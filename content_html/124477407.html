<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<h2>ç¬¬ä¸€ç§ç®€å•æ–¹æ¡ˆ é€šè¿‡composerå®‰è£…</h2>
<p>æ’ä»¶åº“ï¼š<a href="https://packagist.org/packages/maatwebsite/excel" title="maatwebsite/excel - Packagist">maatwebsite/excel - Packagist</a></p>
<p>å®˜ç½‘ï¼š<a href="https://docs.laravel-excel.com/3.1/getting-started/" title="Introduction | Laravel Excel">Introduction | Laravel Excel</a></p>
<p>å¯¼å‡ºæ­¥éª¤ï¼š<a href="https://docs.laravel-excel.com/3.1/exports/" title="ğŸš€ 5 minute quick start | Laravel Excel">ğŸš€ 5 minute quick start | Laravel Excel</a></p>
<p>å®‰è£…å¯¹åº”çš„phpexcelæ’ä»¶</p>
<pre><code class="language-php">composer require maatwebsite/excel
</code></pre>
<p><br/> æ³¨ï¼šcomposeréœ€è¦åˆ‡æºæ“ä½œï¼Œå¦åˆ™ä¸‹è½½å°†å¯èƒ½ä¸ä¼šæˆåŠŸ</p>
<p>å®‰è£…æˆåŠŸåï¼Œå°±æä¾›ç”Ÿæˆå¯¼å‡ºæ•°æ®çš„å‘½ä»¤ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ç”Ÿæˆå¯¼å‡ºæ•°æ®æ–‡ä»¶</p>
<pre><code class="language-php">php artisan make:export FangOwnerExport --model=Models/FangOwner
</code></pre>
<p>  ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶</p>
<p><img alt="" height="417" src="image\12bac9df78604b138a7d482db7b9de6e.png" width="1095"/></p>
<p>åœ¨ç›¸å¯¹çš„æ§åˆ¶å™¨å¯¼å‡ºexcel</p>
<pre><code class="language-php">    #å¼•å…¥
    use Maatwebsite\Excel\Facades\Excel;
    #å¯¼å‡º
    public function phpexcel(){
        # å¯¹åº”æ–‡ä»¶ï¼Œå¯¼å‡ºæ ‡é¢˜
        return Excel::download(new FirmExport(),'news.xlsx');
    }</code></pre>
<h2>ç¬¬äºŒç§ä½¿ç”¨å°†åŸæœ‰å¯¼å‡ºxlsxæ ¼å¼ è½¬å˜ä¸ºcsvæ ¼å¼ å¯ä»¥åœ¨å¤§æ•°æ®å¯¼å‡ºæ—¶ä¼˜åŒ–å¯¼å‡ºé€Ÿåº¦</h2>
<p>è¯¦ç»†ä¹¦å†™ä¸€ä¸‹æ€è·¯ï¼Œä»…æä¾›å€Ÿé‰´</p>
<p>1ã€åˆ›å»ºè·¯ç”±</p>
<pre><code class="language-php">#excelå¯¼å‡º
Route::get('bookexcel',[\App\Http\Controllers\admin\AuthController::class,'fileexcel'])-&gt;name('book.excel');</code></pre>
<p>2ã€å‰ç«¯ä½¿ç”¨</p>
<p><img alt="" height="151" src="image\ad46dd8931dd4c43abb7149887249e6e.png" width="1200"/></p>
<p><img alt="" height="735" src="image\cc1e611beaa0455c85b46be0cb1d93cc.png" width="1200"/></p>
<p> </p>
<p>3ã€åˆ›å»ºå…¬å…±å¯¼å‡ºæ–¹æ³•</p>
<p> åœ¨appæ–‡ä»¶ä¸‹åˆ›å»ºcommonæ–‡ä»¶å¹¶ä¸”åˆ›å»ºcommon.php</p>
<p><img alt="" height="301" src="image\e8f604f0f367478bb7c298ed379f1df6.png" width="267"/></p>
<p> </p>
<p> åœ¨composer.jsonæ–‡ä»¶ä¸­autoloadä¸­è¿›è¡Œä¹¦å†™</p>
<p><img alt="" height="269" src="image\23f511ca2206476a99b29127c655d0f9.png" width="730"/></p>
<pre><code class="language-php">  "files": [
           #å…¬å…±æ–¹æ³•è·¯å¾„
            "app/common/common.php"
        ]</code></pre>
<p>åˆ·æ–°æ¡†æ¶ åœ¨å‘½ä»¤è¡Œ</p>
<pre><code class="language-php">composer dump-autoload</code></pre>
<p>ä»¥ä¸Šæ“ä½œå°±æ˜¯å¯¹æ¡†æ¶ç”Ÿæˆå…±ç±»ï¼Œå®Œæˆååœ¨å…¬å…±ç±»ä¸­å°è£…ä¸€ä¸ªå¯¼å‡ºæ–¹æ³•</p>
<pre><code class="language-php">//åˆ¤æ–­æ˜¯å¦æœ‰è¯¥æ–¹æ³•
if(!function_exists('phpexcel')){
   //è¡¨å¤´ï¼Œæ ‡é¢˜ï¼Œæ•°æ®
    function phpexcel($cell,$title,$data){
        set_time_limit(0);
        ini_set('memory_limit', '128M');
        header('Content-Type: application/vnd.ms-execl');
        header('Content-Disposition: attachment;filename="'.$title . '.csv"');

        //ä»¥å†™å…¥è¿½åŠ çš„æ–¹å¼æ‰“å¼€
        $fp = fopen('php://output', 'a');
 
        foreach($cell as $key =&gt; $item) {
            $celldata[$key] = iconv('UTF-8', 'GBK//IGNORE', $item);
        }
        //å°†æ ‡é¢˜å†™åˆ°æ ‡å‡†è¾“å‡ºä¸­
        fputcsv($fp, $celldata);
        foreach($data as $row){
            foreach($row as $key =&gt; $item) {
                //è¿™é‡Œå¿…é¡»è½¬ç ï¼Œä¸ç„¶ä¼šä¹±ç 
                $row[$key] = iconv('UTF-8', 'GBK//IGNORE', $item);
            }
            fputcsv($fp, $row);
        }
        $res = ['file'=&gt;$title];
        return response()-&gt;json($res);
    }
}</code></pre>
<p>4ã€æ§åˆ¶å…¶è°ƒç”¨</p>
<pre><code class="language-php">   #å¯¼å‡º
    public function fileexcel(Request $request){
        //é˜²æ­¢æ•°æ®é‡å¤§å†…å­˜ä¸å¤Ÿ
        ini_set('memory_limit', '256M');
        //è‡ªå®šä¹‰å­—æ®µ
        $cell=['id','æ–‡ç« æ ‡é¢˜','é‚®ç®±','åŠ å…¥æ—¶é—´'];
        //è‡ªå®šä¹‰å¯¼å‡ºæ–‡ä»¶å
        $title = $request-&gt;input('title','æ–‡ç« åˆ—è¡¨');
        $title = $title.date('YmdHis');
        //æ­¤æ–¹æ³•ä¸ºå¯¼å‡ºæ•°æ®æ¥æºï¼Œåœ¨åº“æ–‡ä»¶é‡Œï¼Œä½ å¯æ ¹æ®è‡ªå·±éœ€è¦çš„æ•°æ®æŸ¥æ•°æ®åº“
        $res=Auths::get()-&gt;toarray();
        $data=[];
        foreach ($res as $k=&gt;$v){
            $data[$k][]=$v['id'];
            $data[$k][]=$v['auth_name'];
            $data[$k][]=$v['auth_email'];
            $data[$k][]=$v['created_at'];
        }
        //å¯¼å‡ºè¡¨æ ¼
         return phpexcel($cell,$title,$data);
    }</code></pre>
<p></p>
</div>
</div>