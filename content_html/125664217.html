<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>类和对象</h3>
<ul><li><a href="#_1">一、类和对象基本知识点</a></li><li><ul><li><a href="#11__2">1.1 类的基本概念</a></li><li><a href="#12__7">1.2 类的定义</a></li><li><a href="#13__61">1.3 类的访问限定符</a></li><li><a href="#14__73">1.4 封装</a></li><li><a href="#15__78">1.5 类对象的大小</a></li><li><a href="#16_this_139">1.6 this指针</a></li><li><ul><li><a href="#161__140">1.6.1 类的初始化</a></li><li><a href="#162_this_169">1.6.2 this指针的特性</a></li></ul>
</li></ul>
</li><li><a href="#_228">二、类的六个默认成员函数</a></li><li><ul><li><a href="#__243">① 构造函数</a></li><li><a href="#__402">② 析构函数</a></li><li><a href="#__477">③ 拷贝构造函数</a></li><li><a href="#__527">④ 赋值运算符重载函数</a></li><li><ul><li><a href="#__528">Ⅰ 运算符重载</a></li><li><a href="#__606">Ⅱ 赋值运算符重载</a></li></ul>
</li><li><a href="#const_640">const修饰类的成员函数</a></li><li><a href="#_const_726">⑤和⑥ 取地址及const取地址操作符重载</a></li></ul>
</li><li><a href="#_746">三、类和对象的知识点进阶</a></li><li><ul><li><a href="#31__747">3.1 再谈构造函数</a></li><li><ul><li><a href="#311__748">3.1.1 初始化列表</a></li><li><a href="#312_explicit_844">3.1.2 explicit关键字</a></li></ul>
</li><li><a href="#32_static_882">3.2 static成员</a></li><li><ul><li><a href="#321_static_883">3.2.1 static成员对象</a></li><li><a href="#322_static_938">3.2.2 static成员函数</a></li></ul>
</li><li><a href="#33_C11_957">3.3 C++11的成员初始化</a></li><li><a href="#34__972">3.4 友元</a></li><li><ul><li><a href="#341__973">3.4.1 友元函数</a></li><li><a href="#342__1036">3.4.2 友元类</a></li></ul>
</li><li><a href="#35__1109">3.5 内部类</a></li></ul>
</li></ul>
</div>
<p></p>
<h1><a id="_1"></a>一、类和对象基本知识点</h1>
<h2><a id="11__2"></a>1.1 类的基本概念</h2>
<blockquote>
<p><font color="#0000dd">首先要知道类和C语言的结构体很像，都是定义出一个新的类型，结构体只能定义变量，而类不仅可以<mark>定义变量</mark>，还可以定义<mark>函数</mark>。</font></p>
</blockquote>
<p>要注意的是在C++中<code>struct</code>兼容C语言的所有用法，同时把<code>struct</code>升级为类，C++用<code>class</code>定义类。</p>
<hr/>
<h2><a id="12__7"></a>1.2 类的定义</h2>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">className</span>
<span class="token punctuation">{<!-- --></span>
   <span class="token comment">// 类体：由成员函数和成员变量组成</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 一定要注意后面的分号</span>
</code></pre>
<blockquote>
<p>class为定义类的关键字，ClassName为类的名字，{}中为类的主体，注意类定义结束时后面分号。<br/> 类中的元素称为类的成员：类中的数据称为类的属性或者成员变量; 类中的函数称为类的方法或者成员函数。</p>
</blockquote>
<p>类的定义也有两种方式：<br/> <font color="#0000dd">1️⃣声明和定义全部放在类中</font></p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//打印基本信息</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _name <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _sex <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> _name<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> _sex<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><font color="#0000dd">2️⃣声明和定义分开</font></p>
<pre><code class="prism language-cpp"><span class="token comment">//.h</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//打印基本信息</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">char</span><span class="token operator">*</span> _name<span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> _sex<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-cpp"><span class="token comment">//.cpp</span>
<span class="token keyword">void</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> _name <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _sex <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>要注意一点：<font color="#dd0000">有<code>{}</code>说明是个域，要用<code>::</code>访问</font></p>
<hr/>
<h2><a id="13__61"></a>1.3 类的访问限定符</h2>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/56bb10efc741463aa3af188298b3a88b.png#pic_center"/><br/> 说明：</p>
<blockquote>
<p>暂时把<code>protected</code>和<code>private</code>看成一样的，<code>public</code>就是在类外面能直接被访问，而<code>private</code>在类外面不能被直接访问<br/> 当不写的时候class的默认访问权限为private，struct为public(因为struct要兼容C)</p>
</blockquote>
<p>【面试题】<br/> C++中struct和class的区别是什么？</p>
<blockquote>
<p><font color="#0000dd">C++需要兼容C语言，所以C++中struct可以当成结构体去使用。另外C++中struct还可以用来定义类。<br/> 和class是定义类是一样的，区别是struct的成员默认访问方式是public，class是struct的成员默认访问方式<br/> 是private。</font></p>
</blockquote>
<hr/>
<h2><a id="14__73"></a>1.4 封装</h2>
<p>面向对象的三大特性：<font color="#dd0000">封装、继承、多态。 </font><br/>封装：类和对象都封装到类中，想被访问的定义成公有，不想被访问的定义成私有。<br/> <mark>封装的本质是管理</mark><br/> 封装更加严格，规范，不封装更自由，对使用的人素养要求高。</p>
<hr/>
<h2><a id="15__78"></a>1.5 类对象的大小</h2>
<p>来看一个类：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>最后编译的结果是 <font color="#dd0000"> 12</font><br/>我们可以看到光private内的三个变量就达到了12，那么类中的成员函数为什么不算在内？</p>
<blockquote>
<p><font color="#0000dd">假设我们实例化了两个对象d1,d2，他们的三个成员变量不一定相同，但是他们的Print函数却相同，如果给每个对象都在内存中存函数的地址，势必会造成空间浪费。所以在计算大小时<mark>不管成员函数</mark></font></p>
</blockquote>
<blockquote>
<p>计算成员变量的大小也遵循内存对齐规则<a href="https://blog.csdn.net/qq_66314292/article/details/123959982">结构体/联合体大小的计算</a></p>
</blockquote>
<p>用一张图理解一下：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/53a34cc043a54b95a2e304c9d009b14c.png#pic_center"/><br/> <em><strong>特殊情况：</strong></em></p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//类中仅有成员函数</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//空类</span>
<span class="token keyword">class</span> <span class="token class-name">B</span>
<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	A a<span class="token punctuation">;</span>
	B b<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>两个的结果都为<font color="#dd0000"> 1</font><br/>为什么不是0？</p>
<blockquote>
<p><font color="#0000dd">给了一个字节不是为了存储数据，是为了占位，表示对象存在过</font></p>
</blockquote>
<p>不然无法区分<code>B b; B bb; B bbb;</code>这三个对象。当我们看这三个对象的地址会发现他们不一样。</p>
<hr/>
<h2><a id="16_this_139"></a>1.6 this指针</h2>
<h3><a id="161__140"></a>1.6.1 类的初始化</h3>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	 <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span> 
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date d2<span class="token punctuation">;</span>
	d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>我们知道d1和d2两个对象初始化调用和的都是同一个函数，那么为什么调用的同一个函数，却能完成各自的初始化呢？</p>
<h3><a id="162_this_169"></a>1.6.2 this指针的特性</h3>
<p>看似init函数有三个参数，而编译器会增加一个隐含参数</p>
<pre><code class="prism language-cpp"><span class="token function">Init</span><span class="token punctuation">(</span>Date<span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
</code></pre>
<p>init内部可以写成：</p>
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
	<span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>那么在主函数内：</p>
<pre><code class="prism language-cpp">Date d1<span class="token punctuation">;</span>
d1<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//d1.Init(&amp;d1, 2022, 1, 1)</span>
Date d2<span class="token punctuation">;</span>
d2<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//d2.Init(&amp;d2, 2022, 1, 2)</span>
</code></pre>
<p><em><strong>this指针特性：</strong></em></p>
<blockquote>
<p><font color="#0000dd">1️⃣this指针是隐含的，编译时增加的，不能自己在函数的调用和定义中加<br/> 2️⃣可以在成员函数中使用</font></p>
</blockquote>
<p>【面试题】<br/> 下面程序能运行通过吗？</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">PrintA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">void</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Show()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	A<span class="token operator">*</span> p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span><span class="token function">PrintA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	p<span class="token operator">-&gt;</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>答案是<code>p-&gt;PrintA()</code>不能运行成功(空指针)，而<code>p-&gt;Show()</code>可以<br/> <code>p-&gt;PrintA()</code>可以看作<code>p-&gt;PrintA(&amp;p)</code>，而题中函数的<code>_a</code>可以看作<code>this-&gt;a</code>，就是空指针解引用。而<code>p-&gt;Show()</code>不会出出现这种情况</p>
</blockquote>
<hr/>
<h1><a id="_228"></a>二、类的六个默认成员函数</h1>
<p>先定义出个日期类：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>类里面的成员函数我们什么都不写，编译器也会默认生成6个函数，这六个函数叫做<mark>默认(缺省)成员函数</mark></p>
</blockquote>
<h2><a id="__243"></a>① 构造函数</h2>
<p>构造函数完成的是对象的<mark>初始化</mark><br/> <font color="#0000dd">构造函数的存在是为了防止我们忘了使用自己定义的初始化函数，而直接去使用对象发生错误</font><br/><em><strong>特性：</strong></em></p>
<blockquote>
<p><em><strong>1️⃣ 函数名与类名相同。<br/> 2️⃣ 无返回值。<br/> 3️⃣ 对象实例化时编译器<mark>自动调用</mark>对应的构造函数。</strong></em></p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>当我们对象实例化后它会<mark>自动调用</mark>Date函数</p>
<blockquote>
<p><em><strong>4️⃣ 构造函数可以重载。<br/> 5️⃣ 无参的构造函数和全缺省的构造函数都称为默认构造函数，<mark>并且默认构造函数只能有一个</mark>。注意：无参<br/> 构造函数、全缺省构造函数、我们没写编译器默认生成的构造函数，都可以认为是默认成员函数。</strong></em></p>
</blockquote>
<p>能够重载说明了有多种初始化方式</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> <span class="token number">2022</span><span class="token punctuation">;</span>
		_month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		_day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date d2<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>d1 调用的是有参数的构造函数，d2 调用的是无参的构造函数。<br/> 而我们可以把两个重载函数合二为一，写成全缺省参数。</p>
<pre><code class="prism language-cpp"><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p><font color="#dd0000">要注意一种情况：<br/> 当有参数的构造函数写成全缺省的时候，d2实例化就会出错，虽然语法上没什么问题，但是编译器却不知道该调哪个函数。</font></p>
<blockquote>
<p><em><strong>6️⃣ 如果类中没有显式定义构造函数，则C++编译器会自动生成一个无参的默认构造函数，一旦用户显式定义编译器将不再生成。</strong></em></p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> <span class="token string">"日"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	d1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>输出结果：</p>
<blockquote>
<p><font color="#dd0000">-858993460年-858993460月-858993460日</font></p>
</blockquote>
<p>我们可以看到，好像编译器默认生成的构造函数好像什么事都没做</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"年"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"月"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> <span class="token string">"日"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		_aa<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
	A _aa<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	d1<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这里编译器把_aa的值初始化为0。所以得出结论：</p>
<blockquote>
<p><font color="#0000dd">编译器默认生成的构造函数，对内置类型(如int，char，指针等等)默认不初始化，对自定义类型(如class，struct)编译器会调用他们的默认构造函数初始化。</font></p>
</blockquote>
<p><em><strong>默认构造函数：</strong></em><br/> 有很多人认为默认构造函数就是我们没写，编译器默认生成的函数，这种理解是不全面的</p>
<blockquote>
<p><font color="#0000dd">1️⃣ 我们不写，编译器默认生成的<br/> 2️⃣ 我们自己写的无参的<br/> 3️⃣ 我们自己写的全缺省的</font></p>
</blockquote>
<p>用一句话来说就是：<font color="#dd0000">不用参数就可以调用的构造函数</font></p>
<p><em><strong>总结：</strong></em></p>
<blockquote>
<p><font color="#660066">默认函数大多数都是要自己写的，并且建议写成全缺省的形式</font></p>
</blockquote>
<hr/>
<h2><a id="__402"></a>② 析构函数</h2>
<p>首先明白一点：析构函数<mark>不是完成对象的销毁</mark>，对象在销毁时会自动调用析构函数，完成类的一些资源清理工作。<br/> <em><strong>特性：</strong></em></p>
<blockquote>
<p><em><strong>1️⃣ 析构函数名是在类名前加上字符 ~。<br/> 2️⃣ 无参数无返回值。<br/> 3️⃣ 一个类有且只有一个析构函数。若未显式定义，系统会自动生成默认的析构函数。<br/> 4️⃣ 对象生命周期结束时，<mark>C++编译系统系统自动调用析构函数。</mark></strong></em></p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token operator">~</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"~Date()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date d1<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>其实在日期类里面，析构函数没有起到什么作用，写不写都一样，那么在什么情况下析构函数有用呢？</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Stack</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Stack</span><span class="token punctuation">(</span><span class="token keyword">int</span> capacity <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> capacity<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		_capacity <span class="token operator">=</span> capacity<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">free</span><span class="token punctuation">(</span>_a<span class="token punctuation">)</span><span class="token punctuation">;</span>
		_a <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		_size <span class="token operator">=</span> _capacity <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span><span class="token operator">*</span> _a<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _size<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _capacity<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>我们在数据结构中学到的栈，每次都要写<code>Destroy</code>函数，而在C++中我们就不用自己写了。像Stack类析构函数具有重大意义。</p>
<blockquote>
<p><em><strong>5️⃣ 先构造的后析构，后构造的先析构</strong></em></p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Stack s1<span class="token punctuation">;</span>
	stack s2<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><font color="#0000dd">对象是定义在栈中，函数调用会建立栈帧，栈帧中的对象构造和析构也<mark>符合后进先出</mark>的规则。</font><br/><em><strong>s1先构造<br/> s2后构造<br/> s1后析构<br/> s2先析构</strong></em></p>
<p>析构函数的跟构造函数类似，对内置类型和自定义类型处理方式不同，<mark>内置类型不处理，自定义类型会处理。</mark><br/> <em><strong>总结一下：</strong></em></p>
<blockquote>
<p><font color="#660066">当你的类在构造函数执行过程中申请了一些资源(内容空间),需要在对象被销毁时进行释放时,就需要自己定义析构函数。</font></p>
</blockquote>
<hr/>
<h2><a id="__477"></a>③ 拷贝构造函数</h2>
<p>拷贝构造就跟字面意思一样，比方说实例化了一个日期类对象d1，现在想要实例化个跟d1信息一样的对象，就要用到拷贝构造。</p>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date <span class="token function">d2</span><span class="token punctuation">(</span>d1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>那么我们就来看看拷贝构造怎么实现？<br/> <em><strong>特性：</strong></em></p>
<blockquote>
<p><em><strong>1️⃣ 拷贝构造函数是<mark>构造函数的一个重载形式</mark>。</strong></em></p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token function">Date</span><span class="token punctuation">(</span>Date d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p><font color="#dd0000">验证发现这个代码编不过，这就要看第二个特性：</font></p>
<blockquote>
<p><em><strong>2️⃣ 拷贝构造函数的参数只有一个且<mark>必须使用引用传参</mark>，使用传值方式会引发无穷递归调用。</strong></em></p>
</blockquote>
<p>为什么上面的函数会无穷递归呢？<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e967f533f8e6491ea9916b47f3e7d58e.png#pic_center"/><br/> 而如果用引用：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/bdeca6e520334ed192db8b7a9e12c55a.png#pic_center"/><br/> 从次可得：<br/> <font color="#0000dd">函数传参，如果传的是自定义类型的对象，推荐使用传引用。如果使用传值，就会调用拷贝构造。</font></p>
<pre><code class="prism language-cpp"><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>3️⃣ 若未显示定义，系统生成默认的拷贝构造函数。它会按照字节序拷贝，我们称作浅拷贝(值拷贝)，就是对<mark>内置类型</mark>浅拷贝，</p>
</blockquote>
<p><font color="#dd0000">但是浅拷贝又会在一些情况下出现问题，比如Stack类。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/807ffa201fac4e74b1dca44f4add0ae4.png#pic_center"/></font></p>
<p><em><strong>总结一下：</strong></em></p>
<blockquote>
<p><font color="#660066">拷贝构造函数是特殊的构造函数，涉及到深浅拷贝，像Date这样的类就需要浅拷贝，不需要自己写，但是像Stack这种的类就需要自己写，不然会导致对象析构两次，导致崩溃。</font></p>
</blockquote>
<hr/>
<h2><a id="__527"></a>④ 赋值运算符重载函数</h2>
<h3><a id="__528"></a>Ⅰ 运算符重载</h3>
<p>C++为了增强代码的可读性引入了运算符重载，而赋值运算符重载就是运算符重载中的一种。<br/> 在以前我们如果要判断两个日期对象是否相等时：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">bool</span> <span class="token function">Equal</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">==</span> d1<span class="token punctuation">.</span>_day
			<span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">==</span> d1<span class="token punctuation">.</span>_month
			<span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">==</span> d1<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date <span class="token function">d2</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> d1<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>d2<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这样我们就面临一个问题：代码<mark>可读性差</mark>。<br/> 如果我们能写成<code>d1 == d2</code>是不是就能通俗易懂了呢？<br/> C++就可以用<mark>运算符重载</mark>来实现，使用关键字<code>operator</code></p>
<pre><code class="prism language-cpp"><span class="token comment">//定义在全局，注意把成员变量设成公有</span>
<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d2<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> d1<span class="token punctuation">.</span>_day <span class="token operator">==</span> d2<span class="token punctuation">.</span>_month
		<span class="token operator">&amp;&amp;</span> d1<span class="token punctuation">.</span>_month <span class="token operator">==</span> d2<span class="token punctuation">.</span>_month
		<span class="token operator">&amp;&amp;</span> d1<span class="token punctuation">.</span>_year <span class="token operator">==</span> d2<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>而我们比较时就有两种写法(两种一样)：</p>
<pre><code class="prism language-cpp"><span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span> d2<span class="token punctuation">)</span><span class="token punctuation">;</span>
d1 <span class="token operator">==</span> d2<span class="token punctuation">;</span>
</code></pre>
<p>但是如果我们不想变成公有呢？<br/> 那么就写成成员函数：</p>
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d1<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">==</span> d1<span class="token punctuation">.</span>_day
		<span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">==</span> d1<span class="token punctuation">.</span>_month
		<span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">==</span> d1<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>比较用法：</p>
<pre><code class="prism language-cpp">d1<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span>d2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//d1.operator(&amp;d1, d2);</span>
d1 <span class="token operator">==</span> d2<span class="token punctuation">;</span><span class="token comment">//d1.opreator(&amp;d1, d2);</span>
</code></pre>
<p><font color="#660066"><em><strong>其他运算符重载方法相同，例如<code>+ - * /</code></strong></em></font><br/><br/> 注意：</p>
<blockquote>
<p><em><strong>1️⃣ 不能通过连接其他符号来创建新的操作符：比如operator@<br/> 2️⃣ 重载操作符必须有一个类类型或者枚举类型的操作数<br/> 3️⃣ 用于内置类型的操作符，其含义不能改变，例如：<mark>内置的整型+，不 能改变其含义</mark><br/> 4️⃣ 作为类成员的重载函数时，其形参看起来比操作数数目少1成员函数的操作符有一个默认的形参this，限定为第一个形参<br/> 5️⃣ <code>.*</code> 、<code>::</code> 、<code>sizeof</code> 、<code>? :</code> 、<code>.</code> 注意以上5个运算符不能重载。这个经常在笔试选择题中出现。</strong></em></p>
</blockquote>
<h3><a id="__606"></a>Ⅱ 赋值运算符重载</h3>
<blockquote>
<p>赋值运算符重载也是拷贝行为，不一样的是，拷贝构造是实例化一个对象时，那同类对象的值拷贝。而赋值运算符重载是在拷贝时<mark>两个对象都已经存在</mark>且已经被初始化过，进而把一个对象赋值给另一个对象。</p>
</blockquote>
<pre><code class="prism language-cpp">	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date d2<span class="token punctuation">;</span>
	d2 <span class="token operator">=</span> d1<span class="token punctuation">;</span>
</code></pre>
<p>这样就可以完成拷贝赋值<br/> 那么我们怎么能自己实现呢？</p>
<pre><code class="prism language-cpp">	<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p>但是这么实现不太好，因为无法连续赋值(d1 = d2 = d3)。</p>
<pre><code class="prism language-cpp">	<span class="token comment">//返回值不加&amp;又会调拷贝构造</span>
	Date<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p><em><strong>总结一下：</strong></em></p>
<blockquote>
<p><font color="#660066">编译器默认生成的赋值运算符跟拷贝构造函数的特性一样，就是说像Date这种类我们自己不用写。对自定义类型，会去调他的赋值运算符重载完成拷贝。</font></p>
</blockquote>
<hr/>
<h2><a id="const_640"></a>const修饰类的成员函数</h2>
<p>将const修饰的类成员函数称之为const成员函数，const修饰类成员函数，<mark>实际修饰该成员函数隐含的this指针</mark>，表明在该成员函数中<mark>不能对类的任何成员进行修改</mark>。<br/> 假如我们想调用比较是否相等的运算符重载函数但是写错了：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">)</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">)</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Date <span class="token function">d1</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Date <span class="token function">d2</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	d1 <span class="token operator">==</span> d2<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>就变成了赋值运算符重载了。那么我们有没有什么方法可以避免呢？<br/> 我们可以给<code>this</code>指针也加上<code>const</code>：<br/> 因为this是隐含的，所以就有以下这种方法：</p>
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span><span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token comment">//修饰*this</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_day <span class="token operator">=</span> d<span class="token punctuation">.</span>_day<span class="token punctuation">)</span><span class="token comment">//error</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_month <span class="token operator">=</span> d<span class="token punctuation">.</span>_month<span class="token punctuation">)</span><span class="token comment">//error</span>
			<span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>_year <span class="token operator">=</span> d<span class="token punctuation">.</span>_year<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//error</span>
	<span class="token punctuation">}</span>
</code></pre>
<p><em><strong>const权限问题：</strong></em></p>
<blockquote>
<ol><li>const对象可以调用非const成员函数吗？</li><li>非const对象可以调用const成员函数吗？</li><li>const成员函数内可以调用其它的非const成员函数吗？</li><li>非const成员函数内可以调用其它的const成员函数吗？</li></ol>
</blockquote>
<p><font color="#dd0000">1 不可以<br/> 2 可以</font></p>
<p>前两个好理解，重要的是后面两个。<br/> <font color="#dd0000">3 不可以</font></p>
<pre><code class="prism language-cpp">    <span class="token keyword">void</span> <span class="token function">Fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p>这里可以看成Fun的this传递给Print()，<mark>权限放大</mark>，不可以。</p>
<p><font color="#dd0000">4 可以</font></p>
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">Fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p>这个实际上是Fun的this传递给Print()，<mark>权限缩小</mark>，可以。</p>
<p><font color="#660066">这里本质就是要看指针的传递。谁调用就是谁传递给别人。</font></p>
<hr/>
<h2><a id="_const_726"></a>⑤和⑥ 取地址及const取地址操作符重载</h2>
<p>这两个操作符不重要，了解就行。<br/> <em><strong>取地址操作符重载：</strong></em></p>
<pre><code class="prism language-cpp">Date<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><em><strong>const取地址操作符重载：</strong></em></p>
<pre><code class="prism language-cpp"><span class="token keyword">const</span> Date<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<hr/>
<h1><a id="_746"></a>三、类和对象的知识点进阶</h1>
<h2><a id="31__747"></a>3.1 再谈构造函数</h2>
<h3><a id="311__748"></a>3.1.1 初始化列表</h3>
<p>像我们前面的构造函数初始化使用的是<mark>函数体内初始化</mark>，<br/> 初始化列表初始化也可以完成初始化。</p>
<pre><code class="prism language-cpp"><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_year</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_month</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_day</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>以一个<mark>冒号开始</mark>，接着是一个以<mark>逗号分隔</mark>的数据成员列表，每个"成员变量"后面跟一个放在括号中的初始值或表达式，不要忘记最后的{}。</p>
</blockquote>
<p><font color="#0000dd">使用的时候两种方法都可以使用，并且可以混着使用：</font></p>
<pre><code class="prism language-cpp"><span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_year</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_month</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p><em><strong>注意：</strong></em></p>
<blockquote>
<p><em><strong>1️⃣ 每个成员变量在初始化列表中只能出现一次(初始化只能初始化一次)<br/> 2️⃣ 类中包含以下成员，<mark>必须放在初始化列表位置进行初始化</mark>：</strong></em><br/> ① 引用成员变量<br/> ② const成员变量<br/> ③ 自定义类型成员(该类<mark>没有默认构造函数</mark>)</p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//不是默认构造函数(需要传参)</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_year</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_n</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_p</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_a</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 显示调用</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token comment">//不能在函数体内初始化，只能使用列表初始化</span>
		<span class="token comment">//_n = 1; </span>
		<span class="token comment">//_p = year;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token comment">//引用必须在定义时初始化，但此处是声明，所以没问题</span>
	<span class="token keyword">int</span><span class="token operator">&amp;</span> _p<span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">int</span> _n<span class="token punctuation">;</span>
	A _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>3️⃣<em><strong>建议尽量使用初始化列表初始化</strong></em>，因为<mark>初始化列表是对象定义的地方</mark>，就算不写也会使用初始化列表初始化(随机值)。<br/> 4️⃣ <em><strong>成员变量在类中<mark>声明次序就是其在初始化列表中的初始化顺序</mark>，与其在初始化列表中的先后次序无关</strong></em>。</p>
</blockquote>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
		<span class="token operator">:</span><span class="token function">_a1</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
		<span class="token punctuation">,</span> <span class="token function">_a2</span><span class="token punctuation">(</span>_a1<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> _a1 <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span> <span class="token operator">&lt;&lt;</span> _a2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a2<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _a1<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	A <span class="token function">aa</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	aa<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><font color="#0000dd">成员变量初始化顺序是按照声明的顺序走的，先初始化_a2，但此时_a1还没被初始化，所以_a2是随机值。然后用a初始化_a1，_a1的值为1。</font></p>
<p><em><strong>补充一个知识点：</strong></em><br/> 有时候我们会看到<code>A(3);</code>这种构造方式，他是构造匿名对象，它的<mark>生命周期只在这一行中</mark>，这一行走完就会调用析构函数。</p>
<p>那么什么情景下会用到匿名对象呢？</p>
<blockquote>
<p>要使用一个对象，但只在这一行有用，就可以用匿名对象，方便快捷。</p>
</blockquote>
<h3><a id="312_explicit_844"></a>3.1.2 explicit关键字</h3>
<p>单参数的构造函数，支持隐式类型转换。</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	A a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//相当于先构造一个临时变量 A tmp(2); </span>
	        <span class="token comment">//再拷贝构造 A a(tmp);</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>而现在的编译器进行了优化，相当于直接调构造函数：<code>A a(2)</code><br/> 但是如果我们不想让它隐式类型转换，就可以用<code>explicit</code>关键字：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">explicit</span> <span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span>
		<span class="token operator">:</span> <span class="token function">_a</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>如果再想<code>A a = 2;</code> 就会报错<br/> <font color="#dd0000">用explicit修饰构造函数，将会禁止单参构造函数的隐式转换。</font></p>
<hr/>
<h2><a id="32_static_882"></a>3.2 static成员</h2>
<h3><a id="321_static_883"></a>3.2.1 static成员对象</h3>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> _n<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//必须在类外边定义，加上类域，不写static</span>
<span class="token keyword">int</span> A<span class="token double-colon punctuation">::</span>_n <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><font color="#dd0000">这个的结果为 <strong>1</strong>，说明_n是存在静态区的，属于整个类，也属于类的所有对象。</font></p>
<p><strong>使用场景：</strong><br/> 计算程序中A定义出了多少个对象？</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">++</span>_n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">const</span> A<span class="token operator">&amp;</span> a<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token operator">++</span>_n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">//所有的对象都是构造或者拷贝构造出来的！！</span>
	<span class="token keyword">int</span> <span class="token function">GetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> _n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token comment">//要注意这里是声明，他的初始化要在类外面。</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> _n<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> A<span class="token double-colon punctuation">::</span>_n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	A a1<span class="token punctuation">;</span>
	A a2<span class="token punctuation">;</span>
	A a3<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> a1<span class="token punctuation">.</span><span class="token function">GetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="322_static_938"></a>3.2.2 static成员函数</h3>
<pre><code class="prism language-cpp">    <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">GetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">return</span> _n<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p>他跟成员函数的区别是<mark>没有this指针</mark>，<mark>不能访问非静态成员</mark>。</p>
<p><font color="#dd0000">静态成员和静态成员函数都不属于某个对象，突破类域就能访问(也要看访问限定符)。</font></p>
<p><em><strong>总结：</strong></em></p>
<blockquote>
<p>1️⃣ 静态成员为所有类对象所共享，不属于某个具体的对象<br/> 2️⃣ 静态成员变量<mark>必须在类外定义</mark>，定义时不添加static关键字<br/> 3️⃣ 类静态成员即可用类名<code>::</code>静态成员或者对象.静态成员来访问<br/> 4️⃣ 静态成员函数<mark>没有隐藏的this指针，不能访问任何非静态成员</mark><br/> 5️⃣ 静态成员和类的普通成员一样，也有public、protected、private3种访问级别，也可以具有返回值</p>
</blockquote>
<hr/>
<h2><a id="33_C11_957"></a>3.3 C++11的成员初始化</h2>
<p>我们知道编译器生成的默认构造函数对内置类型默认不初始化，所以在C++11中引入了解决办法：</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> _p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>我们没有写构造函数，内置类型也会初始化。要注意的是：<br/> <font color="#dd0000">这里不是初始化，依旧是声明，0 和 nullptr为缺省值，如果我们自己写构造函数（不是默认构造函数），没给参数就用缺省值初始化。</font></p>
<hr/>
<h2><a id="34__972"></a>3.4 友元</h2>
<h3><a id="341__973"></a>3.4.1 友元函数</h3>
<p>我们发现前面调用Print()函数的操作比较复杂，那么我们能不能使用<code>operator&lt;&lt;</code>来让我们输出？<br/> 查C++库可以知道cout的类型是<code>ostream</code></p>
<pre><code class="prism language-cpp">    <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		out <span class="token operator">&lt;&lt;</span> _year <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _month <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> _day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<p>但是当我们用<code>cout &lt;&lt; d1</code>调用时候却发现出现错误。</p>
<pre><code class="prism language-cpp">  <span class="token comment">//cout &lt;&lt; d1</span>
  <span class="token comment">//第一个参数是左操作数，第二个是右操作数，两个操作数反了！！</span>
	<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">)</span>
  <span class="token comment">//void operator&lt;&lt;(Date* this, ostream&amp; out)</span>
</code></pre>
<p>所以必须写成 <code>d1 &lt;&lt; cout</code>，但是不能满足我们的需求。<br/> 所以我们要写到全局才能调整顺序。</p>
<pre><code class="prism language-cpp"><span class="token comment">//全局</span>
<span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	out <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><font color="#dd0000">但是写到全局又会出现访问权限的问题。<br/> 这里就引入友元函数：</font></p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">//友元函数的声明</span>
	<span class="token comment">//返回值为ostream是为了连续输出</span>
	<span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> out<span class="token punctuation">,</span> <span class="token keyword">const</span> Date<span class="token operator">&amp;</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	out <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_year <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_month <span class="token operator">&lt;&lt;</span> <span class="token string">"-"</span> <span class="token operator">&lt;&lt;</span> d<span class="token punctuation">.</span>_day <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><em><strong>说明：</strong></em></p>
<blockquote>
<p><font color="#0000dd">1️⃣ 友元函数可访问类的私有和保护成员，但<mark>不是类的成员函数</mark>（无this指针）<br/> 2️⃣ 友元函数<mark>不能用const修饰</mark>（无this指针）<br/> 3️⃣ 友元函数可以在类定义的任何地方声明，不受类访问限定符限制<br/> 4️⃣ 一个函数可以是多个类的友元函数<br/> 5️⃣ 友元函数的调用与普通函数的调用和原理相同</font></p>
</blockquote>
<h3><a id="342__1036"></a>3.4.2 友元类</h3>
<p>友元类的所有成员函数都可以是另一个类的友元函数，<mark>都可以访问另一个类中的非公有成员</mark>。</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">;</span><span class="token comment">//前置声明</span>
<span class="token keyword">class</span> <span class="token class-name">Time</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Time</span><span class="token punctuation">(</span><span class="token keyword">int</span> hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> second <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_hour <span class="token operator">=</span> hour<span class="token punctuation">;</span>
		_minute <span class="token operator">=</span> minute<span class="token punctuation">;</span>
		_second <span class="token operator">=</span> second<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _hour<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _minute<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _second<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Date</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Date</span><span class="token punctuation">(</span><span class="token keyword">int</span> year <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> month <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">int</span> day <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_year <span class="token operator">=</span> year<span class="token punctuation">;</span>
		_month <span class="token operator">=</span> month<span class="token punctuation">;</span>
		_day <span class="token operator">=</span> day<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">PrintTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
	    <span class="token comment">// 直接访问时间类私有的成员变量</span>
		cout <span class="token operator">&lt;&lt;</span> _t<span class="token punctuation">.</span>_hour <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _year<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _month<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _day<span class="token punctuation">;</span>
	Time _t<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>这里我们想在Date类里面调用PrintTime()函数去访问时间类的私有成员变量，明显不可行，但是当我们<mark>让Date变成Time的友元类</mark>后就可以了。</p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Time</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 声明日期类为时间类的友元类，</span>
	<span class="token comment">//则在日期类中就直接访问Time类中的私有成员变量</span>
	<span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Date</span><span class="token punctuation">;</span> 
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Time</span><span class="token punctuation">(</span><span class="token keyword">int</span> hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> minute <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> second <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		_hour <span class="token operator">=</span> hour<span class="token punctuation">;</span>
		_minute <span class="token operator">=</span> minute<span class="token punctuation">;</span>
		_second <span class="token operator">=</span> second<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _hour<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _minute<span class="token punctuation">;</span>
	<span class="token keyword">int</span> _second<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><em><strong>注意：</strong></em></p>
<blockquote>
<p><font color="#dd0000">1️⃣ <em><strong>友元关系具有<mark>单向性</mark>，没有交换性。</strong></em><br/> Date是Time的友元类，那么就可以在Date中直接访问Time的私有成员。但是Time却不能访问Date。<br/> 2️⃣ <em><strong>友元关系不能传递。</strong></em><br/> 如果B是A的友元，C是B的友元，则不能说明C时A的友元。</font></p>
</blockquote>
<p>一般情况下不建议使用友元，因为会破坏封装。</p>
<blockquote>
<p><strong>友元函数不属于任何一个类，是定义在类外的普通函数，所以不能访问私有成员<br/> 而友元类的成员函数都可以访问另一个类的非公有成员</strong></p>
</blockquote>
<hr/>
<h2><a id="35__1109"></a>3.5 内部类</h2>
<p>就是在一个类的里面再定义一个类。<br/> <font color="#dd0000">而内部的类天生是外部的类的友元。</font></p>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token comment">//B叫做A的内部类</span>
	<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token comment">//B天生是A的友元</span>
	<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		<span class="token keyword">int</span> _b<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span> _a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span><span class="token operator">*</span> _p <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>B可以直接访问A。<br/> <em><strong>特点：</strong></em></p>
<blockquote>
<p>1️⃣ 内部类可以定义在外部类的public、protected、private都是可以的。<br/> 2️⃣ 注意内部类可以直接访问外部类中的static、枚举成员，不需要<br/> 外部类的对象/类名。<br/> 3️⃣ <mark>sizeof(外部类)=外部类，和内部类没有任何关系</mark></p>
</blockquote>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>