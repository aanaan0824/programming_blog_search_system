<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<blockquote>
<p>提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档</p>
</blockquote>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#_7">前言</a></li><li><ul><li><a href="#_8">继承性反映的是类与类之间的层次关系，多态性则是考虑这种层次关系以及类自身特定成员函数之间的关系来解决行为的再抽象问题。多态性有两种表现形式一种是不同的对象在收到相同的消息时，产生不同的动作，主要通过虚函数来实现；另一种是同一对象收到相同的消息却产生不同的函数调用，主要通过函数重载来实现。本章将讨论多态性的主要内容：虚函数和动态联编;</a></li></ul>
</li><li><a href="#_11">一、静态联编与动态联编</a></li><li><ul><li><a href="#_15">静态联编</a></li><li><a href="#_114">动态联编</a></li><li><a href="#_120">虚函数</a></li><li><ul><li><ul><li><a href="#_121">虚函数的作用</a></li></ul>
</li><li><a href="#_180">虚函数与一般重载函数的区别</a></li><li><a href="#_189">继承虚属性</a></li><li><ul><li><ul><li><ul><li><a href="#_305">示例虚函数对他的基类的函数没有影响</a></li></ul>
</li></ul>
</li></ul>
</li><li><a href="#_349">成员函数中调用虚函数</a></li><li><a href="#_384">构造函数和析构函数中调用虚函数</a></li><li><a href="#_427">纯虚函数和抽象类</a></li><li><ul><li><ul><li><a href="#_429">纯虚函数</a></li><li><a href="#_479">抽象类</a></li></ul>
</li></ul>
</li><li><a href="#_489">虚析构函数</a></li><li><ul><li><ul><li><a href="#_492">虚析构函数的定义和使用</a></li><li><a href="#_527">虚析构函数的必要性</a></li></ul>
</li></ul>
</li></ul>
</li></ul>
</li><li><a href="#_567">应用实例</a></li></ul>
</div>
<p></p>
<hr/>
<h1><a id="_7"></a>前言</h1>
<h2><a id="_8"></a>继承性反映的是类与类之间的层次关系，多态性则是考虑这种层次关系以及类自身特定成员函数之间的关系来解决行为的再抽象问题。多态性有两种表现形式一种是不同的对象在收到相同的消息时，产生不同的动作，主要通过虚函数来实现；另一种是同一对象收到相同的消息却产生不同的函数调用，主要通过函数重载来实现。本章将讨论多态性的主要内容：虚函数和动态联编;</h2>
<h1><a id="_11"></a>一、静态联编与动态联编</h1>
<p>多态性就是同一符号或名字在不同情况下具有不同解释的现象，既是指同一个函数的多种形态。c++可以支持两种多态性，编译时的多态性和运行时的多态性。<br/> 对一个函数的调用，要在编译时或在运行时确定将其<br/> 连接上相应的函数体的代码，这一过程称为函数联编（简称联编）。c++中两种联编形式：静态联编和动态联编。</p>
<h2><a id="_15"></a>静态联编</h2>
<pre><code>  静态联编是指在程序编译连接阶段进行的联编。编译器根据源代码调用固定的函数标识符，然后由连接器接管这些标识符，并用物理地址代替他们。这种联编又被称为早期联编，应为这种联编工作是在程序运行之前完成的。
  静态联编所支持的多态性称为编译时的多态性，当调用重载函数时，编译器可以根据调用时所使用的实参在编译时就确定下来应调用哪个函数。下面来看在层次关系中一个静态联编的例子。
</code></pre>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Figure</span>         <span class="token comment">//定义基类;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Figure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>           <span class="token comment">//定义派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Circle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> R <span class="token operator">=</span> myr<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> PI <span class="token operator">*</span> R <span class="token operator">*</span> R<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">double</span> R<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>   <span class="token comment">//定义派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myl<span class="token punctuation">,</span> <span class="token keyword">double</span> myw<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> L <span class="token operator">=</span> myl<span class="token punctuation">;</span> W <span class="token operator">=</span> myw<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> L <span class="token operator">*</span> W<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> L<span class="token punctuation">,</span> W<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Figure fig<span class="token punctuation">;</span>                <span class="token comment">//基类Figure对象;</span>
	<span class="token keyword">double</span> area<span class="token punctuation">;</span>
	area <span class="token operator">=</span> fig<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of figure is"</span> <span class="token operator">&lt;&lt;</span>area<span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Circle <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//派生类Circle对象;</span>
	area <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Circle is"</span> <span class="token operator">&lt;&lt;</span> area <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Rectangle <span class="token function">rec</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	area <span class="token operator">=</span> rec<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Rectangle is"</span> <span class="token operator">&lt;&lt;</span> area <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>上面的程序我们可以看出，在静态联编中，其实就是对重载函数的使用。定义不同的对象，通过对象来引用不同的函数从而实现我们要实现的功能。<br/> 静态联编的最大优点就是速度快，运行时的开销仅仅是传递参数，执行函数调用，清除等。不过，程序员必预测在每一种情况下所有的函数调用时，将要使用那些对象。这样，不仅有局限性，有时也是不可能实现的。<br/> 下面的程序就会说明这种情况：</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Figure</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Figure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>             <span class="token comment">//定义派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Circle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> R <span class="token operator">=</span> myr<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> PI<span class="token operator">*</span>R<span class="token operator">*</span>R<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">double</span> R<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>               <span class="token comment">//定义派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>                               
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myl<span class="token punctuation">,</span> <span class="token keyword">double</span> myw<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> L <span class="token operator">=</span> myl<span class="token punctuation">,</span> W <span class="token operator">=</span> myw<span class="token punctuation">;</span> <span class="token punctuation">}</span>
		<span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> L <span class="token operator">*</span> W<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> L<span class="token punctuation">,</span> W<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span>Figure <span class="token operator">&amp;</span>p<span class="token punctuation">)</span>         <span class="token comment">//形参为基类的引用;</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Figure fig<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of figure is"</span><span class="token punctuation">;</span>
	<span class="token function">func</span><span class="token punctuation">(</span>fig<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Circle <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//Circle派生类对象;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Circle is"</span><span class="token punctuation">;</span>
	<span class="token function">func</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Rectangle <span class="token function">rec</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Rectangle is"</span><span class="token punctuation">;</span>
	<span class="token function">func</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/88b68aad4b3a481882991d410cde17f6.png"/><br/> 上面的程序没有报错，但是结果正确，那是为什么？<br/> 在编译时，编译器将函数中的形参p所执行的area（）操作联编到Figure类的area（）上，这样访问的知识从基类继承来的成员。<br/> 那有没有什么方法来改变这种局限性喃？</p>
<h2><a id="_114"></a>动态联编</h2>
<p>动态联编是指在程序运行时进行的联编。只有向具有多态性的函数传递一个实际对象的时候，该函数才能与多种可能的函数中的一种来联系起来。这种联编又被称为晚期联编。<br/> 动态联编所支持的多态性被称为运行时多态性。在程序代码中要知名某个成员函数具有多态性需要进行动态联编，且需要关键字virtual来标记。这种用virtual关键字标记的函数称为虚函数.</p>
<table><thead><tr><th>动态联编的优点</th><th>动态联编的缺点</th></tr></thead><tbody><tr><td>增强了编程灵活性，问题抽象性和程序易维护性</td><td>函数调用顺序慢</td></tr></tbody></table>
<h2><a id="_120"></a>虚函数</h2>
<h4><a id="_121"></a>虚函数的作用</h4>
<p>虚函数是一个成员函数，该成员函在基类内部声明并且被派生类重新定义。为了创建虚函数，应在基类中该函数生命的前面加上关键字virtual。<br/> virtual&lt;返回值类型&gt;&lt;函数名&gt;(&lt;形式参数&gt;)<br/> {<!-- --><br/> 《函数体》<br/> }<br/> 如果某类中一个成员函数被说明为虚函数，这便意味着该成员函数在派生类中可能存在不同的实现方式。当继承包含虚函数的类时，派生类将重新定义该虚函数衣服和自身的需要。从本质上讲，虚函数实现了“相同界面，多种实现”的理念。而这种理念时运行时的多态性的基础，既是动态联编的基础。<br/> 动态联编需要满足的条件：<br/> （1）.类之间满足类型兼容规则;<br/> （2）.要声明虚函数；<br/> （3）.要由成员函数来调用或者是通过指针，引用来访问虚函数。</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Figure</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Figure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> <span class="token number">0.0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>        <span class="token comment">//定义为虚函数;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>                          <span class="token comment">//定义派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>                               
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Circle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> R <span class="token operator">=</span> myr<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> PI <span class="token operator">*</span> R <span class="token operator">*</span> R<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">double</span> R<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span>           <span class="token comment">//定义派生类，公有继承方式</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myl<span class="token punctuation">,</span> <span class="token keyword">double</span> myw<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> L <span class="token operator">=</span> myl<span class="token punctuation">,</span> W <span class="token operator">=</span> myw<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> L <span class="token operator">*</span> W<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> L <span class="token punctuation">,</span> W<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span>Figure<span class="token operator">&amp;</span> p<span class="token punctuation">)</span>                 <span class="token comment">//形参为积基类的引用;</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Figure fig<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Figure of area is"</span><span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>fig<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Circle <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Circle is"</span><span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Rectangle <span class="token function">rec</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of Retangle is"</span><span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d4805936eb1e4fcdb4132ae5edc588e5.png"/><br/> 这个时候我们发现，答案正确了。看到这里，有没有一种熟悉的感觉，和我们前面学的虚基是不是相似。所以这里我们以可以理解为动态联编之所以能够不断地联编，就是因为成员函数产生了副本。</p>
<h3><a id="_180"></a>虚函数与一般重载函数的区别</h3>
<p>乍一看，上面的程序，虚函数类似于重载函数。但它不属于重载函数，虚函数与一般的重载函数的区别：</p>
<table><thead><tr><th>虚函数</th><th>重载函数</th></tr></thead><tbody><tr><td>虚函数不仅要求函数名相同，而且要求函数的签名，返回类型也相同。也就是说函数原型必须完全相同，而且虚函数的特性必须是体现在基类和派生类的类层次结构中</td><td>重载函数只要求函数有相同的函数名，并且重载函数 是在相同作用域定义的名字相同的不同函数</td></tr><tr><td>虚函数只能是非静态成员函数</td><td>重载函数可以是成员函数或友元函数</td></tr><tr><td>构造函数不能定义为虚函数，析构函数能定义为虚函数</td><td>构造函数可以重载，析构函数不可以</td></tr><tr><td>虚函数是根据对象来调用的</td><td>重载函数调用是以传递参数 序列的差别 来调用</td></tr><tr><td>虚函数是在运行时联编</td><td>重载函数是在编译时联编</td></tr></tbody></table>
<h3><a id="_189"></a>继承虚属性</h3>
<p>基类中说明的虚函数具有自动向下传给他的派生类的性质。不管经历多少派生类层，所有界面相同的函数都熬吃虚特性。因为派生类也是基类。<br/> 在派生类中重新定义虚函数时，要求与基类中说明的虚函数原型完全相同，这时对派生类的虚函数中virtual说明可以省略，但是为了提高程序的可读性。为了区分重载函数，而把一个派生类中重定义基类的虚函数称为覆盖。<br/> 示例：</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>          <span class="token comment">//虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span>          <span class="token comment">//派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
 <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>                     <span class="token comment">//没有使用virtual关键字，但是依旧为虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
	 cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass class"</span><span class="token punctuation">;</span>
	 <span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span>Base<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"x="</span> <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Base bc<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>bc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Subclass be<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>be<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b4356eef2ee24bb9971ef9ce9d5dc10b.png"/><br/> 下面我们来分析一下虚函数的错误使用</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>          <span class="token comment">//虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span>          <span class="token comment">//派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
 <span class="token keyword">virtual</span> <span class="token keyword">float</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>                     <span class="token comment">//函数返回类型不同</span>
	<span class="token punctuation">{<!-- --></span>
	 cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass class"</span><span class="token punctuation">;</span>
	 <span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span>Base<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"x="</span> <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Base bc<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>bc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Subclass be<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>be<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/aa3431a021254543a0d1a7b87bb9a383.png"/><br/> 这里派生类中的虚函数，仅仅只是使用了不同的返回类型，但是就报错了，这是用为在c++中，只靠返回类型不同的信息，进行函数匹配是模糊的。</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>          <span class="token comment">//虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span>          <span class="token comment">//派生类，公有继承</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
 <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">)</span>                     <span class="token comment">//函数形参不同</span>
	<span class="token punctuation">{<!-- --></span>
	 cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass class"</span><span class="token punctuation">;</span>
	 <span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span>Base<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"x="</span> <span class="token operator">&lt;&lt;</span> x<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Base bc<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>bc<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Subclass be<span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>be<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>如果派生类与基类的虚函数仅函数名相同，其他不同，则c++认为是重定义函数，是隐藏的，丢失了虚特性。<br/> 一个类中的虚函数说明只对派生类中重定义的函数有影响，对他的基类并没有影响。</p>
<h6><a id="_305"></a>示例虚函数对他的基类的函数没有影响</h6>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>             <span class="token comment">//不是虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>              <span class="token comment">//虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass2</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Subclass</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span>                <span class="token comment">//自动成为虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Baseclass2 class"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> x<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Subclass2 sc2<span class="token punctuation">;</span>
	Base<span class="token operator">&amp;</span> bc <span class="token operator">=</span> sc2<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"x="</span> <span class="token operator">&lt;&lt;</span> bc<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	Subclass<span class="token operator">&amp;</span> sc <span class="token operator">=</span> sc2<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"x="</span> <span class="token operator">&lt;&lt;</span> sc<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/fe5418727bbd40a9a1e10b5dfeff3e63.png"/><br/> 从结果看出，func（）的操作贝莱你白难道Subclasses类中，显然进行的是动态联编。</p>
<h3><a id="_349"></a>成员函数中调用虚函数</h3>
<p>一个基类或派生类的成员函数中可以直接调用该类等级中的虚函数;<br/> <img alt="" src="image\5d868835744f4d5d87f03b02a3f601f3.png"/></p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">//虚函数</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Tis is Base class"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>     <span class="token comment">//调用了虚函数；</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//一般类中的成员都是通过对象来调用，但是这里用虚函数就可以，除了虚函数，还有就是使用静态static关键字，表明他已经被被分配内存；</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass func1()"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Subclass sc<span class="token punctuation">;</span>
	sc<span class="token punctuation">.</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre>
<p>上面的例子中，我们可以得出，在满足公有继承的情况下，成员函数中调用虚函数使用的是动态联编；</p>
<h3><a id="_384"></a>构造函数和析构函数中调用虚函数</h3>
<p>在构造函数和析构函数中调用虚函数时，采用静态联编，即它们所调用的虚函数是自己的类定义的函数。如果在自己的类中没有实现这个函数，则调用的时基类中虚函数，但绝不是任何在派生类中重新定义的虚函数。这是因为在建立派生类的对象时，它所包含的基类成员在派生类中定义的成员建立之前被建立。在对象撤销时，该对象所包含的在派生类中定义的成员要先与基类成员的撤销。<br/> 示例代码：</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>       <span class="token comment">//构造函数调用虚函数，静态联编;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">//虚函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base func1()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Base func2()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>     <span class="token comment">//析构函数调用虚函数，静态联编;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">fnc1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass func1()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"This is Subclass func2()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Subclass sc<span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Exit main"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/66e0eaea07be44e6ad659cf248f23ad4.png"/><br/> 上面的程序中，我们定义了一个派生类对象，派生类中没有构造函数，所以调用了基类中的构造函数，基类中的构造函数调用了它自身定义的虚函数，这里是静态联编。</p>
<h3><a id="_427"></a>纯虚函数和抽象类</h3>
<p>当虚函数没有被派生类重新定义时，将使用基类中的虚函数。然而基类常用来表示一些抽象的概念，基类中没有有意义的虚函数定义。另外，在某些情况下，需要一个虚函数被所有派生类覆盖。为了处理上述两种情况，可以将虚函数定义为纯虚函数，相应的类就变成了抽象类。</p>
<h5><a id="_429"></a>纯虚函数</h5>
<p>如果不能在基类中给出有意义的虚函数的实现，但又必须让基类为派生类提供一个公共界面函数。这时可以将它说明为纯虚函数，留给派生类去实现，说明纯虚函数的格式：<br/> virtual 返回类型 函数名（参数）=0；<br/> 纯虚函数的定义是在虚函数定义的基础上再让函数等于0，这只是表示纯虚函数的形式，并不是说他的返回值为0；<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5c3903102e6f4775aeecd312b7759bbc.png"/></p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">const</span> <span class="token keyword">double</span> PI <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Figure</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Figure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//定义为纯虚函数;如果不是纯虚函数，就要返回一个double值;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Circle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> R <span class="token operator">=</span> myr<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> PI <span class="token operator">*</span> R <span class="token operator">*</span> R<span class="token punctuation">;</span> <span class="token punctuation">}</span>         <span class="token comment">//定义为虚函数;</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">double</span> R<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Figure</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Rectangle</span><span class="token punctuation">(</span><span class="token keyword">double</span> myl<span class="token punctuation">,</span> <span class="token keyword">double</span> myw<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> L <span class="token operator">=</span> myl<span class="token punctuation">;</span> W <span class="token operator">=</span> myw<span class="token punctuation">;</span> <span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">double</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> L <span class="token operator">*</span> W<span class="token punctuation">;</span> <span class="token punctuation">}</span>   <span class="token comment">//定义为虚函数;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">double</span> L <span class="token punctuation">,</span>W<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span>Figure<span class="token operator">&amp;</span> p<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Circle <span class="token function">c</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of cicle is"</span><span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Rectangle <span class="token function">rec</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Area of rectangle is"</span><span class="token punctuation">;</span>
	<span class="token function">fun</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>上面的代码中，Figure中的虚函数仅仅起到为派生类提供接口的作用。</p>
<h5><a id="_479"></a>抽象类</h5>
<p>一个类可以说明多个纯虚函数，对于包含有纯虚函数的类被成为抽象类。一个抽象类只能作为基类来派生新类，不能说明抽象类的对象。应为抽象类中有一个或者多个函数没有被定义，也不能用作参数类型，函数返回类型或显示类型类型。但剋以说明指向抽象类对象的指针（和引用），以支持运行时的多态性；</p>
<pre><code class="prism language-cpp">例如：
Figure fig<span class="token punctuation">;</span> <span class="token comment">//错误;</span>
Figure <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//错误;</span>
<span class="token keyword">int</span> <span class="token function">func2</span><span class="token punctuation">(</span>Figure<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//错误;</span>
<span class="token keyword">void</span> func<span class="token operator">&amp;</span><span class="token punctuation">(</span>Figure<span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//正确;</span>
</code></pre>
<h3><a id="_489"></a>虚析构函数</h3>
<p>一个类中经所有的成员函数总是有益的，它除了会增加一些资源开销，没有其他坏处。但设置虚函数有许多限制，一般只有非静态的成员函数才可以说明为虚函数。除此之外，析构函数也可以是虚函数，并且最好在动态联编的时候说明为虚函数；</p>
<h5><a id="_492"></a>虚析构函数的定义和使用</h5>
<p>c++目前不支持构造虚构造函数。由于析构函数不能有参数，所以一个类只能有一个虚析构函数；</p>
<p>格式：<br/> virtual ~&lt;类名&gt;（）<br/> 入宫一个类的析构函数是虚函数，那么，由它派生而来的所有子类的析构函数也是虚函数。如果析构函数是虚函数，则这个调用是动态联编;<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9eacf8a73feb45b69fb45ee5b3992d34.png"/></p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base destructor is called"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Subclass</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Subclass destructor is called"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Base<span class="token operator">*</span> b <span class="token operator">=</span> <span class="token keyword">new</span> Subclass<span class="token punctuation">;</span>
	<span class="token keyword">delete</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>上面的程序中，我们构造了虚析构函数，那么我们构造虚析构函数的意义又在哪里？</p>
<h5><a id="_527"></a>虚析构函数的必要性</h5>
<p>如果我们在类中定义了一个虚函数，我们在定义了一个对象后，如果要删除这个对象（delete），那么就会自动调用析构函数，也就是说，为了满足能够删除所有的成员函数，也就是构造虚析构函数；</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Base destructor is called"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Subclass</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">int</span><span class="token operator">*</span> ptr<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Subclass</span><span class="token double-colon punctuation">::</span><span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	ptr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Subclass</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Subclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Subclass destructor is called"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">delete</span> ptr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Base<span class="token operator">*</span> b <span class="token operator">=</span> <span class="token keyword">new</span> Subclass<span class="token punctuation">;</span>
	<span class="token keyword">delete</span> b<span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/973ac7861bfc420c9558019aa49d1eed.png"/><br/> 上面的程序我们会发现，用delete删除对象的时候，只调用了基类的析构函数，尾调用派生类的析构函数，，这造成ptr的内存未得到释放，现在我们将~Base（）改为虚析构函数；看它的运行：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/cc653486947c455b9ebdb94fcfbad44d.png"/><br/> 为什么把析构函数改为虚函数就会成功？这是因为将析构函数改为虚函数后，在撤销对象的时候，会先执行派生类的析构函数，由于这里采用了动态联编，所以才会得到这个结果；</p>
<h1><a id="_567"></a>应用实例</h1>
<p>编写一个小型公司的工资管理程序，该公司主要有4类人员：经理。兼职技术人员，销售人员，销售经理。经理固定月薪8000，尖子技术人员100元每小时，销售员为当月销售额的4%，销售经理保底工资为5000，加上部门销售额的5%；<br/> 代码实现：</p>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token comment">//基类Employee的定义</span>
<span class="token keyword">class</span> <span class="token class-name">Employee</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">int</span> no<span class="token punctuation">;</span>  <span class="token comment">//编号;     </span>
	string name<span class="token punctuation">;</span> <span class="token comment">//姓名</span>
	<span class="token keyword">float</span> salary<span class="token punctuation">;</span>  <span class="token comment">//月星总额</span>
	<span class="token keyword">static</span> <span class="token keyword">int</span> totalno<span class="token punctuation">;</span>  <span class="token comment">//编号最大值</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		no <span class="token operator">=</span> totalno<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token comment">//输入员工号加1;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"职工姓名："</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> name<span class="token punctuation">;</span>
		salary <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>   <span class="token comment">//总额赋值为0；</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>   <span class="token comment">//计算月薪函数;</span>
	<span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">//输出员工信息函数;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//兼职技术人员类Technician的定义</span>
<span class="token keyword">class</span> <span class="token class-name">Technician</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Employee</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
	<span class="token keyword">float</span> hourlyrate<span class="token punctuation">;</span>    <span class="token comment">//每小时酬金;</span>
	<span class="token keyword">int</span> workhours<span class="token punctuation">;</span>   <span class="token comment">//当月工作时数;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Technician</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//构造函数;</span>
	<span class="token punctuation">{<!-- --></span>
		hourlyrate <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>         <span class="token comment">//每小时酬薪100；</span>
		cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"本月工作时间:"</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> workhours<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		salary <span class="token operator">=</span> hourlyrate <span class="token operator">*</span> workhours<span class="token punctuation">;</span>    <span class="token comment">//计算月薪，按小时计算;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"兼职技术员："</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">",编号："</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> no <span class="token operator">&lt;&lt;</span> <span class="token string">",本月工资："</span> <span class="token operator">&lt;&lt;</span> salary <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//销售人员类Salesman的定义</span>
<span class="token keyword">class</span> <span class="token class-name">Salesman</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Employee</span>         <span class="token comment">//派生类，销售员</span></span><span class="token punctuation">;</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">float</span> commrate<span class="token punctuation">;</span>     <span class="token comment">//按销售额提取酬金的百分比;</span>
	<span class="token keyword">float</span> sales<span class="token punctuation">;</span>         <span class="token comment">//当月销售额;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Salesman</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">//构造函数;</span>
	<span class="token punctuation">{<!-- --></span>
		commrate <span class="token operator">=</span> <span class="token number">0.04f</span><span class="token punctuation">;</span>     <span class="token comment">//销售提成比例为4%；</span>
		cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"本月销售额："</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> sales<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment">//计算销售员月薪函数;</span>
	<span class="token punctuation">{<!-- --></span>
		salary <span class="token operator">=</span> sales <span class="token operator">*</span> commrate<span class="token punctuation">;</span>     <span class="token comment">//月薪=本月销售额*销售提成比例;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//显示销售员信息函数;</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"销售员："</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">",编号："</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> no <span class="token operator">&lt;&lt;</span> <span class="token string">",本月工资："</span> <span class="token operator">&lt;&lt;</span> salary <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Manager</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Employee</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
	<span class="token keyword">float</span> monthlypay<span class="token punctuation">;</span>      <span class="token comment">//固定月薪;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		monthlypay <span class="token operator">=</span> <span class="token number">8000</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token comment">//计算经理月薪总数;</span>
	<span class="token punctuation">{<!-- --></span>
		salary <span class="token operator">=</span> monthlypay<span class="token punctuation">;</span>          <span class="token comment">//月薪总额;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"经理："</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"编号"</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> no <span class="token operator">&lt;&lt;</span> <span class="token string">",本月工资："</span> <span class="token operator">&lt;&lt;</span> salary <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//销售经理类Salesmanager的定义：</span>
<span class="token keyword">class</span> <span class="token class-name">Salesmanager</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Manager</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Salesman</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">Salesmanager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		monthlypay <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">;</span>
		commrate <span class="token operator">=</span> <span class="token number">0.005f</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">"所有部门月销售量:"</span><span class="token punctuation">;</span>
		cin <span class="token operator">&gt;&gt;</span> sales<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		salary <span class="token operator">=</span> monthlypay <span class="token operator">+</span> commrate <span class="token operator">*</span> sales<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"销售经理："</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">",编号："</span> <span class="token operator">&lt;&lt;</span> no <span class="token operator">&lt;&lt;</span> <span class="token string">",本月工资："</span> <span class="token operator">&lt;&lt;</span> salary <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Employee<span class="token double-colon punctuation">::</span>totalno <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
<span class="token comment">//主函数;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	Manager m1<span class="token punctuation">;</span>
	Technician t1<span class="token punctuation">;</span>
	Salesman s1<span class="token punctuation">;</span>
	Salesmanager sm1<span class="token punctuation">;</span>
	Employee<span class="token operator">*</span> em<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token operator">&amp;</span>m1<span class="token punctuation">,</span><span class="token operator">&amp;</span>t1<span class="token punctuation">,</span><span class="token operator">&amp;</span>s1<span class="token punctuation">,</span><span class="token operator">&amp;</span>sm1 <span class="token punctuation">}</span><span class="token punctuation">;</span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token string">"上述人员的基本信息："</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		em<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		em<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/59504be5b21144f19b41e22aba494128.png"/><br/> 上面的程序就是一个简单的应用，公司的工资管理系统。c++的灵魂就是动态联编，所以掌握好动态联编是学好c++的基础。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e8c48124533c43e19194120983494c8a.png"/></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>