<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-tomorrow-night" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h2><a id="1__0"></a>1 介绍</h2>
<p>批处理（Batch），也称为批处理脚本，批处理就是某对象进行批量的处理，通常被认为是一种简化的脚本语言。</p>
<p>批处理脚本应用于DOS和Windows文件中。</p>
<p>扩展名：bat或cmd</p>
<h2><a id="2__7"></a>2 基础命令</h2>
<h3><a id="21_echopause_9"></a>2.1 echo、@、pause</h3>
<p><code>echo [on|off] [message]</code></p>
<p><code>on|off</code>：指定是否允许命令回显。<br/> <code>message</code>：指定让MS-DOS在屏幕上显示的正文</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">echo</span> hello
pause
</code></pre>
<p><code>@(命令行回显屏蔽符)</code>：表示将不在DOS中显示 <code>echo off</code>命令<br/> <code>echo off</code>：表示后续命令在DOS中不显示，只显示结果<br/> <code>pause</code>：表示脚本执行完成后，不立即关闭DOS窗口，而是提示“请按任意键继续…”。当用户按了任意键后关闭窗口</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
rem 暂停，用户下键盘继续处理
<span class="token function">echo</span> hello &amp;pause &gt; nul
<span class="token function">echo</span> 666
pause
<span class="token function">echo</span> 777
</code></pre>
<h3><a id="22__35"></a>2.2 批处理注释</h3>
<p><code>格式</code>：<code>REM [string]</code><br/> <code>格式</code>：<code>::</code>（两个冒号）</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
rem 这是第一个注释
:: 这是第二个注释
<span class="token function">echo</span> hello
pause
</code></pre>
<h3><a id="23_title__46"></a>2.3 title 标题</h3>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
title 有勇气的牛排
<span class="token function">echo</span> 666
pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\c07b4551b2bf41a1bf6f27b99e8c9713.png"/></p>
<h3><a id="24_color_55"></a>2.4 color</h3>
<p>帮助：<code>color help</code></p>
<pre><code class="prism language-powershell">字体颜色		   背景色
0 = 黑色       8 = 灰色
1 = 蓝色       9 = 淡蓝色
2 = 绿色       A = 淡绿色
3 = 浅绿色     B = 淡浅绿色
4 = 红色       C = 淡红色
5 = 紫色       D = 淡紫色
6 = 黄色       E = 淡黄色
7 = 白色       F = 亮白色
</code></pre>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
title courageSteak
rem 颜色设置
color f2
<span class="token function">echo</span> 666
pause
</code></pre>
<h3><a id="25_mode_79"></a>2.5 mode</h3>
<p>配置设备</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
title courageSteak
rem 这里设置命令行窗口大小
mode con cols=113 lines=15 &amp; color 9f
color f2
<span class="token function">echo</span> 666
pause
</code></pre>
<h3><a id="26_____90"></a>2.6 重定向符 <code>&gt;</code> 和 <code>&gt;&gt;</code></h3>
<p><code>重定向符</code>：用于将某条命令的输出写到指定的地方，如写入到文件、nul（空设备）。</p>
<p><code>&gt;</code>：会覆盖文件中已有的内容。<br/> <code>&gt;&gt;</code>：与 <code>&gt;</code> 不同的是，<code>&gt;&gt;</code> 会将结果直接追加到指定文件的后面。</p>
<p>需求：将ping命令的输出信息写到ping.txt文件</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
ping www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com &gt; ping<span class="token punctuation">.</span>txt
<span class="token function">echo</span> finished
pause
</code></pre>
<h3><a id="27__103"></a>2.7 屏蔽批处理错误</h3>
<p><code>errorlevel</code><br/> 需求：加入使用copy拷贝文件到指定目录</p>
<pre><code class="prism language-powershell">在这里插入代码片
</code></pre>
<h3><a id="28__110"></a>2.8 接收文件参数</h3>
<p>单个参数</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">echo</span> param0=<span class="token operator">%</span>0
<span class="token function">echo</span> param1=<span class="token operator">%</span>1
<span class="token function">echo</span> param2=<span class="token operator">%</span>2
<span class="token function">echo</span> param3=<span class="token operator">%</span>3
<span class="token function">echo</span> param4=<span class="token operator">%</span>4
<span class="token function">echo</span> param5=<span class="token operator">%</span>5
pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\7d17062d24c7415c826dcb82c604d94f.png"/><br/> 使用shift命令接收多个参数</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">echo</span> <span class="token operator">%</span>1 <span class="token operator">%</span>2 <span class="token operator">%</span>3
shift <span class="token operator">/</span>0
<span class="token function">echo</span> <span class="token operator">%</span>1 <span class="token operator">%</span>2 <span class="token operator">%</span>3
shift <span class="token operator">/</span>0
<span class="token function">echo</span> <span class="token operator">%</span>1 <span class="token operator">%</span>2 <span class="token operator">%</span>3
pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\ce9c8dad331f45d2abc65aa3ae92ddd0.png"/></p>
<h3><a id="29_set__135"></a>2.9 set 命令</h3>
<h3><a id="291_set__136"></a>2.9.1 set 基础用法</h3>
<p><code>描述</code>：用来显示、设置或删除 cmd 环境变量。</p>
<p><code>语法</code>：<code>set [variable=[string]]</code></p>
<ul><li>variable：指定环境变量名</li><li>string：指定变量值</li></ul>
<p>实例：显示当前java环境变量</p>
<pre><code class="prism language-powershell"><span class="token function">set</span> java_home1
</code></pre>
<p><img alt="在这里插入图片描述" src="image\c3cbfd1a22844b4e8096777877bec738.png"/></p>
<h3><a id="292_set_a_150"></a>2.9.2 set扩展 /a</h3>
<p>如果使用<code>任何逻辑</code>或<code>取余</code>操作符，则需要将表达式字符串用<code>引号括起来</code></p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
rem 使用 <span class="token operator">/</span>a 执行加法运算。
<span class="token function">set</span> <span class="token operator">/</span>a val=10+22
<span class="token function">echo</span> <span class="token operator">%</span>val%

rem 变量val+10=42
<span class="token function">set</span> <span class="token operator">/</span>a val2=<span class="token operator">%</span>val%<span class="token operator">+</span>10
<span class="token function">echo</span> <span class="token operator">%</span>val2%

rem 将16使用位移操作符，向右移动一位 等同于 除以2，val3=16/2=8
<span class="token function">set</span> <span class="token operator">/</span>a <span class="token string">"val3=16&gt;&gt;1"</span>
<span class="token function">echo</span> <span class="token operator">%</span>val3%

rem 使用分组符号提升加法的优先级 1+2+3<span class="token punctuation">)</span><span class="token operator">*</span>3=6*3=18
<span class="token function">set</span> <span class="token operator">/</span>a val4=<span class="token punctuation">(</span>1+2+3<span class="token punctuation">)</span><span class="token operator">*</span>3
<span class="token function">echo</span> <span class="token operator">%</span>val4%

rem 使用 <span class="token operator">%</span><span class="token operator">%</span> 进行取余运算
<span class="token function">set</span> <span class="token operator">/</span>a <span class="token string">"val5=5%%2"</span>
<span class="token function">echo</span> <span class="token operator">%</span>val5%

pause
</code></pre>
<p>如果一个变量没有被定义，其值默认为0</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> <span class="token operator">/</span>a val=tmp+2
<span class="token function">echo</span> <span class="token operator">%</span>val%
rem 输出：2

pause
</code></pre>
<h3><a id="293_set_p_188"></a>2.9.3 set扩展 /p</h3>
<p><code>描述</code>：用户输入</p>
<p><code>语法</code>：<code>set /P variateName=promptStrig</code></p>
<ul><li>variateName 为变量名</li><li>promptStrig 为提示字符串，将在 DOS 窗口中显示</li></ul>
<p><mark>实例：提示用户输入命令（此处win10测试未通过）</mark></p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> <span class="token operator">/</span>p username=username:
<span class="token function">echo</span> username：<span class="token operator">%</span>username%

pause
</code></pre>
<h3><a id="210_setlocalendlocal_207"></a>2.10 setlocal/endlocal命令</h3>
<p><code>定义</code>：用来定义个一个局部区域，这个局部区域中的环境变量任何变化都不会改变原先的环境变量。</p>
<p>实例：局部区域修改path</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> 重置前
<span class="token function">set</span> path

setlocal
<span class="token function">echo</span> 重置path
<span class="token function">set</span> path=E:\tools
<span class="token function">set</span> path
endlocal

<span class="token function">echo</span> 重置path后
<span class="token function">set</span> path

pause
</code></pre>
<h3><a id="211_shift__229"></a>2.11 shift 命令</h3>
<p><code>定义</code>：该命令用于更改普处理文件处理参数的方式，如指定处理参数的位置等。</p>
<p><code>帮助</code>：<code>shift /?</code></p>
<p>实例1：利用shift命令动态输出批处理执行时所输入的所有参数。</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

:round
<span class="token keyword">if</span> <span class="token string">"%1"</span>==<span class="token string">""</span> goto cmd1
<span class="token function">echo</span> 参数：<span class="token operator">%</span>1
shift
goto round

:cmd1
<span class="token function">echo</span> 没有获取到参数，结束脚本
goto <span class="token keyword">end</span>

:<span class="token keyword">end</span>

pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\ca609ed27c1247a9a23bdad1096247bb.png"/></p>
<h3><a id="212__dp0_256"></a>2.12 获取磁盘路径 %~dp0</h3>
<p>1、%cd%</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

rem 获取当前脚本所在路径
<span class="token function">set</span> basePath=<span class="token operator">%</span>cd%
<span class="token function">echo</span> <span class="token operator">%</span>basePath%

pause
</code></pre>
<p>2、%~dp0</p>
<p>该命令可以用来获取批处理文件的实际路径，与当前DOS环境所在的目录没有关系<br/> <code>d</code>：为 Drive 的缩写，即为驱动器，磁盘；<br/> <code>p</code>：为 Path 缩写，即为路径，目录；</p>
<p>不推荐使用 <code>cd</code> 命令，转到 <code>%~dp0</code>返回的目录<br/> 推荐使用： <code>cd /d %~dp0</code></p>
<h2><a id="3__276"></a>3 字符串操作</h2>
<h3><a id="31__277"></a>3.1 字符换截取操作</h3>
<p><code>语法</code>：<code>%variable:~n,m%</code></p>
<p>实例1：截取字符串</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> str=abcdefghijklmnopqrstuvwxyz0123456789
<span class="token function">echo</span> 原字符串
<span class="token function">echo</span> <span class="token operator">%</span>str%

rem abcde
<span class="token function">echo</span> 截取前5个字符
<span class="token function">echo</span> <span class="token operator">%</span>str:~0<span class="token punctuation">,</span>5%

rem fghijklmnopqrstuvwxyz0123456789
<span class="token function">echo</span> 截取第6个字符直到最后一个
<span class="token function">echo</span> <span class="token operator">%</span>str:~5%

rem 56789
<span class="token function">echo</span> 截取最后5个字符
<span class="token function">echo</span> <span class="token operator">%</span>str:~<span class="token operator">-</span>5%
<span class="token function">echo</span> <span class="token operator">%</span>str:~<span class="token operator">-</span>5<span class="token punctuation">,</span>5%

rem abcdefghijklmnopqrstuvwxyz01234
<span class="token function">echo</span> 截取第1个到倒数第6个字符
<span class="token function">echo</span> <span class="token operator">%</span>str:~0<span class="token punctuation">,</span><span class="token operator">-</span>5%

rem defgh
<span class="token function">echo</span> 从第4个字符开始，截取5个字符
<span class="token function">echo</span> <span class="token operator">%</span>str:~3<span class="token punctuation">,</span>5%

rem 34567
<span class="token function">echo</span> 从倒数第7个字符开始，截取5个字符
<span class="token function">echo</span> <span class="token operator">%</span>str:~<span class="token operator">-</span>7<span class="token punctuation">,</span>5%

pause
</code></pre>
<h3><a id="32__317"></a>3.2 字符串替换操作</h3>
<p>实例1：你真棒，替换为：你特别棒</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> str=你真棒
<span class="token function">echo</span> 替换前：<span class="token operator">%</span>str%
<span class="token function">echo</span> 替换后：<span class="token operator">%</span>str:真=特别<span class="token operator">%</span>

pause
</code></pre>
<p>实例2：利用字符串替换功能，实现查找字符串是否包含指定字符</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> str=hello<span class="token punctuation">,</span>whlcome to Earth<span class="token punctuation">.</span>
<span class="token function">echo</span> 原文：<span class="token operator">%</span>str%

rem 判断str变量中是否存在 the 字符串
<span class="token function">set</span> <span class="token string">"tmpStr=%str:the%"</span>
<span class="token function">echo</span> <span class="token operator">%</span>tmpStr%
<span class="token keyword">if</span> <span class="token string">"%str%"</span>==<span class="token string">"%tmpStr%"</span> <span class="token punctuation">(</span>
    <span class="token function">echo</span> 很抱歉！没有找到
<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>
    <span class="token function">echo</span> 存在字符串 “the”
<span class="token punctuation">)</span>

pause
</code></pre>
<h3><a id="33__347"></a>3.3 字符串合并操作</h3>
<p>将两个字符串合并到一起</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> str1=Hello
<span class="token function">set</span> str2=World

rem 直接输出合并后的字符串
<span class="token function">echo</span> <span class="token operator">%</span>str1%<span class="token operator">%</span>str2%

rem 将合并后的字符串放入 str 变量中
<span class="token function">set</span> str=<span class="token operator">%</span>str1%<span class="token operator">%</span>str2%
<span class="token function">echo</span> <span class="token operator">%</span>str%

pause
</code></pre>
<h2><a id="4_if__364"></a>4 if 语句</h2>
<p>if 语句是执行批处理程序的条件语句。语法为：</p>
<pre><code class="prism language-powershell"><span class="token keyword">if</span> <span class="token namespace">[not]</span> errorlevel num command
<span class="token keyword">if</span> <span class="token namespace">[not]</span> str1==str2 command
<span class="token keyword">if</span> <span class="token namespace">[not]</span> exist filename command

not:取反
errorlevel number:如果最后运行的程序返回一个等于或大于指定数字的退出代码，指定条件为 true。
string==string2：判断字符是否相等
exist filename：判断文件是否存在
</code></pre>
<h3><a id="41_if_377"></a>4.1 if</h3>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> <span class="token operator">/</span>p <span class="token function">pwd</span>=请输入密码：
<span class="token keyword">if</span> <span class="token string">"%pwd%"</span>==<span class="token string">"123456"</span> <span class="token function">echo</span> 密码正确
<span class="token keyword">if</span> not <span class="token string">"%pwd%"</span>==<span class="token string">"123456"</span> <span class="token function">echo</span> 密码错误：<span class="token operator">%</span><span class="token function">pwd</span><span class="token operator">%</span>

<span class="token function">set</span> file=C:\Users\admin\Desktop\批处理\test1<span class="token punctuation">.</span>bat
<span class="token keyword">if</span> exist <span class="token operator">%</span>file% <span class="token function">echo</span> <span class="token operator">%</span>file% 文件存在
<span class="token keyword">if</span> not exist <span class="token operator">%</span>file% <span class="token function">echo</span> <span class="token operator">%</span>file% 文件不存在
</code></pre>
<h3><a id="42_ifelse__389"></a>4.2 if-else: 注意括号旁边的空格</h3>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> <span class="token operator">/</span>p <span class="token function">pwd</span>=请输入密码：
<span class="token keyword">if</span> <span class="token string">"%pwd%"</span>==<span class="token string">"123"</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> 密码正确
<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> 密码错误：<span class="token operator">%</span><span class="token function">pwd</span><span class="token operator">%</span>
<span class="token punctuation">)</span>
</code></pre>
<h3><a id="43_ifelseifelse_401"></a>4.3 if-elseif-else</h3>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> <span class="token operator">/</span>p score=请输入成绩：
<span class="token keyword">if</span> <span class="token operator">%</span>score% lss 60 <span class="token punctuation">(</span>
	<span class="token function">echo</span> 未及格
<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token operator">%</span>score% lss 70 <span class="token punctuation">(</span>
	<span class="token function">echo</span> 及格
<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> 优秀
<span class="token punctuation">)</span>

</code></pre>
<h3><a id="44__417"></a>4.4 逻辑符</h3>
<ul><li>EQU - 等于</li><li>NEQ - 不等于</li><li>LSS - 小于</li><li>LEQ - 小于或等于</li><li>GTR - 大于</li><li>GEQ - 大于或等于</li></ul>
<p><code>/I</code>：表示不区分大小写</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">if</span> <span class="token string">"A"</span> equ <span class="token string">"A"</span> <span class="token function">echo</span> A equ A
<span class="token keyword">if</span> <span class="token string">"A"</span> == <span class="token string">"A"</span> <span class="token function">echo</span> A==A
<span class="token keyword">if</span> <span class="token operator">/</span>I <span class="token string">"A"</span> equ <span class="token string">"a"</span> <span class="token function">echo</span> A equ a
<span class="token keyword">if</span> 100 equ 100 <span class="token function">echo</span> 100 equ 100
<span class="token keyword">if</span> 100 == 100 <span class="token function">echo</span> 100==100
</code></pre>
<p><code>DEFINED</code>：与exist一样，还能取环境变量</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">set</span> val=10
<span class="token keyword">if</span> defined val <span class="token function">echo</span> val=<span class="token operator">%</span>val%
<span class="token keyword">if</span> not defined val <span class="token function">echo</span> 没有定义 val 环境变量

<span class="token keyword">if</span> defined myPath <span class="token function">echo</span> val=<span class="token operator">%</span>myPath%
<span class="token keyword">if</span> not defined myPath <span class="token function">echo</span> 没有定义 myPath 环境变量
</code></pre>
<h2><a id="5_goto__449"></a>5 goto 语句</h2>
<p>实例：要求用户输入字母（A或B），然后根据用户输入的字母显示不同提示信息</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

setlocal
<span class="token function">set</span> <span class="token operator">/</span>p input=请输入字母A或B：
<span class="token keyword">if</span> <span class="token string">"%input%"</span>==<span class="token string">"A"</span> goto A
<span class="token keyword">if</span> <span class="token string">"%input%"</span>==<span class="token string">"B"</span> goto B
<span class="token function">echo</span> 您没有输入字母
goto endlocal

:A
<span class="token function">echo</span> 您输入的字母是A
goto <span class="token keyword">end</span>

:B
<span class="token function">echo</span> 您输入的字母是B
goto <span class="token keyword">end</span>

:<span class="token keyword">end</span>
</code></pre>
<ul><li>代码退出也可以用：<code>exit</code></li><li>名字不可以使用变量</li><li>如果有同名标签，则执行第一个</li></ul>
<h2><a id="6_for__477"></a>6 for 语句</h2>
<p>实例1：执行简单的for循环</p>
<pre><code class="prism language-powershell"><span class="token keyword">for</span> <span class="token operator">%</span>I in <span class="token punctuation">(</span>ABC<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span>I
</code></pre>
<p><img alt="在这里插入图片描述" src="image\c2066e62c18e4ae3b2ef0d4a3e4ca1db.png"/></p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

rem 输出指定的字符串
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>ABC<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
<span class="token punctuation">)</span>

<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>ABC<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
</code></pre>
<p>实例2：使用空格、分号、等号 分割</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>A B C<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>A<span class="token punctuation">;</span>B<span class="token punctuation">;</span>C<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>I in <span class="token punctuation">(</span>A=B=C<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>I
</code></pre>
<p><img alt="在这里插入图片描述" src="image\85891bb868024967af0c315c25a7d80f.png"/><br/> 实例3：打印批处理当前目录下所有文件名称、后缀为txt的文件的名称</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

rem 打印当前目录下面所有的文件名称
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token string">"%%i"</span>

rem 打印当前目录下面所有后缀为 txt 的文件名称
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token string">"%%i"</span>
</code></pre>
<h3><a id="61_for_D__519"></a>6.1 for /D 扩展</h3>
<p>for 语句默认匹配文件名。<br/> <code>/D</code>：与目录名匹配</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> 匹配当前目录下面的 文件名
<span class="token keyword">for</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token string">"%%i"</span>

<span class="token function">echo</span> <span class="token operator">/</span>D 匹配当前目录下面的 所有目录，不包含子目录
<span class="token keyword">for</span> <span class="token operator">/</span>D <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token string">"%%i"</span>

<span class="token function">echo</span> 搜索C盘下所有目录，不包括子目录
<span class="token keyword">for</span> <span class="token operator">/</span>D <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>C:<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token string">"%%i"</span>
</code></pre>
<h3><a id="62_for_R__535"></a>6.2 for /R 扩展</h3>
<p><code>/R</code>：递归进入目录，没有指定，则默认为当前目录树</p>
<p>实例1：搜索</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> 搜索当前目录下的所有文件
<span class="token keyword">for</span> <span class="token operator">/</span>r <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i

rem <span class="token function">echo</span> 输出D盘下所有目录
rem <span class="token keyword">for</span> <span class="token operator">/</span>r d:<span class="token operator">/</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i

<span class="token function">echo</span> 搜索C盘里所有扩展名为exe的文件
<span class="token keyword">for</span> <span class="token operator">/</span>r c:<span class="token operator">/</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">.</span>exe<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i

pause
</code></pre>
<p>实例2：搜索C盘是否有 notepad.exe可执行文件，如果存在则启动</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">for</span> <span class="token operator">/</span>r c:<span class="token operator">/</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>notepad<span class="token punctuation">.</span>exe<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token keyword">if</span> exist <span class="token operator">%</span><span class="token operator">%</span>i <span class="token punctuation">(</span>
		<span class="token function">echo</span> 找到了 notepad<span class="token punctuation">.</span>exe
		rem 启动
		<span class="token function">start</span> <span class="token operator">%</span><span class="token operator">%</span>i
		goto <span class="token keyword">end</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token function">echo</span> 没有找到

:<span class="token keyword">end</span>
</code></pre>
<h3><a id="63_for_L__570"></a>6.3 for /L 扩展</h3>
<p><code>/L</code>：表示以增量形式从start以每次增加 step，知道end的一个数字序列，如果start&lt;end，就会执行该命令，反之，停止。</p>
<p>实例：遍历1-5，步长为2</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">for</span> <span class="token operator">/</span>L <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>1<span class="token punctuation">,</span>2<span class="token punctuation">,</span>5<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i

pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\8c1eca43800c43fd94757d460bcd37fd.png"/><br/> 实例2：创建5~的序列</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">for</span> <span class="token operator">/</span>L <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>5<span class="token punctuation">,</span><span class="token operator">-</span>2<span class="token punctuation">,</span>1<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i

pause
</code></pre>
<p><img alt="在这里插入图片描述" src="image\af614a2a794d4fa1b8016aadc6cd488d.png"/><br/> 实例2：创建指定数量文件夹</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token keyword">for</span> <span class="token operator">/</span>L <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>1<span class="token punctuation">,</span>1<span class="token punctuation">,</span>5<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	md 文件<span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

pause
</code></pre>
<h3><a id="63_for_F__603"></a>6.3 for /F 扩展</h3>
<p><code>/F</code>：主要用来处理文件和一些命令的输出结果，还可以提取文本文件的内容。</p>
<pre><code class="prism language-powershell">name<span class="token comment">#age#score</span>
tom<span class="token comment">#28#95</span>
charles<span class="token punctuation">,</span>32<span class="token comment">#99</span>
</code></pre>
<pre><code class="prism language-powershell"><span class="token comment"># userinfo</span>
name  age   score
tom   28     95
charles   32     99
</code></pre>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> 普通提取名字
<span class="token keyword">for</span> <span class="token operator">/</span>F <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>test<span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

<span class="token function">echo</span> eol=c 省略指定字符开头的行
<span class="token keyword">for</span> <span class="token operator">/</span>F <span class="token string">"eol=#"</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>test<span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

<span class="token function">echo</span> skip=n 从文件头跳过的行数
<span class="token keyword">for</span> <span class="token operator">/</span>F <span class="token string">"skip=2"</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>test<span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

<span class="token function">echo</span> delims=<span class="token comment"># 使用#或,分割内容,如有空格放到最后</span>
<span class="token keyword">for</span> <span class="token operator">/</span>F <span class="token string">"delims=#|,| "</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>test<span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

pause
</code></pre>
<p><strong>tokens=x,y,m-n</strong></p>
<p><code>tokens=m</code>：表示提取第m列<br/> <code>tokens=m,n</code>：表示提取m列和n列<br/> <code>tokens=m-n</code>：表示提取m~n列<br/> <code>tokens=*</code>：忽略行首的所有空格<br/> <code>tokens=m*</code>：提取第m列以后的所有字符</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off


<span class="token keyword">for</span> <span class="token operator">/</span>F <span class="token string">"delims=#|, tokens=3"</span> <span class="token operator">%</span><span class="token operator">%</span>i in <span class="token punctuation">(</span>test<span class="token punctuation">.</span>txt<span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token punctuation">(</span>
	<span class="token function">echo</span> <span class="token operator">%</span><span class="token operator">%</span>i
<span class="token punctuation">)</span>

pause
</code></pre>
<h2><a id="7_call__663"></a>7 call 命令</h2>
<p>call命令不但可以在普处理中调用另一个批处理程序，而且还可以调用指定标号后面的所有命令（也可以称为子程序）</p>
<h3><a id="71__666"></a>7.1 调用外部程序</h3>
<p>实例：创建2个批处理文件，分别为test.bat和sub.bat。在test.bat中调用sub.bat，不传递任何参数。</p>
<p>test.bat</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> test<span class="token punctuation">.</span>bat
call sub<span class="token punctuation">.</span>bat a b
call C:\Users\admin\Desktop\批处理\sub<span class="token punctuation">.</span>bat c d

pause
</code></pre>
<p>sub.bat</p>
<pre><code class="prism language-powershell"><span class="token function">echo</span> off
<span class="token function">echo</span> sub<span class="token punctuation">.</span>bat
<span class="token function">echo</span> 第一个参数：<span class="token operator">%</span>1
<span class="token function">echo</span> 第二个参数：<span class="token operator">%</span>2
</code></pre>
<h3><a id="72__688"></a>7.2 调用子程序</h3>
<p>语法：<code>call :label [arguments]</code></p>
<ul><li><code>label</code>：用于指定调用的位置标签，类似goto</li><li><code>arguments</code>：对于以:label开头的批处理程序（或子程序），指定要传送给其新实例的命令行信息，包括命令行选项、文件名、批处理参数或者变量；</li></ul>
<p>实例：call sub标签</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

call :sub
goto <span class="token keyword">end</span>

:sub
<span class="token function">echo</span> sub label

:<span class="token keyword">end</span>
pause
</code></pre>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

call :sub 10
goto <span class="token keyword">end</span>

rem 子程序
:sub
<span class="token function">echo</span> arg0=<span class="token operator">%</span>0 arg1=<span class="token operator">%</span>1
goto :eof

:<span class="token keyword">end</span>
pause
</code></pre>
<ul><li>子程序一般放在最后，并且在主程序最后加上exit或者跳转语句，避免错误进入子程序。</li><li>子程序、主程序，变量均为全局变量</li></ul>
<h3><a id="73_n_726"></a>7.3 批处理(%n)增强</h3>
<ul><li>%~1 删除引号(")，扩展 %1</li><li>%~f1 将 %1 扩展到一个完全合格的路径名</li><li>%~d1 仅将 %1 扩展到一个驱动器号</li><li>%~p1 仅将 %1 扩展到一个路径</li><li>%~n1 仅将 %1 扩展到一个文件名</li><li>%~x1 仅将 %1 扩展到一个文件扩展名</li><li>%~s1 扩展的路径只含有短名</li><li>%~a1 将 %1 扩展到文件属性</li><li>%~t1 将 %1 扩展到文件的日期/时间</li><li>%~z1 将 %1 扩展到文件的大小</li><li>%~$PATH:1 查找列在 PATH 环境变量的目录，并将 %1 扩展到找到的第一个完全合格的名称。如果环境变量名未被定义，或者没有找到文件，此修改符会扩展到空字符串</li></ul>
<p>可以将增强符组合起来，可取得多重结果：</p>
<ul><li>%~dp1 只将 %1 扩展到驱动器号和路径</li><li>%~nx1 只将 %1 扩展到文件名和扩展名</li><li>%~dp$PATH:1 在列在 PATH 环境变量中的目录里查找 %1，并扩展到找到的第一个文件的驱动器号和路径。</li><li>%~ftza1 将 %1 扩展到类似 DIR 的输出行。</li></ul>
<p>实例：生成一个临时文件 tmp.txt，先将将目录 C:\windows设置为当前目录，调用子程序进行参数扩展；然后再恢复当前目录，调用子程序；观察参数扩展结果。</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">echo</span> 创建一个临时文件 &gt; tmp<span class="token punctuation">.</span>txt

rem 先保存当前目录，再将 c:\windows 设为当前目录
<span class="token function">pushd</span> c:\windows
call :sub tmp<span class="token punctuation">.</span>txt

rem 回复前次的当前目录
<span class="token function">popd</span>
call :sub tmp<span class="token punctuation">.</span>txt
pause

<span class="token function">del</span> tmp<span class="token punctuation">.</span>txt
goto :<span class="token keyword">end</span>

:sub
<span class="token function">echo</span> 删除引号：<span class="token operator">%</span>~1
<span class="token function">echo</span> 路径<span class="token operator">+</span>文件：<span class="token operator">%</span>~f1
<span class="token function">echo</span> 驱动器号：<span class="token operator">%</span>~d1
<span class="token function">echo</span> 仅路径：<span class="token operator">%</span>~p1
<span class="token function">echo</span> 文件名：<span class="token operator">%</span>~n1
<span class="token function">echo</span> 文件扩展名：<span class="token operator">%</span>~x1
<span class="token function">echo</span> 短名<span class="token punctuation">(</span>与f感觉相同<span class="token punctuation">)</span>：<span class="token operator">%</span>~s1
<span class="token function">echo</span> 文件属性<span class="token punctuation">(</span>异常<span class="token punctuation">)</span>：<span class="token operator">%</span>~a1
<span class="token function">echo</span> 文件的日期<span class="token operator">/</span>时间：<span class="token operator">%</span>~t1
<span class="token function">echo</span> 文件的大小：<span class="token operator">%</span>~z1
<span class="token function">echo</span> 驱动器号和路径：<span class="token operator">%</span>~dp1
<span class="token function">echo</span> 文件名和扩展名：<span class="token operator">%</span>~nx1
<span class="token function">echo</span> 类似 <span class="token function">DIR</span> 的输出行：<span class="token operator">%</span>~ftza1

goto :<span class="token keyword">end</span>

rem goto :eof
:<span class="token keyword">end</span>

pause
</code></pre>
<h2><a id="8_start__787"></a>8 start 命令</h2>
<p>帮助：<code>start /?</code></p>
<pre><code class="prism language-powershell"><span class="token function">START</span> <span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>D path<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>I<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>MIN<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>MAX<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>SEPARATE <span class="token punctuation">|</span> <span class="token operator">/</span>SHARED<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token operator">/</span>LOW <span class="token punctuation">|</span> <span class="token operator">/</span>NORMAL <span class="token punctuation">|</span> <span class="token operator">/</span>HIGH <span class="token punctuation">|</span> <span class="token operator">/</span>REALTIME <span class="token punctuation">|</span> <span class="token operator">/</span>ABOVENORMAL <span class="token punctuation">|</span> <span class="token operator">/</span>BELOWNORMAL<span class="token punctuation">]</span>
      <span class="token punctuation">[</span><span class="token operator">/</span>NODE &lt;NUMA node&gt;<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>AFFINITY &lt;hex affinity mask&gt;<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>WAIT<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">/</span>B<span class="token punctuation">]</span>
      <span class="token namespace">[command/program]</span> <span class="token namespace">[parameters]</span>

    <span class="token string">"title"</span>     在窗口标题栏中显示的标题。
    path        启动目录。
    B           启动应用程序，但不创建新窗口。
                应用程序已忽略 ^C 处理。除非应用程序
                启用 ^C 处理，否则 ^<span class="token keyword">Break</span> 是唯一可以中断
                该应用程序的方式。
    I           新的环境将是传递
                给 cmd<span class="token punctuation">.</span>exe 的原始环境，而不是当前环境。
</code></pre>
<p>可以写绝对路径</p>
<p>实例：启动 notepad.exe 记事本程序</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">start</span> notepad<span class="token punctuation">.</span>exe
</code></pre>
<p>实例：启动一个子脚本，并设置titile为“测试”</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">start</span> <span class="token string">"测试"</span> sub<span class="token punctuation">.</span>bat
</code></pre>
<p>实例：最小化/最大化 启动记事本</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
rem 最小化启动
<span class="token function">start</span> <span class="token operator">/</span>min notepad<span class="token punctuation">.</span>exe
rem 最大化启动
<span class="token function">start</span> <span class="token operator">/</span>max notepad<span class="token punctuation">.</span>exe
</code></pre>
<p>实例：检测 打开的记事本 是否关闭</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off

<span class="token function">start</span> <span class="token operator">/</span>wait notepad<span class="token punctuation">.</span>exe
<span class="token function">echo</span> 记事本被关闭
</code></pre>
<p>实例：打开指定网址</p>
<pre><code class="prism language-powershell">@<span class="token function">echo</span> off
<span class="token function">start</span> www<span class="token punctuation">.</span>couragesteak<span class="token punctuation">.</span>com
</code></pre>
<h2><a id="9_pushd__popd__844"></a>9 pushd 和 popd 命令</h2>
<p>定义：一般用于保存当前路径，并且切换到指定的新路径</p>
<p>语法：<code>pushd [path | ..]</code></p>
<p>path:指定要切换的路径</p>
<p>实例：通过dos窗口切换到D盘，然后恢复</p>
<pre><code class="prism language-powershell"><span class="token function">pushd</span> D:\
<span class="token function">popd</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="image\6748ffd1306641da8d1bfacf0f7e927b.png"/></p>
<p>参考地址：<br/> https://www.bilibili.com/video/BV16x411b7rW<br/> https://www.hxstrive.com/subject/windows_bat/111.htm</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>