<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p id="main-toc"><strong>目录</strong></p>
<p id="%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5EPPlus-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5EPPlus">一、导入EPPlus</a></p>
<p id="1.%E9%A6%96%E5%85%88%E5%9C%A8Unity%E4%B8%AD%E5%AF%BC%E5%85%A5EPPlus%E5%92%8CExcel-toc" style="margin-left:40px;"><a href="#1.%E9%A6%96%E5%85%88%E5%9C%A8Unity%E4%B8%AD%E5%AF%BC%E5%85%A5EPPlus%E5%92%8CExcel">1.首先在Unity中导入EPPlus和Excel</a></p>
<p id="2.%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC%EF%BC%8C%E5%BC%95%E5%85%A5%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4-toc" style="margin-left:40px;"><a href="#2.%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC%EF%BC%8C%E5%BC%95%E5%85%A5%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4">2.创建脚本，引入命名空间</a>​​​​​​​</p>
<p id="%E4%BA%8C%E3%80%81%E8%AF%BB%E5%8F%96EPPlus-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E8%AF%BB%E5%8F%96EPPlus">二、读取Excel</a></p>
<p id="1.%20%E8%8E%B7%E5%8F%96Excel%E4%BF%A1%E6%81%AF%E6%96%87%E4%BB%B6-toc" style="margin-left:40px;"><a href="#1.%20%E8%8E%B7%E5%8F%96Excel%E4%BF%A1%E6%81%AF%E6%96%87%E4%BB%B6">1. 获取Excel信息文件</a></p>
<p id="2.%E6%89%93%E5%BC%80Excel%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%89%93%E5%BC%80%E8%A1%A8%E6%A0%BC-toc" style="margin-left:40px;"><a href="#2.%E6%89%93%E5%BC%80Excel%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%89%93%E5%BC%80%E8%A1%A8%E6%A0%BC">2.打开Excel文件信息，打开表格</a></p>
<p id="3.%E9%9C%80%E8%A6%81%E6%89%93%E5%BC%80%E6%AD%A4Excel%E7%9A%84%E5%93%AA%E5%BC%A0%E8%A1%A8%E6%A0%BC-toc" style="margin-left:40px;"><a href="#3.%E9%9C%80%E8%A6%81%E6%89%93%E5%BC%80%E6%AD%A4Excel%E7%9A%84%E5%93%AA%E5%BC%A0%E8%A1%A8%E6%A0%BC">3.需要打开此Excel的哪张表格</a></p>
<p id="4.%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#4.%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE">4.读取数据</a></p>
<p id="5.%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C-toc" style="margin-left:40px;"><a href="#5.%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C">5.输出结果</a></p>
<p id="%C2%A06.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%C2%A06.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">6.完整代码</a></p>
<p id="%E4%B8%89%E3%80%81%E5%86%99%E5%85%A5Excel-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81%E5%86%99%E5%85%A5Excel">三、写入Excel</a></p>
<p id="1.%E4%B8%80%E4%BA%8C%E6%AD%A5%E5%92%8C%E8%AF%BB%E5%8F%96%E4%B8%80%E6%A0%B7-toc" style="margin-left:40px;"><a href="#1.%E4%B8%80%E4%BA%8C%E6%AD%A5%E5%92%8C%E8%AF%BB%E5%8F%96%E4%B8%80%E6%A0%B7">1.一二步和读取一样</a></p>
<p id="2.%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#2.%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE">2.写入数据</a></p>
<p id="3.%E5%86%99%E5%85%A5%E5%90%8E%E8%A1%A8%E6%A0%BC-toc" style="margin-left:40px;"><a href="#3.%E5%86%99%E5%85%A5%E5%90%8E%E8%A1%A8%E6%A0%BC">3.写入后表格</a></p>
<p id="%C2%A04.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81-toc" style="margin-left:40px;"><a href="#%C2%A04.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">4.完整代码</a></p>
<p id="4.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC-toc" style="margin-left:0px;"><a href="#4.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC">四.创建表格</a></p>
<p id="1.%E4%B8%80%E4%BA%8C%E6%AD%A5%E5%92%8C%E8%AF%BB%E5%8F%96%E4%B8%80%E6%A0%B7-toc" style="margin-left:40px;"><a href="#1.%E4%B8%80%E4%BA%8C%E6%AD%A5%E5%92%8C%E8%AF%BB%E5%8F%96%E4%B8%80%E6%A0%B7">1.一二步和读取一样</a></p>
<p id="2.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC-toc" style="margin-left:40px;"><a href="#2.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC">2.创建表格</a></p>
<p id="3.%E5%88%9B%E5%BB%BA%E5%A5%BD%E7%9A%84%E8%A1%A8%E6%A0%BC-toc" style="margin-left:40px;"><a href="#3.%E5%88%9B%E5%BB%BA%E5%A5%BD%E7%9A%84%E8%A1%A8%E6%A0%BC">3.创建好的表格</a></p>
<p id="%E4%BA%94%E3%80%81%E5%B8%B8%E7%94%A8API-toc" style="margin-left:0px;"><a href="#%E4%BA%94%E3%80%81%E5%B8%B8%E7%94%A8API">五、常用API</a></p>
<p id="1.%E5%AF%B9%E8%A1%A8%E6%A0%BC%E7%9A%84%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#1.%E5%AF%B9%E8%A1%A8%E6%A0%BC%E7%9A%84%E6%93%8D%E4%BD%9C">1.对表格的操作</a></p>
<p id="2.%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE-toc" style="margin-left:40px;"><a href="#2.%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE">2.处理数据</a></p>
<p id="3.%E5%AF%B9Excel%E7%9A%84%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#3.%E5%AF%B9Excel%E7%9A%84%E6%93%8D%E4%BD%9C">3.对Excel的操作</a></p>
<p id="%E5%85%AD.%E6%8F%90%E7%A4%BA-toc" style="margin-left:0px;"><a href="#%E5%85%AD.%E6%8F%90%E7%A4%BA">六、提示</a></p>
<hr id="hr-toc"/>
<p></p>
<h1 id="%E4%B8%80%E3%80%81%E5%AF%BC%E5%85%A5EPPlus">一、导入EPPlus</h1>
<h2 id="1.%E9%A6%96%E5%85%88%E5%9C%A8Unity%E4%B8%AD%E5%AF%BC%E5%85%A5EPPlus%E5%92%8CExcel">1.首先在Unity中导入EPPlus和Excel</h2>
<p style="text-align:center;"><img alt="" height="142" src="image\fdab5d53d984409cb8ce7b3ecc718233.png" width="281"/></p>
<p></p>
<h2 id="2.%E5%88%9B%E5%BB%BA%E8%84%9A%E6%9C%AC%EF%BC%8C%E5%BC%95%E5%85%A5%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4">2.创建脚本，引入命名空间</h2>
<pre><code class="language-cs">using UnityEngine;
using UnityEditor;
using OfficeOpenXml;
using System.IO;</code></pre>
<p></p>
<hr/>
<h1></h1>
<h1 id="%E4%BA%8C%E3%80%81%E8%AF%BB%E5%8F%96EPPlus">二、读取Excel</h1>
<p style="text-align:center;"> <img alt="" height="232" src="image\0782e7df6ccc4b6f81043ffd64df651c.png" width="305"/></p>
<p style="text-align:center;">- 表格数据</p>
<h2 id="1.%20%E8%8E%B7%E5%8F%96Excel%E4%BF%A1%E6%81%AF%E6%96%87%E4%BB%B6">1. 获取Excel信息文件</h2>
<pre><code class="language-cs">        string filePath = Application.dataPath + "/目标名称.xlsx";//这里是文件路径
   
        //获取Excel文件的信息
        FileInfo fileInfo = new FileInfo(filePath);</code></pre>
<h2 id="2.%E6%89%93%E5%BC%80Excel%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF%EF%BC%8C%E6%89%93%E5%BC%80%E8%A1%A8%E6%A0%BC">2.打开Excel文件信息，打开表格</h2>
<pre><code class="language-cs">        //通过Excel文件信息，打开表格
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))
        //using是用来强行资源释放（前括号是打开，后括号是关闭）
        {

        }</code></pre>
<h2 id="3.%E9%9C%80%E8%A6%81%E6%89%93%E5%BC%80%E6%AD%A4Excel%E7%9A%84%E5%93%AA%E5%BC%A0%E8%A1%A8%E6%A0%BC">3.需要打开此Excel的哪张表格</h2>
<pre><code class="language-cs">        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))
        {
            //取得Excel文件中的第N张表
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1];
        }</code></pre>
<h2 id="4.%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE">4.读取数据</h2>
<pre><code class="language-cs">
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))
        {
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1];
            for (int i = 2; i &lt; worksheet.Dimension.End.Row; i++)
            //End.Row获得当前表格的最大行数
            {
                Debug.Log("目标名称：" + worksheet.Cells[i, 1].Value.ToString() + " // 设备名称：" + worksheet.Cells[i, 2].Value.ToString() + " // 地址：" + worksheet.Cells[i, 3].Value.ToString());
                //Cells是个二维数组，第一个参数是读取第几行，第二个参数是读取第几列需要ToString出数据
            }
        }</code></pre>
<h2 id="5.%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C">5.输出结果</h2>
<p class="img-center"><img alt="" height="440" src="image\ac6ca73df12346919ae6c6f28ad4f5bc.png" width="534"/></p>
<h2 id="%C2%A06.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">6.完整代码</h2>
<pre><code class="language-cs">using UnityEngine;
using UnityEditor;
using OfficeOpenXml;
using System.IO;

/// &lt;summary&gt; Read文件 &lt;/summary&gt;
public class ReadExcel
{

    [MenuItem("数据持久化/1.Excel/1.ReadExcel")]
    public static void InputExcel()
    {
        string filePath = Application.dataPath + "/00.Excel文件夹/Read.xlsx";

        ///获取Excel文件的信息
        FileInfo fileInfo = new FileInfo(filePath);

        ///通过Excel文件信息，打开表格
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))//using是用来强行资源释放（前括号是打开，后括号是关闭）
        {
            //取得Excel文件中的第N张表
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1];
            for (int i = 2; i &lt; worksheet.Dimension.End.Row; i++)//End.Row获得当前表格的最大行数
            {
                Debug.Log("目标名称：" + worksheet.Cells[i, 1].Value.ToString() + 
                    " // 设备名称：" + worksheet.Cells[i, 2].Value.ToString() + 
                    " // 地址：" + worksheet.Cells[i, 3].Value.ToString());
                //Cells是个二维数组，第一个参数是读取第几行，第二个参数是读取第几列需要ToString出数据
            }
        }
    }
}</code></pre>
<p></p>
<hr/>
<p></p>
<h1 id="%E4%B8%89%E3%80%81%E5%86%99%E5%85%A5Excel">三、写入Excel</h1>
<p style="text-align:center;"><img alt="" height="216" src="image\13cb218ae5a44a36972aa02050acbf5f.png" width="287"/></p>
<p style="text-align:center;">- 初始表格</p>
<h2 id="1.%E4%B8%80%E4%BA%8C%E6%AD%A5%E5%92%8C%E8%AF%BB%E5%8F%96%E4%B8%80%E6%A0%B7">1.一二步和读取一样</h2>
<h2 id="2.%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE">2.写入数据</h2>
<pre><code class="language-cs">        ///通过Excel文件信息，打开表格
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))//using是用来强行资源释放（前括号是打开，后括号是关闭）
        {
            //取得Excel文件中的第N张表
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets["Sheet1"];
            for (int i = 2; i &lt;= 12; i++)
            {
                //直接向每个表格赋值则是写入
                worksheet.Cells[i, 1].Value = "目标名称" + " " + (i - 1);
                worksheet.Cells[i, 2].Value = "设备地址" + " " + (i - 1);
                worksheet.Cells[i, 3].Value = "地址" + " " + (i - 1);
            }
            excelPackage.Save();//写入后保存表格
        }</code></pre>
<h2 id="3.%E5%86%99%E5%85%A5%E5%90%8E%E8%A1%A8%E6%A0%BC">3.写入后表格</h2>
<p style="text-align:center;"><img alt="" height="208" src="image\4007df50e79d46f695b34d90f91be506.png" width="266"/></p>
<h2 id="%C2%A04.%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81">4.完整代码</h2>
<pre><code class="language-cs">using UnityEngine;
using UnityEditor;
using OfficeOpenXml;
using System.IO;

public class WriteExcel
{

    [MenuItem("数据持久化/1.Excel/2.WriteExcel")]
    public static void ChangeExcel()
    {
        string filePath = Application.dataPath + "/00.Excel文件夹/Write.xlsx";

        ///获取Excel文件的信息
        FileInfo fileInfo = new FileInfo(filePath);

        ///通过Excel文件信息，打开表格
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))//using是用来强行资源释放（前括号是打开，后括号是关闭）
        {
            //取得Excel文件中表格叫Sheet1的表格
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets["Sheet1"];
            for (int i = 2; i &lt;= 12; i++)
            {
                //直接向每个表格赋值则是写入
                worksheet.Cells[i, 1].Value = "目标名称" + " " + (i - 1);
                worksheet.Cells[i, 2].Value = "设备地址" + " " + (i - 1);
                worksheet.Cells[i, 3].Value = "地址" + " " + (i - 1);
            }
            excelPackage.Save();//写入后保存表格
        }
    }

}
</code></pre>
<p></p>
<hr/>
<p></p>
<h1 id="4.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC">四.创建表格</h1>
<h2>1.一二步和读取一样</h2>
<h2 id="2.%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC">2.创建表格</h2>
<pre><code class="language-cs">using UnityEngine;
using UnityEditor;
using OfficeOpenXml;
using System.IO;

public class Creat
{
    [MenuItem("数据持久化/1.Excel/3.CreatExcel")]
    public static void ChangeExcel()
    {
        string filePath = Application.dataPath + "/00.Excel文件夹/Creat.xlsx";

        ///获取Excel文件的信息（文件中没有这个文件也不会报错）
        FileInfo fileInfo = new FileInfo(filePath);

        ///通过Excel文件信息，打开表格
        using (ExcelPackage excelPackage = new ExcelPackage(fileInfo))//在这里也没有创建Excel文件
        {
            //在新Excel文件中创建叫Sheet1的表格
            ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets.Add("Sheet1");
            worksheet.Cells[1, 1].Value = "目标名称";
            worksheet.Cells[1, 2].Value = "设备地址";
            worksheet.Cells[1, 3].Value = "地址";
            for (int i = 2; i &lt;= 12; i++)
            {
                //直接向每个表格赋值则是写入
                worksheet.Cells[i, 1].Value = "目标名称" + " " + (i - 1);
                worksheet.Cells[i, 2].Value = "设备地址" + " " + (i - 1);
                worksheet.Cells[i, 3].Value = "地址" + " " + (i - 1);
            }
            excelPackage.Save();//写入后保存表格
        }
        //完成文件创建
    }
}</code></pre>
<h2 id="3.%E5%88%9B%E5%BB%BA%E5%A5%BD%E7%9A%84%E8%A1%A8%E6%A0%BC">3.创建好的表格</h2>
<p class="img-center"><img alt="" height="190" src="image\1da04351a1c24d7a8f647414b59a54a9.png" width="235"/></p>
<p></p>
<hr/>
<p></p>
<h1 id="%E4%BA%94%E3%80%81%E5%B8%B8%E7%94%A8API">五、常用API</h1>
<h2 id="1.%E5%AF%B9%E8%A1%A8%E6%A0%BC%E7%9A%84%E6%93%8D%E4%BD%9C">1.对表格的操作</h2>
<blockquote>
<ol><li>通过int索引取得Excel文件中的第N张表<br/> ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets[1]</li><li>通过string获得Excel的表格<br/> ExcelWorksheet worksheet1 = excelPackage.Workbook.Worksheets["Sheet1"];</li><li>获得当前表格数目<br/> int i = excelPackage.Workbook.Worksheets.Count;</li><li>添加一张表格<br/> ExcelWorksheet worksheet = excelPackage.Workbook.Worksheets.Add("Sheet2");</li><li>给表格名称添加颜色（表头颜色换成绿色）<br/> worksheet.TabColor = System.Drawing.Color.ForestGreen;<br/><img alt="" height="37" src="image\78fae52d036e45e1b64921cffcbba067.png" width="202"/></li></ol>
</blockquote>
<h2 id="2.%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE">2.处理数据</h2>
<blockquote>
<ol><li>获得表格中最大行和列<br/> int row = worksheet.Dimension.End.Row;//行<br/> int column = worksheet.Dimension.End.Column;//列</li><li>获得第x各格子中的内容<br/> worksheet.Cells[1, 1].Value.ToString();//获得[1,1]位置的内容，可以写入（写入不加ToString）也可以读取 </li></ol>
</blockquote>
<h2 id="3.%E5%AF%B9Excel%E7%9A%84%E6%93%8D%E4%BD%9C">3.对Excel的操作</h2>
<blockquote>
<ol><li>获得一个Excel文件<br/> ExcelPackage excelPackage = new ExcelPackage(fileInfo)；</li><li>保存修改后的Excel文件<br/> excelPackage.Save();//保存<br/> excelPackage.SaveAs();//另存为</li></ol>
</blockquote>
<h1></h1>
<hr/>
<h1></h1>
<h1 id="%E5%85%AD.%E6%8F%90%E7%A4%BA">六、提示</h1>
<ol><li>若修改表格，记得Save执行保存表格的操作</li></ol>
<p></p>
<p></p>
<p></p>
<p>下面的EPPlus的GitHUb：</p>
<p><a class="has-card" href="https://github.com/JanKallman/EPPlus" title="GitHub - JanKallman/EPPlus: Create advanced Excel spreadsheets using .NET"><span class="link-card-box"><span class="link-title">GitHub - JanKallman/EPPlus: Create advanced Excel spreadsheets using .NET</span><span class="link-desc">Create advanced Excel spreadsheets using .NET. Contribute to JanKallman/EPPlus development by creating an account on GitHub.</span><span class="link-link"><img alt="" class="link-link-icon" src="image\fluidicon.png"/>https://github.com/JanKallman/EPPlus</span></span></a></p>
</div>
</div>