<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-tomorrow-night" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>目录</h3>
<ul><li><a href="#xlsxwriter_1">一、xlsxwriter简介</a></li><li><a href="#xlsxwriter_3">二、xlsxwriter语法</a></li><li><ul><li><a href="#1_4">1、模块安装</a></li><li><a href="#2_8">2、模块导入</a></li><li><a href="#3_12">3、创建工作簿、工作表</a></li><li><a href="#4_29">4、设置写入格式</a></li><li><ul><li><a href="#41__30">4.1 写入</a></li><li><a href="#42__99">4.2 设置单元格样式</a></li><li><a href="#43__146">4.3 设置工作表标签颜色</a></li><li><a href="#44__158">4.4 列宽和行高</a></li><li><a href="#45__182">4.5 合并单元格</a></li></ul>
</li></ul>
</li><li><a href="#_209">三、实例应用</a></li><li><a href="#_351">四、参考资料</a></li></ul>
</div>
<p></p>
<h1><a id="xlsxwriter_1"></a>一、xlsxwriter简介</h1>
<p>新建 <strong>xlsx</strong> 文件，插入数据、插入图标等表格操作。<strong>只能新建xlsx后写入xlsx文件</strong>。</p>
<h1><a id="xlsxwriter_3"></a>二、xlsxwriter语法</h1>
<h2><a id="1_4"></a>1、模块安装</h2>
<pre><code class="prism language-python">pip3 install xlsxwriter
</code></pre>
<h2><a id="2_8"></a>2、模块导入</h2>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter
</code></pre>
<h2><a id="3_12"></a>3、创建工作簿、工作表</h2>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter

<span class="token comment"># 创建工作簿</span>
workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个excel文件</span>

<span class="token comment"># 创建工作表</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>  <span class="token comment"># 在文件中创建一个名为这是sheet1的sheet,不加名字默认为sheet1</span>

<span class="token comment"># 写入数据</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'写点什么好'</span><span class="token punctuation">)</span>  <span class="token comment"># 第1行第1列（即A1）写入</span>

workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3f195448aa514e418e3f03fcc84c611e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_15,color_FFFFFF,t_70,g_se,x_16"/></p>
<h2><a id="4_29"></a>4、设置写入格式</h2>
<h3><a id="41__30"></a>4.1 写入</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/acfb617d2be94b4a957387af38ee074d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_17,color_FFFFFF,t_70,g_se,x_16"/><br/> 举例：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token comment"># 创建工作簿</span>
workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个excel文件</span>

<span class="token comment"># 创建工作表</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>  <span class="token comment"># 在文件中创建一个名为这是sheet1的sheet,不加名字默认为sheet1</span>

<span class="token comment"># 写入数据</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'写点什么好'</span><span class="token punctuation">)</span>  <span class="token comment"># 写入字符串</span>

worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'=SUM(B3:B4)'</span><span class="token punctuation">)</span>  <span class="token comment"># 写入excel公式</span>
worksheet<span class="token punctuation">.</span>write_formula<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'=SUM(B3:B4)'</span><span class="token punctuation">)</span>  <span class="token comment"># 写入excel公式</span>

date_format <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'num_format'</span><span class="token punctuation">:</span> <span class="token string">'yyyy-mm-dd H:M:S'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
date_format1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'num_format'</span><span class="token punctuation">:</span> <span class="token string">'yyyy/m/d;@'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
worksheet<span class="token punctuation">.</span>write_datetime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>date_format <span class="token punctuation">)</span> <span class="token comment"># 写入自定义时间</span>
worksheet<span class="token punctuation">.</span>write_datetime<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>date_format1 <span class="token punctuation">)</span> <span class="token comment"># 写入日期</span>

num_format <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'num_format'</span><span class="token punctuation">:</span> <span class="token string">'0.00_);[Red](0.00)'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
worksheet<span class="token punctuation">.</span>write_number<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1001</span><span class="token punctuation">)</span>  <span class="token comment"># 写入数字（常规）</span>
worksheet<span class="token punctuation">.</span>write_number<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1001</span><span class="token punctuation">,</span>num_format<span class="token punctuation">)</span>  <span class="token comment"># 写入数字（数值）</span>

worksheet<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span>row <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">,</span>col <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'嘿嘿'</span><span class="token punctuation">,</span><span class="token string">'哈哈'</span><span class="token punctuation">,</span><span class="token string">'呵呵'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 按行写入：从第几行开始，从第几列开始，写入的值</span>

workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>写入公式效果：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/784e75310fda464b8ce00bc535faec8a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> 写入自定义时间、日期效果：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e790be16150143e9b4575470259a870f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/53b2480290f343f68edaeda68f65a379.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<p>写入数据效果：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ca43a0344a1e401ab5cca05e84bd4420.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/8d93f069f7194b3d99ea44872ace3d58.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> <mark><strong>重要！！！怎么知道想要的格式如何表示？</strong></mark></p>
<p>举个例子：我想要写入excel的单元格格式是：货币<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/346a5a441199403e940fddb670008ec5.png"/><br/> 1、先在excel写入数据并设置成货币类型<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ef4212a8895a441a95a234a6e9112cbd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_19,color_FFFFFF,t_70,g_se,x_16"/><br/> 2、按照下图所示在excel设置成自定义，可以看到刚才设置的货币对应的样式：‘￥#,##0.00;￥-#,##0.00’<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/82c7915bbfa64528ad3ce14b292ef90f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> 验证一下：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token comment"># 创建工作簿</span>
workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 创建一个excel文件</span>

<span class="token comment"># 创建工作表</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>  <span class="token comment"># 在文件中创建一个名为这是sheet1的sheet,不加名字默认为sheet1</span>

<span class="token comment"># 写入数据</span>
num_format <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">'num_format'</span><span class="token punctuation">:</span> <span class="token string">'￥#,##0.00;￥-#,##0.00'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span>num_format<span class="token punctuation">)</span>  <span class="token comment"># 写入数字（常规）</span>

workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f37d552074f54be3a9a08d68169bd515.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="42__99"></a>4.2 设置单元格样式</h3>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter

workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>
title_format <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'font_name'</span> <span class="token punctuation">:</span> <span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token comment"># 字体</span>
    <span class="token string">'font_size'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token comment"># 字体大小</span>
    <span class="token string">'font_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体颜色</span>
    <span class="token string">'bold'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否粗体</span>
    <span class="token string">'bg_color'</span><span class="token punctuation">:</span> <span class="token string">'#101010'</span><span class="token punctuation">,</span>  <span class="token comment"># 表格背景颜色</span>
    <span class="token string">'fg_color'</span><span class="token punctuation">:</span> <span class="token string">'#00FF00'</span><span class="token punctuation">,</span>  <span class="token comment"># 前景颜色</span>
    <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  <span class="token comment"># 水平居中对齐</span>
    <span class="token string">'valign'</span><span class="token punctuation">:</span> <span class="token string">'vcenter'</span><span class="token punctuation">,</span>  <span class="token comment"># 垂直居中对齐</span>
    <span class="token comment"># 'num_format': 'yyyy-mm-dd H:M:S',# 设置日期格式</span>
    <span class="token comment"># 后面参数是线条宽度</span>
    <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 边框宽度</span>
    <span class="token string">'top'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 上边框</span>
    <span class="token string">'left'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 左边框</span>
    <span class="token string">'right'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 右边框</span>
    <span class="token string">'bottom'</span><span class="token punctuation">:</span> <span class="token number">1</span>  <span class="token comment"># 底边框</span>
<span class="token punctuation">}</span>
<span class="token builtin">format</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'font_size'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 字体大小</span>
    <span class="token string">'font_color'</span><span class="token punctuation">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体颜色</span>
    <span class="token string">'bold'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否粗体</span>
    <span class="token string">'bg_color'</span><span class="token punctuation">:</span> <span class="token string">'#101010'</span><span class="token punctuation">,</span>  <span class="token comment"># 表格背景颜色</span>
    <span class="token string">'fg_color'</span><span class="token punctuation">:</span> <span class="token string">'#00FF00'</span><span class="token punctuation">,</span> <span class="token comment"># 前景颜色</span>
    <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  <span class="token comment"># 水平居中对齐</span>
    <span class="token string">'valign'</span><span class="token punctuation">:</span> <span class="token string">'vcenter'</span><span class="token punctuation">,</span>  <span class="token comment"># 垂直居中对齐</span>
    <span class="token comment"># 'num_format': 'yyyy-mm-dd H:M:S',# 设置日期格式</span>
    <span class="token comment"># 后面参数是线条宽度</span>
    <span class="token string">'border'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 边框宽度</span>
    <span class="token string">'top'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 上边框</span>
    <span class="token string">'left'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 左边框</span>
    <span class="token string">'right'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token comment"># 右边框</span>
    <span class="token string">'bottom'</span><span class="token punctuation">:</span> <span class="token number">1</span>  <span class="token comment"># 底边框</span>
<span class="token punctuation">}</span>
title_style <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>title_format<span class="token punctuation">)</span>  <span class="token comment"># 设置样式format是一个字典</span>
style <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">)</span>  <span class="token comment"># 设置样式format是一个字典</span>
worksheet<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'表头1'</span><span class="token punctuation">,</span><span class="token string">'表头2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> title_style<span class="token punctuation">)</span>  <span class="token comment"># 第一行第一列开始写入表头</span>
worksheet<span class="token punctuation">.</span>write_row<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'数据1'</span><span class="token punctuation">,</span><span class="token string">'数据2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> style<span class="token punctuation">)</span>  <span class="token comment"># 第二行第一列开始写入数据</span>
workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/bb4b3ba8149e4e779fa895cc507e2e41.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_15,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="43__146"></a>4.3 设置工作表标签颜色</h3>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter

workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>
worksheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>
worksheet1<span class="token punctuation">.</span>set_tab_color<span class="token punctuation">(</span><span class="token string">'#0000FF'</span><span class="token punctuation">)</span>
worksheet2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet2'</span><span class="token punctuation">)</span>
workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9003688f92164770afa3ba389e83109d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_15,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="44__158"></a>4.4 列宽和行高</h3>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter

<span class="token comment"># 创建工作簿</span>
workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>

<span class="token comment"># 创建工作表</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>

<span class="token comment"># 写入数据</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'这是个很长的字段'</span><span class="token punctuation">)</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'这是个特别长的字段'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置行宽</span>
worksheet<span class="token punctuation">.</span>set_row<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token comment"># 第一行行宽</span>

<span class="token comment"># 设置列宽</span>
worksheet<span class="token punctuation">.</span>set_column<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token comment"># 第二、三列列宽</span>

workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d9c2495e5ef845b5a144bdc790706820.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="45__182"></a>4.5 合并单元格</h3>
<p>语法：<br/> <strong>merge_range(first_row, first_col, last_row, last_col, data[, cell_format])</strong></p>
<p>举例：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlsxwriter
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token comment"># 创建工作簿</span>
workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'测试文件.xlsx'</span><span class="token punctuation">)</span>

<span class="token comment"># 创建工作表</span>
worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span><span class="token string">'这是sheet1'</span><span class="token punctuation">)</span>

<span class="token comment"># 写入数据</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'未合并'</span><span class="token punctuation">)</span> <span class="token comment"># 第一行第一列，A1写入'未合并'</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'会被覆盖'</span><span class="token punctuation">)</span> <span class="token comment"># 第三行第一列，A3写入'会被覆盖'</span>
worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'待合并'</span><span class="token punctuation">)</span> <span class="token comment"># 第五行第一列，A5写入'待合并'</span>
worksheet<span class="token punctuation">.</span>merge_range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'合并01'</span><span class="token punctuation">)</span> <span class="token comment"># 合并第二行-四行，第三列-五列，即：C2:E4</span>
worksheet<span class="token punctuation">.</span>merge_range<span class="token punctuation">(</span><span class="token string">'A3:B3'</span><span class="token punctuation">,</span><span class="token string">'覆盖它'</span><span class="token punctuation">)</span> <span class="token comment"># 合并A3:B3，并写入'覆盖它'</span>
worksheet<span class="token punctuation">.</span>merge_range<span class="token punctuation">(</span><span class="token string">'A5:B5'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token comment"># 合并A5:B5，'待合并'并不被覆盖</span>

workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/014466a06c6b4056a87fb8b3bbb2997a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_15,color_FFFFFF,t_70,g_se,x_16"/></p>
<h1><a id="_209"></a>三、实例应用</h1>
<p><strong>功能描述：</strong><br/> 从数据库取数，写入xlsx，并发送邮件。</p>
<p><strong>代码实现：</strong></p>
<pre><code class="prism language-python"><span class="token comment"># util为博主封装的模块</span>
<span class="token keyword">from</span> util <span class="token keyword">import</span> config
<span class="token keyword">from</span> util<span class="token punctuation">.</span>gmail <span class="token keyword">import</span> Mail
<span class="token keyword">from</span> util<span class="token punctuation">.</span>gstring <span class="token keyword">import</span> convert_df_to_html
<span class="token keyword">from</span> util<span class="token punctuation">.</span>logger <span class="token keyword">import</span> log
<span class="token keyword">from</span> util<span class="token punctuation">.</span>db <span class="token keyword">import</span> get_db
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> os
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">import</span> xlsxwriter


<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>init_date<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#创建excel文件</span>
    new_excel <span class="token operator">=</span> <span class="token string">"6（1）班考试成绩单-"</span> <span class="token operator">+</span> init_date <span class="token operator">+</span><span class="token string">".xlsx"</span> <span class="token comment"># 附件</span>
    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>new_excel<span class="token punctuation">)</span> <span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>new_excel<span class="token punctuation">)</span>
    workbook <span class="token operator">=</span> xlsxwriter<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>new_excel<span class="token punctuation">)</span>

    <span class="token comment"># 数据库连接</span>
    db <span class="token operator">=</span> get_db<span class="token punctuation">(</span><span class="token string">"dbcenter"</span><span class="token punctuation">)</span>

    <span class="token comment"># 数据库取数</span>
    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'开始从数据库取数...'</span><span class="token punctuation">)</span>
    math_sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'''
        select '张三' as name
               ,'6（1）班' as class
               ,'数学' as subject
               ,95 as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        union all
        select '李四' as name
               ,'6（1）班' as class
               ,'数学' as subject
               ,98 as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        union all
        select '王五' as name
               ,'6（1）班' as class
               ,'数学' as subject
               ,null as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        '''</span></span>

    chinese_sql <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'''
        select '张三' as name
               ,'6（1）班' as class
               ,'语文' as subject
               ,90 as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        union all
        select '李四' as name
               ,'6（1）班' as class
               ,'语文' as subject
               ,88 as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        union all
        select '王五' as name
               ,'6（1）班' as class
               ,'语文' as subject
               ,70 as score
               ,</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>init_date<span class="token punctuation">}</span></span><span class="token string"> as init_date
        '''</span></span>

    sqls <span class="token operator">=</span> <span class="token punctuation">[</span>math_sql<span class="token punctuation">,</span>chinese_sql<span class="token punctuation">]</span>
    sheets <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'数学成绩单'</span><span class="token punctuation">,</span><span class="token string">'语文成绩单'</span><span class="token punctuation">]</span>
    title_format <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'font_name'</span><span class="token punctuation">:</span> <span class="token string">'宋'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体</span>
        <span class="token string">'font_size'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 字体大小</span>
        <span class="token string">'font_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体颜色</span>
        <span class="token string">'bold'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 是否粗体</span>
        <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  <span class="token comment"># 水平居中对齐</span>
        <span class="token string">'valign'</span><span class="token punctuation">:</span> <span class="token string">'vcenter'</span>  <span class="token comment"># 垂直居中对齐</span>
    <span class="token punctuation">}</span>
    <span class="token builtin">format</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'font_name'</span><span class="token punctuation">:</span> <span class="token string">'宋'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体</span>
        <span class="token string">'font_size'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 字体大小</span>
        <span class="token string">'font_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体颜色</span>
        <span class="token string">'bold'</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span class="token punctuation">,</span>  <span class="token comment"># 是否粗体</span>
        <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  <span class="token comment"># 水平居中对齐</span>
        <span class="token string">'valign'</span><span class="token punctuation">:</span> <span class="token string">'vcenter'</span>  <span class="token comment"># 垂直居中对齐</span>
    <span class="token punctuation">}</span>
    date_format <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'font_name'</span><span class="token punctuation">:</span> <span class="token string">'宋'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体</span>
        <span class="token string">'font_size'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 字体大小</span>
        <span class="token string">'font_color'</span><span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>  <span class="token comment"># 字体颜色</span>
        <span class="token string">'align'</span><span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>  <span class="token comment"># 水平居中对齐</span>
        <span class="token string">'valign'</span><span class="token punctuation">:</span> <span class="token string">'vcenter'</span><span class="token punctuation">,</span>  <span class="token comment"># 垂直居中对齐</span>
        <span class="token string">'num_format'</span><span class="token punctuation">:</span> <span class="token string">'yyyy/mm/dd'</span>
        <span class="token punctuation">}</span>
    title_style <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>title_format<span class="token punctuation">)</span>
    style <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">)</span>
    date_style <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_format<span class="token punctuation">(</span>date_format<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sqls<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
        datas <span class="token operator">=</span> db<span class="token punctuation">.</span>query<span class="token punctuation">(</span>sqls<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>init_date <span class="token punctuation">:</span> init_date<span class="token punctuation">}</span><span class="token punctuation">)</span>
        df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>datas<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'subject'</span><span class="token punctuation">,</span> <span class="token string">'score'</span><span class="token punctuation">,</span> <span class="token string">'init_date'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        df<span class="token punctuation">[</span><span class="token string">"班主任"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'王老师'</span>
        df<span class="token punctuation">[</span><span class="token string">"考试日期"</span><span class="token punctuation">]</span> <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>init_date<span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>
        df <span class="token operator">=</span> df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"姓名"</span><span class="token punctuation">,</span><span class="token string">"class"</span><span class="token punctuation">:</span><span class="token string">"班级"</span><span class="token punctuation">,</span><span class="token string">"subject"</span><span class="token punctuation">:</span><span class="token string">"科目"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">:</span><span class="token string">"分数"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        order <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"考试日期"</span><span class="token punctuation">,</span><span class="token string">"班级"</span><span class="token punctuation">,</span><span class="token string">"班主任"</span><span class="token punctuation">,</span><span class="token string">"姓名"</span><span class="token punctuation">,</span><span class="token string">"科目"</span><span class="token punctuation">,</span><span class="token string">"分数"</span><span class="token punctuation">]</span>
        df <span class="token operator">=</span> df<span class="token punctuation">[</span>order<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#缺考分数为0</span>
        log<span class="token punctuation">.</span>info<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
        datas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>xi<span class="token punctuation">)</span> <span class="token keyword">for</span> xi <span class="token keyword">in</span> df<span class="token punctuation">.</span>values<span class="token punctuation">]</span>
        excel_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> datas
        worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_worksheet<span class="token punctuation">(</span>sheets<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>excel_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>excel_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> excel_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> title_style<span class="token punctuation">)</span>
                <span class="token keyword">elif</span> j <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    worksheet<span class="token punctuation">.</span>write_datetime<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>init_date<span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> date_style<span class="token punctuation">)</span>  <span class="token comment"># 写入时间</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> excel_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> style<span class="token punctuation">)</span>
    workbook<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">#发邮件</span>
    <span class="token comment">#html = convert_df_to_html(df)</span>
    mail_config <span class="token operator">=</span> config<span class="token punctuation">.</span>get_config<span class="token punctuation">(</span><span class="token string">"email.send_fxm"</span><span class="token punctuation">)</span><span class="token comment"># 发件人</span>
    mail <span class="token operator">=</span> Mail<span class="token punctuation">(</span>mail_config<span class="token punctuation">)</span>
    title <span class="token operator">=</span> <span class="token string">'6（1）班考试成绩单-'</span> <span class="token operator">+</span> init_date <span class="token comment"># 邮件标题</span>
    to_list <span class="token operator">=</span> <span class="token string">'xxx.com'</span>  <span class="token comment"># 收件人</span>
    mail<span class="token punctuation">.</span>send_email<span class="token punctuation">(</span>to_list<span class="token punctuation">,</span> title<span class="token punctuation">,</span>content_text <span class="token operator">=</span> <span class="token string">'各位家长你们好，6（1）班'</span><span class="token operator">+</span> init_date <span class="token operator">+</span> <span class="token string">'日考试成绩单详见附件！'</span><span class="token punctuation">,</span> attachment_list<span class="token operator">=</span><span class="token punctuation">[</span>new_excel<span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    init_date <span class="token operator">=</span> <span class="token string">'20220412'</span>
    run<span class="token punctuation">(</span>init_date<span class="token punctuation">)</span>

</code></pre>
<p><strong>效果：</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7b0881f933d543e0855017c7d482f7c2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_16,color_FFFFFF,t_70,g_se,x_16"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7645dc3f3c8547e6a3f94d0bb2666424.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_16,color_FFFFFF,t_70,g_se,x_16"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/a4183c821fab4d53bc837aa08b592aba.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA7pSnIHNoYW1teQ==,size_19,color_FFFFFF,t_70,g_se,x_16"/></p>
<h1><a id="_351"></a>四、参考资料</h1>
<p><a href="https://blog.csdn.net/ixusy88/article/details/106742403">Python3之excel操作–xlsxwriter模块</a></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>