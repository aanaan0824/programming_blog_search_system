<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p>物联网数据通讯,需要从服务器上的mqtt服务器上订阅数据,</p>
<p>xml格式如下:</p>
<p>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/> &lt;Order&gt;<br/>   &lt;Items&gt;<br/>     &lt;Mqtt Ip="121.43.168.148"   Port="6000" Name="Data0" password="0"/&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data0" startid="0" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data1" startid="1" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data2" startid="2" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data3" startid="3" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data4" startid="4" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data5" startid="5" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data6" startid="6" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data7" startid="7" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data8" startid="8" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data9" startid="9" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data10" startid="10" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data11" startid="11" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data12" startid="12" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data13" startid="13" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data14" startid="14" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data15" startid="15" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data16" startid="16" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data17" startid="17" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data18" startid="18" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data19" startid="19" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data20" startid="20" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data21" startid="21" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data22" startid="22" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data23" startid="23" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data24" startid="24" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data25" startid="25" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data26" startid="26" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data27" startid="27" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data28" startid="28" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data29" startid="29" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data30" startid="30" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data31" startid="31" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data32" startid="32" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data33" startid="33" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data34" startid="34" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data35" startid="35" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data36" startid="36" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data37" startid="37" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data38" startid="38" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data39" startid="39" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data40" startid="40" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data41" startid="41" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data42" startid="42" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data43" startid="43" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data44" startid="44" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data45" startid="45" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data46" startid="46" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data47" startid="47" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data48" startid="48" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data49" startid="49" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data50" startid="50" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data51" startid="51" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data52" startid="52" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data53" startid="53" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data54" startid="54" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data55" startid="55" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data56" startid="56" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data57" startid="57" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data58" startid="58" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data59" startid="59" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data60" startid="60" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data61" startid="61" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data62" startid="62" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data63" startid="63" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data64" startid="64" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data65" startid="65" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data66" startid="66" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data67" startid="67" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data68" startid="68" numid="10" note="10" Value="10" /&gt;<br/>     &lt;OrderItem Room="1#配电房" Line="进线柜" Name="Data69" startid="69" numid="10" note="10" Value="10" /&gt;<br/><br/>   &lt;/Items&gt;<br/> &lt;/Order&gt;</p>
<p>订阅主题为1#配电房/进线柜/Data0等</p>
<p>下图为订阅到部分数据</p>
<p><img alt="" height="634" src="image\9ca4b3421b4140a187589e6141d74ac7.png" width="1200"/></p>
<p>订阅代码:</p>
<p> string topic = "/home/tempurture/line1";</p>
<p>            MqttClient client = new MqttClient(serverIp, Convert.ToInt32(serverPort), false, null, null, MqttSslProtocols.TLSv1_2);<br/>             string clientId = Guid.NewGuid().ToString();<br/>             string username = "admin";<br/>             string password = "password";<br/>             //建立连接<br/>             client.Connect(clientId, username, password);<br/>             for (int m = 0; m &lt; xml.datalist.Count; m++)<br/>             {<!-- --><br/>                 topic = xml.datalist[m];<br/>                 // 订阅主题 "/home/temperature"， 订阅质量 QoS 2 <br/>                 client.Subscribe(new string[] { topic }, new byte[] { MqttMsgBase.QOS_LEVEL_EXACTLY_ONCE });<br/>             }<br/>             label1.Text = topic;<br/>             client.MqttMsgPublishReceived += new MqttClient.MqttMsgPublishEventHandler(messageReceive);<br/>             timer1.Interval = Convert.ToInt32(textStartId.Text) * 1000 + 30000;<br/>             this.timer1.Enabled = true;</p>
<p> 需要源码的发我邮箱,279644337@qq.com</p>
</div>
</div>