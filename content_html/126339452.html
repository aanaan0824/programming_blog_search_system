<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<br/>
<hr/>
<blockquote>
<ul><li><strong>ğŸ’‚ ä¸ªäººç½‘ç«™:</strong> <font color="1E88E5"><a href="http://www.it-learning.cn/">ITçŸ¥è¯†å°å±‹</a></font></li><li><strong>ğŸ¤Ÿ ç‰ˆæƒ:</strong> æœ¬æ–‡ç”±ã€ITå­¦ä¹ æ—¥è®°ã€‘åŸåˆ›ã€åœ¨CSDNé¦–å‘ã€éœ€è¦è½¬è½½è¯·è”ç³»åšä¸»</li><li>ğŸ’¬ å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ã€<strong><font color="1E88E5">æ¬¢è¿å…³æ³¨ã€ç‚¹èµã€æ”¶è—(ä¸€é”®ä¸‰è¿)å’Œè®¢é˜…ä¸“æ å“¦</font></strong></li><li>ğŸ’… <strong><font color="1E88E5">å¼€æºé¡¹ç›®:ã€<a href="https://gitee.com/it-learning-diary/it-wheels-king">è½®å­ä¹‹ç‹</a>ã€‘</font></strong></li></ul>
</blockquote>
<hr/>
<p></p>
<div class="toc">
<h3>æ–‡ç« ç›®å½•</h3>
<ul><li><ul><li><a href="#_16">å‰è¨€</a></li><li><a href="#_24">å·¥å…·ä»‹ç»</a></li><li><ul><li><a href="#excel_40">ä¸€ã€excelå·¥å…·</a></li><li><a href="#csv_165">äºŒã€csvå·¥å…·</a></li><li><a href="#ftp_298">ä¸‰ã€ftpå·¥å…·</a></li><li><a href="#_431">å››ã€åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå·¥å…·</a></li></ul>
</li><li><a href="#_524">å·¥å…·æ›´æ–°</a></li><li><a href="#_534">é›†æˆæ–¹æ¡ˆä»‹ç»å…³è”æ–‡ç« </a></li><li><a href="#_541">å†™åœ¨æœ€å</a></li></ul>
</li></ul>
</div>
<p></p>
<hr/>
<h2><a id="_16"></a>å‰è¨€</h2>
<p>â€ƒâ€ƒ<strong>ä¸€ä¸ªä¼˜ç§€çš„å¼€å‘è€…ï¼Œä¸€å®šæ˜¯ä¼šåˆ©ç”¨å„ç§å·¥å…·æ¥æå‡è‡ªå·±çš„å¼€å‘æ•ˆç‡ã€‚</strong> å‰æ®µæ—¶é—´ï¼Œåšä¸»åœ¨Gitee/Githubå¼€æºäº†ä¸€ä¸ªæå‡å¼€å‘æ•ˆç‡çš„å·¥å…·ï¼Œå·¥å…·å†…é›†æˆäº†å„ç§å¸¸ç”¨å·¥å…·å¦‚csvã€excelã€ftpã€æ–‡ä»¶ç³»ç»Ÿç­‰ç­‰ï¼Œ<strong>åªéœ€è¦ç®€å•è°ƒç”¨APIï¼Œå°±å¯ä»¥å¾—åˆ°æƒ³è¦çš„ç»“æœï¼Œå¯ä»¥æå¤§å¸®åŠ©å¼€å‘è€…æå‡æ•ˆç‡</strong>ï¼Œä¸‹é¢æ¥ä¸€èµ·çœ‹çœ‹è¿™æ¬¾å·¥å…·å¦‚ä½•ä½¿ç”¨å§ã€‚</p>
<p><img alt="image-20220806204935635" src="https://img-blog.csdnimg.cn/img_convert/efeb4ee7f26aa90e7700851341045f23.png"/></p>
<h2><a id="_24"></a>å·¥å…·ä»‹ç»</h2>
<p>â€ƒâ€ƒæŠ¥è¡¨çš„å¯¼å‡ºã€å¯¼å…¥åŠŸèƒ½ã€æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ç­‰åœ¨å¹³å¸¸ä¸šåŠ¡ä¸­æ˜¯æœ€å¸¸è§ä¸è¿‡çš„åŠŸèƒ½äº†ï¼Œ<strong>è®¸å¤šå°ä¼™ä¼´åœ¨å¼€å‘çš„æ—¶å€™æ‰ä¼šå»ç½‘ä¸Šæ‰¾ä¹‹å‰åˆ«äººç¼–å†™è¿‡çš„æ¡ˆä¾‹å‚è€ƒï¼Œä½†æ˜¯è®¸å¤šåšå®¢è®°è½½çš„éƒ½æ˜¯æ—¶é—´æ¯”è¾ƒé•¿è¿œæˆ–è€…ä¸å®Œæ•´çš„ä»£ç ï¼Œè¿™å¯¼è‡´åœ¨å¼•å…¥çš„æ—¶å€™è¿˜è¦å¤„ç†å¼•å…¥çš„è®¸å¤šæœªçŸ¥é—®é¢˜ã€‚</strong></p>
<p>â€ƒâ€ƒç°åœ¨åšä¸»å¼€æºçš„â€œè½®å­ä¹‹ç‹â€åŒ…å«äº†è¿™äº›å¸¸è§çš„åŠŸèƒ½ï¼Œ<strong>æºç å…¨å¼€å‘ï¼Œæ¯ç§åŠŸèƒ½éƒ½æœ‰ç›¸åº”çš„ä¾‹å­è¯´æ˜ï¼Œé¡¹ç›®ä¼šæŒç»­æ›´æ–°è¿­ä»£ï¼Œæœ‰é—®é¢˜è¿˜å¯ä»¥åŠæ—¶ç»™é¡¹ç›®æissueï¼Œç›¸ä¿¡æ¯”å¤§å¤šæ•°ç½‘ä¸Šçš„åšå®¢ä»£ç å¯é æ€§æ›´é«˜ã€‚</strong></p>
<p>â€ƒâ€ƒ<strong>é¡¹ç›®åœ°å€å¦‚ä¸‹ï¼š</strong></p>
<p>â€ƒâ€ƒGithubï¼š<a href="https://github.com/it-learning-diary/it-wheels-king">https://github.com/it-learning-diary/it-wheels-king</a></p>
<p>â€ƒâ€ƒGiteeï¼š<a href="https://gitee.com/it-learning-diary/it-wheels-king">https://gitee.com/it-learning-diary/it-wheels-king</a></p>
<p>â€ƒâ€ƒ<strong>é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</strong></p>
<p><img alt="image-20220807104023940" src="https://img-blog.csdnimg.cn/img_convert/21adc2f399aace29368ddeb1fdf5dcbc.png"/></p>
<h3><a id="excel_40"></a>ä¸€ã€excelå·¥å…·</h3>
<p>â€ƒâ€ƒè¯¥å·¥å…·å®ç°é‡‡ç”¨çš„æ˜¯å¼€æºçš„easyexcelæ¡†æ¶ã€‚easyexcelæ˜¯é˜¿é‡Œçš„å¼€å‘äººå‘˜å¯¹poiæ¡†æ¶è¿›è¡Œäº†ä¼˜åŒ–ï¼Œè§£å†³äº†poiåœ¨å¤§æ•°æ®é‡æ—¶å¯èƒ½å‡ºç°OOMå¼‚å¸¸ï¼Œå¹¶ä¸”å…¼å®¹xlså’Œxlsxä¸¤ç§æ–‡ä»¶ç±»å‹çš„ä¸€ä¸ªå¼€æºæ¡†æ¶ã€‚</p>
<p>â€ƒâ€ƒ<strong>excelå·¥å…·é›†æˆåŠŸèƒ½å¦‚ä¸‹ï¼š</strong></p>
<ul><li>excelçš„å¯¼å…¥(å¯ä»¥è‡ªå®šä¹‰è½¬æ¢åçš„excelæ•°æ®å¤„ç†çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ”¯æŒæŠ›å‡ºå¼‚å¸¸ã€äº‹åŠ¡å›æ»šã€è®°å½•è§£ææ—¶çš„å¼‚å¸¸æ•°æ®)</li><li>å¯¼å‡º(æ”¯æŒå›ºå®šè¡¨å¤´,å…¼å®¹å¤šsheeté¡µå’ŒåŠ¨æ€è¡¨å¤´,å…¼å®¹å¤šsheeté¡µ)åŠŸèƒ½ã€‚</li></ul>
<p>â€ƒâ€ƒ<strong>excelå·¥å…·çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</strong></p>
<p>â€ƒâ€ƒä½¿ç”¨è¿‡easyexcelæ¡†æ¶çš„ä¸€äº›è¯»è€…çŸ¥é“ï¼Œæ¯ä¸ªå¯¼å…¥åŠŸèƒ½éƒ½è¦å†™ä¸€ä¸ªå¯¹åº”çš„Listenerè¿›è¡Œæ•°æ®è½¬æ¢ï¼Œåœ¨å¾ˆå¤šæ—¶é—´å…¶å®è½¬æ¢çš„é€»è¾‘éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œä¸åŒçš„åªä¸è¿‡æ˜¯è½¬æ¢åæ•°æ®å¤„ç†çš„ä¸šåŠ¡é€»è¾‘ä¸ä¸€æ ·ã€‚</p>
<p>â€ƒâ€ƒ<strong>æœ¬å¼€æºé¡¹ç›®çš„excelå·¥å…·åˆ™åˆ©ç”¨Javaä¸­çš„æ³›å‹å’ŒJava8ä¸­çš„Consumeræ¥å£å°†ç›¸åŒçš„éƒ¨åˆ†(è½¬æ¢é€»è¾‘)æŠ½å–å‡ºæ¥ï¼Œä¸åŒçš„éƒ¨åˆ†åˆ™å•ç‹¬ä¼ å…¥(æ•°æ®å¤„ç†çš„ä¸šåŠ¡é€»è¾‘)ï¼Œè¿™æ ·å°±é¿å…äº†æ¯ä¸ªå¯¼å…¥éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªç›¸ç±»ä¼¼çš„Listernerï¼Œå‡å°‘äº†ç±»çš„åˆ›å»ºå’Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚</strong></p>
<p>â€ƒâ€ƒ<strong>éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"> <span class="token comment">/**
     * é€šç”¨å¯¼å…¥excelæ–‡ä»¶æ–¹æ³•
     *
     * @param fileStream å¯¼å…¥çš„æ–‡ä»¶æµ
     * @param rowDto æ¥æ”¶excelæ¯è¡Œæ•°æ®çš„å®ä½“
     * @param rowAction å°†æ¥æ”¶åˆ°çš„å®ä½“è¿›è¡Œè‡ªå®šä¹‰çš„ä¸šåŠ¡å¤„ç†é€»è¾‘æ–¹æ³•
     * @param &lt;T&gt; å®ä½“ç±»å‹
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">importFile</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> fileStream<span class="token punctuation">,</span> <span class="token class-name">T</span> rowDto<span class="token punctuation">,</span> <span class="token class-name">ThrowingConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> rowAction<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è·å–excelé€šç”¨ç›‘å¬å™¨</span>
        <span class="token class-name">ExcelImportCommonListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> commonListener <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelImportCommonListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>rowAction<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯»å–excelæ–‡ä»¶å¹¶å¯¼å…¥</span>
        <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fileStream<span class="token punctuation">,</span> rowDto<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> commonListener<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token comment">/**
     * excelæ–‡ä»¶å¯¼å‡º(å¯ä»¥åŒ…å«å¤šä¸ªsheeté¡µ)ï¼Œå›ºå®šè¡¨å¤´(é€šè¿‡å®ä½“æŒ‡å®šå±æ€§çš„æ–¹å¼)
     * @param response
     * @param fileName   å¯¼å‡ºæ–‡ä»¶å
     * @param head       å¯¼å‡ºè¡¨å¤´(å¤šä¸ªsheeté¡µå°±æ˜¯å¤šä¸ªé›†åˆå…ƒç´ )
     * @param exportData éœ€è¦å¯¼å‡ºæ•°æ®
     * @param sheetNames sheeté¡µçš„åç§°ï¼Œä¸ºç©ºåˆ™é»˜è®¤ä»¥:sheet + æ•°å­—è§„åˆ™å‘½å
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">exportFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> head<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> exportData<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sheetNames<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"ExcelExportUtil exportFile required param can't be empty"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">ExcelWriter</span> writer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>EXCEL_CONTENT_TYPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>CONTENT_DISPOSITION<span class="token punctuation">,</span> <span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>ATTACHMENT_FILENAME <span class="token operator">+</span> fileName <span class="token operator">+</span> <span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>XLSX_SUFFIX<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è®¾ç½®å¯¼å‡ºçš„è¡¨æ ¼æ ·å¼</span>
            <span class="token class-name">HorizontalCellStyleStrategy</span> horizontalCellStyleStrategy <span class="token operator">=</span> <span class="token function">getExportDefaultStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerWriteHandler</span><span class="token punctuation">(</span>horizontalCellStyleStrategy<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> itemIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> itemIndex <span class="token operator">&lt;</span> exportData<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> itemIndex<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// è¡¨å¤´æ•°æ®</span>
                <span class="token class-name">Object</span> headData <span class="token operator">=</span> head<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// sheeté¡µçš„æ•°æ®</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> exportData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">WriteSheet</span> sheet <span class="token operator">=</span> <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">writerSheet</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">,</span> <span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>sheetNames<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>SHEET_NAME <span class="token operator">+</span> itemIndex <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span> sheetNames<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>itemIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>headData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"ExcelExportUtil exportFile in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> writer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                writer<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre>
<p>â€ƒâ€ƒ<strong>ä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹(åœ¨å·¥å…·ä¸­æ¯ä¸ªé¡¹ç›®éƒ½æœ‰å…·ä½“çš„æ¡ˆä¾‹ï¼Œä¸æ‡‚çš„è¿˜å¯ä»¥ç•™è¨€è·Ÿåšä¸»æ²Ÿé€š)ï¼š</strong></p>
<pre><code class="prism language-java"><span class="token comment">/**
     * å¯¼å…¥ç”¨æˆ·æ•°æ®æ¡ˆä¾‹
     *
     * @param file
     */</span>
    <span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadUserListDemoWithExcel</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ­¤å¤„å…ˆæ ¡éªŒå¯¼å…¥çš„æ–‡ä»¶ç±»å‹æ˜¯å¦ä¸ºexcel</span>
        <span class="token class-name">String</span> type <span class="token operator">=</span> <span class="token class-name">FileTypeUtil</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">||</span> type<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">ImportConstant</span><span class="token punctuation">.</span>XLS_TYPE<span class="token punctuation">)</span> <span class="token operator">||</span> type<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">ImportConstant</span><span class="token punctuation">.</span>XLSX_TYPE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è¿”å›æ ¡éªŒå¤±è´¥ä¿¡æ¯</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å¤–å±‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"å¤–å±‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ç»Ÿä¸€å¯¼å…¥æ–¹æ³•</span>
        <span class="token class-name">ExcelImportUtil</span><span class="token punctuation">.</span><span class="token function">importFile</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">UserDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UserServiceImpl</span><span class="token operator">::</span><span class="token function">saveUserList</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

 <span class="token comment">/**
     * å¯¼å‡ºæ¡ˆä¾‹
     *
     * @param response
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportUserListDemoWithExcel</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// è¡¨å¤´(ä½¿ç”¨excelä¸­çš„æ³¨è§£å®šä¹‰ï¼Œå¦‚æœè¡¨å¤´ä¸å›ºå®šï¼Œè¯·ä½¿ç”¨ExcelExportUtil.exportWithDynamicDataè¿›è¡Œå¯¼å‡º)</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserExportVo</span><span class="token punctuation">&gt;</span></span> head <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserExportVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ•°æ®(ä½¿ç”¨ä¸¤å±‚listä¸ºäº†å…¼å®¹å¤šä¸ªsheeté¡µï¼Œå¦‚æœæ˜¯ä¸åŒçš„sheeté¡µåˆ™æ”¾åœ¨ä¸åŒçš„Listé›†åˆä¸­)</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">UserExportVo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> exportDataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserExportVo</span><span class="token punctuation">&gt;</span></span> exportItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥è¯¢æ•°æ®</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> dbData <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†æ•°æ®è½¬æ¢æˆå¯¼å‡ºéœ€è¦çš„å®é™…æ•°æ®æ ¼å¼,æ­¤å¤„åªæ˜¯æ¼”ç¤º</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token operator">:</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">UserExportVo</span> vo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserExportVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> vo<span class="token punctuation">)</span><span class="token punctuation">;</span>
            exportItem<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>vo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        exportDataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>exportItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// sheeté¡µåç§°-è‡ªå®šä¹‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼ ç©º</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sheetNameList <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ExcelExportUtil</span><span class="token punctuation">.</span><span class="token function">exportFile</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> head<span class="token punctuation">,</span> exportDataList<span class="token punctuation">,</span> sheetNameList<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="csv_165"></a>äºŒã€csvå·¥å…·</h3>
<p>â€ƒâ€ƒCsvå³é€—å·åˆ†éš”å€¼ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºå­—ç¬¦åˆ†éš”ç¬¦ï¼Œ<strong>ä¸excelç­‰æ–‡ä»¶ç›¸æ¯”ï¼Œexcelæ–‡ä»¶ä¸­ä¼šåŒ…å«è®¸å¤šæ ¼å¼ä¿¡æ¯ï¼Œå ç”¨çš„ç©ºé—´ä¼šæ›´å¤§ï¼Œæ‰€ä»¥Csvåœ¨å¾ˆå¤šå¤§æ•°æ®åœºæ™¯å¯¼å‡ºã€å¯¼å…¥åœºæ™¯æ˜¯éå¸¸å¸¸è§çš„ã€‚è¯¥å·¥å…·å®ç°é‡‡ç”¨çš„æ˜¯å¼€æºçš„univocity-parsersæ¡†æ¶å®ç°ã€‚</strong></p>
<p>â€ƒâ€ƒä¹‹å‰æœ‰ä¸€ç¯‡ä¸“é—¨è®²è§£è½®å­ä¹‹ç‹é¡¹ç›®ä¸ºä½•ä½¿ç”¨univocity-parsersæ¡†æ¶é›†æˆcsvçš„è¯¦ç»†è¿‡ç¨‹ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥ç‚¹å‡»é“¾æ¥æŸ¥çœ‹ï¼š<a href="https://juejin.cn/post/7099613370248069134">é›†æˆcsvå·¥å…·çš„å‰å› åæœ</a></p>
<p>â€ƒâ€ƒ<strong>éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"> <span class="token comment">/**
     * ä½¿ç”¨å®ä½“beanæ¥æ”¶csvæ•°æ®æ–‡ä»¶å¹¶è¿›è¡Œæ•°æ®è½ç›˜
     *
     * @param inputStream
     * @param errorList
     * @param rowDtoClass
     * @param rowAction
     * @param &lt;T&gt;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">importCsvWithBean</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errorList<span class="token punctuation">,</span> <span class="token class-name">Class</span> rowDtoClass<span class="token punctuation">,</span> <span class="token class-name">ThrowingConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> rowAction<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// å®šä¹‰beanè§£æè€…ï¼šç”¨äºå°†csvä¸­æ•°æ®ç»‘å®šåˆ°å®ä½“å±æ€§ä¸­ï¼Œç„¶åå­˜å‚¨å¸¦listé›†åˆä¸Š</span>
        <span class="token class-name">BeanListProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> rowProcessor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanListProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>rowDtoClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CsvParserSettings</span> setting <span class="token operator">=</span> <span class="token function">getDefaultSetting</span><span class="token punctuation">(</span>errorList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        setting<span class="token punctuation">.</span><span class="token function">setProcessor</span><span class="token punctuation">(</span>rowProcessor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆ›å»ºcsvæ–‡ä»¶è§£æ</span>
        <span class="token class-name">CsvParser</span> csvParser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CsvParser</span><span class="token punctuation">(</span>setting<span class="token punctuation">)</span><span class="token punctuation">;</span>
        csvParser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–æ•°æ®æ˜ å°„åçš„é›†åˆ</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> rowProcessor<span class="token punctuation">.</span><span class="token function">getBeans</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ ¡éªŒå¿…å¡«å­—æ®µ</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">T</span> row <span class="token operator">:</span> dataList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// æ ¡éªŒå¯¼å…¥å­—æ®µ</span>
            <span class="token class-name">ImportValid</span><span class="token punctuation">.</span><span class="token function">validRequireField</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> errorList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ‰§è¡Œæ•°æ®æŒä¹…åŒ–</span>
        <span class="token function">persistentBeanDataToDb</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> rowAction<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
   <span class="token comment">/**
     * å¯¼å‡ºcsvæ–‡ä»¶(è¡¨å¤´å’Œè¡Œéƒ½ä»¥å®ä½“çš„æ–¹å¼)
     *
     * @param response
     * @param head
     * @param rowDataList
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">exportCsvWithBean</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">,</span> <span class="token class-name">T</span> head<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> rowDataList<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">CsvWriter</span> writer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è®¾ç½®å“åº”å¤´æ ¼å¼</span>
            response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>EXCEL_CONTENT_TYPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>CONTENT_DISPOSITION<span class="token punctuation">,</span> <span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>ATTACHMENT_FILENAME <span class="token operator">+</span> fileName <span class="token operator">+</span> <span class="token class-name">ExportConstant</span><span class="token punctuation">.</span>CSV_SUFFIX<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// è®¾ç½®å¯¼å‡ºæ ¼å¼</span>
            <span class="token class-name">CsvWriterSettings</span> setting <span class="token operator">=</span> <span class="token function">getDefaultWriteSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// åˆ›è§beanå¤„ç†å™¨ï¼Œç”¨äºå¤„ç†å†™å…¥æ•°æ®</span>
            <span class="token class-name">BeanWriterProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> beanWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanWriterProcessor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>head<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            setting<span class="token punctuation">.</span><span class="token function">setRowWriterProcessor</span><span class="token punctuation">(</span>beanWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// å¯¼å‡ºæ•°æ®</span>
            writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CsvWriter</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setting<span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">processRecords</span><span class="token punctuation">(</span>rowDataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"CsvExportUtil exportCsvWithBean in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> 

</code></pre>
<p>â€ƒâ€ƒ<strong>ä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹:</strong></p>
<pre><code class="prism language-java"><span class="token comment">/**
     * å¯¼å‡ºæ¡ˆä¾‹
     *
     * @param response
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">exportUserListWithCsv</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserExportCsvVo</span><span class="token punctuation">&gt;</span></span> exportItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æŸ¥è¯¢æ•°æ®</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> dbData <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä½¿ç”¨å­—ç¬¦ä¸²æ•°ç»„æ–¹å¼ä½œä¸ºè¡¨å¤´å¯¼å‡ºcsvæ•°æ®</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> head <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token operator">:</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> row <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            row<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">CsvExportUtil</span><span class="token punctuation">.</span><span class="token function">exportCsvWithString</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">"demo"</span><span class="token punctuation">,</span> head<span class="token punctuation">,</span> dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

 <span class="token comment">/**
     * å¯¼å…¥ç”¨æˆ·æ•°æ®æ¡ˆä¾‹ï¼ˆcsvæ¨¡å¼ï¼‰
     *
     * @param file
     */</span>
<span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadUserListWithCsv</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// æ­¤å¤„å…ˆæ ¡éªŒå¯¼å…¥çš„æ–‡ä»¶ç±»å‹æ˜¯å¦ä¸ºcsv</span>
        <span class="token class-name">String</span> type <span class="token operator">=</span> <span class="token class-name">FileTypeUtil</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token operator">||</span> type<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">ImportConstant</span><span class="token punctuation">.</span>CSV_TYPE<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// è¿”å›æ ¡éªŒå¤±è´¥ä¿¡æ¯</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å¤–å±‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"å¤–å±‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> errorLogList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨ç»Ÿä¸€å¯¼å…¥æ–¹æ³•</span>
        <span class="token comment">// æ–¹å¼ä¸€ï¼šä½¿ç”¨csvæ•°æ®æ˜ å°„åˆ°dtoå®ä½“çš„æ–¹å¼è¿›è¡Œæ•°æ®å¯¼å…¥</span>
        <span class="token comment">//CsvImportUtil.importCsvWithBean(file.getInputStream(), errorLogList, UserCsvDto.class, UserServiceImpl::saveUserListWithCsv);</span>

        <span class="token comment">// æ–¹å¼äºŒã€ä½¿ç”¨csvæ•°æ®æ˜ å°„åˆ°å­—ç¬¦ä¸²æ•°ç»„çš„æ–¹å¼è¿›è¡Œæ•°æ®å¯¼å…¥</span>
        <span class="token class-name">CsvImportUtil</span><span class="token punctuation">.</span><span class="token function">importCsvWithString</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> errorLogList<span class="token punctuation">,</span> <span class="token class-name">UserCsvDto</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">UserServiceImpl</span><span class="token operator">::</span><span class="token function">saveUserListWithCsvStringArrDemo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å¦‚æœå­˜åœ¨è§£æå¼‚å¸¸ï¼Œè¾“å‡ºè§£æå¼‚å¸¸å¹¶è¿›è¡Œäº‹åŠ¡å›æ»š</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>errorLogList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>errorLogList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
</code></pre>
<h3><a id="ftp_298"></a>ä¸‰ã€ftpå·¥å…·</h3>
<p>â€ƒâ€ƒFtpæ–‡ä»¶ä¸Šä¼ ä¸‹è½½ç›¸æ¯”excelã€csvç­‰å‡ºç°çš„åœºæ™¯è¾ƒå°‘ï¼Œ<strong>ä½†æ˜¯ï¼Œå¦‚æœä½ å‚ä¸çš„é¡¹ç›®æ˜¯æ”¿åºœæˆ–è€…æ¶‰åŠåˆ°ç¬¬ä¸‰æ–¹æ—§ç³»ç»Ÿå¯¹æ¥çš„æ—¶å€™ï¼Œå¾ˆå¤šæ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°å®ƒã€‚å› ä¸ºå¾ˆå¤šæ—§ç³»ç»Ÿæˆ–è€…æ”¿åºœé¡¹ç›®ä½¿ç”¨çš„æŠ€æœ¯æ¯”è¾ƒæ—§æˆ–è€…æœ‰åˆ¶åº¦é™åˆ¶ï¼Œä¸€èˆ¬éƒ½æ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼ä¸ä½ è¿›è¡Œäº¤äº’ï¼Œæ­¤æ—¶ftpå·¥å…·å°±å¾ˆæœ‰æ•ˆäº†ã€‚</strong></p>
<p>â€ƒâ€ƒFtpå·¥å…·ä½¿ç”¨çš„commons-netå¼€æºæ¡†æ¶è¿›è¡Œå®ç°ï¼Œå…·ä½“çš„é›†æˆæµç¨‹ä¹‹å‰å•ç‹¬ä½¿ç”¨ä¸€ç¯‡æ–‡ç« è¿›è¡Œäº†éå¸¸è¯¦ç»†çš„ä»‹ç»ï¼Œæœ‰éœ€è¦çš„è¯»è€…å¯ä»¥ç‚¹å‡»åé¢é“¾æ¥æŸ¥çœ‹ï¼š<a href="https://juejin.cn/post/7025778008791187469">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºftpæœåŠ¡å™¨ï¼Œå¹¶ç”¨ç¨‹åºå®Œæˆftpä¸Šä¼ ä¸‹è½½åŠŸèƒ½</a></p>
<p>â€ƒâ€ƒ<strong>éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"><span class="token comment">/**
     * ä¸Šä¼ 
     *
     * @return
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">FtpUploadParam</span> param<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">FTPClient</span> ftpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FTPClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1 æµ‹è¯•è¿æ¥</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">connect</span><span class="token punctuation">(</span>ftpClient<span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getHostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//2 æ£€æŸ¥å·¥ä½œç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ftpClient<span class="token punctuation">.</span><span class="token function">changeWorkingDirectory</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getWorkingPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    ftpClient<span class="token punctuation">.</span><span class="token function">makeDirectory</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getWorkingPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// å°†æ–‡ä»¶ç¼–ç æˆFtpæœåŠ¡å™¨æ”¯æŒçš„ç¼–ç ç±»å‹ï¼ˆFTPåè®®é‡Œé¢ï¼Œè§„å®šæ–‡ä»¶åç¼–ç ä¸ºiso-8859-1ï¼Œæ‰€ä»¥ç›®å½•åæˆ–æ–‡ä»¶åéœ€è¦è½¬ç ã€‚ï¼‰</span>
                <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span><span class="token function">getSaveName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span>ftpClientCharset<span class="token punctuation">)</span><span class="token punctuation">,</span> ftpServerCharset<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 3 ä¸Šä¼ æ–‡ä»¶</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ftpClient<span class="token punctuation">.</span><span class="token function">storeFile</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                    log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"FtpUtils uploadFile unsuccessfully!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"FtpUtils upload in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">disconnect</span><span class="token punctuation">(</span>ftpClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> flag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">/**
     * @description: ä¸‹è½½ftpæ–‡ä»¶
     * @param:
     * @param: param
     * @param: downloadFileName
     * @return:
     * @date: 2022/7/14 10:56
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">FtpDownloadParam</span> param<span class="token punctuation">,</span> <span class="token class-name">String</span> downloadFileName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FTPClient</span> ftpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FTPClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> downloadResult <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment">//1 æµ‹è¯•è¿æ¥</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">connect</span><span class="token punctuation">(</span>ftpClient<span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getHostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">String</span> localPath <span class="token operator">=</span> param<span class="token punctuation">.</span><span class="token function">getDownloadPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> param<span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>localPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//2 æ£€æŸ¥å·¥ä½œç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨è¿”å›</span>
                <span class="token comment">// if (!ftpClient.changeWorkingDirectory(param.getWorkingPath())) {<!-- --></span>
                <span class="token comment">//    return false;</span>
                <span class="token comment">// }</span>
                <span class="token comment">/*
                 * æ‰“å¼€FTPæœåŠ¡å™¨çš„PASSæ¨¡å¼(ä¸è®°å¾—FTPåè®®æ”¯æŒçš„æ¨¡å¼è¯·ç¿»åˆ°æ–‡ç« ç¬¬ä¸€é˜¶æ®µ)
                 * è¿™ä¸ªæ–¹æ³•çš„æ„æ€å°±æ˜¯æ¯æ¬¡æ•°æ®è¿æ¥ä¹‹å‰ï¼Œftp clientå‘Šè¯‰ftp serverå¼€é€šä¸€ä¸ªç«¯å£æ¥ä¼ è¾“æ•°æ®. å› ä¸ºftp
                 * serverå¯èƒ½æ¯æ¬¡å¼€å¯ä¸åŒçš„ç«¯å£æ¥ä¼ è¾“æ•°æ®ï¼Œä½†æ˜¯åœ¨linuxä¸Šï¼Œç”±äºå®‰å…¨é™åˆ¶ï¼Œå¯èƒ½æŸäº›ç«¯å£æ²¡æœ‰å¼€å¯ï¼Œå¯èƒ½å‡ºç°å‡ºç°é˜»å¡
                 */</span>
                ftpClient<span class="token punctuation">.</span><span class="token function">enterLocalPassiveMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è®¾ç½®æ–‡ä»¶çš„ä¼ è¾“æ–¹å¼-äºŒè¿›åˆ¶</span>
                ftpClient<span class="token punctuation">.</span><span class="token function">setFileType</span><span class="token punctuation">(</span>FTP<span class="token punctuation">.</span>BINARY_FILE_TYPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å°†æ–‡ä»¶ç¼–ç æˆFtpæœåŠ¡å™¨æ”¯æŒçš„ç¼–ç ç±»å‹ï¼ˆFTPåè®®é‡Œé¢ï¼Œè§„å®šæ–‡ä»¶åç¼–ç ä¸ºiso-8859-1ï¼Œæ‰€ä»¥ç›®å½•åæˆ–æ–‡ä»¶åéœ€è¦è½¬ç ã€‚ï¼‰</span>
                <span class="token comment">// ç¼ºå°‘ç¼–ç è½¬æ¢ä¼šå¯¼è‡´ï¼šä»FTPæœåŠ¡å™¨ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶æ˜¯ç ´æŸçš„ï¼Œæ— æ³•è¢«æ‰“å¼€</span>
                downloadResult <span class="token operator">=</span> ftpClient<span class="token punctuation">.</span><span class="token function">retrieveFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>downloadFileName
                        <span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span>ftpClientCharset<span class="token punctuation">)</span><span class="token punctuation">,</span> ftpServerCharset<span class="token punctuation">)</span><span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
                out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"FtpUtils upload in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">nonNull</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"FtpUtils upload in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token function">disconnect</span><span class="token punctuation">(</span>ftpClient<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> downloadResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>â€ƒâ€ƒ<strong>å…·ä½“ä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/ftp/upload"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">FtpUploadParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FtpUploadParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setHostname</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerHostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setWorkingPath</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerWorkingPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setSaveName</span><span class="token punctuation">(</span><span class="token string">"xxx.mp3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">InputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:/uploadfile/like.mp3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setInputStream</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ftpUtils<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestFtpServerController upload é”™è¯¯:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/ftp/download"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">FtpDownloadParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FtpDownloadParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setHostname</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerHostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setWorkingPath</span><span class="token punctuation">(</span>ftpConfig<span class="token punctuation">.</span><span class="token function">getServerWorkingPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setDownloadPath</span><span class="token punctuation">(</span><span class="token string">"D:/downloadFile/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            param<span class="token punctuation">.</span><span class="token function">setFileName</span><span class="token punctuation">(</span><span class="token string">"xxx.mp3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ftpUtils<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span> <span class="token string">"xxxx.mp3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestFtpServerController download é”™è¯¯:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

</code></pre>
<h3><a id="_431"></a>å››ã€åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå·¥å…·</h3>
<p>â€ƒâ€ƒ<strong>éç»“æ„åŒ–æ•°æ®é€šå¸¸æ˜¯ä½¿ç”¨æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ—¶å€™ä¸å¯é¿å…åœ°è¦ä½¿ç”¨åˆ°æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œç®¡ç†ã€‚</strong> åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå·¥å…·ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹å¼€æºæ¡†æ¶seaweedfsè¿›è¡Œæ­å»ºï¼Œå¯ä»¥å®ç°ç¨‹åºä¸Šä¼ ï¼Œåˆ é™¤ã€ä¸‹è½½ã€æŸ¥è¯¢ï¼Œå¹¶æœ‰æ–‡ä»¶åˆ†å¸ƒå¼å­˜å‚¨ï¼Œé¿å…å•ç‚¹æ•…éšœï¼ŒèŠ‚çº¦æˆæœ¬ç­‰ç‰¹ç‚¹ã€‚</p>
<p>â€ƒâ€ƒå‰é¢ä¹Ÿä¸“é—¨é€šè¿‡ä¸€ç¯‡æ–‡ç« è®²è§£äº†ï¼šä¸ºä½•è¦ä½¿ç”¨seaweedfsæ¡†æ¶æ­å»ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥é€šè¿‡ä¸‹æ–¹é“¾æ¥è¿›è¡ŒæŸ¥çœ‹ï¼š<a href="https://juejin.cn/post/7127104556328026148">Giteeå›¾åºŠå´©æºƒåï¼Œæˆ‘ä½¿ç”¨Seaweedfsæ­å»ºäº†æ–‡ä»¶ç³»ç»Ÿå¹¶å°è£…æˆè½®å­å¼€æº</a></p>
<p>â€ƒâ€ƒ<strong>éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"><span class="token comment">/**
     * @description: ä¸Šä¼ å•ä¸ªæ–‡ä»¶åˆ°æ–‡ä»¶æœåŠ¡å™¨
     * @param: file
     * @return: æ–‡ä»¶çš„fid + æ–‡ä»¶çš„è¯·å…¨è®¿é—®åœ°å€
     * @author: it
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileSource</span> fileSource <span class="token operator">=</span> <span class="token function">getFileSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileTemplate</span> fileTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileTemplate</span><span class="token punctuation">(</span>fileSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸Šä¼ æ–‡ä»¶</span>
        <span class="token class-name">FileHandleStatus</span> handleStatus <span class="token operator">=</span> fileTemplate<span class="token punctuation">.</span><span class="token function">saveFileByStream</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> contentType<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–ä¸Šä¼ æ–‡ä»¶çš„è®¿é—®åœ°å€</span>
        <span class="token class-name">String</span> fileUrl <span class="token operator">=</span> fileTemplate<span class="token punctuation">.</span><span class="token function">getFileUrl</span><span class="token punctuation">(</span>handleStatus<span class="token punctuation">.</span><span class="token function">getFileId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…³é—­å½“å‰è¿æ¥</span>
        fileSource<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> handleStatus<span class="token punctuation">.</span><span class="token function">getFileId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span>DASHED <span class="token operator">+</span> fileUrl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment">/**
     * @description: æ ¹æ®æ–‡ä»¶ä¸‹è½½æ–‡ä»¶
     * @param: fid
     * @param: response
     * @param: fileName
     * @author: it
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFileByFid</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> fid<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileSource</span> fileSource <span class="token operator">=</span> <span class="token function">getFileSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileTemplate</span> fileTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileTemplate</span><span class="token punctuation">(</span>fileSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StreamResponse</span> fileStream <span class="token operator">=</span> fileTemplate<span class="token punctuation">.</span><span class="token function">getFileStream</span><span class="token punctuation">(</span>fid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¾ç½®å“åº”å¤´</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>CONTENT_TYPE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> encodeFileName <span class="token operator">=</span> <span class="token function">buildingFileNameAdapterBrowser</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>CONTENT_DISPOSITION<span class="token punctuation">,</span> <span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>ATTACHMENT_FILENAME <span class="token operator">+</span> encodeFileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¯»å–å¹¶å†™å…¥åˆ°å“åº”è¾“å‡º</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> fileStream<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fileByte <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>inputStream<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        inputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fileByte<span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileByte<span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fileSource<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>â€ƒâ€ƒ<strong>å…·ä½“ä½¿ç”¨æ¡ˆä¾‹å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="prism language-java"><span class="token comment">/**
     * @description: ä¸Šä¼ æ–‡ä»¶
     * @param:
     * @param: file
     * @return:
     * @author: it
     * @date: 2022/7/14 17:01
     */</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"upload"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> fileUrl <span class="token operator">=</span> seaweedFsUtil<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fileUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestSeaweedFsController uploadFile in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @description: ä¸‹è½½æ–‡ä»¶
     * @param:
     * @param: fileId
     * @return:
     * @author: it
     * @date: 2022/7/14 17:01
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"download"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> fileId<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            seaweedFsUtil<span class="token punctuation">.</span><span class="token function">downloadFileByFid</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> request<span class="token punctuation">,</span> fileId<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"TestSeaweedFsController downloadFile in error:{}"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="_524"></a>å·¥å…·æ›´æ–°</h2>
<p>â€ƒâ€ƒåˆ°æ­¤ä¸ºæ­¢ï¼Œè½®å­ä¹‹ç‹å·²é›†æˆçš„å·¥å…·å°±ä»‹ç»å®Œæ¯•äº†ï¼Œåç»­è¿˜ä¼šä¸æ–­æ›´æ–°ã€é›†æˆæ–°çš„è½®å­ï¼Œä¸‹é¢ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹ä¸‹ä¸€æ®µæ—¶é—´é¡¹ç›®çš„ä¸€äº›å·¥ä½œ(<strong>å¦‚æœè¯»è€…æœ‰æƒ³è¦é›†æˆçš„è½®å­ï¼Œæ¬¢è¿æissueæˆ–è€…è¿™æ–‡ç« ä¸‹é¢ç•™è¨€</strong>)ï¼š</p>
<ul><li>é›†æˆä¸€ä¸ªå¯è§†åŒ–ç•Œé¢ï¼Œæ›´å¥½åœ°ä»‹ç»å¼€æºå·¥å…·ä¸­å„ä¸ªè½®å­çš„å¼•å…¥æ¡ˆä¾‹ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ã€‚</li><li>é›†æˆwordæ–‡ä»¶å¯¼å‡ºå·¥å…·</li><li>é›†æˆpdfæ–‡ä»¶å¯¼å‡ºå·¥å…·</li><li>é›†æˆå¤æ‚æŠ¥è¡¨çš„æŠ¥è¡¨å¯¼å‡ºå·¥å…·(ä½¿ç”¨freemakeræ¡†æ¶)</li><li>å¾…æ›´æ–°â€¦</li></ul>
<h2><a id="_534"></a>é›†æˆæ–¹æ¡ˆä»‹ç»å…³è”æ–‡ç« </h2>
<ul><li><a href="https://blog.csdn.net/qq_40891009/article/details/120497976">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºftpæœåŠ¡å™¨ï¼Œå¹¶ç”¨ç¨‹åºå®Œæˆftpä¸Šä¼ ä¸‹è½½åŠŸèƒ½</a></li><li><a href="https://blog.csdn.net/qq_40891009/article/details/124874311">é›†æˆcsvå·¥å…·çš„å‰å› åæœ</a></li><li><a href="https://it-learning-diary.blog.csdn.net/article/details/126114259">Giteeå›¾åºŠå´©æºƒåï¼Œæˆ‘ä½¿ç”¨Seaweedfsæ­å»ºäº†æ–‡ä»¶ç³»ç»Ÿå¹¶å°è£…æˆè½®å­å¼€æº</a></li></ul>
<h2><a id="_541"></a>å†™åœ¨æœ€å</h2>
<p>â€ƒâ€ƒå¼€æºä¹‹è·¯ä¸å®¹æ˜“ï¼Œå¼€æºä¹‹å¿ƒä¸å¿˜è®°ï¼<strong>å¦‚æœåšä¸»å¼€æºçš„é¡¹ç›®å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œè¯·ç»™é¡¹ç›®starï¼Œç»™åšä¸»æ›´å¤šåŠ¨åŠ›ï¼Œå¦‚æœé˜…è¯»æ–‡ç« ç»™æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œè¯·ç»™åšä¸»ç‚¹èµã€å…³æ³¨ã€‚</strong></p>
<p>â€ƒâ€ƒè¯¥å¼€æºé¡¹ç›®ä¼šæŒç»­æ›´æ–°å’Œç»´æŠ¤ï¼Œå¸Œæœ›æœ‰æ›´å¤šè¯»è€…èƒ½å¤Ÿæå‡ºå»ºè®®å’Œæƒ³æ³•ï¼Œ<strong>å¦‚æœæœ‰éœ€è¦é›†æˆçš„å·¥å…·ï¼Œæ¬¢è¿ç»™é¡¹ç›®æissueæˆ–è€…è¿™æ–‡ç« ä¸‹é¢ç•™è¨€ï¼Œåšä¸»çœ‹åˆ°åä¼šåŠæ—¶å›å¤ã€‚</strong></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>