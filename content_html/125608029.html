<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-github-gist" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/8b4a4855fe7444ba859925a594c3791b.jpeg#pic_center"/><br/> 本文主要介绍了<code>Node.js</code>常用的文件操作方法，以及常见的处理场景，文件追加，文件夹递归删除等。</p>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#Nodejs9_4">Node.js中9种必须要掌握的文件操作方法</a></li><li><ul><li><a href="#_6">一、前言</a></li><li><a href="#fsmkdir_20">二、fs.mkdir()创建文件夹</a></li><li><ul><li><a href="#21__39">2.1 最简单的案例</a></li><li><a href="#22__58">2.2 递归创建文件夹</a></li></ul>
</li><li><a href="#fswirteFile_80">三、fs.wirteFile()创建、写文件</a></li><li><ul><li><a href="#31__105">3.1 创建并写入一个文件</a></li><li><a href="#32__123">3.2 重写文件并指定编码</a></li><li><a href="#33_GBK_143">3.3 写入GBK格式的文件</a></li></ul>
</li><li><a href="#fsappendFile_166">四、fs.appendFile()文件后追加内容</a></li><li><ul><li><a href="#41__186">4.1 使用追加的方式创建并写入内容</a></li><li><a href="#42__202">4.2 追加内容</a></li></ul>
</li><li><a href="#fsstat_218">五、fs.stat()判断路径是目录还是文件</a></li><li><ul><li><a href="#51__236">5.1 判断文件案例</a></li></ul>
</li><li><a href="#fsreadFile_255">六、fs.readFile()读取文件内容</a></li><li><ul><li><a href="#61__275">6.1 以默认格式读取文件</a></li><li><a href="#62_GBK_295">6.2 以指定格式（这里是GBK）读取文件</a></li></ul>
</li><li><a href="#fsreaddir_315">七、fs.readdir()读取文件夹中的内容</a></li><li><ul><li><a href="#71__334">7.1 读取文件夹案例</a></li><li><a href="#72__363">7.2 获取文件类型</a></li></ul>
</li><li><a href="#fsraname_392">八、fs.raname()重命名、移动文件</a></li><li><ul><li><a href="#81__406">8.1 重命名文件</a></li><li><a href="#82__443">8.2 移动文件</a></li></ul>
</li><li><a href="#fsunlink_476">九、fs.unlink()删除文件</a></li><li><ul><li><a href="#91__480">9.1 删除文件案例</a></li></ul>
</li><li><a href="#fsrmdir_512">十、fs.rmdir()删除文件夹</a></li><li><ul><li><a href="#101__533">10.1 删除空的文件夹</a></li><li><a href="#102__585">10.2 删除非空的文件夹</a></li></ul>
</li><li><a href="#_620">十一、总结</a></li><li><a href="#_634">十二、本文源码</a></li></ul>
</li></ul>
</div>
<p></p>
<h1><a id="Nodejs9_4"></a>Node.js中9种必须要掌握的文件操作方法</h1>
<h2><a id="_6"></a>一、前言</h2>
<ol><li>fs.mkdir()</li><li>fs.writeFile()</li><li>fs.appendFile()</li><li>fs.stat()</li><li>fs.readFile()</li><li>fs.readdir()</li><li>fs.rename()</li><li>fs.unlink()</li><li>fs.rmdir()</li></ol>
<h2><a id="fsmkdir_20"></a>二、fs.mkdir()创建文件夹</h2>
<p>异步的创建一个文件夹。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token punctuation">,</span>options<span class="token punctuation">]</span><span class="token punctuation">,</span>callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt; | &lt;integer&gt;
 * recursive &lt;boolean&gt; 默认值: false
 * mode &lt;string&gt; | &lt;integer&gt; Windows 上不支持。 默认值: 0o777。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * path &lt;string&gt; | &lt;undefined&gt; 仅当创建目录时将 recursive 设置为 true。
 */</span>
</code></pre>
<h3><a id="21__39"></a>2.1 最简单的案例</h3>
<p>最简单的案例，在当前目录下创建一个<code>temp</code>文件夹：</p>
<pre><code class="prism language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">'./temp'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'创建文件夹成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704150029913" src="https://img-blog.csdnimg.cn/img_convert/be69dd98726bb7d3b83bb5ee6d37a428.png"/></p>
<h3><a id="22__58"></a>2.2 递归创建文件夹</h3>
<p>使用参数<code>{recursive:true}</code>创建多层次的文件夹。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">'./parent/son/grandson'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">recursive</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>path</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'递归创建文件夹成功'</span><span class="token punctuation">,</span>path<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704150941247" src="https://img-blog.csdnimg.cn/img_convert/e51b637a7b57d82801ff01767e50ac66.png"/></p>
<p><strong>注意：</strong> 在使用<code>{recursive:true}</code>参数时，回调对应的会增加一个<code>path</code>参数，其他情况下没有。</p>
<h2><a id="fswirteFile_80"></a>三、fs.wirteFile()创建、写文件</h2>
<p>当 <code>file</code> 是文件名时，将数据异步地写入文件，如果文件已存在则替换该文件。 <code>data</code> 可以是字符串或缓冲区。</p>
<p>当 <code>file</code> 是文件描述符时，其行为类似于直接调用 <code>fs.write()</code>（<strong>本文不涉及这种情况</strong>）。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * file &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;integer&gt; 文件名或文件描述符
 * data &lt;string&gt; | &lt;Buffer&gt; | &lt;TypedArray&gt; | &lt;DataView&gt; | &lt;Object&gt;
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: 'utf8'
 * mode &lt;integer&gt; 默认值: 0o666
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'w'。
 * signal &lt;AbortSignal&gt; 允许中止正在进行的写入文件
 * callback &lt;Function&gt;
 * err &lt;Error&gt; | &lt;AggregateError&gt;
 */</span>
</code></pre>
<h3><a id="31__105"></a>3.1 创建并写入一个文件</h3>
<p>创建一个名为<code>index.html</code>的文件，并写入一行字符串。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token string">"&lt;h1&gt;你好，中国&lt;/h1&gt;"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"创建写入文件成功"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果如下：</p>
<p><img alt="image-20220704152812122" src="https://img-blog.csdnimg.cn/img_convert/b31267acb94357a626436e8847607309.png"/></p>
<h3><a id="32__123"></a>3.2 重写文件并指定编码</h3>
<p>重写<code>index.html</code>，并为文件指定编码：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token string">'&lt;h2&gt;面朝大海，春暖花开&lt;/h2&gt;'</span><span class="token punctuation">,</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入指定格式文件成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行效果如下：</p>
<p><img alt="image-20220704154454936" src="https://img-blog.csdnimg.cn/img_convert/24950b5e1ab21a99b4d2489a646b72cd.png"/></p>
<p>原文件内容被覆盖。</p>
<h3><a id="33_GBK_143"></a>3.3 写入GBK格式的文件</h3>
<p><code>Node.js</code>仅支持<code>utf8 ucs2 ascii binary base64 hex</code>这几种格式，对于<code>GBK</code>，<code>GB2312</code>等特殊格式需要使用额外的库（这里使用<code>iconv-lite</code>）。</p>
<p>案例：</p>
<pre><code class="prism language-js"><span class="token keyword">const</span> iconv <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'iconv-lite'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./style.css'</span><span class="token punctuation">,</span>iconv<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">'面朝大海，春暖花开'</span><span class="token punctuation">,</span><span class="token string">'gbk'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"以GBK格式写入成功"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704171140551" src="https://img-blog.csdnimg.cn/img_convert/eaa495defbbead03997e6e916a8c83c1.png"/></p>
<p>注意底部的编码格式，如果使用<code>utf-8</code>打开文件会乱码的呦！</p>
<h2><a id="fsappendFile_166"></a>四、fs.appendFile()文件后追加内容</h2>
<p>异步地将数据追加到文件，如果该文件尚不存在，则创建该文件。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;number&gt; 文件名或文件描述符
 * data &lt;string&gt; | &lt;Buffer&gt;
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: 'utf8'
 * mode &lt;integer&gt; 默认值: 0o666
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'a'。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>
</code></pre>
<h3><a id="41__186"></a>4.1 使用追加的方式创建并写入内容</h3>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token string">'测试写入'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"使用追加的方式创建并写入文件"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704194103819" src="https://img-blog.csdnimg.cn/img_convert/8ab1544bc3ca1098780336b359c7b970.png"/></p>
<h3><a id="42__202"></a>4.2 追加内容</h3>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./test.txt'</span><span class="token punctuation">,</span> <span class="token string">"\n追加测试"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'在已经存在的文件中追加内容'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704194010770" src="https://img-blog.csdnimg.cn/img_convert/5211044dab3a881d79d47e2a6bf8cce9.png"/></p>
<h2><a id="fsstat_218"></a>五、fs.stat()判断路径是目录还是文件</h2>
<p>判断路径是文件还是目录。</p>
<p>语法：</p>
<pre><code class="prism language-js"> fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt;
 * bigint &lt;boolean&gt; 返回的 &lt;fs.Stats&gt; 对象中的数值是否应为 bigint。 默认值: false。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * stats &lt;fs.Stats&gt;
 */</span>
</code></pre>
<h3><a id="51__236"></a>5.1 判断文件案例</h3>
<p>判断<code>index.html</code>是文件还是目录。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>stats</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./index.html是文件：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./index.html是目录：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行效果：</p>
<p><img alt="image-20220704155406486" src="https://img-blog.csdnimg.cn/img_convert/a976be40ebb7f3c1a8674370ad3d79b4.png"/></p>
<h2><a id="fsreadFile_255"></a>六、fs.readFile()读取文件内容</h2>
<p>异步地读取文件的全部内容。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;integer&gt; 文件名或文件描述符
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: null
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'r'。
 * signal &lt;AbortSignal&gt; 允许中止正在进行的读取文件
 * callback &lt;Function&gt;
 * err &lt;Error&gt; | &lt;AggregateError&gt;
 * data &lt;string&gt; | &lt;Buffer&gt;
 */</span>
</code></pre>
<h3><a id="61__275"></a>6.1 以默认格式读取文件</h3>
<p>以默认的格式（<code>utf-8</code>）读取文件内容：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">读取文件成功，文件内容是：\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<p><img alt="image-20220704162501845" src="https://img-blog.csdnimg.cn/img_convert/6a4e002678c486b4de8423b37b4c75f3.png"/></p>
<p>如果要读取的文件不是<code>utf-8</code>格式，就会出现乱码，这时就需要指定读取格式。</p>
<h3><a id="62_GBK_295"></a>6.2 以指定格式（这里是GBK）读取文件</h3>
<p>遗憾的是，<code>node.js</code>不支持除了<code>utf8 ucs2 ascii binary base64 hex</code>之外的编码，我们需要使用额外的包（<code>iconv-lite</code>）读取<code>GBK</code>文件：</p>
<pre><code class="prism language-js"><span class="token keyword">const</span> iconv <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'iconv-lite'</span><span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">读取文件成功，文件内容是：\n</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"读取文件成功，文件内容是：\n"</span><span class="token punctuation">,</span>iconv<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token string">'gbk'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果如下：</p>
<p><img alt="image-20220704170140585" src="https://img-blog.csdnimg.cn/img_convert/09e3aecf0b356f9005cfc9f11a064183.png"/></p>
<h2><a id="fsreaddir_315"></a>七、fs.readdir()读取文件夹中的内容</h2>
<p>读取目录的内容。 回调有两个参数 <code>(err, files)</code>，其中 <code>files</code> 是目录中文件名的数组，不包括 <code>'.'</code> 和 <code>'..'</code>。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;string&gt; | &lt;Object&gt;
 * encoding &lt;string&gt; 默认值: 'utf8'
 * withFileTypes &lt;boolean&gt; 默认值: false
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * files &lt;string[]&gt; | &lt;Buffer[]&gt; | &lt;fs.Dirent[]&gt;
 */</span>
</code></pre>
<h3><a id="71__334"></a>7.1 读取文件夹案例</h3>
<p>读取当前文件夹下所有的文件。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>files</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS D:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Study<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
<span class="token punctuation">[</span>
  <span class="token string">'01-fs.js'</span>,
  <span class="token string">'index.html'</span>,       
  <span class="token string">'node_modules'</span>,     
  <span class="token string">'package-lock.json'</span>,
  <span class="token string">'package.json'</span>,     
  <span class="token string">'style.css'</span>,
  <span class="token string">'temp'</span>
<span class="token punctuation">]</span>
</code></pre>
<h3><a id="72__363"></a>7.2 获取文件类型</h3>
<p>我们可以在读取文件列表的时候，获取文件的类型。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">withFileTypes</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>files</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS D:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Study<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
<span class="token punctuation">[</span>
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'01-fs.js'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">1</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'index.html'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">1</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'node_modules'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">2</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'package-lock.json'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">1</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'package.json'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">1</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'style.css'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">1</span> <span class="token punctuation">}</span>,
  Dirent <span class="token punctuation">{<!-- --></span> name: <span class="token string">'temp'</span>, <span class="token punctuation">[</span>Symbol<span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">]</span>: <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre>
<h2><a id="fsraname_392"></a>八、fs.raname()重命名、移动文件</h2>
<p>将 <code>oldPath</code> 处的文件异步重命名为作为 <code>newPath</code> 提供的路径名。 如果 <code>newPath</code> 已经存在，则它将被覆盖。 如果在 <code>newPath</code> 中有目录，则会引发错误。 除了可能的异常之外，没有为完成回调提供任何参数。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>oldPath<span class="token punctuation">,</span> newPath<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * oldPath &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * newPath &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>
</code></pre>
<h3><a id="81__406"></a>8.1 重命名文件</h3>
<p>将<code>index.html</code>重命名为<code>main.html</code>。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span> <span class="token string">'./main.html'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'重命名成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
重命名成功
PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span>


    目录: E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          <span class="token number">2022</span>/7/4     <span class="token number">18</span>:43                node_modules
da----          <span class="token number">2022</span>/7/4     <span class="token number">17</span>:33                temp
-a----          <span class="token number">2022</span>/7/4     <span class="token number">19</span>:48           <span class="token number">6210</span> 01-fs.js
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:23             <span class="token number">27</span> main.html         <span class="token punctuation">(</span>*<span class="token punctuation">)</span>
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:58           <span class="token number">1455</span> package-lock.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:57             <span class="token number">55</span> package.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">17</span>:05             <span class="token number">18</span> style.css
-a----          <span class="token number">2022</span>/7/4     <span class="token number">19</span>:40             <span class="token number">12</span> test.txt
</code></pre>
<h3><a id="82__443"></a>8.2 移动文件</h3>
<p>将<code>./main.html</code>移动到<code>./temp/main.html</code>。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./main.html'</span><span class="token punctuation">,</span> <span class="token string">'./temp/main.html'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'移动文件成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
移动文件成功
PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span> .<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>     


    目录: E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token punctuation">\</span>temp


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:23             <span class="token number">27</span> main.html


PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span>
</code></pre>
<h2><a id="fsunlink_476"></a>九、fs.unlink()删除文件</h2>
<p>异步地删除文件或符号链接。 除了可能的异常之外，没有为完成回调提供任何参数。</p>
<h3><a id="91__480"></a>9.1 删除文件案例</h3>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'./temp/main.html'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"删除文件成功"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span> .<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>


    目录: E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token punctuation">\</span>temp


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----          <span class="token number">2022</span>/7/4     <span class="token number">20</span>:03              <span class="token number">0</span> main.html


PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
删除文件成功
PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span> .<span class="token punctuation">\</span>temp<span class="token punctuation">\</span>
PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> 
</code></pre>
<h2><a id="fsrmdir_512"></a>十、fs.rmdir()删除文件夹</h2>
<p>删除指定路径的文件夹。</p>
<p>语法：</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span>path<span class="token punctuation">[</span><span class="token punctuation">,</span> options<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
<span class="token comment">/**
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt;
 * maxRetries &lt;integer&gt; 如果遇到 EBUSY、EMFILE、ENFILE、ENOTEMPTY 或 EPERM 错误，
 *           Node.js 将在每次尝试时以 retryDelay 毫秒的线性退避等待时间重试该操作。 
 *           此选项表示重试次数。 如果 recursive 选项不为 true，则忽略此选项。 默认值: 0。
 * recursive &lt;boolean&gt; 如果为 true，则执行递归目录删除。 在递归模式下，操作将在失败时重试。 默认值: false。 已弃用。
 * retryDelay &lt;integer&gt; 重试之间等待的时间（以毫秒为单位）。 如果 recursive 选项不为 true，则忽略此选项。 默认值: 100。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>
</code></pre>
<h3><a id="101__533"></a>10.1 删除空的文件夹</h3>
<p>删除<code>./temp</code>文件夹。</p>
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'./temp'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除空的文件夹'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span> <span class="token builtin class-name">.</span>      


    目录: E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          <span class="token number">2022</span>/7/4     <span class="token number">18</span>:43                node_modules
da----          <span class="token number">2022</span>/7/4     <span class="token number">20</span>:03                temp
-a----          <span class="token number">2022</span>/7/4     <span class="token number">20</span>:09           <span class="token number">7666</span> 01-fs.js
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:58           <span class="token number">1455</span> package-lock.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:57             <span class="token number">55</span> package.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">17</span>:05             <span class="token number">18</span> style.css
-a----          <span class="token number">2022</span>/7/4     <span class="token number">19</span>:40             <span class="token number">12</span> test.txt


PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
删除空的文件夹
PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">ls</span>


    目录: E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          <span class="token number">2022</span>/7/4     <span class="token number">18</span>:43                node_modules
-a----          <span class="token number">2022</span>/7/4     <span class="token number">20</span>:09           <span class="token number">7666</span> 01-fs.js
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:58           <span class="token number">1455</span> package-lock.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">16</span>:57             <span class="token number">55</span> package.json
-a----          <span class="token number">2022</span>/7/4     <span class="token number">17</span>:05             <span class="token number">18</span> style.css
-a----          <span class="token number">2022</span>/7/4     <span class="token number">19</span>:40             <span class="token number">12</span> test.txt
</code></pre>
<h3><a id="102__585"></a>10.2 删除非空的文件夹</h3>
<p>这里使用的是同步的文件处理函数，用于递归的删除文件夹。</p>
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//同步读取文件夹</span>
    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>             <span class="token comment">//删除文件夹中的所有文件/夹</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> stats <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">emptyDir</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">删除</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">文件成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>                  <span class="token comment">//删除文件夹</span>
<span class="token punctuation">}</span>

<span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token string">'./node_modules'</span><span class="token punctuation">)</span>
</code></pre>
<p>代码执行结果：</p>
<pre><code class="prism language-bash">PS E:<span class="token punctuation">\</span>Code<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>demos<span class="token operator">&gt;</span> <span class="token function">node</span> .<span class="token punctuation">\</span>01-fs.js
删除.package-lock.json文件成功
删除dependabot.yml文件成功
删除codeStyleConfig.xml文件成功
删除Project.xml文件成功
删除iconv-lite.iml文件成功
<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.
</code></pre>
<h2><a id="_620"></a>十一、总结</h2>
<p>本文总结了<code>Node.js</code>常用的文件操作方法，以及常见的文件处理场景。主要包括：</p>
<ol><li>fs.mkdir()</li><li>fs.writeFile()</li><li>fs.appendFile()</li><li>fs.stat()</li><li>fs.readFile()</li><li>fs.readdir()</li><li>fs.rename()</li><li>fs.unlink()</li><li>fs.rmdir()</li></ol>
<h2><a id="_634"></a>十二、本文源码</h2>
<pre><code class="prism language-js"><span class="token comment">/**
 * fs.mkdir(path[,options],callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt; | &lt;integer&gt;
 * recursive &lt;boolean&gt; 默认值: false
 * mode &lt;string&gt; | &lt;integer&gt; Windows 上不支持。 默认值: 0o777。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * path &lt;string&gt; | &lt;undefined&gt; 仅当创建目录时将 recursive 设置为 true。
 */</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token comment">// 1. 最简单的测试案例</span>
<span class="token comment">// fs.mkdir('./temp',(err)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('创建文件夹成功')</span>
<span class="token comment">// })</span>

<span class="token comment">// 2. 递归创建文件夹</span>
<span class="token comment">// fs.mkdir('./parent/son/grandson',{recursive:true},(err,path)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('递归创建文件夹成功',path)</span>
<span class="token comment">// })</span>

<span class="token comment">/**-------------------------------------------------------------------------------------- */</span>
<span class="token comment">/**-------------------------------------------------------------------------------------- */</span>
<span class="token comment">/**-------------------------------------------------------------------------------------- */</span>

<span class="token comment">/**
 * fs.writeFile(file, data[, options], callback)
 * file &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;integer&gt; 文件名或文件描述符
 * data &lt;string&gt; | &lt;Buffer&gt; | &lt;TypedArray&gt; | &lt;DataView&gt; | &lt;Object&gt;
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: 'utf8'
 * mode &lt;integer&gt; 默认值: 0o666
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'w'。
 * signal &lt;AbortSignal&gt; 允许中止正在进行的写入文件
 * callback &lt;Function&gt;
 * err &lt;Error&gt; | &lt;AggregateError&gt;
 */</span>

<span class="token comment">// 1. 创建并写入一个文件</span>
<span class="token comment">// fs.writeFile('./index.html',"&lt;h1&gt;你好，中国&lt;/h1&gt;",(err)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log("创建写入文件成功")</span>
<span class="token comment">// })</span>

<span class="token comment">// 2. 指定文件格式</span>
<span class="token comment">// fs.writeFile('./index.html','&lt;h2&gt;面朝大海，春暖花开&lt;/h2&gt;','utf-8',(err)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('写入指定格式文件成功')</span>
<span class="token comment">// })</span>

<span class="token comment">// 3. 写gbk文件</span>
<span class="token comment">// const iconv = require('iconv-lite')</span>
<span class="token comment">// fs.writeFile('./style.css',iconv.encode('面朝大海，春暖花开','gbk'),(err)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log("以GBK格式写入成功")</span>
<span class="token comment">// })</span>


<span class="token comment">/**
 * fs.appendFile(path, data[, options], callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;number&gt; 文件名或文件描述符
 * data &lt;string&gt; | &lt;Buffer&gt;
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: 'utf8'
 * mode &lt;integer&gt; 默认值: 0o666
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'a'。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>

<span class="token comment">// 1. 创建文件并写入内容</span>
<span class="token comment">// fs.appendFile('./test.txt', '测试写入', (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log("使用追加的方式创建并写入文件")</span>
<span class="token comment">// })</span>

<span class="token comment">// 2. 追加内容</span>
<span class="token comment">// fs.appendFile('./test.txt', "\n追加测试", (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('在已经存在的文件中追加内容')</span>
<span class="token comment">// })</span>

<span class="token comment">/** =============================================================================== */</span>


<span class="token comment">/**
 * fs.stat(path[, options], callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt;
 * bigint &lt;boolean&gt; 返回的 &lt;fs.Stats&gt; 对象中的数值是否应为 bigint。 默认值: false。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * stats &lt;fs.Stats&gt;
 */</span>

<span class="token comment">// 1. 判断路径是目录还是文件</span>
<span class="token comment">// fs.stat('./index.html',(err,stats)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log(`./index.html是文件：${stats.isFile()}`)</span>
<span class="token comment">//     console.log(`./index.html是目录：${stats.isDirectory()}`)</span>
<span class="token comment">// })</span>


<span class="token comment">/**
 * fs.readFile(path[, options], callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt; | &lt;integer&gt; 文件名或文件描述符
 * options &lt;Object&gt; | &lt;string&gt;
 * encoding &lt;string&gt; | &lt;null&gt; 默认值: null
 * flag &lt;string&gt; 请参阅对文件系统 flags 的支持。 默认值: 'r'。
 * signal &lt;AbortSignal&gt; 允许中止正在进行的读取文件
 * callback &lt;Function&gt;
 * err &lt;Error&gt; | &lt;AggregateError&gt;
 * data &lt;string&gt; | &lt;Buffer&gt;
 */</span>

<span class="token comment">// 1. 读取文件内容</span>
<span class="token comment">// fs.readFile('./index.html',(err,data)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log(`读取文件成功，文件内容是：\n${data}`)</span>
<span class="token comment">// })</span>

<span class="token comment">// 2. 以指定格式读取文件</span>
<span class="token comment">// const iconv = require('iconv-lite')</span>
<span class="token comment">// fs.readFile('./index.html',(err,data)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log(`读取文件成功，文件内容是：\n${data}`)</span>
<span class="token comment">//     console.log("读取文件成功，文件内容是：\n",iconv.decode(data,'gbk'))</span>
<span class="token comment">// })</span>


<span class="token comment">/**================================================================================ */</span>

<span class="token comment">/**
 * fs.readdir(path[, options], callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;string&gt; | &lt;Object&gt;
 * encoding &lt;string&gt; 默认值: 'utf8'
 * withFileTypes &lt;boolean&gt; 默认值: false
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 * files &lt;string[]&gt; | &lt;Buffer[]&gt; | &lt;fs.Dirent[]&gt;
 *
 */</span>
<span class="token comment">// 1. 读取当前目录下所有的文件</span>
<span class="token comment">// fs.readdir('./',(err,files)=&gt;{<!-- --></span>
<span class="token comment">//     if(err){<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log(files)</span>
<span class="token comment">// })</span>

<span class="token comment">// 2. 获取文件类型</span>
<span class="token comment">// fs.readdir('./', { withFileTypes: true }, (err, files) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log(files)</span>
<span class="token comment">// })</span>



<span class="token comment">/**
 * fs.rename(oldPath, newPath, callback)
 * oldPath &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * newPath &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>

<span class="token comment">// fs.rename('./index.html', './main.html', (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('重命名成功')</span>
<span class="token comment">// })</span>

<span class="token comment">// fs.rename('./main.html', './temp/main.html', (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('移动文件成功')</span>
<span class="token comment">// })</span>

<span class="token comment">/**
 * fs.unlink(path, callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>

<span class="token comment">// fs.unlink('./temp/main.html', (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log("删除文件成功")</span>
<span class="token comment">// })</span>

<span class="token comment">/**
 * fs.rmdir(path[, options], callback)
 * path &lt;string&gt; | &lt;Buffer&gt; | &lt;URL&gt;
 * options &lt;Object&gt;
 * maxRetries &lt;integer&gt; 如果遇到 EBUSY、EMFILE、ENFILE、ENOTEMPTY 或 EPERM 错误，
 *           Node.js 将在每次尝试时以 retryDelay 毫秒的线性退避等待时间重试该操作。 
 *           此选项表示重试次数。 如果 recursive 选项不为 true，则忽略此选项。 默认值: 0。
 * recursive &lt;boolean&gt; 如果为 true，则执行递归目录删除。 在递归模式下，操作将在失败时重试。 默认值: false。 已弃用。
 * retryDelay &lt;integer&gt; 重试之间等待的时间（以毫秒为单位）。 如果 recursive 选项不为 true，则忽略此选项。 默认值: 100。
 * callback &lt;Function&gt;
 * err &lt;Error&gt;
 */</span>
<span class="token comment">// fs.rmdir('./temp', (err) =&gt; {<!-- --></span>
<span class="token comment">//     if (err) {<!-- --></span>
<span class="token comment">//         console.log(err.message)</span>
<span class="token comment">//         return</span>
<span class="token comment">//     }</span>
<span class="token comment">//     console.log('删除空的文件夹')</span>
<span class="token comment">// })</span>


<span class="token keyword">function</span> <span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//同步读取文件夹</span>
    files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>             <span class="token comment">//删除文件夹中的所有文件/夹</span>
        <span class="token keyword">const</span> filePath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> stats <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">emptyDir</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            fs<span class="token punctuation">.</span><span class="token function">unlinkSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">删除</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">文件成功</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">rmdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>                  <span class="token comment">//删除文件夹</span>
<span class="token punctuation">}</span>

<span class="token function">emptyDir</span><span class="token punctuation">(</span><span class="token string">'./node_modules'</span><span class="token punctuation">)</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>