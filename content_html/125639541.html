<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#_2">一、前言</a></li><li><a href="#_9">二、代码界面展示</a></li><li><a href="#_20">三、代码运算结果展示</a></li><li><ul><li><a href="#31__21">3.1 闭合导线</a></li><li><ul><li><a href="#311_txt_22">3.1.1 通过txt文件导入原始数据</a></li><li><a href="#312__37">3.1.2 设置</a></li><li><a href="#313__50">3.1.3 计算</a></li><li><a href="#314__68">3.1.4 绘图</a></li><li><a href="#315__93">3.1.5 数据导出</a></li><li><a href="#316___97">3.1.6 整体展示</a></li></ul>
</li><li><a href="#3_2__102">3. 2 附和导线</a></li></ul>
</li><li><a href="#_114">四、源代码</a></li><li><a href="#_1095">五、结语</a></li></ul>
</div>
<p></p>
<h1><a id="_2"></a>一、前言</h1>
<p><strong>本程序是使用C# 编写的一个附和闭合导线平差程序<br/> 闭合导线：两个已知点，一个已知点+方位角；<br/> 附和导线：双定向附和导线；</strong><br/> <em><strong>(由于CSDN关闭了付费上传权限，导致我无法更新资源，所以我发布的下载资源是最开始上传的只能计算2个已知点的闭合导线简易平差程序，不能计算一个点+方位角和附和导线，如果下载了的同学私聊我一下邮箱，我看到了发给你新的)</strong></em></p>
<h1><a id="_9"></a>二、代码界面展示</h1>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3d3b5daad3464547a3bcd831a5e1fab8.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2af5799c86cb4b6686ecad6bac5f5970.png"/><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/16028b8f54d948b9ab75eef3817bf4df.png"/></p>
<p>Form1（大窗体）中控件有：Menu，tabControl，dataGridView。<br/> Form2（小窗体）中控件有：radioButton，comboBox，label，textbox button。</p>
<h1><a id="_20"></a>三、代码运算结果展示</h1>
<h2><a id="31__21"></a>3.1 闭合导线</h2>
<h3><a id="311_txt_22"></a>3.1.1 通过txt文件导入原始数据</h3>
<p><strong>没有的数据我用的0代替</strong>，沿用的水准测量程序的读取代码。<br/> 我这里的数据是直接给出了水平角了。<br/> 有些同学实习给的原始数据是<strong>盘左盘右数据</strong>。如果想要程序计算，需要多设置个几变量，如果想要数据显示出来的话，表格，数据导入那里也需要修改一下，但是运算逻辑是没有变的，自己改一下应该不难。<br/> <strong>实在不会的话，建议自己手动先把水平角算出来，再使用程序计算。</strong></p>
<p><strong>数据一：（2个已知点-右角）</strong><br/> <img alt="导入数据" src="https://img-blog.csdnimg.cn/552e7fcb845b47dfa9ab4e8365643cf7.png"/><br/> <strong>数据二：（2个已知点-左角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d8360ef72b0040fba9c38823102abf41.png"/><strong>数据三：（方位角(48.4319)-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/a6b9441411814baf8f4c4e5373f7f823.png"/><strong>数据四：（方位角（100）-右角）</strong></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/509f153857fb4ecda48f63a11cd6e54d.png"/></p>
<h3><a id="312__37"></a>3.1.2 设置</h3>
<p><strong>数据一：（2个已知点-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/eb123a60b89341c1b559b86da070e04e.png"/></p>
<p><strong>数据二：（2个已知点-左角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e255122b5f6c47e3bbd9360ec036b1d1.png"/></p>
<p><strong>数据三：（方位角(48.4319)-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5b897a57b95d451dba83c437991e7a04.png"/></p>
<p><strong>数据四：（方位角（100）-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1e73cd7af16741df9427f14c783f6e87.png"/></p>
<h3><a id="313__50"></a>3.1.3 计算</h3>
<p><strong>数据一：（2个已知点-右角）</strong><br/> 计算结果和工程测量大师的是差不多的，mm位上有一些数据有差别，应该主要是我整个计算的过程中都没有去避免double的精度误差（不明白精度误差的可以去搜搜看看）。如果你要参考我的代码可以自己添加使用round来保留位数。<br/> 这个界面上面是datagridview，下面是richtextbox，表格设计成这样其实不符合导线平差计算表的样式的。主要是自己没去学习表格的设计，能力不足，所以按照工程测量大师的表格设计的表。限差这些我随便找的一个标准。但是这个数据本身计算出来就是不合格的。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9a07c59dbc4d40d4bab3721454a66f9d.png"/><strong>数据二：（2个已知点-左角）</strong><br/> 与他自己计算的数据可以进行对比<br/> 数据差别的来源<br/> 1.角度改正数的分配，我程序分配的逻辑是先均分，多出来的分配给边长较长的。<br/> 2.位数保留，和数据一 一样<br/> 不过最后计算的B点坐标，程序和原始数据一样。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f83bee6b06964fe7accef9401a66dd09.png"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5bbadbfe8a6f4eae9a821a861a3a51ec.png"/><br/> <strong>数据三：（方位角(48.4319)-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d4472fa5f8f64d298549a7c2caa98035.png"/><strong>数据四：（方位角（100）-右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/91721481da11443382574cdd815f3da3.png"/></p>
<h3><a id="314__68"></a>3.1.4 绘图</h3>
<p>这个功能只能大概画出一个图形，电脑画图的坐标系和测量坐标系不一样，所以需要转换。程序画的时候已经转换了<br/> 说明一下，这个程序能画的坐标范围为x∈[-224,224],y∈[-496,496]，如果坐标不属于这里面的就画不出来。坐标太大的话需要你自己在绘图那段代码里面修改n，让坐标同时缩小n倍。<br/> 但是如果你的坐标是（3465128.993,552965.750）这种的，x坐标和y坐标位数不一样，设置n就没有用了，就画不出来了。<br/> 当然你可以自己发力，画出图形来。<br/> <strong>数据一：（2个已知点+右角）</strong></p>
<p>n=5</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1ddbeaf11a2e4d84b1fa75457e031917.png"/></p>
<p><strong>数据二：（2个已知点-左角）</strong><br/> n=5<br/> 画出来确实像一个厂房的结构<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b6d2d832b2c84cca8f7c42894a58e529.png"/><strong>数据三：（方位角(48.4319)-右角）</strong><br/> n=5<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/af74653db7fb4a428ece7bf3b9e3574f.png"/><br/> <strong>数据四：（方位角（100）-右角）</strong><br/> n=5<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d493bf99bb7a4139a8557ad2fd0888c6.png"/></p>
<h3><a id="315__93"></a>3.1.5 数据导出</h3>
<p>这个没什么好聊的，就是把计算的数据导出成excel<br/> <strong>数据一：（2个已知点+右角）</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3a27230be0674bdab23030232dc64c77.png"/></p>
<h3><a id="316___97"></a>3.1.6 整体展示</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3c8d48a4f8cf49b09a2d03d6c4163937.gif#pic_center"/></p>
<h2><a id="3_2__102"></a>3. 2 附和导线</h2>
<p>这里我就不过多描述了，就是计算双定向附和导线<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7a587bb1ce92486f80aecfa7365e1c8d.gif#pic_center"/>实验数据都是搜索的，经过了验证的。<br/> <strong>数据一</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/02570be44b1640c1a6860553d4593dfb.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/82e2ead3acb04b049da7d4fb07254462.png"/><br/> <strong>数据二</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9b476f2944f44581b4b3019bbe288b9a.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/51a797f1fd384f9bb87057d05bf11494.png"/></p>
<h1><a id="_114"></a>四、源代码</h1>
<pre><code class="prism language-csharp">
<span class="token keyword">namespace</span> 附和闭合导线平差程序
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
    <span class="token punctuation">{<!-- --></span>
       
        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//画图设置</span>
        <span class="token class-name">Graphics</span> g<span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">int</span></span> midx<span class="token punctuation">,</span> midy<span class="token punctuation">;</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span>Point<span class="token punctuation">&gt;</span></span> curvelist<span class="token punctuation">;</span>

        <span class="token class-name">Form2</span> form2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Form2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span>RowData<span class="token punctuation">&gt;</span></span> rdatas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>RowData<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List<span class="token punctuation">&lt;</span>ResultData<span class="token punctuation">&gt;</span></span> rtdatas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ResultData<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultData</span> rtdata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ResultData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RowData</span> rdata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RowData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Tolerance</span> tolerance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tolerance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">double</span></span> D <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> M <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> S <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">double</span></span> d1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> m1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> s1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword">double</span></span> d2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> m2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        


        <span class="token keyword">private</span> <span class="token keyword">void</span> 文件<span class="token function">ToolStripMenuItem1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            tabControl1<span class="token punctuation">.</span>SelectedTab <span class="token operator">=</span> tabControl1<span class="token punctuation">.</span>TabPages<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            rdatas<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> temp<span class="token punctuation">;</span>

            <span class="token class-name">OpenFileDialog</span> ofd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OpenFileDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ofd<span class="token punctuation">.</span>Filter <span class="token operator">=</span> <span class="token string">"文本文件(*.txt)|*.txt|所有文件(*.*)|*.*"</span><span class="token punctuation">;</span>
            ofd<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">"打开数据文件"</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>ofd<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>OK<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>

                <span class="token class-name">StreamReader</span> sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">StreamReader</span><span class="token punctuation">(</span>ofd<span class="token punctuation">.</span>FileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>sr<span class="token punctuation">.</span>EndOfStream<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>

                    temp <span class="token operator">=</span> sr<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{<!-- --></span> <span class="token char">','</span><span class="token punctuation">,</span> <span class="token char">' '</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> StringSplitOptions<span class="token punctuation">.</span>RemoveEmptyEntries<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">RowData</span> rdata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">RowData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rdata<span class="token punctuation">.</span>DH <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    rdata<span class="token punctuation">.</span>DMS <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rdata<span class="token punctuation">.</span>L <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rdata<span class="token punctuation">.</span>X <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rdata<span class="token punctuation">.</span>Y <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    rdatas<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rdata<span class="token punctuation">)</span><span class="token punctuation">;</span>


                <span class="token punctuation">}</span>
                sr<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token function">GridBuild1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"输入失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GridBuild1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DH<span class="token punctuation">;</span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">;</span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                dataGridView1<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>

            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> 设置<span class="token function">ToolStripMenuItem_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            form2<span class="token punctuation">.</span><span class="token function">ShowDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> 计算<span class="token function">ToolStripMenuItem_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            tabControl1<span class="token punctuation">.</span>SelectedTab <span class="token operator">=</span> tabControl1<span class="token punctuation">.</span>TabPages<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">ClearData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowHAandVandCHA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowCA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ShowΔxandΔ<span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ShowCΔxandCΔ<span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowXandY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowTolerance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Tolerance</span> tolerance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Tolerance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowHAandVandCHA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//闭合</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name"><span class="token keyword">double</span></span> sumli <span class="token operator">=</span> <span class="token number">180</span> <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    D <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>d<span class="token punctuation">;</span>
                    M <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>m<span class="token punctuation">;</span>
                    S <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
                    i<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                tolerance<span class="token punctuation">.</span>fβ <span class="token operator">=</span> <span class="token punctuation">(</span>D <span class="token operator">+</span> M <span class="token operator">/</span> <span class="token number">60.0</span> <span class="token operator">+</span> S <span class="token operator">/</span> <span class="token number">3600.0</span> <span class="token operator">-</span> sumli<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>

                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DH<span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        d1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>d<span class="token punctuation">;</span>
                        m1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>m<span class="token punctuation">;</span>
                        s1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> HAb <span class="token operator">=</span> <span class="token function">toDu</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>HA <span class="token operator">=</span> HAb<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> d1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> m1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        d1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>d<span class="token punctuation">;</span>
                        m1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>m<span class="token punctuation">;</span>
                        s1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> HAx <span class="token operator">=</span> <span class="token function">toDu</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>HA <span class="token operator">=</span> HAx<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> S <span class="token operator">=</span> <span class="token function">VDistribution</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        d2 <span class="token operator">=</span> d1<span class="token punctuation">;</span>
                        m2 <span class="token operator">=</span> m1<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>S <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            S <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            m2 <span class="token operator">=</span> m1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>S <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            S <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            m2 <span class="token operator">=</span> m1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            m2 <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            d2 <span class="token operator">=</span> d1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m2 <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            m2 <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            d2 <span class="token operator">=</span> d1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> CHAx <span class="token operator">=</span> <span class="token function">toDu</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CHA <span class="token operator">=</span> CHAx<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> d1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> m1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> d2<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> m2<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span>


            <span class="token punctuation">}</span>
            <span class="token comment">//附和</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">double</span></span> Xa <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Ya <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Xb <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Yb <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Theta1 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Atan</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Yb <span class="token operator">-</span> Ya<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Xb <span class="token operator">-</span> Xa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> radCA <span class="token operator">=</span> <span class="token function">JudgementQuadrant</span><span class="token punctuation">(</span>Theta1<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> CAa <span class="token operator">=</span> radCA <span class="token operator">*</span> <span class="token number">180</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>
                rtdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAa<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Xc <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Yc <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Xd <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Yd <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> Theta2 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Atan</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Yd <span class="token operator">-</span> Yc<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Xd <span class="token operator">-</span> Xc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> radCc <span class="token operator">=</span> <span class="token function">JudgementQuadrant</span><span class="token punctuation">(</span>Theta2<span class="token punctuation">,</span> rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> CAc <span class="token operator">=</span> radCc <span class="token operator">*</span> <span class="token number">180</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>
                rtdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAc<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    D <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>d<span class="token punctuation">;</span>
                    M <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>m<span class="token punctuation">;</span>
                    S <span class="token operator">+=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text<span class="token operator">==</span><span class="token string">"右角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">double</span> βli <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">double</span> βce <span class="token operator">=</span> D <span class="token operator">+</span> M <span class="token operator">/</span> <span class="token number">60.0</span> <span class="token operator">+</span> S <span class="token operator">/</span> <span class="token number">3600.0</span><span class="token punctuation">;</span>
                    tolerance<span class="token punctuation">.</span>fβ <span class="token operator">=</span> βce <span class="token operator">-</span> βli<span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"左角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">double</span> βli <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token operator">+</span><span class="token number">360</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">double</span> βce <span class="token operator">=</span> D <span class="token operator">+</span> M <span class="token operator">/</span> <span class="token number">60.0</span> <span class="token operator">+</span> S <span class="token operator">/</span> <span class="token number">3600.0</span><span class="token punctuation">;</span>
                    tolerance<span class="token punctuation">.</span>fβ <span class="token operator">=</span> βce <span class="token operator">-</span> βli<span class="token punctuation">;</span>   
                <span class="token punctuation">}</span>
                
                <span class="token keyword">while</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">&gt;</span> <span class="token number">360</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    tolerance<span class="token punctuation">.</span>fβ <span class="token operator">-=</span> <span class="token number">360</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">360</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    tolerance<span class="token punctuation">.</span>fβ <span class="token operator">+=</span> <span class="token number">360</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                tolerance<span class="token punctuation">.</span>fβ <span class="token operator">=</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span> tolerance<span class="token punctuation">.</span>fβ <span class="token operator">*</span> <span class="token number">3600</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DH<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> i <span class="token operator">==</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">||</span> i <span class="token operator">==</span> rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                            rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                            dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                            dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        d1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>d<span class="token punctuation">;</span>
                        m1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>m<span class="token punctuation">;</span>
                        s1 <span class="token operator">=</span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DMS<span class="token punctuation">)</span><span class="token punctuation">.</span>s<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> HAx <span class="token operator">=</span> <span class="token function">toDu</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>HA <span class="token operator">=</span> HAx<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> S <span class="token operator">=</span> <span class="token function">VDistribution</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        d2 <span class="token operator">=</span> d1<span class="token punctuation">;</span>
                        m2 <span class="token operator">=</span> m1<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>S <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            S <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            m2 <span class="token operator">=</span>m1<span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>S<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            S <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            m2<span class="token operator">=</span>m1<span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            m2 <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            d2 <span class="token operator">=</span>d1<span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m2<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            m2 <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                            d2 <span class="token operator">=</span>d1<span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> CHAx <span class="token operator">=</span> <span class="token function">toDu</span><span class="token punctuation">(</span>d2<span class="token punctuation">,</span> m2<span class="token punctuation">,</span> S<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CHA <span class="token operator">=</span> CHAx<span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> d1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> m1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> d2<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> m2<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>S<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span>
                
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token comment">//点号和水平角和改正后的水平角</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowL</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    tolerance<span class="token punctuation">.</span>fl <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    tolerance<span class="token punctuation">.</span>fl <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>


            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token comment">//展示距离</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowCA</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//闭合</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//已知点坐标（X1，Y1）,(X2，Y2)</span>
                <span class="token class-name"><span class="token keyword">double</span></span> CAa <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> CAb <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name"><span class="token keyword">double</span></span> X1 <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> Y1 <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> X2 <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> Y2 <span class="token operator">=</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> Theta <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Atan</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Y2 <span class="token operator">-</span> Y1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>X2 <span class="token operator">-</span> X1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">double</span></span> radCA <span class="token operator">=</span> <span class="token function">JudgementQuadrant</span><span class="token punctuation">(</span>Theta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        CAa <span class="token operator">=</span> radCA <span class="token operator">*</span> <span class="token number">180</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAa<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>

                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>

                        CAa <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>form2<span class="token punctuation">.</span>textBox1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span> <span class="token operator">+</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>form2<span class="token punctuation">.</span>textBox2<span class="token punctuation">.</span>Text<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">+</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>form2<span class="token punctuation">.</span>textBox3<span class="token punctuation">.</span>Text<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAa<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>

                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"右角"</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            CAb <span class="token operator">=</span> CAa <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>HA <span class="token operator">+</span> <span class="token number">180</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"左角"</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            CAb <span class="token operator">=</span> CAa <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>HA <span class="token operator">+</span> <span class="token number">180</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token keyword">if</span> <span class="token punctuation">(</span>CAb <span class="token operator">&gt;</span> <span class="token number">360</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            CAb <span class="token operator">-=</span> <span class="token number">360</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>CAb<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
                        <span class="token punctuation">{<!-- --></span>
                            CAb <span class="token operator">+=</span> <span class="token number">360</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAb<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms1 <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>

                        CAb <span class="token operator">=</span> <span class="token function">Calculate_CA</span><span class="token punctuation">(</span>CAa<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAb<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms1 <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        CAb <span class="token operator">=</span> <span class="token function">Calculate_CA</span><span class="token punctuation">(</span>CAb<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAb<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms1 <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            <span class="token comment">//附和</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">double</span></span> CAx<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms1<span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rtdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        CAx <span class="token operator">=</span> <span class="token function">Calculate_CA</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAx<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms2 <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        CAx <span class="token operator">=</span> <span class="token function">Calculate_CA</span><span class="token punctuation">(</span>CAx<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">=</span> CAx<span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> dms2 <span class="token operator">=</span> <span class="token function">toDMS</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> dms2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> dms2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        
                    <span class="token punctuation">}</span>
                    
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token comment">//计算展示坐标方位角</span>
        <span class="token comment">//计算坐标方位角</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">Calculate_CA</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> CA<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> CA1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"右角"</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA1 <span class="token operator">=</span>CA <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CHA <span class="token operator">+</span> <span class="token number">180</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox2<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"左角"</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA1 <span class="token operator">=</span> CA <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CHA <span class="token operator">+</span> <span class="token number">180</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>CA1 <span class="token operator">&gt;=</span> <span class="token number">360</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA1 <span class="token operator">-=</span> <span class="token number">360</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>CA1 <span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA1 <span class="token operator">+=</span> <span class="token number">360</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> CA1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> ShowΔxandΔ<span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    tolerance<span class="token punctuation">.</span>fx <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx<span class="token punctuation">;</span>
                    tolerance<span class="token punctuation">.</span>fy <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    i<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                tolerance<span class="token punctuation">.</span>fD <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fx <span class="token operator">*</span> tolerance<span class="token punctuation">.</span>fx <span class="token operator">+</span> tolerance<span class="token punctuation">.</span>fy <span class="token operator">*</span> tolerance<span class="token punctuation">.</span>fy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                tolerance<span class="token punctuation">.</span>K <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fD <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">double</span></span> fxce<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> fyce<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>fxli<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>fyli<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
                fxli <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">-</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
                fyli <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">-</span> rdatas<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CA <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">;</span>
                    fxce <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx<span class="token punctuation">;</span>
                    fyce <span class="token operator">+=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                tolerance<span class="token punctuation">.</span>fx <span class="token operator">=</span> fxce <span class="token operator">-</span> fxli<span class="token punctuation">;</span>
                tolerance<span class="token punctuation">.</span>fy <span class="token operator">=</span> fyce <span class="token operator">-</span> fyli<span class="token punctuation">;</span>
                tolerance<span class="token punctuation">.</span>fD <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fx <span class="token operator">*</span> tolerance<span class="token punctuation">.</span>fx <span class="token operator">+</span> tolerance<span class="token punctuation">.</span>fy <span class="token operator">*</span> tolerance<span class="token punctuation">.</span>fy<span class="token punctuation">)</span><span class="token punctuation">;</span>
                tolerance<span class="token punctuation">.</span>K <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fD <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token punctuation">}</span><span class="token comment">//计算展示Δx和Δy和fd，fl，fx，fx，K</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> ShowCΔxandCΔ<span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> temp1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        temp <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fx <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
                        temp1 <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fy <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        temp <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fx <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
                        temp1 <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fy <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx <span class="token operator">-</span> temp<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy <span class="token operator">-</span> temp1<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    i<span class="token operator">++</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>


            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">double</span></span> temp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> temp1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    temp <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fx <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
                    temp1 <span class="token operator">=</span> tolerance<span class="token punctuation">.</span>fy <span class="token operator">*</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">/</span> tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δx <span class="token operator">-</span> temp<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Δy <span class="token operator">-</span> temp1<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token comment">//计算展示CΔ和CΔy</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowXandY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    i<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rtdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CΔx<span class="token punctuation">;</span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">=</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>CΔy<span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Cells<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token comment">//计算展示X和Y</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ShowTolerance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                richTextBox1<span class="token punctuation">.</span><span class="token function">AppendText</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"角度闭合差为 fβ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"″"</span> <span class="token operator">+</span> <span class="token string">"   fβ允=±24√n=±"</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"    角度闭合差超限"</span><span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"角度闭合差为 fβ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"″"</span> <span class="token operator">+</span> <span class="token string">"   fβ允=±24√n=±"</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"fx="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"  fy="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"  fl="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长闭合差fD ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fD<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差容许值="</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K <span class="token operator">&gt;</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差K ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&gt;"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"   "</span> <span class="token operator">+</span> <span class="token string">"结果超限"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K <span class="token operator">&lt;</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差K ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"   "</span> <span class="token operator">+</span> <span class="token string">"结果不超限"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>


            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> rtdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span><span class="token function">AppendText</span><span class="token punctuation">(</span>Environment<span class="token punctuation">.</span>NewLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"角度闭合差为 fβ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"″"</span> <span class="token operator">+</span> <span class="token string">"   fβ允=±24√n=±"</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"fx="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fx<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"  fy="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fy<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"  fl="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fl<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长闭合差fD ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fD<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"m"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差容许值="</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K <span class="token operator">&gt;</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差K ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&gt;"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"   "</span> <span class="token operator">+</span> <span class="token string">"结果超限"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K <span class="token operator">&lt;</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    richTextBox1<span class="token punctuation">.</span>Text <span class="token operator">+=</span> <span class="token string">"导线全长相对闭合差K ="</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>K<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&lt;"</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">/</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"   "</span> <span class="token operator">+</span> <span class="token string">"结果不超限"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>








        <span class="token punctuation">}</span><span class="token comment">//展示限差</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ClearData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            dataGridView2<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            rtdatas<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            D <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> M <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> S <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            d1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> m1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            tolerance<span class="token punctuation">.</span>fx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            tolerance<span class="token punctuation">.</span>fy <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            tolerance<span class="token punctuation">.</span>fl <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ResultData</span> rtdata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ResultData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                rtdata<span class="token punctuation">.</span>DH <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DH<span class="token punctuation">;</span>
                rtdatas<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rtdata<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token comment">//计算前清理数据，避免数据重复计算</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token punctuation">(</span><span class="token keyword">double</span> d<span class="token punctuation">,</span> <span class="token keyword">double</span> m<span class="token punctuation">,</span> <span class="token keyword">double</span> s<span class="token punctuation">)</span></span> <span class="token function">ReturnDMS</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> DMS<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
             <span class="token class-name"><span class="token keyword">double</span></span> d<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s<span class="token punctuation">;</span>
            d <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Floor</span><span class="token punctuation">(</span>DMS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DMS <span class="token operator">-</span> d<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            s <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>DMS <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">Floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>DMS <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token comment">//格式转换</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">JudgementQuadrant</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> Theta<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> j<span class="token punctuation">)</span> <span class="token comment">//判断方位角象限</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> CA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> m <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">-</span> rdatas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>X<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> n <span class="token operator">=</span> rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">-</span> rdatas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>Y<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> Theta<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI <span class="token operator">-</span> Theta<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> Theta <span class="token operator">+</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">-</span> Theta<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                CA <span class="token operator">=</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>


            <span class="token keyword">return</span> CA<span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token function">AngularCarry</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> d<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> m<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> s<span class="token punctuation">)</span><span class="token comment">//角度进位</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                s <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                m <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                m <span class="token operator">-=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                d <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                s <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                m <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                m <span class="token operator">+=</span> <span class="token number">60</span><span class="token punctuation">;</span>
                d <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{<!-- --></span> d<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s <span class="token punctuation">}</span><span class="token punctuation">;</span>




        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">VDistribution</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> s<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> i<span class="token punctuation">)</span><span class="token comment">//改正数分配</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> temp2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">//闭合</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton1<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">ArrayList</span> arrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"两个已知点"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        arrayList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        arrayList<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>

                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>comboBox1<span class="token punctuation">.</span>Text <span class="token operator">==</span> <span class="token string">"一个已知点+方位角"</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    n <span class="token operator">=</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count <span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        arrayList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        arrayList<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token class-name"><span class="token keyword">int</span></span> temp <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取余</span>
                <span class="token class-name"><span class="token keyword">int</span></span> temp1 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> avernum <span class="token operator">=</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">-</span> temp<span class="token punctuation">)</span> <span class="token operator">/</span> n<span class="token punctuation">;</span>
                
                
                <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">&gt;=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>arrayList<span class="token punctuation">[</span>n <span class="token operator">-</span> temp1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>temp <span class="token operator">/</span> temp1 <span class="token operator">+</span> avernum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>avernum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//附和    </span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>form2<span class="token punctuation">.</span>radioButton2<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">int</span></span> n<span class="token operator">=</span>rtdatas<span class="token punctuation">.</span>Count<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">int</span></span> temp <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//取余</span>
                <span class="token class-name"><span class="token keyword">int</span></span> temp1 <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Abs</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">double</span></span> avernum <span class="token operator">=</span> <span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">-</span> temp<span class="token punctuation">)</span> <span class="token operator">/</span> n<span class="token punctuation">;</span>
                <span class="token class-name">ArrayList</span> arrayList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> rdatas<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    arrayList<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>L<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    arrayList<span class="token punctuation">.</span><span class="token function">Sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>L <span class="token operator">&gt;=</span> Convert<span class="token punctuation">.</span><span class="token function">ToDouble</span><span class="token punctuation">(</span>arrayList<span class="token punctuation">[</span>n <span class="token operator">-</span> temp1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>temp <span class="token operator">/</span> temp1 <span class="token operator">+</span> avernum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>avernum<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>tolerance<span class="token punctuation">.</span>fβ <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    temp2 <span class="token operator">=</span> s <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>V<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> temp2<span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token function">toDMS</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> CA<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">int</span></span> d <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>CA<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CA <span class="token operator">-</span> d<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> s <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>Math<span class="token punctuation">.</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CA <span class="token operator">-</span> d<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3600</span> <span class="token operator">-</span> m <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> temp <span class="token operator">=</span> <span class="token function">AngularCarry</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> m<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{<!-- --></span> temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> temp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token comment">//十进制度数转度分秒</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span></span> <span class="token function">toDu</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> d1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> m1<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> s1<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> du <span class="token operator">=</span> d1 <span class="token operator">+</span> m1 <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">+</span> s1 <span class="token operator">/</span> <span class="token number">3600</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> du<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token comment">//度分秒转十进制度数</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">drawPoint</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> X<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> Y<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            g<span class="token punctuation">.</span><span class="token function">FillRectangle</span><span class="token punctuation">(</span>Brushes<span class="token punctuation">.</span>Red<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>Y<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>X<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> 绘图<span class="token function">ToolStripMenuItem_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            tabControl1<span class="token punctuation">.</span>SelectedTab <span class="token operator">=</span> tabControl1<span class="token punctuation">.</span>TabPages<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            tabPage3<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            g <span class="token operator">=</span> tabPage3<span class="token punctuation">.</span><span class="token function">CreateGraphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            midx <span class="token operator">=</span> tabPage3<span class="token punctuation">.</span>ClientRectangle<span class="token punctuation">.</span>Height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            midy <span class="token operator">=</span> tabPage3<span class="token punctuation">.</span>ClientRectangle<span class="token punctuation">.</span>Width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> midx<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ClientRectangle<span class="token punctuation">.</span>Width<span class="token punctuation">,</span> midx<span class="token punctuation">)</span><span class="token punctuation">;</span>
            g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> midy<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> midy<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ClientRectangle<span class="token punctuation">.</span>Height<span class="token punctuation">)</span><span class="token punctuation">;</span>
            curvelist <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>Point<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">int</span></span> n <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rtdatas<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                
            <span class="token punctuation">{<!-- --></span>
                
                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>

                    <span class="token function">drawPoint</span><span class="token punctuation">(</span><span class="token punctuation">(</span>midx <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>midy <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token function">drawPoint</span><span class="token punctuation">(</span><span class="token punctuation">(</span>midx <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>midy <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    g<span class="token punctuation">.</span><span class="token function">DrawLine</span><span class="token punctuation">(</span>Pens<span class="token punctuation">.</span>Black<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>midy <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>midx <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">/</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>midy <span class="token operator">+</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Y <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>midx <span class="token operator">-</span> rtdatas<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>X <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> 保存<span class="token function">ToolStripMenuItem_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//这里的代码自己搜索一下，就是将datagridview 转换成txt或者excel</span>
        <span class="token punctuation">}</span>
       

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<pre><code class="prism language-csharp"><span class="token comment">//这里是创建的变量</span>
 <span class="token keyword">class</span> <span class="token class-name">RowData</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> DH<span class="token punctuation">;</span><span class="token comment">//点号</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> DMS<span class="token punctuation">;</span><span class="token comment">//度分秒</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> L<span class="token punctuation">;</span><span class="token comment">//距离</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> X<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> Y<span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">ResultData</span> 
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">string</span></span> DH<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> HA<span class="token punctuation">;</span><span class="token comment">//水平角</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> V<span class="token punctuation">;</span><span class="token comment">//改正数</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> CHA<span class="token punctuation">;</span><span class="token comment">//改正后水平角</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> CA<span class="token punctuation">;</span><span class="token comment">//方位角</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> L<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> Δx<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> Δy<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> CΔx<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> CΔy<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> X<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> Y<span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">Tolerance</span> <span class="token comment">//限差</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token keyword">double</span> fβ<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> fl<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> fx<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> fy<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> fD<span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">double</span></span> K<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>Form2的代码我就不复制了，如上图一些设置的按钮。</p>
<h1><a id="_1095"></a>五、结语</h1>
<p>不管是水准测量平差或者是导线测量，主要面临的不是公式不会用（高斯正反算就是纯粹的将公式套用编程），而是各种编程的基础问题（数据导入，显示，分隔，循环处理，debug，输出等等），计算公式倒是好理解。其实最简单的就是写一个最死的程序，只处理一组数据或者单个数据，过后慢慢百度学习，久而久之就相对熟练了。<br/> 如果你有基础，看源码就可以了。如果你才学C#窗体，我觉得你下载这一个程序或者水准那个基本上可以满足测绘程序编写的要求了，不用每个问题都去搜索，这两个程序基本都包括了。<br/> 我才学C#的时候，有很多自己也不会，也要看别人的，比如如何打开文件夹，读取txt，用逗号或者空格分隔，换行读取过后再显示，跨窗体调用数据，保存数据，画图，方法的调用等等，遇到了各种报错了就开始搜索再修改，过后再把它们融合到自己写的程序。<br/> 如果有一个现成的程序，会对你的程序学习有很大帮助。<br/> 我的其他文章：</p>
<ol><li>利用Python编写一个高斯正反算程序：<a href="https://blog.csdn.net/Zj1638/article/details/125740379">https://blog.csdn.net/Zj1638/article/details/125740379</a></li><li>利用C#编写一个高斯正反算程序：<a href="https://blog.csdn.net/Zj1638/article/details/125380593">https://blog.csdn.net/Zj1638/article/details/125380593</a></li><li>利用C#编写一个水准测量近似平差程序：<a href="https://blog.csdn.net/Zj1638/article/details/119303957">https://blog.csdn.net/Zj1638/article/details/119303957</a></li><li>利用C#编写一个GPS高程拟合（二次曲面拟合模型）程序：<a href="https://blog.csdn.net/Zj1638/article/details/125752243">https://blog.csdn.net/Zj1638/article/details/125752243</a></li></ol>
<p>相关下载链接：</p>
<ol><li>利用C#编写一个水准测量近似平差程序下载链接：<a href="https://download.csdn.net/download/Zj1638/16732130">https://download.csdn.net/download/Zj1638/16732130</a></li><li>利用C#编写一个闭合导线简易平差程序下载链接：<a href="https://download.csdn.net/download/Zj1638/85928040">https://download.csdn.net/download/Zj1638/85928040</a><em><strong>(由于CSDN关闭了付费上传权限，导致我无法更新资源，所以这里下载的程序是只能计算2个已知点的闭合导线简易平差程序，不能计算一个点+方位角和附和导线，下载了的同学私聊我一下，我看到了发给你)</strong></em></li><li>利用C#编写一个高斯正反算程序下载链接：<a href="https://download.csdn.net/download/Zj1638/85711234">https://download.csdn.net/download/Zj1638/85711234</a></li><li>利用Python编写一个高斯正反算程序下载链接：<a href="https://download.csdn.net/download/Zj1638/86059069">https://download.csdn.net/download/Zj1638/86059069</a></li><li>利用C#编写一个GPS高程拟合（二次曲面拟合模型）程序下载链接：<a href="https://download.csdn.net/download/Zj1638/85916113">https://download.csdn.net/download/Zj1638/85916113</a></li></ol>
<p>需要的可以支持一下。如果有什么不懂的，可以私信，我看到了会回答的。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>