<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-dracula" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>旋转中心的计算和使用</h3>
<ul><li><a href="#1__1">1. 为什么要标定旋转中心</a></li><li><a href="#2__11">2. 如何标定旋转中心</a></li><li><ul><li><a href="#21__12">2.1 标定旋转中心的操作步骤</a></li><li><a href="#22__15">2.2 三点拟合圆心代码：</a></li></ul>
</li><li><a href="#3_halcon_69">3. halcon多点拟合圆的方法</a></li><li><a href="#4__88">4. 如何使用旋转中心计算偏移量</a></li><li><a href="#5__107">5. 计算一点绕另一点旋转一定角度后新点的坐标</a></li></ul>
</div>
<p></p>
<h1><a id="1__1"></a>1. 为什么要标定旋转中心</h1>
<ul><li>在机器视觉实际应用过程中，有这样的案例：机械手要抓取物料，物料每次的角度不一样，机械手的末端工具中心与其自身的旋转中心不重合，如果想完成这个抓取的工作，有两种解决方案：</li></ul>
<ol><li><strong>TCP标定</strong>（Tool Center Point）</li></ol>
<ul><li>一般机械手都会有建立新工具坐标系的功能，比如EPSON。TCP标定的本质就是求旧的工具坐标系与新的工具坐标系的旋转平移矩阵。一般是定义新的工具编号，放一个参考点，多次旋转U轴（旋转轴）（4次），然后移动X，Y（base下）使新工具坐标末端对准参考点，</li><li>对完之后点击示教就行了。以上使EPOSN的简单流程。</li></ul>
<ol start="2"><li><strong>标定旋转中心和旋转半径</strong></li></ol>
<ul><li>如果机器人没有TCP标定的功能怎么办呢？其实这种概率比较低，因为市场上几乎所有的机器人都会有这种功能了，大部分是由于操作机器人的工程师业务不够熟练，所以就把这个任务交给机器视觉工程师了。</li><li>还有另外一种情况，如果你使用的运动机构是运动控制卡控制的，这里我们讨论的是有旋转轴的机构，而且旋转轴上的工具末端中心又和旋转轴不重合，这时候就不得不标定旋转中心和旋转半径了。</li><li>其实一般带有旋转轴的机构，我们都会标定旋转中心的，因为靠机械定位误差比较大，机器视觉工程师要对最终的精度负责，标定旋转中心是必要的，要不然我们要旋转轴干嘛呢？</li></ul>
<h1><a id="2__11"></a>2. 如何标定旋转中心</h1>
<h2><a id="21__12"></a>2.1 标定旋转中心的操作步骤</h2>
<ul><li>如下图，在旋转轴工具上放置一个Mark点，旋转角度，获得三个点，三点拟合圆，获得圆心坐标和旋转半径（默认已经做完九点标定，这三个点转为世界坐标后再计算圆心坐标和旋转半径）。 <br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210520175419382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODU2NjYzMg==,size_16,color_FFFFFF,t_70"/></li></ul>
<h2><a id="22__15"></a>2.2 三点拟合圆心代码：</h2>
<p>通过下面的计算，我们能得到旋转中心和旋转半径。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210521111840299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODU2NjYzMg==,size_16,color_FFFFFF,t_70"/></p>
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>ComponentModel</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Drawing</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Text</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> 求圆心
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">Form1</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Form</span></span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token function">Form1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">InitializeComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">button1_Click</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">object</span></span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> xy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">double</span></span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            xy <span class="token operator">=</span> <span class="token function">RotateCenter</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtX1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtY1<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtX2<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtY2<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtX3<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>txtY3<span class="token punctuation">.</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            txtxcen<span class="token punctuation">.</span>Text <span class="token operator">=</span> xy<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//X</span>
            txtycen<span class="token punctuation">.</span>Text <span class="token operator">=</span> xy<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Y</span>
            txtrcen<span class="token punctuation">.</span>Text <span class="token operator">=</span> xy<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//R</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token function">RotateCenter</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> x1<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">double</span></span> y1<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">double</span></span> x2<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">double</span></span> y2<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">double</span></span> x3<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">double</span></span> y3<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">;</span>
            a <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x2<span class="token operator">-</span>x1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            b <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y2<span class="token operator">-</span>y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
            c <span class="token operator">=</span> x2 <span class="token operator">*</span> x2 <span class="token operator">+</span> y2 <span class="token operator">*</span> y2 <span class="token operator">-</span> x1 <span class="token operator">*</span> x1 <span class="token operator">-</span> y1 <span class="token operator">*</span> y1<span class="token punctuation">;</span>
            d <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x3 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y3 <span class="token operator">-</span> y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
            f <span class="token operator">=</span> x3 <span class="token operator">*</span> x3 <span class="token operator">+</span> y3 <span class="token operator">*</span> y3 <span class="token operator">-</span> x2 <span class="token operator">*</span> x2 <span class="token operator">-</span> y2 <span class="token operator">*</span> y2<span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> x <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> f <span class="token operator">-</span> e <span class="token operator">*</span> c<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>b<span class="token operator">*</span>d<span class="token operator">-</span>e<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> y <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token operator">*</span>c<span class="token operator">-</span>a<span class="token operator">*</span>f<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>b<span class="token operator">*</span>d<span class="token operator">-</span>e<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> r <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>x1 <span class="token operator">-</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> x<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y1 <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> xyr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">double</span></span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            xyr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
            xyr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">;</span>
            xyr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> r<span class="token punctuation">;</span>
            <span class="token keyword">return</span> xyr<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1><a id="3_halcon_69"></a>3. halcon多点拟合圆的方法</h1>
<p>如果你使用的算法库是halcon，那么我将给您提供一个更方便的多点拟合圆的方法：</p>
<ul><li>博客链接：<a href="https://blog.csdn.net/weixin_38566632/article/details/118580370?spm=1001.2014.3001.5501">https://blog.csdn.net/weixin_38566632/article/details/118580370?spm=1001.2014.3001.5501</a></li><li>这种方法更灵活，您可以自由增加点数而不受限制。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210713172055624.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODU2NjYzMg==,size_16,color_FFFFFF,t_70"/><br/> <mark>halcon代码：</mark></li></ul>
<pre><code class="prism language-csharp">Row <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100.5</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
Col <span class="token punctuation">:</span><span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">99.4</span><span class="token punctuation">]</span>

gen_contour_polygon_xld <span class="token return-type class-name"><span class="token punctuation">(</span>Contour<span class="token punctuation">,</span> Row<span class="token punctuation">,</span> Col<span class="token punctuation">)</span></span>
fit_circle_contour_xld <span class="token punctuation">(</span>Contour<span class="token punctuation">,</span> 'geotukey'<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> Row_C<span class="token punctuation">,</span> Column_C<span class="token punctuation">,</span> Radius_C<span class="token punctuation">,</span> StartPhi_C<span class="token punctuation">,</span> EndPhi_C<span class="token punctuation">,</span> PointOrder_C<span class="token punctuation">)</span>
 
dev_set_color <span class="token punctuation">(</span>'blue'<span class="token punctuation">)</span>
gen_circle_contour_xld <span class="token punctuation">(</span>ContCircle<span class="token punctuation">,</span> Row_C<span class="token punctuation">,</span> Column_C<span class="token punctuation">,</span> Radius_C<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token function">acos</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 'positive'<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<h1><a id="4__88"></a>4. 如何使用旋转中心计算偏移量</h1>
<p>这一步就是最重要的一步了，如何使用旋转中心和旋转半径来确定偏移量呢？<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210521121220336.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODU2NjYzMg==,size_16,color_FFFFFF,t_70"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210521123725158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zODU2NjYzMg==,size_16,color_FFFFFF,t_70"/></p>
<p>已知：旋转中心坐标和旋转半径R<br/> <img alt="〖R=l〗_OB 〖=l〗_OA" src="https://img-blog.csdnimg.cn/20210521123807307.png"/></p>
<p>设：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210521123831432.png"/></p>
<p>因为<br/> 三角形BAC 和 三角形 OAD是相似三角形<br/> 所以<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210521123849194.png"/></p>
<p>求解上面方程：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2021052112390341.png"/></p>
<h1><a id="5__107"></a>5. 计算一点绕另一点旋转一定角度后新点的坐标</h1>
<ul><li>第4节主要是为了讲清楚这个推导过程，接下来我们直接给出代码：</li><li>博客链接：<a href="https://blog.csdn.net/weixin_38566632/article/details/118580534?spm=1001.2014.3001.5501">https://blog.csdn.net/weixin_38566632/article/details/118580534?spm=1001.2014.3001.5501</a></li></ul>
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">RotatePoint</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">double</span></span> X <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">double</span></span> Y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">//顺时针角度为负数</span>
            <span class="token function">RotateAngle</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">ref</span> X<span class="token punctuation">,</span> <span class="token keyword">ref</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span>

            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>X<span class="token operator">+</span><span class="token string">","</span><span class="token operator">+</span>Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">RotateAngle</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">double</span></span> XRotation<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> YRotation<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> ARotate<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> XBefore<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">double</span></span> YBefore<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">double</span></span> XAfter<span class="token punctuation">,</span> <span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">double</span></span> YAfter<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token keyword">double</span></span> Rad <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                Rad <span class="token operator">=</span> ARotate <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Acos</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span>
                XAfter <span class="token operator">=</span> <span class="token punctuation">(</span>XBefore <span class="token operator">-</span> XRotation<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>Rad<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>YBefore <span class="token operator">-</span> YRotation<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>Rad<span class="token punctuation">)</span> <span class="token operator">+</span> XRotation<span class="token punctuation">;</span>
                YAfter <span class="token operator">=</span> <span class="token punctuation">(</span>YBefore <span class="token operator">-</span> YRotation<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Cos</span><span class="token punctuation">(</span>Rad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>XBefore <span class="token operator">-</span> XRotation<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">Sin</span><span class="token punctuation">(</span>Rad<span class="token punctuation">)</span> <span class="token operator">+</span> YRotation<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token string">"OK"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<ul><li>标定旋转中心的目的就是，计算旋转一定角度后新点的坐标；</li></ul>
<p><strong>X,Y和角度纠偏的步骤：</strong></p>
<ul><li>X,Y和角度的偏差，在机械动作上是同时进行纠偏的，但是在算法中却不是，我们往往是先转正角度，然后算出转正角度后新位置的坐标；</li><li>此时新位置和模板角度是相同的，只需要平移就能重合，这个平移量就是9点标定时算出并保存的仿射变换矩阵来计算的了。</li></ul>
<p>对我的文章感兴趣的小伙伴，可以关注我，我会一直更新这类的文章，和大家一起探讨学习。如果您觉得文章写的还不错的话，就帮我点个赞吧。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>