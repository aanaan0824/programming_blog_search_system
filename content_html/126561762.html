<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atelier-sulphurpool-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#_5">前言</a></li><li><a href="#Visual_Studio_14">一、Visual Studio应用开发</a></li><li><ul><li><a href="#1_16">1、流程步骤</a></li><li><a href="#2_31">2、示例代码</a></li></ul>
</li><li><a href="#_186">二、具体操作方法</a></li><li><ul><li><a href="#1_187">1、引入依赖包</a></li><li><a href="#2_207">2、初始化</a></li><li><a href="#3FBox_278">3、开启指定FBox所有监控点</a></li><li><a href="#4_333">4、盒子状态变更推送</a></li><li><a href="#5_387">5、实时数据推送</a></li><li><a href="#6_443">6、获取盒子信息与盒子分组</a></li><li><a href="#7_485">7、获取盒子监控点分组和监控点条目</a></li><li><a href="#8_548">8、监控点值写入</a></li><li><a href="#9_589">9、驱动器操作</a></li><li><ul><li><a href="#plc_590">获取盒子下所有的plc</a></li><li><a href="#PLC_639">下载PLC</a></li></ul>
</li><li><a href="#10_690">10、监控点操作</a></li><li><ul><li><a href="#_691">新增监控点条目</a></li><li><a href="#_748">更新监控点条目</a></li></ul>
</li><li><a href="#11_828">11、报警操作</a></li><li><ul><li><a href="#_829">获取盒子底下所有的报警条目</a></li><li><a href="#_874">获取报警历史记录条目</a></li><li><a href="#_914">新增报警条目</a></li><li><a href="#_965">更新报警条目</a></li><li><a href="#_1015">删除报警条目</a></li></ul>
</li><li><a href="#12_1044">12、历史操作</a></li><li><ul><li><a href="#_1045">获取历史记录多通道数据</a></li><li><a href="#_1085">获取历史记录条目</a></li><li><a href="#_1135">新增历史记录条目</a></li><li><a href="#_1200">更新历史记录条目</a></li></ul>
</li></ul>
</li><li><a href="#_1291">总结</a></li></ul>
</div>
<p></p>
<hr/>
<h1><a id="_5"></a>前言</h1>
<p>上几篇介绍了FlexManager设备云端数据的各种操作，相信大家都有看了。本篇开始，将就怎么使用设备云数据库的数据进行客户端应用开发的方式逐一介绍。当然，最基层的设备入云得基本掌握一点自动化的一些相关知识，同学们如果有兴趣可以到我的学习资料里边去学习一波，此处不做重点讲述。本文重点讲述的是基于FlexManager的Visual Studio应用开发。</p>
<hr/>
<p>`特别说明：<br/> 1、适用于 Visual Studio版本号15.3及以上。<br/> 2、需要引入NuGet依赖包FBoxClientDriver、FBoxClientDriver.Contract。</p>
<h1><a id="Visual_Studio_14"></a>一、Visual Studio应用开发</h1>
<h2><a id="1_16"></a>1、流程步骤</h2>
<p>①配置参数<br/> ②创建DefaultCredentialProvider对象</p>
<p>③创建FBoxClientManager对象<br/> ④登录服务器</p>
<p>⑤侦听盒子状态变更事件<br/> ⑥侦听实时数据推送变更事件</p>
<p>⑦开启盒子的所有监控点数据推送</p>
<p>⑧定义方法<br/> ⑨调用方法</p>
<h2><a id="2_31"></a>2、示例代码</h2>
<p>注意:数据推送前需要先开点</p>
<pre><code class="prism language-java">using <span class="token class-name">System</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Threading</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver<span class="token punctuation">.</span>Contract</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver<span class="token punctuation">.</span>Impl</span><span class="token punctuation">;</span>

namespace SDKDEMO
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//配置参数</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FBoxClientParameters</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">ClientId</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">ClientSecret</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">UserName</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">Password</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">IdServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"https://account.flexem.com/core"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">MainServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"http://fbox360.com"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">HdataServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"http://fbhs1.fbox360.com"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FBoxDemo</span> <span class="token operator">:</span> <span class="token class-name">IDisposable</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> readonly <span class="token class-name">IFBoxClientManager</span> _fbox<span class="token punctuation">;</span>
        <span class="token keyword">private</span> readonly string boxNo <span class="token operator">=</span> <span class="token string">"300015050009"</span><span class="token punctuation">;</span> <span class="token comment">// 以这个为例子</span>

        <span class="token keyword">public</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//创建对象并初始化</span>
            <span class="token keyword">var</span> provider <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">DefaultCredentialProvider</span><span class="token punctuation">(</span><span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>ClientId</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>ClientSecret</span><span class="token punctuation">,</span>
                    <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>UserName</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>Password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxClientManager</span><span class="token punctuation">(</span><span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>IdServer</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>MainServer</span><span class="token punctuation">,</span>
                <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>HdataServer</span><span class="token punctuation">,</span> provider<span class="token punctuation">,</span> <span class="token class-name">Guid<span class="token punctuation">.</span>NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _fbox<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 启动</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//初始化SDK，内部建立signalr连接对象，Restart只需全局执行一次。</span>
            _fbox<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//侦听盒子状态变更事件</span>
            _fbox<span class="token punctuation">.</span>BoxConnectStateChanged <span class="token operator">+=</span> _fbox_BoxConnectStateChanged<span class="token punctuation">;</span>
            <span class="token comment">//侦听实时数据变更事件</span>
            _fbox<span class="token punctuation">.</span>DataMonitorValueChanged <span class="token operator">+=</span> _fbox_DataMonitorValueChanged<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 实时数据变更函数</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">_fbox_DataMonitorValueChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DataMonitorValueChangedArgs</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            foreach <span class="token punctuation">(</span><span class="token keyword">var</span> dmon in e<span class="token punctuation">)</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>$<span class="token string">"dmv:{dmon.Uid}:{dmon.Value},{dmon.Status}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 盒子状态变更函数</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">_fbox_BoxConnectStateChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BoxConnectionStateItem</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//NewState：1、2是盒子在线状态。0、3为盒子不在线状态，根据盒子状态对盒子进行开点操作</span>
            foreach <span class="token punctuation">(</span><span class="token keyword">var</span> stateItem in e<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>$<span class="token string">"{stateItem.BoxNo},{stateItem.NewState}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 开启盒子所有监控点</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//盒子每次掉线后，重新上线后均需要重新开点</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                _fbox<span class="token punctuation">.</span><span class="token function">StartAllDataMonitorPointsOnBox</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span>boxNo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//boxNo为盒子号</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">ex<span class="token punctuation">.</span></span>Message</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">// 未登录服务器，请先Restart()</span>
                        <span class="token keyword">case</span> <span class="token string">"Box server not found."</span><span class="token operator">:</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token comment">// 当前账号下未找到BoxNo序列号的盒子</span>
                        <span class="token keyword">case</span> <span class="token string">"Not Found"</span><span class="token operator">:</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token keyword">default</span><span class="token operator">:</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 获取盒子分组和盒子信息</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">var</span> grpList <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
            foreach <span class="token punctuation">(</span><span class="token keyword">var</span> grp in grpList<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Uid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// 盒子分组的Uid</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 盒子分组名称</span>
                foreach <span class="token punctuation">(</span><span class="token keyword">var</span> box in <span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Boxes</span><span class="token punctuation">)</span>              <span class="token comment">// 遍历分组下的盒子集合</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子Id</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Alias</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子名称</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子号码</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>ConnectionState</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取的时候盒子状态， 不能作为实时状态用，也不能一直调用这个接口来作为盒子状态变更，盒子状态变更请使用SignalR实时推送</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>NetworkType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 网络类型   1:网络, 2:2G, 3:3G (这个不支持),4:Wifi ,5:4G </span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Disabled</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 盒子是否被禁用</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>ApiBaseUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ApiBaseUrl服务器地址</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>SignalrUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// SignalR服务器地址</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Owned</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 是否为拥有者</span>
                    <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// 盒子类型， 0：标准盒子，1：mini盒子,2:Lite 3：VPN盒子</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//定义方法</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//调用定义的方法</span>
                <span class="token class-name">Console<span class="token punctuation">.</span>ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>在创建IFBoxClientManager实例并初始化时，您需要提供一下参数：clientId、clientsecret、username、password、Id server、App server、和Hdata Server。<br/> username、password为FlexManager的账号、密码。<br/> clientId、clientsecret为找销售申请的账号、密码。<br/> Id server、App server、和Hdata Server若公有云的话不变，私有云改为对应地址。</p>
<h1><a id="_186"></a>二、具体操作方法</h1>
<h2><a id="1_187"></a>1、引入依赖包</h2>
<p>特别说明：<br/> 1、此依赖包适用于Visual Studio版本号15.3及以上。<br/> 第一步：使用VS2019创建.NET Core Console程序<br/> 第二步：引入NuGet依赖包</p>
<p>FBoxClientDriver<br/> FBoxClientDriver.Contract<br/> 例如引入FBoxClientDriver包<br/> 方式一</p>
<p>在Visual Studio2019命令行中执行如下语句<br/> PM&gt; Install-Package FBoxClientDriver<br/> ​```<br/><br/> 方式二</p>
<p>在Visual Studio2019中导入项目，在NuGet包库中引入依赖包名，如下图。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/dfd5cddc3a4949dca0e337f2961e6211.png#pic_center"/></p>
<h2><a id="2_207"></a>2、初始化</h2>
<p>通过配置参数登录服务器</p>
<pre><code class="prism language-java">using <span class="token class-name">System</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Linq</span><span class="token punctuation">;</span>
using <span class="token class-name">System<span class="token punctuation">.</span>Threading</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver<span class="token punctuation">.</span>Contract</span><span class="token punctuation">;</span>
using <span class="token class-name">FBoxClientDriver<span class="token punctuation">.</span>Impl</span><span class="token punctuation">;</span>

namespace SDKDEMO
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//配置参数</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FBoxClientParameters</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">ClientId</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"ClientId"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">ClientSecret</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"ClientSecret"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">UserName</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"UserName"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">Password</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"Password"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">IdServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"https://account.flexem.com/core"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">MainServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"http://fbox360.com"</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> string <span class="token class-name">HdataServer</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">"http://fbhs1.fbox360.com"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FBoxDemo</span> <span class="token operator">:</span> <span class="token class-name">IDisposable</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> readonly <span class="token class-name">IFBoxClientManager</span> _fbox<span class="token punctuation">;</span>
        <span class="token keyword">private</span> readonly string boxNo <span class="token operator">=</span> <span class="token string">"300015050009"</span><span class="token punctuation">;</span> <span class="token comment">// 以这个为例子</span>

        <span class="token keyword">public</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//创建对象并初始化</span>
            <span class="token keyword">var</span> provider <span class="token operator">=</span>
                <span class="token keyword">new</span> <span class="token class-name">DefaultCredentialProvider</span><span class="token punctuation">(</span><span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>ClientId</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>ClientSecret</span><span class="token punctuation">,</span>
                    <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>UserName</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>Password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxClientManager</span><span class="token punctuation">(</span><span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>IdServer</span><span class="token punctuation">,</span> <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>MainServer</span><span class="token punctuation">,</span>
                <span class="token class-name">FBoxClientParameters<span class="token punctuation">.</span>HdataServer</span><span class="token punctuation">,</span> provider<span class="token punctuation">,</span> <span class="token class-name">Guid<span class="token punctuation">.</span>NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            _fbox<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

       <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// 启动</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//初始化SDK，内部建立signalr连接对象，Restart只需全局执行一次。</span>
            _fbox<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//调用启动方法，内部建立signalr连接对象，Restart只需全局执行一次。</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name">Console<span class="token punctuation">.</span>ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="3FBox_278"></a>3、开启指定FBox所有监控点</h2>
<p>可开启当前在线FBox的所有监控点数据推送</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 开启盒子所有监控点</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">//盒子掉线后，每次上线均需要调此接口</span>
    _fbox<span class="token punctuation">.</span><span class="token function">StartAllDataMonitorPointsOnBox</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span>boxNo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//boxNo为盒子号</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>开启监控点数据推送<br/> 可开启指定监控点数据推送</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 开启监控点数据推送</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">StartDmonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 调接口新增监控点后，需要调此接口才能收到新增点的数据推送</span>
    _fbox<span class="token punctuation">.</span><span class="token function">StartDataMonitorPoint</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataMonitorPointArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>                      <span class="token comment">//盒子号</span>
        <span class="token class-name">DataMonitorUid</span> <span class="token operator">=</span> <span class="token number">113470726140747285</span> <span class="token comment">//监控点Uid</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartDmonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启监控点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="4_333"></a>4、盒子状态变更推送</h2>
<p>当服务器侦测到FBox发生状态变更，则会推送消息<br/> 消息内容为数组<br/> 单个对象属性如下表</p>
<table><thead><tr><th>字段名</th><th>类型</th><th>参数描述</th></tr></thead><tbody><tr><td>id</td><td>string</td><td>FBox的Id</td></tr><tr><td>state</td><td>int</td><td>盒子当前状态，0：未知，1：已连接，2：超时，3：已断开</td></tr><tr><td>net</td><td>int</td><td>盒子网络类型1:网络 2:2G,3:3G(目前不支持)4:WIFI,5:4G</td></tr><tr><td>rssi</td><td>int</td><td>信号：0~8</td></tr><tr><td>vers</td><td>json对象</td><td>FBox固件版本，fcs，fds,floader.</td></tr><tr><td>mode</td><td>int</td><td>FBox状态0：正常，1：透传中</td></tr></tbody></table>
<p>侦听事件</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 启动</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 通过参数登录服务器</span>
    _fbox<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//侦听盒子状态变更事件</span>
    _fbox<span class="token punctuation">.</span>BoxConnectStateChanged <span class="token operator">+=</span> _fbox_BoxConnectStateChanged<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 盒子状态变更函数</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">_fbox_BoxConnectStateChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BoxConnectionStateItem</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> stateItem in e<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>$<span class="token string">"{stateItem.BoxNo},{stateItem.NewState}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="5_387"></a>5、实时数据推送</h2>
<p>前提条件：监控点已经开启，盒子每次掉线后，重新上线后均需要重新开点<br/> 当监控点数据发生变化或者开启监控条目时，服务器推送消息。</p>
<table><thead><tr><th>字段名</th><th>类型</th><th>参数描述</th></tr></thead><tbody><tr><td>boxSessionId</td><td>int</td><td>目前可忽略</td></tr><tr><td>values</td><td>json数组</td><td>监控点的值集合，单个属性详情见下表</td></tr><tr><td>boxUid</td><td>string</td><td>FBox的id</td></tr></tbody></table>
<p>value对应属性</p>
<table><thead><tr><th>字段名</th><th>类型</th><th>参数描述</th></tr></thead><tbody><tr><td>id</td><td>string</td><td>监控点条目uid</td></tr><tr><td>value</td><td>string</td><td>值，若条目配置小数位则需程序自己转，服务器不做任何中转</td></tr><tr><td>status</td><td>int</td><td>如果条目正常，则无此属性1：无数据，2：超时，3：错误，4：Socket异常，5：FDS错误，16：未完成</td></tr></tbody></table>
<p>侦听事件</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 启动</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 通过参数登录服务器</span>
    _fbox<span class="token punctuation">.</span><span class="token function">Restart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//侦听实时数据变更事件</span>
    _fbox<span class="token punctuation">.</span>DataMonitorValueChanged <span class="token operator">+=</span> _fbox_DataMonitorValueChanged<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 实时数据变更函数</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sender"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="e"&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">_fbox_DataMonitorValueChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DataMonitorValueChangedArgs</span><span class="token punctuation">&gt;</span></span> e<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> dmon in e<span class="token punctuation">)</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span>$<span class="token string">"dmv:{dmon.Uid}:{dmon.Value},{dmon.Status}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="6_443"></a>6、获取盒子信息与盒子分组</h2>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取盒子分组和盒子信息</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> grpList <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> grp in grpList<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Uid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// 盒子分组的Uid</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 盒子分组名称</span>
        foreach <span class="token punctuation">(</span><span class="token keyword">var</span> box in <span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Boxes</span><span class="token punctuation">)</span>              <span class="token comment">// 遍历分组下的盒子集合</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子Id</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Alias</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子名称</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 盒子号码</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>ConnectionState</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取的时候盒子状态， 不能作为实时状态用，也不能一直调用这个接口来作为盒子状态变更，盒子状态变更请使用SignalR实时推送</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>NetworkType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 网络类型   1:网络, 2:2G, 3:3G (这个不支持),4:Wifi ,5:4G </span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Disabled</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 盒子是否被禁用</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>ApiBaseUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ApiBaseUrl服务器地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>SignalrUrl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// SignalR服务器地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>Owned</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 是否为拥有者</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">box<span class="token punctuation">.</span></span>BoxType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// 盒子类型， 0：标准盒子，1：mini盒子,2:Lite 3：VPN盒子</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetBoxGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="7_485"></a>7、获取盒子监控点分组和监控点条目</h2>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取盒子监控点分组和监控点条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">public</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DmonItemDtoV2</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">GetDmonGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> dmonGrps <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetDmonGroupDmonsV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span>boxNo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> grp in dmonGrps<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 监控点分组的Id</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 监控点分组的名称</span>
        foreach <span class="token punctuation">(</span><span class="token keyword">var</span> item in <span class="token class-name"><span class="token namespace">grp<span class="token punctuation">.</span></span>Items</span><span class="token punctuation">)</span>     <span class="token comment">// 遍历当前分组grp下所有的监控点条目</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//监控点Id</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//监控点名称</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>DevAlias</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//PLC别名</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>StationNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//站号</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>IsDeviceChanged</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设备是否被移除（只有在移除时出现该参数，为true）FBox的连接设备変更后会出现该参数</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>TaskState</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//条目状态</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>DeadValue</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//死值区</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>BitIndex</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//按位索引号</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>BitIndexEnabled</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//是否启用按位索引号</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>BitStateLabel</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//位类型数据标签</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>CharCount</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//字符个数</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>DataType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//数据类型</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Encoding</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//编码方式</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>FractionalDigits</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//小数位</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>GroupId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//监控点分组</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>GroupName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//监控点名称</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>IntegralDigits</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//整数位（目前无作用）</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>IoWidth</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//寄存器位宽</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>MainAddress</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//主地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Memo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//备注</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Privilege</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//读写模式</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>RegId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//寄存器Id</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>RegName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//寄存器名称</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>StringByteOrder</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字节序</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>SubAddress</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//子地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>SubIndex</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//DB块地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>TrafficSaving</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//是否开启省流量模式</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>Unit</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//单位</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">item<span class="token punctuation">.</span></span>ValueTransform</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//数据运算</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">dmonGrps<span class="token punctuation">.</span></span>SelectMany</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name"><span class="token namespace">x<span class="token punctuation">.</span></span>Items</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//监控点条目集合</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetDmonGroups</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="8_548"></a>8、监控点值写入</h2>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 监控点写值</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="requet"&gt;&lt;/param&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">WriteDmonValue</span><span class="token punctuation">(</span><span class="token class-name">WriteDmonRequest</span> requet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">WriteValue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DataMonitorWriteValueArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">requet<span class="token punctuation">.</span></span>BoxNo</span><span class="token punctuation">,</span>                     <span class="token comment">//盒子号</span>
        <span class="token class-name">DataMonitorGroupName</span> <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">requet<span class="token punctuation">.</span></span>DmonGrpName</span><span class="token punctuation">,</span><span class="token comment">//监控点组名称</span>
        <span class="token class-name">DataMonitorName</span> <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">requet<span class="token punctuation">.</span></span>DmonName</span><span class="token punctuation">,</span>        <span class="token comment">//监控点条目名称</span>
        <span class="token class-name">Value</span> <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">requet<span class="token punctuation">.</span></span>Value</span><span class="token punctuation">,</span>                     <span class="token comment">//条目的值</span>
        <span class="token class-name">Type</span> <span class="token operator">=</span> <span class="token class-name">WriteValueType<span class="token punctuation">.</span>AutoParse</span> <span class="token comment">//条目值类型，0：和监控点值类型一致,1：十进制,2：字符串,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WriteDmonRequest</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> string <span class="token class-name">BoxNo</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> string <span class="token class-name">DmonGrpName</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> string <span class="token class-name">DmonName</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> object <span class="token class-name">Value</span> <span class="token punctuation">{<!-- --></span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>WriteDmonValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="9_589"></a>9、驱动器操作</h2>
<h3><a id="plc_590"></a>获取盒子下所有的plc</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取盒子下的所有PLC</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">GetPlcs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> boxplc <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetPlcDeviceV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo                              <span class="token comment">//盒子号</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> plc in boxplc<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Alias</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">//plc别名</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>BaudRate</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//波特率</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>BroadcastStationNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//广播站号</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设备类型，0:主设备，1：从设备，2：主从设备（目前不支持）</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>DataBits</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//数据位</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>DefaultStationNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//默认广播站号</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>EnableBroadcast</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//使能广播站号</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Interface</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//串口接口类型，0：RS232，1：RS485_2，2：RS485_4，85：网络（串口1支持RS232、RS485_2和RS485_4,串口2仅支持RS485_2，串口3仅支持RS232）</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//IP地址</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>ParityType</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//校验位，none：无校验，odd：奇校验，even：偶校验</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>PlcAdvancedSettings</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//高级设置</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>PlcDongleFlag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//远程停机状态</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>PlcId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//PLCId</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>SlaveNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//从设备号</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>StopBits</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//停止位</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>PlcName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//PLC名称</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//类型，0：串口，2：以太网</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>Port</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//以太网端口号</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">plc<span class="token punctuation">.</span></span>PortNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//站号</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetPlcs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="PLC_639"></a>下载PLC</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 下载PLC</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">DownloadPlc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">DownLoadPlcsV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AddOrUpdatePlcDeviceArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>
        <span class="token class-name">PlcList</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AddOrUpdatePlcDeviceV2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//以下为下载一个plc为例</span>
            <span class="token comment">//注意，本方法下载plc时会覆盖之前的plc，如需多个plc，自行添加</span>
            <span class="token keyword">new</span> <span class="token class-name">AddOrUpdatePlcDeviceV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">PlcId</span> <span class="token operator">=</span>  <span class="token number">305</span><span class="token punctuation">,</span>                       <span class="token comment">//PLCId</span>
                <span class="token class-name">PlcName</span> <span class="token operator">=</span> <span class="token string">"ABB"</span><span class="token punctuation">,</span>                    <span class="token comment">//PLC名称</span>
                <span class="token class-name">Alias</span> <span class="token operator">=</span> <span class="token string">"ABB AC500_RTU"</span><span class="token punctuation">,</span>            <span class="token comment">//别名</span>
                <span class="token class-name">Type</span> <span class="token operator">=</span> <span class="token class-name">ServerType<span class="token punctuation">.</span>Serial</span><span class="token punctuation">,</span>     <span class="token comment">//类型，0：串口，2：以太网</span>
                <span class="token class-name">PortNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>                        <span class="token comment">//编号</span>
                <span class="token class-name">Class</span> <span class="token operator">=</span> <span class="token class-name">PlcClass<span class="token punctuation">.</span>Master</span><span class="token punctuation">,</span>       <span class="token comment">//设备类型，0:主设备，1：从设备，2：主从设备（目前不支持）</span>
                <span class="token class-name">DefaultStationNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>               <span class="token comment">//默认站号</span>
                <span class="token class-name">Interface</span> <span class="token operator">=</span> <span class="token class-name">DeviceInterfaceTypes<span class="token punctuation">.</span>Tcp</span><span class="token punctuation">,</span><span class="token comment">//串口接口类型，0：RS232，1：RS485_2，2：RS485_4，85：网络（串口1支持RS232、RS485_2和RS485_4,串口2仅支持RS485_2，串口3仅支持RS232）</span>
                <span class="token class-name">BaudRate</span> <span class="token operator">=</span> <span class="token number">9600</span><span class="token punctuation">,</span>                   <span class="token comment">//波特率</span>
                <span class="token class-name">Port</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>                       <span class="token comment">//网络设备端口号</span>
                <span class="token class-name">DataBits</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span>                     <span class="token comment">//数据位</span>
                <span class="token class-name">StopBits</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>                      <span class="token comment">//停止位</span>
                <span class="token class-name">ParityType</span> <span class="token operator">=</span> <span class="token class-name">ParityType<span class="token punctuation">.</span>None</span><span class="token punctuation">,</span> <span class="token comment">//校验位，none：无校验，odd：奇校验，even：偶校验</span>
                <span class="token class-name">Ip</span> <span class="token operator">=</span> <span class="token string">"0"</span><span class="token punctuation">,</span>                        <span class="token comment">//IP地址</span>
                <span class="token class-name">EnableBroadcast</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token comment">//是否启动广播站号</span>
                <span class="token class-name">BroadcastStationNo</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>        <span class="token comment">//广播站号</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>DownloadPlc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="10_690"></a>10、监控点操作</h2>
<h3><a id="_691"></a>新增监控点条目</h3>
<p>监控点添加完后需要连接SignalR成功后，开启添加的监控点数据推送。</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 新增监控点条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">AddDMon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">AddDataMonitorPointV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AddDmonsArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">AddDmons</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AddDataMonitorDefinitionV2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">new</span> <span class="token class-name">AddDataMonitorDefinitionV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">GroupName</span> <span class="token operator">=</span>  <span class="token string">"fff"</span><span class="token punctuation">,</span><span class="token comment">//监控点分组名称，和groupId任选一个使用，若使用不存在的监控点分组，则会自动增加该分组</span>
                <span class="token class-name">Name</span>  <span class="token operator">=</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span><span class="token comment">//监控点名称</span>
                <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Local"</span><span class="token punctuation">,</span><span class="token comment">//PLC别名</span>
                <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//站号</span>
                <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Int16</span><span class="token punctuation">,</span><span class="token comment">//数据类型，详情见接口文档中附录二</span>
                <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"LW"</span><span class="token punctuation">,</span><span class="token comment">//寄存器名称，和regId、iowidth确定唯一寄存器</span>
                <span class="token class-name">Privilege</span> <span class="token operator">=</span> <span class="token class-name">PrivilegeType<span class="token punctuation">.</span>ReadWrite</span><span class="token punctuation">,</span><span class="token comment">//读写权限，2：Write,4：ReadOnly,6：ReadWrite,</span>
                <span class="token comment">//地址请根据设备的配置进行填写</span>
                <span class="token class-name">MainAddress</span> <span class="token operator">=</span>  <span class="token number">5</span><span class="token punctuation">,</span><span class="token comment">//主地址</span>
                <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//子地址</span>
                <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//DB块地址</span>
                <span class="token class-name">BitIndexEnabled</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//是否启用按位索引</span>
                <span class="token class-name">IntegralDigits</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//整数位（目前无作用）</span>
                <span class="token class-name">FractionalDigits</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//小数位</span>
                <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token string">"度"</span><span class="token punctuation">,</span><span class="token comment">//单位，仅对字类型有效</span>
                <span class="token class-name">TrafficSaving</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//是否启用省流量模式，true:启用，false：不启用</span>
                <span class="token class-name">BitStateLabel</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BitStateLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token class-name">FalseLabel</span> <span class="token operator">=</span> <span class="token string">"关机"</span><span class="token punctuation">,</span><span class="token class-name">TrueLabel</span> <span class="token operator">=</span> <span class="token string">"开机"</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//位类型时显示标签，属性ttext:值为1时显示的文本，ftext：值为0时显示的文本</span>
                <span class="token class-name">Memo</span> <span class="token operator">=</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span><span class="token comment">//备注</span>
                <span class="token class-name">DeadValue</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//死区值，数据再±deadValue范围内数据不推送</span>
                <span class="token comment">//只有在DataType = DataType.String（字符串类型） 时有以下参数</span>
                <span class="token comment">//Encoding = EncodeType.None,//编码格式，字符串类型使用0：无，非字符串类型使用，1：Unicode,2:Ascii</span>
                <span class="token comment">//StringByteOrder = StringByteOrder.O12,//字符串字节序，编码为Ascii格式时有效0：倒序，1：正序</span>
                <span class="token comment">//CharCount = 5, //字符个数</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span><span class="token comment">//盒子号</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>AddDMon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_748"></a>更新监控点条目</h3>
<p>监控点添加完后需要连接SignalR成功后，开启监控点数据推送。</p>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 更新监控点条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">UpdateDmon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">UpdateDataMonitorPointV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateDmonArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span><span class="token comment">//盒子号</span>
        <span class="token class-name">UpdateDmonList</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UpdateDataMonitorDefinitionV2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">new</span> <span class="token class-name">UpdateDataMonitorDefinitionV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Id</span> <span class="token operator">=</span> <span class="token number">113470726140747285</span><span class="token punctuation">,</span><span class="token comment">//需要更新条目的Id</span>
                <span class="token class-name">GroupName</span> <span class="token operator">=</span> <span class="token string">"fff"</span><span class="token punctuation">,</span><span class="token comment">//监控点分组名称，和groupId任选一个使用，若使用不存在的监控点分组，则会自动增加该分组</span>
                <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token string">"ggg"</span><span class="token punctuation">,</span><span class="token comment">//监控点名称</span>
                <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Local"</span><span class="token punctuation">,</span><span class="token comment">//PLC别名</span>
                <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//站号</span>
                <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Int16</span><span class="token punctuation">,</span><span class="token comment">//数据类型，详情见接口文档中附录二</span>
                <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"LW"</span><span class="token punctuation">,</span><span class="token comment">//寄存器名称，和regId、iowidth确定唯一寄存器</span>
                <span class="token comment">//地址请根据设备的配置进行填写</span>
                <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token comment">//主地址</span>
                <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//子地址</span>
                <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//DB块地址</span>
                <span class="token class-name">IntegralDigits</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//整数位（目前无作用）</span>
                <span class="token class-name">FractionalDigits</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token comment">//小数位</span>
                <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token string">"度"</span><span class="token punctuation">,</span><span class="token comment">//单位</span>
                <span class="token class-name">Privilege</span> <span class="token operator">=</span> <span class="token class-name">PrivilegeType<span class="token punctuation">.</span>ReadOnly</span><span class="token punctuation">,</span><span class="token comment">//读写权限，2：Write,4：ReadOnly,6：ReadWrite,</span>
                <span class="token class-name">TrafficSaving</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//是否启用省流量模式，true:启用，false：不启用</span>
                <span class="token class-name">DeadValue</span> <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span><span class="token comment">//死区值，数据再±deadValue范围内数据不推送</span>
                <span class="token class-name">BitStateLabel</span> <span class="token operator">=</span>  <span class="token keyword">new</span> <span class="token class-name">BitStateLabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//位类型时显示标签，属性ttext:值为1时显示的文本，ftext：值为0时显示的文本</span>
                <span class="token class-name">Memo</span> <span class="token operator">=</span> <span class="token string">"ggg"</span><span class="token punctuation">,</span><span class="token comment">//备注</span>
                <span class="token class-name">Encoding</span> <span class="token operator">=</span> <span class="token class-name">EncodeType<span class="token punctuation">.</span>None</span><span class="token comment">//编码格式，字符串类型使用0：无，非字符串类型使用，1：Unicode,2:Ascii</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>UpdateDmon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
删除监控点条目
<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 删除监控点条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">RemoveDmon</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span> ids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{<!-- --></span> <span class="token number">113470815205744205</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    _fbox<span class="token punctuation">.</span><span class="token function">RemoveDataMonitorPointV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RemoveDataMonDefArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span> <span class="token comment">//盒子号</span>
        <span class="token class-name">Ids</span> <span class="token operator">=</span> ids      <span class="token comment">//需要删除的监控点条目Id集合</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>RemoveDmon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="11_828"></a>11、报警操作</h2>
<h3><a id="_829"></a>获取盒子底下所有的报警条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取盒子底下所有的报警条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">public</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AlarmDefintitionDtoV2</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">GetAlarmItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> allitems <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetAllAlarmDefinitionsV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> items in allitems<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>TaskState</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//条目状态</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>AlarmGroup</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//报警分组</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>AlarmMessage</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//报警信息</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//报警条目编码</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Condition1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//报警条件一</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>ConditionCombineMethod</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//条件组合</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//报警条目Id</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>IsDeviceChanged</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//设备是否已经变更</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Memo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//备注</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//报警条目名称</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Operand1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">操作数，若选择Bit数据类型，操作数0为OFF，1为ON</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Condition2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//报警条件二</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Operand2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//操作数二</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> allitems<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetAlarmItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_874"></a>获取报警历史记录条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取报警历史记录</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">GetAlarmHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> hdata <span class="token operator">=</span> _fbox<span class="token punctuation">.</span><span class="token function">GetAlarmEvents</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AlarmEventQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BeginTime</span> <span class="token operator">=</span> <span class="token class-name">DateTime<span class="token punctuation">.</span>Parse</span><span class="token punctuation">(</span><span class="token string">"2018-4-5"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//开始时间 long型的utc时间戳unix epoch</span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>                          <span class="token comment">//盒子号</span>
        <span class="token class-name">EndTime</span> <span class="token operator">=</span> <span class="token class-name">DateTime<span class="token punctuation">.</span>Parse</span><span class="token punctuation">(</span><span class="token string">"2018-4-24"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">//结束时间 long型的utc时间戳unix epoch</span>
        <span class="token class-name">Limit</span> <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span>                            <span class="token comment">//获取条数限制，结果条数限制 负值为向前查询，建议使用500.</span>
        <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token string">"313265"</span>                         <span class="token comment">//报警条目的编码，若全查则无需该参数</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> data in hdata<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>Action</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//类型</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>AlarmId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//报警条目Id</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>Code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//报警条目编码</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>Message</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//报警信息</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>Value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//监控点值</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">data<span class="token punctuation">.</span></span>TimestampUnixEpoch</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//时间戳</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetAlarmHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_914"></a>新增报警条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 新增报警条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">AddAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">AddAlarmDefinitionV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AddAlarmDefArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">AddAlarms</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AddAlarmDefinitionV2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">new</span> <span class="token class-name">AddAlarmDefinitionV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token string">"报警名称"</span><span class="token punctuation">,</span>        <span class="token comment">// 新增报警条目名称是唯一的，不可同名</span>
                <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Modbus_TCP"</span><span class="token punctuation">,</span> <span class="token comment">//设备驱动别名</span>
                <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>          <span class="token comment">//PLC通讯站号</span>
                <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Bit</span><span class="token punctuation">,</span> <span class="token comment">//数据类型，详情见接口文档中附录二</span>
                <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"4X_bit"</span><span class="token punctuation">,</span>    <span class="token comment">//寄存器名称，和regId、iowidth确定唯一寄存器</span>
                <span class="token comment">//地址请根据报警条目需要检测的监控点配置</span>
                <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment">//主地址</span>
                <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//子地址</span>
                <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//DB块地址</span>
                <span class="token class-name">AlarmMessage</span> <span class="token operator">=</span> <span class="token string">"XXXX"</span><span class="token punctuation">,</span>  <span class="token comment">//报警信息</span>
                <span class="token class-name">GroupName</span> <span class="token operator">=</span> <span class="token string">"报警分组"</span><span class="token punctuation">,</span> <span class="token comment">//报警点分组名称或使用GroupId报警分组Id，优先名称</span>
                <span class="token class-name">Memo</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>             <span class="token comment">//备注</span>
                <span class="token comment">//以下为报警条件</span>
                <span class="token class-name">Condition1</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionType<span class="token punctuation">.</span>Eq</span><span class="token punctuation">,</span><span class="token comment">//触发报警条件类型，报警条件一，0：不等于，1：等于，2：大于，3：大于等于，4：小于，5：小于等于</span>
                <span class="token class-name">Operand1</span> <span class="token operator">=</span> <span class="token number">80</span><span class="token punctuation">,</span>  <span class="token comment">//条件值</span>
                <span class="token class-name">ConditionCombineMethod</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionCombineMethod<span class="token punctuation">.</span>And</span><span class="token punctuation">,</span> <span class="token comment">//条件联合，None：无，And：与，Or：或</span>
                <span class="token class-name">Condition2</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionType<span class="token punctuation">.</span>Eq</span><span class="token punctuation">,</span><span class="token comment">//触发报警条件类型，报警条件一，0：不等于，1：等于，2：大于，3：大于等于，4：小于，5：小于等于</span>
                <span class="token class-name">Operand2</span> <span class="token operator">=</span> <span class="token number">90</span> <span class="token comment">//条件值</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo     <span class="token comment">//新增报警条目的盒子号</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>AddAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_965"></a>更新报警条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 更新报警条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">UpdateAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">UpdateAlarmDefinitionV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateAlarmDefArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span><span class="token comment">//报警条目的盒子号</span>
        <span class="token class-name">UpdateAlarms</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UpdateAlarmDefinitionV2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">new</span> <span class="token class-name">UpdateAlarmDefinitionV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Id</span> <span class="token operator">=</span> <span class="token number">113522543645056649</span><span class="token punctuation">,</span><span class="token comment">//报警条目的Id</span>
                <span class="token class-name">Name</span> <span class="token operator">=</span> <span class="token string">"修改了"</span><span class="token punctuation">,</span> <span class="token comment">//报警条目名称 </span>
                <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Modbus_TCP"</span><span class="token punctuation">,</span><span class="token comment">//设备驱动别名</span>
                <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//PLC通讯站号</span>
                <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Int16</span><span class="token punctuation">,</span><span class="token comment">//数据类型，详情见接口文档中附录二</span>
                <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"4X"</span><span class="token punctuation">,</span><span class="token comment">//寄存器名称，和regId、iowidth确定唯一寄存器</span>
                <span class="token comment">//地址请根据报警条目需要检测的监控点配置</span>
                <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">//主地址</span>
                <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//子地址</span>
                <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//DB块地址</span>
                <span class="token class-name">GroupName</span> <span class="token operator">=</span> <span class="token string">"报警分组"</span><span class="token punctuation">,</span><span class="token comment">//报警分组名称，与groupId使用一个即可</span>
                <span class="token comment">//以下为报警条件</span>
                <span class="token class-name">Condition1</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionType<span class="token punctuation">.</span>Lt</span><span class="token punctuation">,</span><span class="token comment">//触发报警条件类型，报警条件一，0：不等于，1：等于，2：大于，3：大于等于，4：小于，5：小于等于</span>
                <span class="token class-name">Operand1</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token comment">//条件值一，若选择Bit数据类型，操作数0为OFF，1为ON</span>
                <span class="token class-name">ConditionCombineMethod</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionCombineMethod<span class="token punctuation">.</span>And</span><span class="token punctuation">,</span> <span class="token comment">//条件联合，None：无，And：与，Or：或</span>
                <span class="token class-name">Condition2</span> <span class="token operator">=</span> <span class="token class-name">AlarmConditionType<span class="token punctuation">.</span>Eq</span><span class="token punctuation">,</span><span class="token comment">//触发报警条件类型，报警条件二，0：不等于，1：等于，2：大于，3：大于等于，4：小于，5：小于等于</span>
                <span class="token class-name">Operand2</span> <span class="token operator">=</span> <span class="token number">90</span> <span class="token comment">//条件值二</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>UpdateAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1015"></a>删除报警条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 删除报警条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">RemoveAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> ids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token number">110424333146494353</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    _fbox<span class="token punctuation">.</span><span class="token function">RemoveAlarmDefinitionV2</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RemoveAlarmDefArgsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>      <span class="token comment">//盒子号</span>
        <span class="token class-name">Ids</span> <span class="token operator">=</span> ids           <span class="token comment">//删除的报警条目UId</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>RemoveAlarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="12_1044"></a>12、历史操作</h2>
<h3><a id="_1045"></a>获取历史记录多通道数据</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取历史记录多通道数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token class-name">IList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ByRowHistoryDataRow</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">GetHdataHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> hdata <span class="token operator">=</span>  _fbox<span class="token punctuation">.</span><span class="token function">GetByRowHistoryData</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetHistoryDataArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>                                <span class="token comment">//盒子号</span>
        <span class="token class-name">StartTime</span> <span class="token operator">=</span> <span class="token class-name">DateTime<span class="token punctuation">.</span>Parse</span><span class="token punctuation">(</span><span class="token string">"2018-06-06 08:58:32"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>       <span class="token comment">//起始时间</span>
        <span class="token class-name">EndTime</span> <span class="token operator">=</span> <span class="token class-name">DateTime<span class="token punctuation">.</span>Parse</span><span class="token punctuation">(</span><span class="token string">"2018-06-07 08:58:32"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token comment">//结束时间</span>
        <span class="token class-name">Limit</span> <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">,</span>                                 <span class="token comment">//最大获取数据条数</span>
        <span class="token class-name">TimeRange</span> <span class="token operator">=</span> <span class="token class-name">TimeRangeTypes<span class="token punctuation">.</span>BeginOpenEndOpen</span><span class="token punctuation">,</span> <span class="token comment">//区间类型,BeginCloseEndClose:全毕区间,BeginCloseEndOpen:左闭右开，BeginOpenEndClose:左开右闭，BeginOpenEndOpen:全开区间</span>
        <span class="token class-name">HdataItemName</span> <span class="token operator">=</span> <span class="token string">"XX"</span><span class="token punctuation">,</span>                        <span class="token comment">//历史数据条目名称</span>
        <span class="token class-name">HdataChannelNames</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token string">"11"</span><span class="token punctuation">,</span> <span class="token string">"22"</span><span class="token punctuation">}</span><span class="token comment">//通道名称</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> d in <span class="token class-name"><span class="token namespace">hdata<span class="token punctuation">.</span></span>Rows</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">d<span class="token punctuation">.</span></span>Time</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 历史数据条目的采集时间</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">d<span class="token punctuation">.</span></span>Values</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 对应通道名称集合中的第一个元素</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">d<span class="token punctuation">.</span></span>Values</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 对应通道名称集合中的第二个元素</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">hdata<span class="token punctuation">.</span></span>Rows</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetHdataHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1085"></a>获取历史记录条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取历史记录条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">GetHdataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> itemlist <span class="token operator">=</span>  _fbox<span class="token punctuation">.</span><span class="token function">GetHdataItems</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BoxArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo                                       <span class="token comment">//盒子号</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Result<span class="token punctuation">;</span>
    foreach <span class="token punctuation">(</span><span class="token keyword">var</span> items in itemlist<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>BoxId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">//盒子Id</span>
        foreach <span class="token punctuation">(</span><span class="token keyword">var</span> channels in <span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Channels</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>Uid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">//通道Id</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>HasSubAddress</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//寄存器是否有子地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>HasSubIndex</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//寄存器是否有DB块地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>DataType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//数据类型，详情见接口文档中附录二</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>MainAddress</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//主地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>RegName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//寄存器名称</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>RegId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//寄存器Id</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>IoWidth</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//寄存器位宽</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>StationNo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">//站号</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>SubAddress</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">//子地址</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>DevAlias</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//PLC别名</span>
            <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">channels<span class="token punctuation">.</span></span>SubIndex</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//DB块地址</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">//名称</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>RecordingPeriod</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//采集周期</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>Uid</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token comment">//主键</span>
        <span class="token class-name">Console<span class="token punctuation">.</span>WriteLine</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">items<span class="token punctuation">.</span></span>IsControl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">//是否使用使能</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>GetHdataList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1135"></a>新增历史记录条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 新增历史记录多通道</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">AddHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">AddHdataItems</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AddHdataItemArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>                          <span class="token comment">//盒子号</span>
        <span class="token class-name">HdataItems</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AddHdataItemDto</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//以下为增加一个通道为例，增加多个通道自行增加</span>
                    <span class="token keyword">new</span> <span class="token class-name">AddHdataChannelsDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">ChannelName</span> <span class="token operator">=</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>    <span class="token comment">//通道名称</span>
                        <span class="token class-name">AddressDescription</span> <span class="token operator">=</span> <span class="token string">"LW"</span><span class="token punctuation">,</span><span class="token comment">//地址描述</span>
                        <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>          <span class="token comment">//站号</span>
                        <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Bcd16</span><span class="token punctuation">,</span><span class="token comment">//数据类型，详情见接口文档中附录二</span>
                        <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Modbus_TCP"</span><span class="token punctuation">,</span>  <span class="token comment">//PLC别名</span>
                        <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"4X"</span><span class="token punctuation">,</span>        <span class="token comment">//寄存器名称，与regId，iowidth确认唯一寄存器</span>
                        <span class="token comment">//请根据设备的配置填写</span>
                        <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>        <span class="token comment">//主地址</span>
                        <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>         <span class="token comment">//子地址</span>
                        <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">//DB块地址</span>
                        <span class="token class-name">BitIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>           <span class="token comment">//按位索引号</span>
                        <span class="token class-name">BitIndexEnabled</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//是否启用按位索引 </span>
                        <span class="token class-name">FractionalDigits</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token comment">//通道小数位</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token class-name">IsControl</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否使能控制</span>
                <span class="token comment">//当使能控制为true时，填写以下使能参数</span>
                <span class="token class-name">ControlOptions</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HDataControlOptionsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//使能参数</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">ControlType</span> <span class="token operator">=</span> <span class="token class-name">HControlType</span><span class="token punctuation">.</span>OFF<span class="token punctuation">,</span><span class="token comment">//使能配置,0:OFF,1:ON</span>
                    <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Bit</span><span class="token punctuation">,</span>    <span class="token comment">//数据类型，详情见接口文档中附录二</span>
                    <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"Modbus_TCP"</span><span class="token punctuation">,</span>    <span class="token comment">//PLC别名</span>
                    <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>              <span class="token comment">//站号</span>
                    <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"4X_bit"</span><span class="token punctuation">,</span>         <span class="token comment">//寄存器名称，和regId、iowidth确定唯一寄存器</span>
                    <span class="token comment">//请根据设备的配置填写</span>
                    <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token comment">//主地址</span>
                    <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>             <span class="token comment">//子地址</span>
                    <span class="token class-name">AddressDescription</span> <span class="token operator">=</span> <span class="token string">"LW"</span><span class="token punctuation">,</span>  <span class="token comment">//地址描述</span>
                    <span class="token class-name">BitIndex</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>               <span class="token comment">//按位索引号</span>
                    <span class="token class-name">BitIndexEnabled</span> <span class="token operator">=</span> <span class="token boolean">false</span>     <span class="token comment">//是否启用按位索引</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>AddHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1200"></a>更新历史记录条目</h3>
<pre><code class="prism language-java"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 更新历史记录多通道</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">UpdateHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">UpdateHdataItems</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UpdateHdataItemArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>
        <span class="token class-name">HdataItems</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UpdateHdataItemDto</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//以下为更新一个通道为例</span>
                    <span class="token keyword">new</span> <span class="token class-name">UpdateHdataChannelsDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        <span class="token class-name">Uid</span> <span class="token operator">=</span> <span class="token number">97427676249298676</span><span class="token punctuation">,</span> <span class="token comment">//通道Uid</span>
                        <span class="token class-name">ChannelName</span> <span class="token operator">=</span> <span class="token string">"15"</span><span class="token punctuation">,</span><span class="token comment">//通道名称</span>
                        <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"ABB AC500_RTU"</span><span class="token punctuation">,</span><span class="token comment">//PLC别名</span>
                        <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token comment">//站号</span>
                        <span class="token class-name">DataType</span> <span class="token operator">=</span>   <span class="token class-name">DataType<span class="token punctuation">.</span>Int16</span><span class="token punctuation">,</span><span class="token comment">//数据类型，详情见接口文档中附录二</span>
                        <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"4X"</span><span class="token punctuation">,</span><span class="token comment">//寄存器名称，与regId，iowidth确认唯一寄存器</span>
                        <span class="token comment">//请根据设备的配置进行填写</span>
                        <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token comment">//主地址</span>
                        <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//子地址</span>
                        <span class="token class-name">SubIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//索引地址</span>
                        <span class="token class-name">Unit</span> <span class="token operator">=</span> <span class="token string">"°"</span><span class="token punctuation">,</span><span class="token comment">//单位</span>
                        <span class="token class-name">IntegralDigits</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token comment">//整数位</span>
                        <span class="token class-name">FractionalDigits</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token comment">//小数位</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token class-name">IsControl</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   <span class="token comment">//是否启用使能配置</span>
                <span class="token comment">//当启用使能配置时，请配置使能参数</span>
                <span class="token class-name">ControlOptions</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HDataControlOptionsV2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//使能参数</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name">ControlType</span> <span class="token operator">=</span> <span class="token class-name">HControlType</span><span class="token punctuation">.</span>OFF<span class="token punctuation">,</span><span class="token comment">//使能状态,0:OFF,1:ON</span>
                    <span class="token class-name">DataType</span> <span class="token operator">=</span> <span class="token class-name">DataType<span class="token punctuation">.</span>Bit</span><span class="token punctuation">,</span>  <span class="token comment">//数据类型，详情见接口文档中附录二</span>
                    <span class="token class-name">DevAlias</span> <span class="token operator">=</span> <span class="token string">"ABB AC500_RTU"</span><span class="token punctuation">,</span>   <span class="token comment">//PLC别名</span>
                    <span class="token class-name">StationNo</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>              <span class="token comment">//站号</span>
                    <span class="token class-name">RegName</span> <span class="token operator">=</span> <span class="token string">"0X"</span><span class="token punctuation">,</span>             <span class="token comment">//寄存器名称与regId，iowidth确认唯一寄存器</span>
                    <span class="token comment">//请根据设备的配置进行填写</span>
                    <span class="token class-name">MainAddress</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token comment">//主地址</span>
                    <span class="token class-name">SubAddress</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>             <span class="token comment">//子地址</span>
                    <span class="token class-name">AddressDescription</span> <span class="token operator">=</span> <span class="token string">"ABB"</span><span class="token punctuation">,</span>  <span class="token comment">//地址描述</span>
                    <span class="token class-name">BitIndex</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>               <span class="token comment">//按位索引号</span>
                    <span class="token class-name">BitIndexEnabled</span> <span class="token operator">=</span> <span class="token boolean">false</span>     <span class="token comment">//是否启用按位索引</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>UpdateHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
删除历史记录条目
<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 删除历史记录条目</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">RemoveHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _fbox<span class="token punctuation">.</span><span class="token function">RemoveHdataItem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RemoveHdataItemArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BoxNo</span> <span class="token operator">=</span> boxNo<span class="token punctuation">,</span>                                  <span class="token comment">//盒子号</span>
        <span class="token class-name">Ids</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token number">85289974828733605</span> <span class="token punctuation">}</span>    <span class="token comment">//历史记录Id集合</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//在Program，Main函数中调用</span>
<span class="token keyword">class</span> <span class="token class-name">Program</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            using <span class="token punctuation">(</span><span class="token keyword">var</span> fbox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FBoxDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//启动</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>StartAllDMonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//开启FBox所有监控点</span>
                <span class="token class-name"><span class="token namespace">fbox<span class="token punctuation">.</span></span>RemoveHdata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用此方法</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h1><a id="_1291"></a>总结</h1>
<p>以上就是今天要讲的内容，本文仅仅简单介绍了基于FlexManager的Visual Studio应用开发，而FlexManager提供了大量能使我们自己使用云数据创建客户端应用的方式方法，同学们可以多深入了解一下。下一篇将具体讲述在FlexManager的基础上进行数据云间中转的实际操作细节，欢迎同学们进一步的来学习。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>