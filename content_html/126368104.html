<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p id="main-toc"><strong>目录</strong></p>
<p id="%E4%B8%80%E3%80%81%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF">一、全局事件总线</a></p>
<p id="%E4%BD%9C%E7%94%A8-toc" style="margin-left:40px;"><a href="#%E4%BD%9C%E7%94%A8">作用</a></p>
<p id="%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#%E5%AE%89%E8%A3%85">安装</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B-toc" style="margin-left:40px;"><a href="#%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B">组件使用案例</a></p>
<p id="%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90-toc" style="margin-left:80px;"><a href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">案例分析</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%B8%80%EF%BC%88%E5%B0%8F%E6%98%8E%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%BB%84%E4%BB%B6%E4%B8%80%EF%BC%88%E5%B0%8F%E6%98%8E%EF%BC%89">组件一（小明）</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%BA%8C%EF%BC%88%E5%B0%8F%E7%BA%A2%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%BB%84%E4%BB%B6%E4%BA%8C%EF%BC%88%E5%B0%8F%E7%BA%A2%EF%BC%89">组件二（小红）</a></p>
<p id="%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA-toc" style="margin-left:80px;"><a href="#%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA">效果展示</a></p>
<p id="%E4%BA%8C%E3%80%81%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83%C2%A0-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83%C2%A0">二、订阅与发布 </a></p>
<p id="%E5%AE%89%E8%A3%85-toc" style="margin-left:40px;"><a href="#%E5%AE%89%E8%A3%85">安装</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B-toc" style="margin-left:40px;"><a href="#%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B">组件使用案例</a></p>
<p id="%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90-toc" style="margin-left:80px;"><a href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">案例分析</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%B8%80%EF%BC%88%E5%B0%8F%E6%98%8E%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%BB%84%E4%BB%B6%E4%B8%80%EF%BC%88%E5%B0%8F%E6%98%8E%EF%BC%89">组件一（小明）</a></p>
<p id="%E7%BB%84%E4%BB%B6%E4%BA%8C%EF%BC%88%E5%B0%8F%E7%BA%A2%EF%BC%89-toc" style="margin-left:80px;"><a href="#%E7%BB%84%E4%BB%B6%E4%BA%8C%EF%BC%88%E5%B0%8F%E7%BA%A2%EF%BC%89">组件二（小红）</a></p>
<p id="%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA-toc" style="margin-left:80px;"><a href="#%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA">效果展示</a></p>
<hr id="hr-toc"/>
<p></p>
<h1 id="%E4%B8%80%E3%80%81%E5%85%A8%E5%B1%80%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF">一、全局事件总线</h1>
<h2 id="%E4%BD%9C%E7%94%A8" style="margin-left:.0001pt;text-align:justify;"><strong><strong>作用</strong></strong></h2>
<p style="margin-left:.0001pt;text-align:justify;">一种组件间通信的方式 适用于任意组件间通信。</p>
<h2 id="%E5%AE%89%E8%A3%85" style="margin-left:.0001pt;text-align:justify;"><strong><strong>安装</strong></strong></h2>
<p style="margin-left:.0001pt;text-align:justify;">安装全局事件总线:在入口文件main.js中，给VM添加$bus，任意组件都可以在原型中调用。</p>
<pre><code class="language-javascript">new Vue({
  render: h =&gt; h(App),

  beforeCreate(){
  	  Vue.prototype.$bus  = this
  }

}).$mount('#app')</code></pre>
<h2 id="%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B" style="margin-left:.0001pt;text-align:justify;"><strong><strong>组件使用案例</strong></strong></h2>
<h3 id="%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90"><strong><strong>案例分析</strong></strong></h3>
<p>创建两个子组件，如下组件，<strong>其中注释内容是演示订阅与发布无视即可</strong></p>
<p>下面代码所演示的是，小明组件给小红组件姓名“小明”，小红组件给小明组件“年龄”，主要通过<span style="color:#fe2c24;">自定义事件</span>，其中小明组件自定义“getName”,需要传递给小红组件，小红组件就需要“getName”来接收，也可以销毁传递</p>
<p>发送代码如下</p>
<pre><code class="language-javascript">this.$bus.$emit('getName',this.name)//this.name是所要传递的值，</code></pre>
<p>接收代码如下</p>
<pre><code class="language-javascript">this.$bus.$on('getName',(name)=&gt;{
            console.log( '小红得到的名字',name);
          })</code></pre>
<p>销毁代码如下</p>
<p>需要一个点击事件来触发</p>
<pre><code class="language-javascript">this.$bus.$off('getName')</code></pre>
<h3 id="%E7%BB%84%E4%BB%B6%E4%B8%80%EF%BC%88%E5%B0%8F%E6%98%8E%EF%BC%89">组件一（小明）</h3>
<pre><code class="language-javascript">&lt;template&gt;
	&lt;div&gt;
		姓名：{<!-- -->{name}}年龄：{<!-- -->{age}}&lt;button @click="sendMsg"&gt;给小红组件传姓名&lt;/button&gt; &lt;button @click="del"&gt;销毁传递&lt;/button&gt;

	&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
	// import pubsub from 'pubsub-js'
	export default {
	  name: 'XiaoMing',
	  data(){
		return{
			name:'小明',
			age:20
		}
	  },
	  methods:{
		  sendMsg(){
			//   pubsub.publish('usname',this.name)

			  this.$bus.$emit('getName',this.name)
		  },
		  del(){
			this.$bus.$off('getName')
			console.log('已销毁');
		  }
	  },
	mounted(){
		// pubsub.subscribe('age',(e,page)=&gt;{
		// 	console.log('小明得到小红',e,page);
		// })
		this.$bus.$on('getAge',(age)=&gt;{
			console.log('小明得到的年龄',age);
		})
	}
	}
&lt;/script&gt;

&lt;style&gt;
&lt;/style&gt;</code></pre>
<h3 id="%E7%BB%84%E4%BB%B6%E4%BA%8C%EF%BC%88%E5%B0%8F%E7%BA%A2%EF%BC%89">组件二（小红）</h3>
<pre><code class="language-javascript">&lt;template&gt;
	&lt;div&gt;
		姓名：{<!-- -->{name}}年龄：{<!-- -->{age}} &lt;button @click="sendAge"&gt;给小明组件传年龄&lt;/button&gt;&lt;button &gt;取消订阅&lt;/button&gt;
	&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
	// import pubsub from 'pubsub-js'
	export default {
	  name:'XiaoHong',
	  data(){
		return{
			name:'小红',
			age:18
		}
	  },
	  methods:{
		sendAge(){
			// pubsub.publish('age',this.age)

			this.$bus.$emit('getAge',this.age)
		},
		// noRead(){
		// 	pubsub.unsubscribe(this.del)
		// }
	  },
	  mounted(){
		//   this.del=pubsub.subscribe('usname',(q,msg)=&gt;{
		// 	  console.log('小红得到小明',q,msg)
		//   }),


		  this.$bus.$on('getName',(name)=&gt;{
			console.log( '小红得到的名字',name);
		  })
	  },	  
	}
&lt;/script&gt;
&lt;style&gt;
&lt;/style&gt;</code></pre>
<h3 id="%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA">效果展示</h3>
<p style="text-align:center;"><img alt="" src="https://img-blog.csdnimg.cn/047af9f6d5844c81bebc53105e993a57.gif"/></p>
<h1 id="%E4%BA%8C%E3%80%81%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83%C2%A0">二、订阅与发布 </h1>
<h2 style="margin-left:.0001pt;text-align:justify;"><strong><strong>安装</strong></strong></h2>
<p style="margin-left:.0001pt;text-align:justify;">一种组件间通信的方式，适用于任意组件间通信，如今有很多消息订阅与发布的包，在这里只介绍一种，pubsub-js。</p>
<p style="margin-left:.0001pt;text-align:justify;">打开终端输入命令：<strong>npm i pubsub-js</strong></p>
<h2 style="margin-left:.0001pt;text-align:justify;">组件使用案例</h2>
<h3>案例分析</h3>
<p>通过订阅与发布的方式，小明组件给小红组件姓名，小红组件给小明组件年龄</p>
<p style="margin-left:.0001pt;text-align:justify;">第一步我们需要引入:<span style="color:#fe2c24;"><strong> import pubsub from 'pubsub-js'</strong></span></p>
<p style="margin-left:.0001pt;text-align:justify;">第二步通过在小明组件发布</p>
<pre><code class="language-javascript">pubsub.publish('usname',this.name) //usname:发布消息的名称，第二个参数：为发布内容</code></pre>
<p>第三步在小红组件订阅</p>
<pre><code class="language-javascript"> this.del=pubsub.subscribe('usname',(q,msg)=&gt;{
			  console.log('小红得到小明',q,msg)
		  })</code></pre>
<p>第四步想要取消订阅，自定义事件，绑定销毁，通过第三步的this.del</p>
<pre><code class="language-javascript">pubsub.unsubscribe(this.del)</code></pre>
<h3>组件一（小明）</h3>
<pre><code class="language-javascript">&lt;template&gt;
	&lt;div&gt;
		姓名：{<!-- -->{name}}年龄：{<!-- -->{age}}&lt;button @click="sendMsg"&gt;给小红组件传姓名&lt;/button&gt; &lt;button &gt;销毁传递&lt;/button&gt;

	&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
	import pubsub from 'pubsub-js'
	export default {
	  name: 'XiaoMing',
	  data(){
		return{
			name:'小明',
			age:20
		}
	  },

	  methods:{
		  sendMsg(){
			  pubsub.publish('usname',this.name)

			//   this.$bus.$emit('getName',this.name)
		  },
		//   del(){
		// 	this.$bus.$off('getName')
		// 	console.log('已销毁');
		//   }
	  },
	mounted(){
		pubsub.subscribe('age',(e,page)=&gt;{
			console.log('小明得到小红',e,page);
		})

		// this.$bus.$on('getAge',(age)=&gt;{
		// 	console.log('小明得到的年龄',age);
		// })
	}
	}
&lt;/script&gt;

&lt;style&gt;
&lt;/style&gt;</code></pre>
<h3>组件二（小红）</h3>
<pre><code class="language-javascript">&lt;template&gt;
	&lt;div&gt;
		姓名：{<!-- -->{name}}年龄：{<!-- -->{age}} &lt;button @click="sendAge"&gt;给小明组件传年龄&lt;/button&gt;&lt;button @click="noRead"&gt;取消订阅&lt;/button&gt;
	&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
	import pubsub from 'pubsub-js'
	export default {
	  name:'XiaoHong',
	  data(){
		return{
			name:'小红',
			age:18
		}
	  },
	  methods:{
		sendAge(){
			pubsub.publish('age',this.age)

			// this.$bus.$emit('getAge',this.age)
		},
		noRead(){
			pubsub.unsubscribe(this.del)
		}
	  },
	  mounted(){
		  this.del=pubsub.subscribe('usname',(q,msg)=&gt;{
			  console.log('小红得到小明',q,msg)
		  })


		//   this.$bus.$on('getName',(name)=&gt;{
		// 	console.log( '小红得到的名字',name);
		//   })
	  },
	
	  
	}
&lt;/script&gt;

&lt;style&gt;
&lt;/style&gt;</code></pre>
<h3>效果展示</h3>
<p><img alt="" height="556" src="https://img-blog.csdnimg.cn/b3fa0fa603f549cd9eb5b7a8f22b2d36.gif" width="882"/></p>
<p></p>
</div>
</div>