<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3> </h3>
<ul><li><ul><li><a href="#_1">插件下载</a></li><li><a href="#_6">基本操作</a></li><li><ul><li><a href="#_7">导入</a></li><li><a href="#_11">使用公网网址</a></li><li><a href="#html_26">使用本地html网页</a></li><li><a href="#unityhtml_37">unity和html的交互</a></li><li><ul><li><a href="#htmlunity_39">html调用unity方法</a></li><li><a href="#unityjs_174">unity向js传参</a></li></ul>
</li><li><a href="#vue_177">使用vue开发</a></li><li><a href="#_182">注意事项</a></li><li><a href="#_190">写在最后</a></li></ul>
</li></ul>
</li></ul>
</div>
<p></p>
<h2><a id="_1"></a>插件下载</h2>
<p>该插件在unity商店里面有，售价<mark>75$</mark>，着实有点贵，我在淘宝上面买了一份，一块钱，刚刚好，各位需要可以去淘宝直接搜索，一块钱也不是啥事，如果想白嫖，这里也给出我的百度网盘分享，是最新版3.1.0，需要的朋友自取即可。<br/> 链接：<a href="https://pan.baidu.com/s/1jHORiHNtEBYOIctW64RifA">Embedded Browser3.1.0</a><br/> 提取码：i2mb</p>
<h2><a id="_6"></a>基本操作</h2>
<h3><a id="_7"></a>导入</h3>
<p>下载后会得到一个后缀为.unitypackage的文件，这个就是unity的包。现在我们只需要点开unity，然后右键Assets,选择import package即可打开文件，在文件中选择这个包就可以导入了。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604145659940.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 等待稍后加载文件，点击import即可成功导入。</p>
<h3><a id="_11"></a>使用公网网址</h3>
<p>这个时候我们就可以开始初步使用了，这里以导入百度搜索为基础，介绍使用流程。<br/> 在新建的场景中的canvas里面建立一个raw image控件。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2021060415003381.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 在该控件中点击Add Component添加插件，输入browser,可以看到，系统已经自动找到了我们导入的插件。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150155652.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 选择GUI Beowser UI后，系统会自动添加两个compoent<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150302956.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/></p>
<p>其中Browser里面的URl就是我们放网页地址的地方，填入百度搜索的地址。运行unity，可以看到百度已经加载出来了，输入搜索也是可以的。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150525757.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/></p>
<p>这里如果不能点击的同学，可以再添加一个compoents<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150615454.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> GUI Browser是即将被淘汰的组件，建议使用pointer UI GUI，但是实际上这个插件再2.0版本就这么说，到3.1了依旧没有改。。。</p>
<h3><a id="html_26"></a>使用本地html网页</h3>
<p>如果是要使用网页替代unity UI 那么插入本地网页必不可少，请看详细操作方法：<br/> 在unity跟目录下建立BrowserAssets文件夹。<mark>注意，名字必须完全一致，如果不一致会导致插件找不到文件</mark></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150855897.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 将需要使用的html放入其中即可<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604150952570.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 回到unity中，将刚才在输入的百度url改为，localGame://mychart.html<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604151047409.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 点击运行后可以发现我们自定义的html文件就显示了出来。</p>
<h3><a id="unityhtml_37"></a>unity和html的交互</h3>
<p>在这个插件里面提供了html和unity互相调用传参的方法。基本操作如下：</p>
<h4><a id="htmlunity_39"></a>html调用unity方法</h4>
<p>html调用unity的方法，只需要js调用一个方法，然后在c#里面监听同名函数即可。具体代码如下<br/> html</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>ECharts<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引入 echarts<span class="token punctuation">.</span>js <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>style type<span class="token operator">=</span><span class="token string">"text/css"</span><span class="token operator">&gt;</span>
			<span class="token operator">*</span> <span class="token punctuation">{<!-- --></span>
				padding<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
				margin<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
				box<span class="token operator">-</span>sizing<span class="token punctuation">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token punctuation">.</span>title <span class="token punctuation">{<!-- --></span>
				margin<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
				text<span class="token operator">-</span>align<span class="token punctuation">:</span> center<span class="token punctuation">;</span>
				color<span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>
				background<span class="token operator">-</span>color<span class="token punctuation">:</span> #<span class="token number">162256</span><span class="token punctuation">;</span>
				padding<span class="token punctuation">:</span> <span class="token number">10</span>px <span class="token number">0</span><span class="token punctuation">;</span>
				height<span class="token punctuation">:</span> <span class="token number">60</span>px<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token punctuation">.</span>main <span class="token punctuation">{<!-- --></span>
				display<span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
				<span class="token comment">/* height: 600px; */</span>
				height<span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token number">100</span>vh <span class="token operator">-</span> <span class="token number">60</span>px<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token punctuation">.</span>main<span class="token operator">&gt;</span>div <span class="token punctuation">{<!-- --></span>
				<span class="token comment">/* background-color: ; */</span>
				<span class="token comment">/* opacity: .3; */</span>
			<span class="token punctuation">}</span>

			<span class="token punctuation">.</span>left<span class="token punctuation">,</span>
			<span class="token punctuation">.</span>right <span class="token punctuation">{<!-- --></span>
				width<span class="token punctuation">:</span> <span class="token number">15</span><span class="token operator">%</span><span class="token punctuation">;</span>
				background<span class="token operator">-</span>color<span class="token punctuation">:</span> #<span class="token number">00</span>f798<span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token punctuation">.</span>middle <span class="token punctuation">{<!-- --></span>
				width<span class="token punctuation">:</span> <span class="token number">60</span><span class="token operator">%</span><span class="token punctuation">;</span>
				margin<span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>
				<span class="token comment">/* background-color: antiquewhite; */</span>
			<span class="token punctuation">}</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 为ECharts准备一个具备大小（宽高）的Dom <span class="token operator">--</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"index"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>h1 <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"title"</span><span class="token operator">&gt;</span>数字孪生世界<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"main"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"left"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">"button"</span> onclick<span class="token operator">=</span><span class="token string">"test()"</span><span class="token operator">&gt;</span><span class="token number">15</span>栋教学楼<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"middle"</span><span class="token operator">&gt;</span>
					<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"main"</span> style<span class="token operator">=</span><span class="token string">"width: 400px;height:300px;"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"right"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"echarts.min.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">&gt;</span>
			<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">21</span>
				<span class="token comment">// test1("15");</span>
				<span class="token function">testAgain</span><span class="token punctuation">(</span><span class="token string">"传过来的参数"</span><span class="token punctuation">)</span>
				<span class="token keyword">return</span> a
			<span class="token punctuation">}</span>
			<span class="token keyword">function</span> <span class="token function">testAgain</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				
			<span class="token punctuation">}</span>
			<span class="token keyword">function</span> <span class="token function">checkUi</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"js接受到参数"</span><span class="token punctuation">,</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>

</code></pre>
<p>在我们的raw Image组件上挂载一个脚本用来监听js发过来的函数操作。代码如下：</p>
<pre><code class="prism language-javascript">using System<span class="token punctuation">.</span>Collections<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
using UnityEngine<span class="token punctuation">;</span>
using ZenFulcrum<span class="token punctuation">.</span>EmbeddedBrowser<span class="token punctuation">;</span>

namespace Mannager
<span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">test</span> <span class="token punctuation">:</span> MonoBehaviour
    <span class="token punctuation">{<!-- --></span>
        Browser browser<span class="token punctuation">;</span>
        <span class="token keyword">public</span> UiMannager uiMannager<span class="token punctuation">;</span>

        <span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">InitData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//uiMannager = UiMannager.GetInstance();</span>

        <span class="token punctuation">}</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">Awake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//获取插件Browser组件（Unity方使用插件基础一步）</span>
            browser <span class="token operator">=</span> gameObject<span class="token punctuation">.</span>GetComponent<span class="token operator">&lt;</span>Browser<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Update is called once per frame</span>
        <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Input<span class="token punctuation">.</span><span class="token function">GetKey</span><span class="token punctuation">(</span>KeyCode<span class="token punctuation">.</span><span class="token constant">H</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                browser<span class="token punctuation">.</span><span class="token function">CallFunction</span><span class="token punctuation">(</span><span class="token string">"checkUi"</span><span class="token punctuation">,</span> <span class="token string">"lampPanel"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//uiMannager.CallFunction("lampPanel");</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">InitData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>

            browser<span class="token punctuation">.</span><span class="token function">RegisterFunction</span><span class="token punctuation">(</span><span class="token string">"testAgain"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>JSONNode jk<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{<!-- --></span>
                Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>jk<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
<p>获取到browser组件后，调用其api RegisterFunction监听 testAgain函数，注册回调，jk[0].value对应的是第一个参数，点击后unity打印出了该参数，成功完成html调用unity.<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604163000192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/></p>
<h4><a id="unityjs_174"></a>unity向js传参</h4>
<p>同上代码，在update生命周期里面，监听的h按键的点击，调用CallFunction方法，向html同名方法传参，按下键盘h键，可以看到js打印输出。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604163348924.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/></p>
<h3><a id="vue_177"></a>使用vue开发</h3>
<p>使用vue开发的网页打包后和正常html没有太大的区别，唯一需要注意的是，交互的时候，js需要暴露在全局的函数才会被找到（我理解的是这样，没有验证过），所以需要使用vue的话，就要在mounted生命周期里面把函数设置为window的属性，比如这样。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/20210604164003120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NjOTA5MDkw,size_16,color_FFFFFF,t_70"/><br/> 其他的流程和上面并没有什么区别，更细节的东西我没有用到就没有研究过，大家可以自行学习。</p>
<h3><a id="_182"></a>注意事项</h3>
<ol><li>这个插件的文档不好找，百度不出来，可以去unity商店找到这个插件，介绍里面有它的文档，需要翻墙（这个站点不太稳定，翻墙也不一定就能进去，多进几次吧）</li><li>如果有需要播放视频的操作，该插件使用的开源谷歌内核，而h264需要高额的专利费，作者负担不起，所以不支持，简单的来说就是不支持mp4格式的视频，能播放.webm的文件，需要的同学可以下个格式工厂转换一下</li><li>直接百度这个插件的教程，很多人写的都是很老的版本了，基本上用的都是2.0版本，2.0版本是不支持video标签的，只能用flash播放，我写这个就是最近几天到处找方案把我坑惨了，希望能帮到后来者</li><li>不知道为什么，使用vue开发的单文件，在进行了组件切换后返回来，页面高度就会缩小一半，我目前还没发现是为什么。</li><li>如果是使用2.0的同学打包后会发现网页加载不出来，需要进入根目录data文件下，把Plugins文件夹下的x86_64里面的所有文件移动到Plugins里面，这是2.0的bug，目前3.1已经修复，如有加载不出来的也可以看看这个文件夹（死马当活马医嘛）</li></ol>
<h3><a id="_190"></a>写在最后</h3>
<p>以上就是我最近几天的使用总结，我也是刚使用unity开发，还有很多的问题，本文因为最近查资料发现大家都写的不完整，遇到了许多坑，总结一下也帮助一下后来者。文章如果有什么技术上的问题和纰漏，欢迎指正。我也还有许多问题没有解决，比如上面说到了切换页面后页面高度缩小的问题，或者生产环境下打开调试的操作，有知道的同学也欢迎指教，感激不尽。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>