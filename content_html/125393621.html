<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/4391aef028794a228fe949bed021a6e3.gif#pic_center"/><br/> 近期的开发需求，需要开发一个3D饼图。不同于echarts的二维饼图，有完善的API，开发起来比较顺手。3D类的图资料较少，就连Echarts官网提供的相关API信息也是模模糊糊的，理解起来不容易。</p>
<p>以饼图为例子。一个完整的2D饼图是由一个或者多个扇形组成的；而一个完整的3D饼图是由一个或者多个扇形曲面组成。</p>
<p>Echarts曲面绘制通过series-surface. type ="surface"配置项来设置，详细参数说明，请参考官网。<br/> ｜——》<a href="https://echarts.apache.org/zh/option-gl.html#series-surface">任意门</a></p>
<p>其实光看官网的配置参数，会很难理解。因为没有足够的示例，无法进行调试测试，导致对于知识难掌握，容易产生厌烦情绪。（没错！说的就是俺）</p>
<p>最好的办法就是先去社区或者网络找找有没有相关案例，感谢这些乐于分享知识的开发者们。——》<a href="https://www.makeapie.cn/echarts">Echarts社区入口</a><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d8c75f3002ff41b8bcad5dc93ce72371.png"/><br/> 其实也有不少，但是并不能完全满足我的开发需求。只能通过现有的满足条件的案例，拿到代码后再跑一遍，理解里面的配置项的涵义，再自己慢慢调整开发。</p>
<p>下面对实现流程进行简单解析。</p>
<h4><a id="_15"></a>准备工作</h4>
<p>依赖除了必要的echarts依赖外，还需echarts-gl。<br/> ｜——》<a href="https://www.npmjs.com/package/echarts-gl">任意门</a></p>
<p>在这里要注意版本匹配，否则会报错：</p>
<blockquote>
<p><strong>echarts-gl 2.x版本的是和echarts 5.X的版本相匹配的。<br/> echarts-gl 1.x版本的是和echarts 4.X的版本相匹配的。</strong></p>
</blockquote>
<p>也就是说如果你echarts是4.x的，但是echarts-gl是2.x的，这是万万使不得的，会报错哦～</p>
<h4><a id="3D_26"></a>3D饼图实现</h4>
<p>如下图的3D饼图，是由4个扇形曲面实现。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/285baf065715449baedc43ad5073213a.png"/></p>
<h6><a id="_29"></a>生成扇形的曲面参数方程</h6>
<p>用于 series-surface.parametricEquation</p>
<pre><code class="prism language-javascript"> <span class="token keyword">function</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span><span class="token parameter">startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 计算</span>
            <span class="token keyword">let</span> midRatio <span class="token operator">=</span> <span class="token punctuation">(</span>startRatio <span class="token operator">+</span> endRatio<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> startRadian <span class="token operator">=</span> startRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> endRadian <span class="token operator">=</span> endRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> midRadian <span class="token operator">=</span> midRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token comment">// 如果只有一个扇形，则不实现选中效果。</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>startRatio <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> endRatio <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                isSelected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 计算选中效果分别在 x 轴、y 轴方向上的位移（位移均为 0）</span>
            <span class="token keyword">let</span> offsetX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> offsetY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 计算选中效果在 z 轴方向上的位移（未选中，位移均为 0）</span>
            <span class="token keyword">let</span> offsetZ <span class="token operator">=</span> isSelected <span class="token operator">?</span> <span class="token number">0.15</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 计算高亮效果的放大比例（未高亮，则比例为 1）</span>
            <span class="token keyword">let</span> hoverRate <span class="token operator">=</span> isHovered <span class="token operator">?</span> <span class="token number">1.05</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 返回曲面参数方程</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">v</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">50</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">x</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>midRatio <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">||</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian
                                    <span class="token operator">:</span> u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">||</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u
                                    <span class="token operator">:</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> offsetX <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">y</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>midRatio <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">||</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian
                                    <span class="token operator">:</span> u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">||</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u
                                    <span class="token operator">:</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> offsetY <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> offsetZ <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<p>大部分小可爱肯定会在这一步感到疑惑，u、v、x、y、z这都是啥呀(((o(<em>ﾟ▽ﾟ</em>)o)))？赶紧去官网查查。<br/> 然而，<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/892a0eef0c074cfa8caa6c67ef38f43a.png"/><br/> ┻━┻︵╰(‵□′)╯︵┻━┻</p>
<p>没错，依然还是不懂呀！！！（希望官网能再完善一下，写得再详细一些。）</p>
<p>其实，u、v、x、y、z是与球坐标系相关的参数。</p>
<blockquote>
<p>球坐标系是三维坐标系的一种，用以确定三维空间中点、线、面以及体的位置，它以坐标原点为参考点，由方位角、仰角和距离构成。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e348c0f0572a4113abfadd5f030fb823.png"/><br/> 在数学里，球坐标系（英语：Spherical coordinate system）是一种利用球坐标表示一个点 p 在三维空间的位置的三维正交坐标系。图1显示了球坐标的几何意义：原点到 P 点的距离 r ，原点到点 P 的连线与正 z-轴之间的天顶角以及原点到点 P 的连线，在 xy-平面的投影线，与正 x-轴之间的方位角。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2cc618db253c447d98e2cadf19526b53.png"/><br/> 例子：<br/> 假设P（x，y，z）为空间内一点，则点P也可用这样三个有次序的数(r，θ，φ)来确定，其中r为原点O与点P间的距离；θ为有向线段OP与z轴正向的夹角；φ为从正z轴来看自x轴按逆时针方向转到OM所转过的角，这里M为点P在xOy面上的投影；。这样的三个数r，θ，φ叫做点P的球面坐标，显然，这里r，θ，φ的变化范围为r∈[0,+∞)，θ∈[0, π]， φ∈[0,2π] ，如图所示。<br/> 当r,θ或φ分别为常数时,可以表示如下特殊曲面:r = 常数，即以原点为心的球面；θ= 常数，即以原点为顶点、z轴为轴的圆锥面；φ= 常数，即过z轴的半平面。<br/> 转化：<br/> 1).球坐标系(r,θ,φ)与直角坐标系(x,y,z)的转换关系:<br/> x=rsinθcosφ.<br/> y=rsinθsinφ.<br/> z=rcosθ.<br/> 2).反之，直角坐标系(x,y,z)与球坐标系(r,θ,φ)的转换关系为:<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2d9e9b40b8cf4e0dbad450fd47261898.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/dfeb28906aee4adfb04d12ec242d1bba.png"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/19a728e0053e47c3a27ad0679657cfc0.png"/></p>
</blockquote>
<p>在这里，<em><strong>u就代表球坐标系中的φ，v代表球坐标系中的θ。</strong></em></p>
<p>有了这层知识护航，再去看上面的曲面方程，理解立刻+1了！↖(⁎⁍̴̛ᴗ⁍̴̛⁎)↗</p>
<p>再搭配这个3D球示例看，会更上一层楼哦～<br/> ｜——》<a href="https://echarts.apache.org/examples/zh/editor.html?c=sphere-parametric-surface&amp;gl=1">任意门</a></p>
<h6><a id="3D_198"></a>调用曲面方程生成3D图</h6>
<p>为每一个配置项生成曲面3D扇形。</p>
<pre><code class="prism language-javascript">  <span class="token comment">// 生成模拟 3D 饼图的配置项</span>
        <span class="token keyword">function</span> <span class="token function">getPie3D</span><span class="token punctuation">(</span><span class="token parameter">pieData</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">let</span> series <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> sumValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> startValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> endValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> legendData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// 为每一个饼图数据，生成一个 series-surface 配置</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pieData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                sumValue <span class="token operator">+=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token keyword">let</span> seriesItem <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span>
                        <span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">"undefined"</span>
                            <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">series</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
                            <span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"surface"</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">parametric</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">wireframe</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">pieData</span><span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">pieStatus</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">hovered</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">let</span> itemStyle <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        itemStyle<span class="token punctuation">.</span>color <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    seriesItem<span class="token punctuation">.</span>itemStyle <span class="token operator">=</span> itemStyle<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>seriesItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 使用上一次遍历时，计算出的数据和 sumValue，调用 getParametricEquation 函数，</span>
            <span class="token comment">// 向每个 series-surface 传入不同的参数方程 series-surface.parametricEquation，也就是实现每一个扇形。</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> series<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                endValue <span class="token operator">=</span> startValue <span class="token operator">+</span> series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio <span class="token operator">=</span> startValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio <span class="token operator">=</span> endValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>
                    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">,</span>
                    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">,</span>
                    <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token boolean">false</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
                startValue <span class="token operator">=</span> endValue<span class="token punctuation">;</span>
                legendData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 补充一个透明的圆环，用于支撑高亮功能的近似实现。</span>
            series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"mouseoutSeries"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"surface"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">parametric</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">wireframe</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">parametricEquation</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">v</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">x</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">y</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 准备待返回的配置项，把准备好的 legendData、series 传入。</span>
            <span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">data</span><span class="token operator">:</span> legendData<span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">xAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">yAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">zAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">grid3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">boxHeight</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 厚度</span>
                    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">boxWidth</span><span class="token operator">:</span> <span class="token number">144</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">viewControl</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">//3d效果可以放大、旋转等，请自己去查看官方配置</span>
                        <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token comment">// 角度</span>
                        <span class="token literal-property property">beta</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 饼块开始位置角度</span>
                        <span class="token literal-property property">rotateSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">zoomSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">panSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">autoRotate</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment">// ！！！不要配置postEffect，会影响性能。</span>
                    <span class="token comment">//后处理特效可以为画面添加高光、景深、环境光遮蔽（SSAO）、调色等效果。可以让整个画面更富有质感。</span>
                      <span class="token comment">// postEffect: {<!-- --></span>
                    <span class="token comment">//     //配置这项会出现锯齿，请自己去查看官方配置有办法解决</span>
                    <span class="token comment">//     enable: true,</span>
                    <span class="token comment">//     bloom: {<!-- --></span>
                    <span class="token comment">//         enable: true,</span>
                    <span class="token comment">//         bloomIntensity: 0.1,</span>
                    <span class="token comment">//     },</span>
                    <span class="token comment">//     SSAO: {<!-- --></span>
                    <span class="token comment">//         enable: true,</span>
                    <span class="token comment">//         quality: "medium",</span>
                    <span class="token comment">//         radius: 2,</span>
                    <span class="token comment">//     },</span>
                    <span class="token comment">// },</span>
                    <span class="token literal-property property">light</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"rgb(85, 84, 84)"</span><span class="token punctuation">,</span> <span class="token comment">// 主光源的颜色。</span>
                            <span class="token literal-property property">shadow</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 主光源是否投射阴影</span>
                            <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// 主光源绕 x 轴，即上下旋转的角度</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">series</span><span class="token operator">:</span> series<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> option<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<h4><a id="_350"></a>指示线实现</h4>
<h6><a id="_351"></a>方案：</h6>
<p>1.用series-line3D，生成指示线。<br/> 我试了一下，这种不好看，生硬，不灵活。而且很容易超出边界。<br/> <img alt="示范例子" src="https://img-blog.csdnimg.cn/5c1dccd623ab4119811773996a59e2c6.png"/><br/> 2.在原来的曲面上，再生成一层2D饼图，调整2D饼图的位置和大小，再使2D饼图透明，保留其指示线和标签。<br/> (这里比较难的是，调整2D图的位置和大小，因为2D图和标签无法完美发生角度偏转，若3D图旋转角度过大，则2D标签无法调整到和3D图完美匹配。)</p>
<p><strong>透明前：</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/43d0ced43dc34a14af0d8d2e422ea86e.png"/><br/> <strong>透明后：</strong><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/66cd514bd0d54ee5b398c075f6562212.png"/><br/> <strong>关键代码：</strong></p>
<pre><code class="prism language-javascript">        option<span class="token punctuation">.</span>series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'酒水销售占比'</span><span class="token punctuation">,</span> <span class="token comment">//自己根据场景修改</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pie'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">hoverAnimation</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 悬停不放大</span>
            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">"bottom"</span><span class="token punctuation">,</span>
                <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{percentSty|</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>params<span class="token punctuation">.</span>percent<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%}\n{nameSty|</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">rich</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">nameSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">percentSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#FFFFFF'</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">countSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#B9D3ED'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'rgb(90,156,241,0.3)'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">borderRadius</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">labelLine</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">showAbove</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// 视觉引导线第一段的长度</span>
                <span class="token literal-property property">length2</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token comment">// 视觉引导项第二段的长度</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#686868"</span><span class="token punctuation">,</span> <span class="token comment">// 改变标示线的颜色</span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span> <span class="token comment">// 线的类型</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">startAngle</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token comment">// 起始角度，支持范围[0, 360]。</span>
            <span class="token literal-property property">clockwise</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 饼图的扇区是否是顺时针排布。上述这两项配置主要是为了对齐3d的样式</span>
            <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'40%'</span><span class="token punctuation">,</span> <span class="token string">'52%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'50%'</span><span class="token punctuation">,</span> <span class="token string">'53%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> paramsList<span class="token punctuation">,</span>
            <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span>  <span class="token comment">//这里必须是0，不然2d的图会覆盖在表面</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h6><a id="3D_420"></a>到此，3D饼图的难点之处已介绍完毕，有需要的小可爱可以自己着手试试。看看指示线部分还有没有其他更好的方法实现，若找到，务必@我，让我学习一下☆〜（ゝ。∂）</h6>
<h4><a id="_422"></a>完整代码贴上</h4>
<pre><code class="prism language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Ehcarts Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://echarts.baidu.com/resource/echarts-gl-latest/dist/echarts-gl.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>chartsContent<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>560px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span>150px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">var</span> myChart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'chartsContent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 生成扇形的曲面参数方程，用于 series-surface.parametricEquation</span>
        <span class="token keyword">function</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span><span class="token parameter">startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 计算</span>
            <span class="token keyword">let</span> midRatio <span class="token operator">=</span> <span class="token punctuation">(</span>startRatio <span class="token operator">+</span> endRatio<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>

            <span class="token keyword">let</span> startRadian <span class="token operator">=</span> startRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> endRadian <span class="token operator">=</span> endRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> midRadian <span class="token operator">=</span> midRatio <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

            <span class="token comment">// 如果只有一个扇形，则不实现选中效果。</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>startRatio <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> endRatio <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                isSelected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 计算选中效果分别在 x 轴、y 轴方向上的位移（位移均为 0）</span>
            <span class="token keyword">let</span> offsetX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> offsetY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 计算选中效果在 z 轴方向上的位移（未选中，位移均为 0）</span>
            <span class="token keyword">let</span> offsetZ <span class="token operator">=</span> isSelected <span class="token operator">?</span> <span class="token number">0.15</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment">// 计算高亮效果的放大比例（未高亮，则比例为 1）</span>
            <span class="token keyword">let</span> hoverRate <span class="token operator">=</span> isHovered <span class="token operator">?</span> <span class="token number">1.05</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>

            <span class="token keyword">let</span> tmp <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">// 返回曲面参数方程</span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token literal-property property">v</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">50</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token function-variable function">x</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>midRatio <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">||</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian
                                    <span class="token operator">:</span> u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">||</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u
                                    <span class="token operator">:</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetX <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> offsetX <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token function-variable function">y</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>midRatio <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">||</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian
                                    <span class="token operator">:</span> u <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&lt;</span> startRadian <span class="token operator">&amp;&amp;</span> u <span class="token operator">&gt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span> u <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>startRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">&gt;</span> endRadian <span class="token operator">||</span> u <span class="token operator">&lt;</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                            tmp <span class="token operator">=</span>
                                midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u <span class="token operator">&lt;</span> <span class="token number">0</span>
                                    <span class="token operator">?</span> midRadian <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u
                                    <span class="token operator">:</span> midRadian <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> u<span class="token punctuation">;</span>
                            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                                offsetY <span class="token operator">+</span>
                                <span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>endRadian<span class="token punctuation">)</span> <span class="token operator">*</span> tmp<span class="token punctuation">)</span> <span class="token operator">/</span>
                                    <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">-</span> midRadian <span class="token operator">+</span> startRadian<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                                hoverRate
                            <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> offsetY <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">*</span> hoverRate<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>

                <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> offsetZ <span class="token operator">+</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 生成模拟 3D 饼图的配置项</span>
        <span class="token keyword">function</span> <span class="token function">getPie3D</span><span class="token punctuation">(</span><span class="token parameter">pieData</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">let</span> series <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> sumValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> startValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> endValue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> legendData <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// 为每一个饼图数据，生成一个 series-surface 配置</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pieData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                sumValue <span class="token operator">+=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token keyword">let</span> seriesItem <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span>
                        <span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">"undefined"</span>
                            <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">series</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
                            <span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"surface"</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">parametric</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">wireframe</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">pieData</span><span class="token operator">:</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">pieStatus</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">hovered</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">let</span> itemStyle <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        itemStyle<span class="token punctuation">.</span>color <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">!=</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        itemStyle<span class="token punctuation">.</span>opacity <span class="token operator">=</span> pieData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>itemStyle<span class="token punctuation">.</span>opacity<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    seriesItem<span class="token punctuation">.</span>itemStyle <span class="token operator">=</span> itemStyle<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>seriesItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 使用上一次遍历时，计算出的数据和 sumValue，调用 getParametricEquation 函数，</span>
            <span class="token comment">// 向每个 series-surface 传入不同的参数方程 series-surface.parametricEquation，也就是实现每一个扇形。</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> series<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                endValue <span class="token operator">=</span> startValue <span class="token operator">+</span> series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio <span class="token operator">=</span> startValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio <span class="token operator">=</span> endValue <span class="token operator">/</span> sumValue<span class="token punctuation">;</span>
                series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>
                    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">,</span>
                    series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">,</span>
                    <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token boolean">false</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
                startValue <span class="token operator">=</span> endValue<span class="token punctuation">;</span>
                legendData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>series<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 补充一个透明的圆环，用于支撑高亮功能的近似实现。</span>
            series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"mouseoutSeries"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"surface"</span><span class="token punctuation">,</span>
                <span class="token literal-property property">parametric</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">wireframe</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">parametricEquation</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">v</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">max</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">step</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">20</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">x</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">y</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function-variable function">z</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">u<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0.1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 准备待返回的配置项，把准备好的 legendData、series 传入。</span>
            <span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">legend</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">data</span><span class="token operator">:</span> legendData<span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">xAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">yAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">zAxis3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">grid3D</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">boxHeight</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 厚度</span>
                    <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">boxWidth</span><span class="token operator">:</span> <span class="token number">144</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">viewControl</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token comment">//3d效果可以放大、旋转等，请自己去查看官方配置</span>
                        <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token comment">// 角度</span>
                        <span class="token literal-property property">beta</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 饼块开始位置角度</span>
                        <span class="token literal-property property">rotateSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">zoomSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">panSensitivity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">autoRotate</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">light</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                            <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"rgb(85, 84, 84)"</span><span class="token punctuation">,</span> <span class="token comment">// 主光源的颜色。</span>
                            <span class="token literal-property property">shadow</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 主光源是否投射阴影</span>
                            <span class="token literal-property property">alpha</span><span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment">// 主光源绕 x 轴，即上下旋转的角度</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">series</span><span class="token operator">:</span> series<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> option<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 监听鼠标事件，实现饼图选中效果（单选），近似实现高亮（放大）效果。</span>
        <span class="token keyword">let</span> selectedIndex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> hoveredIndex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

        <span class="token comment">// 监听点击事件，实现选中效果（单选）</span>
        myChart<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 从 option.series 中读取重新渲染扇形所需的参数，将是否选中取反。</span>
            <span class="token keyword">let</span> isSelected <span class="token operator">=</span> <span class="token operator">!</span>option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected<span class="token punctuation">;</span>
            <span class="token keyword">let</span> isHovered <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>hovered<span class="token punctuation">;</span>
            <span class="token keyword">let</span> startRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">;</span>
            <span class="token keyword">let</span> endRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">;</span>

            <span class="token comment">// 如果之前选中过其他扇形，将其取消选中（对 option 更新）</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>selectedIndex <span class="token operator">!==</span> <span class="token string">''</span> <span class="token operator">&amp;&amp;</span> selectedIndex <span class="token operator">!==</span> params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>selectedIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>selectedIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">,</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>selectedIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>selectedIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 对当前点击的扇形，执行选中/取消选中操作（对 option 更新）</span>
            option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered<span class="token punctuation">)</span><span class="token punctuation">;</span>
            option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected <span class="token operator">=</span> isSelected<span class="token punctuation">;</span>

            <span class="token comment">// 如果本次是选中操作，记录上次选中的扇形对应的系列号 seriesIndex</span>
            isSelected <span class="token operator">?</span> selectedIndex <span class="token operator">=</span> params<span class="token punctuation">.</span>seriesIndex <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'option-click: '</span><span class="token punctuation">,</span> option<span class="token punctuation">)</span>
            <span class="token comment">// 使用更新后的 option，渲染图表</span>
            myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 监听 mouseover，近似实现高亮（放大）效果</span>
        myChart<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

            <span class="token comment">// 准备重新渲染扇形所需的参数</span>
            <span class="token keyword">let</span> isSelected<span class="token punctuation">;</span>
            <span class="token keyword">let</span> isHovered<span class="token punctuation">;</span>
            <span class="token keyword">let</span> startRatio<span class="token punctuation">;</span>
            <span class="token keyword">let</span> endRatio<span class="token punctuation">;</span>

            <span class="token comment">// 如果触发 mouseover 的扇形当前已高亮，则不做操作</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hoveredIndex <span class="token operator">===</span> params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token comment">// 否则进行高亮及必要的取消高亮操作</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 如果当前有高亮的扇形，取消其高亮状态（对 option 更新）</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>hoveredIndex <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 从 option.series 中读取重新渲染扇形所需的参数，将是否高亮设置为 false。</span>
                    isSelected <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected<span class="token punctuation">;</span>
                    isHovered <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    startRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">;</span>
                    endRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">;</span>

                    <span class="token comment">// 对当前点击的扇形，执行取消高亮操作（对 option 更新）</span>
                    option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>hovered <span class="token operator">=</span> isHovered<span class="token punctuation">;</span>

                    <span class="token comment">// 将此前记录的上次选中的扇形对应的系列号 seriesIndex 清空</span>
                    hoveredIndex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// 如果触发 mouseover 的扇形不是透明圆环，将其高亮（对 option 更新）</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>seriesName <span class="token operator">!==</span> <span class="token string">'mouseoutSeries'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 从 option.series 中读取重新渲染扇形所需的参数，将是否高亮设置为 true。</span>
                    isSelected <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected<span class="token punctuation">;</span>
                    isHovered <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    startRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">;</span>
                    endRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">;</span>

                    <span class="token comment">// 对当前点击的扇形，执行高亮操作（对 option 更新）</span>
                    option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>hovered <span class="token operator">=</span> isHovered<span class="token punctuation">;</span>

                    <span class="token comment">// 记录上次高亮的扇形对应的系列号 seriesIndex</span>
                    hoveredIndex <span class="token operator">=</span> params<span class="token punctuation">.</span>seriesIndex<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 使用更新后的 option，渲染图表</span>
                myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 修正取消高亮失败的 bug</span>
        myChart<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'globalout'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>


            <span class="token keyword">if</span> <span class="token punctuation">(</span>hoveredIndex <span class="token operator">!==</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 从 option.series 中读取重新渲染扇形所需的参数，将是否高亮设置为 true。</span>
                isSelected <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>selected<span class="token punctuation">;</span>
                isHovered <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                startRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>startRatio<span class="token punctuation">;</span>
                endRatio <span class="token operator">=</span> option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieData<span class="token punctuation">.</span>endRatio<span class="token punctuation">;</span>

                <span class="token comment">// 对当前点击的扇形，执行取消高亮操作（对 option 更新）</span>
                option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>parametricEquation <span class="token operator">=</span> <span class="token function">getParametricEquation</span><span class="token punctuation">(</span>startRatio<span class="token punctuation">,</span> endRatio<span class="token punctuation">,</span> isSelected<span class="token punctuation">,</span> isHovered<span class="token punctuation">)</span><span class="token punctuation">;</span>
                option<span class="token punctuation">.</span>series<span class="token punctuation">[</span>hoveredIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>pieStatus<span class="token punctuation">.</span>hovered <span class="token operator">=</span> isHovered<span class="token punctuation">;</span>

                <span class="token comment">// 将此前记录的上次选中的扇形对应的系列号 seriesIndex 清空</span>
                hoveredIndex <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 使用更新后的 option，渲染图表</span>
            myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> colorList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'#D98053'</span><span class="token punctuation">,</span> <span class="token string">'#E2B062'</span><span class="token punctuation">,</span> <span class="token string">'#5A9CF1'</span><span class="token punctuation">,</span> <span class="token string">'#6ED3D3'</span><span class="token punctuation">]</span>
        <span class="token keyword">const</span> dataSource <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"啤酒"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"高粱酒"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"桃花酿"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"白酒"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span>
        <span class="token keyword">const</span> paramsList <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
                <span class="token operator">...</span>item<span class="token punctuation">,</span>
                <span class="token literal-property property">shading</span><span class="token operator">:</span> <span class="token string">'realistic'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> colorList<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 传入数据生成 option</span>
        <span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token function">getPie3D</span><span class="token punctuation">(</span>paramsList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 是否需要label指引线，如果要就添加一个透明的2d饼状图并调整角度使得labelLine和3d的饼状图对齐，并再次setOption</span>
        option<span class="token punctuation">.</span>series<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'酒水销售占比'</span><span class="token punctuation">,</span> <span class="token comment">//自己根据场景修改</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pie'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">hoverAnimation</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 悬停不放大</span>
            <span class="token literal-property property">label</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">"bottom"</span><span class="token punctuation">,</span>
                <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{percentSty|</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>params<span class="token punctuation">.</span>percent<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%}\n{nameSty|</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>params<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">rich</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">nameSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">percentSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#FFFFFF'</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">countSty</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">lineHeight</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fontFamily</span><span class="token operator">:</span> <span class="token string">"PingFangSC-Regular"</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">fintWeight</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#B9D3ED'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'rgb(90,156,241,0.3)'</span><span class="token punctuation">,</span>
                        <span class="token literal-property property">borderRadius</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">labelLine</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">showAbove</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                <span class="token literal-property property">length</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// 视觉引导线第一段的长度</span>
                <span class="token literal-property property">length2</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token comment">// 视觉引导项第二段的长度</span>
                <span class="token literal-property property">lineStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#686868"</span><span class="token punctuation">,</span> <span class="token comment">// 改变标示线的颜色</span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span> <span class="token comment">// 线的类型</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">startAngle</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token comment">// 起始角度，支持范围[0, 360]。</span>
            <span class="token literal-property property">clockwise</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 饼图的扇区是否是顺时针排布。上述这两项配置主要是为了对齐3d的样式</span>
            <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'40%'</span><span class="token punctuation">,</span> <span class="token string">'52%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'50%'</span><span class="token punctuation">,</span> <span class="token string">'53%'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token literal-property property">data</span><span class="token operator">:</span> paramsList<span class="token punctuation">,</span>
            <span class="token literal-property property">itemStyle</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span>  <span class="token comment">//这里必须是0，不然2d的图会覆盖在表面</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.container</span> <span class="token punctuation">{<!-- --></span>
            <span class="token property">width</span><span class="token punctuation">:</span> 560px<span class="token punctuation">;</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 164px<span class="token punctuation">;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #000000<span class="token punctuation">;</span>
            <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">.imgContent</span> <span class="token punctuation">{<!-- --></span>
            <span class="token property">width</span><span class="token punctuation">:</span> 164px<span class="token punctuation">;</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 86px<span class="token punctuation">;</span>
            <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
            <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
            <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
            <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token property">z-index</span><span class="token punctuation">:</span> 5<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4><a id="_929"></a>问题记录</h4>
<h6><a id="1_930"></a>1.页面操作变得卡顿不流畅，性能降低。</h6>
<p>解决：去除postEffect，此配置是为了让3D图更有质感，可其实在这里也没起多大作用。</p>
<pre><code class="prism language-javascript"> <span class="token comment">// postEffect: {<!-- --></span>
                    <span class="token comment">//     //配置这项会出现锯齿，请自己去查看官方配置有办法解决</span>
                    <span class="token comment">//     enable: true,</span>
                    <span class="token comment">//     bloom: {<!-- --></span>
                    <span class="token comment">//         enable: true,</span>
                    <span class="token comment">//         bloomIntensity: 0.1,</span>
                    <span class="token comment">//     },</span>
                    <span class="token comment">//     SSAO: {<!-- --></span>
                    <span class="token comment">//         enable: true,</span>
                    <span class="token comment">//         quality: "medium",</span>
                    <span class="token comment">//         radius: 2,</span>
                    <span class="token comment">//     },</span>
                    <span class="token comment">// },</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>