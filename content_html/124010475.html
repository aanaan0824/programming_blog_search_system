<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p>/// &lt;summary&gt;<br/>     /// 定时任务<br/>     /// &lt;/summary&gt;<br/>     public class TimeJobService : BackgroundService<br/>     {<!-- --><br/>         private readonly ITaskServices _service;<br/>         /// &lt;summary&gt;<br/>         /// 构造函数<br/>         /// &lt;/summary&gt;<br/>         /// &lt;param name="service"&gt;&lt;/param&gt;<br/>         public TimeJobService(ITaskServices service)<br/>         {<!-- --><br/>             _service = service;<br/>         }<br/>         /// &lt;summary&gt;<br/>         /// <br/>         /// &lt;/summary&gt;<br/>         /// &lt;param name="stoppingToken"&gt;&lt;/param&gt;<br/>         /// &lt;returns&gt;&lt;/returns&gt;<br/>         protected override async Task ExecuteAsync(CancellationToken stoppingToken)<br/>         {<!-- --></p>
<p>            while (!stoppingToken.IsCancellationRequested)<br/>             {<!-- --><br/>                 await new TaskFactory().StartNew(() =&gt;<br/>                 {<!-- --><br/>                     try<br/>                     {<!-- --><br/>                         //满足某种条件执行 比如每天凌晨执行<br/>                         var time = DateTime.Now;<br/>                         var nowDay = DateTime.Now.ToString("yyyy-MM-dd");<br/>                         var benginDate = DateTime.Parse(nowDay + " 00:00:01");<br/>                         var endDate = DateTime.Parse(nowDay + " 00:11:01");<br/>                         if (time &gt;= benginDate &amp;&amp; time &lt;= endDate)<br/>                         {<!-- --><br/>                             _service.TaskRun();<br/>                         }<br/>                     }<br/>                     catch (Exception e)<br/>                     {<!-- --><br/>                     }</p>
<p>                    //定时任务休眠，10分钟执行一次<br/>                     Thread.Sleep(60 * 1000 * 10);<br/>                 });<br/>             }<br/>         }<br/>     }</p>
<p>Startup.cs注入</p>
<p>//自动注入定时器开始,//后台任务启动专用.   <br/> services.AddTransient&lt;Microsoft.Extensions.Hosting.IHostedService, TimeJobService&gt;(); </p>
</div>
</div>