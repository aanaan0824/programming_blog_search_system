<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-tomorrow-night" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h1><a id="MySQL_0"></a>MySQL练习</h1>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#MySQL_0">MySQL练习</a></li><li><a href="#50SQL_5">50道经典SQL练习题全网最详细解析</a></li><li><ul><li><ul><li><ul><li><a href="#_7">数据表介绍</a></li><li><a href="#_43">建表语句</a></li><li><a href="#_85">插入数据</a></li><li><a href="#_148">练习题目</a></li><li><ul><li><a href="#1_01__02__150">1.查询" 01 “课程比” 02 "课程成绩高的学生的信息及课程分数</a></li><li><a href="#2_01__02__259">2.查询同时存在" 01 “课程和” 02 "课程的情况</a></li><li><a href="#3_01__02__null__300">3.查询存在" 01 “课程但可能不存在” 02 "课程的情况(不存在时显示为 null )</a></li><li><a href="#4_01__02__348">4.查询不存在" 01 “课程但存在” 02 "课程的情况</a></li><li><a href="#5_60__396">5.查询平均成绩⼤于等于 60 分的同学的学生编号和学生姓名和平均成绩</a></li><li><a href="#6_SC__429">6.查询在 SC 表存在成绩的学生信息</a></li><li><a href="#7_null_458">7.查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩，没成绩的显示为 null</a></li><li><a href="#8_492">8.查询「李」姓老师的数量</a></li><li><a href="#9_506">9.查询学过「张三」老师授课的同学的信息</a></li><li><a href="#10_574">10.查询没有学全所有课程的同学的信息</a></li><li><a href="#11_01__631">11.查询至少有一门课与学号为" 01 "的同学所学相同的同学的信息</a></li><li><ul><li><a href="#2_680">解法2</a></li></ul>
</li><li><a href="#12_01___727">12.查询和" 01 "号的同学学习的课程 完全相同的其他同学的信息</a></li><li><a href="#13_834">13.查询没学过"张三"老师讲授的任一门课程的学生姓名</a></li><li><a href="#14_898">14.查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</a></li><li><a href="#15_01__60_950">15.检索" 01 "课程分数小于 60，按分数降序排列的学生信息</a></li><li><a href="#16_981">16.按平均成绩从⾼到低显示所有学生的所有课程的成绩以及平均成绩</a></li><li><a href="#17__ID_name_607080809090_1046">17.查询各科成绩最⾼分、最低分和平均分： 以如下形式显示：课程 ID，课程 name，最⾼分，最低分，平均分，及格率，中等率，优良率，优秀率 及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</a></li><li><a href="#18_1082">18.按各科平均成绩进行排序，并显示排名</a></li><li><a href="#19_1116">19.按各科平均成绩进行排序，并显示排名，~~重复时不保留名次空缺~~</a></li></ul>
</li><li><a href="#_1150">三种常见的排名</a></li><li><a href="#ROW_NUMBER_1154">ROW_NUMBER</a></li><li><a href="#DENSE_RANK_1173">DENSE_RANK</a></li><li><a href="#RANK_1196">RANK</a></li><li><a href="#ROW_NUMBER_1223">ROW_NUMBER</a></li><li><a href="#DENSE_RANK_1254">DENSE_RANK</a></li><li><a href="#RANK_1289">RANK</a></li><li><ul><li><a href="#20_1327">20.查询学生的总成绩，并进行排名，总分重复时保留名次空缺</a></li><li><a href="#21_1370">21.查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</a></li><li><a href="#221008585707060600_1408">22.统计各科成绩各分数段人数：课程编号，课程名称，[100-85），[85-70），[70-60），[60-0）及所占百分</a></li><li><a href="#23_1442">23.查询各科成绩前三名的记录</a></li><li><a href="#24_1513">24.查询每门课程被选修的学生数</a></li><li><a href="#25_1529">25.查询出只选修两门课程的学生学号和姓名</a></li><li><a href="#26_1562">26.查询男生、女生人数</a></li><li><a href="#27_1577">27.查询名字中含有「风」字的学生信息</a></li><li><a href="#28_1593">28.查询同名同性学生名单，并统计同名同性人数</a></li><li><a href="#29_1990__1611">29.查询 1990 年出生的学生名单</a></li><li><a href="#30_1636">30.查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</a></li><li><a href="#31_85__1669">31.查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</a></li><li><a href="#32_60__1703">32.查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</a></li><li><a href="#33_1752">33.查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</a></li><li><a href="#34_70__1790">34.查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</a></li><li><a href="#35_1826">35.查询不及格的课程</a></li><li><a href="#36_01__80__1863">36.查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名</a></li><li><a href="#37_1896">37.求每门课程的学生人数</a></li><li><a href="#38_1911">38.成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</a></li><li><a href="#39_2007">39.成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</a></li><li><a href="#40_2125">40.查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</a></li><li><a href="#41_2156">41.查询每门课程成绩最好的前两名</a></li><li><a href="#42_5__2204">42.统计每门课程的学生选修人数（超过 5 人的课程才统计）。</a></li><li><a href="#43_2220">43.检索至少选修两门课程的学生学号</a></li><li><a href="#44_2236">44.查询选修了全部课程的学生信息</a></li><li><a href="#45_2266">45.查询各学生的年龄，只按年份来算</a></li><li><a href="#46___2275">46.按照出生日期来算，当前月日 &lt; 出生年月的月日，则年龄减一</a></li><li><a href="#47_2311">47.查询本周过生日的学生</a></li><li><a href="#48_2327">48.查询下周过生日的学生</a></li><li><a href="#49_2343">49.查询本月过生日的学生</a></li><li><a href="#50_2357">50.查询下月过生日的学生</a></li></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</div>
<p></p>
<hr/>
<h1><a id="50SQL_5"></a>50道经典SQL练习题全网最详细解析</h1>
<h4><a id="_7"></a>数据表介绍</h4>
<ul><li> <p>1.学⽣表 Student(SId,Sname,Sage,Ssex)</p>
<ul><li> <p>SId 学⽣编号</p> </li><li> <p>Sname 学⽣姓名</p> </li><li> <p>Sage 出⽣年⽉</p> </li><li> <p>Ssex 学⽣性别</p> </li></ul> </li><li> <p>2.课程表 Course(CId,Cname,TId)</p>
<ul><li> <p>CId 课程编号</p> </li><li> <p>Cname 课程名称</p> </li><li> <p>TId 教师编号</p> </li></ul> </li><li> <p>3.教师表 Teacher(TId,Tname)</p>
<ul><li> <p>TId 教师编号</p> </li><li> <p>Tname 教师姓名</p> </li></ul> </li><li> <p>4.成绩表 SC(SId,CId,score)</p>
<ul><li> <p>SId 学⽣编号</p> </li><li> <p>CId 课程编号</p> </li><li> <p>score 分数</p> </li></ul> </li></ul>
<hr/>
<h4><a id="_43"></a>建表语句</h4>
<ul><li> <p>学⽣表 Student</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> Student<span class="token punctuation">(</span>
    SId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Sname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Sage <span class="token keyword">datetime</span><span class="token punctuation">,</span>
    Ssex <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> </li><li> <p>课程表 Course</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> Course<span class="token punctuation">(</span>
    CId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Cname nvarchar<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    TId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>教师表 Teacher</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> Teacher<span class="token punctuation">(</span>
    TId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Tname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>成绩表 SC</p> <pre><code class="prism language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> SC<span class="token punctuation">(</span>
    SId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    CId <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    score <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ul>
<hr/>
<h4><a id="_85"></a>插入数据</h4>
<blockquote>
<p>注意这里插入数据的时候，里面可能含有隐藏字符，出现显示不出的数据手动重新打一下再插入即可</p>
</blockquote>
<ul><li> <p>学⽣表 Student</p> <pre><code class="prism language-sql"><span class="token comment">-- 学生表 Student</span>
<span class="token comment">-- 学生表 Student</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'赵雷'</span> <span class="token punctuation">,</span> <span class="token string">'1990-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'钱电'</span> <span class="token punctuation">,</span> <span class="token string">'1990-12-21'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'孙风'</span> <span class="token punctuation">,</span> <span class="token string">'1990-12-20'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'李云'</span> <span class="token punctuation">,</span> <span class="token string">'1990-12-06'</span> <span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'周梅'</span> <span class="token punctuation">,</span> <span class="token string">'1991-12-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'吴兰'</span> <span class="token punctuation">,</span> <span class="token string">'1992-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'郑竹'</span> <span class="token punctuation">,</span> <span class="token string">'1989-01-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'09'</span> <span class="token punctuation">,</span> <span class="token string">'张三'</span> <span class="token punctuation">,</span> <span class="token string">'2017-12-20'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'10'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span> <span class="token punctuation">,</span> <span class="token string">'2017-12-25'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'11'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span> <span class="token punctuation">,</span> <span class="token string">'2012-06-06'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'12'</span> <span class="token punctuation">,</span> <span class="token string">'赵六'</span> <span class="token punctuation">,</span> <span class="token string">'2013-06-13'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Student <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'13'</span> <span class="token punctuation">,</span> <span class="token string">'孙七'</span> <span class="token punctuation">,</span> <span class="token string">'2014-06-01'</span> <span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> </li><li> <p>课程表 Course</p> <pre><code class="prism language-sql"><span class="token comment">-- 科⽬表 Course </span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'语文'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'数学'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Course <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'英语'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>教师表 Teacher</p> <pre><code class="prism language-sql"><span class="token comment">-- 教师表 Teacher </span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> Teacher <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> </li><li> <p>成绩表 SC</p> <pre><code class="prism language-sql"><span class="token comment">-- 成绩表 SC </span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'05'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">87</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'01'</span> <span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'06'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'02'</span> <span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">insert</span> <span class="token keyword">into</span> SC <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'07'</span> <span class="token punctuation">,</span> <span class="token string">'03'</span> <span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ul>
<hr/>
<h4><a id="_148"></a>练习题目</h4>
<h5><a id="1_01__02__150"></a>1.查询" 01 “课程比” 02 "课程成绩高的学生的信息及课程分数</h5>
<blockquote>
<p>分析：<br/> 1、找出有01成绩的学生成绩信息<br/> 2、找出有02成绩的学生成绩信息<br/> 3、通过SId将两表取别名t1、t2进行左连接<br/> 4、加上满足01‘语文’ &gt; 02’数学’的条件</p>
</blockquote>
<ul><li>找出有01成绩的学生成绩信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\2eb666c2241d4cf2a199e5ccdaab0339.png" width="100%"/>
</div>
<ul><li>找出有02成绩的学生成绩信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1e83363c4c66496b8b72750de7c2fd53.png" width="100%"/>
</div>
<ul><li>通过SId将两表取别名t1、t2进行左连接</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId<span class="token punctuation">,</span>
       t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>
       t1<span class="token punctuation">.</span>score <span class="token keyword">as</span> <span class="token string">'语文'</span><span class="token punctuation">,</span>
       t2<span class="token punctuation">.</span>score <span class="token keyword">as</span> <span class="token string">'数学'</span> 
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> 
       SId<span class="token punctuation">,</span>
       CId<span class="token punctuation">,</span>
       score 
  <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span> t1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> 
       SId<span class="token punctuation">,</span>
       CId<span class="token punctuation">,</span>
       score 
  <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'02'</span>
<span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId<span class="token operator">=</span>t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\04292a07066349d08ada345292e4cc3e.png" width="100%"/>
</div>
<ul><li>加上满足01‘语文’ &gt; 02’数学’的条件</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId<span class="token punctuation">,</span>
       t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>
       t1<span class="token punctuation">.</span>score <span class="token keyword">as</span> <span class="token string">'语文'</span><span class="token punctuation">,</span>
       t2<span class="token punctuation">.</span>score <span class="token keyword">as</span> <span class="token string">'数学'</span> 
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> 
       SId<span class="token punctuation">,</span>
       CId<span class="token punctuation">,</span>
       score 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span> t1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> 
       SId<span class="token punctuation">,</span>
       CId<span class="token punctuation">,</span>
       score 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'02'</span>
<span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId<span class="token operator">=</span>t2<span class="token punctuation">.</span>SId
<span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>score <span class="token operator">&gt;</span> t2<span class="token punctuation">.</span>score<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\9c51e8e8e7084de9ae01aad60490c04e.png" width="100%"/>
</div>
<ul><li>最后将上面的表作为一个子表tt1将我们想要查询的表关联起来，取出想要查询的字段</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>Sname
        <span class="token punctuation">,</span>tt3<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>tt3<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
    <span class="token keyword">FROM</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> SId
               <span class="token punctuation">,</span>CId
               <span class="token punctuation">,</span>score 
        <span class="token keyword">FROM</span> SC 
        <span class="token keyword">where</span> CId <span class="token operator">=</span> <span class="token string">'01'</span>
    <span class="token punctuation">)</span> t1
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span>	SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score 
        <span class="token keyword">FROM</span> SC 
        <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span>
    <span class="token punctuation">)</span> t2
    <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId
    <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>Score <span class="token operator">&gt;</span> t2<span class="token punctuation">.</span>Score
<span class="token punctuation">)</span> tt1 
<span class="token keyword">JOIN</span> Student tt2 <span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">JOIN</span> SC tt3 <span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt3<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\9b496790ede043a58ad6d2abf043e5c0.png" width="100%"/>
</div>
<hr/>
<h5><a id="2_01__02__259"></a>2.查询同时存在" 01 “课程和” 02 "课程的情况</h5>
<pre><code>分析：
     满足条件的SC表中：
       1、筛选出课程号为01的全部信息 AS命名为 t1
       2、筛选出课程号为02的全部信息 AS命名为 t2
       3、使用join连接取出同时存在01课程和02课程的SId
</code></pre>
<ul><li>筛选出课程号为01的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\7365603b757e48a78a5f886f62005b1a.png" width="100%"/>
</div>
<ul><li>筛选出课程号为02的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\71fc9c176375479a9258d6157e7b34b9.png" width="100%"/>
</div>
<ul><li>使用join连接取出同时存在01课程和02课程的SId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span><span class="token keyword">AS</span> t1 <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span><span class="token keyword">AS</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\515874e522244ffd99ad14a199371b73.png" width="100%"/>
</div>
<hr/>
<h5><a id="3_01__02__null__300"></a>3.查询存在" 01 “课程但可能不存在” 02 "课程的情况(不存在时显示为 null )</h5>
<pre><code>分析：
     满足条件的SC表中：
       1、筛选出课程号为01的全部信息 AS命名为 t1
       2、筛选出课程号为02的全部信息 AS命名为 t2
       3、左连接
</code></pre>
<ul><li>筛选出课程号为01的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>CId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\cc9f1f79a70447a29bab9e7e19836cd8.png" width="100%"/>
</div>
<ul><li>筛选出课程号为02的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>CId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\3109d2cc99404d2e870d9bd2b312ff51.png" width="100%"/>
</div>
<ul><li>左连接</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t2CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> t2Score
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\f4dae0e195a74897b3306e20a4765016.png" width="100%"/>
</div>
<hr/>
<h5><a id="4_01__02__348"></a>4.查询不存在" 01 “课程但存在” 02 "课程的情况</h5>
<pre><code>分析：
     满足条件的SC表中：
       1、筛选出课程号为01的全部信息 AS命名为 t1
       2、筛选出课程号为02的全部信息 AS命名为 t2
       3、右连接
</code></pre>
<ul><li>筛选出课程号为01的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>CId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\cc9f1f79a70447a29bab9e7e19836cd8.png" width="100%"/>
</div>
<ul><li>筛选出课程号为02的全部信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>CId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\3109d2cc99404d2e870d9bd2b312ff51.png" width="100%"/>
</div>
<ul><li>右连接</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t2CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> t2Score
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'02'</span>
<span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\0ed3783b850d46b4ba526fed0050784d.png" width="100%"/>
</div>
<hr/>
<h5><a id="5_60__396"></a>5.查询平均成绩⼤于等于 60 分的同学的学生编号和学生姓名和平均成绩</h5>
<blockquote>
<p>分析：<br/> 1、先查出平均成绩大于60分的SId，并用ROUND(X,D)保留两位小数<br/> 2、再将平均分作为表t1与Student表t2做连接得出结果</p>
</blockquote>
<ul><li>先查出平均成绩大于60分的SId，并用ROUND(X,D)保留两位小数</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">AS</span> avg_score 
 <span class="token keyword">FROM</span> SC 
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
 <span class="token keyword">HAVING</span> avg_score<span class="token operator">&gt;=</span><span class="token number">60</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\6dfbc79aa0bb4de89d7e009584b07c3d.png" width="100%"/>
</div>
<ul><li>再将平均分作为表t1与Student表t2做连接得出结果</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>avg_score
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
<span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">AS</span> avg_score 
 <span class="token keyword">FROM</span> SC 
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
 <span class="token keyword">HAVING</span> avg_score<span class="token operator">&gt;=</span><span class="token number">60</span>
<span class="token punctuation">)</span>t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\7b5730b824924e78bc9b5ca76f087495.png" width="100%"/>
</div>
<hr/>
<h5><a id="6_SC__429"></a>6.查询在 SC 表存在成绩的学生信息</h5>
<blockquote>
<p>分析：<br/> 1、首先DISTINCTSC表的SId的数据<br/> 2、在将上表作为表t1与Student表t2连接查询出学生信息</p>
</blockquote>
<ul><li>首先DISTINCTSC表的SId的数据</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 
 <span class="token keyword">DISTINCT</span> SId 
 <span class="token keyword">FROM</span> SC<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\cafcb2ed4d26450099dea7641dd63de6.png" width="100%"/>
</div>
<ul><li>在将上表作为表t1与Student表t2连接查询出学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> 
    <span class="token keyword">DISTINCT</span> SId 
    <span class="token keyword">FROM</span> SC
<span class="token punctuation">)</span>t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\fd27f39df30442aba3fe08c02c6ad46b.png" width="100%"/>
</div>
<hr/>
<h5><a id="7_null_458"></a>7.查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩，没成绩的显示为 null</h5>
<blockquote>
<p>分析：<br/> 1、首先统计出SC表SId的选课总数和总成绩<br/> 2、在将上表作为表t1与Student表t2做右连接查询出所有同学的学⽣编号、学⽣姓名、选课总数、所有课程的总成绩，没成绩的显示为 null</p>
</blockquote>
<ul><li>首先统计出SC表SId的选课总数和总成绩</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt
       <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> sum_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c4863250bc5c4c06af65998604e7ee1e.png" width="100%"/>
</div>
<ul><li>在将上表作为表t1与Student表t2做右连接查询出所有同学的学⽣编号、学⽣姓名、选课总数、所有课程的总成绩，没成绩的显示为 null</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>cnt <span class="token keyword">AS</span> <span class="token string">'选课总数'</span>
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_score <span class="token keyword">AS</span> <span class="token string">'总成绩'</span>
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt
           <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> sum_score 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId
<span class="token punctuation">)</span>t1 <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\dc89eddc6c89408a9de0437037c51b5f.png" width="100%"/>
</div>
<hr/>
<h5><a id="8_492"></a>8.查询「李」姓老师的数量</h5>
<blockquote>
<p>分析：直接使用COUNT(*)统计LIKE模糊查询查询「李」姓⽼师的数量</p>
</blockquote>
<ul><li>直接使用COUNT(*)统计LIKE模糊查询查询「李」姓⽼师的数量</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> Teacher 
<span class="token keyword">WHERE</span> Teacher<span class="token punctuation">.</span>Tname 
<span class="token operator">LIKE</span> <span class="token punctuation">(</span><span class="token string">'李%'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c575362fbc4d4f27aab5a8852414146d.png" width="100%"/>
</div>
<hr/>
<h5><a id="9_506"></a>9.查询学过「张三」老师授课的同学的信息</h5>
<blockquote>
<p>分析：<br/> 1、首先查询张三老师的TId<br/> 2、然后查询张三老师的授课信息CId<br/> 3、再查询学过张三老师授课的学生SId<br/> 4、最后将学过张三老师授课的学生SId作为表t1和Student表t2连接查询出学生信息</p>
</blockquote>
<ul><li>首先查询张三老师的TId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> TId 
<span class="token keyword">FROM</span> Teacher 
<span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\34d8769d04d7412888da0dbce9ca4992.png" width="100%"/>
</div>
<ul><li>然后查询张三老师的授课信息CId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> Course 
<span class="token keyword">WHERE</span> TId <span class="token operator">=</span><span class="token punctuation">(</span>
           <span class="token keyword">SELECT</span> TId 
           <span class="token keyword">FROM</span> Teacher 
           <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\eb01b6b5f83c41c9afe5687dbaf9a8b9.png" width="100%"/>
</div>
<ul><li>再查询学过张三老师授课的学生SId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> CId 
      <span class="token keyword">FROM</span> Course 
      <span class="token keyword">WHERE</span> TId <span class="token operator">=</span><span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> TId 
                <span class="token keyword">FROM</span> Teacher 
                <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
      <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e33f8e54dc674860af09d0e76892ccc2.png" width="100%"/>
</div>
<ul><li>最后将学过张三老师授课的学生SId作为表t1和Student表t2连接查询出学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId 
  <span class="token keyword">FROM</span> SC 
  <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> CId 
      <span class="token keyword">FROM</span> Course 
      <span class="token keyword">WHERE</span> TId <span class="token operator">=</span><span class="token punctuation">(</span>
            <span class="token keyword">SELECT</span> TId 
                <span class="token keyword">FROM</span> Teacher 
                <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
      <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\75c3c0bef5a34410a97ca01805077bd8.png" width="100%"/>
</div>
<hr/>
<h5><a id="10_574"></a>10.查询没有学全所有课程的同学的信息</h5>
<blockquote>
<p>分析：<br/> 1、先查询所有课程信息<br/> 2、然后将所有课程信息作为表t1与Student表t2内连接查询出同学的信息<br/> 3、查询所有课程信息的数量<br/> 4、最后将上表作为tt1表对课程信息进行筛选小于课程总数的查询出没有学全所有课程的同学的信息</p>
</blockquote>
<ul><li>先查询所有课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId 
<span class="token keyword">FROM</span> SC<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\abef5c35efbc45d080074f422a5cf6bb.png" width="100%"/>
</div>
<ul><li>然后将所有课程信息作为表t1与Student表t2内连接查询出同学的信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
          <span class="token punctuation">,</span>CId 
<span class="token keyword">FROM</span> SC
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a4361fc4503d4fbd84ffc4c576f39f69.png" width="100%"/>
</div>
<ul><li>查询所有课程信息的数量</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> Course<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\4e0cf01f206246b897c219f0b8eec134.png" width="100%"/>
</div>
<ul><li>最后将上表作为tt1表对课程信息进行筛选小于课程总数的查询出没有学全所有课程的同学的信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>SName
        <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>tt1<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token keyword">as</span> cnt
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>SName
    <span class="token keyword">FROM</span> SC t1 <span class="token keyword">JOIN</span> Student t2
    <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SID
<span class="token punctuation">)</span> tt1 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>SId<span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>SName
<span class="token keyword">Having</span> cnt <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span>  <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> Course<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\fa986ae9d04e414b8e61448ce838b9c7.png" width="100%"/>
</div>
<hr/>
<h5><a id="11_01__631"></a>11.查询至少有一门课与学号为" 01 "的同学所学相同的同学的信息</h5>
<blockquote>
<p>分析：<br/> 1、首先查询学号为01同学所学的课程号<br/> 2、然后查询至少有一门课与01同学所学相同的学生编号<br/> 3、将上表的结果作为tt2与Student表tt2进行左连接查询，找到学生信息</p>
</blockquote>
<ul><li>首先查询学号为01同学所学的课程号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\935e00d05db34243aae7d648d91dc2ac.png" width="100%"/>
</div>
<ul><li>然后查询至少有一门课与01同学所学相同的学生编号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>SId<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> CId 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token punctuation">)</span>t1 <span class="token keyword">JOIN</span> SC t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c7ada457d5944427813858924064c662.png" width="100%"/>
</div>
<ul><li>将上表的结果作为tt2与Student表tt2进行左连接查询，找到学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> tt2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
          <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>SId<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> CId 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token punctuation">)</span>t1 <span class="token keyword">JOIN</span> SC t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t2<span class="token punctuation">.</span>SId
<span class="token punctuation">)</span> tt1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> Student tt2
<span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\f9442d2816ae446f8b482ef34e0a3349.png" width="100%"/>
</div>
<h6><a id="2_680"></a>解法2</h6>
<blockquote>
<p>分析：<br/> 1、首先查询学号为01同学所学的课程号<br/> 2、然后再对课程号不是01的所有学生的课程信息进行筛选<br/> 3、最后将SC表作为t1表与Student表t2表进行关联，找到学生信息</p>
</blockquote>
<ul><li>首先查询学号为01同学所学的课程号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\935e00d05db34243aae7d648d91dc2ac.png" width="100%"/>
</div>
<ul><li>然后再对课程号不是01的所有学生的课程信息进行筛选</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> SId
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> SId <span class="token operator">!=</span> <span class="token string">'01'</span> 
<span class="token operator">AND</span> CId <span class="token operator">IN</span><span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> CId 
        <span class="token keyword">FROM</span> SC 
        <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\6de6e86ab0de4295b7f598e159e67ae0.png" width="100%"/>
</div>
<ul><li>最后将SC表作为t1表与Student表t2表进行关联，找到学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> t1<span class="token punctuation">.</span>SId
                <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
<span class="token keyword">FROM</span> 
    SC t1 <span class="token keyword">JOIN</span> Student t2
    <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId
    <span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>SId <span class="token operator">!=</span> <span class="token string">'01'</span> 
    <span class="token operator">AND</span> CId <span class="token operator">IN</span><span class="token punctuation">(</span>
              <span class="token keyword">SELECT</span> CId 
              <span class="token keyword">FROM</span> SC 
              <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span>
         <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c7565e8f4e3b4f4e8cf7428766e104e0.png" width="100%"/>
</div>
<hr/>
<h5><a id="12_01___727"></a>12.查询和" 01 "号的同学学习的课程 完全相同的其他同学的信息</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出学号为01的课程信息<br/> 2、然后查询出学号不为01的课程信息<br/> 3、再将上面两个表分别作为t1、t2进行关联，得出01同学学习的所有课程信息和其他同学的所有课程信息<br/> 4、然后将SC表作为t1表与Student表t2表进行关联、表tt1分组对学号为01的学生进行筛选</p>
</blockquote>
<ul><li>首先查询出学号为01的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> SId<span class="token operator">=</span><span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\5fdf1cd6fcfa4d819bb16472967a2148.png" width="100%"/>
</div>
<ul><li>然后查询出学号不为01的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> SId<span class="token operator">!=</span><span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\ec7128726e134d10b52833f44b84b99e.png" width="100%"/>
</div>
<ul><li>再将上面两个表分别作为t1、t2进行关联，得出01同学学习的所有课程信息和其他同学的所有课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t1CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t2CId 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId 
  <span class="token keyword">FROM</span> SC 
  <span class="token keyword">WHERE</span> SId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> SId<span class="token operator">!=</span><span class="token string">'01'</span><span class="token punctuation">)</span> t2
   <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\44fc4f7cac994d88b7aa16dfe712380b.png" width="100%"/>
</div>
<ul><li>然后将SC表作为t1表与Student表t2表进行关联、表tt1分组对学号为01的学生进行筛选</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> tt1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>tt1<span class="token punctuation">.</span>t1CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> t1Cnt
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>tt1<span class="token punctuation">.</span>t2CId<span class="token punctuation">)</span> <span class="token keyword">as</span> t2Cnt 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
         <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t1CId
         <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t2CId 
  <span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId 
  <span class="token keyword">FROM</span> SC 
  <span class="token keyword">WHERE</span> SId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> SId<span class="token operator">!=</span><span class="token string">'01'</span><span class="token punctuation">)</span> t2
   <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> tt1 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>SId
   <span class="token keyword">HAVING</span> t1Cnt <span class="token operator">AND</span> t2Cnt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
                             <span class="token keyword">FROM</span> SC 
                             <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\63ed19eee95740af92839ca5048e9fe8.png" width="100%"/>
</div>
<ul><li>最后将上表作为ttt1与Student表ttt2进行关联，找到学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> ttt1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>ttt2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> tt1<span class="token punctuation">.</span>SId
          <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>tt1<span class="token punctuation">.</span>t1CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> t1Cnt
          <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>tt1<span class="token punctuation">.</span>t2CId<span class="token punctuation">)</span> <span class="token keyword">as</span> t2Cnt 
   <span class="token keyword">FROM</span><span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t1CId
            <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>CId <span class="token keyword">AS</span> t2CId 
     <span class="token keyword">FROM</span><span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> SId
            <span class="token punctuation">,</span>CId 
     <span class="token keyword">FROM</span> SC 
     <span class="token keyword">WHERE</span> SId<span class="token operator">=</span><span class="token string">'01'</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> SId<span class="token operator">!=</span><span class="token string">'01'</span><span class="token punctuation">)</span> t2
   <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> tt1 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>SId
   <span class="token keyword">HAVING</span> t1Cnt <span class="token operator">AND</span> t2Cnt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> 
                             <span class="token keyword">FROM</span> SC 
                             <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> ttt1 <span class="token keyword">JOIN</span> Student ttt2
<span class="token keyword">ON</span> ttt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> ttt2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\04aad8c7896e46f19cc253c47e720e7c.png" width="100%"/>
</div>
<hr/>
<h5><a id="13_834"></a>13.查询没学过"张三"老师讲授的任一门课程的学生姓名</h5>
<blockquote>
<p>1、首先查询出张三老师教授的课程<br/> 2、然后查询出张三老师讲授的任意一门的课程号<br/> 3、再查询出张三老师讲授的任意一门的课程号对应的SId<br/> 4、最后查询出没学过"张三"老师讲授的任一门课程的学生姓名</p>
</blockquote>
<ul><li>首先查询出张三老师教授的课程</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> TId 
<span class="token keyword">FROM</span> Teacher 
<span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\42a26b77dd98494aa6e53c5851d78350.png" width="100%"/>
</div>
<ul><li>然后查询出张三老师讲授的任意一门的课程号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> Course 
<span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> TId 
      <span class="token keyword">FROM</span> Teacher 
      <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\11ee5750a52d43a394ce67a9a31e5d29.png" width="100%"/>
</div>
<ul><li>再查询出张三老师讲授的任意一门的课程号对应的SId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> CId <span class="token operator">in</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> CId 
  <span class="token keyword">FROM</span> Course 
  <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> TId 
    <span class="token keyword">FROM</span> Teacher 
    <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\19aee8912b604c758ff4b1adcda697e0.png" width="100%"/>
</div>
<ul><li>最后查询出没学过"张三"老师讲授的任一门课程的学生姓名</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
      <span class="token punctuation">,</span>Sname 
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> SId 
<span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId 
    <span class="token keyword">FROM</span> SC 
    <span class="token keyword">WHERE</span> CId <span class="token operator">in</span><span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span> CId 
      <span class="token keyword">FROM</span> Course 
      <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span> TId 
        <span class="token keyword">FROM</span> Teacher 
        <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<hr/>
<h5><a id="14_898"></a>14.查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先查询不及格同学的课程的学号和课程号<br/> 2、再以SId进行分组将两门及其以上不及格课程的学号和平均成绩查询出来<br/> 3、最后将上表作为表tt1与Student表tt2做关联，取出要查询的信息</p>
</blockquote>
<ul><li>首先查询不及格同学的课程的学号和课程号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId
       <span class="token punctuation">,</span>score
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a11e275b4bc24d9b85a31e08a890aace.png" width="100%"/>
</div>
<ul><li>再以SId进行分组将两门及其以上不及格课程的学号和平均成绩查询出来</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
          <span class="token punctuation">,</span>CId
          <span class="token punctuation">,</span>score
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> t1 
	 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId <span class="token keyword">HAVING</span> cnt <span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\bcd148f2b1fa42d9b1b46bf950716bfa.png" width="100%"/>
</div>
<ul><li>最后将上表作为表tt1与Student表tt2做关联，取出要查询的信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> tt2<span class="token punctuation">.</span>SId<span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>Sname<span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>avg_score <span class="token keyword">FROM</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
          <span class="token punctuation">,</span>CId
          <span class="token punctuation">,</span>score
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">)</span> t1 
	 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId <span class="token keyword">HAVING</span> cnt <span class="token operator">&gt;=</span><span class="token number">2</span><span class="token punctuation">)</span> tt1 <span class="token keyword">JOIN</span> Student tt2
   <span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\2fa34f84fa594f04888d2190a372e830.png" width="100%"/>
</div>
<hr/>
<h5><a id="15_01__60_950"></a>15.检索" 01 "课程分数小于 60，按分数降序排列的学生信息</h5>
<blockquote>
<p>分析：<br/> 1、首先先将SC表t1与Student表t2进行关联<br/> 2、最后检索出01课程分数小于60，按分数降序排列的学生信息</p>
</blockquote>
<ul><li>首先先将SC表t1与Student表t2进行关联</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score 
<span class="token keyword">FROM</span>
SC t1 <span class="token keyword">JOIN</span> Student t2 
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e7cd0428b83443409d1d5e56f30f1414.png" width="100%"/>
</div>
<ul><li>最后检索出01课程分数小于60，按分数降序排列的学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score 
<span class="token keyword">FROM</span>
SC t1 <span class="token keyword">JOIN</span> Student t2 
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId
<span class="token operator">AND</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> <span class="token string">'01'</span> <span class="token operator">AND</span> t1<span class="token punctuation">.</span>score <span class="token operator">&lt;</span> <span class="token number">60</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1f81fdca112040339d2d2a0758f72d58.png" width="100%"/>
</div>
<hr/>
<h5><a id="16_981"></a>16.按平均成绩从⾼到低显示所有学生的所有课程的成绩以及平均成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先先查出’01’语文、'02’数学、'03’英语课程号所对应的成绩<br/> 2、然后查出所有课程的平均成绩<br/> 3、因为有语文、数学、英语三门课程所有要对平均分进行分组<br/> 4、最后将分组后的表作为tt1表分别与’01’语文、'02’数学、'03’英语进行左连接，找出所有学生的每门课的平均成绩，然后按平均分进行升序</p>
</blockquote>
<ul><li>首先先查出’01’语文、'02’数学、'03’英语课程号所对应的成绩</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\92f1275505ae4660870b5b20058d4b3b.png" width="100%"/>
</div>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a7272b82163b47a58e26adae2e5f0054.png" width="100%"/>
</div>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId<span class="token punctuation">,</span>score <span class="token keyword">FROM</span> SC <span class="token keyword">WHERE</span> SId <span class="token operator">=</span> <span class="token string">'03'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\61ccb4010184411985e9c73a7e92add9.png" width="100%"/>
</div>
<ul><li>然后查出所有课程的平均成绩</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_socre 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\dd42248fb0c44a749bbb30b7508d2220.png" width="100%"/>
</div>
<ul><li>因为有语文、数学、英语三门课程所有要对平均分进行分组</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_score 
<span class="token keyword">FROM</span>
SC t1 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\5c34d2a66c974335ab25e2348413aeed.png" width="100%"/>
</div>
<ul><li>最后将分组后的表作为tt1表分别与’01’语文、'02’数学、'03’英语进行左连接，找出所有学生的每门课的平均成绩，然后按平均分进行升序</li></ul>
<pre><code class="prism language-sql">	<span class="token keyword">SELECT</span> tt1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>avg_score <span class="token keyword">AS</span> <span class="token string">'平均分'</span>
       <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>score <span class="token keyword">AS</span> <span class="token string">'语文'</span>
       <span class="token punctuation">,</span>tt3<span class="token punctuation">.</span>score <span class="token keyword">AS</span> <span class="token string">'数学'</span>
       <span class="token punctuation">,</span>tt4<span class="token punctuation">.</span>score <span class="token keyword">AS</span> <span class="token string">'英语'</span>
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
          <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">as</span> avg_score 
   <span class="token keyword">FROM</span>
   SC t1 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>SId
<span class="token punctuation">)</span> tt1
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> SId<span class="token punctuation">,</span>score <span class="token keyword">from</span> SC <span class="token keyword">where</span> CId <span class="token operator">=</span> <span class="token string">'01'</span><span class="token punctuation">)</span> tt2 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> SId<span class="token punctuation">,</span>score <span class="token keyword">from</span> SC <span class="token keyword">where</span> CId <span class="token operator">=</span> <span class="token string">'02'</span><span class="token punctuation">)</span> tt3 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt3<span class="token punctuation">.</span>SId
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span><span class="token keyword">select</span> SId<span class="token punctuation">,</span>score <span class="token keyword">from</span> SC <span class="token keyword">where</span> CId <span class="token operator">=</span> <span class="token string">'03'</span><span class="token punctuation">)</span> tt4 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt4<span class="token punctuation">.</span>SId
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>avg_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a592d9ef52634cb5a5e289d2c623fdce.png" width="100%"/>
</div>
<hr/>
<h5><a id="17__ID_name_607080809090_1046"></a>17.查询各科成绩最⾼分、最低分和平均分： 以如下形式显示：课程 ID，课程 name，最⾼分，最低分，平均分，及格率，中等率，优良率，优秀率 及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</h5>
<ul><li>首先先将SC表和Course进行关联并分组</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname 
<span class="token keyword">FROM</span>
SC t1 <span class="token keyword">JOIN</span> Course t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1156e994678a42ab8d210ad7d369cecd.png" width="100%"/>
</div>
<ul><li>然后分别计算出最高分、最低分、平均分、及格率、中等率、优良率、优秀率，并将查询结果按人数降序排列，若人数相同，按课程号升序排列</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname
       <span class="token punctuation">,</span><span class="token function">MAX</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'最高分'</span>
       <span class="token punctuation">,</span><span class="token function">MIN</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'最低分'</span>
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'平均分'</span>
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'及格率'</span> 
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">70</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'中等率'</span> 
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优良率'</span> 
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score <span class="token operator">&gt;=</span> <span class="token number">90</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token operator">/</span><span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'优秀率'</span> 
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'人数'</span>
<span class="token keyword">FROM</span>
SC t1 <span class="token keyword">JOIN</span> Course t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token string">'人数'</span> <span class="token keyword">DESC</span><span class="token punctuation">,</span>CId <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\abfda2ba02bf4a63a3cc85615e5154bc.png" width="100%"/>
</div>
<hr/>
<h5><a id="18_1082"></a>18.按各科平均成绩进行排序，并显示排名</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出各科的平均分并进行排序<br/> 2、最后定义一个变量@i然后将上表作为t1表进行排名计算，查询出结果</p>
</blockquote>
<ul><li>首先查询出各科的平均分并进行排序</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> avg_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\df12118d711f43dd903ceff8447a60b6.png" width="100%"/>
</div>
<ul><li>最后定义一个变量@i然后将上表作为t1表进行排名计算，查询出结果</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">-- 定义一个变量</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>avg_score
       <span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">AS</span> <span class="token string">'排名'</span> 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId
          <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> avg_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_score <span class="token keyword">DESC</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c315a9844b94400ab8f1d76923aeb9ee.png" width="100%"/>
</div>
<hr/>
<h5><a id="19_1116"></a>19.按各科平均成绩进行排序，并显示排名，<s>重复时不保留名次空缺</s></h5>
<blockquote>
<p>分析：<br/> 1、首先查询出各科的平均分并进行排序<br/> 2、最后定义一个变量@i然后将上表作为t1表进行排名计算，查询出结果</p>
</blockquote>
<ul><li>首先查询出各科的平均分并进行排序</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId
       <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> avg_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\df12118d711f43dd903ceff8447a60b6.png" width="100%"/>
</div>
<ul><li>最后定义一个变量@i然后将上表作为t1表进行排名计算，查询出结果</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">-- 定义一个变量</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>avg_score
       <span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">AS</span> <span class="token string">'排名'</span> 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId
          <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> avg_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_score <span class="token keyword">DESC</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c315a9844b94400ab8f1d76923aeb9ee.png" width="100%"/>
</div>
<hr/>
<h4><a id="_1150"></a>三种常见的排名</h4>
<blockquote>
<p>row_number、dense_rank、rank在MySQL 5.7中的实现<br/> 对SC中的学生score进行整体排名</p>
</blockquote>
<h4><a id="ROW_NUMBER_1154"></a>ROW_NUMBER</h4>
<blockquote>
<p>1 2 3 4 5 6 7 没有重复排名，依次递增</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">as</span> row_number
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  SId
            <span class="token punctuation">,</span>CId
            <span class="token punctuation">,</span>score
    <span class="token keyword">from</span> SC
    <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<h4><a id="DENSE_RANK_1173"></a>DENSE_RANK</h4>
<blockquote>
<p>1 2 3 3 3 4 5 6 7 有重复时并列排名，最终排名也是连续的</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> dense_rank
        <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  SId
            <span class="token punctuation">,</span>CId
            <span class="token punctuation">,</span>score
    <span class="token keyword">from</span> SC
    <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<h4><a id="RANK_1196"></a>RANK</h4>
<blockquote>
<p>1 2 3 3 3 6 7 8 有重复时并列排名，最终排名不连续</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@j</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token variable">@j</span> :<span class="token operator">=</span> <span class="token variable">@j</span> <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@j</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rank
        <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span>
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  SId
            <span class="token punctuation">,</span>CId
            <span class="token punctuation">,</span>score
    <span class="token keyword">from</span> SC
    <span class="token keyword">order</span> <span class="token keyword">by</span> score <span class="token keyword">desc</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>进行分组排名</p>
</blockquote>
<h4><a id="ROW_NUMBER_1223"></a>ROW_NUMBER</h4>
<blockquote>
<p>查询每⻔课程成绩最好的前三名 1 2 3 4 5 6 7 没有重复排名，依次递增</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>SName
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
    <span class="token keyword">from</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">from</span> SC
        <span class="token keyword">order</span> <span class="token keyword">by</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> tt1 <span class="token keyword">join</span> Student tt2 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>rn<span class="token operator">&lt;=</span><span class="token number">3</span> <span class="token operator">and</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">order</span> <span class="token keyword">by</span> tt1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn<span class="token punctuation">;</span>
</code></pre>
<h4><a id="DENSE_RANK_1254"></a>DENSE_RANK</h4>
<blockquote>
<p>查询每⻔课程成绩最好的前三名 1 2 3 3 3 4 5 6 7 有重复时并列排名，最终排名也是连续的</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@j</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@k</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>SName
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token variable">@j</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@j</span><span class="token operator">=</span><span class="token variable">@k</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
            <span class="token punctuation">,</span><span class="token variable">@k</span> :<span class="token operator">=</span> <span class="token variable">@j</span>
    <span class="token keyword">from</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">from</span> SC
        <span class="token keyword">order</span> <span class="token keyword">by</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> tt1 <span class="token keyword">join</span> Student tt2 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>rn<span class="token operator">&lt;=</span><span class="token number">3</span> <span class="token operator">and</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">order</span> <span class="token keyword">by</span> tt1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn<span class="token punctuation">;</span>
</code></pre>
<h4><a id="RANK_1289"></a>RANK</h4>
<blockquote>
<p>查询每⻔课程成绩最好的前三名 1 2 3 3 3 6 7 8 有重复时并列排名，最终排名不连续</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@j</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@k</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@m</span> :<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>SName
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn
<span class="token keyword">from</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token variable">@j</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@m</span> :<span class="token operator">=</span> <span class="token variable">@m</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">@m</span> :<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@j</span><span class="token operator">=</span><span class="token variable">@k</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@m</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
            <span class="token punctuation">,</span><span class="token variable">@k</span> :<span class="token operator">=</span> <span class="token variable">@j</span>
    <span class="token keyword">from</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">from</span> SC
        <span class="token keyword">order</span> <span class="token keyword">by</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> tt1 <span class="token keyword">join</span> Student tt2 <span class="token keyword">on</span> tt1<span class="token punctuation">.</span>rn<span class="token operator">&lt;=</span><span class="token number">3</span> <span class="token operator">and</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">order</span> <span class="token keyword">by</span> tt1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn<span class="token punctuation">;</span>
</code></pre>
<hr/>
<h5><a id="20_1327"></a>20.查询学生的总成绩，并进行排名，总分重复时保留名次空缺</h5>
<blockquote>
<p>122345<br/> 分析：<br/> 1、首先先查询总成绩，以SId进行分组，并进行排序<br/> 2、最后将上表作为t1表然后定义变量@i、@j进行排名、@p、@q用来控制总分重复时 保留名次空缺</p>
</blockquote>
<ul><li>首先先查询总成绩，以SId进行分组，并进行排序</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
<span class="token keyword">AS</span> sum_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sum_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\80ab57e446864f55aee4f6ed2a83151e.png" width="100%"/>
</div>
<p>*最后将上表作为t1表然后定义变量@i、@j进行排名、@p、@q用来控制总分重复时 保留名次空缺</p>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@j</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_score <span class="token keyword">AS</span> <span class="token string">'总分'</span>
       <span class="token punctuation">,</span><span class="token variable">@j</span> :<span class="token operator">=</span><span class="token variable">@j</span> <span class="token operator">+</span> <span class="token number">1</span>
       <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span>t1<span class="token punctuation">.</span>sum_score
       <span class="token punctuation">,</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@j</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token variable">@j</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'排名'</span>
       <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span> 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
  <span class="token keyword">AS</span> sum_score 
  <span class="token keyword">FROM</span> SC 
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sum_score <span class="token keyword">DESC</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\96a76b590c7846b2a187c9747eb51ac1.png" width="100%"/>
</div>
<hr/>
<h5><a id="21_1370"></a>21.查询学生的总成绩，并进行排名，总分重复时不保留名次空缺</h5>
<blockquote>
<p>122456</p>
</blockquote>
<ul><li>首先先查询总成绩，以SId进行分组，并进行排序</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
<span class="token keyword">AS</span> sum_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sum_score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\80ab57e446864f55aee4f6ed2a83151e.png" width="100%"/>
</div>
<p>*最后将上表作为t1表然后定义变量@i进行排名、@p、@q用来控制总分重复时不保留名次空缺</p>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>sum_score <span class="token keyword">AS</span> <span class="token string">'总分'</span>
        <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>sum_score 
        <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">'排名'</span>
        <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span>
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> 
  <span class="token keyword">AS</span> sum_score 
  <span class="token keyword">FROM</span> SC 
  <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> sum_score <span class="token keyword">DESC</span>
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\d1f2834002b54ac6a29306b237c04ba4.png" width="100%"/>
</div>
<hr/>
<h5><a id="221008585707060600_1408"></a>22.统计各科成绩各分数段人数：课程编号，课程名称，[100-85），[85-70），[70-60），[60-0）及所占百分</h5>
<blockquote>
<p>分析：<br/> 1、首先将SC表t1与Course表t2进行关联，并以CId进行分组<br/> 2、最后计算出各分段分数，显示出来</p>
</blockquote>
<ul><li>首先将SC表t1与Course表t2进行关联，并以CId进行分组</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname 
<span class="token keyword">FROM</span> 
   SC t1 <span class="token keyword">JOIN</span> Course t2 
   <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e1f912332f12431e8c2a3a147c05d735.png" width="100%"/>
</div>
<ul><li>最后计算出各分段分数，显示出来</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score<span class="token operator">&lt;=</span><span class="token number">100</span> <span class="token operator">AND</span> score<span class="token operator">&gt;</span><span class="token number">85</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'[100-85)'</span>
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score<span class="token operator">&lt;=</span><span class="token number">85</span> <span class="token operator">AND</span> score<span class="token operator">&gt;</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'[85-70)'</span>
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score<span class="token operator">&lt;=</span><span class="token number">70</span> <span class="token operator">AND</span> score<span class="token operator">&gt;</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'[70-60)'</span>
       <span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>score<span class="token operator">&lt;=</span><span class="token number">60</span> <span class="token operator">AND</span> score<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"%"</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'[60-0)'</span>
<span class="token keyword">FROM</span> 
   SC t1 <span class="token keyword">JOIN</span> Course t2 
   <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\f5cc1863a1d44a1fb43d5b4d9ebf6e45.png" width="100%"/>
</div>
<hr/>
<h5><a id="23_1442"></a>23.查询各科成绩前三名的记录</h5>
<blockquote>
<p>分析：<br/> 1、首先查出各科成绩并进行排序<br/> 2、然后将上表作为t1表定义@i控制排序,@q、@p控制重复时保留空缺<br/> 3、最后将上表作为tt1表与Student表tt2进行关联去除各科成绩排名前三的记录</p>
</blockquote>
<ul><li>首先查出各科成绩并进行排序</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId
       <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\b71edd84026340aabe9e9a6bb50bad24.png" width="100%"/>
</div>
<ul><li>然后将上表作为t1表定义@i控制排序,@q、@p控制重复时保留空缺</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">FROM</span> SC
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1

</code></pre>
<div align="center">
<img height="100%/" src="image\dc350262d3ca48f48eaa820dffb8ec8e.png" width="100%"/>
</div>
<ul><li>最后将上表作为tt1表与Student表tt2进行关联去除各科成绩排名前三的记录</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> tt1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">FROM</span> SC
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1<span class="token punctuation">)</span> tt1 <span class="token keyword">JOIN</span> Student tt2
<span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>rn<span class="token operator">&lt;=</span><span class="token number">3</span> <span class="token operator">AND</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>rn<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\8ebbd95f1510448798b2164e008a3d16.png" width="100%"/>
</div>
<hr/>
<h5><a id="24_1513"></a>24.查询每门课程被选修的学生数</h5>
<blockquote>
<p>分析：<br/> 以CId进行分组查询出每门课程被选修的学生数</p>
</blockquote>
<ul><li>以CId进行分组查询出每门课程被选修的学生数</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CId<span class="token punctuation">)</span> 
<span class="token keyword">AS</span> cnt 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\3a563d6c3cc34a2e8a3737a0b42cc6f9.png" width="100%"/>
</div>
<hr/>
<h5><a id="25_1529"></a>25.查询出只选修两门课程的学生学号和姓名</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出选修两门课程的学生课程和学号<br/> 2、然后将上表作为t1表与Studen表t2关联取出学生姓名，找出结果</p>
</blockquote>
<ul><li>首先查询出选修两门课程的学生课程和学号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
<span class="token keyword">HAVING</span> cnt <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\27f1129d01e54244a07c8cb5e9c4a5d2.png" width="100%"/>
</div>
<ul><li>然后将上表作为t1表与Studen表t2关联取出学生姓名，找出结果</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
          <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> cnt 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId 
   <span class="token keyword">HAVING</span> cnt <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\03a5e1531f7f428a85b69b922b61d5a6.png" width="100%"/>
</div>
<hr/>
<h5><a id="26_1562"></a>26.查询男生、女生人数</h5>
<blockquote>
<p>分析：<br/> 以性别分组分别求出男生、女生的人数</p>
</blockquote>
<ul><li>以性别分组分别求出男生、女生的人数</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> Ssex
<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> Student 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Ssex<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\9001aba4efb34c3da3482fec9f73fd81.png" width="100%"/>
</div>
<hr/>
<h5><a id="27_1577"></a>27.查询名字中含有「风」字的学生信息</h5>
<blockquote>
<p>分析：<br/> 使用 LIKE 模糊查询名字中含有「风」字的学生信息</p>
</blockquote>
<ul><li>使用 LIKE 模糊查询名字中含有「风」字的学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student <span class="token keyword">WHERE</span> Sname <span class="token operator">LIKE</span> <span class="token string">'%风%'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e696aed0860d429ca64f9e8266844c49.png" width="100%"/>
</div>
<div align="center">
<img height="100%/" src="image\15e00767d9164f518759983dfec8b8d7.png" width="100%"/>
</div>
<p>通过观察发现并不存在名字中含有凤字的学生信息</p>
<hr/>
<h5><a id="28_1593"></a>28.查询同名同性学生名单，并统计同名同性人数</h5>
<blockquote>
<p>分析：<br/> 以学生姓名，性别分组，然后count出同名同性的人数</p>
</blockquote>
<ul><li>以学生姓名，性别分组，然后count出同名同性的人数</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> Sname
       <span class="token punctuation">,</span>Ssex
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> 
<span class="token keyword">AS</span> cnt 
<span class="token keyword">FROM</span> Student 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Sname<span class="token punctuation">,</span>Ssex 
<span class="token keyword">HAVING</span> cnt <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\522cc8d578a74aae89d68c82a7318fc2.png" width="100%"/>
</div>
<hr/>
<h5><a id="29_1990__1611"></a>29.查询 1990 年出生的学生名单</h5>
<blockquote>
<p>分析：该题有两种解法<br/> 1、使用LIKE模糊查询<br/> 2、使用BETWEEN…AND…查询</p>
</blockquote>
<ul><li>使用LIKE模糊查询</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student 
<span class="token keyword">WHERE</span> Sage 
<span class="token operator">LIKE</span> <span class="token string">'1990%'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\0a86d1d492534ed29e0ae91bf28bd055.png" width="100%"/>
</div>
<ul><li>使用BETWEEN…AND…查询</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Student 
<span class="token keyword">WHERE</span> Sage 
<span class="token operator">BETWEEN</span> <span class="token string">'1990-1-1'</span> <span class="token operator">AND</span> <span class="token string">'1990-12-31'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a1f4dc6898824029a8582f558d152e14.png" width="100%"/>
</div>
<hr/>
<h5><a id="30_1636"></a>30.查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</h5>
<blockquote>
<p>分析：<br/> 1、将SC表与Course表做关联查询出每门课程的平均分<br/> 2、最后将上表按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</p>
</blockquote>
<ul><li>将SC表与Course表做关联查询出每门课程的平均分</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  SC<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>Course<span class="token punctuation">.</span>Cname
        <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>SC<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span> SC 
<span class="token keyword">JOIN</span> Course 
<span class="token keyword">ON</span> SC<span class="token punctuation">.</span>CId <span class="token operator">=</span> Course<span class="token punctuation">.</span>CId 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SC<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>Course<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\186912d79c594002a7d73d2be9cd7f0a.png" width="100%"/>
</div>
<ul><li>最后将上表按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  SC<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>Course<span class="token punctuation">.</span>Cname
        <span class="token punctuation">,</span><span class="token function">AVG</span><span class="token punctuation">(</span>SC<span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score
<span class="token keyword">FROM</span> SC 
<span class="token keyword">JOIN</span> Course 
<span class="token keyword">ON</span> SC<span class="token punctuation">.</span>CId <span class="token operator">=</span> Course<span class="token punctuation">.</span>CId 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SC<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>Course<span class="token punctuation">.</span>Cname
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> avg_score <span class="token keyword">DESC</span><span class="token punctuation">,</span>SC<span class="token punctuation">.</span>CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\2137e103ec6c4c2daca91550cb2f7199.png" width="100%"/>
</div>
<hr/>
<h5><a id="31_85__1669"></a>31.查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出成绩大于等于85的平均成绩的课程信息<br/> 2、然后将上表作为t1表与Studen表t2做关联取出学生信息</p>
</blockquote>
<ul><li>首先查询出成绩大于等于85的平均成绩的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId
<span class="token keyword">HAVING</span> avg_score<span class="token operator">&gt;=</span><span class="token number">85</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\09c96a02df3347aa9f59971caf0dc997.png" width="100%"/>
</div>
<ul><li>然后将上表作为t1表与Studen表t2做关联取出学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>avg_score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> SId
          <span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> avg_score 
   <span class="token keyword">FROM</span> SC 
   <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId
   <span class="token keyword">HAVING</span> avg_score<span class="token operator">&gt;=</span><span class="token number">85</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\184fb5987a824d8fab6721135db2b781.png" width="100%"/>
</div>
<hr/>
<h5><a id="32_60__1703"></a>32.查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出课程名为数学的CId<br/> 2、然后再将上表作为字表查询出课程名为数学，且分数低于60的课程信息<br/> 3、最后将上表作为表t1与Student表t2做关联取出学生信息</p>
</blockquote>
<ul><li>首先查询出课程名为数学的CId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  CId
<span class="token keyword">FROM</span> Course 
<span class="token keyword">WHERE</span> CName <span class="token operator">=</span> <span class="token string">'数学'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\b06fa3b333ac4f9288350462d9c0bb6a.png" width="100%"/>
</div>
<ul><li>然后再将上表作为字表查询出课程名为数学，且分数低于60的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>Score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> CId <span class="token operator">=</span><span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span>  CId
      <span class="token keyword">FROM</span> Course 
      <span class="token keyword">WHERE</span> CName <span class="token operator">=</span> <span class="token string">'数学'</span>
<span class="token punctuation">)</span><span class="token operator">AND</span> score<span class="token operator">&lt;</span><span class="token number">60</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c14c3bc54c384d31a96ec85e8ac7cdd2.png" width="100%"/>
</div>
<ul><li>最后将上表作为表t1与Student表t2做关联取出学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>Score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>Score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> CId <span class="token operator">=</span><span class="token punctuation">(</span>
      <span class="token keyword">SELECT</span>  CId
      <span class="token keyword">FROM</span> Course 
      <span class="token keyword">WHERE</span> CName <span class="token operator">=</span> <span class="token string">'数学'</span>
<span class="token punctuation">)</span><span class="token operator">AND</span> score<span class="token operator">&lt;</span><span class="token number">60</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\198370531b1f4b4f9c225960ebc4ba18.png" width="100%"/>
</div>
<hr/>
<h5><a id="33_1752"></a>33.查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出所有课程的分数，并以SId分组（存在学生没成绩，没选课的情况为0分）<br/> 2、然后将Student表t1与上表作为表t2做左连接，取出学生姓名</p>
</blockquote>
<ul><li>首先查询出所有课程的分数，并以SId分组（存在学生没成绩，没选课的情况为0分）</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  SId
        <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'01'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'语文成绩'</span>
        <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'02'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'数学成绩'</span>
        <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'03'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'英语成绩'</span>
<span class="token keyword">FROM</span> SC
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\164e7c55bfcd4c21a8d15757f31f6e77.png" width="100%"/>
</div>
<ul><li>然后将Student表t1与上表作为表t2做左连接，取出学生姓名</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>语文成绩
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>数学成绩
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>英语成绩 
<span class="token keyword">FROM</span>
Student t1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span>  SId
           <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'01'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'语文成绩'</span>
        <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'02'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'数学成绩'</span>
        <span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">CASE</span> CId <span class="token keyword">WHEN</span> <span class="token string">'03'</span> <span class="token keyword">THEN</span> score <span class="token keyword">ELSE</span> <span class="token number">0</span> <span class="token keyword">END</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'英语成绩'</span>
        <span class="token keyword">FROM</span> SC
        <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId
<span class="token punctuation">)</span> t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1c77c8b6a47d4660a5227b6218baabb7.png" width="100%"/>
</div>
<hr/>
<h5><a id="34_70__1790"></a>34.查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出成绩在70分以上的课程信息<br/> 2、然后再将上表作为t1表与Student表t2关联，再与Course表t3做关联取出任何一门课程成绩在 70 分以上的姓名、课程名称和分数信息</p>
</blockquote>
<ul><li>首先查询出成绩在70分以上的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  SId
        <span class="token punctuation">,</span>CId
        <span class="token punctuation">,</span>score
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> score<span class="token operator">&gt;</span><span class="token number">70</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a4ca0b4000a041079bcc071fab5f36b3.png" width="100%"/>
</div>
<ul><li>然后再将上表作为t1表与Student表t2关联，再与Course表t3做关联取出任何一门课程成绩在 70 分以上的姓名、课程名称和分数信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>Cname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>Score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span>  SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score
   <span class="token keyword">FROM</span> SC
   <span class="token keyword">WHERE</span> score<span class="token operator">&gt;</span><span class="token number">70</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span> SId
<span class="token keyword">JOIN</span> Course t3
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t3<span class="token punctuation">.</span>CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\f9886a03318c461e846a42368ff8ec41.png" width="100%"/>
</div>
<hr/>
<h5><a id="35_1826"></a>35.查询不及格的课程</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出成绩低于60分的课程信息<br/> 2、然后将上表作为表t1与Student表t2表做连接，再与Course表t3做连接，找出不及格课程的学生、课程编号、课程名称、成绩</p>
</blockquote>
<ul><li>首先查询出成绩低于60分的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> CId
                <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC 
<span class="token keyword">WHERE</span> score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\fc1252ed991f496cb95f1c5e6cbb9bb5.png" width="100%"/>
</div>
<p>*然后将上表作为表t1与Student表t2表做连接，再与Course表t3做连接，找出不及格课程的学生、课程编号、课程名称、成绩</p>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  <span class="token keyword">DISTINCT</span> 
        t2<span class="token punctuation">.</span>Sname
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>t3<span class="token punctuation">.</span>CName
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> SId
           <span class="token punctuation">,</span>CId
           <span class="token punctuation">,</span>score
    <span class="token keyword">FROM</span> SC
    <span class="token keyword">WHERE</span> score<span class="token operator">&lt;</span><span class="token number">60</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId
<span class="token keyword">JOIN</span> Course t3
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t3<span class="token punctuation">.</span>CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\edf01f22f46842d699d7f08c9f9aafc1.png" width="100%"/>
</div>
<hr/>
<h5><a id="36_01__80__1863"></a>36.查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出课程编号为01且课程成绩在80分以上的课程信息<br/> 2、然后将上表作为表t1与Student表t2做关联，取出学生的学号和姓名</p>
</blockquote>
<ul><li>首先查询出课程编号为01且课程成绩在80分以上的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>score
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span> 
<span class="token operator">AND</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\b21c8652b6f044688044e0f5a5e05667.png" width="100%"/>
</div>
<ul><li>然后将上表作为表t1与Student表t2做关联，取出学生的学号和姓名</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>score
  <span class="token keyword">FROM</span> SC
  <span class="token keyword">WHERE</span> CId <span class="token operator">=</span> <span class="token string">'01'</span> 
  <span class="token operator">AND</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span>
<span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\ba3824628b4f498eab4f4ea8f34715d9.png" width="100%"/>
</div>
<hr/>
<h5><a id="37_1896"></a>37.求每门课程的学生人数</h5>
<ul><li>将SC表t1与Course表t2做关联，并按CId分组，取出课程号、课程名称、每门课程</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>cname
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'人数'</span>
<span class="token keyword">FROM</span> SC t1 <span class="token keyword">JOIN</span> Course t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>CId <span class="token operator">=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Cname<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1a282cba5dfa4975985ac6785720d876.png" width="100%"/>
</div>
<hr/>
<h5><a id="38_1911"></a>38.成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先查询张三老师所授的课程TId<br/> 2、然后在Course表中查询张三老师所授课程的课程编号CId<br/> 3、再在SC表查询，成绩不重复的课程信息<br/> 4、然后将成绩降序排列取出第一个成绩LIMIT 1，即是最高成绩<br/> 5、最后将上表作为t1表与Student表t2连接，取出成绩最高的学生信息</p>
</blockquote>
<ul><li>首先查询张三老师所授的课程TId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> TId 
<span class="token keyword">FROM</span> Teacher 
<span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\45449886f7eb414a9a6f5584821262ef.png" width="100%"/>
</div>
<ul><li>然后在Course表中查询张三老师所授课程的课程编号CId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> Course 
<span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> TId 
   <span class="token keyword">FROM</span> Teacher 
   <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\349a161924ce4cadbd1bbac6cbdda701.png" width="100%"/>
</div>
<ul><li>再在SC表查询，成绩不重复的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId
       <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\805ebe2202b54e1e8fd5ef8e603d5104.png" width="100%"/>
</div>
<ul><li>然后将成绩降序排列取出第一个成绩LIMIT 1，即是最高成绩</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId
       <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score
<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\edbe6d6aa4ee4c59838144173cb297d5.png" width="100%"/>
</div>
<ul><li>最后将上表作为t1表与Student表t2连接，取出成绩最高的学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId
         <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score
<span class="token keyword">LIMIT</span> <span class="token number">1</span><span class="token punctuation">)</span> t1 <span class="token keyword">JOIN</span> Student t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\5e5ebc7d0caf4c458cb49c8037db7cda.png" width="100%"/>
</div>
<hr/>
<h5><a id="39_2007"></a>39.成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先查询张三老师所授的课程TId<br/> 2、然后在Course表中查询张三老师所授课程的课程编号CId<br/> 3、再在SC表查询，成绩不重复的课程信息，并降序排列<br/> 4、将上表作为表t1再定义@i、@p、@q三个变量@i控制排序，@p、@q控制分数重复保留名次<br/> 5、然后将上表作为tt1表与Student表tt2做连接，取出最高分成绩，以及学生信息</p>
</blockquote>
<ul><li>首先查询张三老师所授的课程TId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> TId 
<span class="token keyword">FROM</span> Teacher 
<span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\45449886f7eb414a9a6f5584821262ef.png" width="100%"/>
</div>
<ul><li>然后在Course表中查询张三老师所授课程的课程编号CId</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId 
<span class="token keyword">FROM</span> Course 
<span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> TId 
   <span class="token keyword">FROM</span> Teacher 
   <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\349a161924ce4cadbd1bbac6cbdda701.png" width="100%"/>
</div>
<ul><li>再在SC表查询，成绩不重复的课程信息，并降序排列</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>CId
       <span class="token punctuation">,</span>score 
<span class="token keyword">FROM</span> SC
<span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\ac64bb1de54b491bb5c5e3a8cb5e894b.png" width="100%"/>
</div>
<ul><li>将上表作为表t1再定义@i、@p、@q三个变量@i控制排序，@p、@q控制分数重复保留名次</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> dense_rank
        <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span>
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId
         <span class="token punctuation">,</span>score 
  <span class="token keyword">FROM</span> SC
  <span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> 
<span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\c5630790442242c89630aadc0f51c75b.png" width="100%"/>
</div>
<ul><li>然后将上表作为tt1表与Student表tt2做连接，取出最高分成绩，以及学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> tt2<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>SId
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score 
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
          <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
          <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
          <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>score
          <span class="token punctuation">,</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> dense_rank
          <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span><span class="token variable">@p</span>
  <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId
         <span class="token punctuation">,</span>CId
         <span class="token punctuation">,</span>score 
  <span class="token keyword">FROM</span> SC
  <span class="token keyword">WHERE</span> CId <span class="token operator">IN</span> 
<span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> CId 
   <span class="token keyword">FROM</span> Course 
   <span class="token keyword">WHERE</span> TId <span class="token operator">=</span> <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span> TId 
     <span class="token keyword">FROM</span> Teacher 
     <span class="token keyword">WHERE</span> Tname <span class="token operator">=</span> <span class="token string">'张三'</span>
   <span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> score <span class="token keyword">DESC</span><span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> tt1 <span class="token keyword">JOIN</span> Student tt2
<span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>dense_rank <span class="token operator">=</span> <span class="token number">1</span> 
<span class="token operator">AND</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\6ecf2aecaf9b40888236b4d39a5c82da.png" width="100%"/>
</div>
<hr/>
<h5><a id="40_2125"></a>40.查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</h5>
<blockquote>
<p>分析：<br/> 1、首先现将SC表t1与自己SC表t2进行关联，取出成绩相同的学生编号、课程编号、学生成绩<br/> 2、然后再与Student表t3进行关联取出学生信息</p>
</blockquote>
<ul><li>首先现将SC表t1与自己SC表t2进行关联，取出成绩相同的学生编号、课程编号、学生成绩</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> SC t1 <span class="token keyword">JOIN</span> SC t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>score <span class="token operator">=</span> t2<span class="token punctuation">.</span>score 
<span class="token operator">AND</span> t1<span class="token punctuation">.</span>CId <span class="token operator">!=</span> t2<span class="token punctuation">.</span>CId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\7c5334749d614b329b8c91eeab89d476.png" width="100%"/>
</div>
<ul><li>然后再与Student表t3进行关联取出学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> t3<span class="token punctuation">.</span>Sname
       <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
       <span class="token punctuation">,</span>t2<span class="token punctuation">.</span>score
<span class="token keyword">FROM</span> SC t1 <span class="token keyword">JOIN</span> SC t2
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>score <span class="token operator">=</span> t2<span class="token punctuation">.</span>score 
<span class="token operator">AND</span> t1<span class="token punctuation">.</span>CId <span class="token operator">!=</span> t2<span class="token punctuation">.</span>CId
<span class="token keyword">JOIN</span> Student t3
<span class="token keyword">ON</span> t1<span class="token punctuation">.</span>SId <span class="token operator">=</span> t3<span class="token punctuation">.</span>SId<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\212210ed9409404485d634632a9d265a.png" width="100%"/>
</div>
<hr/>
<h5><a id="41_2156"></a>41.查询每门课程成绩最好的前两名</h5>
<blockquote>
<p>分析：<br/> 1、首先在SC表中查询出每门课程的成绩并按CId分数降序排列<br/> 2、定义函数@i、@p、@q，按每门课程的成绩进行排序，并将上表作为t1表，然后再作为tt1表与Student表tt2进行连接取出每名课程成绩最好的前两名</p>
</blockquote>
<ul><li>首先在SC表中查询出每门课程的成绩并按CId分数降序排列</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
        <span class="token punctuation">,</span>CId
        <span class="token punctuation">,</span>score
<span class="token keyword">FROM</span> SC
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\fc9478c2e20d4d20a70c6b0794667430.png" width="100%"/>
</div>
<ul><li>定义函数@i、@p、@q，按每门课程的成绩进行排序，并将上表作为t1表，然后再作为tt1表与Student表tt2进行连接取出每名课程成绩最好的前两名</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SET</span> <span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@p</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span>  tt1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>tt2<span class="token punctuation">.</span>SName
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>CId
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>score
        <span class="token punctuation">,</span>tt1<span class="token punctuation">.</span>rn
<span class="token keyword">FROM</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>score
            <span class="token punctuation">,</span><span class="token variable">@p</span> :<span class="token operator">=</span> t1<span class="token punctuation">.</span>CId
            <span class="token punctuation">,</span><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">@p</span><span class="token operator">=</span><span class="token variable">@q</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span> <span class="token variable">@i</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">@i</span> :<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> rn
            <span class="token punctuation">,</span><span class="token variable">@q</span> :<span class="token operator">=</span> <span class="token variable">@p</span>
    <span class="token keyword">FROM</span> <span class="token punctuation">(</span>
        <span class="token keyword">SELECT</span>  SId
                <span class="token punctuation">,</span>CId
                <span class="token punctuation">,</span>score
        <span class="token keyword">FROM</span> SC
        <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> CId<span class="token punctuation">,</span>score <span class="token keyword">DESC</span>
    <span class="token punctuation">)</span> t1
<span class="token punctuation">)</span> tt1 <span class="token keyword">JOIN</span> Student tt2 <span class="token keyword">ON</span> tt1<span class="token punctuation">.</span>rn<span class="token operator">&lt;=</span><span class="token number">2</span> <span class="token operator">AND</span> tt1<span class="token punctuation">.</span>SId <span class="token operator">=</span> tt2<span class="token punctuation">.</span>SId
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> tt1<span class="token punctuation">.</span>CId<span class="token punctuation">,</span>rn<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e49ac3094a5d45c8b8a2efc7096a3fed.png" width="100%"/>
</div>
<hr/>
<h5><a id="42_5__2204"></a>42.统计每门课程的学生选修人数（超过 5 人的课程才统计）。</h5>
<blockquote>
<p>分析：<br/> 1、以CId进行分组，统计出超过5人的课程信息</p>
</blockquote>
<ul><li>以CId进行分组，统计出超过5人的课程信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> CId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>SId<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'选课人数'</span>
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> CId
<span class="token keyword">HAVING</span> 选课人数 <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\1680643ef1b24bba984d97485e3adf0f.png" width="100%"/>
</div>
<hr/>
<h5><a id="43_2220"></a>43.检索至少选修两门课程的学生学号</h5>
<blockquote>
<p>分析：<br/> 1、以SId进行分组，统计出至少选修两门课程的学生学号</p>
</blockquote>
<ul><li>以SId进行分组，统计出至少选修两门课程的学生学号</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>CID<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'选课数量'</span>
<span class="token keyword">FROM</span> SC 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> SId
<span class="token keyword">HAVING</span> 选课数量 <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\edc25bdea2fc4005a7424087323185a3.png" width="100%"/>
</div>
<hr/>
<h5><a id="44_2236"></a>44.查询选修了全部课程的学生信息</h5>
<blockquote>
<p>分析：<br/> 1、首先查询出总课程属性作为表t3<br/> 2、然后将Student表t1与SC表t2进行关联，以SId、Sname进行分组，用表t3筛选出选修了全部课程的学生信息</p>
</blockquote>
<ul><li>首先查询出总课程属性作为表t3</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> 
<span class="token keyword">FROM</span> Course t3<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\a7918af9b03c446a9e2fe4e04f810c13.png" width="100%"/>
</div>
<ul><li>然后将Student表t1与SC表t2进行关联，以SId、Sname进行分组，用表t3筛选出选修了全部课程的学生信息</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>  t1<span class="token punctuation">.</span>SId
        <span class="token punctuation">,</span>t1<span class="token punctuation">.</span>Sname
        <span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token string">'选课数量'</span>
<span class="token keyword">FROM</span> Student t1 <span class="token keyword">JOIN</span> SC t2
<span class="token keyword">ON</span> t2<span class="token punctuation">.</span>SId <span class="token operator">=</span> t1<span class="token punctuation">.</span>SId
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> t1<span class="token punctuation">.</span>SId<span class="token punctuation">,</span>t1<span class="token punctuation">.</span>Sname
<span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
   <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>t3<span class="token punctuation">.</span>CId<span class="token punctuation">)</span> 
   <span class="token keyword">FROM</span> Course t3
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\e667efd073bf4ef78339f42ce28a7d0f.png" width="100%"/>
</div>
<hr/>
<h5><a id="45_2266"></a>45.查询各学生的年龄，只按年份来算</h5>
<blockquote>
<p>分析：拿当前日期减去学生出生日期</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> date_format<span class="token punctuation">(</span>Sage<span class="token punctuation">,</span><span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> Student<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\0e0001f2517245c5b49de0bb28a934a0.png" width="100%"/>
</div>
<hr/>
<h5><a id="46___2275"></a>46.按照出生日期来算，当前月日 &lt; 出生年月的月日，则年龄减一</h5>
<blockquote>
<p>分析：<br/> 1、首先先在Student表中查询出出生日期、当前月日、出生年月的月日<br/> 2、然后将上表作为表t1，计算出当前月日 &lt; 出生年月的月日，则年龄减一</p>
</blockquote>
<ul><li>首先先在Student表中查询出出生日期、当前月日、出生年月的月日</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId 
       <span class="token punctuation">,</span>Sname
       <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> date_format<span class="token punctuation">(</span>Sage<span class="token punctuation">,</span><span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> age
       <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>Sage<span class="token punctuation">,</span><span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> month_day
       <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> now_month_day
<span class="token keyword">FROM</span> Student<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\2a44a47d1eb54e509fe7953d36668e72.png" width="100%"/>
</div>
<ul><li>然后将上表作为表t1，计算出当前月日 &lt; 出生年月的月日，则年龄减一</li></ul>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId 
       <span class="token punctuation">,</span>SName
       <span class="token punctuation">,</span><span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> now_month_day<span class="token operator">&lt;</span>month_day <span class="token keyword">THEN</span> age<span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">ELSE</span> age <span class="token keyword">END</span> <span class="token keyword">AS</span> new_age
       <span class="token punctuation">,</span>age
<span class="token keyword">FROM</span><span class="token punctuation">(</span>
  <span class="token keyword">SELECT</span> SId 
         <span class="token punctuation">,</span>Sname
         <span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> date_format<span class="token punctuation">(</span>Sage<span class="token punctuation">,</span><span class="token string">'%Y'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> age
         <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span>Sage<span class="token punctuation">,</span><span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> month_day
         <span class="token punctuation">,</span>date_format<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'%m-%d'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> now_month_day
<span class="token keyword">FROM</span> Student
<span class="token punctuation">)</span> t1<span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\556edea58a6c4d479e7e5118e198b202.png" width="100%"/>
</div>
<hr/>
<h5><a id="47_2311"></a>47.查询本周过生日的学生</h5>
<blockquote>
<p>分析：查询当前周与表中的周数是否相等即可</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>SName
       <span class="token punctuation">,</span>Sage
       <span class="token punctuation">,</span>WEEK<span class="token punctuation">(</span>Sage<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> WEEK<span class="token punctuation">(</span>Sage<span class="token punctuation">)</span> <span class="token operator">=</span> WEEK<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\ddfc44c06b8249e1aa9b86168671438c.png" width="100%"/>
</div>
<blockquote>
<p>本周没人过生日所以没有数据</p>
</blockquote>
<hr/>
<h5><a id="48_2327"></a>48.查询下周过生日的学生</h5>
<blockquote>
<p>分析：查询当前周+1与表中的周数是否相等即可</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>SName
       <span class="token punctuation">,</span>Sage
       <span class="token punctuation">,</span>WEEK<span class="token punctuation">(</span>Sage<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> WEEK<span class="token punctuation">(</span>Sage<span class="token punctuation">)</span> <span class="token operator">=</span> WEEK<span class="token punctuation">(</span>date_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">INTERVAL</span> <span class="token number">1</span> WEEK<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\b47735841e7f4dc08c76c076a5517884.png" width="100%"/>
</div>
<blockquote>
<p>下一周没人过生日所以没有数据</p>
</blockquote>
<hr/>
<h5><a id="49_2343"></a>49.查询本月过生日的学生</h5>
<blockquote>
<p>分析：查询当前月与表中的月数是否相等即可</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>SName
       <span class="token punctuation">,</span>Sage
       <span class="token punctuation">,</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span>Sage<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>Sage<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\b6c5d0236bf94678a459d0e357d1c249.png" width="100%"/>
</div>
<hr/>
<h5><a id="50_2357"></a>50.查询下月过生日的学生</h5>
<blockquote>
<p>分析：查询当前月+1与表中的月数是否相等即可</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> SId
       <span class="token punctuation">,</span>SName
       <span class="token punctuation">,</span>Sage
       <span class="token punctuation">,</span><span class="token keyword">MONTH</span><span class="token punctuation">(</span>Sage<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> Student
<span class="token keyword">WHERE</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>Sage<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span>date_add<span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">MONTH</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<div align="center">
<img height="100%/" src="image\18f38c0fba474912a8fb9ebb825c4e3d.png" width="100%"/>
</div>
<blockquote>
<p>下一月没人过生日所以没有数据</p>
</blockquote>
<hr/>
<blockquote>
<p>week()函数参见下列网址</p>
<p>https://blog.csdn.net/moakun/article/details/82528773</p>
<p>date_format()函数参见下列网址</p>
<p>https://www.w3school.com.cn/sql/func_date_format.asp</p>
</blockquote>
<hr/>
<p>**终于到底啦！这篇是全网最细最详细解析，编了5w5q字，靓仔不容易，关注一下吧！**💖</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>