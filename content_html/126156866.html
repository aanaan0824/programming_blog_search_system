<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-dracula" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#reactredux_7">⭐react-redux基本使用</a></li><li><ul><li><a href="#_reactredux_207">⛳求和案例_react-redux基本使用总结</a></li></ul>
</li><li><a href="#1mapDispatch_225">⭐优化1：简写mapDispatch</a></li><li><a href="#2Provider_350">⭐优化2：Provider组件的使用</a></li><li><a href="#3UI_397">⭐优化3：整合UI组件与容器组件</a></li><li><ul><li><a href="#_reactredux_479">⛳求和案例_react-redux优化总结</a></li></ul>
</li></ul>
</div>
<p></p>
<blockquote>
<p>上篇文章<a href="https://blog.csdn.net/xuxuii/article/details/125968311?spm=1001.2014.3001.5502">初步了解和学习了react-redux的原理和组件拆分</a><br/> 今天探索一下react-redux基本使用以及对求和案例的代码优化<br/> 感兴趣的小伙伴一起来看看吧！🤞</p>
</blockquote>
<p><img alt="在这里插入图片描述" height="70%" src="https://img-blog.csdnimg.cn/b5a34355dbdd47c8b596191cf3d5d13c.jpeg#pic_center" width="70%"/></p>
<h1><a id="reactredux_7"></a>⭐react-redux基本使用</h1>
<p>依旧对求和案例进行分析：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/59420a2fb0304f6ba829054dac93b119.jpeg#pic_center"/></p>
<p>根据react-redux模型图，实现了Count的容器组件与Count的UI组件的联系，接下来要实现容器组件给UI组件传递 redux中所保存的状态以及操作状态的方法，要<code>借助props</code>。</p>
<p>但是不能像原先父子组件传参利用标签的方式传递，比如：</p>
<pre><code class="prism language-js"><span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token constant">B</span> a<span class="token operator">=</span><span class="token string">'1'</span> b<span class="token operator">=</span><span class="token string">'2'</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre>
<p><strong>那么如何在容器组件（父组件）向UI组件传递参数呢？</strong></p>
<blockquote>
<p>由于父子组件关系是靠connect形成的，所以connect函数在第一次调用的时候<strong>要传入两个参数</strong>，参数必须是<strong>函数类型</strong>的，这样react-redux库就帮你调用这两个函数，一个函数返回值作为状态，另一个函数返回值作为操作状态的方法。</p>
</blockquote>
<pre><code class="prism language-js"><span class="token comment">// react-redux API默认要给connect两个函数作为参数，两个函数会收到来至redux传来的值和方法。</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span>
</code></pre>
<p>mapStateToProps()函数的<strong>返回值</strong>作为 <code>状态</code> 传递给了UI组件，函数返回的是一个对象，mapStateToProps函数<strong>返回的对象中的key</strong>就作为传递给UI组件props的key，value就作为传递给UI组件props的value。</p>
<blockquote>
<p>由于要获取redux里的状态，就要store.getState()，就要在容器组件里引入store，但是之前已经在上层App.jsx里向容器组件传了store，就不需要自己引入了，这里也不需要我们自己去获取状态，<strong>react-redux帮我们调mapStateToProps()函数时，已经帮我们把状态传过去了</strong>，只需要<strong>mapStateToProps(state)接收一下</strong>即可。</p>
</blockquote>
<pre><code class="prism language-js"><span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这样UI组件就可以通过 this.props 接收到 <strong>状态</strong>：</p>
<pre><code class="prism language-js"><span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前求和为：<span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
</code></pre>
<hr/>
<p>mapDispatchToProps()函数的<strong>返回值</strong>作为 <code>操作状态的方法</code> 传递给了UI组件，函数返回的是一个对象，mapDispatchToProps函数返回的对象中的key就作为传递给UI组件props的key，value就作为传递给UI组件props的value。</p>
<blockquote>
<p>由于要实现加这个运算，就要在jia这个回调函数里通知redux执行加法，就要调用store.dispatch(action)这个方法，这里又要引入store操作状态，但是这里也不需要store调用dispatch方法，<strong>react-redux帮我们把dispatch()方法传过去了</strong>，直接用即可。</p>
</blockquote>
<pre><code class="prism language-js"><span class="token comment">// 引入action</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  createIncrementAction<span class="token punctuation">,</span>
  createDecrementAction<span class="token punctuation">,</span>
  createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span>
<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">jia</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通知redux执行加法</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jian</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通知redux执行减法</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jiaAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通知redux执行异步加法</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这样UI组件就可以通过 this.props 接收到 <strong>操作状态的方法</strong>：</p>
<pre><code class="prism language-js"><span class="token comment">// 加法</span>
<span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 获取用户输入</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
  <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 减法</span>
<span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 获取用户输入</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
  <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jian</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 奇数再加</span>
<span class="token function-variable function">incrementIfOdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 获取用户输入</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 异步加</span>
<span class="token function-variable function">incrementAsync</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 获取用户输入</span>
  <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
  <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jiaAsync</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<hr/>
<p><code>src=&gt; components=&gt; Count =&gt; index.jsx：</code></p>
<pre><code class="prism language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{<!-- --></span>

  <span class="token comment">// 加法</span>
  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取用户输入</span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 减法</span>
  <span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取用户输入</span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jian</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 奇数再加</span>
  <span class="token function-variable function">incrementIfOdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取用户输入</span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 异步加</span>
  <span class="token function-variable function">incrementAsync</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取用户输入</span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jiaAsync</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// console.log('UI组件接收到的props是：', this.props)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前求和为：<span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>select ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber <span class="token operator">=</span> c<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"3"</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>decrement<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>incrementIfOdd<span class="token punctuation">}</span><span class="token operator">&gt;</span>当前求和为奇数再加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>incrementAsync<span class="token punctuation">}</span><span class="token operator">&gt;</span>异步加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>src=&gt; containers=&gt; Count =&gt; index.jsx：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 引入Count的UI组件</span>
<span class="token keyword">import</span> CountUI <span class="token keyword">from</span> <span class="token string">'../../components/Count'</span>
<span class="token comment">// 引入action</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  createIncrementAction<span class="token punctuation">,</span>
  createDecrementAction<span class="token punctuation">,</span>
  createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span>

<span class="token comment">// 引入connect用于连接UI组件与redux</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>

<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">jia</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通知redux执行加法</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jian</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jiaAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span>
</code></pre>
<h2><a id="_reactredux_207"></a>⛳求和案例_react-redux基本使用总结</h2>
<blockquote>
<p>1️⃣明确两个概念：</p>
<ul><li>UI组件：<strong>不能使用任何redux的api</strong>，只负责页面的呈现、交互等。</li><li>容器组件：<strong>负责和redux通信，将结果交给UI组件</strong>。</li></ul>
<p>2️⃣如何创建一个容器组件———依靠react-redux的connect函数</p>
<p><code>connect(mapStateToProps,mapDispatchToProps)(UI组件)</code></p>
<ul><li>mapStateToProps：映射状态，返回值是一个对象</li><li>mapDispatchToProps：映射操作状态的方法，返回值是一个对象</li></ul>
<p>3️⃣ 备注：<strong>容器组件中的store是靠props传进去的，而不是在容器组件中直接引入</strong>。</p>
</blockquote>
<h1><a id="1mapDispatch_225"></a>⭐优化1：简写mapDispatch</h1>
<p><code>优化前：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 映射状态</span>
<span class="token keyword">function</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>优化后：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 映射状态</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><code>优化前：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 映射操作状态的方法</span>
<span class="token keyword">function</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span><span class="token parameter">dispatch</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">jia</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 通知redux执行加法</span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jian</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jiaAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>优化后：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 映射操作状态的方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapDispatchToProps</span> <span class="token operator">=</span> <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token function-variable function">jia</span><span class="token operator">:</span> <span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jian</span><span class="token operator">:</span> <span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">jiaAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre>
<hr/>
<p><code>再优化后：</code></p>
<pre><code class="prism language-js"><span class="token comment">// 引入Count的UI组件</span>
<span class="token keyword">import</span> CountUI <span class="token keyword">from</span> <span class="token string">'../../components/Count'</span>
<span class="token comment">// 引入action</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  createIncrementAction<span class="token punctuation">,</span>
  createDecrementAction<span class="token punctuation">,</span>
  createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span>

<span class="token comment">// 引入connect用于连接UI组件与redux</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>

<span class="token comment">//使用connect()()创建并暴露一个Count的容器组件</span>
<span class="token comment">// react-redux API默认要给connect两个函数作为参数，两个函数会收到来至redux传来的值和方法。</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token punctuation">{<!-- --></span>
      <span class="token function-variable function">jia</span><span class="token operator">:</span> <span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    	<span class="token function-variable function">jian</span><span class="token operator">:</span> <span class="token parameter">number</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createDecrementAction</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    	<span class="token function-variable function">jiaAsync</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
    	<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createIncrementAsyncAction</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span>
</code></pre>
<p><strong>mapDispatchToProps的简写：</strong></p>
<pre><code class="prism language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// mapDispatchToProps的一般写法</span>
  <span class="token comment">// dispatch =&gt; (</span>
  <span class="token comment">//   {<!-- --></span>
  <span class="token comment">//     jia: number =&gt; dispatch(createIncrementAction(number)),</span>
  <span class="token comment">//     jian: number =&gt; dispatch(createDecrementAction(number)),</span>
  <span class="token comment">//     jiaAsync: (number, time) =&gt;</span>
  <span class="token comment">//       dispatch(createIncrementAsyncAction(number, time))</span>
  <span class="token comment">//   }</span>
  <span class="token comment">// )</span>

  <span class="token comment">// mapDispatchToProps的简写</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">jia</span><span class="token operator">:</span> createIncrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">jian</span><span class="token operator">:</span> createDecrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">jiaAsync</span><span class="token operator">:</span> createIncrementAsyncAction
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>CountUI<span class="token punctuation">)</span>
</code></pre>
<p><strong>分析mapDispatchToProps的简写</strong></p>
<pre><code class="prism language-js"><span class="token punctuation">{<!-- --></span>
  <span class="token literal-property property">jia</span><span class="token operator">:</span> createIncrementAction<span class="token punctuation">,</span>
  <span class="token literal-property property">jian</span><span class="token operator">:</span> createDecrementAction<span class="token punctuation">,</span>
  <span class="token literal-property property">jiaAsync</span><span class="token operator">:</span> createIncrementAsyncAction
<span class="token punctuation">}</span>
</code></pre>
<p>Count的UI组件里调用了jia函数，传递了用户选择的参数，然后在容器组件里调用了createIncrementAction方法，返回值是一个action对象，<code>react-redux帮我们自动dispatch</code>了。</p>
<blockquote>
<p>mapDispatchToProps可以写成<code>一个普通的函数</code>，也可以是<code>一个对象</code>。</p>
</blockquote>
<blockquote>
<p>react-redux还有一个优势：<strong>不用自己监测redux的状态是否发生了变化</strong>，内部的所有逻辑全部交给容器组件来完成，避免污染整个app组件。</p>
</blockquote>
<h1><a id="2Provider_350"></a>⭐优化2：Provider组件的使用</h1>
<p><code>App.jsx:</code></p>
<pre><code class="prism language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> Count <span class="token keyword">from</span> <span class="token string">'./containers/Count'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./redux/store'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{<!-- --></span><span class="token comment">/* 渲染容器组件，给容器组件传递store */</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>Count store<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>store<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>当项目中有多个容器组件时，每次都要给容器组件传递store，这样不太方便，所以：我们可以在<strong>index.js入口文件</strong>里引入react-redux里的一个API——<code>Provider</code>。</p>
<blockquote>
<p>把所有容器组件都需要的store交给Provider，Provider会自动分析整个项目里所有的容器组件，把store传给每一个需要store的容器组件。</p>
</blockquote>
<p><code>index.js:</code></p>
<pre><code class="prism language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom/client'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./redux/store'</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>

<span class="token comment">// 创建虚拟DOM</span>
<span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 渲染虚拟DOM到页面</span>
root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
    <span class="token punctuation">{<!-- --></span><span class="token comment">/* 检查App组件以及子组件里的一些代码是否有不合理的地方 */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre>
<h1><a id="3UI_397"></a>⭐优化3：整合UI组件与容器组件</h1>
<p>前面两个优化，我们分别从代码层面和API层面进行了优化。在这里，我们将在文件层面对UI组件和容器组件进行优化。</p>
<p>由于我们学习了react-redux库，要求为组件分别写成UI组件和容器组件。那么如果在整个应用中，有20个组件需要和redux打交道，那么我们就需要写40个组件…可想而知，这样写是不行的，我们可以作出一些优化：</p>
<blockquote>
<p>可以将<strong>UI组件和容器组件整合在同一个文件夹</strong>里。</p>
</blockquote>
<p><img alt="在这里插入图片描述" height="80%" src="https://img-blog.csdnimg.cn/f9a52a123a2d494f812d85a1af0ec413.png#pic_center" width="80%"/></p>
<p><code>/src/containers/Count/index.jsx:</code></p>
<pre><code class="prism language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// 引入action</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>
  createIncrementAction<span class="token punctuation">,</span>
  createDecrementAction<span class="token punctuation">,</span>
  createIncrementAsyncAction
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../redux/count_action'</span>
<span class="token comment">// 引入connect用于连接UI组件与redux</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>

<span class="token comment">// 定义UI组件</span>
<span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 加法</span>
  <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 减法</span>
  <span class="token function-variable function">decrement</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jian</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 奇数再加</span>
  <span class="token function-variable function">incrementIfOdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jia</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 异步加</span>
  <span class="token function-variable function">incrementAsync</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber
    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">jiaAsync</span><span class="token punctuation">(</span>value <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前求和为：<span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>select ref<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token parameter">c</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>selectNumber <span class="token operator">=</span> c<span class="token punctuation">}</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"1"</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"2"</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">"3"</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>decrement<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>incrementIfOdd<span class="token punctuation">}</span><span class="token operator">&gt;</span>当前求和为奇数再加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token keyword">this</span><span class="token punctuation">.</span>incrementAsync<span class="token punctuation">}</span><span class="token operator">&gt;</span>异步加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//使用connect()()创建并暴露一个Count的容器组件</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token literal-property property">count</span><span class="token operator">:</span> state <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// mapDispatchToProps的简写</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">jia</span><span class="token operator">:</span> createIncrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">jian</span><span class="token operator">:</span> createDecrementAction<span class="token punctuation">,</span>
    <span class="token literal-property property">jiaAsync</span><span class="token operator">:</span> createIncrementAsyncAction
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span>Count<span class="token punctuation">)</span>
</code></pre>
<h2><a id="_reactredux_479"></a>⛳求和案例_react-redux优化总结</h2>
<blockquote>
<p>1️⃣ 容器组件和UI组件<strong>整合成一个文件</strong></p>
<p>2️⃣ 无需自己给容器组件传递store，给<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         &lt;
        
       
       
        &lt;
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mrel">&lt;</span></span></span></span></span>App/&gt;包裹一个<span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         &lt;
        
       
       
        &lt;
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mrel">&lt;</span></span></span></span></span>Provider store={store}&gt;即可。</p>
<p>3️⃣ 使用了react-redux后也不用再自己监测redux中状态的改变了，容器组件可以自动完成这个工作。</p>
<p>4️⃣ mapDispatchToProps也可以简单的写成一个对象。</p>
<p>5️⃣ 一个组件要和redux“打交道”要经过哪几步？</p>
<ul><li> <p>定义好UI组件—不暴露</p> </li><li> <p>引入connect生成一个容器组件，并暴露，写法如下：</p> <pre><code class="prism language-js"><span class="token function">connect</span><span class="token punctuation">(</span>
  <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">key</span><span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//映射状态</span>
  <span class="token punctuation">{<!-- --></span><span class="token literal-property property">key</span><span class="token operator">:</span>xxxxAction<span class="token punctuation">}</span>  <span class="token comment">//映射操作状态的方法</span>
<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">UI</span>组件<span class="token punctuation">)</span>
</code></pre> </li><li> <p>在UI组件中通过this.props.xxxxxx读取和操作状态</p> </li></ul>
</blockquote>
<blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          今天的分享就到这里啦✨
         
        
       
       
        \textcolor{red}{今天的分享就到这里啦✨}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: red;">今天的分享就到这里啦</span><span class="mord" style="color: red;">✨</span></span></span></span></span> <br/><br/> <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          原创不易，还希望各位大佬支持一下
         
        
       
       
        \textcolor{blue}{原创不易，还希望各位大佬支持一下}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: blue;">原创不易，还希望各位大佬支持一下</span></span></span></span></span> <br/><br/> 🤞 <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          点赞，你的认可是我创作的动力！
         
        
       
       
        \textcolor{green}{点赞，你的认可是我创作的动力！}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: green;">点赞，你的认可是我创作的动力！</span></span></span></span></span> <br/><br/> ⭐️ <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          收藏，你的青睐是我努力的方向！
         
        
       
       
        \textcolor{green}{收藏，你的青睐是我努力的方向！}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: green;">收藏，你的青睐是我努力的方向！</span></span></span></span></span> <br/><br/> ✏️ <span class="katex--inline"><span class="katex"><span class="katex-mathml">
     
      
       
        
         
          评论，你的意见是我进步的财富！
         
        
       
       
        \textcolor{green}{评论，你的意见是我进步的财富！}
       
      
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord cjk_fallback" style="color: green;">评论，你的意见是我进步的财富！</span></span></span></span></span> <br/></p>
</blockquote>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>