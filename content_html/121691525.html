<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#_1">前言介绍</a></li><li><ul><li><a href="#npoi_2">npoi介绍</a></li></ul>
</li><li><a href="#1excel_5">1.读取excel数据</a></li><li><ul><li><a href="#11_sheet_38">1.1 读取sheet表</a></li><li><a href="#12_sheet_60">1.2 获取sheet数据</a></li></ul>
</li><li><a href="#2excel_92">2.删除excel</a></li><li><ul><li><a href="#21_sheet_93">2.1 删除sheet表</a></li><li><a href="#22__123">2.2 清空指定行数据</a></li></ul>
</li><li><a href="#3excel_169">3.修改excel数据</a></li><li><ul><li><a href="#31__170">3.1 修改指定行数据</a></li><li><a href="#32__209">3.2 修改单元格数据</a></li></ul>
</li><li><a href="#4excel_255">4.写入excel</a></li><li><ul><li><a href="#41_WorkBook_256">4.1 创建WorkBook</a></li><li><a href="#42_excel_288">4.2 写入excel文件</a></li></ul>
</li></ul>
</div>
<p></p>
<h1><a id="_1"></a>前言介绍</h1>
<h2><a id="npoi_2"></a>npoi介绍</h2>
<blockquote>
<p>NPOI. NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。. NPOI是一个开源的C#读写Excel、WORD等微软OLE2组件文档的项目。.</p>
</blockquote>
<h1><a id="1excel_5"></a>1.读取excel数据</h1>
<pre><code class="prism language-csharp"> <span class="token keyword">public</span> <span class="token class-name">IWorkbook</span> RWorkbook <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取读取 WorkBook</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetReadWorkbook</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取扩展名</span>
    <span class="token class-name"><span class="token keyword">string</span></span> _extensionName <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Path<span class="token punctuation">.</span><span class="token function">GetExtension</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 文件流</span>
    <span class="token class-name">FileStream</span> _fs<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>ReadWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 把xls写入workbook中 2003版本</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_extensionName <span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">".xls"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        RWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HSSFWorkbook</span><span class="token punctuation">(</span>_fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 把xlsx 写入workbook中 2</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_extensionName <span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">".xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        RWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XSSFWorkbook</span><span class="token punctuation">(</span>_fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        RWorkbook <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"此文件非excel文件，无法读取数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    _fs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<h2><a id="11_sheet_38"></a>1.1 读取sheet表</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取表中的Sheet名称</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>ISheet<span class="token punctuation">&gt;</span></span> Sheets <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取所有 Sheet表</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetSheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取表</span>
    Sheets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">List<span class="token punctuation">&lt;</span>ISheet<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> _sheetCount <span class="token operator">=</span> RWorkbook<span class="token punctuation">.</span>NumberOfSheets<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _sheetCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Sheets<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>RWorkbook<span class="token punctuation">.</span><span class="token function">GetSheetAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<h2><a id="12_sheet_60"></a>1.2 获取sheet数据</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取 Sheet 表数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sheet"&gt;&lt;/param&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetSheetData</span><span class="token punctuation">(</span><span class="token class-name">ISheet</span> sheet<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">IRow</span> _row<span class="token punctuation">;</span>
	<span class="token comment">//从第一行开始获取数据</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> sheet<span class="token punctuation">.</span>LastRowNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取具体行</span>
        _row<span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_row<span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 获取行对应的列数</span>
            <span class="token class-name"><span class="token keyword">var</span></span> _column <span class="token operator">=</span> _row<span class="token punctuation">.</span>LastCellNum<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> _column<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">//  获取某行某列对应的单元格数据</span>
                <span class="token class-name"><span class="token keyword">var</span></span> _cellValue <span class="token operator">=</span> _row<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      
                <span class="token comment">// 4. 输出单元格数据        </span>
               Console<span class="token punctuation">.</span><span class="token function">Wlite</span><span class="token punctuation">(</span>_cellValue<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 换行</span>
            Console<span class="token punctuation">.</span><span class="token function">WliteLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1><a id="2excel_92"></a>2.删除excel</h1>
<h2><a id="21_sheet_93"></a>2.1 删除sheet表</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 删除其中一个Sheet</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sheetName"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="excelPath"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">RemoveOneSheet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sheetName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建文件流</span>
    <span class="token class-name">FileStream</span> _fsWrite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 1. 通过Sheet名字查找Sheet下标</span>
        <span class="token class-name"><span class="token keyword">var</span></span> _sheetIndex <span class="token operator">=</span> RWorkbook<span class="token punctuation">.</span><span class="token function">GetSheetIndex</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_sheetIndex <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 2. 通过Sheet下标移除 Sheet</span>
            RWorkbook<span class="token punctuation">.</span><span class="token function">RemoveSheetAt</span><span class="token punctuation">(</span>_sheetIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 3. 对 Workbook 的修改写入文件流，对文件进行相应操作</span>
            RWorkbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>_fsWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2><a id="22__123"></a>2.2 清空指定行数据</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 清空 Sheet指定行数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="rowNum"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="sheetName"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name="excelPath"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">EmptySheetRow</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> rowNum<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> sheetName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">FileStream</span> _fsWrite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token number">1</span><span class="token punctuation">.</span> 通过Sheet名 获取对应的 ISheet 
        <span class="token class-name">ISheet</span> _sheet<span class="token operator">=</span> RWorkbook<span class="token punctuation">.</span><span class="token function">GetSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_sheet <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        	<span class="token comment">// 2. 定位到要删除的指定行</span>
            <span class="token class-name">IRow</span> _row <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>RowNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_row <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 3. 清空行数据</span>
                _sheet<span class="token punctuation">.</span><span class="token function">RemoveRow</span><span class="token punctuation">(</span>_row<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 4. 对 Workbook 的修改写入文件流，对文件进行相应操作；</span>
                RWorkbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>_fsWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"This the Sheet does not exist"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span>
    <span class="token punctuation">{<!-- --></span>
        _fsWrite<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1><a id="3excel_169"></a>3.修改excel数据</h1>
<h2><a id="31__170"></a>3.1 修改指定行数据</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 修改Sheet行数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sheetName"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateSheet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sheetName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">,</span><span class="token class-name"><span class="token keyword">int</span></span> rowCount<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建文件流</span>
    <span class="token class-name">FileStream</span> _fsWrite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 1. 通过Sheet名 获取对应的ISheet--其中 RWorkbook 为读取Excel文档时获取</span>
        <span class="token class-name"><span class="token keyword">var</span></span> _sheet <span class="token operator">=</span> RWorkbook<span class="token punctuation">.</span><span class="token function">GetSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 获取行对应的列数</span>
        <span class="token class-name"><span class="token keyword">int</span></span> _column <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowCount<span class="token punctuation">)</span><span class="token punctuation">.</span>LastCellNum<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> _column <span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 3. 获取某行某列对应的单元格数据</span>
            <span class="token class-name"><span class="token keyword">var</span></span> _sheetCellValue <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowCount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 4. 向单元格传值，以覆盖对应的单元格数据</span>
            _sheetCellValue<span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>_sheetCellValue <span class="token operator">+</span> <span class="token string">"Update"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 5. 对 Workbook 的修改写入文件流，对文件进行相应操作</span>
        RWorkbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>fsWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 6. 关闭文件流</span>
        _fsWrite<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="32__209"></a>3.2 修改单元格数据</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 修改 Sheet单元格数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="sheetName"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">UpdateSheet</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> sheetName<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建文件流</span>
    <span class="token class-name">FileStream</span> _fsWrite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 1. 通过Sheet名 获取对应的ISeet--其中 ReadWorkbook 为读取Excel文档时获取</span>
        <span class="token class-name"><span class="token keyword">var</span></span> _sheet <span class="token operator">=</span> RWorkbook<span class="token punctuation">.</span><span class="token function">GetSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 获取行数</span>
        <span class="token class-name"><span class="token keyword">int</span></span> _rowCount <span class="token operator">=</span> _sheet<span class="token punctuation">.</span>LastRowNum<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _rowCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 3. 获取行对应的列数</span>
            <span class="token class-name"><span class="token keyword">int</span></span> _columnount <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>LastCellNum<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> _columnount<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 4. 获取某行某列对应的单元格数据</span>
                <span class="token class-name"><span class="token keyword">var</span></span> _sheetCellValue <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 5. 向单元格传值，以覆盖对应的单元格数据</span>
                sheetCellValue<span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>_sheetCellValue <span class="token operator">+</span> <span class="token string">"Update"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 6. 对 Workbook 的修改写入文件流，对文件进行相应操作</span>
        RWorkbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>fsWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 7. 关闭文件流</span>
        _fsWrite<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1><a id="4excel_255"></a>4.写入excel</h1>
<h2><a id="41_WorkBook_256"></a>4.1 创建WorkBook</h2>
<pre><code class="prism language-csharp"><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 写入IWorkbook</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token class-name">IWorkbook</span> WWorkbook <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取写入WorkBook</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">GetWriteWorkbook</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 获取扩展名</span>
    <span class="token class-name"><span class="token keyword">string</span></span> _extensionName <span class="token operator">=</span> System<span class="token punctuation">.</span>IO<span class="token punctuation">.</span>Path<span class="token punctuation">.</span><span class="token function">GetExtension</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 把xls写入workbook中</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_extensionName <span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">".xls"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        WWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 把xlsx 写入workbook中</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_extensionName <span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">".xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        WWorkbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">XSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{<!-- --></span>
        WWorkbook <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<h2><a id="42_excel_288"></a>4.2 写入excel文件</h2>
<pre><code class="prism language-csharp"><span class="token comment">// &lt;summary&gt;</span>
<span class="token comment">/// Table 实体类数据转 表格数据</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name="excelPath"&gt;&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;&lt;/returns&gt;</span>
<span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">TableDataToCell</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span></span> excelPath<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">FileStream</span> _fsWrite <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FileStream</span><span class="token punctuation">(</span>excelPath<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 1. 在WriteWorkbook 上添加名为 sheetDemo 的数据表</span>
        <span class="token class-name">ISheet</span> _sheet <span class="token operator">=</span> WWorkbook<span class="token punctuation">.</span><span class="token function">CreateSheet</span><span class="token punctuation">(</span><span class="token string">"sheetDemo "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 2. 定义行数</span>
        <span class="token class-name"><span class="token keyword">var</span></span> _rowCount <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token comment">// 3. 定义列数</span>
        <span class="token class-name"><span class="token keyword">int</span></span> _columnount <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> _rowCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
        	<span class="token comment">// 4. 创建行</span>
            <span class="token class-name">IRow</span>  _row <span class="token operator">=</span> _sheet<span class="token punctuation">.</span><span class="token function">CreateRow</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> _columnount<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
            	<span class="token comment">// 5. 创建某行某列对应的单元格</span>
                 <span class="token class-name">ICell</span> _cell <span class="token operator">=</span> _row<span class="token punctuation">.</span><span class="token function">CreateCell</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 6. 向单元格添加值</span>
                _cell<span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">i</span><span class="token punctuation">}</span></span><span class="token string">行 第</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">j</span><span class="token punctuation">}</span></span><span class="token string">列"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 添加表格样式</span>
                _cell<span class="token punctuation">.</span>CellStyle <span class="token operator">=</span> ExpandFliePath<span class="token punctuation">.</span><span class="token function">OtherRowStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//7. 将表单写入文件流</span>
        WWorkbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>_fsWrite<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span>
    <span class="token punctuation">{<!-- --></span>
    	<span class="token comment">// 关闭文件流</span>
        _fsWrite<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>