<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>数据库课程设计——学生宿舍管理，需要全部源码可以关注私信我</h3>
<ul><li><a href="#_7">前言</a></li><li><a href="#_12">一、课题背景和开发环境</a></li><li><ul><li><a href="#1_13">1、课题背景</a></li><li><a href="#2_15">2、开发环境</a></li></ul>
</li><li><a href="#_17">二、系统功能及示意图</a></li><li><ul><li><a href="#1_18">1、系统实现功能</a></li><li><a href="#2_33">2、功能示意图</a></li><li><ul><li><a href="#21_34">2.1学生模块</a></li><li><a href="#22_37">2.2管理人员模块</a></li></ul>
</li></ul>
</li><li><a href="#_39">三、概念结构设计</a></li><li><ul><li><a href="#1E_R_42">1、管理员分配宿舍E_R图</a></li><li><a href="#2_45">2、数据库关系图</a></li></ul>
</li><li><a href="#_47">四、数据库表</a></li><li><a href="#_174">五、数据库的实施</a></li><li><ul><li><a href="#1_175">1、触发器设计</a></li></ul>
</li><li><a href="#_183">六、部分系统功能设计与实现</a></li><li><ul><li><a href="#1database_184">1、database类</a></li><li><a href="#2_249">2、登录界面</a></li><li><ul><li><a href="#1_251">（1）界面展示：</a></li></ul>
</li><li><a href="#3_365">3、宿舍界面</a></li><li><ul><li><a href="#1_366">（1）界面展示</a></li><li><a href="#2_368">（2）界面功能</a></li></ul>
</li><li><a href="#4_568">4、分配宿舍界面</a></li><li><ul><li><a href="#1_569">（1）界面展示</a></li><li><a href="#2_571">（2）界面功能</a></li></ul>
</li></ul>
</li><li><a href="#_774">七、系统测试(部分功能)</a></li><li><ul><li><a href="#1_775">1、学生登录</a></li><li><ul><li><a href="#1_779">（1）查看个人信息：</a></li><li><a href="#2_781">（2）查看宿舍信息：</a></li><li><a href="#3_784">（3）申请更换宿舍：</a></li></ul>
</li><li><a href="#21_788">2、管理人员登录（用权限为1管理员登录可以进行所有操作）：</a></li><li><ul><li><a href="#1_789">（1）宿舍楼管理：</a></li><li><a href="#2_797">（2）宿舍管理：</a></li></ul>
</li></ul>
</li><li><a href="#_807">总结</a></li></ul>
</div>
<p></p>
<hr/>
<h1><a id="_7"></a>前言</h1>
<p>学生宿舍管理系统从实际问题出发，解决高校传统方式进行学生宿舍管理的缺点，极大提高了学生宿舍管理的效率。本系统基于SQLServer数据库系统，从学生和管理人员两个角度出发进行设计。从学生角度出发，学生能够查看个人信息，查看宿舍的信息，提交更换宿舍申请以及修改登录密码；从管理人员角度出发，实现管理宿舍信息、学生信息、对宿舍、学生进行增删改查、分配新生的宿舍、对申请更换宿舍的学生进行宿舍的分配。不仅如此，针对低权限的管理人员，不能操作宿舍楼、宿舍信息，加强了数据的保密性。</p>
<hr/>
<h1><a id="_12"></a>一、课题背景和开发环境</h1>
<h2><a id="1_13"></a>1、课题背景</h2>
<p>学生宿舍管理系统对于一个学校来说是不可获取的重要组成部分。学生宿舍是大学生在高校校园里一个重要的学习、生活、交往的空间环境。大学生，大约有2/3 的时间是在宿舍环境里度过的。随着高校办学规模的扩大，在校学生的学历层次、思想状态、文化水平呈多样化、复杂化趋势，这在很大程度上给学生管理工作带来许多新的问题。例如：学生宿舍的住宿管理也日益增多，宿管员的工作难度逐渐加大，已经不能满足实际的需要，工作效率也比较低，并且这种传统方式也存在着许多弊端，如：保密性差，效率低，很难保存记录等。当今社会是飞速进步的世界，原始的记录方式已经被社会所淘汰了，计算机化管理正是适应时代的产物。采用计算机来管理宿舍和学生的信息，大大提高了查询的速度，节约了人力和物力资源。现如今，计算机的价格十分亲民，性能也有了很大的进步。它已经被应用于许多领域。我们针对高校学生宿舍存在的问题，设计了一套学生宿舍管理系统。本系统针对高校采用传统方式管理的缺点，极大提高了学生宿舍管理的效率，也是科学化、正规化的管理；本系统的开发是为了方便宿管员的管理以及对相关信息的更新，为老师、学生查询所在宿舍的信息。实现寝室信息管理工作流程的系统化、规范化和自动化。</p>
<h2><a id="2_15"></a>2、开发环境</h2>
<p>使用的数据库是Microsoft SQL Server Management Studio 18。具有许多显著的优点：易用性、适合分布式组织的可伸缩性、用于决策支持的数据仓库功能、与许多其他服务器软件紧密关联的集成性、良好的性价比等。使用了Visual Studio 2022中的Window 窗体应用（.NET Framework），用于创建具有Window窗体用户界面的项目。</p>
<h1><a id="_17"></a>二、系统功能及示意图</h1>
<h2><a id="1_18"></a>1、系统实现功能</h2>
<p>从实际生活应用角度出发，学生宿舍管理系统应该同时提供给系统管理员与学生使用，而二者所需要的功能并不相同。因此系统从学生与管理员两个角度进行出发，结合实际所需要的操作进行分模块设计。<br/> 一、学生界面功能：<br/> （1）登录功能：设计登录界面，针对学生输入的学号密码，通过匹配数据库里的学号密码，实现不同的学生进行登录。<br/> （2）个人信息查询：通过学生的学号查询，学生可以检查自己的各项信息。<br/> （3）修改密码：通过学号进行密码修改，学生可以修改自己的登录密码。<br/> （4）宿舍信息查询：宿舍信息界面向学生展示了宿舍成员的信息，以及宿舍的一些基本信息。<br/> （5）申请更换宿舍：学生可以根据自己需求，向管理员提出更换宿舍的申请，需等管理员同意且分配完宿舍后，才有新的宿舍信息。<br/> 二、管理人员界面功能<br/> （1）宿舍楼管理：根据填写的信息，对宿舍楼进行增删改查。<br/> （2）宿舍管理界面：根据填写的信息，对宿舍的信息进行增删改查操作。<br/> （3）分配宿舍界面：给未分配宿舍的同学，进行宿舍分配，其中有未分配人员的信息，空余宿舍的信息。<br/> （4）学生信息管理界面：对学生信息进行增删改查操作。<br/> （5）调整宿舍界面：对申请更换宿舍的学生进行调整，其中有申请同学的信息和空余宿舍的信息。<br/> （6）登录功能：在登录界面，选择管理员，输入正确的账号密码即可进入管理人员界面。对于低权限的管理人员不能进行宿舍楼管理和宿舍管理。只有超级管理员才可以进行这两个操作。</p>
<h2><a id="2_33"></a>2、功能示意图</h2>
<h3><a id="21_34"></a>2.1学生模块</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b59a8ac0e5aa40f1967653217c70fa64.png#pic_center"/></p>
<h3><a id="22_37"></a>2.2管理人员模块</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/a8a1fb5d0068458d8e1828cd941896b6.png#pic_center"/></p>
<h1><a id="_39"></a>三、概念结构设计</h1>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/797b3edeaa924110acade6549415bebf.png#pic_center"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/6236f02be49e4382981b57d052a6e43d.png#pic_center"/></p>
<h2><a id="1E_R_42"></a>1、管理员分配宿舍E_R图</h2>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b29e51388e8b4e728515f774d2344daf.png#pic_center"/></p>
<h2><a id="2_45"></a>2、数据库关系图</h2>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/57cd379d315d435198e5bd0ffcc1b9db.png#pic_center"/></p>
<h1><a id="_47"></a>四、数据库表</h1>
<p>①Student<br/> 由上表（数据图关系图）可知，学生需要有姓名，性别，出生日期，专业，班级，手机号码的属性，因此创建学生表。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7a92513a07634020a60ee25c01672341.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Student<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>sname<span class="token punctuation">]</span> <span class="token punctuation">[</span>varchar<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>sex<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>birth<span class="token punctuation">]</span> <span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>sdept<span class="token punctuation">]</span> <span class="token punctuation">[</span>varchar<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>class<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>phone<span class="token punctuation">]</span> <span class="token punctuation">[</span>varchar<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
PRIMARY KEY <span class="token function">CLUSTERED</span> 
<span class="token punctuation">(</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> ASC
<span class="token punctuation">)</span><span class="token function">WITH</span> <span class="token punctuation">(</span>PAD_INDEX <span class="token operator">=</span> OFF<span class="token punctuation">,</span> STATISTICS_NORECOMPUTE <span class="token operator">=</span> OFF<span class="token punctuation">,</span> IGNORE_DUP_KEY <span class="token operator">=</span> OFF<span class="token punctuation">,</span> ALLOW_ROW_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> ALLOW_PAGE_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> OPTIMIZE_FOR_SEQUENTIAL_KEY <span class="token operator">=</span> OFF<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>②Studentlogin<br/> 学生登录表记录了学生的登录账号和密码，该表的账号为学生的学号，是Student表中ssid的外键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/c24a5cf396214cae8c4394265a926e5f.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Studentlogin<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>pwd<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>③Building<br/> 宿舍楼有楼号，宿舍数量和地理位置的属性，所以我们创建宿舍楼表，记录每栋楼的信息，将楼号bid设为主键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/15fb31d740b140459049f56e4f00677b.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Building<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>bid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>local<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
 CONSTRAINT <span class="token punctuation">[</span>PK__Building__DE90ADE74750D263<span class="token punctuation">]</span> PRIMARY KEY <span class="token function">CLUSTERED</span> 
<span class="token punctuation">(</span>
	<span class="token punctuation">[</span>bid<span class="token punctuation">]</span> ASC
<span class="token punctuation">)</span><span class="token function">WITH</span> <span class="token punctuation">(</span>PAD_INDEX <span class="token operator">=</span> OFF<span class="token punctuation">,</span> STATISTICS_NORECOMPUTE <span class="token operator">=</span> OFF<span class="token punctuation">,</span> IGNORE_DUP_KEY <span class="token operator">=</span> OFF<span class="token punctuation">,</span> ALLOW_ROW_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> ALLOW_PAGE_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> OPTIMIZE_FOR_SEQUENTIAL_KEY <span class="token operator">=</span> OFF<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>④Dormitory<br/> 宿舍有宿舍编号（方便运用），楼号，宿舍号，楼层，床位，价格等信息，所以我们建立宿舍表，将宿舍号设为主键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/097a1821f9664cb5953e6582edf3f2fb.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Dormitory<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>did<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>bid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>dnum<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>dfloor<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>bed<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>price<span class="token punctuation">]</span> <span class="token punctuation">[</span>decimal<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
 CONSTRAINT <span class="token punctuation">[</span>PK__Dormitor__D877D216A2D12D3F<span class="token punctuation">]</span> PRIMARY KEY <span class="token function">CLUSTERED</span> 
<span class="token punctuation">(</span>
	<span class="token punctuation">[</span>did<span class="token punctuation">]</span> ASC
<span class="token punctuation">)</span><span class="token function">WITH</span> <span class="token punctuation">(</span>PAD_INDEX <span class="token operator">=</span> OFF<span class="token punctuation">,</span> STATISTICS_NORECOMPUTE <span class="token operator">=</span> OFF<span class="token punctuation">,</span> IGNORE_DUP_KEY <span class="token operator">=</span> OFF<span class="token punctuation">,</span> ALLOW_ROW_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> ALLOW_PAGE_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> OPTIMIZE_FOR_SEQUENTIAL_KEY <span class="token operator">=</span> OFF<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>⑤Manager<br/> 管理员拥有账号，密码，姓名和权限这些属性，权限用以区别超级管理员和普通管理员，并且将账号mid设为主键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e2864475d3ed4592bba5b07ab6576d94.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Manager<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>pass<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>sname<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>permission<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
PRIMARY KEY <span class="token function">CLUSTERED</span> 
<span class="token punctuation">(</span>
	<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> ASC
<span class="token punctuation">)</span><span class="token function">WITH</span> <span class="token punctuation">(</span>PAD_INDEX <span class="token operator">=</span> OFF<span class="token punctuation">,</span> STATISTICS_NORECOMPUTE <span class="token operator">=</span> OFF<span class="token punctuation">,</span> IGNORE_DUP_KEY <span class="token operator">=</span> OFF<span class="token punctuation">,</span> ALLOW_ROW_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> ALLOW_PAGE_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> OPTIMIZE_FOR_SEQUENTIAL_KEY <span class="token operator">=</span> OFF<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>⑥StuDormitory<br/> 学生宿舍表记录学生的宿舍编号和学号，将学号和宿舍编号设为主键，才能唯一确定一条记录，学号为Student表的ssid的外键，宿舍编号为Dormitoryd的did的外键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/904c0c36997447e799b06ffda3ce09ec.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>StuDormitory<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>did<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> NOT <span class="token constant">NULL</span><span class="token punctuation">,</span>
PRIMARY KEY <span class="token function">CLUSTERED</span> 
<span class="token punctuation">(</span>
	<span class="token punctuation">[</span>did<span class="token punctuation">]</span> ASC<span class="token punctuation">,</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> ASC
<span class="token punctuation">)</span><span class="token function">WITH</span> <span class="token punctuation">(</span>PAD_INDEX <span class="token operator">=</span> OFF<span class="token punctuation">,</span> STATISTICS_NORECOMPUTE <span class="token operator">=</span> OFF<span class="token punctuation">,</span> IGNORE_DUP_KEY <span class="token operator">=</span> OFF<span class="token punctuation">,</span> ALLOW_ROW_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> ALLOW_PAGE_LOCKS <span class="token operator">=</span> ON<span class="token punctuation">,</span> OPTIMIZE_FOR_SEQUENTIAL_KEY <span class="token operator">=</span> OFF<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>⑦Apply<br/> 学生宿舍申请表拥有学号，旧宿舍，申请日期，原因和状态五个属性，状态为0表示处理完，状态为1表示未处理。学号是Student表的ssid的外键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/476c95d3123d4cc88107e70186bd6978.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Apply<span class="token punctuation">]</span><span class="token punctuation">(</span>
	<span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>olddnum<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>adate<span class="token punctuation">]</span> <span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>reason<span class="token punctuation">]</span> <span class="token punctuation">[</span>varchar<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">[</span>condition<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<p>⑧Change<br/> 学生宿舍变动表记录学生的学号，处理日期，旧宿舍和更换过后的新宿舍，学号是Student表的外键。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7b739a7985954306ac4586a2295fe107.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
CREATE TABLE <span class="token punctuation">[</span>dbo<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">[</span>Change<span class="token punctuation">]</span><span class="token punctuation">(</span>
   <span class="token punctuation">[</span>ssid<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">char</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>olddnum<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>newdnum<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>cdata<span class="token punctuation">]</span> <span class="token punctuation">[</span>datetime<span class="token punctuation">]</span> <span class="token constant">NULL</span>
<span class="token punctuation">)</span> ON <span class="token punctuation">[</span>PRIMARY<span class="token punctuation">]</span>
GO
</code></pre>
<h1><a id="_174"></a>五、数据库的实施</h1>
<h2><a id="1_175"></a>1、触发器设计</h2>
<p>1、Studentlogin表的插入触发器。当插入学号和密码时，表中存在相同学号，则不允许插入。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/9a7e408b3bf44fd18c9f0060859bd298.png#pic_center"/></p>
<p>2、更换宿舍申请表的插入触发器。当进行插入时，幻表中已经进行了插入，获取当前表中按时间顺序排第二的记录（即插入记录的上一条记录）得到处理状态，如果为0，证明处理完毕，可以进行插入，如果为1，证明尚未处理，不可插入。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/aa7440a6f01d4da081a087278957d4ad.png#pic_center"/><br/> 3、学生宿舍表的插入触发器。如果在表中不存在插入的学号，并且插入的宿舍剩余床位大于0，则同意插入，不满足二者其一条件则不允许插入。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7faf909da86240568219e3fa0878eb62.png#pic_center"/></p>
<h1><a id="_183"></a>六、部分系统功能设计与实现</h1>
<h2><a id="1database_184"></a>1、database类</h2>
<p>创建database类，通过非连接的方式访问数据库，对传参的sql语句进行处理，有两个方法，获取数据（）与更新（），获取数据主要是用于读取数据库的信息，利用SqlDataAdapter的对象myAdapter.Fill方法将数据从数据库复制到DataSet的对象myDataSet中，最后将myDataSet返回。就实现了从数据库获取信息。更新主要是用于对数据库的数据进行增删改查操作。创建database类方便之后要从数据库获取数据的代码编写，减少代码冗余。</p>
<pre><code class="prism language-c">代码如下：
using System<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Data<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>SqlClient<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Windows<span class="token punctuation">.</span>Forms<span class="token punctuation">;</span>

namespace StudentdormManaSys
<span class="token punctuation">{<!-- --></span>
    internal class database
    <span class="token punctuation">{<!-- --></span>
        private <span class="token keyword">static</span> string connStr <span class="token operator">=</span> @<span class="token string">"data source=.;database = Dormitorymanager; integrated security = true"</span><span class="token punctuation">;</span>
        private <span class="token keyword">static</span> SqlConnection conn <span class="token operator">=</span> new <span class="token function">SqlConnection</span><span class="token punctuation">(</span>connStr<span class="token punctuation">)</span><span class="token punctuation">;</span>

        public <span class="token keyword">static</span> DataSet 获取数据<span class="token punctuation">(</span>string sqlStr<span class="token punctuation">)</span><span class="token comment">//sqlStr是需要执行的sql语句</span>
        <span class="token punctuation">{<!-- --></span>
            try
            <span class="token punctuation">{<!-- --></span>
                conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                SqlDataAdapter myAdapter <span class="token operator">=</span> new <span class="token function">SqlDataAdapter</span><span class="token punctuation">(</span>sqlStr<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
                DataSet myDataSet <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                myDataSet<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                myAdapter<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>myDataSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>myDataSet<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> myDataSet<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">catch</span> <span class="token punctuation">(</span>Exception ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"打开数据库失败"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> null<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        public <span class="token keyword">static</span> <span class="token keyword">void</span> 更新<span class="token punctuation">(</span>string sqlStr<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            try
            <span class="token punctuation">{<!-- --></span>
                conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                SqlCommand myCmd <span class="token operator">=</span> new <span class="token function">SqlCommand</span><span class="token punctuation">(</span>sqlStr<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
                myCmd<span class="token punctuation">.</span>CommandType <span class="token operator">=</span> CommandType<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
                myCmd<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            catch
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"更新据库失败"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="2_249"></a>2、登录界面</h2>
<p>用户根据不同的身份（学生或者管理员）进行选择后，输入自己的用户名与密码，如果与数据库匹配正确即可登录。对登录组件利用Color.FromArgb方法设置成透明，使界面展示美观。点击学生则显示学生登录窗口，点击管理人员则显示管理人员登录窗口。一开始加载时默认选择学生登录。</p>
<h3><a id="1_251"></a>（1）界面展示：</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/74d8d0fffcda43f2a708234c5aa012ed.png#pic_center"/></p>
<pre><code class="prism language-c">代码如下：
        public <span class="token keyword">static</span> string ssid<span class="token punctuation">;</span><span class="token comment">//设置静态变量，方便之后调用</span>
        public <span class="token keyword">static</span> string mmid<span class="token punctuation">;</span>
        private <span class="token keyword">void</span> <span class="token function">studentlogin_CheckedChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>studentlogin<span class="token punctuation">.</span>Checked <span class="token operator">==</span> true<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Stulogin<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Manlogin<span class="token punctuation">.</span><span class="token function">Hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                managerlogin<span class="token punctuation">.</span>Checked <span class="token operator">=</span> false<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> <span class="token function">managerlogin_CheckedChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>managerlogin<span class="token punctuation">.</span>Checked <span class="token operator">==</span> true<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                Manlogin<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Stulogin<span class="token punctuation">.</span><span class="token function">Hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                studentlogin<span class="token punctuation">.</span>Checked <span class="token operator">=</span> false<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> 登录<span class="token function">_Load</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            studentlogin<span class="token punctuation">.</span>Checked <span class="token operator">=</span> true<span class="token punctuation">;</span>
            logintype<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            logintype<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Stulogin<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Stulogin<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Manlogin<span class="token punctuation">.</span><span class="token function">Hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Manlogin<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            button1<span class="token punctuation">.</span>BackColor <span class="token operator">=</span> Color<span class="token punctuation">.</span><span class="token function">FromArgb</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sidpassword<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            midpassword<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

</code></pre>
<p>对登录账号密码进行验证：根据学生跟管理人员的单选框有没有被选中进行判断是学生还是管理员进行登录操作（if-else判断）。采用非连接的方式访问数据库，设置一个DataSet 调用database中获取数据的方法。根据DataSet是否为空，判断是否存在账号。若存在则判断密码与DataSet中的密码字段是否相等，相等就显示登录成功。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> <span class="token function">button1_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            string connstring <span class="token operator">=</span> @<span class="token string">"Data Source = .;Database = DormitoryManager;integrated security = true"</span><span class="token punctuation">;</span>
            SqlConnection conn <span class="token operator">=</span> new <span class="token function">SqlConnection</span><span class="token punctuation">(</span>connstring<span class="token punctuation">)</span><span class="token punctuation">;</span>
            try
            <span class="token punctuation">{<!-- --></span>
                conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>studentlogin<span class="token punctuation">.</span>Checked <span class="token operator">==</span> true<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    string sid <span class="token operator">=</span> sidaccount<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ssid <span class="token operator">=</span> sid<span class="token punctuation">;</span>
                    string sql1 <span class="token operator">=</span> <span class="token string">"select * from Studentlogin where ssid='"</span> <span class="token operator">+</span> sid <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">;</span><span class="token comment">//查找学生账号</span>
                    DataSet s1 <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new一个对象</span>
                    s1 <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//传入查询语句</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>s1 <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token comment">//没有匹配到账户 </span>
                    <span class="token punctuation">{<!-- --></span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该账号不存在！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        string selectpwd1 <span class="token operator">=</span> s1<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"pwd"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectpwd1<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>sidpassword<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//比较输入密码与表中密码是否一致</span>
                        <span class="token punctuation">{<!-- --></span>
                            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"恭喜您登录成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            学生管理 f1 <span class="token operator">=</span> new 学生管理<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            f1<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span><span class="token keyword">else</span>
                        <span class="token punctuation">{<!-- --></span>
                            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"密码错误！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span>
                <span class="token punctuation">{<!-- --></span>
                    string mid <span class="token operator">=</span> midaccount<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mmid <span class="token operator">=</span> mid<span class="token punctuation">;</span>
                    string sql2 <span class="token operator">=</span> <span class="token string">"select * from Manager where mid='"</span><span class="token operator">+</span>mid<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span><span class="token comment">//查找管理账号</span>
                    DataSet s2 <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//new一个对象</span>
                    s2 <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据<span class="token punctuation">(</span>sql2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//传入查询语句</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>s2 <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token comment">//没有匹配到账户 </span>
                    <span class="token punctuation">{<!-- --></span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该账号不存在！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">else</span>
                    <span class="token punctuation">{<!-- --></span>
                        string selectpwd2 <span class="token operator">=</span> s2<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"pass"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>selectpwd2<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span>midpassword<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//比较输入密码与表中密码是否一致</span>
                        <span class="token punctuation">{<!-- --></span>
                            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"恭喜您登录成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            管理人员界面 f2<span class="token operator">=</span>new 管理人员界面<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            f2<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span>
                        <span class="token punctuation">{<!-- --></span>
                            MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"密码错误！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token function">catch</span> <span class="token punctuation">(</span>Exception ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"数据库连接异常！"</span> <span class="token operator">+</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> <span class="token string">"系统消息"</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>OK<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            finally
            <span class="token punctuation">{<!-- --></span>
                conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
</code></pre>
<h2><a id="3_365"></a>3、宿舍界面</h2>
<h3><a id="1_366"></a>（1）界面展示</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/87162febba0e4396a198f7c3b2f482e1.png#pic_center"/></p>
<h3><a id="2_368"></a>（2）界面功能</h3>
<p>对宿舍进行增删改查的操作，在文本框输入正确的信息即可实现对宿舍进行添加、修改、删除操作。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> 宿舍更新<span class="token punctuation">(</span>string str<span class="token punctuation">)</span><span class="token comment">//宿舍信息中宿舍信息表更新</span>
        <span class="token punctuation">{<!-- --></span>
            DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                DorDgv<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"did"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"宿舍id"</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"bid"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"楼号"</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"dnum"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"宿舍号"</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"dfloor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"楼层"</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"bed"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"床位数"</span><span class="token punctuation">;</span>
                DorDgv<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"单价"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                DorDgv<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        private bool <span class="token function">IsNotchongfu_d_b</span><span class="token punctuation">(</span>string did<span class="token punctuation">,</span> string dnum<span class="token punctuation">,</span> string bid<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据
                <span class="token punctuation">(</span><span class="token string">"select * from Dormitory where did !='"</span> <span class="token operator">+</span> did <span class="token operator">+</span> <span class="token string">"'and dnum='"</span> <span class="token operator">+</span> dnum <span class="token operator">+</span> <span class="token string">"'"</span> <span class="token operator">+</span> <span class="token string">"and bid='"</span> <span class="token operator">+</span> bid <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> false<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> true<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        private bool <span class="token function">IsNotExist_did</span><span class="token punctuation">(</span>string no<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据<span class="token punctuation">(</span><span class="token string">"select * from Dormitory where did='"</span><span class="token operator">+</span>no<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">==</span> null<span class="token punctuation">)</span>
                <span class="token keyword">return</span> true<span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">return</span> false<span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
</code></pre>
<p>编写宿舍更新方法、判断宿舍记录是否存在。一个是同一栋楼是否有相同的宿舍号，一个是判断宿舍编号是否相同。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> 添加<span class="token function">Dor_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//宿舍信息界面添加宿舍</span>
        <span class="token punctuation">{<!-- --></span>
            string did<span class="token operator">=</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string bid<span class="token operator">=</span>bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string dnum <span class="token operator">=</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string floor<span class="token operator">=</span>floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string bed<span class="token operator">=</span>bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            string price<span class="token operator">=</span>pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入宿舍id！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请选择楼号！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入宿舍号！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入楼层！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入床位数！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入单价！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsNotExist_did</span><span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">IsNotchongfu_d_b</span><span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该记录已存在！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                string sqlStr1<span class="token punctuation">;</span>
                try
                <span class="token punctuation">{<!-- --></span>
                    sqlStr1 <span class="token operator">=</span> <span class="token string">"insert into Dormitory values('"</span> <span class="token operator">+</span> didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span>
                         <span class="token operator">+</span> bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"')"</span><span class="token punctuation">;</span>
                    database<span class="token punctuation">.</span>更新<span class="token punctuation">(</span>sqlStr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    宿舍获取<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"添加成功！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                catch
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"操作失败！请检查规范"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        
        private <span class="token keyword">void</span> 修改<span class="token function">Dor_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//宿舍信息界面修改宿舍信息</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入宿舍id！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请选择楼号！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入宿舍号！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入楼层！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入床位数！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span> MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入单价！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">IsNotExist_did</span><span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span>true<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该记录不存在！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsNotchongfu_d_b</span><span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该宿舍记录已存在！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                string sqlStr1<span class="token punctuation">;</span>
                try
                <span class="token punctuation">{<!-- --></span>
                    sqlStr1 <span class="token operator">=</span> <span class="token string">"update  Dormitory set did='"</span> <span class="token operator">+</span> didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"',bid='"</span>
                        <span class="token operator">+</span>bidtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"',dnum='"</span> <span class="token operator">+</span> dnumtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"',dfloor='"</span>
                        <span class="token operator">+</span> floortxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"',bed='"</span> <span class="token operator">+</span> bedtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"',price='"</span>
                        <span class="token operator">+</span> pricetxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span> <span class="token string">"' where did='"</span> <span class="token operator">+</span> didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">;</span>
                    database<span class="token punctuation">.</span>更新<span class="token punctuation">(</span>sqlStr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    宿舍获取<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"修改成功！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                catch
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"操作失败！请检查规范"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> 删除<span class="token function">Dor_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//宿舍信息界面删除宿舍</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"请输入宿舍id！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsNotExist_did</span><span class="token punctuation">(</span>didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                string sqlStr1<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"确定要删除该记录吗？无法撤销！"</span><span class="token punctuation">,</span> <span class="token string">"删除"</span><span class="token punctuation">,</span> MessageBoxButtons<span class="token punctuation">.</span>YesNo<span class="token punctuation">,</span> MessageBoxIcon<span class="token punctuation">.</span>Question<span class="token punctuation">,</span> MessageBoxDefaultButton<span class="token punctuation">.</span>Button2<span class="token punctuation">)</span> <span class="token operator">==</span> DialogResult<span class="token punctuation">.</span>Yes<span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    try
                    <span class="token punctuation">{<!-- --></span>
                        sqlStr1 <span class="token operator">=</span> <span class="token string">"delete from Dormitory where did='"</span> <span class="token operator">+</span> didtxt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">;</span>
                        database<span class="token punctuation">.</span>更新<span class="token punctuation">(</span>sqlStr1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        宿舍获取<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"删除成功！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token function">catch</span><span class="token punctuation">(</span>Exception ex<span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"操作失败！请检查规范"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该记录不存在！"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> 取消<span class="token function">Dor_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            bidtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            didtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            dnumtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            floortxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            bedtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            pricetxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            查询txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<p>编写按钮的点击事件，实现对宿舍的增删改查操作，每次操作完后更新一下DataGridView中的信息。以便管理人员直接看到数据变化。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> 取消<span class="token function">Dor_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            bidtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            didtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            dnumtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            floortxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            bedtxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            pricetxt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
            查询txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        private <span class="token keyword">void</span> <span class="token function">button8_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            宿舍获取<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<h2><a id="4_568"></a>4、分配宿舍界面</h2>
<h3><a id="1_569"></a>（1）界面展示</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/15633a0f3c0343979882fefee20e4fee.png#pic_center"/></p>
<h3><a id="2_571"></a>（2）界面功能</h3>
<p>对未分配的学生分配宿舍，在右边输入正确的信息，查看空宿舍，点击分配宿舍既可给学生分配宿舍。</p>
<pre><code class="prism language-c">代码如下：
       private <span class="token keyword">void</span> 分配宿舍学生信息更新<span class="token punctuation">(</span>string str<span class="token punctuation">)</span><span class="token comment">//分配宿舍表更新</span>
       <span class="token punctuation">{<!-- --></span>
           DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           DataTable dt <span class="token operator">=</span> new <span class="token function">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               <span class="token keyword">int</span> count <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>

               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"ssid"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"sname"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"sex"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"birth"</span><span class="token punctuation">,</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"sdept"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"phone"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
               <span class="token punctuation">{<!-- --></span>
                   DataRow dr1 <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"ssid"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"ssid"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"sname"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"sname"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"sex"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"sex"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"birth"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"birth"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"sdept"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"sdept"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"class"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"class"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"phone"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"phone"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dt<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">InsertAt</span><span class="token punctuation">(</span>dr1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
               分配宿舍学生信息<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> dt<span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"ssid"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"学号"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"sname"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"姓名"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"sex"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"性别"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"birth"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"出生日期"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"sdept"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"专业"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"class"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"班级"</span><span class="token punctuation">;</span>
               分配宿舍学生信息<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"phone"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"电话"</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
           <span class="token keyword">else</span>
           <span class="token punctuation">{<!-- --></span>
               分配宿舍学生信息<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> null<span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       private <span class="token keyword">void</span> 获取空余宿舍<span class="token punctuation">(</span><span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           DataTable dt <span class="token operator">=</span> new <span class="token function">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           DataSet number <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据
               <span class="token punctuation">(</span><span class="token string">"select * from Dormitory where bed&gt; (select COUNT (StuDormitory.did) from StuDormitory where StuDormitory.did=Dormitory.did) "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               <span class="token keyword">int</span> count <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"did"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"bid"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"dnum"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列  </span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"dfloor"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"bed"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列 </span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"remain"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>
               dt<span class="token punctuation">.</span>Columns<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//添加一列</span>

               <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
               <span class="token punctuation">{<!-- --></span>
                   DataRow dr1 <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">NewRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"did"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"did"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"bid"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"bid"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"dnum"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"dnum"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   try
                   <span class="token punctuation">{<!-- --></span>
                       number <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据
               <span class="token punctuation">(</span><span class="token string">"select COUNT(did) from StuDormitory where StuDormitory.did='"</span> <span class="token operator">+</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"did"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                       dr1<span class="token punctuation">[</span><span class="token string">"remain"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"bed"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>number<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token punctuation">}</span>
                   catch
                   <span class="token punctuation">{<!-- --></span>
                       dr1<span class="token punctuation">[</span><span class="token string">"remain"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"计算失败"</span><span class="token punctuation">;</span>
                   <span class="token punctuation">}</span>

                   dr1<span class="token punctuation">[</span><span class="token string">"dfloor"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"dfloor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"bed"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"bed"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dr1<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   dt<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span><span class="token function">InsertAt</span><span class="token punctuation">(</span>dr1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>

               dataGridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> dt<span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"did"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"宿舍id"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"bid"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"楼号"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"dnum"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"宿舍号"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"dfloor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"楼层"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"bed"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"床位数"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"单价"</span><span class="token punctuation">;</span>
               dataGridView1<span class="token punctuation">.</span>Columns<span class="token punctuation">[</span><span class="token string">"remain"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>HeaderText <span class="token operator">=</span> <span class="token string">"剩余床位"</span><span class="token punctuation">;</span>

           <span class="token punctuation">}</span>
           <span class="token keyword">else</span>
           <span class="token punctuation">{<!-- --></span>
               dataGridView1<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> null<span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
       private bool <span class="token function">IsNotExist_OtherSex</span><span class="token punctuation">(</span>string did<span class="token punctuation">,</span> string sid<span class="token punctuation">)</span>
       <span class="token punctuation">{<!-- --></span>
           DataSet ds <span class="token operator">=</span> new <span class="token function">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据
               <span class="token punctuation">(</span>@"select <span class="token operator">*</span> from StuDormitory<span class="token punctuation">,</span>Student 
                 where StuDormitory<span class="token punctuation">.</span>ssid<span class="token operator">=</span>Student<span class="token punctuation">.</span>ssid and did<span class="token operator">=</span>'" <span class="token operator">+</span> did <span class="token operator">+</span>
                  <span class="token string">"'and sex=(select sex from Student where ssid='"</span> <span class="token operator">+</span> sid <span class="token operator">+</span> <span class="token string">"')"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
           <span class="token punctuation">{<!-- --></span>
               <span class="token keyword">return</span> true<span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
           <span class="token keyword">else</span>
           <span class="token punctuation">{<!-- --></span>
               ds <span class="token operator">=</span> database<span class="token punctuation">.</span>获取数据
               <span class="token punctuation">(</span>@"select <span class="token operator">*</span> from StuDormitory
                 where  did<span class="token operator">=</span><span class="token char">'" + did + "'</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span>ds <span class="token operator">!=</span> null<span class="token punctuation">)</span>
               <span class="token punctuation">{<!-- --></span>
                   <span class="token keyword">return</span> false<span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
               <span class="token keyword">else</span> <span class="token keyword">return</span> true<span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
</code></pre>
<p>编写获取空余宿舍和分配宿舍学生信息更新两个方法，方便后面点击事件的更新和获取学生、宿舍信息数据的代码编写。编写判断原宿舍的成员性别和添加的学生性别是否一致，不一致就拒绝添加。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> 男生<span class="token function">rb_CheckedChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//分配宿舍查询男生信息</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>男生rb<span class="token punctuation">.</span>Checked <span class="token operator">==</span> true<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                string str <span class="token operator">=</span> <span class="token string">"select * from Student where ssid not in(select ssid from StuDormitory) and sex='男'"</span><span class="token punctuation">;</span>
                分配宿舍学生信息更新<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> 女生<span class="token function">rb_CheckedChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//分配宿舍查询女生信息</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>女生rb<span class="token punctuation">.</span>Checked <span class="token operator">==</span> true<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                string str <span class="token operator">=</span> <span class="token string">"select * from Student where ssid not in(select ssid from StuDormitory)  and sex='女'"</span><span class="token punctuation">;</span>
                分配宿舍学生信息更新<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> <span class="token function">allrb_CheckedChanged</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//分配宿舍查询所有信息</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>allrb<span class="token punctuation">.</span>Checked<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                string str <span class="token operator">=</span> <span class="token string">"select * from Student where ssid not in(select ssid from StuDormitory )"</span><span class="token punctuation">;</span>
                分配宿舍学生信息更新<span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre>
<p>编写按钮点击事件，实现对未分配宿舍的学生进行宿舍分配。</p>
<pre><code class="prism language-c">代码如下：
        private <span class="token keyword">void</span> 分配宿舍查询<span class="token function">_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span><span class="token comment">//分配宿舍查询空宿舍信息</span>
        <span class="token punctuation">{<!-- --></span>
            获取空余宿舍<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        private <span class="token keyword">void</span> 分配宿舍<span class="token function">Bt_Click</span><span class="token punctuation">(</span>object sender<span class="token punctuation">,</span> EventArgs e<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>分配宿舍宿舍编号txt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">||</span> 分配宿舍学号txt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"缺少选中数据!"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsNotExist_OtherSex</span><span class="token punctuation">(</span>分配宿舍宿舍编号txt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 分配宿舍学号txt<span class="token punctuation">.</span>Text<span class="token punctuation">.</span><span class="token function">Trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"该宿舍已经有其他性别的学生!"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                try
                <span class="token punctuation">{<!-- --></span>
                    string str2 <span class="token operator">=</span> @"
                   insert into StuDormitory <span class="token function">values</span><span class="token punctuation">(</span><span class="token char">'" + 分配宿舍宿舍编号txt.Text.Trim() + "'</span><span class="token punctuation">,</span><span class="token char">'" + 分配宿舍学号txt.Text.Trim() + "'</span><span class="token punctuation">)</span>"<span class="token punctuation">;</span>
                    database<span class="token punctuation">.</span>更新<span class="token punctuation">(</span>str2<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    分配宿舍楼号txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍宿舍编号txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍宿舍号txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍学号txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍性别txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍姓名txt<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                    分配宿舍学生信息更新<span class="token punctuation">(</span>@"select <span class="token operator">*</span> from Student where not <span class="token function">exists</span><span class="token punctuation">(</span>
                select <span class="token operator">*</span> from StuDormitory where ssid<span class="token operator">=</span>Student<span class="token punctuation">.</span>ssid <span class="token punctuation">)</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    获取空余宿舍<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"操作完成"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                catch
                <span class="token punctuation">{<!-- --></span>
                    MessageBox<span class="token punctuation">.</span><span class="token function">Show</span><span class="token punctuation">(</span><span class="token string">"操作失败!"</span><span class="token punctuation">,</span> <span class="token string">"提示"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
</code></pre>
<h1><a id="_774"></a>七、系统测试(部分功能)</h1>
<h2><a id="1_775"></a>1、学生登录</h2>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/055b2f6084084442be865d0c56831101.png#pic_center"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2775ba43759b4e49984a301a2071bc3d.png#pic_center"/></p>
<h3><a id="1_779"></a>（1）查看个人信息：</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ef2012850b574839a9df79ba3b5d1a26.png#pic_center"/></p>
<h3><a id="2_781"></a>（2）查看宿舍信息：</h3>
<p>可以查看宿舍成员以及宿舍的基本信息。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/eca339e9547a4b328c1d85b968379fd0.png#pic_center"/></p>
<h3><a id="3_784"></a>（3）申请更换宿舍：</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d2a51db0bff742d9be98542069a9b6ab.png#pic_center"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/23f27dbff0ac49ddbeb3afe2c5fc33c3.png#pic_center"/><br/> 学生提交申请更换宿舍的请求，最后一个列数值为1表示还未被处理。</p>
<h2><a id="21_788"></a>2、管理人员登录（用权限为1管理员登录可以进行所有操作）：</h2>
<h3><a id="1_789"></a>（1）宿舍楼管理：</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/cf45de789b2244aca6fbe92be5ecbce9.png#pic_center"/><br/> 添加宿舍楼：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e05f1ba4e11e454b808703085c37c492.png#pic_center"/><br/> 修改宿舍楼信息：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/221439c44843415db96256b4b00a35f9.png#pic_center"/><br/> 删除宿舍楼信息：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d2f865e8be41446b9ce6490d07470d5c.png#pic_center"/></p>
<h3><a id="2_797"></a>（2）宿舍管理：</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/3ef6c306611347e8a93e5c203232b5dd.png#pic_center"/><br/> 添加宿舍信息：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/99c989288b8842fab842e8c9c118eeec.png#pic_center"/><br/> 删除宿舍信息：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/4371fe33a94041dcb16bfd56bd38eb0e.png#pic_center"/><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1b5df552067c4343856631d9ac7823fe.png#pic_center"/></p>
<hr/>
<h1><a id="_807"></a>总结</h1>
<p>此次课程设计使用了SQL Server与VS中的Window 窗体应用相结合，根据实际情况进行需求分析，设计学生宿舍管理系统。该系统解决高校传统方式进行学生宿舍管理的缺点，极大提高了学生宿舍管理的效率。系统还存在许多功能没有完善，例如对宿舍报修的处理、对宿舍放假回家的出入统计等功能。接下来可以继续增添这方面的功能来完善该系统。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>