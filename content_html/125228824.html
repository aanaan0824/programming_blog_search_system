<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p> 在C#中有时需要用到调用matlab中的程序或模块，这里介绍其主要配置步骤。</p>
<p>注意，前提是电脑上已安装matlab，然后才能进行配置。如果未安装matlab，则可以通过将需要调用的matlab模块编译为dll文件供C#调用，其具体步骤不再详细说明，可以自行查阅其他博主的博客。</p>
<h1 style="margin-left:.0001pt;text-align:justify;">第1步</h1>
<p style="margin-left:.0001pt;text-align:justify;">打开matlab，在命令窗口中输入“mex -setup”，回车后，选择 “mex –setup C++”。</p>
<p><img alt="" height="185" src="image\cef884ec4195463592ef09501019229a.png" width="553"/></p>
<p> 完成后，可见“MEX configured to…”提示。</p>
<p><img alt="" height="158" src="image\ca0cadf743e94c7e9e3935d463839408.png" width="553"/></p>
<h1> 第2步</h1>
<p style="margin-left:.0001pt;text-align:justify;">打开Visual Studio，新建项目。</p>
<p style="margin-left:.0001pt;text-align:justify;">在解决方案资源管理器中，右键 “引用”，选择“添加引用”。</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="203" src="image\be631ca5a58a47b2b313c773aa47f4da.png" width="294"/></p>
<p> 在“COM”中，选择“Matlab Application”，确定。</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="267" src="image\fcb92c4a02b04041a6a495605bdff26b.png" width="346"/></p>
<h1 style="margin-left:.0001pt;text-align:justify;">第3步</h1>
<p style="margin-left:.0001pt;text-align:justify;">在代码中，加上、</p>
<pre><code class="language-cs">using MLApp;</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">然后定义一个对象</p>
<pre><code class="language-cs">MLAPPCLass myMatlab = new MLApp();</code></pre>
<p> <img alt="" height="304" src="image\c9b319fdcee84d2f92fc1620bf01fd3e.png" width="470"/></p>
<p> 此时会报错：</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="115" src="image\ecebd08545764ac9bc55535b19e67bf2.png" width="319"/></p>
<p> 这时，右键“MLApp”，点击“属性”。</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="121" src="image\2fa3112d17df4e698b8908ca3d232360.png" width="289"/></p>
<p> 将 “嵌入互操作类型”改为 “False”即可。</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="278" src="image\6f9bc142163941c5aba5fb94d0ce25db.png" width="239"/></p>
<h1 style="margin-left:.0001pt;text-align:justify;">第4步</h1>
<p style="margin-left:.0001pt;text-align:justify;">需要执行matlab程序时，可以输入</p>
<pre><code class="language-cs">myMatlab.Execute("str = ‘helloworld’;");</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">需要读取matlab中的变量时，可以输入</p>
<pre><code class="language-cs">string str = (string)myMatlab.GetVariable("str", "base");</code></pre>
<p></p>
</div>
</div>