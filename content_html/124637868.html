<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p id="main-toc"><strong>目录</strong></p>
<p id="-toc" style="margin-left:0px;"></p>
<p id="1%E3%80%81selenium%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#1%E3%80%81selenium%E7%AE%80%E4%BB%8B">1、selenium简介</a></p>
<p id="2%E3%80%81%E7%8E%AF%E5%A2%83%20Python%20%2B%20selenium-toc" style="margin-left:0px;"><a href="#2%E3%80%81%E7%8E%AF%E5%A2%83%20Python%20%2B%20selenium">2、环境 Python + selenium</a></p>
<p id="2.1%E3%80%81selenium%E5%BA%93%E5%AE%89%E8%A3%85-toc" style="margin-left:80px;"><a href="#2.1%E3%80%81selenium%E5%BA%93%E5%AE%89%E8%A3%85">2.1、selenium库安装</a></p>
<p id="2.2%E3%80%81%E9%A9%B1%E5%8A%A8%E4%B8%8B%E8%BD%BD-toc" style="margin-left:80px;"><a href="#2.2%E3%80%81%E9%A9%B1%E5%8A%A8%E4%B8%8B%E8%BD%BD">2.2、驱动下载</a></p>
<p id="2.3%E3%80%81%E9%A9%B1%E5%8A%A8%E4%BD%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8-toc" style="margin-left:80px;"><a href="#2.3%E3%80%81%E9%A9%B1%E5%8A%A8%E4%BD%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8">2.3、驱动位置与使用</a></p>
<p id="3%E3%80%81selenium%E5%BA%93%E4%BB%A3%E7%A0%81%E8%AE%B2%E8%A7%A3-toc" style="margin-left:0px;"><a href="#3%E3%80%81selenium%E5%BA%93%E4%BB%A3%E7%A0%81%E8%AE%B2%E8%A7%A3">3、selenium库代码讲解</a></p>
<p id="3.1%E3%80%81id-toc" style="margin-left:80px;"><a href="#3.1%E3%80%81id">3.1、id</a></p>
<p id="3.1%E3%80%81name-toc" style="margin-left:80px;"><a href="#3.1%E3%80%81name">3.1、name</a></p>
<p id="3.3%E3%80%81Class-toc" style="margin-left:80px;"><a href="#3.3%E3%80%81Class">3.3、Class</a></p>
<p id="3.4%E3%80%81tag-toc" style="margin-left:80px;"><a href="#3.4%E3%80%81tag">3.4、tag</a></p>
<p id="3.5%E3%80%81Link-toc" style="margin-left:80px;"><a href="#3.5%E3%80%81Link">3.5、Link</a></p>
<p id="3.6%E3%80%81xpath-toc" style="margin-left:80px;"><a href="#3.6%E3%80%81xpath">3.6、xpath</a></p>
<p id="3.7%E3%80%81css%E9%80%89%E6%8B%A9%E5%99%A8-toc" style="margin-left:80px;"><a href="#3.7%E3%80%81css%E9%80%89%E6%8B%A9%E5%99%A8">3.7、css选择器</a></p>
<p id="3.8%E3%80%81js%E6%89%A7%E8%A1%8C-toc" style="margin-left:80px;"><a href="#3.8%E3%80%81js%E6%89%A7%E8%A1%8C">3.8、js执行</a></p>
<p id="4%E3%80%81selenium%E5%B0%81%E8%A3%85-toc" style="margin-left:0px;"><a href="#4%E3%80%81selenium%E5%B0%81%E8%A3%85">4、selenium封装</a></p>
<p id="4.1%E3%80%81%E8%AE%BE%E8%AE%A1%E8%A7%84%E5%88%99-toc" style="margin-left:80px;"><a href="#4.1%E3%80%81%E8%AE%BE%E8%AE%A1%E8%A7%84%E5%88%99">4.1、设计规则</a></p>
<p id="4.2%E3%80%81%E7%A1%AE%E8%AE%A4%E5%85%A5%E5%8F%A3%E5%87%BD%E6%95%B0-toc" style="margin-left:80px;"><a href="#4.2%E3%80%81%E7%A1%AE%E8%AE%A4%E5%85%A5%E5%8F%A3%E5%87%BD%E6%95%B0">4.2、确认入口函数</a></p>
<p id="4.3%E3%80%81%E8%AE%BE%E8%AE%A1%E9%80%BB%E8%BE%91-toc" style="margin-left:80px;"><a href="#4.3%E3%80%81%E8%AE%BE%E8%AE%A1%E9%80%BB%E8%BE%91">4.3、设计逻辑</a></p>
<p id="4.4%E3%80%81%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85-toc" style="margin-left:80px;"><a href="#4.4%E3%80%81%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85">4.4、代码封装</a></p>
<hr id="hr-toc"/>
<p></p>
<h1 id="1%E3%80%81selenium%E7%AE%80%E4%BB%8B" style="text-align:justify;"><strong>1、selenium简介</strong></h1>
<p style="margin-left:.0001pt;text-align:justify;">         Selenium是一个用于Web应用程序测试的工具，Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。支持的浏览器包括IE（7, 8, 9, 10, 11），<a href="https://baike.baidu.com/item/Mozilla%20Firefox/3504923" title="Mozilla Firefox">Mozilla Firefox</a>，<a href="https://baike.baidu.com/item/Safari/597" title="Safari">Safari</a>，<a href="https://baike.baidu.com/item/Google/86964" title="Google">Google</a> <a href="https://baike.baidu.com/item/Chrome/5633839" title="Chrome">Chrome</a>，<a href="https://baike.baidu.com/item/Opera/25140" title="Opera">Opera</a>，Edge等; 支持的开发语言有Java、Python、C#、ruby。</p>
<p style="margin-left:.0001pt;text-align:justify;">   2004年selenium诞生</p>
<p style="margin-left:.0001pt;text-align:justify;">   2006年webdriver诞生</p>
<p style="margin-left:.0001pt;text-align:justify;">   2008年selenium与webdriver合并selenium2.0</p>
<p style="margin-left:.0001pt;text-align:justify;">   2016年selenium3.0诞生</p>
<p style="margin-left:.0001pt;text-align:justify;">   2021年selenium4.0诞生</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="314" src="image\19bead0423864ff69d4afc8d75bf087f.png" width="645"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>Selenium IDE</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">        嵌入到FIrefox浏览器中的一个插件，实现简单的浏览器操作的录制和回放功能，应用场景：快速的创建bug重现场景，在测试人员测试过程中，发现bug之后可以通过IDE将重现的步骤录制下来，以帮助开发人员更容易的重现bug</p>
<p style="margin-left:.0001pt;text-align:justify;">IDE录制的脚本可以转换为多种语言。从而帮助我们快速的开发脚本</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">Ps: 按经验建议尽量少用录制，在人工智能没发展到一定程度，这是一条歪路。</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>Selenium RC</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">                Selenium RC 是Selenium家族的核心部分。Selenium RC 支持多种不同语言编写的自动化脚本测试，通过Selenium RC服务器作为代理服务器去访问应用，从而达到测试的目的。</p>
<p style="margin-left:.0001pt;text-align:justify;">Selenium RC分为Client Libraries和Selenium Server。Client Libraries库主要用于编写测试脚本，用来控制Selenium Server的库。Selenium Server 负责控制浏览器行为。总的来说，Selenium Server 包括三个部分：Launcher、Http Proxy和Core。其中，Selenium Core是被Selenium Server嵌入到浏览器页面中。其实<strong><strong>Selenium Core就是一堆JavaScript函数的集合</strong></strong>，即通过这些javascript函数我们才能实现用程序对浏览器的操作。Launcher用于启动浏览器，把Selenium Core加载到浏览器页面当中，并把浏览器的代理设置为Selenium Server的Http Proxy。</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">Ps: 建议做WEB自动化过程中可以顺便将js学会。</p>
<h1 style="text-align:justify;"></h1>
<h1 id="2%E3%80%81%E7%8E%AF%E5%A2%83%20Python%20%2B%20selenium" style="text-align:justify;"><strong>2、环境 Python + selenium</strong></h1>
<h3 id="2.1%E3%80%81selenium%E5%BA%93%E5%AE%89%E8%A3%85" style="text-align:justify;"><a name="_Toc26720"></a><strong>2.1、selenium库安装</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">命令：pip insatll selenium  或 pip3 install selenium</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="149" src="image\a66d6d69b0234a8fbea5eecfbcddd08b.png" width="695"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="2.2%E3%80%81%E9%A9%B1%E5%8A%A8%E4%B8%8B%E8%BD%BD" style="text-align:justify;"><a name="_Toc25860"></a><strong>2.2、驱动下载</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">浏览器驱动下载 chrome  （ie、火狐可自行学习）</p>
<ul><li style="text-align:justify;">确认谷歌浏览器版本，操作如下图，确认版本为100.0.4896.127</li></ul>
<p style="text-align:justify;"><img alt="" height="583" src="image\22d9442907b448858a5b07f391366e56.png" width="1200"/></p>
<p></p>
<ul><li style="text-align:justify;">针对浏览器版本去下载对应的驱动</li></ul>
<p style="margin-left:.0001pt;text-align:justify;">        大家可以自行去www.baidu.com搜索谷歌浏览器驱动找到后下载，不过这个过程可能比较久。在这里提供所有版本的下载连接</p>
<p style="margin-left:.0001pt;text-align:justify;"><a href="http://chromedriver.storage.googleapis.com/index.html" title="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a></p>
<p style="margin-left:.0001pt;text-align:justify;"><span style="color:#494949;">        </span>进入网站找到对应版本的驱动下载，上图版本是100.0.4896.127，是以要找到对应版本下载，如果找不到对应版本，可以找最相近的版本。也是可以用来驱动浏览器的，不能用一定会有对应版本出现；现在没有找到100.0.4896.127版本，所以找到最接近版本100.0.4896.60下载</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="908" src="image\b811472e56d34e95bf2b3611d073d4b6.png" width="1144"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">        选择当前系统所对应的版本，像window版本，直接下win32的包，不用担心64位系统。通用，如果不通用，肯定会有一个win64的包。</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="277" src="image\b45b83a67a374faea19ace0413df2981.png" width="664"/></p>
<p>将下载的zip压缩包解压出来的chromedriver.exe的文件</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="221" src="image\33cdd1ba2f0b401da170eb04b72ff306.png" width="147"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="2.3%E3%80%81%E9%A9%B1%E5%8A%A8%E4%BD%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8" style="text-align:justify;"><a name="_Toc30268"></a><strong>2.3、驱动位置与使用</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        驱动位置有两种，这里讲灵活放置法，规范放置法大家可当课题自行去研究。</p>
<p style="margin-left:.0001pt;text-align:justify;">灵活放置是将驱动文件放到selenium执行代码文件同级目录下即可。</p>
<p style="margin-left:.0001pt;text-align:justify;">举例：</p>
<p style="margin-left:.0001pt;text-align:justify;">新增一个python项目，然后将chromedriver.exe文件放到项目目录下</p>
<p style="margin-left:.0001pt;text-align:justify;">新增一个demo01.py文件在文件里编写打开百度的代码</p>
<p style="margin-left:.0001pt;text-align:justify;">from selenium import webdriver<br/> dr = webdriver.Chrome()<br/> dr.get('https://www.baidu.com')</p>
<p style="margin-left:.0001pt;text-align:justify;">运行。如下图，成功打开谷歌浏览器，访问百度网站</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="text-align:justify;"><img alt="" height="640" src="image\a0aca02d70484857ad133c2f7532df8c.png" width="1200"/></p>
<p></p>
<p></p>
<h1 id="3%E3%80%81selenium%E5%BA%93%E4%BB%A3%E7%A0%81%E8%AE%B2%E8%A7%A3" style="text-align:justify;"><strong>3、selenium库代码讲解</strong></h1>
<p style="margin-left:.0001pt;text-align:justify;">        使用selenium之前，需要先了解一些网页元素定位的知识，结合这些知识来实现元素定位后点击，编辑等</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>如何手动进行元素定位？</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">        打开浏览器---f12进入开发者模式---在Elements页面---使用选择工具去页面点击对应元素---HTML将自动展开并高亮显示选择到的元素标记</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>重要知识点</strong></strong></p>
<ol><li style="text-align:justify;"><strong><strong>find_element()  与 find_elements() 方法</strong></strong></li><li style="text-align:justify;"><strong><strong>元素定位八大方式</strong></strong></li></ol>
<p style="margin-left:.0001pt;text-align:justify;">将上面两点结合起来讲解，如下：</p>
<p style="margin-left:.0001pt;text-align:justify;">3.1~3.7介绍定位八大方式，3.8是讲js独立脚本</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="3.1%E3%80%81id" style="text-align:justify;"><a name="_Toc19736"></a><strong>3.1、id</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        在网页HTML中发现有一个元素刚好有id属性，很幸运，因id基本上需要唯一，不然Doc会出现未知异常。我们可以使用其定位出来这元素来实现对应操作。因为它是唯一的，所以一般可以使用find_element()来定位</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例：</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">进入百度，搜索’路飞’，</p>
<p style="margin-left:.0001pt;text-align:justify;">可以通过 f12在html里知道百度搜索框架的id是kw，搜索按钮的id是su</p>
<p style="margin-left:.0001pt;text-align:justify;">所以编写代码如下：</p>
<pre><code class="language-python">#导入库

from selenium import webdriver
from selenium.webdriver.common.by import By

#初始化浏览器
dr = webdriver.Chrome()



#打开百度
dr.get('https://www.baidu.com')

#输入路飞
dr.find_element(By.ID, 'kw').send_keys('路飞')

#点击百度一下
dr.find_element(By.ID, 'su').click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">在最开始需要将 selenium 的 webdriver与By 导入</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">在输入路径语句中查询元素方法find_element里参数一By.ID表示定位属性是id，参数二表示属性值为kw</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="833" src="image\a8eba83a503947698af72ea0771db884.png" width="1200"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="3.1%E3%80%81name" style="text-align:justify;"><a name="_Toc3007"></a><strong>3.1、name</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        在网页HTML中发现有一个元素有name属性，也很幸运，因为开发能添加name，也是要给其标记，将其与其他元素区别。我们可以使用其定位出来这元素来实现对应操作。</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例：</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">还是进入百度，搜索’诸葛亮’</p>
<p style="margin-left:.0001pt;text-align:justify;">可以通过 f12在html里知道百度搜索框的name是<span style="background-color:#ffffff;"><span style="color:#202124;">wd</span></span>，搜索按钮的id是su</p>
<p style="margin-left:.0001pt;text-align:justify;">所以编写代码如下：（在上面已经导包了，下面的代码就不导包了）</p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.baidu.com')
dr.find_element(By.NAME, 'wd').send_keys('诸葛亮')
dr.find_element(By.ID, 'su').click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">可以见输入诸葛亮这条语句查询元素方法find_element参数一由 By.NAME表示用name定位，参数二也是取name的值wd</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="803" src="image\36c54a03143b45c09660520ad12de0b4.png" width="1200"/></p>
<p></p>
<h3 id="3.3%E3%80%81Class" style="text-align:justify;"><a name="_Toc28326"></a><strong>3.3、Class</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        网页HTML一般都会有class属性，前端开发者会用其来归类批量添加样式，所以它可能不是唯一的标识。这里我们可能会使用find_elements()来获取</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例：</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN，点击分类</p>
<p style="margin-left:.0001pt;text-align:justify;">使用f12查看CSDN的HTML，发现在所有分类元素的class均是<span style="background-color:#ffffff;"><span style="color:#202124;">navigation-right</span></span></p>
<p style="margin-left:.0001pt;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#202124;">所以代码编写如下</span></span></p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
#点击第一个分类
dr.find_elements(By.CLASS_NAME, 'navigation-right')[0].click()
#等待3秒
time.sleep(3)
#点击第一个分类
dr.find_elements(By.CLASS_NAME, 'navigation-right')[1].click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">可以见点击查询元素方法find_element参数一由 By.CLASS_NAME表示了要取class定位，参数二则是给出class的值</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="760" src="image\701bb03c0e0445dab4accb1a9cff3bd9.png" width="1200"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="3.4%E3%80%81tag" style="text-align:justify;"><a name="_Toc25549"></a><strong>3.4、tag</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        tag是网页HTML中的标记，HTML由标记组成，一个标记就是一个元素，所以它基本上不会唯一，所以也使用find_elemenets()来获取</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例：</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN，点击头条新闻</p>
<p style="margin-left:.0001pt;text-align:justify;">使用F12查看CSDN的HTML，发现头条新闻的分类元素的标签是<span style="background-color:#ffffff;"><span style="color:#202124;">dl</span></span></p>
<p style="margin-left:.0001pt;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#202124;">所以代码编写如下</span></span></p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
dr.find_elements(By.TAG_NAME, 'dl')[0].click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">可以见点击查询元素方法find_element参数一由 By.TAG_NAME表示了要取tag定位，参数二则是给出tag名</p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行结果如下</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="802" src="image\0463ebf3426845a591663c47c47fdc02.png" width="1200"/></p>
<p></p>
<h3 id="3.5%E3%80%81Link" style="text-align:justify;"><a name="_Toc31602"></a><strong>3.5、Link</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        Link表示包含有属性href = “https://www.xxxxxxx.com”元素，可以通过linktext定位，linktext是页面上展示的文字。它还可以部分linktext定位。</p>
<p style="margin-left:.0001pt;text-align:justify;">网上很多文章将linktext通过全linktext与部分linktext区分为两种定位方式，没有本文最后的JS定位方式，也是对的。</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">举例：</p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN，点击分类</p>
<p style="margin-left:.0001pt;text-align:justify;">使用F12查看CSDN的HTML,发现分类都是有href属性的，可以用linktext定位</p>
<p style="margin-left:.0001pt;text-align:justify;">所以代码编写如下：</p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
#通过linetext点击‘Java’分类
dr.find_element(By.LINK_TEXT, 'Java').click()
time.sleep(3)
#通过部分linktext点击‘人工智能’分类
dr.find_element(By.PARTIAL_LINK_TEXT, '人工智').click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">参数一By.LINK_TEXT表示全部匹配linktext定位找到元素，参数二值是页面这个链接的全部文案‘Java’</p>
<p style="margin-left:.0001pt;text-align:justify;">参数一By.PARTIAL_LINK_TEXT表示模糊匹配linktext定位找到元素 ，参数二值是页面这个链接部分文案‘人工智’</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行结果如下</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="758" src="image\399bcc0c69544736b5a215ab4d47e00f.png" width="1200"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="3.6%E3%80%81xpath" style="text-align:justify;"><a name="_Toc7459"></a><strong>3.6、xpath</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        xpath是XML路径定位器，HTML与XML相似，所以也可以用xpath来定位，这个相对于前面的来说，需要大家掌握一些xpath的理论知识。</p>
<table border="1" cellspacing="0" style="margin-left:6.75pt;width:416.2pt;"><tbody><tr><td style="background-color:#eff3f5;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><strong><span style="color:#4f4f4f;"><strong>表达式</strong></span></strong></p> </td><td style="background-color:#eff3f5;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><strong><span style="color:#4f4f4f;"><strong>描述</strong></span></strong></p> </td></tr><tr><td style="background-color:#ffffff;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">nodename</span></p> </td><td style="background-color:#ffffff;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">选取此节点的所有子节点</span></p> </td></tr><tr><td style="background-color:#f7f7f7;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">/</span></p> </td><td style="background-color:#f7f7f7;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">从当前节点选取直接子节点</span></p> </td></tr><tr><td style="background-color:#ffffff;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">//</span></p> </td><td style="background-color:#ffffff;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">从当前节点选取子孙节点</span></p> </td></tr><tr><td style="background-color:#f7f7f7;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">.</span></p> </td><td style="background-color:#f7f7f7;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">选取当前节点</span></p> </td></tr><tr><td style="background-color:#ffffff;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">. .</span></p> </td><td style="background-color:#ffffff;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">选取当前节点的父节点</span></p> </td></tr><tr><td style="background-color:#f7f7f7;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">@</span></p> </td><td style="background-color:#f7f7f7;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">选取属性</span></p> </td></tr><tr><td style="background-color:#f7f7f7;width:135pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">*</span></p> </td><td style="background-color:#f7f7f7;width:281.2pt;"> <p style="margin-left:.0001pt;text-align:center;"><span style="color:#4f4f4f;">任何元素</span></p> </td></tr></tbody></table>
<p style="margin-left:.0001pt;text-align:justify;">   </p>
<p style="margin-left:.0001pt;text-align:justify;">       xpath定位逻辑是通过id、name、class等属性定位到一个大范围元素然后再通过路 径 定位到精准元素；针对定位到多个元素时也可以下标取值，但下标从1开始。可以 用 xpath定位到任何元素</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">表格的内容弄懂后，但并不一定会用到，懂了是让自己知道xpath是如何定位的；实战中基本上用到xpath定位时，一般使用浏览器f12里面copy xpath功能，获取到对应元素的xpath（老手一般是自己写xpath,因为F12有时复制的xpath不是最精简的）</p>
<p style="margin-left:.0001pt;text-align:justify;">比如我要获取CSDN技术树元素的xpath,只需要按照下图箭头的顺序点击，即可获取到对应的xpath了</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="841" src="image\1c8146f243d24d3bb11a35a450e68491.png" width="967"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">然后用基来举例：</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例：</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN，点击技能树元素</p>
<p style="margin-left:.0001pt;text-align:justify;">通过F12里的copy xpath功能可以知道技能树元素的xpath为//*[@id="www-home-right"]/div[1]/div[2]/div[1]/div/span</p>
<p style="margin-left:.0001pt;text-align:justify;">所以代码编写如下</p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
dr.find_element(By.XPATH, '//*[@id="www-home-right"]/div[1]/div[2]/div[1]/div/span').click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">参数一By.XPATH表示使用xpath方式定位，参数二是给元素xpath值</p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="833" src="image\03de11f3c08b4d5ca040a5e146a3e7d8.png" width="1200"/></p>
<p></p>
<h3 id="3.7%E3%80%81css%E9%80%89%E6%8B%A9%E5%99%A8" style="text-align:justify;"><a name="_Toc21602"></a><strong>3.7、css选择器</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">        css是前端样式，这里说的css定位是用css样式里定位元素用的方法叫做css选择器。</p>
<p style="margin-left:.0001pt;text-align:justify;">符号.代表class,  符号 # 代表id， 路径空格写tag名</p>
<p style="margin-left:.0001pt;text-align:justify;">        它与xpath一样，可以定位到任何元素，也可以直接通过F12的copy selector来取 得元素的css选择器</p>
<p style="margin-left:.0001pt;text-align:justify;"><strong><strong>举例</strong></strong></p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN, 点击CSDN指数元素</p>
<p style="margin-left:.0001pt;text-align:justify;">通过f12里的copy selector取得元素的css选择器为：#www-home-right &gt; div.www-home-silde &gt; div.ContentBlock &gt; div:nth-child(1) &gt; div &gt; span</p>
<p style="margin-left:.0001pt;text-align:justify;">所以代码编写如下</p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
dr.find_element(By.CSS_SELECTOR, '#www-home-right &gt; div.www-home-silde &gt; div.ContentBlock &gt; div:nth-child(2) &gt; div &gt; span').click()</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">参数一By.CSS_SELECTOR表示使用css方式定位，参数二是给元素css选择器</p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下：</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="711" src="image\572cfdc2853b4382898c59e203d64bfe.png" width="1200"/></p>
<p></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="3.8%E3%80%81js%E6%89%A7%E8%A1%8C" style="text-align:justify;"><a name="_Toc5921"></a><strong>3.8、js执行</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">js不是定位器</p>
<p style="margin-left:.0001pt;text-align:justify;">js不是定位器</p>
<p style="margin-left:.0001pt;text-align:justify;">js不是定位器</p>
<p style="margin-left:.0001pt;text-align:justify;">js是javascript，是可以独以运行的脚本；不使用selenium的方法，进行页面元素的点击、输入、拖拽等等操作，像如果对js使用很熟练，那么也就完全不需要管上面的定位方式。全部可以使用js来实现页面元素的各种操作。</p>
<p style="margin-left:.0001pt;text-align:justify;">像滚动条拖拽是没法用元素定位操作的，只能使用js</p>
<p style="margin-left:.0001pt;text-align:justify;">举例：（新手经典问题）</p>
<p style="margin-left:.0001pt;text-align:justify;">进入CSDN，拖拽滚动条</p>
<p style="margin-left:.0001pt;text-align:justify;">滚动条拖拽的js为document.documentElement.scrollTop=10000</p>
<p style="margin-left:.0001pt;text-align:justify;">代码编写如下</p>
<pre><code class="language-python">dr = webdriver.Chrome()
dr.get('https://www.csdn.net/')
dr.execute_script('document.documentElement.scrollTop=10000')</code></pre>
<p style="margin-left:.0001pt;text-align:justify;">使用exeute_script执行JS </p>
<p style="margin-left:.0001pt;text-align:justify;">代码执行如下</p>
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="771" src="image\2fc6a17874eb41d4b7ef8bf666a21782.png" width="1200"/></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h1 id="4%E3%80%81selenium%E5%B0%81%E8%A3%85" style="text-align:justify;"><strong>4、selenium封装</strong></h1>
<p style="margin-left:.0001pt;text-align:justify;">        上面讲了selenium八大元素定位方式，但做自动化肯定不是一直写这样的python代码，因为时间与空间上都浪费人力，不如功能测试，所以我们需要学会去二次封装selenium。将其制定成规则化的自然代码来让自动化变得简单易懂。</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="4.1%E3%80%81%E8%AE%BE%E8%AE%A1%E8%A7%84%E5%88%99" style="text-align:justify;"><a name="_Toc18814"></a><strong>4.1、设计规则</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">一、做自动化是模拟人的操作，所以有操作字段：点击、输入等</p>
<p style="margin-left:.0001pt;text-align:justify;">二、定位元素需要定位方式，所以有定位器字段：id、name、class、tag、link、plink、xpath、css、js</p>
<p style="margin-left:.0001pt;text-align:justify;">三、定位器有了，定位器的对象字段也要有</p>
<p style="margin-left:.0001pt;text-align:justify;">四、页面相同属性的元素有多个，所以需要一个下标字段</p>
<p style="margin-left:.0001pt;text-align:justify;">五、输入、下拉、检查需要值，所以值字段也需要一个</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">基本上暂时可以先确定这些字段:</p>
<p style="margin-left:.0001pt;text-align:justify;">operation、type、locatuion、index、value</p>
<h3 id="4.2%E3%80%81%E7%A1%AE%E8%AE%A4%E5%85%A5%E5%8F%A3%E5%87%BD%E6%95%B0" style="text-align:justify;"><a name="_Toc20117"></a><strong>4.2、确认入口函数</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">设计好五个参数后，基本上操作就只需要这五个参数了，所以需要一个统一入口函数，将这五个参数均带入其实。</p>
<p style="margin-left:.0001pt;text-align:justify;">def web_autotest_opr(operation, type, locatuion, index, value)</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="4.3%E3%80%81%E8%AE%BE%E8%AE%A1%E9%80%BB%E8%BE%91" style="text-align:justify;"><a name="_Toc4348"></a><strong>4.3、设计逻辑</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">一、封装浏览器打开功能，返回浏览器对象</p>
<p style="margin-left:.0001pt;text-align:justify;">二、封装入口函数</p>
<p style="margin-left:.0001pt;text-align:justify;">三、封装定位元素方式</p>
<p style="margin-left:.0001pt;text-align:justify;">四、封装元素操作方式</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<h3 id="4.4%E3%80%81%E4%BB%A3%E7%A0%81%E5%B0%81%E8%A3%85" style="text-align:justify;"><a name="_Toc17266"></a><strong>4.4、代码封装</strong></h3>
<p style="margin-left:.0001pt;text-align:justify;">from selenium import webdriver<br/> from selenium.webdriver.common.by import By<br/><br/> def open_url(url):<br/>     '''<br/>     打开浏览顺访问url，并返回浏器操作句柄<br/>     :param url: 要测试的网站url<br/>     :return: webdriver对像<br/>     '''<br/>     opr = webdriver.Chrome()<br/>     opr.get(url)<br/>     return opr<br/><br/><br/> def get_element(opr:webdriver.Chrome, type, locatuion, index):<br/>     '''<br/>     获取元素并返回<br/>     :param opr: 浏览器句柄<br/>     :param type: 定位器类型<br/>     :param locatuion: 定位器<br/>     :param index: 下标<br/>     :return: 元素对象<br/>     '''<br/>     if str.lower(type) == 'id':<br/>         return opr.find_elements(By.ID, locatuion)[index]<br/>     elif str.lower(type) == 'name':<br/>         return opr.find_elements(By.NAME, locatuion)[index]<br/>     elif str.lower(type) == 'class':<br/>         return opr.find_elements(By.CLASS_NAME, locatuion)[index]<br/>     elif str.lower(type) == 'tag':<br/>         return opr.find_elements(By.TAG_NAME, locatuion)[index]<br/>     elif str.lower(type) == 'link':<br/>         return opr.find_elements(By.LINK_TEXT, locatuion)[index]<br/>     elif str.lower(type) == 'plink':<br/>         return opr.find_elements(By.PARTIAL_LINK_TEXT, locatuion)[index]<br/>     elif str.lower(type) == 'xpath':<br/>         return opr.find_elements(By.XPATH, locatuion)[index]<br/>     elif str.lower(type) == 'css':<br/>         return opr.find_elements(By.CSS_SELECTOR, locatuion)[index]<br/><br/><br/> def element_opr(el:webdriver.Chrome.find_element, operation, value):<br/>     '''<br/>     元素操作<br/>     :param el: 元素对象<br/>     :param operation: 操作类型<br/>     :param value: 值<br/>     :return: 成功（True）or失败(False)<br/>     '''<br/>     if operation == '点击':<br/>         el.click()<br/>         return True<br/>     elif operation == '输入':<br/>         el.send_keys(value)<br/>         return True<br/><br/> def web_autotest_opr(opr:webdriver.Chrome ,operation, type, locatuion, index=0, value=''):<br/>     '''<br/>     元素操作统一入口<br/>     :param opr: 浏览器句柄<br/>     :param operation: 操作类型<br/>     :param type: 定位器类型<br/>     :param locatuion: 定位器<br/>     :param index: 下标<br/>     :param value: 值<br/>     :return: 成功（True）or失败(False)<br/>     '''<br/>     if str.lower(type) != 'js':<br/>         el = get_element(opr, type, locatuion, index)<br/>         result = element_opr(el, operation, value)<br/>     else:<br/>         result = opr.execute_script(locatuion)<br/>     return result</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">这一部分属于UI自动化测试框架的核心部分的封装，当然逻辑肯定不止这些，并且上面这些代码是面向过程的，等大家有实力了，可以慢慢优化这些代码，尽量变成面向对象的。</p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
<p style="margin-left:.0001pt;text-align:justify;">想了解Web自动化框架的可以进入：<a href="https://blog.csdn.net/weixin_40331132/article/details/106482043" title="Python 从无到有搭建WebUI自动化测试框架_魂尾ac的博客-CSDN博客_python ui自动化测试框架">Python 从无到有搭建WebUI自动化测试框架_魂尾ac的博客-CSDN博客_python ui自动化测试框架</a></p>
<p style="margin-left:.0001pt;text-align:justify;"></p>
</div>
</div>