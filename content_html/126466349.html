<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>æ–‡ç« ç›®å½•</h3>
<ul><li><a href="#0__5">0 å‰è¨€</a></li><li><a href="#1__26">1 ç®€ä»‹</a></li><li><a href="#2__30">2 ä¸»è¦å™¨ä»¶</a></li><li><a href="#3__35">3 å®ç°æ•ˆæœ</a></li><li><a href="#4__47">4 è®¾è®¡åŸç†</a></li><li><a href="#_61">éƒ¨åˆ†æ ¸å¿ƒä»£ç </a></li><li><a href="#5__224">5 æœ€å</a></li></ul>
</div>
<p></p>
<hr color="#000000" size='1"'/>
<h1><a id="0__5"></a>0 å‰è¨€</h1>
<p>ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚</p>
<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p>
<p>ğŸš© <strong>åŸºäºå•ç‰‡æœºçš„å¢¨æ°´å±é˜…è¯»å™¨(å•è¯å¡)</strong></p>
<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p>
<ul><li>éš¾åº¦ç³»æ•°ï¼š3åˆ†</li><li>å·¥ä½œé‡ï¼š3åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š5åˆ†</li></ul>
<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š</strong></p>
<p><a href="https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md">https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md</a></p>
<br/>
<h1><a id="1__26"></a>1 ç®€ä»‹</h1>
<p>åŸºäºesp12-få’Œæ±‰æœ”213äºŒæ‰‹ä»·ç­¾å¼€å‘ï¼Œå¯å®ç°å•è¯é˜…è¯»ã€é»˜å†™ï¼Œå¤šè¯åº“å…±å­˜ï¼Œæ”¯æŒä¸Šä¸‹ç¿»é¡µï¼Œåè‘—é˜…è¯»æ¨¡å¼æ”¯æŒæé€Ÿä¸Šä¸‹ç¿»é¡µï¼Œæ”¯æŒå¤šä¹¦ç±è¿›åº¦ä¿å­˜ï¼Œä¼‘çœ ç­‰ç­‰ï¼Œåç»­å°†å‡çº§æ›´å¤šåŠŸèƒ½å®ç°å¤šè¯­ç§æ”¯æŒç­‰ç­‰ã€‚</p>
<h1><a id="2__30"></a>2 ä¸»è¦å™¨ä»¶</h1>
<ul><li>ESP12-F</li><li>æ±‰æœ”2.13å¯¸ç”µå­ä»·ç­¾</li></ul>
<h1><a id="3__35"></a>3 å®ç°æ•ˆæœ</h1>
<p><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\d5e825c870f74da2825b000362169986.png" width="500"/><br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\8f5bb89268d444f498d3b25b8a8b5427.png" width="500"/><br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\0ade6def33fb4eaf8defd6b9aec6fd42.png" width="500"/><br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\87a17170a47e430eb4a24a74660cd54a.png" width="500"/></p>
<h1><a id="4__47"></a>4 è®¾è®¡åŸç†</h1>
<p><strong>ESP -12Fæ¨¡å—æ•´ä½“ä»‹ç»</strong><br/> è¯¥æ¨¡å—æ ¸å¿ƒå¤„ç†å™¨ ESP8266 åœ¨è¾ƒå°å°ºå¯¸å°è£…ä¸­é›†æˆäº†ä¸šç•Œé¢†å…ˆçš„ Tensilica L106 è¶…ä½åŠŸè€— 32 ä½å¾®å‹ MCUï¼Œå¸¦æœ‰ 16 ä½ç²¾ç®€æ¨¡å¼ï¼Œä¸»é¢‘æ”¯æŒ 80 MHz å’Œ160 MHzï¼Œæ”¯æŒ RTOSï¼Œé›†æˆ Wi-Fi MAC/ BB/RF/PA/LNAï¼Œæ¿è½½å¤©çº¿ã€‚è¯¥æ¨¡å—æ”¯æŒæ ‡å‡†çš„ IEEE802.11 b/g/n åè®®ï¼Œå®Œæ•´çš„ TCP/IP åè®®æ ˆã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨è¯¥æ¨¡å—ä¸ºç°æœ‰çš„è®¾å¤‡æ·»åŠ è”ç½‘åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥æ„å»ºç‹¬ç«‹çš„ç½‘ç»œæ§åˆ¶å™¨ã€‚ESP8266 æ˜¯é«˜æ€§èƒ½æ— çº¿ SOCï¼Œä»¥æœ€ä½æˆæœ¬æä¾›æœ€å¤§å®ç”¨æ€§ï¼Œä¸º WiFi åŠŸèƒ½åµŒå…¥å…¶ä»–ç³»ç»Ÿæä¾›æ— é™å¯èƒ½ã€‚<br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\db55da92dc2841ee89b2cabd1d120cad.png" width="600"/></p>
<p><strong>æ¥å£è¯´æ˜</strong><br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\b3268fcd78774a14ace0259dba3db81f.png" width="600"/><br/> <strong>æ±‰æœ”2.13å¯¸ç”µå­ä»·ç­¾</strong></p>
<p>æ±‰æœ”2.13å¯¸çš„ç”µå­ä»·ç­¾ï¼Œé—²é±¼ä¸Šé¢ä»·æ ¼æ¯”è¾ƒä¾¿å®œï¼Œå¤§éƒ¨åˆ†åœ¨7å—é’±ä¸€ä¸ª<br/> å†…æ ¸ä¸ºMSP4302553ï¼Œé©±åŠ¨åŸç†å›¾å¦‚ä¸‹ï¼š<br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="image\177ff269ed294fca9cd0828a6134f66f.png" width="600"/></p>
<h1><a id="_61"></a>éƒ¨åˆ†æ ¸å¿ƒä»£ç </h1>
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;LittleFS.h&gt;</span></span>
<span class="token comment">//#include &lt;SD.h&gt;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">key2</span>         <span class="token expression"><span class="token number">0</span>   </span><span class="token comment">//ä¸­é—´çš„æŒ‰é”®ï¼Œä¹Ÿæ˜¯çƒ§å½•æŒ‰é”®</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">key3</span>         <span class="token expression"><span class="token number">5</span>   </span><span class="token comment">//å³è¾¹çš„æŒ‰é”®ï¼Œè¿›å…¥é»˜å†™æ¨¡å¼çš„æŒ‰é”®</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">key4</span>         <span class="token expression"><span class="token number">13</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;U8g2_for_Adafruit_GFX.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;GxEPD2_BW.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"gb2312.c"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"img.c"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SPI_SPEED</span> <span class="token expression"><span class="token function">SD_SCK_MHZ</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SD_CS</span>           <span class="token expression"><span class="token number">5</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">bat_switch_pin</span>  <span class="token expression"><span class="token number">12</span>          </span><span class="token comment">// ç”µæ± ç”µå‹è¯»å–å¼€å…³</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">bat_vcc_pin</span>     <span class="token expression">A0          </span><span class="token comment">// è¯»å–ç”µæ± ç”µå‹å¼•è„šï¼Œä¸èƒ½è¶…è¿‡1V</span></span>
<span class="token comment">//#include "FS.h"</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;EEPROM.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RST_PIN</span> <span class="token expression"><span class="token number">0</span> </span><span class="token comment">// D3(0)</span></span>
<span class="token comment">//GxEPD2_BW&lt;GxEPD2_290_T94, GxEPD2_290_T94::HEIGHT&gt; display(GxEPD2_290_T94(/*CS=D8*/ SS, /*DC=D3*/ 0, /*RST=D4*/ 2, /*BUSY=D2*/ 4)); // GDEM029T94</span>
<span class="token comment">//GxEPD2_BW&lt;GxEPD2_213, GxEPD2_213::HEIGHT&gt; display(GxEPD2_213(/*CS=*/ 16, /*DC=D3*/ 0, /*RST=*/ -1, /*BUSY=*/ 4));</span>
GxEPD2_BW<span class="token operator">&lt;</span>GxEPD2_213<span class="token punctuation">,</span> GxEPD2_213<span class="token operator">::</span>HEIGHT<span class="token operator">&gt;</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token function">GxEPD2_213</span><span class="token punctuation">(</span><span class="token comment">/*CS*/</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token comment">/*DC*/</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">/*RST*/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">/*BUSY*/</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
U8G2_FOR_ADAFRUIT_GFX u8g2Fonts<span class="token punctuation">;</span>
<span class="token comment">//int dis_count = 0; //åˆ¤æ–­å±€åˆ·æˆ–å…¨åˆ·</span>
bool f_word <span class="token operator">=</span> false<span class="token punctuation">;</span>
bool flag <span class="token operator">=</span> true<span class="token punctuation">;</span>
<span class="token keyword">float</span> bat_vcc <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>                <span class="token comment">// ç”µæ± ç”µå‹</span>
<span class="token keyword">void</span> <span class="token function">power_sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä½å‹ä¼‘çœ </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"bat_data.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"displaycode.h"</span></span>
File story_dataFile<span class="token punctuation">;</span><span class="token comment">//å°è¯´</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"BookRead.h"</span></span>
<span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token class-name">uint8_t</span> chinese_gb2312<span class="token punctuation">[</span><span class="token number">253023</span><span class="token punctuation">]</span> <span class="token function">U8G2_FONT_SECTION</span><span class="token punctuation">(</span><span class="token string">"chinese_gb2312"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
   8266æ¥çº¿æ–¹å¼ï¼š
   busy--D2 4
   res--D4 2
   dc--D3 0
   cs--D8 15
   clk--D5 14
   din--D7 13
   gnd--g
   vcc--3v3
*/</span>
<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">55</span><span class="token punctuation">;</span>
bool read_state <span class="token operator">=</span> false<span class="token punctuation">;</span> <span class="token comment">//æ ‡è®°é˜…è¯»/é»˜å†™æ¨¡å¼</span>

<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
  <span class="token comment">// put your setup code here, to run once:</span>
  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å¼€å§‹"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>key2<span class="token punctuation">,</span> INPUT_PULLUP<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//INPUT_PULLUP</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>key3<span class="token punctuation">,</span> INPUT_PULLUP<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//INPUT_PULLUP</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"setup"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>RST_PIN<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>RST_PIN<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>RST_PIN<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">digitalWrite</span><span class="token punctuation">(</span>RST_PIN<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  EEPROM<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> f1 <span class="token operator">=</span> EEPROM<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> f2 <span class="token operator">=</span> EEPROM<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>f1 <span class="token operator">==</span> f2 <span class="token operator">&amp;&amp;</span> f1 <span class="token operator">==</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    EEPROM<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    EEPROM<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    EEPROM<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    EEPROM<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†u8g2è¿æ¥åˆ°display</span>
  display<span class="token punctuation">.</span><span class="token function">setRotation</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">firstPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">fillScreen</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">float</span> batVCC <span class="token operator">=</span> <span class="token function">getBatVolNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>batVCC <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token function">power_sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token comment">/*åˆ¤æ–­å½“å‰æ˜¯å­¦ä¹ æ¨¡å¼è¿˜æ˜¯å°è¯´æ¨¡å¼ */</span>
  <span class="token keyword">int</span> read_mode <span class="token operator">=</span> EEPROM<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>read_mode <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>LittleFS<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//(SD_CS, SPI_SPEED)){<!-- --></span>
      Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"SD å¯åŠ¨æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
      Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"SD æœªèƒ½æˆåŠŸå¯åŠ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å°è¯´æ¨¡å¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    display<span class="token punctuation">.</span><span class="token function">nextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">get_story_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­¦ä¹ æ­£å¸¸å¯åŠ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">init_study</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">button</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">init_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>LittleFS<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// mount the file system</span>
  <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶è·å–å¤±è´¥ï¼Œè¯·å…ˆä¸Šä¼ æ–‡ä»¶ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">init_study</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  display<span class="token punctuation">.</span><span class="token function">drawInvertedBitmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> logo<span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> GxEPD_BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//  display.drawInvertedBitmap(0, 0, logo2, 296, 128, GxEPD_BLACK);</span>
  display<span class="token punctuation">.</span><span class="token function">nextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">setPartialWindow</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å±€åˆ·æç¤ºå­—æ ·</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">setForegroundColor</span><span class="token punctuation">(</span>GxEPD_BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è®¾ç½®å‰æ™¯è‰²</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">setBackgroundColor</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>LittleFS<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// mount the file system</span>
  <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶è·å–å¤±è´¥ï¼Œè¯·å…ˆä¸Šä¼ æ–‡ä»¶ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    u8g2Fonts<span class="token punctuation">.</span><span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    u8g2Fonts<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶è·å–å¤±è´¥ï¼Œè¯·å…ˆä¸Šä¼ æ–‡ä»¶ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  display<span class="token punctuation">.</span><span class="token function">fillScreen</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>chinese_gb2312<span class="token punctuation">)</span><span class="token punctuation">;</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶è·å–æˆåŠŸ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  u8g2Fonts<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶ç³»ç»Ÿå¯ç”¨æˆåŠŸ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  String wordbookname_temp <span class="token operator">=</span> <span class="token function">selectbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>LittleFS<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>wordbookname_temp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æœ‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">" æ²¡æœ‰."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    display<span class="token punctuation">.</span><span class="token function">fillScreen</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    u8g2Fonts<span class="token punctuation">.</span><span class="token function">setFont</span><span class="token punctuation">(</span>chinese_gb2312<span class="token punctuation">)</span><span class="token punctuation">;</span>
    u8g2Fonts<span class="token punctuation">.</span><span class="token function">setCursor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    u8g2Fonts<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ä¸Šæ¬¡æ‰“å¼€æ–‡ä»¶ä¸å­˜åœ¨ï¼å°†è¿›å…¥æ–‡ä»¶ç®¡ç†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    display<span class="token punctuation">.</span><span class="token function">nextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    display<span class="token punctuation">.</span><span class="token function">setFullWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    display<span class="token punctuation">.</span><span class="token function">fillScreen</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">draw_word_file_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  display<span class="token punctuation">.</span><span class="token function">nextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">power_sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  display<span class="token punctuation">.</span><span class="token function">setFullWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">fillScreen</span><span class="token punctuation">(</span>GxEPD_WHITE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">drawInvertedBitmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> low_power<span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> GxEPD_BLACK<span class="token punctuation">)</span><span class="token punctuation">;</span>
  display<span class="token punctuation">.</span><span class="token function">nextPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ESP<span class="token punctuation">.</span><span class="token function">deepSleep</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
<span class="token punctuation">}</span>

</code></pre>
<br/>
<h1><a id="5__224"></a>5 æœ€å</h1>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>