<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-tomorrow-night" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p>先来说说当下市场开发使用的问题，目前2021年使用vue3开发的企业还是少，基本上都还是以vue2的形式进行开发，vue3的开发模式跟react很像，这时候有人就会想那我学vue3有用么，淦，他喵的，先别激动，冷静听我说说，vue3对于现在企业来说都在慢慢的把一些vue2的东西进行升级，这个非常关键，因为vue2中可以使用vue3的方法，vue3不能使用vue2，你连vue2都没有搞定，还拿个锤子去搞vue3，我们先来看看vue3和vue2的一些区别<br/> <img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/1ecb742095304499b21c778e8bea0e3d.gif"/></p>
<h2><a id="1webpackvite_3"></a>1.webpack和vite</h2>
<p>① vue2使用的是webpack形式去构建项目<br/> webpack是一开始是入口文件，然后分析路由，然后模块，最后进行打包，然后告诉你，服务器准备好了可以开始干了<br/> ②vue3使用vite构建项目<br/> 先告诉你服务器准备完成，然后等你发送HTTP请求，然后是入口文件，Dynamic import（动态导入）code split point（代码分割）</p>
<p>最大的好处和区别就是为了让项目中一些代码文件多了以后去保存更新数据时更快能够看到实际效果，也就是所谓的（热更新）</p>
<h2><a id="2mainjs_10"></a>2.main.js文件</h2>
<p>vue2中我们可以使用pototype(原型)的形式去进行操作，引入的是构造函数<br/> vue3中需要使用结构的形式进行操作，引入的是工厂函数<br/> vue3中app组件中可以没有根标签</p>
<h2><a id="3setup_15"></a>3.setup函数</h2>
<p>setup函数必须要return 返回出去</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'appName'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token comment">//变量</span>
   <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">'打工仔'</span>
   <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span>
   <span class="token comment">//方法</span>
   <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我只是一个</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,今年</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">岁</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//返回一个对象</span>
   <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    name<span class="token punctuation">,</span>
    age<span class="token punctuation">,</span>
    say
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

</code></pre>
<p>你会发现当前的${name}中name不需要使用this去进行操作，this的作用只不过是取到某个作用域中变量而已，而setup函数提供了当前只在这个作用域中</p>
<p>这时候就很不爽了，那岂不是每次我定义的变量和方法都需要return,vue3中给我们提供了<br/> 在script标签上添加setup 如：<code>&lt;script setup&gt;&lt;/script&gt;</code>,相当在编译运行时放到了setup中<br/> <code>注：setup比beforeCreate、created生命周期更早，也就是说在当前直接用this去获取data中的数据打出来的还是undefined</code><br/> setup语法中课接收2个参数setup(props,context)<br/> 都知vue2中<code>this.$attrs,this.$slots,this.$emit</code>等同context中<code>attrs，slots，emit</code><br/> <code>注：当我们只接受一个参数时，页面会提示警告，但是不影响使用</code></p>
<h2><a id="4_50"></a>4.指令与插槽</h2>
<ul><li>vue2中使用slot可以直接使用slot,而vue3中必须使用v-slot的形式</li><li>v-for与v-if在vue2中优先级高的是v-for指令，而且不建议一起使用</li><li>vue3中v-for与v-if,只会把当前v-if当做v-for中的一个判断语句，不会相互冲突</li><li>vue3中移除keyCode作为v-on的修饰符，当然也不支持config.keyCodes</li><li>vue3中移除v-on.native修饰符</li><li>vue3中移除过滤器filter</li></ul>
<h2><a id="5refreactive_59"></a>5.ref与reactive</h2>
<p><strong>ref</strong><br/> 把数据变为响应式数据，ref把它们变成了对象，如果我们直接去操作代码是修改不了的，你会发现当前name和age还是通过get和set修改页面，这时你需要使用.value，并且ref还是Refimpl</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>姓名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"say"</span><span class="token operator">&gt;</span>修改<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'中介'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
    <span class="token comment">//方法</span>
    <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">=</span><span class="token string">'波妞'</span>
      age<span class="token operator">=</span><span class="token number">18</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      name<span class="token punctuation">,</span>
      age<span class="token punctuation">,</span>
      say
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p>这样的话那我们在页面上不是得{<!-- -->{name.value}}来做显示，实际不用这样的，在我们vue3中会检测到你的ref是对象，自动会给你加上.value，如果我们自己定义的ref对象，实例会变为refimpl,这个时候用XX.value.XX进行修改</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>姓名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>职业：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>job<span class="token punctuation">.</span>occupation<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>薪资：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"say"</span><span class="token operator">&gt;</span>修改<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'中介'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> job<span class="token operator">=</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      occupation<span class="token operator">:</span><span class="token string">'程序员'</span><span class="token punctuation">,</span>
      salary<span class="token operator">:</span><span class="token string">'10k'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
    <span class="token comment">//方法</span>
    <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      job<span class="token punctuation">.</span>value<span class="token punctuation">.</span>salary<span class="token operator">=</span><span class="token string">'12k'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      name<span class="token punctuation">,</span>
      age<span class="token punctuation">,</span>
      job<span class="token punctuation">,</span>
      say
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p>这时我们打印obj.value，他已经不再是refimpl对象，变成了proxy对象，因为vue3底层是proxy对象，基本数据类型都是按Object.defineProperty里面get和set进行数据劫持，vue3已经把reactive封装进去了，相当于我们在调用ref时，会自动调用reactive</p>
<p><strong>reactive</strong><br/> 上面我们说ref里面的对象会调用reactive，把Object转换为Proxy，现在我们直接通过reactive变成Proxy，它进行了一个深层次的响应式</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>姓名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>职业：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>job<span class="token punctuation">.</span>occupation<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>薪资：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>爱好：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>hobby<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>hobby<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> hobby<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"say"</span><span class="token operator">&gt;</span>修改<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">,</span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'波妞'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> job<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      occupation<span class="token operator">:</span><span class="token string">'程序员'</span><span class="token punctuation">,</span>
      salary<span class="token operator">:</span><span class="token string">'10k'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> hobby<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'吃饭'</span><span class="token punctuation">,</span><span class="token string">'睡觉'</span><span class="token punctuation">,</span><span class="token string">'打豆豆'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span>
    <span class="token comment">//方法</span>
    <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      job<span class="token punctuation">.</span>salary<span class="token operator">=</span><span class="token string">'12k'</span>
      hobby<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'学习'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      name<span class="token punctuation">,</span>
      age<span class="token punctuation">,</span>
      job<span class="token punctuation">,</span>
      say<span class="token punctuation">,</span>
      hobby
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p>这时你肯定会觉得方法太多了，还不如使用ref提供的.value,是不是感觉爽爽爽，但是有一个问题，如果有一堆数据那不是要一直去.value，点到冒烟，这个时候你可以用模拟vue2中data的形式，就会感觉更香</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>姓名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>年龄：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>职业：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>job<span class="token punctuation">.</span>occupation<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>薪资：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>爱好：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>hobby<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>data<span class="token punctuation">.</span>hobby<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> data<span class="token punctuation">.</span>hobby<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"say"</span><span class="token operator">&gt;</span>修改<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> data<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span><span class="token string">'波妞'</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
      job<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        occupation<span class="token operator">:</span><span class="token string">'程序员'</span><span class="token punctuation">,</span>
        salary<span class="token operator">:</span><span class="token string">'10k'</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      hobby<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'吃饭'</span><span class="token punctuation">,</span><span class="token string">'睡觉'</span><span class="token punctuation">,</span><span class="token string">'打豆豆'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//方法</span>
    <span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      data<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token operator">=</span><span class="token string">'12k'</span>
      data<span class="token punctuation">.</span>hobby<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'学习'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      data<span class="token punctuation">,</span>
      say<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p><strong>ref与reactive区别</strong></p>
<ol><li>ref定义的是基本数据类型</li><li>ref通过Object.defineProperty()的get和set实现数据劫持</li><li>ref操作数据.value，读取时不需要。value</li><li>reactive定义对象或数组数据类型</li><li>reactive通过Proxy实现数据劫持</li><li>reactive操作和读取数据不需要.value</li></ol>
<h2><a id="6vue3_230"></a>6.vue3的响应式原理</h2>
<p>vue2的响应式原理用Object.defineProperty的get和set进行数据劫持，从而实现响应式</p>
<ul><li>vue2中只有get和set方法去进行属性的读取和修改操作，当我们进行新增，删除时，页面不会实时更新</li><li>直接通过下标改数组，页面也不会实时更新</li></ul>
<p>vue3中响应式原理使用Proxy进行代理，使用window内置对象Reflect反射，学了Es6的语法的就知道我们在使用Proxy进行代理，好比甲方公司给出需要什么技术的前端攻城狮，让乙方去干招聘、面试等环节</p>
<ul><li>Proxy可以拦截对象中任意的属性变化，当然包括读写，添加，删除等</li><li>Reflect对<code>源对象</code>属性进行操作</li></ul>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> p<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
<span class="token comment">// 读取属性时调用</span>
    <span class="token function">get</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propName<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">//修改属性或添加属性时调用</span>
    <span class="token function">set</span> <span class="token punctuation">(</span>target<span class="token punctuation">,</span> propName<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propName<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">//删除属性时调用</span>
    <span class="token function">deleteProperty</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> propName</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    	<span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> propName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> 
</code></pre>
<h2><a id="7computedwatchwatchEffct_258"></a>7.computed和watch与watchEffct区别</h2>
<p><strong>computed</strong><br/> vue2中computed方法直接去写上当前方法去进行调用完事</p>
<pre><code class="prism language-javascript">computed<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>  <span class="token comment">//计算属性</span>
            <span class="token function">_suming</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>one<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>two<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">dataTimeing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"计算属性方法"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// return "计算属性方法"+new Date()</span>
                <span class="token keyword">return</span> <span class="token string">"普通方法"</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>time
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>vue3中computed变为组合式Api，那么意味着需要引入，当前如果需要去修改，就需要去终结computed</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    姓：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"names.familyName"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>
    名：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"names.lastName"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>
    姓名：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>fullName<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>br<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">,</span>computed<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> names<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      familyName<span class="token operator">:</span><span class="token string">'波'</span><span class="token punctuation">,</span>
      lastName<span class="token operator">:</span><span class="token string">'妞'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    fullName<span class="token operator">=</span><span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">return</span> names<span class="token punctuation">.</span>familyName<span class="token operator">+</span><span class="token string">'.'</span><span class="token operator">+</span>names<span class="token punctuation">.</span>lastName
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//修改写法</span>
    names<span class="token punctuation">.</span>fullName<span class="token operator">=</span><span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span>	names<span class="token punctuation">.</span>familyName<span class="token operator">+</span><span class="token string">'.'</span><span class="token operator">+</span>names<span class="token punctuation">.</span>lastName
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span>  nameList<span class="token operator">=</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>
        names<span class="token punctuation">.</span>familyName<span class="token operator">=</span>nameList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        names<span class="token punctuation">.</span>lastName<span class="token operator">=</span>nameList<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      names<span class="token punctuation">,</span>
      fullName
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p><strong>watch</strong><br/> vue2中watch通过对象的形式去直接监听</p>
<pre><code class="prism language-javascript">watch<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            userName<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                immediate<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
                deep<span class="token operator">:</span><span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            
        <span class="token punctuation">}</span>
</code></pre>
<p>vue3中watch是不是跟computed都是组合APi呢？它就是</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前数字为<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>num<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"num++"</span><span class="token operator">&gt;</span>点击数字加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">,</span>watch<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> num<span class="token operator">=</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span>
    <span class="token comment">//监听单个</span>
    <span class="token function">watch</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">当前数字增加了,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>oldValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//监听多个响应数据</span>
     <span class="token comment">//watch([num,msg],(newValue,oldValue)=&gt;{<!-- --></span>
     <span class="token comment">// console.log('当前改变了',newValue,oldValue)</span>
    <span class="token comment">//})</span>

    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      num
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p>为什么newValue与oldValue一样呢，就很尴尬，都是新的数据，就算你使用ref来定义，还是没有办法监听到oldValue（他喵的，都给你说了ref定义的对象会自动调用reactive）,所以在监视reactive定义的响应式数据时，oldValue无法正确获取,并且你会发现，它是强制开启深度监视（deep:true），并且无法关闭。</p>
<p>reactive监听的是响应式数据只是监听其中一个，我们都知道vue3会监听reactive或者ref定义，并不能监听，那需要监听多个属性怎么办呢，可以只能是写成下面这种</p>
<pre><code class="prism language-javascript"><span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>names<span class="token punctuation">.</span>age<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>names<span class="token punctuation">.</span>familyName<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'names改变了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
<p>如果需要监听深度属性怎么办呢，我们都知道reactive是响应式数据属性，如果这个属性是对象，那么我们就可以开启深度监听</p>
<pre><code class="prism language-javascript"><span class="token comment">//第一种</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> names<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'names改变了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//第二种</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> names<span class="token punctuation">.</span>job<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>oldValue</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'names改变了'</span><span class="token punctuation">,</span>newValue<span class="token punctuation">,</span>oldValue<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{<!-- --></span>deep<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>watchEffect</strong><br/> watchEffect是vue3中新增的函数，看字面意思就知道他也有watch，实际上他跟watch功能一样</p>
<p><strong>优势</strong></p>
<ul><li>默认开启 <code>immediate:true</code></li><li>需要用哪个就监听哪个</li><li>值发生改变就调用一次，且不需要返回值</li></ul>
<pre><code class="prism language-javascript"><span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> one <span class="token operator">=</span> num<span class="token punctuation">.</span>value
    <span class="token keyword">const</span> tow <span class="token operator">=</span> person<span class="token punctuation">.</span>age
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'watchEffect执行了'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2><a id="8_401"></a>8.生命周期</h2>
<p>vue2中我们是通过new Vue(),在执行beforeCreate与created接着问你有没有vm.$mount(el)<br/> <img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/4c416962491b4ea4a3d89d501e2c89f7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAQmlLQUJp,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> vue3中是先准备好所有后再执行<br/> <img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/28e70c06d9d54e129310acb83c465e6c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAQmlLQUJp,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> 区别：beforeCreate与created并没有组合式API中,setup就相当于这两个生命周期函数</p>
<p><strong>setup中</strong></p>
<ul><li>beforeCreate===&gt;Not needed*</li><li>created=======&gt;Not needed*</li><li>beforeMount ===&gt;onBeforeMount</li><li>mounted=======&gt;onMounted</li><li>beforeUpdate===&gt;onBeforeUpdate</li><li>updated =======&gt;onUpdatedupdated</li><li>beforeUnmount ==&gt;onBeforeUnmount</li><li>unmounted =====&gt;onUnmounted</li></ul>
<h2><a id="9hooks_418"></a>9.hooks函数</h2>
<pre><code class="prism language-javascript"><span class="token comment">//一般都是建一个hooks文件夹，都写在里面</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">,</span>onMounted<span class="token punctuation">,</span>onBeforeUnmount<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   <span class="token comment">//鼠标点击坐标</span>
   <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      x<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
      y<span class="token operator">:</span><span class="token number">0</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>

   <span class="token comment">//实现鼠标点击获取坐标的方法</span>
   <span class="token keyword">function</span> <span class="token function">savePoint</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      point<span class="token punctuation">.</span>x <span class="token operator">=</span> event<span class="token punctuation">.</span>pageX
      point<span class="token punctuation">.</span>y <span class="token operator">=</span> event<span class="token punctuation">.</span>pageY
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>pageX<span class="token punctuation">,</span>event<span class="token punctuation">.</span>pageY<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>

   <span class="token comment">//实现鼠标点击获取坐标的方法的生命周期钩子</span>
   <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span>savePoint<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>

   <span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span>savePoint<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>

   <span class="token keyword">return</span> point
<span class="token punctuation">}</span>
<span class="token comment">//在其他地方调用</span>
<span class="token keyword">import</span> useMousePosition <span class="token keyword">from</span> <span class="token string">'./hooks/useMousePosition'</span>
<span class="token keyword">let</span> point <span class="token operator">=</span> useMousePosition（）
</code></pre>
<h2><a id="10toReftoRefs_452"></a>10.toRef与toRefs</h2>
<p><strong>toRef</strong>相当于ref类型数据</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前姓名<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前年龄<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前薪水<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token constant">K</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"names.name+='!'"</span><span class="token operator">&gt;</span>点击加<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"names.age++"</span><span class="token operator">&gt;</span>点击加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"names.job.salary++"</span><span class="token operator">&gt;</span>点击薪水加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> names<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span><span class="token string">'老谭'</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>
      job<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        salary<span class="token operator">:</span><span class="token number">10</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      names
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<p>这时我们只是操作变量，如果我们需要去操作页面字符串可以达到响应式吗？这个时候我们需要把name.XX变为toRef去进行操作name中的数据，<br/> 那这时你肯定会去想说句妈卖批，我为何不使用ref去改变呢，ref也能达到响应式数据效果，当前的names里面的数据并不是源数据，而是新定义出的数据，自然操作修改的也不是源数据的names</p>
<pre><code class="prism language-javascript"><span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span>names<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
  age<span class="token operator">:</span>names<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
  salary<span class="token operator">:</span>names<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span><span class="token function">toRef</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span><span class="token function">toRef</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  salary<span class="token operator">:</span><span class="token function">toRef</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>job<span class="token punctuation">,</span><span class="token string">'salary'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span><span class="token function">ref</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span><span class="token function">ref</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span>
  salary<span class="token operator">:</span><span class="token function">ref</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>toRefs</strong><br/> toRefs与toRef有什么不同呢，字面意思也能看出来s肯定是更多的意思，（这时你又在猜想，是这样的）自信一些，特喵的，当前<code>...</code>是结构了一次，不懂的可以去看看Es6，这就不过多的谈</p>
<pre><code class="prism language-javascript"> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前姓名<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前薪水<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token constant">K</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
    <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="11router_518"></a>11.router</h2>
<p>vue2中还是使用this.<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        r
       
       
        o
       
       
        u
       
       
        t
       
       
        e
       
       
        r
       
       
        .
       
       
        p
       
       
        u
       
       
        s
       
       
        h
       
       
        来
       
       
        进
       
       
        行
       
       
        路
       
       
        由
       
       
        跳
       
       
        转
       
       
        ，
       
       
        在
       
       
        v
       
       
        u
       
       
        e
       
       
        3
       
       
        中
       
       
        没
       
       
        有
       
       
        这
       
       
        些
       
       
        ，
       
       
        而
       
       
        是
       
       
        定
       
       
        义
       
       
        了
       
       
        一
       
       
        个
       
       
        v
       
       
        u
       
       
        e
       
       
        −
       
       
        r
       
       
        o
       
       
        u
       
       
        t
       
       
        e
       
       
        r
       
       
        ,
       
       
        直
       
       
        接
       
       
        引
       
       
        入
       
       
        u
       
       
        s
       
       
        e
       
       
        R
       
       
        o
       
       
        u
       
       
        t
       
       
        e
       
       
        ,
       
       
        u
       
       
        s
       
       
        e
       
       
        R
       
       
        o
       
       
        u
       
       
        t
       
       
        e
       
       
        r
       
       
        ，
       
       
        相
       
       
        当
       
       
        于
       
       
        v
       
       
        u
       
       
        e
       
       
        2
       
       
        中
       
       
        提
       
       
        供
       
       
        的
       
       
        ‘
       
       
        t
       
       
        h
       
       
        i
       
       
        s
       
       
        .
       
      
      
       router.push来进行路由跳转，在vue3中没有这些，而是定义了一个vue-router,直接引入useRoute,useRouter，相当于vue2中提供的`this.
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord">.</span><span class="mord mathdefault">p</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">路</span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">跳</span><span class="mord cjk_fallback">转</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">在</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">3</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">没</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">些</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">而</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">义</span><span class="mord cjk_fallback">了</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord cjk_fallback">直</span><span class="mord cjk_fallback">接</span><span class="mord cjk_fallback">引</span><span class="mord cjk_fallback">入</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.00773em;">R</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">当</span><span class="mord cjk_fallback">于</span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mord">2</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">提</span><span class="mord cjk_fallback">供</span><span class="mord cjk_fallback">的</span><span class="mord">‘</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">.</span></span></span></span></span>route，this.<span class="katex--inline"><span class="katex"><span class="katex-mathml">
    
     
      
       
        r
       
       
        o
       
       
        u
       
       
        t
       
       
        e
       
       
        r
       
       
        ‘
       
       
        ,
       
       
        别
       
       
        问
       
       
        这
       
       
        ‘
       
       
        t
       
       
        h
       
       
        i
       
       
        s
       
       
        .
       
      
      
       router`,别问这`this.
      
     
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord">‘</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord cjk_fallback">别</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">这</span><span class="mord">‘</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord">.</span></span></span></span></span>route，this.$router`有什么区别，这都没看过我建议你去先看看vue2</p>
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>useRouter<span class="token punctuation">,</span>useRoute<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> router<span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> route<span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>code<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span><span class="token punctuation">{<!-- --></span>
    fn
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="12Api_538"></a>12.全局Api的转移（很重要）</h2>
<table><thead><tr><th>2.x 全局 API（ Vue）</th><th>3.x 实例 API(app)</th></tr></thead><tbody><tr><td>Vue.config.xxxx</td><td>app.config.xxxx</td></tr><tr><td>Vue.config.productionTip</td><td>移除</td></tr><tr><td>Vue.component</td><td>app.component</td></tr><tr><td>Vue.directive</td><td>app.directive</td></tr><tr><td>Vue.mixin</td><td>app.mixin</td></tr><tr><td>Vue.use</td><td>app.use</td></tr><tr><td>Vue.prototype</td><td>app.config.globalProperties</td></tr></tbody></table>
<p>vue2中可以通过Vue.prototype去操作原型，在vue3中只能通过app.config.globalProperties，当时玩的时候还以为自己写错了，修改的这些你会发现改动的东西挺多</p>
<h2><a id="APi_552"></a>其他APi(了解)</h2>
<h2><a id="13shallowReactiveshallowRef_554"></a>13.shallowReactive与shallowRef</h2>
<p>shallowReactive浅层次的响应式,它就是只把第一层的数据变为响应式，深层的数据不会变为响应式,shallowRef如果定义的是基本类型的数据，那么它和ref是一样的不会有什么改变，但是要是定义的是对象类型的数据，那么它就不会进行响应式，之前我们说过如果ref定义的是对象，那么它会自动调用reactive变为Proxy,但是要是用到的是shallowRef那么就不会调用reactive去进行响应式。</p>
<ul><li>shallowReactive：只处理对象最外层属性的响应式（浅响应式）。</li><li>shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理</li></ul>
<pre><code class="prism language-javascript"><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token function">shallowReactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
 name<span class="token operator">:</span><span class="token string">'大理段氏'</span><span class="token punctuation">,</span>
 age<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
 job<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
   salary<span class="token operator">:</span><span class="token number">20</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
 y<span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2><a id="14readonlyshallowReadonly_573"></a>14.readonly与shallowReadonly</h2>
<ul><li>readonly是接收了一个响应式数据然后重新赋值，返回的数据就不允许修改（深层只读）</li><li>shallowReadonly却只是浅层只读（第一层只读，其余层可以进行修改）</li></ul>
<pre><code class="prism language-javascript">names<span class="token operator">=</span><span class="token function">readonly</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
names<span class="token operator">=</span><span class="token function">shallowReadonly</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>

</code></pre>
<h2><a id="15toRawmarkRaw_584"></a>15.toRaw与markRaw</h2>
<p>toRaw其实就是将一个由reactive生成的响应式对象转为普通对象。如果是ref定义的话，是没有效果的（包括ref定义的对象）如果在后续操作中对数据进行了添加的话，添加的数据为响应式数据，当然要是将数据进行markRaw操作后就不会变为响应式，可能大家会说，不就是和readonly一样吗？那肯定不一样咯，readonly是根本没办法改，但markRaw是不转化为响应式，但是数据还会发生改变</p>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"home"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前姓名<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前年龄<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>当前薪水<span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token constant">K</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h1 v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"names.girlFriend"</span><span class="token operator">&gt;</span>女朋友：<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>names<span class="token punctuation">.</span>girlFriend<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"names.name+='!'"</span><span class="token operator">&gt;</span>点击加<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"addAges"</span><span class="token operator">&gt;</span>点击加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"addSalary"</span><span class="token operator">&gt;</span>点击薪水加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"add"</span><span class="token operator">&gt;</span>添加女朋友<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">"addAge"</span><span class="token operator">&gt;</span>添加女朋友年龄<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>reactive<span class="token punctuation">,</span>toRaw<span class="token punctuation">,</span>markRaw<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> names<span class="token operator">=</span><span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      name<span class="token operator">:</span><span class="token string">'老伍'</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>
      job<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
        salary<span class="token operator">:</span><span class="token number">10</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">function</span> <span class="token function">addAges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      names<span class="token punctuation">.</span>age<span class="token operator">++</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">addSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> fullName<span class="token operator">=</span><span class="token function">toRaw</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
      fullName<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary<span class="token operator">++</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> girlFriend<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>sex<span class="token operator">:</span><span class="token string">'女'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">}</span>
      names<span class="token punctuation">.</span>girlFriend<span class="token operator">=</span><span class="token function">markRaw</span><span class="token punctuation">(</span>girlFriend<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">addAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      names<span class="token punctuation">.</span>girlFriend<span class="token punctuation">.</span>age<span class="token operator">++</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>girlFriend<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
      names<span class="token punctuation">,</span>
      add<span class="token punctuation">,</span>
      addAge<span class="token punctuation">,</span>
      addAges<span class="token punctuation">,</span>
      addSalary
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<h2><a id="16customRef_643"></a>16.customRef</h2>
<p>customRef创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制<br/> 可以使用其特性做防抖节流，原生的方法就不具体写，说一下概念，后续出一个节流防抖，递归，深浅拷贝等</p>
<ul><li>防抖：规定时间内触发同一时间，只执行一次（执行的这一次可以在最开始也可以在最后）</li><li>节流：在规定一定间隔时间内触发同一事件，在当前时间内只执行一次，下一个时间内也只执行一次（当前执行的可以在最开始也可以最后）</li></ul>
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"keyWord"</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span>keyWord<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>customRef<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//自定义一个ref——名为：myRef</span>
    <span class="token keyword">function</span> <span class="token function">myRef</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span>times</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> time
      <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span>trigger</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>
          <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">有人从myRef中读取数据了，我把</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">给他了</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//通知Vue追踪value的变化（必须要有，并且必须要在return之前）</span>
            <span class="token keyword">return</span> value
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">有人把myRef中数据改为了：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
            time <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
              value <span class="token operator">=</span> newValue
              <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//通知Vue去重新解析模板（必须要有）</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>times<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> keyWord <span class="token operator">=</span> <span class="token function">myRef</span><span class="token punctuation">(</span><span class="token string">'HelloWorld'</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span> <span class="token comment">//使用自定义的ref</span>

    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>keyWord<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre>
<h2><a id="17provideinject_690"></a>17.provide与inject</h2>
<p>都知道组件传值吧，在vue2中，如果要在后代组件中使用父组件的数据，那么要一层一层的父子组件传值或者用到vuex，但是现在，无论组件层次结构有多深，父组件都可以作为其所有子组件的依赖提供者。这个特性有两个部分：父组件有一个 provide 选项来提供数据，子组件有一个 inject 选项来开始使用这些数据</p>
<pre><code class="prism language-javascript"><span class="token comment">//父</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span> provide <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token keyword">let</span> fullname <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>name<span class="token operator">:</span><span class="token string">'阿月'</span><span class="token punctuation">,</span>salary<span class="token operator">:</span><span class="token string">'15k'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">'fullname'</span><span class="token punctuation">,</span>fullname<span class="token punctuation">)</span> <span class="token comment">//给自己的后代组件传递数据</span>
 <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>fullname<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//后代</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>inject<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token keyword">let</span> fullname <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">'fullname'</span><span class="token punctuation">)</span>
 <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span>fullname<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="18_709"></a>18.响应式判断</h2>
<ol><li>isRef: 检查值是否为一个 ref 对象。</li><li>isReactive：检查对象是否是由 reactive 创建的响应式代理。</li><li>isReadonly: 检查对象是否是由 readonly 创建的只读代理。</li><li>isProxy：检查对象是否是由 reactive 或 readonly 创建的 proxy。</li></ol>
<pre><code class="prism language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span>readonly<span class="token punctuation">,</span>isRef<span class="token punctuation">,</span>isReactive<span class="token punctuation">,</span>isReadonly<span class="token punctuation">,</span>isProxy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
  name<span class="token operator">:</span><span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> fullName <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>name<span class="token operator">:</span><span class="token string">'小唐'</span><span class="token punctuation">,</span>price<span class="token operator">:</span><span class="token string">'20k'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> fullNames <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isRef</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReadonly</span><span class="token punctuation">(</span>fullNames<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isProxy</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isProxy</span><span class="token punctuation">(</span>fullNames<span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isProxy</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>