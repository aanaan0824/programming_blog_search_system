<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-github-gist" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#unittest_8">一、unittest测试框架</a></li><li><ul><li><a href="#1_12">1、测试固件</a></li><li><ul><li><a href="#11_setUp_13">1.1 setUp（）</a></li><li><a href="#12_tearDown_15">1.2 tearDown（）</a></li></ul>
</li><li><a href="#2unittest__18">2、unittest 基本使用</a></li><li><a href="#3suit_56">3、测试套件（suit）</a></li><li><ul><li><a href="#31__101">3.1 测试用例执行顺序</a></li><li><a href="#32__104">3.2 忽略测试用例的执行</a></li></ul>
</li><li><a href="#4_110">4、断言</a></li><li><a href="#5HTML__132">5、HTML 报告生成</a></li><li><ul><li><a href="#51__135">5.1 测试报告</a></li><li><a href="#52__178">5.2 异常捕捉与错误截图</a></li><li><ul><li><a href="#521_get_screenshot_as_file_182">5.2.1 错误截图：get_screenshot_as_file()</a></li><li><a href="#522__193">5.2.2 异常捕捉</a></li><li><a href="#523__201">5.2.3 整体代码</a></li></ul>
</li></ul>
</li></ul>
</li><li><a href="#_257">二、数据驱动</a></li><li><ul><li><a href="#1ddt__266">1、ddt 安装</a></li><li><a href="#2ddt__269">2、ddt 使用</a></li></ul>
</li></ul>
</div>
<p></p>
<hr color="#000000" size='1"'/>
<h1><a id="unittest_8"></a>一、unittest测试框架</h1>
<ul><li>unittest 是python 的单元测试框架， unittest 单元测试提供了创建测试用例，测试套件以及批量执行的方案。作为单元测试的框架， unittest 也是可以对程序最小模块的一种敏捷化的测试。</li><li>unittest 和 Junit 都是单元测试？区别在于： unittest 是基于功能测试的单元测试，是基于 UI 界面的功能性测试，而 Junit 是白盒单元测试框架。</li><li>解决了单个脚本重复的操作（导包，获取浏览器驱动，关闭浏览器）。</li></ul>
<h2><a id="1_12"></a>1、测试固件</h2>
<h3><a id="11_setUp_13"></a>1.1 setUp（）</h3>
<ul><li>在执行测试用例脚本之前进行初始化环境的方法。</li></ul>
<h3><a id="12_tearDown_15"></a>1.2 tearDown（）</h3>
<ul><li>测试用例执行后，进行清理环境工作。</li></ul>
<h2><a id="2unittest__18"></a>2、unittest 基本使用</h2>
<ul><li>测试用例的命名： test_ 。</li></ul>
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token keyword">import</span> unittest

<span class="token keyword">class</span> <span class="token class-name">TestUnit1</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取浏览器的驱动</span>
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1、self 就是类的引用/实例</span>
        <span class="token comment"># 2、全局变量的定义：self.变量名</span>
        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/"</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

        <span class="token comment"># 在百度中搜索信息</span>
        <span class="token comment"># 测试用例的命名： test_</span>
    <span class="token keyword">def</span> <span class="token function">test_search1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"顾一野"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_search2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"account"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token comment"># 关闭浏览器</span>
    <span class="token keyword">def</span> <span class="token function">tearDowm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 一个入口</span>
    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
        unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2><a id="3suit_56"></a>3、测试套件（suit）</h2>
<ul><li>把不同文件下的测试用例组织起来形成的测试用例组。</li><li>把需要一次性执行的测试用例，放在一个套件中，就可以一次性运行。</li></ul>
<pre><code class="prism language-python"><span class="token keyword">import</span> unittest
<span class="token keyword">from</span> Test <span class="token keyword">import</span> testbaidu1
<span class="token keyword">from</span> Test <span class="token keyword">import</span> testbaidu2


<span class="token keyword">def</span> <span class="token function">creatSuit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 1、要把不同测试脚本的类中的需要执行的方法放在一个测试套件中</span>
    <span class="token comment"># suit = unittest.TestSuite()</span>
    <span class="token comment"># suit.addTest(testbaidu1.Baidu1("test_hao"))</span>
    <span class="token comment"># suit.addTest(testbaidu2.Baidu2("test_hao"))</span>
    <span class="token comment"># suit.addTest(testbaidu2.Baidu2("test_baidusearch"))</span>
    <span class="token comment"># return suit</span>

    <span class="token comment"># 2、如果需要把一个测试脚本中年所有的测试用例都添加到suit中，怎么做？</span>
    <span class="token comment"># 第一种※：makeSuit</span>

    <span class="token comment">#  suit = unittest.TestSuite()</span>
    <span class="token comment">#  suit.addTest(unittest.makeSuite(testbaidu1.Baidu1))</span>
    <span class="token comment">#  suit.addTest(unittest.makeSuite(testbaidu2.Baidu2))</span>
    <span class="token comment">#  return suit</span>

    <span class="token comment"># 第二种：TestLoader</span>

    <span class="token comment"># suit1 = unittest.TestLoader().loadTestsFromTestCase(testbaidu1.Baidu1)</span>
    <span class="token comment"># suit2 = unittest.TestLoader().loadTestsFromTestCase(testbaidu2.Baidu2)</span>
    <span class="token comment"># suit = unittest.TestSuite([suit1, suit2])</span>
    <span class="token comment"># return suit</span>

    <span class="token comment"># 3、可以把一个文件夹下面所有的测试脚本中的测试用例放入测试套件</span>
    discover <span class="token operator">=</span> unittest<span class="token punctuation">.</span>defaultTestLoader<span class="token punctuation">.</span>discover<span class="token punctuation">(</span><span class="token string">"../Test"</span><span class="token punctuation">,</span> pattern<span class="token operator">=</span><span class="token string">"testbaidu*.py"</span><span class="token punctuation">,</span> top_level_dir<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> discover


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    suit <span class="token operator">=</span> creatSuit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># verbersity= 0 测试用例成功多少，失败多少, 1 会标注哪个成功/失败, 2 会标注</span>
    runner <span class="token operator">=</span> unittest<span class="token punctuation">.</span>TextTestRunner<span class="token punctuation">(</span><span class="token punctuation">)</span>
    runner<span class="token punctuation">.</span>run<span class="token punctuation">(</span>suit<span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/cb821e386ee2499b95497c4836058991.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bCP5pu56KaB5Yqg5rK5,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="31__101"></a>3.1 测试用例执行顺序</h3>
<ul><li>按照test_后面的名称排序，0 ~ 9， A ~ Z，a ~ z。如果第一个字母相同，就看第二个字母，依次执行。</li></ul>
<h3><a id="32__104"></a>3.2 忽略测试用例的执行</h3>
<pre><code class="prism language-python"><span class="token decorator annotation punctuation">@unittest<span class="token punctuation">.</span>skip</span><span class="token punctuation">(</span><span class="token string">"skipping"</span><span class="token punctuation">)</span>
</code></pre>
<h2><a id="4_110"></a>4、断言</h2>
<ul><li>在自动化脚本中来判断实际结果和预期结果是否一致情况。</li><li>就百度为例，如何判断查询成功？网页标题是搜索信息，或者页面中出现某个元素。</li><li>assertEqual（预期结果，实际结果，msg = “实际结果于预期结果不一致时输出的内容”）。</li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/c7890d0f9a944140853602e90877bc60.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bCP5pu56KaB5Yqg5rK5,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<pre><code class="prism language-python">    <span class="token keyword">def</span> <span class="token function">test_hbaidu</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        driver <span class="token operator">=</span> self<span class="token punctuation">.</span>driver
        url <span class="token operator">=</span> self<span class="token punctuation">.</span>url
        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token comment"># self.assertEqual("突如其来的假期_百度搜索", driver.title, msg="实际结果和预期结果不一致" )</span>
        self<span class="token punctuation">.</span>assertTrue<span class="token punctuation">(</span><span class="token string">"百度一下，你就知道"</span> <span class="token operator">==</span> driver<span class="token punctuation">.</span>title<span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">"不一致！！！"</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"突如其来的假期"</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>submit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
        <span class="token comment"># self.assertEqual(driver.title, "突如其来的假期_百度搜索", msg="实际结果和预期结果不一致" )</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
</code></pre>
<h2><a id="5HTML__132"></a>5、HTML 报告生成</h2>
<ul><li>在测试用例较多时，就需要统计测试用例的执行结果。</li><li>HTML 报告和错误截图都是用来分析测试用例批量执行后的结果的，错误截图可以帮助我们更清晰的看到错误具体出现的页面以及错误状况。</li></ul>
<h3><a id="51__135"></a>5.1 测试报告</h3>
<pre><code class="prism language-python"><span class="token keyword">import</span> HTMLTestRunner
<span class="token keyword">import</span> os
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> time
<span class="token keyword">import</span> unittest

<span class="token keyword">def</span> <span class="token function">createsuite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    discovers <span class="token operator">=</span> unittest<span class="token punctuation">.</span>defaultTestLoader<span class="token punctuation">.</span>discover<span class="token punctuation">(</span><span class="token string">"../Test"</span><span class="token punctuation">,</span> pattern<span class="token operator">=</span><span class="token string">"testbaidu*.py"</span><span class="token punctuation">,</span> top_level_dir<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>discovers<span class="token punctuation">)</span>
    <span class="token keyword">return</span> discovers

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment"># 文件夹要创建地址，脚本所在的目录，</span>
    curpath <span class="token operator">=</span> sys<span class="token punctuation">.</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment"># c 盘下所有的路径都被打开，相当于一个数组</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">)</span>
    <span class="token comment"># 只是需要第一个</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 1，创建文件夹，存放 HTML 报告</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>curpath<span class="token operator">+</span><span class="token string">'/resultreport'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>curpath<span class="token operator">+</span><span class="token string">'/resultreport'</span><span class="token punctuation">)</span>

    <span class="token comment"># 2，文件夹的命名：时间  时分秒，名称绝对不会重复  time.time() 获取时间戳，local转换为当地时间。</span>
    <span class="token comment"># time.strftime() 把本地时间以某一种特定格式展示。</span>
    now <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d-%H %M %S"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># 文件名</span>
    filename <span class="token operator">=</span> curpath <span class="token operator">+</span> <span class="token string">'/resultreport/'</span><span class="token operator">+</span> now <span class="token operator">+</span> <span class="token string">'resultreport.html'</span>

    <span class="token comment"># 打开文件，编写内容</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>

        runner <span class="token operator">=</span> HTMLTestRunner<span class="token punctuation">.</span>HTMLTestRunner<span class="token punctuation">(</span>stream<span class="token operator">=</span>fp<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">u"测试报告"</span><span class="token punctuation">,</span>
                                               description<span class="token operator">=</span><span class="token string">u"用例执行情况"</span><span class="token punctuation">,</span> verbosity<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
        suite <span class="token operator">=</span> createsuite<span class="token punctuation">(</span><span class="token punctuation">)</span>
        runner<span class="token punctuation">.</span>run<span class="token punctuation">(</span>suite<span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ea2e56b4398640dc9856c5e6220bc30a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bCP5pu56KaB5Yqg5rK5,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="52__178"></a>5.2 异常捕捉与错误截图</h3>
<ul><li>BUG 的要素：标题、版本号、测试环境、测试步骤（测试数据）、预期结果、实际结果、附件（错误日志、错误截图）</li><li>BUG 复现：让 BUG 再次出现，使开发人员能更快的定位到 BUG。</li><li>可以捕捉到错误，并且把错误截图保存，给我们错误定位带来方便。</li></ul>
<h4><a id="521_get_screenshot_as_file_182"></a>5.2.1 错误截图：get_screenshot_as_file()</h4>
<pre><code class="prism language-python">    <span class="token keyword">def</span> <span class="token function">save_errorImage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">,</span>fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># "./" 表示当前路径</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span>
        <span class="token comment"># 错误截图的名称要不一样</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d-%H%M%S"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span><span class="token string">"./image/"</span> <span class="token operator">+</span> now <span class="token operator">+</span> fileName<span class="token punctuation">)</span>
</code></pre>
<h4><a id="522__193"></a>5.2.2 异常捕捉</h4>
<pre><code class="prism language-python">        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">"肖战_百度搜索"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">"和预期结果不一致"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>save_errorImage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token string">"error.png"</span><span class="token punctuation">)</span>
</code></pre>
<h4><a id="523__201"></a>5.2.3 整体代码</h4>
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token keyword">import</span> unittest
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">TestUnit1</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 获取浏览器的驱动</span>
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1、self 就是类的引用/实例</span>
        <span class="token comment"># 2、全局变量的定义：self.变量名</span>
        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/"</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

        <span class="token comment"># 在百度中搜索信息</span>
        <span class="token comment"># 测试用例的命名： test_</span>

    <span class="token keyword">def</span> <span class="token function">test_search1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"顾一野"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
    <span class="token comment"># 在百度中搜索英文</span>
    <span class="token keyword">def</span> <span class="token function">test_search2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"Lisa"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token comment"># 异常捕捉 再传参数时，没有传 self，实例也可以不用传。 在TestCase类下，只有test_ 才执行，其他的只有被调用才执行。</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span><span class="token string">"肖战_百度搜索"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">"和预期结果不一致"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>save_errorImage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token string">"error.png"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">save_errorImage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">,</span>fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># "./" 表示当前路径</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span>
        <span class="token comment"># 错误截图的名称要不一样</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d-%H%M%S"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span><span class="token string">"./image/"</span> <span class="token operator">+</span> now <span class="token operator">+</span> fileName<span class="token punctuation">)</span>

    <span class="token comment"># 关闭浏览器</span>
    <span class="token keyword">def</span> <span class="token function">tearDowm</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 一个入口</span>
    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
        unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/47d9e2bd54d04fadb134dd9005baaa16.png"/></p>
<h1><a id="_257"></a>二、数据驱动</h1>
<ul><li>例如一个搜索框，如何进行功能测试？<br/> 例如在新闻方面，在输入人名（中文。英文）等等，看是否搜索出对应信息。等等信息。</li><li>自动化测试用例： 
  <ul><li>1、定位输入框 “kw” ，在输入框中输入内容。</li><li>2、定位百度一下按钮 “su”，点击按钮。</li><li>3、判断搜索内容。</li></ul> </li><li>上述方法太过冗杂，可以使用数据驱动，一次性完成需要多次执行的测试用例。</li></ul>
<h2><a id="1ddt__266"></a>1、ddt 安装</h2>
<ul><li>1、查看是否安装 ddt，在 cmd 中输入 pip show ddt 出现版本号就说明安装成功。</li><li>2、没有安装，在 cmd 中输入 pip install ddt 安装。</li></ul>
<h2><a id="2ddt__269"></a>2、ddt 使用</h2>
<ul><li>参考文档：<a href="http://ddt.readthedocs.io/en/latest/">http://ddt.readthedocs.io/en/latest/</a></li><li>1、导入from ddt import ddt, unpack, data, file_data 和 import sys, csv</li><li>2、在类前面一定要加上 @ddt</li></ul>
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time
<span class="token keyword">import</span> unittest
<span class="token keyword">from</span> ddt <span class="token keyword">import</span> ddt<span class="token punctuation">,</span> unpack<span class="token punctuation">,</span> data<span class="token punctuation">,</span> file_data
<span class="token keyword">import</span> sys<span class="token punctuation">,</span> csv<span class="token punctuation">,</span> os

<span class="token comment"># 如何读取 TXT 文件中的数据形成数组</span>
<span class="token keyword">def</span> <span class="token function">getTxt</span><span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    rows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    path <span class="token operator">=</span> sys<span class="token punctuation">.</span>path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> file_name<span class="token punctuation">,</span> <span class="token string">'rt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        readers <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>f<span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">,</span> quotechar<span class="token operator">=</span><span class="token string">"|"</span><span class="token punctuation">)</span>
        <span class="token builtin">next</span><span class="token punctuation">(</span>readers<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> readers<span class="token punctuation">:</span>
            temprows<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> row<span class="token punctuation">:</span>
                temprows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            rows<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temprows<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span>
        <span class="token keyword">return</span> rows

<span class="token decorator annotation punctuation">@ddt</span>
<span class="token keyword">class</span> <span class="token class-name">Search</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/"</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@unittest<span class="token punctuation">.</span>skip</span><span class="token punctuation">(</span><span class="token string">"skipping"</span><span class="token punctuation">)</span>
    <span class="token comment"># 1、一次性传一个参数</span>
    <span class="token decorator annotation punctuation">@data</span><span class="token punctuation">(</span><span class="token string">"肖战"</span><span class="token punctuation">,</span> <span class="token string">"Lisa"</span><span class="token punctuation">,</span> <span class="token string">"顾一野"</span><span class="token punctuation">,</span> <span class="token string">"党章"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_find1</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@unittest<span class="token punctuation">.</span>skip</span><span class="token punctuation">(</span><span class="token string">"skipping"</span><span class="token punctuation">)</span>
    <span class="token comment"># 2、一次性传两个参数 u:utf-8,防止中文乱码  需要 unpack 来一一对应参数</span>
    <span class="token decorator annotation punctuation">@data</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Lisa'</span><span class="token punctuation">,</span> <span class="token string">u"Lisa_百度搜索"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">u'肖战'</span><span class="token punctuation">,</span> <span class="token string">u"顾一野_百度搜索"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@unpack</span>
    <span class="token keyword">def</span> <span class="token function">test_find2</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expected_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>expected_value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">"与预期结果不一致"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>save_errorImage<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token string">"error.png"</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@unittest<span class="token punctuation">.</span>skip</span><span class="token punctuation">(</span><span class="token string">"skipping"</span><span class="token punctuation">)</span>
    <span class="token comment"># 3、使用 json 文件（一次传一个数据） ，测试数据在文件里，整洁、保存多</span>
    <span class="token decorator annotation punctuation">@file_data</span><span class="token punctuation">(</span><span class="token string">'test_baidu_data.json'</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_find3</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token comment"># 4、传入一个 txt 文件（可以传多组数据）</span>
    <span class="token decorator annotation punctuation">@data</span><span class="token punctuation">(</span><span class="token operator">*</span>getTxt<span class="token punctuation">(</span><span class="token string">'test_baidu_data.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@unpack</span>
    <span class="token keyword">def</span> <span class="token function">test_find4</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expected_value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token comment"># 断言</span>
        self<span class="token punctuation">.</span>assertEqual<span class="token punctuation">(</span>expected_value<span class="token punctuation">,</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">,</span> msg<span class="token operator">=</span><span class="token string">"与预期结果不一致"</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>expected_value<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">save_errorImage</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> driver<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"./image"</span><span class="token punctuation">)</span>
        now <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y%m%d-%H%M%S"</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        driver<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span><span class="token string">"./image/"</span> <span class="token operator">+</span> now <span class="token operator">+</span> <span class="token string">"-"</span><span class="token operator">+</span> fileName<span class="token punctuation">)</span>

    <span class="token comment"># 关闭浏览器</span>
    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
       self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># 一个入口</span>
    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
        unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p>test_baidu_data.txt</p>
<pre><code class="prism language-python">data
周迅<span class="token punctuation">,</span> 周迅_百度搜索
肖战<span class="token punctuation">,</span> 肖战_百度搜索
</code></pre>
<p>test_baidu_data.json</p>
<pre><code class="prism language-python"><span class="token punctuation">[</span>
<span class="token string">"jolin"</span><span class="token punctuation">,</span>
<span class="token string">"林俊杰"</span>
<span class="token punctuation">]</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>