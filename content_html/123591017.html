<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h2><a id="_0"></a>报错</h2>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/a5f27187290b42ac94b02cbe463da6cd.png"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e819b4f060324cc094f9952db68e8cf6.png"/><br/> asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).<br/> This can impact web performance.<br/> entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.<br/> Entrypoints:</p>
<p><strong>打包时提示文件过大，配置解决方案，如下</strong><br/> 直接设置文件的压缩率就可以</p>
<pre><code class="prism language-javascript"><span class="token comment">//核心代码</span>
configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 为生产环境修改配置...</span>
      config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">'production'</span><span class="token punctuation">;</span>
      config<span class="token punctuation">[</span><span class="token string">"performance"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//打包文件大小配置</span>
        <span class="token string">"maxEntrypointSize"</span><span class="token punctuation">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
        <span class="token string">"maxAssetSize"</span><span class="token punctuation">:</span> <span class="token number">30000000</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre>
<h3><a id="_25"></a>上代码：</h3>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@vue/cli-service'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  transpileDependencies<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  assetsDir<span class="token punctuation">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span>
  productionSourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  chainWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'assets'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/assets'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'components'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token comment">// 为生产环境修改配置...</span>
      config<span class="token punctuation">.</span>mode <span class="token operator">=</span> <span class="token string">'production'</span><span class="token punctuation">;</span>
      config<span class="token punctuation">[</span><span class="token string">"performance"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//打包文件大小配置</span>
        <span class="token string">"maxEntrypointSize"</span><span class="token punctuation">:</span> <span class="token number">10000000</span><span class="token punctuation">,</span>
        <span class="token string">"maxAssetSize"</span><span class="token punctuation">:</span> <span class="token number">30000000</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre>
<h2><a id="_52"></a>还有一种方法就是对其进行压缩</h2>
<p>安装依赖</p>
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> compression-webpack-plugin --save-dev
</code></pre>
<p>在vue.config.js中引用</p>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> CompressionWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"compression-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>配置压缩文件</p>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> productionGzipExtensions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"js"</span><span class="token punctuation">,</span> <span class="token string">'css'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>配置对超过大小文件进行压缩</p>
<pre><code class="prism language-javascript"><span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      filename<span class="token punctuation">:</span> <span class="token string">"[path][base].gz"</span><span class="token punctuation">,</span>
      algorithm<span class="token punctuation">:</span> <span class="token string">"gzip"</span><span class="token punctuation">,</span>
      test<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">"\\.("</span> <span class="token operator">+</span> productionGzipExtensions<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")$"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//匹配文件名</span>
      threshold<span class="token punctuation">:</span> <span class="token number">10240</span><span class="token punctuation">,</span> <span class="token comment">//对10K以上的数据进行压缩</span>
      minRatio<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
      deleteOriginalAssets<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token comment">//是否删除源文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>下面时完整代码</strong></p>
<pre><code class="prism language-javascript"><span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> defineConfig <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@vue/cli-service'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CompressionWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"compression-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 开启gzip压缩， 按需引用</span>
<span class="token keyword">const</span> productionGzipExtensions <span class="token operator">=</span> <span class="token regex">/\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i</span><span class="token punctuation">;</span> <span class="token comment">// 开启gzip压缩， 按需写入</span>
<span class="token keyword">const</span> <span class="token constant">IS_PROD</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'production'</span><span class="token punctuation">,</span> <span class="token string">'prod'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>dir<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token comment">//去除多余的console.log</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
  transpileDependencies<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  assetsDir<span class="token punctuation">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span>
  productionSourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  integrity<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  crossorigin<span class="token punctuation">:</span> undefined<span class="token punctuation">,</span>
  chainWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span><span class="token function">symlinks</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 修复热更新失效</span>
    <span class="token comment">// 如果使用多页面打包，使用vue inspect --plugins查看html是否在结果数组中</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">"html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>args <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 修复 Lazy loading routes Error</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>chunksSortMode <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> args<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias <span class="token comment">// 添加别名</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@assets'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/assets'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@components'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@views'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/views'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@store'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/store'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 压缩图片</span>
    <span class="token comment">// 需要 npm i -D image-webpack-loader</span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">"images"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"image-webpack-loader"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">"image-webpack-loader"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        mozjpeg<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> progressive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> quality<span class="token punctuation">:</span> <span class="token number">65</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        optipng<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> enabled<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        pngquant<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> quality<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.65</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> speed<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        gifsicle<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> interlaced<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        webp<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> quality<span class="token punctuation">:</span> <span class="token number">75</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  configureWebpack<span class="token punctuation">:</span> <span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 开启 gzip 压缩</span>
    <span class="token comment">// 需要 npm i -D compression-webpack-plugin</span>
    <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">IS_PROD</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          filename<span class="token punctuation">:</span> <span class="token string">'[path].gz[query]'</span><span class="token punctuation">,</span>
          algorithm<span class="token punctuation">:</span> <span class="token string">'gzip'</span><span class="token punctuation">,</span>
          test<span class="token punctuation">:</span> productionGzipExtensions<span class="token punctuation">,</span>
          threshold<span class="token punctuation">:</span> <span class="token number">10240</span><span class="token punctuation">,</span><span class="token comment">//大于10k的进行压缩</span>
          minRatio<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token comment">//打包环境去掉console.log等</span>
        <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          terserOptions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            ecma<span class="token punctuation">:</span> undefined<span class="token punctuation">,</span>
            warnings<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            parse<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            compress<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
              drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              drop_debugger<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
              pure_funcs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'console.log'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 移除console</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    config<span class="token punctuation">.</span>plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>config<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span> <span class="token operator">...</span>plugins<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h3><a id="5xwebpack_160"></a>我这个是最方法，大家可以复制到自己的项目中直接使用，我的是5.x的webpack，同类型版本的可以直接使用</h3>
<ul><li>需要nginx也配合使用压缩，开启全局http压缩</li></ul>
<pre><code class="prism language-bash"><span class="token function">gzip</span>  off<span class="token punctuation">;</span>
gzip_static on<span class="token punctuation">;</span>
gzip_min_length 10k<span class="token punctuation">;</span>
gzip_buffers 4 16k<span class="token punctuation">;</span>
gzip_comp_level 6<span class="token punctuation">;</span>
gzip_types application/javascript application/css text/css text/javascript<span class="token punctuation">;</span>
gzip_disable <span class="token string">"MSIE [1-6]\."</span><span class="token punctuation">;</span>
gzip_vary on<span class="token punctuation">;</span>
</code></pre>
<p><strong>这种方法是最优方法真正的考虑性能用的，上面的第一种方法只是让其不提示了而已，不会去考虑性能问题</strong></p>
<p>vue.config.js配置详解注释</p>
<pre><code class="prism language-javascript"><span class="token comment">// vue.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CompressionWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"compression-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 开启gzip压缩， 按需引用</span>
<span class="token keyword">const</span> productionGzipExtensions <span class="token operator">=</span> <span class="token regex">/\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i</span><span class="token punctuation">;</span> <span class="token comment">// 开启gzip压缩， 按需写入</span>
<span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack-bundle-analyzer"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span> <span class="token comment">// 打包分析</span>
<span class="token keyword">const</span> <span class="token constant">IS_PROD</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'production'</span><span class="token punctuation">,</span> <span class="token string">'prod'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">resolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>dir<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//用于生产环境去除多余的css</span>
<span class="token keyword">const</span> PurgecssPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"purgecss-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//全局文件路径</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"glob-all"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//压缩代码并去掉console</span>
<span class="token keyword">const</span> UglifyJsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"uglifyjs-webpack-plugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  publicPath<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">?</span> <span class="token string">'/site/vue-demo/'</span> <span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token comment">// 公共路径</span>
  indexPath<span class="token punctuation">:</span> <span class="token string">'index.html'</span> <span class="token punctuation">,</span> <span class="token comment">// 相对于打包路径index.html的路径</span>
  outputDir<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>outputDir <span class="token operator">||</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token comment">// 'dist', 生产环境构建文件的目录</span>
  assetsDir<span class="token punctuation">:</span> <span class="token string">'static'</span><span class="token punctuation">,</span> <span class="token comment">// 相对于outputDir的静态资源(js、css、img、fonts)目录</span>
  lintOnSave<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否在开发环境下通过 eslint-loader 在每次保存时 lint 代码</span>
  runtimeCompiler<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否使用包含运行时编译器的 Vue 构建版本</span>
  productionSourceMap<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token constant">IS_PROD</span><span class="token punctuation">,</span> <span class="token comment">// 生产环境的 source map</span>
  parallel<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"os"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 是否为 Babel 或 TypeScript 使用 thread-loader。该选项在系统的 CPU 有多于一个内核时自动启用，仅作用于生产构建。</span>
  pwa<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 向 PWA 插件传递选项。</span>
  chainWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span><span class="token function">symlinks</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 修复热更新失效</span>
    <span class="token comment">// 如果使用多页面打包，使用vue inspect --plugins查看html是否在结果数组中</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">"html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>args <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 修复 Lazy loading routes Error</span>
      args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>chunksSortMode <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> args<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    config<span class="token punctuation">.</span>resolve<span class="token punctuation">.</span>alias <span class="token comment">// 添加别名</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@assets'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/assets'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@components'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@views'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/views'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'@store'</span><span class="token punctuation">,</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src/store'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 压缩图片</span>
    <span class="token comment">// 需要 npm i -D image-webpack-loader</span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">"images"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">"image-webpack-loader"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">"image-webpack-loader"</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        mozjpeg<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> progressive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> quality<span class="token punctuation">:</span> <span class="token number">65</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        optipng<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> enabled<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        pngquant<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> quality<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.65</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> speed<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        gifsicle<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> interlaced<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        webp<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> quality<span class="token punctuation">:</span> <span class="token number">75</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 打包分析, 打包之后自动生成一个名叫report.html文件(可忽视)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">IS_PROD</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">"webpack-report"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>BundleAnalyzerPlugin<span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{<!-- --></span>
          analyzerMode<span class="token punctuation">:</span> <span class="token string">"static"</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  configureWebpack<span class="token punctuation">:</span> config <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 开启 gzip 压缩</span>
    <span class="token comment">// 需要 npm i -D compression-webpack-plugin</span>
    <span class="token keyword">const</span> plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">IS_PROD</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">CompressionWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
          filename<span class="token punctuation">:</span> <span class="token string">"[path].gz[query]"</span><span class="token punctuation">,</span>
          algorithm<span class="token punctuation">:</span> <span class="token string">"gzip"</span><span class="token punctuation">,</span>
          test<span class="token punctuation">:</span> productionGzipExtensions<span class="token punctuation">,</span>
          threshold<span class="token punctuation">:</span> <span class="token number">10240</span><span class="token punctuation">,</span>
          minRatio<span class="token punctuation">:</span> <span class="token number">0.8</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//启用代码压缩</span>
            plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    uglifyOptions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                        compress<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
                            warnings<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            drop_debugger<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            pure_funcs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"console.log"</span><span class="token punctuation">]</span> <span class="token comment">//移除console</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    sourceMap<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    parallel<span class="token punctuation">:</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//去掉不用的css 多余的css</span>
            plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">PurgecssPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                    paths<span class="token punctuation">:</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"./**/*.vue"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    extractors<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">{<!-- --></span>
                            extractor<span class="token punctuation">:</span> <span class="token keyword">class</span> <span class="token class-name">Extractor</span> <span class="token punctuation">{<!-- --></span>
                                <span class="token keyword">static</span> <span class="token function">extract</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                    <span class="token keyword">const</span> validSection <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>
                                        <span class="token regex">/&lt;style([\s\S]*?)&lt;\/style&gt;+/gim</span><span class="token punctuation">,</span>
                                        <span class="token string">""</span>
                                    <span class="token punctuation">)</span><span class="token punctuation">;</span>
                                    <span class="token keyword">return</span> validSection<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/[A-Za-z0-9-_:/]+/g</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                                <span class="token punctuation">}</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"html"</span><span class="token punctuation">,</span> <span class="token string">"vue"</span><span class="token punctuation">]</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">]</span><span class="token punctuation">,</span>
                    whitelist<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"html"</span><span class="token punctuation">,</span> <span class="token string">"body"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    whitelistPatterns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token regex">/el-.*/</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                    whitelistPatternsChildren<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token regex">/^token/</span><span class="token punctuation">,</span> <span class="token regex">/^pre/</span><span class="token punctuation">,</span> <span class="token regex">/^code/</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    config<span class="token punctuation">.</span>plugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>config<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span> <span class="token operator">...</span>plugins<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  css<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
    extract<span class="token punctuation">:</span> <span class="token constant">IS_PROD</span><span class="token punctuation">,</span>
    requireModuleExtension<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">// 去掉文件名中的 .module</span>
    loaderOptions<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 给 less-loader 传递 Less.js 相关选项</span>
        less<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// `globalVars` 定义全局对象，可加入全局变量</span>
          globalVars<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            primary<span class="token punctuation">:</span> <span class="token string">'#333'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
      overlay<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// 让浏览器 overlay 同时显示警告和错误</span>
       warnings<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
       errors<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      host<span class="token punctuation">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
      port<span class="token punctuation">:</span> <span class="token number">8080</span><span class="token punctuation">,</span> <span class="token comment">// 端口号</span>
      https<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// https:{type:Boolean}</span>
      open<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//配置自动启动浏览器</span>
      hotOnly<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 热更新</span>
      <span class="token comment">// proxy: 'http://localhost:8080'  // 配置跨域处理,只有一个代理</span>
      proxy<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">//配置多个跨域</span>
        <span class="token string">"/api"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
          target<span class="token punctuation">:</span> <span class="token string">"http://172.11.11.11:7071"</span><span class="token punctuation">,</span>
          changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">// ws: true,//websocket支持</span>
          secure<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"^/api"</span><span class="token punctuation">:</span> <span class="token string">"/"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"/api2"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
          target<span class="token punctuation">:</span> <span class="token string">"http://172.12.12.12:2018"</span><span class="token punctuation">,</span>
          changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">//ws: true,//websocket支持</span>
          secure<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          pathRewrite<span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">"^/api2"</span><span class="token punctuation">:</span> <span class="token string">"/"</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>如果本篇文章对您有帮助请点个赞和关注，谢谢</strong></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>