<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<blockquote>
<p>🌟<strong>个人博客：</strong><a href="https://www.hellocode.top">www.hellocode.top</a>🌟<br/> ⭐所有文章均在<mark>上方博客</mark>首发，其他平台同步更新<br/> 🔥<strong>本文专栏：</strong><a href="https://blog.csdn.net/qq_24980365/category_11657214.html">《Java Web从入门到实战》</a><br/> 🌞&gt; 如没有Java基础，请先前往<a href="https://blog.csdn.net/qq_24980365/category_11505720.html">《Java零基础指南》</a>专栏学习相应知识<br/> ⚡如有问题，欢迎指正，一起学习~~</p>
</blockquote>
<hr/>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><ul><li><a href="#Linux_7">Linux</a></li><li><ul><li><a href="#Linux_9">初识Linux</a></li><li><a href="#Linux_60">Linux的安装和使用</a></li><li><ul><li><a href="#Vmware_64">Vmware</a></li><li><a href="#SecureCRT_85">SecureCRT</a></li><li><a href="#_89">目录和文件</a></li><li><a href="#_98">时间同步</a></li><li><a href="#_102">克隆与快照</a></li></ul>
</li><li><a href="#_116">系统与设置命令</a></li><li><ul><li><a href="#_118">账号管理</a></li><li><a href="#_140">用户组</a></li><li><a href="#_159">系统管理相关命令</a></li><li><a href="#_173">进程相关命令</a></li><li><a href="#_232">目录管理</a></li><li><a href="#_274">文件基本属性</a></li><li><a href="#_312">综合案例</a></li></ul>
</li><li><a href="#_325">文件管理</a></li><li><ul><li><a href="#touch_327">touch</a></li><li><a href="#vivim_334">vi/vim编辑器</a></li><li><a href="#_382">文件查看</a></li><li><a href="#echo_423">echo命令</a></li><li><a href="#awk_430">awk命令</a></li><li><a href="#_460">软连接</a></li></ul>
</li><li><a href="#_466">压缩命令</a></li><li><ul><li><a href="#_468">查找命令</a></li><li><a href="#gzip_478">gzip命令</a></li><li><a href="#gunzip_485">gunzip命令</a></li><li><a href="#tar_491">tar命令</a></li><li><a href="#zip_508">zip命令</a></li><li><a href="#unzip_517">unzip命令</a></li><li><a href="#bzip2_527">bzip2命令</a></li></ul>
</li><li><a href="#_537">网络与磁盘管理</a></li><li><ul><li><a href="#_539">网络管理</a></li><li><a href="#_556">磁盘管理</a></li><li><a href="#yum_580">yum</a></li><li><a href="#rpm_613">rpm</a></li></ul>
</li><li><a href="#shell_620">shell</a></li><li><ul><li><a href="#shell_622">初识shell</a></li><li><a href="#_662">注释和变量</a></li><li><a href="#_710">数组</a></li><li><a href="#_718">运算符</a></li><li><a href="#_795">选择语句</a></li><li><a href="#_865">循环语句</a></li><li><a href="#_901">函数</a></li></ul>
</li></ul>
</li><li><a href="#Nginx_964">Nginx</a></li><li><ul><li><ul><li><a href="#_966">概述</a></li><li><a href="#_971">安装</a></li><li><a href="#_1004">发布项目</a></li></ul>
</li></ul>
</li><li><a href="#JavaWeb_1018">JavaWeb核心</a></li><li><ul><li><a href="#_1020">企业开发简介</a></li><li><ul><li><a href="#JavaEE_1022">JavaEE规范</a></li><li><a href="#WEB_1030">WEB概述</a></li><li><a href="#_1050">系统结构</a></li></ul>
</li><li><a href="#tomcat_1068">tomcat</a></li><li><ul><li><a href="#_1070">服务器</a></li><li><a href="#Tomcat_1082">Tomcat</a></li><li><a href="#_1103">基本使用</a></li><li><a href="#Java_WEB_1148">Java WEB项目</a></li><li><a href="#_1180">配置文件</a></li></ul>
</li><li><a href="#HTTP_1228">HTTP协议</a></li><li><ul><li><a href="#_1230">概述</a></li><li><a href="#_1244">协议的请求</a></li><li><a href="#_1282">协议的响应</a></li></ul>
</li><li><a href="#_1316">发布资源案例</a></li><li><ul><li><a href="#Servlet_1339">Servlet介绍</a></li></ul>
</li><li><a href="#Servlet_1387">Servlet</a></li><li><ul><li><a href="#_1389">概述</a></li><li><a href="#_1396">执行过程</a></li><li><a href="#_1411">实现方式</a></li><li><a href="#_1417">生命周期</a></li><li><a href="#_1430">线程安全问题</a></li><li><a href="#_1439">映射方式</a></li><li><a href="#_1525">创建时机</a></li><li><a href="#Servlet_1537">默认Servlet</a></li></ul>
</li><li><a href="#ServletConfig_1544">ServletConfig</a></li><li><ul><li><a href="#_1550">配置方式</a></li><li><a href="#_1571">常用方法</a></li></ul>
</li><li><a href="#ServletContext_1649">ServletContext</a></li><li><ul><li><a href="#_1655">域对象</a></li><li><a href="#_1660">配置方式</a></li><li><a href="#_1677">常用方法</a></li></ul>
</li><li><a href="#_1734">注解开发</a></li><li><ul><li><a href="#_1742">自动注解开发</a></li><li><a href="#_1763">手动创建容器(了解)</a></li></ul>
</li><li><a href="#1_1801">学生管理系统1</a></li><li><a href="#_1910">请求对象</a></li><li><ul><li><a href="#_1918">获取各种路径</a></li><li><a href="#_1967">获取请求头</a></li><li><a href="#_2011">获取请求参数信息</a></li><li><a href="#_2162">流对象获取请求信息</a></li><li><a href="#_2215">中文乱码问题</a></li><li><a href="#_2243">请求域</a></li><li><a href="#_2254">请求转发</a></li><li><a href="#_2313">请求包含</a></li></ul>
</li><li><a href="#_2350">响应对象</a></li><li><ul><li><a href="#_2358">常见状态码</a></li><li><a href="#_2370">字节流响应消息</a></li><li><a href="#_2409">字符流响应消息</a></li><li><a href="#_2429">响应图片</a></li><li><a href="#_2455">设置缓存</a></li><li><a href="#_2467">定时刷新</a></li><li><a href="#_2478">请求重定向</a></li><li><a href="#_2490">文件下载</a></li></ul>
</li><li><a href="#2_2525">学生管理系统2</a></li><li><a href="#Cookie_2593">Cookie</a></li><li><ul><li><a href="#_2595">会话</a></li><li><a href="#_2601">概述</a></li><li><a href="#Cookie_2614">Cookie属性</a></li><li><a href="#_2626">方法</a></li><li><a href="#_2636">练习</a></li><li><a href="#_2677">注意事项</a></li></ul>
</li><li><a href="#Session_2693">Session</a></li><li><ul><li><a href="#_2707">常用方法</a></li><li><a href="#_2717">对象获取</a></li><li><a href="#_2725">练习</a></li><li><a href="#_2764">注意事项</a></li></ul>
</li><li><a href="#JSP_2779">JSP</a></li><li><ul><li><a href="#_2793">快速入门</a></li><li><a href="#_2814">执行过程</a></li><li><a href="#_2830">语法</a></li><li><a href="#_2842">指令</a></li><li><a href="#_2861">注意事项</a></li><li><a href="#MVC_2890">MVC模型</a></li></ul>
</li><li><a href="#3_2899">学生管理系统3</a></li><li><a href="#EL_3079">EL表达式</a></li><li><ul><li><a href="#_3086">快速入门</a></li><li><a href="#_3121">获取数据</a></li><li><a href="#_3175">注意事项</a></li><li><a href="#_3186">运算符</a></li><li><a href="#_3209">隐式对象</a></li></ul>
</li><li><a href="#JSTL_3266">JSTL</a></li><li><ul><li><a href="#_3280">核心标签</a></li></ul>
</li><li><a href="#Filter_3349">Filter</a></li><li><ul><li><a href="#_3354">概述</a></li><li><a href="#FilterChain_3367">FilterChain</a></li><li><a href="#_3379">过滤器使用</a></li><li><a href="#_3414">使用细节</a></li><li><a href="#_3434">生命周期</a></li><li><a href="#FilterConfig_3443">FilterConfig</a></li><li><a href="#_3467">五种拦截行为</a></li></ul>
</li><li><a href="#Listener_3519">Listener</a></li><li><ul><li><a href="#_3529">监听器</a></li><li><a href="#_3645">监听器的使用</a></li></ul>
</li><li><a href="#_3738">学生管理系统优化</a></li><li><ul><li><a href="#_3740">解决乱码</a></li><li><a href="#_3772">检查登录</a></li><li><a href="#JSP_3816">优化JSP页面</a></li></ul>
</li></ul>
</li><li><a href="#MYSQL_3823">MYSQL</a></li><li><ul><li><a href="#_3825">基本概念</a></li><li><ul><li><a href="#_3827">数据库</a></li><li><a href="#Mysql_3834">Mysql</a></li><li><a href="#_3841">安装</a></li></ul>
</li><li><a href="#DDL_3847">DDL</a></li><li><ul><li><a href="#_3849">数据库、数据表、数据的关系</a></li><li><a href="#SQL_3859">SQL的介绍</a></li><li><a href="#_3874">查询和创建数据库</a></li><li><a href="#_3913">修改、删除、使用数据库</a></li><li><a href="#_3945">查询数据表</a></li><li><a href="#_3968">创建数据表</a></li><li><a href="#_4006">数据表的修改</a></li><li><a href="#_4045">数据表的删除</a></li></ul>
</li><li><a href="#DML_4060">DML</a></li><li><ul><li><a href="#_4062">新增表数据</a></li><li><a href="#_4086">修改和删除表数据</a></li></ul>
</li><li><a href="#DQL_4108">DQL</a></li><li><ul><li><a href="#_4110">查询语法</a></li><li><a href="#_4131">查询全部</a></li><li><a href="#_4196">条件查询</a></li><li><a href="#_4254">聚合函数查询</a></li><li><a href="#_4292">排序查询</a></li><li><a href="#_4312">分组查询</a></li><li><a href="#_4340">分页查询</a></li></ul>
</li><li><a href="#_4374">约束</a></li><li><ul><li><a href="#_4391">主键约束</a></li><li><a href="#_4438">主键自增约束</a></li><li><a href="#_4481">唯一约束</a></li><li><a href="#_4520">非空约束</a></li><li><a href="#_4558">外键约束</a></li><li><a href="#_4624">外键级联操作(了解)</a></li></ul>
</li><li><a href="#_4670">多表操作</a></li><li><ul><li><a href="#_4679">一对一</a></li><li><a href="#_4714">一对多</a></li><li><a href="#_4744">多对多</a></li><li><a href="#_4783">多表查询</a></li><li><a href="#_5036">练习</a></li></ul>
</li><li><a href="#_5201">视图</a></li><li><ul><li><a href="#_5206">数据准备</a></li><li><a href="#_5236">创建和查询</a></li><li><a href="#_5260">修改和删除</a></li></ul>
</li><li><a href="#_5293">数据库备份和恢复</a></li><li><a href="#_5320">存储过程和函数</a></li><li><ul><li><a href="#_5331">创建和调用</a></li><li><a href="#_5394">查看和删除</a></li><li><a href="#_5409">变量</a></li><li><a href="#if_5479">if语句</a></li><li><a href="#_5528">参数传递</a></li><li><a href="#while_5577">while循环</a></li><li><a href="#_5618">存储函数</a></li></ul>
</li><li><a href="#_5663">触发器</a></li><li><ul><li><a href="#_5677">触发器的操作</a></li><li><a href="#_5802">查看和删除</a></li></ul>
</li><li><a href="#_5817">事务</a></li><li><ul><li><a href="#_5824">基本使用</a></li><li><a href="#_5871">提交方式</a></li><li><a href="#ACID_5899">四大特征(ACID)</a></li><li><a href="#_5914">隔离级别</a></li></ul>
</li><li><a href="#_5961">存储引擎</a></li><li><ul><li><a href="#_5966">体系结构</a></li><li><a href="#_5982">存储引擎</a></li><li><a href="#_5993">基本操作</a></li><li><a href="#_6038">存储引擎的选择</a></li></ul>
</li><li><a href="#_6052">索引</a></li><li><ul><li><a href="#_6057">分类</a></li><li><a href="#_6070">创建和查询</a></li><li><a href="#_6117">添加和删除</a></li><li><a href="#_6140">索引的原理</a></li><li><a href="#_6178">设计原则</a></li></ul>
</li><li><a href="#_6201">锁</a></li><li><ul><li><a href="#InnoDB_6232">InnoDB共享锁</a></li><li><a href="#InnoDB_6309">InnoDB排他锁</a></li><li><a href="#MyISAM__6356">MyISAM 读锁</a></li><li><a href="#MyISAM__6408">MyISAM 写锁</a></li><li><a href="#_6446">悲观锁和乐观锁</a></li></ul>
</li><li><a href="#MyCat_6488">MyCat</a></li><li><ul><li><a href="#_6500">安装</a></li><li><a href="#_6526">集群环境</a></li><li><a href="#_6542">主从复制</a></li><li><a href="#_6604">读写分离</a></li><li><a href="#_6648">分库分表</a></li></ul>
</li></ul>
</li><li><a href="#JDBC_6754">JDBC</a></li><li><ul><li><a href="#_6760">快速入门</a></li><li><a href="#_6807">功能类详解</a></li><li><a href="#_6872">案例</a></li><li><ul><li><a href="#_6876">数据准备</a></li><li><a href="#_6974">需求实现</a></li><li><a href="#_6982">代码展示</a></li></ul>
</li><li><a href="#_7284">工具类</a></li><li><ul><li><a href="#_7286">抽取工具类</a></li><li><a href="#_7395">优化学生案例</a></li></ul>
</li><li><a href="#_7592">注入攻击</a></li><li><a href="#_7677">事务管理</a></li><li><a href="#_7730">连接池</a></li><li><ul><li><a href="#_7738">自定义数据库连接池</a></li><li><a href="#_7879">归还连接</a></li><li><a href="#_8263">动态代理</a></li><li><a href="#_8334">开源数据库连接池</a></li><li><a href="#_8475">连接池的工具类</a></li></ul>
</li><li><a href="#_8610">框架</a></li><li><ul><li><a href="#_8614">源信息</a></li><li><a href="#update_8635">update方法</a></li><li><a href="#_8760">查询功能</a></li></ul>
</li></ul>
</li><li><a href="#Mybatis_9153">Mybatis</a></li><li><a href="#JavaScript_9155">JavaScript</a></li><li><a href="#jQuery_9157">jQuery</a></li><li><a href="#AJAX_9159">AJAX</a></li><li><a href="#Vue__Element_9161">Vue + Element</a></li><li><a href="#Redis_9163">Redis</a></li><li><a href="#Maven_9165">Maven基础</a></li><li><a href="#Web_9167">Web项目实战-黑马页面</a></li></ul>
</li></ul>
</div>
<p></p>
<h2><a id="Linux_7"></a>Linux</h2>
<h3><a id="Linux_9"></a>初识Linux</h3>
<p><strong>操作系统</strong>：管理<mark>计算机硬件</mark>与<mark>软件资源</mark>的计算机程序，同时也是计算机系统的内核与基石。</p>
<p><strong>主流操作系统</strong></p>
<ul><li>桌面操作系统：Window系列、macOS、Linux</li><li>服务器操作系统：Linux、Windows Server</li><li>嵌入式操作系统：Linux</li><li>移动设备操作系统：Unix（Linux、ios）</li></ul>
<p><strong>Linux发展历程</strong></p>
<ul><li>1984年Minix（只用于教学）</li><li>1991年编写驱动程序，年底公开Linux内核源码</li><li>1994年Linux1.0（Linus Torvalds）</li><li>至此开始流行起来</li></ul>
<p><strong>Linux特点</strong></p>
<ul><li>Linux是一套<mark>免费</mark>使用和自由传播的类Unix操作系统</li><li>是一个基于POSIX和Unix的多用户、多任务、支持多线程和多CPU的操作系统</li><li>它能运行主要的Unix工具软件、应用程序和网络协议。它支持32位和64位硬件</li><li>继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统</li><li>两个基本思想 
  <ul><li>一切都是文件</li><li>每个软件都有确定的用途</li></ul> </li><li>完全兼容POSIX1.0标准</li><li>多用户、多任务</li><li>良好的界面</li><li>支持多种平台</li></ul>
<p><strong>Linux与其它操作系统的区别</strong></p>
<ul><li>开源情况</li><li>硬件适用</li><li>本质不同</li><li>系统界面</li><li>驱动程序</li><li>系统使用</li><li>软件与支持</li></ul>
<blockquote>
<p>Windows更适用于家庭个人使用</p>
<p>Linux更适用于企业服务器使用</p>
</blockquote>
<p><strong>Linux发行商和常见发行版</strong></p>
<ul><li>Redhat公司--------Red Hat Linux（最著名的Linux版本、收费）-----免费的CentOS</li><li>CentOS特点：主流、免费、更新方便</li></ul>
<h3><a id="Linux_60"></a>Linux的安装和使用</h3>
<p>先安装虚拟机，再安装Centos</p>
<h4><a id="Vmware_64"></a>Vmware</h4>
<p><strong>Vmware简介</strong></p>
<ul><li>不需要分区或者重开机就能在同一台PC上使用两种以上的操作系统</li><li>完全隔离并且保护不同操作系统的环境以及所有的软件、资料</li><li>不同的操作系统之间还可以进行互动操作</li><li>有复原功能</li><li>能够设置并且随时修改操作系统的操作环境</li><li>常见虚拟机软件：VMware workstation、VirtualBox</li></ul>
<p><strong>Vmware下载</strong>：<a href="https://www.vmware.com/cn.html">https://www.vmware.com/cn.html</a></p>
<p><strong>CentOS镜像下载</strong>：<a href="https://www.centos.org/download/">https://www.centos.org/download/</a><br/> <mark>高速下载地址</mark></p>
<ul><li><a href="http://mirrors.aliyun.com">http://mirrors.aliyun.com</a></li><li><a href="http://mirrors.sohu.com">http://mirrors.sohu.com</a></li><li><a href="http://mirrors.163.com">http://mirrors.163.com</a></li><li><a href="http://mirrors.cqu.edu.cn/CentOS">http://mirrors.cqu.edu.cn/CentOS</a></li></ul>
<h4><a id="SecureCRT_85"></a>SecureCRT</h4>
<p>简介：SecureCRT是一款支持SSH（SSH1和SSH2）的终端仿真程序，简单地说是Windows下登录Unix或Linux服务器主机的软件。</p>
<h4><a id="_89"></a>目录和文件</h4>
<ul><li>Linux没有盘符这个概念，只有一个根目录/，所有文件都在他下面</li><li>etc表示系统中的配置文件</li><li>usr、usr/bin、usr/sbin都表示系统预设执行文件的放置目录</li><li>var/log表示程序运行日志的存放目录</li><li>切换根目录：<code>cd /</code></li><li>查看目录内容：<code>ls -l</code></li></ul>
<h4><a id="_98"></a>时间同步</h4>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/fdaeef93ee4b408f89d8187a04c0e276.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="_102"></a>克隆与快照</h4>
<p><strong>克隆</strong>：将原系统完完全全的拷贝一份，原系统丢失后克隆的系统还能正常使用</p>
<ul><li>占用空间大</li><li>原系统不存在，克隆体还能用</li></ul>
<p><strong>快照</strong>：记录系统当前状态，并不会把系统完整拷贝</p>
<ul><li>占用空间小</li><li>原系统不存在，快照也就无法使用</li></ul>
<blockquote>
<p>克隆和拍摄快照时都需要关闭虚拟机</p>
</blockquote>
<h3><a id="_116"></a>系统与设置命令</h3>
<h4><a id="_118"></a>账号管理</h4>
<blockquote>
<p>与用户相关的命令，必须在管理员权限下才能执行</p>
<p>命令：<code>su root</code></p>
</blockquote>
<ul><li>创建用户：<code>useradd (选项) 用户名</code></li><li>用户口令：<code>passwd (选项) 用户名</code>
<ul><li>密码不能是一个回文</li><li>长度必须大于8位</li><li>必须是字母和数字的结合</li></ul> </li></ul>
<blockquote>
<p>在root权限下切换其它用户可直接切换，无需输入密码</p>
</blockquote>
<ul><li>修改用户：<code>usermod 选项 用户名</code></li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1d5a03c097604b4da6f09ebc62288c90.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<ul><li>删除用户：<code>userdel (选项) 用户名</code></li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b8c54a4e51f247dda4fc04ad11f61058.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="_140"></a>用户组</h4>
<p>将用户分成小组，方便对用户的管理</p>
<ul><li>创建用户组：<code>groupadd (选项) 用户组名</code></li><li>修改用户组：<code>groupmod (选项) 用户组名</code><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e7bededf3c33469f85b522d9c673ebab.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></li><li>查询用户所属组：<code>groups 用户名</code></li><li>删除用户组：<code>groupdel 用户组名</code></li><li>管理用户组内成员：<code>gpasswd (可选项) 组名</code>
<blockquote>
<p>gpasswd是Linux下的管理工具，用于将一个用户添加到组或者从组中删除</p>
</blockquote>
<ul><li>-a：添加用户到组</li><li>-d：从组中删除用户</li><li>-A：指定管理员</li><li>-M：指定组员和-A的用途差不多</li><li>-r：删除密码</li><li>-R：限制用户登入组，只有组中的成员才可以用newgrp加入该组<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d4b50104aba846a5b2baa468b0330de0.png#pic_center"/></li></ul> </li></ul>
<h4><a id="_159"></a>系统管理相关命令</h4>
<ul><li>日期管理：<code>date [参数选项]</code><br/> 参数选项： 
  <ul><li><code>-d "字符串"</code>：显示字符串所指的日期与时间。字符串前后必须加上双引号</li><li><code>-s "字符串"</code>：根据字符串来设置日期与时间。字符串前后必须加上双引号</li><li><code>-u</code>：显示GMT（北京时间为CST）</li><li><code>--help</code>：在线帮助</li><li><code>--version</code>：显示版本信息</li></ul> </li><li>显示登陆账号的信息：<code>logname</code></li><li>切换用户：<code>su 用户名</code></li><li>查看当前用户详细信息（用户id、群组id、所属组）：<code>id 用户名</code></li><li>提高普通用户的操作权限：<code>sudo [参数选项]</code></li></ul>
<h4><a id="_173"></a>进程相关命令</h4>
<p><mark>实时显示process的动态</mark> ：<code>top</code></p>
<blockquote>
<p>pid:每个进程的id</p>
<p>user：进程是属于哪个用户</p>
<p>PR：进程的优先级</p>
<p>NI：进程优先级（负数为高优先级，正数为低优先级）</p>
<p>VIRT：当前进程占用虚拟内存的总量</p>
<p>S：当前进程的状态</p>
</blockquote>
<ul><li>实时显示所有进程信息（显示完整命令）:<code>top -c</code></li><li>实时显示指定进程的信息：<code>top -p PID</code></li><li>结束实时监控：<code>q</code></li></ul>
<p><mark>查看当前正在运行的进程信息</mark>：<code>ps</code></p>
<ul><li>显示系统中所有的进程信息：<code>ps -A</code></li><li>显示系统中所有的进程信息（完整信息）：<code>ps -ef</code></li><li>显示指定用户的进程信息：<code>ps -u 用户名</code></li></ul>
<p><mark>中断执行中的程序</mark>：<code>kill PID</code></p>
<ul><li>例如：<code>kill 1111</code>表示杀死PID为1111的进程</li><li><code>kill -9 PID</code>：强制杀死指定PID的进程</li><li><code>killall -u 用户名</code>：杀死这个用户中的所有进程</li><li><code>kill -9 $(ps -ef|grep 用户名)</code>：杀死指定用户的所有进程</li><li><code>kill -l</code>：查看对应编号</li></ul>
<p><mark>关机命令</mark>：<code>shutdown</code>（延迟关机)</p>
<ul><li><code>shutdown -h now</code>：立即关机</li><li><code>shutdown +1 "1分钟以后关机"</code>：延迟一分钟以后关机，并给出警告信息</li><li><code>shutdown -r +1 "准备重启了"</code>：延迟一分钟以后重启，并给出警告信息</li><li><code>shutdown -c</code>：取消关机命令<br/> <mark>重启命令</mark>：<code>reboot</code>（立即重启）</li></ul>
<p><mark>显示当前登录系统的用户</mark>：<code>who</code></p>
<ul><li><code>who -H</code>：显示明细（标题）信息</li></ul>
<p><mark>校正服务器时间、时区</mark>：<code>timedatectl</code></p>
<p>几个小概念</p>
<table><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td>时区</td><td>因时区不同显示的时间不同，牵扯到夏令时和调整等问题，date命令可查看</td></tr><tr><td>系统时钟：System Clock</td><td>Linux OS的时间，date命令可查看</td></tr><tr><td>硬件时钟：RTC:Real Time Clock</td><td>主板上由电池供电的BIOS时间，hwclock -r可查看</td></tr><tr><td>NTP:Network Time Protocol</td><td>本机时间和实际的时间之间的经常会有差别，一般使用NTP服务器进行时间校准</td></tr></tbody></table>
<ul><li><code>timedatectl status</code>：显示系统的当前时间和日期</li><li><code>timedatectl list-timezones</code>：查看所有可用的时区</li><li><code>timedatectl set-timezone "Asia/Shanghai"</code>：设置本地时区</li><li><code>timedatectl set-ntp false</code>：禁用时间同步</li><li><code>timedatectl set-time "2022-02-22 20:20:00"</code>：设置时间</li><li><code>timedatectl set-ntp true</code>：启用时间同步</li></ul>
<p><mark>清除屏幕</mark>：<code>clear</code></p>
<h4><a id="_232"></a>目录管理</h4>
<table><thead><tr><th>常见命令</th><th>作用</th></tr></thead><tbody><tr><td>ls</td><td>列出目录</td></tr><tr><td>cd</td><td>切换目录</td></tr><tr><td>pwd</td><td>显示目前的目录</td></tr><tr><td>mkdir</td><td>创建新目录</td></tr><tr><td>rmdir</td><td>删除空目录</td></tr><tr><td>cp</td><td>复制文件或目录</td></tr><tr><td>rm</td><td>删除文件或目录</td></tr><tr><td>mv</td><td>移动文件或目录<br/>修改文件或者目录的名字</td></tr></tbody></table>
<ul><li>ls命令相当于在Windows系统中打开文件夹，看到的目录以及文件的明细。 
  <ul><li>语法：<code>ls [参数选项] 目录名称</code></li><li><code>-a</code>：显示所有文件或目录（包含隐藏）</li><li><code>-d</code>：仅列出目录本身，而不是列出目录内的文件数据（常用）</li><li><code>-l</code>：长数据串列出，包含文件的属性与权限等等数据（常用）</li></ul>
<blockquote>
<p><code>ls</code>：显示不隐藏的文件与文件夹<br/> <code>ls -l</code>：显示不隐藏的文件与文件夹的详细信息<br/> <code>ls -al</code>：显示所有文件与文件夹的详细信息</p>
</blockquote> </li><li><code>pwd -P</code>：查看当前所在目录</li><li><code>cd [相对路径或绝对路径]</code>：切换目录 
  <ul><li><code>cd ..</code>：返回上一级目录</li></ul> </li><li><code>mkdir</code>
<ul><li><code>mkdir 文件夹的名字</code>：创建单级目录</li><li>创建多级文件夹，使用<code>mkdir -p aaa/bbb</code></li></ul> </li><li><code>rmdir</code>
<ul><li><code>rmdir 文件夹名字</code>：删除空目录</li><li><code>rmdir -p aaa/bbb</code>：删除多级目录（先删bbb，如果删完aaa也为空，则aaa也一起删除）</li></ul> </li><li><code>rm</code>
<ul><li><code>rm 文件路径</code>：删除文件</li><li><code>rm -r 目录路径</code>：删除目录和目录里面所有的内容（单级目录或多级目录都行）</li></ul> </li><li><code>touch 文件名.后缀名</code>：创建一个文件</li><li><code>cp</code>
<ul><li><code>cp 数据源 目的地</code>：文件复制（仅文件）</li><li><code>cp -r aaa/* ccc</code>：将aaa目录中的所有文件及目录拷贝到ccc中（<code>*</code>代指所有）</li></ul> </li><li><code>mv</code>
<ul><li><code>mv 数据源 目的地</code>：改名(数据源和目的地相同)、移动文件或文件夹</li><li><code>mv 文件名 文件名</code>：将源文件名改为目标文件名</li><li><code>mv 目录名 目录名</code>：目标目录已存在，将源目录移动到目标目录；目标目录不存在则改名</li></ul> </li></ul>
<h4><a id="_274"></a>文件基本属性</h4>
<ul><li>文件权限（共10位） 
  <ul><li>第一位为<mark>d</mark>表示是一个文件夹；是 <mark>-</mark> 表示是一个文件；<mark>|</mark> 表示是一个链接文档（快捷方式）</li><li><mark>r</mark>表示可读；<mark>w</mark>表示可写；<mark>x</mark>表示可执行； <mark>-</mark> 表示没有当前权限</li><li>2-4位表示属主权限（文件所属的用户可以做的事情）</li><li>5-7位表示属组权限（文件所在用户组可以对它做的事）</li><li>8-10位表示其它用户权限</li></ul> </li><li><code>chgrp</code>命令（change group） 
  <ul><li><code>chgrp [选项参数] [所属群组] [文件或目录...]</code>：更改所属组</li><li><code>chgrp root aaa</code>：将aaa文件夹所属组更改为root</li><li><code>chgrp -v root aaa</code>：将aaa的属组改为root（<mark>-v</mark>会多一句提示语）</li></ul> </li><li><code>chown</code>命令 
  <ul><li><code>chown 属主名 文件名</code>：更改属主</li><li><code>chown [参数选项] 属主名:属组名 文件名</code>：更改属主和属组</li><li><mark>-R</mark>：处理指定目录以及其子目录下的所有文件</li></ul> </li><li><code>chmod</code>命令 
  <ul><li>作用：修改属主、属组、其他用户的权限</li><li>数字方式语法：<code>chmod [参数选项] 数字权限 文件或目录</code></li><li>符号方式语法：<code>chmod u=rwx,g=rx,o=r a.txt</code></li><li><mark>-R</mark>：对目前目录下的所有档案与子目录进行相同的权限变更（即以递回的方式逐个变更）</li></ul> </li></ul>
<p><strong>修改方式</strong></p>
<ul><li>数字方式 
  <ul><li><mark>r</mark>-----<mark>4</mark></li><li><mark>w</mark>----<mark>2</mark></li><li><mark>x</mark>----<mark>1</mark></li><li><mark>-</mark>----<mark>0</mark></li></ul>
<blockquote>
<p>设置时会把三个数字加在一起设置<br/> 例如：rwx则为7</p>
</blockquote> </li><li>符号方式 
  <ul><li><mark>user</mark>属主权限----<mark>u</mark></li><li><mark>group</mark>属组权限----<mark>g</mark></li><li><mark>others</mark>其它权限----<mark>o</mark></li><li><mark>all</mark>全部身份----<mark>a</mark></li><li><mark>+</mark>（加入）、<mark>-</mark>（除去）、=（设定）</li><li><mark>r</mark>（可读）、<mark>w</mark>（可写）、<mark>x</mark>（可执行）</li></ul> </li></ul>
<h4><a id="_312"></a>综合案例</h4>
<blockquote>
<p>需求：一个公司的开发团队有三个用户：Java、erlang、golang<br/> 有一个文件目录tmp/work供他们开发，如何实现让这三个用户都对其具有写权限</p>
</blockquote>
<p><strong>思路</strong></p>
<ul><li>创建三个用户，并把他们加入到对应的用户组（dev-group）</li><li>将tmp/work文件夹所属组更改为dev-group</li><li>修改文件夹所属组的权限</li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/8ee972f981ee4b94b8ef7a1682b60795.png#pic_center"/></p>
<h3><a id="_325"></a>文件管理</h3>
<h4><a id="touch_327"></a>touch</h4>
<ul><li>语法：<code>touch [参数选项] 文件名</code>
<blockquote>
<p>如果文件不存在就创建文件，如果存在就修改时间属性</p>
</blockquote> </li><li><code>touch a{1..10}.txt</code>：创建a1.txt一直到a10.txt共10个文件（批量创建空文件）</li><li><code>stat a.txt</code>：查看文件的详细信息</li></ul>
<h4><a id="vivim_334"></a>vi/vim编辑器</h4>
<ul><li>vi编辑器：只能是编辑文本内容，不能对字体、段落进行排版 
  <ul><li>不支持鼠标操作</li><li>没有菜单</li><li>只有命令</li></ul> </li><li>vim编辑器：vim是从vi发展出来的一个文本编辑器。 
  <ul><li>代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用</li></ul> </li></ul>
<blockquote>
<p>简单来说：<br/> vi是老式的文字处理器，不过功能已经很齐全了，但是还是有可以改进的地方<br/> vim则可以说是程序员开发者的一项很好用的工具</p>
</blockquote>
<ul><li>vi/vim三种模式 
  <ul><li>阅读模式（命令模式）</li><li>编辑模式（编辑模式）</li><li>保存模式（末行模式）</li></ul>
<blockquote>
<p>命令模式下只能读不能写<br/> 在命令模式下输入<code>i</code>可以进入编辑模式，在编辑完成之后按下<code>Esc</code>又可以退出到命令模式<br/> 在命令模式下输入<code>:</code>可以进入末行模式，在保存完之后还可以按下两次<code>Esc</code>继续回退到命令模式</p>
</blockquote> </li><li>打开和新建文件 
  <ul><li>语法：<code>vim 文件名</code></li><li>如果文件已经存在，会直接打开文件（命令模式）</li><li>如果文件不存在，打开一个临时文件，在保存且退出后，就会新建一个文件</li></ul> </li><li>进入编辑模式</li></ul>
<table><thead><tr><th>命令</th><th>英文</th><th>功能</th><th>常用</th></tr></thead><tbody><tr><td>i</td><td>insert</td><td>在当前字符前插入文本</td><td>常用</td></tr><tr><td>I</td><td>insert</td><td>在行首插入文本</td><td>较常用</td></tr><tr><td>a</td><td>append</td><td>在当前字符后添加文本</td><td></td></tr><tr><td>A</td><td>append</td><td>在行末添加文本</td><td>较常用</td></tr><tr><td>o</td><td></td><td>在当前行后面插入一空行</td><td>常用</td></tr><tr><td>O</td><td></td><td>在当前行前面插入一空行</td><td>常用</td></tr></tbody></table>
<ul><li>进入末行模式保存文件 
  <ul><li><code>:q</code>：当vim进入文件没有对文件内容做任何操作可以按“q”退出</li><li><code>:q!</code>：当vim进入文件对文件内容有操作但不想保存退出</li><li><code>:wq</code>：正常保存退出</li><li><code>:wq!</code>：强行保存退出，只针对于root用户或文件所有人</li></ul> </li><li>vim定位行 
  <ul><li>语法：<code>vim 文件名 +行数</code>：查看文件并定位到具体行数</li><li><code>vim a.txt +5</code>：查看a.txt文件并定位到第5行</li></ul> </li><li>异常处理 
  <ul><li>如果vim异常退出，在磁盘上可能会保存有<mark>交换文件</mark></li></ul>
<blockquote>
<p>在修改一个文件时(a.txt)，为保证文件安全，vim不会对源文件进行修改，会产生一个新的文件(a.txt.swp)，并对该文件进行编辑<br/> 只有在保存的时候，才会将新文件写回到源文件中</p>
</blockquote>
<ul><li>如果有交换文件，在下次使用vim编辑文件时，系统会提示是否对交换文件继续操作（将交换文件删除即可）</li></ul> </li></ul>
<h4><a id="_382"></a>文件查看</h4>
<table><thead><tr><th>命令</th><th>功能</th></tr></thead><tbody><tr><td>cat 文件名</td><td>查看小文件内容</td></tr><tr><td>less -N 文件名</td><td>分屏显示大文件内容</td></tr><tr><td>head -n 文件名</td><td>查看文件的前一部分</td></tr><tr><td>tail -n 文件名</td><td>查看文件的最后部分</td></tr><tr><td>grep 关键字 文件名</td><td>根据关键字搜索文本文件内容</td></tr></tbody></table>
<ul><li><code>cat -n a.txt</code>：可以加入参数选项<code>-n</code>显示行号 
  <ul><li>只能阅读小文件</li><li>阅读大文件可能显示不完整</li></ul> </li><li><code>less 文件名</code>：查看大文件 
  <ul><li>加入<code>-N</code>可显示行号</li><li>ctrl + F ：向前移动一屏</li><li>ctrl + B ：向后移动一屏</li><li>ctrl + D ：向前移动半屏</li><li>ctrl + U ：向后移动半屏</li><li>j ：向前移动一行</li><li>k ：向后移动一行</li><li>G：移动到最后一行</li><li>g：移动到第一行</li><li>q/ZZ：退出less命令</li></ul> </li><li><code>tail 文件名</code>：默认查看文件最后10行内容 
  <ul><li><code>tail -3 b.txt</code>：查看文件最后3行内容</li><li><code>tail -f b.txt</code>：动态显示文件最后10行内容（<mark>ctrl + C停止</mark>）</li><li><code>tail -n +2 b.txt</code>：显示文件b.txt的内容，从第2行至文件末尾</li><li><code>tail -c 45 b.txt</code>：显示文件最后45个字符</li></ul> </li><li><code>head 文件名</code>：查看文件前10行内容 
  <ul><li>其它内容和tail类似</li></ul> </li><li><code>grep命令</code>
<ul><li>类似于Windows下打开文件后ctrl+F的查找功能</li><li>查找对应的进程</li><li>语法：<code>grep [参数选项] 关键字 文件</code>：根据关键字，搜索文本文件内容</li><li><mark>-n</mark>：把包含关键字的行号展示出来</li><li><mark>-i</mark>：把包含关键字的行展示出来，搜索时忽略大小写</li><li><mark>-v</mark>：把不包含关键字的行展示出来</li><li><code>ps -ef | grep sshd</code>：将进程中含有sshd的进程展示出来</li><li><code>ps -ef | grep -c sshd</code>：将进程中含有sshd的进程的个数展示出来</li></ul> </li></ul>
<h4><a id="echo_423"></a>echo命令</h4>
<ul><li><code>echo 字符串</code>：展示文本</li><li><code>echo 字符串 &gt; 文件名</code>：将字符串写到文件中（覆盖文件内容）</li><li><code>echo 字符串 &gt;&gt; 文件名</code>：将字符串写到文件中（不覆盖原内容）</li><li><code>cat 不存在的目录 &amp;&gt;&gt; 存在的文件</code>：将命令的失败结果追加到指定的文件的后面</li></ul>
<h4><a id="awk_430"></a>awk命令</h4>
<ul><li>AWK是一种处理文本文件的语言，是一个强大的文本分析工具（名字取自三位创始人名字中的字母）</li><li>语法：<code>awk [参数选项] '语法' 文件</code></li><li>过滤：<code>cat a.txt | awk '/zhang|li/'</code>：查看a.txt文件中包含zhang或者li的行</li><li>切割</li></ul>
<table><thead><tr><th>选项</th><th>含义</th></tr></thead><tbody><tr><td><code>-F ','</code></td><td>使用指定字符分割</td></tr><tr><td><code>$ + 数字</code></td><td>获取第几段内容</td></tr><tr><td><code>$0</code></td><td>获取当前行内容</td></tr><tr><td><code>OFS="字符"</code></td><td>向外输出时的段分割字符串</td></tr><tr><td><code>toupper()</code></td><td>字符转成大写</td></tr><tr><td><code>tolower()</code></td><td>字符转成小写</td></tr><tr><td><code>length()</code></td><td>返回字符长度</td></tr></tbody></table>
<blockquote>
<p><code>cat a.txt | awk -F ' ' '{print $1,$2,$3}'</code>：将a.txt中的内容按空格分割并打印第1-3列<br/> <code>cat a.txt | awk -F ' ' '{print toupper($1),$2,$3}'</code>：将a.txt中的内容分隔后并将$1中的内容转为大写字符后输出<br/> <code>cat a.txt | awk -F '' '{OFS="---"}{print $1,$2,$3}'</code>：将a.txt中的内容分隔后并用—重新分隔后输出</p>
</blockquote>
<ul><li>计算</li></ul>
<table><thead><tr><th>命令</th><th>含义</th></tr></thead><tbody><tr><td>awk<br/>BEGIN{初始化操作}<br/>{每行都执行}<br/>END{结束时操作}<br/>文件名</td><td>固定语法<br/>BEGIN{这里面放的是执行前的语句}<br/>{这里面放的是处理每一行要执行的语句}<br/>END{这里面放的是处理完所有的行后要执行的语句}<br/>文件名</td></tr></tbody></table>
<blockquote>
<p><code>cat a.txt | awk -F' ' 'BEGIN{}{totle=totle+$2}END{print totle}'</code>：将a.txt分割后把$2的值相加并输出<br/> <code>cat a.txt | awk -F' ' 'BEGIN{}{totle=totle+$2}END{print totle}'</code>：输出totle以及总人数（行数）</p>
</blockquote>
<h4><a id="_460"></a>软连接</h4>
<ul><li>类似于Windows里面的快捷方式</li><li>语法：<code>ln -s 目标文件路径 快捷方式路径</code></li><li><code>ln -s aaa/bbb/ccc/ddd/eee/a.txt a.txt</code></li></ul>
<h3><a id="_466"></a>压缩命令</h3>
<h4><a id="_468"></a>查找命令</h4>
<ul><li>语法：<code>find [参数选项] &lt;指定目录&gt; &lt;指定条件&gt; &lt;指定内容&gt;</code>：在指定目录下查找文件</li><li>参数选项 
  <ul><li><mark>-name filename</mark>：查找名为filename的文件</li><li><mark>-ctime -n或+n</mark>：按时间来查找文件，-n指n天以内，+n指n天以前</li></ul> </li><li><code>find . -name "*.txt"</code>：查找当前目录下所有以txt为后缀的文件</li><li><code>find . -ctime -1</code>：当前文件夹下1天内操作过的文件 
  <blockquote>
<p>将 <mark>.</mark> 替换为 <mark>/</mark> 则表示在全盘范围进行查找</p>
</blockquote> </li></ul>
<h4><a id="gzip_478"></a>gzip命令</h4>
<ul><li>语法：<code>gzip [参数选项] [文件]</code>：压缩文件</li><li><code>gzip a.txt</code>：将a.txt文件压缩</li><li><code>gzip *</code>：将当前目录下所有文件都进行压缩（已经压缩过的不能再次被压缩）</li><li><code>gzip -dv 文件名</code>：解压文件并显示详细信息</li></ul>
<h4><a id="gunzip_485"></a>gunzip命令</h4>
<ul><li>语法：<code>gunzip [参数] [文件]</code>：解压文件</li><li><code>gunzip 压缩文件</code>：解压压缩文件</li><li><code>gunzip *</code>：解压当前目录下的所有压缩文件</li></ul>
<h4><a id="tar_491"></a>tar命令</h4>
<ul><li>语法：<code>tar [必要参数] [选择参数] [文件]</code>：打包、压缩和解压（文件/文件夹）</li><li><mark>注意</mark>：tar本身不具有压缩功能，它是调用压缩功能实现的</li><li>参数选项 
  <ul><li><mark>-c</mark>：建立新的压缩文件</li><li><mark>-v</mark>：显示指令执行过程</li><li><mark>-f &lt;备份文件&gt;</mark>：指定压缩文件</li><li><mark>-z</mark>：通过gzip指令处理压缩文件</li><li><mark>-t</mark>：列出压缩文件中的内容</li><li><mark>-x</mark>：表示解压</li></ul> </li><li><code>tar -cvf 打包文件名 文件名</code>：打包文件并指定打包之后的文件名（仅打包不压缩）</li><li><code>tar -zcvf b.gz b.txt</code>：通过gzip指令将b.txt压缩为b.gz并显示过程（打包压缩）</li><li><code>tar -zcvf aaa.gz aaa</code>：将aaa文件夹压缩为aaa.gz</li><li><code>tar -ztvf aaa.gz</code>：查看压缩文件中的内容</li><li><code>tar -zxvf aaa.gz</code>：解压aaa.gz文件</li></ul>
<h4><a id="zip_508"></a>zip命令</h4>
<ul><li>语法：<code>zip [必要参数] [选择参数] [文件]</code>：压缩</li><li><mark>注意</mark>：zip是个使用广泛的压缩程序，文件经他压缩后会另外产生具有"<mark>.zip</mark>"扩展名的压缩文件</li><li>参数选项 
  <ul><li><mark>-q</mark>：不显示指令执行过程</li><li><mark>-r</mark>：递归处理，将指定目录下的所有文件和子目录一并处理</li></ul> </li><li><code>zip -q -r 压缩文件名 文件/文件夹</code>：压缩对应的文件/文件夹</li></ul>
<h4><a id="unzip_517"></a>unzip命令</h4>
<ul><li>语法：<code>unzip [必要参数] [选择参数] [文件]</code>：解压</li><li><mark>注意</mark>：只能解压"<mark>.zip</mark>"扩展名的压缩文件</li><li>参数选项 
  <ul><li><mark>-l</mark>：显示压缩文件内所包含的文件</li><li><mark>-d &lt;目录&gt;</mark>：指定文件解压缩后要存储的目录</li></ul> </li><li><code>unzip -l aaa.zip</code>：查看aaa.zip压缩文件所包含的文件</li><li><code>unzip -d aaa aaa.zip</code>：将aaa.zip压缩文件解压到aaa文件夹中（aaa文件夹可以不存在，会自动创建）</li></ul>
<h4><a id="bzip2_527"></a>bzip2命令</h4>
<ul><li>语法：<code>bzip2 [参数选项] 文件</code>：压缩文件</li><li><mark>注意</mark>：使用新的压缩算法，和zip相比压缩后的<mark>文件比原来的要小</mark>，但<mark>花费时间变长</mark></li><li>若没有加上任何参数，bizp2压缩完文件后会产生bz2的压缩文件，并删除原始文件</li><li><code>bzip2 a.txt</code>：压缩并删除a.txt</li><li><strong>bunzip2命令</strong>：<code>bunzip2 [参数选项] 文件</code>：解压 
  <ul><li><mark>-v</mark>：解压文件时，显示详细的信息</li><li><code>bunzip2 -v a.bz2</code>：解压并显示详细信息</li></ul> </li></ul>
<h3><a id="_537"></a>网络与磁盘管理</h3>
<h4><a id="_539"></a>网络管理</h4>
<ul><li><strong>ifconfig命令</strong>
<ul><li>语法：<code>ifconfig [参数选项]</code>：显示或配置网络设备的命令</li><li><code>ifconfig ens37 down</code>：关闭ens37这张网卡</li><li><code>ifconfig ens37 up</code>：开启网卡ens37</li><li><code>ifconfig ens37 192.168.23.199</code>：将ens37网卡的ip更改为192.168.23.199</li><li><code>ifconfig ens37 192.168.23.199 netmask 255.255.255.0</code>：配置ip地址和子网掩码</li></ul> </li><li><strong>ping命令</strong>
<ul><li>语法：<code>ping [参数选项]</code>：检测是否与主机联通</li><li><mark>-c &lt;完成次数&gt;</mark>：设置完成要求回应的次数</li><li><code>ping -c 2 www.baidu.com</code>：指定接收包的次数</li></ul> </li><li><strong>netstat命令</strong>
<ul><li>语法：<code>netstat [参数选项]</code>：显示网络状态</li><li><mark>-a</mark>：显示所有连线中的Socket</li><li><mark>-i</mark>：显示网卡列表</li></ul> </li></ul>
<h4><a id="_556"></a>磁盘管理</h4>
<ul><li><strong>lsblk命令</strong>
<ul><li>语法：<code>lsblk [参数选项]</code>：列出硬盘的使用情况</li><li>理解为：list block的英文缩写</li><li><code>lsblk -f</code>：显示系统信息</li></ul> </li><li><strong>df命令</strong>
<ul><li>语法：<code>df [参数选项]</code>：显示目前在Linux系统上，磁盘的使用情况</li><li><mark>–total</mark>：显示所有的信息</li><li><mark>-h</mark>：换算成KB，MB，GB等形式进行展示（方便阅读）</li><li><code>df</code>：显示整个硬盘的使用情况</li><li><code>df 文件夹</code>：显示文件夹使用情况</li><li><code>df --total</code>：显示所有的信息</li><li><code>df -h</code>：将结果变成kb、mb、gb等形式展示，利于阅读</li></ul> </li><li><strong>mount命令</strong>
<ul><li>语法：<code>mount [参数选项] 目录</code>：用于<mark>挂载</mark>Linux系统外的设备</li><li>类似与Windows中的U盘，但在Linux中需要手动新建一个文件夹，并把该文件夹和U盘关联起来（挂载点和挂载）</li></ul>
<blockquote>
<p>注意：“挂载点”的目录需要以下几个要求：<br/> 目录事先存在，可以用mkdir命令新建目录<br/> 挂载点目录不可被其它进程使用到<br/> 挂载点下原有文件将被隐藏</p>
</blockquote>
<ul><li><code>mount -t auto /dev/cdrom PPP</code>：将光驱和PPP文件夹挂载</li><li><code>umount PPP</code>：卸载PPP文件夹所挂载的光驱</li></ul> </li></ul>
<h4><a id="yum_580"></a>yum</h4>
<ul><li>在Linux中，如果我们需要查找、安装、下载或者卸载另外的软件，就需要通过yum来进行操作。英文全称为：Yellow dog Updater,Modified</li><li><strong>yum常用命令</strong>
<ul><li>列出所有可更新的软件清单命令：<code>yum check -update</code></li><li>更新所有软件命令：<code>yum update</code></li><li>仅安装指定的软件命令：<code>yum install &lt;package_name&gt;</code></li><li>仅更新指定的软件命令：<code>yum update &lt;package_name&gt;</code></li><li>列出所有可安装的软件清单命令：<code>yum list</code></li><li>删除软件包命令：<code>yum remove &lt;package_name&gt;</code></li><li>查找软件包命令：<code>yum search &lt;keyword&gt;</code></li><li>清除缓存命令： 
    <ul><li><code>yum clean packages</code>：清除缓存目录下的软件包</li><li><code>yum clean headers</code>：清除缓存目录下的headers</li><li><code>yum clean oldheaders</code>：清除缓存目录下旧的headers</li><li><code>yum clean,yum clean all(= yum clean packages;yum clean oldheades)</code>：清除缓存目录下的软件包及旧的headers</li></ul> </li></ul> </li><li><mark>-y</mark>：在安装过程中，如果有选择提示，全部选择<mark>y</mark></li><li><mark>注意</mark>：使用yum必须联网且在root权限下</li><li><code>yum -y install tree</code>：安装tree</li><li><code>tree</code>：执行tree，展示当前目录结构</li><li><code>yum remove tree</code>：移除tree</li><li><code>yum list tom*</code>：查找以tom为开头的软件名称</li><li><strong>yum源</strong>
<ul><li>在下载软件的时候，都是从yum源中获取的，默认是centos中默认的yum源（在国外，下载速度慢）</li><li><mark>更换国内yum源</mark>
<ul><li><code>yum -y install wget</code>：安装一个下载工具</li><li><code>cd /etc/yum.repos.d/</code>：进入yum的相关文件夹中</li><li><code>mv CentOS-Base.repo CentOS-Base.repo.back</code>：对原yum文件改名（备份）</li><li><code>wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code>：下载阿里yum源文件</li><li><code>yum clean all</code>：清理缓存，并重新加载yum</li><li><code>yum makecache</code>：为新yum源建立缓存文件</li><li><code>yum search tomcat</code>：查找软件，验证阿里云的yum源是否可以正常使用</li></ul> </li></ul> </li></ul>
<h4><a id="rpm_613"></a>rpm</h4>
<ul><li>在最初，RedHat Linux发行版专门用来管理Linux各种套件的程序</li><li>和yum的区别 
  <ul><li>rpm只能安装已经下载到本地机器上的rpm包</li><li>yum能在线下载并安装rpm包，能更新系统，且还能自动处理包与包之间的依赖问题，这个是rpm工具所不具备的</li></ul> </li></ul>
<h3><a id="shell_620"></a>shell</h3>
<h4><a id="shell_622"></a>初识shell</h4>
<blockquote>
<p>在计算机科学中，shell就是一个<mark>命令解释器</mark><br/> shell是位于操作系统和应用程序之间，是他们二者最主要的接口。<br/> shell负责把应用程序的输入命令信息解释给操作系统，将操作系统指令处理后的结果解释给应用程序</p>
</blockquote>
<p><strong>一句话，shell就是在操作系统和应用程序之间的一个命令翻译工具。</strong></p>
<p><strong>Windows和Linux中的shell</strong></p>
<ul><li>Windows系统：cmd.exe 命令提示字符</li><li>Linux系统：sh / csh / ksh / <mark>bash</mark>(默认) / …</li></ul>
<p><strong>shell的使用方式</strong></p>
<ul><li>手工方式</li></ul>
<blockquote>
<p>手工敲击键盘，直接输入命令，按Enter后。<br/> 执行命令，显示命令执行的结果<br/> <mark>重点</mark>：逐行输入命令，逐行进行确认执行</p>
</blockquote>
<ul><li>脚本方式</li></ul>
<blockquote>
<p>我们把手工执行的命令，写到一个文件中，然后运行这个文件，达到执行命令的效果。<br/> 这个文件就叫做<mark>脚本文件</mark></p>
</blockquote>
<p><strong>编写第一个shell脚本</strong></p>
<ul><li>新建一个文件后缀名为sh</li><li>编写内容<pre><code class="prism language-shell"><span class="token shebang important">#! /bin/bash</span>
<span class="token comment">#这是临时shell脚本</span>
<span class="token builtin class-name">echo</span> <span class="token string">'nihao'</span>
<span class="token builtin class-name">echo</span> <span class="token string">'hello'</span>
</code></pre> </li><li>执行</li></ul>
<h4><a id="_662"></a>注释和变量</h4>
<p><strong>注释</strong></p>
<ul><li>单行注释</li></ul>
<pre><code class="prism language-shell"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># 这是单行注释</span>
<span class="token builtin class-name">echo</span> <span class="token string">'hello world'</span>
</code></pre>
<ul><li>多行注释</li></ul>
<pre><code class="prism language-shell"><span class="token shebang important">#!/bin/bash</span>
:<span class="token operator">&lt;&lt;</span><span class="token operator">!</span> 这是多行注释
多行注释
多行注释
<span class="token operator">!</span>
<span class="token builtin class-name">echo</span> <span class="token string">'hello world'</span>
</code></pre>
<pre><code class="prism language-shell">:<span class="token operator">&lt;&lt;</span>字符
	注释内容
字符
</code></pre>
<p><strong>变量</strong></p>
<ul><li>定义变量 
  <ul><li>普通变量 
    <ul><li>方式一：<code>变量名=变量值</code>（变量值必须是一个整体，中间没有特殊字符）</li><li>方式二：<code>变量名='变量值'</code>（单引号中的内容，原样赋值）</li><li>方式三：<code>变量名="变量值"</code>（如果双引号中有其它变量，会把变量的结果进行拼接，然后赋值）</li></ul>
<blockquote>
<p>习惯：数字不加引号，其它默认加双引号</p>
</blockquote> </li><li>命令变量（将命令的结果赋值给变量） 
    <ul><li>方式一：<mark>变量名=`命令`</mark>(这里是反引号&lt;tab键上方&gt;)</li><li>方式二：<code>变量名=$(命令)</code>（常用）</li></ul> </li></ul> </li><li>使用变量 
  <ul><li>方式一：<code>$变量名</code>（非标准写法，图省事）</li><li>方式二：<code>"$变量名"</code>（非标准写法，图省事）</li><li>方式三：<code>${变量名}</code>（在双引号里面要使用变量的值）</li><li>方式四：<code>"${变量名}"</code>（标准使用方式）</li></ul> </li><li>只读变量：<code>readonly 变量名</code></li><li>删除变量：<code>unset 变量名</code></li></ul>
<h4><a id="_710"></a>数组</h4>
<table><thead><tr><th>定义数组</th><th>数组名=(值1 值2 … 值n)</th><th>arr=(1 2 3 4 5)</th></tr></thead><tbody><tr><td>给数组的元素赋值</td><td>数组名[索引]=值</td><td>arr[0]=1</td></tr><tr><td>获取元素</td><td>${数组名[下标]}</td><td>${arr[0]}</td></tr><tr><td>获取长度</td><td>${#数组名[*]}<br/>${#数组名[@]}</td><td>${#arr[*]}<br/>${#arr[@]}</td></tr></tbody></table>
<h4><a id="_718"></a>运算符</h4>
<table><thead><tr><th align="center">运算符</th><th align="center">说明</th><th align="center">举例</th></tr></thead><tbody><tr><td align="center">+</td><td align="center">加法</td><td align="center">expr $a + $b</td></tr><tr><td align="center">-</td><td align="center">减法</td><td align="center">expr $a - $b</td></tr><tr><td align="center">*</td><td align="center">乘法</td><td align="center">expr $a \* $b</td></tr><tr><td align="center">/</td><td align="center">除法</td><td align="center">expr $b / $a</td></tr><tr><td align="center">%</td><td align="center">取余</td><td align="center">expr $b % $a</td></tr><tr><td align="center">=</td><td align="center">赋值</td><td align="center">a=$b （把b变量的值赋给a变量）</td></tr><tr><td align="center">++ / –</td><td align="center">自增 / 自减</td><td align="center">((a++))</td></tr></tbody></table>
<p><strong>注意点</strong></p>
<ol><li>原生的bash不支持简单的数学运算。可以通过其它命令实现：expr</li><li>表达式和运算符之间要有空格</li><li>完整的表达式要被反引号包含</li><li>乘法中不能直接使用*，需要在乘号前加\转义</li></ol>
<p>举例：<mark>`expr 2 + 2`</mark></p>
<p><strong>字符串运算符</strong></p>
<table><thead><tr><th>运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td>=</td><td>检测两个字符串是否相等，相等返回true</td><td>[ $a = $b ]</td></tr><tr><td>!=</td><td>检测两个字符串是否不相等，不相等返回true</td><td>[ $a != $b ]</td></tr><tr><td>-z</td><td>检测字符串长度是否为0，为0返回true</td><td>[ -z $a ]</td></tr><tr><td>-n</td><td>检测字符串长度是否不为0，不为0返回true</td><td>[ -n $a ]</td></tr><tr><td>$</td><td>检测字符串是否为空，不为空返回true</td><td>[ $a ]</td></tr></tbody></table>
<blockquote>
<p><code>[]</code>与里面的代码命令有个空格隔开，不能贴在一起</p>
<p><code>$?</code>可以获取上一条语句的执行结果</p>
<p><mark>在shell中，0为真，1为假</mark></p>
<p><code>${#字符串}</code>获取字符串长度</p>
</blockquote>
<p><strong>关系运算符</strong></p>
<table><thead><tr><th align="center">运算符</th><th align="center">说明</th><th align="center">举例</th></tr></thead><tbody><tr><td align="center">-eq</td><td align="center">检测两个数是否相等，相等返回true(<mark>equals</mark>)</td><td align="center">[ $a -eq $b ]</td></tr><tr><td align="center">-ne</td><td align="center">检测两个数是否不相等，不相等返回true(<mark>not equals</mark>)</td><td align="center">[ $a -ne $b ]</td></tr><tr><td align="center">-gt</td><td align="center">检测左边的数是否大于右边的，如果是，则返回(true<mark>greater than</mark>)</td><td align="center">[ $a -gt $b ]</td></tr><tr><td align="center">-lt</td><td align="center">检测左边的数是否小于右边的，如果是，返回true(<mark>less than</mark>)</td><td align="center">[ $a -lt $b ]</td></tr><tr><td align="center">-ge</td><td align="center">检测左边的数是否大于等于右边的，如果是，则返回true(<mark>greater equals</mark>)</td><td align="center">[ $a -ge $b ]</td></tr><tr><td align="center">-le</td><td align="center">检测左边的数是否小于等于右边的，如果是，则返回true(<mark>less equals</mark>)</td><td align="center">[ $a -le $b]</td></tr></tbody></table>
<p><mark>关系运算符只支持数字，不支持字符串，除非字符串的值是数字</mark></p>
<p><strong>布尔运算符</strong></p>
<table><thead><tr><th align="center">运算符</th><th align="center">说明</th><th align="center">举例</th></tr></thead><tbody><tr><td align="center">!</td><td align="center">取反运算</td><td align="center">[ ! false ] 返回true</td></tr><tr><td align="center">-o</td><td align="center">或运算，有一个表达式为true 则返回true (<mark>or</mark>)</td><td align="center">[ $a -lt 20 -o $b -gt 100 ]</td></tr><tr><td align="center">-a</td><td align="center">与运算，两个表达式都为true 才返回true(<mark>and</mark>)</td><td align="center">[ $a -lt 20 -a $b -gt 100 ]</td></tr></tbody></table>
<p><strong>逻辑运算符</strong></p>
<table><thead><tr><th>运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>逻辑的 AND</td><td>[[ true &amp;&amp; true ]] 返回true</td></tr><tr><td>||</td><td>逻辑的 OR</td><td>[[ false || false ]] 返回false</td></tr></tbody></table>
<h4><a id="_795"></a>选择语句</h4>
<p><strong>if语法</strong></p>
<pre><code class="prism language-shell">if<span class="token punctuation">[</span> 条件 <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	语句体
<span class="token keyword">fi</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> 条件 <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	语句体
<span class="token keyword">else</span>
	语句体
<span class="token keyword">fi</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token keyword">if</span> <span class="token punctuation">[</span> 条件1 <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	语句体
<span class="token keyword">elif</span> <span class="token punctuation">[</span> 条件2 <span class="token punctuation">]</span>
	语句体
<span class="token keyword">else</span>
	语句体
<span class="token keyword">fi</span>
</code></pre>
<p><strong>小练习</strong></p>
<pre><code class="prism language-shell"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># if语句</span>

<span class="token comment">#if的第一种格式：</span>
<span class="token comment">#查找一个进程，如果进程存在，就打印true</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> -c <span class="token string">"ssh"</span><span class="token variable">)</span></span> -gt <span class="token number">1</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"true"</span>
<span class="token keyword">fi</span>
</code></pre>
<p><strong>case语法</strong></p>
<pre><code class="prism language-shell"><span class="token keyword">case</span> 值 <span class="token keyword">in</span>
模式1 <span class="token punctuation">)</span>
	语句体1
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
模式2 <span class="token punctuation">)</span>
	语句体2
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token assign-left variable">v</span><span class="token operator">=</span><span class="token string">"hhxx"</span>
<span class="token keyword">case</span> <span class="token string">"<span class="token variable">${v}</span>"</span> <span class="token keyword">in</span>
<span class="token string">"hhxx"</span><span class="token punctuation">)</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"好好学习"</span>
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token string">"ttxs"</span><span class="token punctuation">)</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"天天向上"</span>
	<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre>
<h4><a id="_865"></a>循环语句</h4>
<p><strong>for循环</strong></p>
<pre><code class="prism language-shell"><span class="token keyword">for</span> 变量 <span class="token keyword">in</span> 范围
<span class="token keyword">do</span>
	循环体
<span class="token keyword">done</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token keyword">for</span> <span class="token for-or-select variable">loop</span> <span class="token keyword">in</span> A B C
<span class="token keyword">do</span>
	<span class="token builtin class-name">echo</span> <span class="token variable">$loop</span>
<span class="token keyword">done</span>
</code></pre>
<p><strong>while循环</strong></p>
<pre><code class="prism language-shell"><span class="token keyword">while</span> 条件
<span class="token keyword">do</span>
	循环体
<span class="token keyword">done</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">${a}</span>"</span> -le <span class="token number">10</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">${a}</span>"</span>
	<span class="token variable"><span class="token punctuation">((</span>a<span class="token operator">++</span><span class="token punctuation">))</span></span>
<span class="token keyword">done</span>
</code></pre>
<h4><a id="_901"></a>函数</h4>
<p><strong>无参无返回值</strong></p>
<pre><code class="prism language-shell">函数名<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	函数体
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-shell"><span class="token function-name function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">echo</span> <span class="token string">"函数测试！"</span>
<span class="token punctuation">}</span>
<span class="token builtin class-name">echo</span> <span class="token string">"==========="</span>
<span class="token builtin class-name">test</span>
<span class="token builtin class-name">echo</span> <span class="token string">"============"</span>
</code></pre>
<p><strong>有参无返回值</strong></p>
<pre><code class="prism language-shell"><span class="token function-name function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">echo</span> <span class="token string">"第一个参数<span class="token variable">$1</span>"</span>
	<span class="token builtin class-name">echo</span> <span class="token string">"第二个参数<span class="token variable">$2</span>"</span>
<span class="token punctuation">}</span>

method a b
</code></pre>
<p><strong>有参有返回值</strong></p>
<pre><code class="prism language-shell"><span class="token function-name function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token builtin class-name">echo</span> <span class="token string">"接收到参数<span class="token variable">$1</span>和<span class="token variable">$2</span>"</span>
	<span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>$<span class="token number">1</span> <span class="token operator">+</span> $<span class="token number">2</span><span class="token variable">))</span></span>
<span class="token punctuation">}</span>

method <span class="token number">10</span> <span class="token number">20</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
</code></pre>
<p><strong>小练习</strong></p>
<blockquote>
<p><code>read 变量名</code>：表示把键盘录入的数据赋值给这个变量</p>
</blockquote>
<pre><code class="prism language-shell"><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#在方法中键盘录入两个整数，并返回这两个整数和</span>

<span class="token function-name function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token builtin class-name">echo</span> <span class="token string">"请录入第一个数："</span>
        <span class="token builtin class-name">read</span> num1
        <span class="token builtin class-name">echo</span> <span class="token string">"请录入第二个数："</span>
        <span class="token builtin class-name">read</span> num2
        <span class="token builtin class-name">echo</span> <span class="token string">"两个数分别为：<span class="token variable">${num1}</span>,<span class="token variable">${num2}</span>"</span>
        <span class="token builtin class-name">return</span> <span class="token variable"><span class="token variable">$((</span>$num1 <span class="token operator">+</span> $num2<span class="token variable">))</span></span>
<span class="token punctuation">}</span>

method
<span class="token builtin class-name">echo</span> <span class="token string">"两数之和为：<span class="token variable">$?</span>"</span>
</code></pre>
<hr/>
<h2><a id="Nginx_964"></a>Nginx</h2>
<blockquote>
<p>这部分应该是HTML + CSS + Nginx，因为HTML和CSS是之前学过的，当时并没有记笔记，这部分也相当简单些，如果有没学过的可以自行搜索资料学习一下~</p>
</blockquote>
<h4><a id="_966"></a>概述</h4>
<ul><li>Nginx是一款服务器软件</li><li>其核心功能是可以和服务器硬件相结合，从而可以将程序发布到Nginx服务器上，让更多用户浏览</li></ul>
<h4><a id="_971"></a>安装</h4>
<ol><li> <p>上传压缩包：<code>put nginx压缩包位置</code>（CRT中按alt+p键进入sftp）</p> </li><li> <p>解压压缩包：<code>tar -zxvf 压缩包名</code></p> </li><li> <p>进入解压目录：<code>cd nginx解压目录</code></p> </li><li> <p>安装依赖环境</p> <p><code>yum -y install pcre pcre-devel</code></p> <p><code>yum -y install zlib zlib-devel</code></p> <p><code>yum -y install openssl openssl-devel</code><br/> <code>yum -y install gcc</code></p> </li><li> <p>安装nginx<br/> <code>./configure</code><br/> <code>make</code><br/> <code>make install</code>(安装完会在/usr/local/下有一个nginx目录)</p> </li><li> <p>进入对应目录：<code>cd /usr/local/nginx/sbin</code></p> </li><li> <p>启动nginx服务：<code>./nginx</code><br/> 停止：<code>./nginx -s stop</code><br/> 重启：<code>./nginx -s reload</code></p> </li><li> <p>查看nginx服务状态：<code>ps -ef | grep nginx</code></p> </li><li> <p>测试nginx服务：浏览器打开对应Linux服务器ip地址</p> </li></ol>
<blockquote>
<p>最后这里在浏览器打开对应ip地址无法访问，解决方法：<br/> 第一步，对80端口进行防火墙配置：<code>firewall-cmd --zone=public --add-port=80/tcp --permanent</code><br/> 第二步，重启防火墙服务：<code>systemctl restart firewalld.service</code><br/> 然后重新在浏览器中访问你的ip，应该就可以访问了。</p>
</blockquote>
<h4><a id="_1004"></a>发布项目</h4>
<ol><li> <p>在 <mark>/home</mark> 下创建一个web目录：<code>mkdir web</code></p> </li><li> <p>将项目上传到该目录下：<code>put web项目压缩包</code></p> </li><li> <p>解压项目压缩包：<code>unzip web程序压缩包</code></p> </li><li> <p>编辑nginx配置文件：<code>vim /home/nginx-1.18.0/conf/nginx.conf</code><br/> 找到server的大括号范围，修改location的路径<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/24d17f209949415a85889033d675cfaf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p> </li><li> <p>进入对应目录：<code>cd /usr/local/nginx/sbin</code></p> </li><li> <p>关闭nginx服务：<code>./nginx -s stop</code></p> </li><li> <p>启动nginx服务并加载配置文件：<code>/usr/local/nginx/sbin/nginx -c/home/nginx-1.18.0/conf/nginx.conf</code></p> </li><li> <p>通过浏览器测试网站</p> </li></ol>
<hr/>
<h2><a id="JavaWeb_1018"></a>JavaWeb核心</h2>
<h3><a id="_1020"></a>企业开发简介</h3>
<h4><a id="JavaEE_1022"></a>JavaEE规范</h4>
<ul><li><mark>JavaEE(Java Enterprise Edition)：Java企业版</mark></li><li>它是由SUN公司领导、各个厂家共同制定并得到广泛认可的工业标准。</li><li>JavaEE早期叫做J2EE，但是没有继续采用其命名规则。J2EE的版本从1.0开始到1.4结束。而JavaEE版本是从JavaEE 5 版本开始，目前最新的版本是JavaEE 8。</li><li>JavaEE规范是很多Java开发技术的总称。这些技术规范都是沿用自J2EE的。一共包括了13个技术规范。</li><li>包括：JDBC, JNDI, EJB, RMI, IDL/CORBA, JSP, Servlet, XML, JMS, JTA, JTS, JavaMail, JAF。</li></ul>
<h4><a id="WEB_1030"></a>WEB概述</h4>
<p><strong>概述</strong></p>
<ul><li>WEB在计算机领域中代表的是<mark>网络</mark>。</li><li>像我们之前所用的WWW，它是World Wide Web 三个单词的缩写，称为：<mark>万维网</mark></li><li>网络相关技术的出现是为了让我们在网络的世界中<mark>获取资源</mark>，这些资源的存放之处，我们把它叫做<mark>网站</mark>。</li><li>我们通过输入网站的地址（网址），就可以访问网站中提供的资源（不区分局域网或广域网）</li></ul>
<p><strong>资源分类</strong></p>
<ul><li>静态资源<br/> 网站中提供给人们展示的资源是一成不变的，也就是说不同人或者在不同时间，看到的内容都是一样的。<br/> 作为开发者来说，我们编写的HTML, CSS, JavaScript 都属于静态资源。</li><li>动态资源<br/> 网站中提供给人们展示的资源是由程序产生的，在不同的时间或者不同的人由于身份的不同，所看到的内容是不一样的。<br/> 作为网站开发者来说，我们编写的JSP、Servlet等都属于动态资源。</li></ul>
<h4><a id="_1050"></a>系统结构</h4>
<blockquote>
<p>在之前的学习中，开发的都是Java工程。这些工程在企业中称之为项目或者产品。都是有系统架构的！</p>
</blockquote>
<ul><li>基础结构划分 
  <ul><li>CS结构：（Client Server）<mark>客户端+服务器</mark>的方式（把不同的应用直接安装在客户端上）</li><li>BS结构：（Browser Server）<mark>浏览器+服务器</mark>的方式</li></ul> </li><li>技术选型划分 
  <ul><li>Model1模型</li><li>Model2模型</li><li>MVC模型</li><li>三层架构 + MVC模型</li></ul> </li><li>部署方式划分 
  <ul><li>一体化结构</li><li>垂直拆分结构</li><li>分布式结构</li><li>微服务结构</li></ul> </li></ul>
<h3><a id="tomcat_1068"></a>tomcat</h3>
<h4><a id="_1070"></a>服务器</h4>
<ul><li>服务器是计算机的一种，它比普通计算机运行更快、负载更高、价格更贵。==服务器在网络中为其它客户机（如PC机、智能设备等）提供计算或者应用服务。==服务器具有高速的CPU运算能力、长时间的可靠运行、强大的I/O外部数据吞吐能力以及更好的扩展性。</li><li>而我们这里所说的服务器，其实是web服务器，或者应用服务器。它本质就是一个软件，通过和硬件相结合，从而达到帮助我们来发布应用的功能，让用户通过客户机访问我们的应用。</li><li>常用的应用服务器 
  <table><thead><tr><th>服务器名称</th><th>说明</th></tr></thead><tbody><tr><td>weblogic</td><td>实现了JavaEE规范，重量级服务器，又称为JavaEE容器</td></tr><tr><td>websphereAS</td><td>实现了JavaEE规范，重量级服务器</td></tr><tr><td>JBOSSAS</td><td>实现了JavaEE规范，重量级服务器，免费的</td></tr><tr><td>Tomcat</td><td>实现了jsp/servlet规范，是一个轻量级服务器，开源免费</td></tr></tbody></table> </li></ul>
<h4><a id="Tomcat_1082"></a>Tomcat</h4>
<ul><li>Tomcat是Apache软件基金会的Jakarta项目组中的一个核心项目，由Apache、Sun和其它一些公司及个人共同开发而成。由于有了Sun公司的参与和支持，最新的Servlet、JSP规范总能在Tomcat中得到体现。因为Tomcat技术先进、性能稳定，而且免费，所以深受Java爱好者的喜爱并得到了部分软件开发商的认可，成为目前比较流行的Web应用服务器。</li><li>Tomcat官网：<a href="https://tomcat.apache.org/">https://tomcat.apache.org/</a></li><li>Tomcat各个版本所需要的支持<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/72042aa7324c49529838d4ed6ba32c74.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></li></ul>
<p><strong>下载和安装</strong></p>
<ul><li>下载：官网下载</li><li>安装：直接解压即可</li><li>目录组成 
  <ul><li><mark>bin</mark>：一些二进制可执行文件</li><li><mark>conf</mark>：保存配置文件的路径</li><li>lib：Tomcat在运行过程中所需要的jar包</li><li>logs：日志文件</li><li>temp：临时文件</li><li><mark>webapps</mark>：项目发布目录（一个文件夹代表一个web应用）（ROOT代表根项目）</li><li>work：工作目录</li></ul> </li></ul>
<h4><a id="_1103"></a>基本使用</h4>
<ol><li> <p>启动<br/> <code>startup.bat</code>：Windows下启动执行文件<br/> <code>startup.sh</code>：Linux下启动执行文件</p>
<blockquote>
<p>启动后浏览器访问:http://localhost:8080可以进入欢迎界面（Tomcat默认端口为8080）</p>
</blockquote> </li><li> <p>停止<br/> <code>shutdown.bat</code>：Windows下关闭执行文件<br/> <code>shutdown.sh</code>：Linux下关闭执行文件</p> </li><li> <p>部署项目<br/> 在webapps目录下创建一个文件夹<br/> 将资源放到该文件夹中<br/> 启动tomcat，输入正确路径</p> </li></ol>
<p><strong>常见问题</strong></p>
<ol><li> <p>启动问题<br/> 启动窗口一闪而过：没有配置jdk环境变量<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5bc11599345e47409cabcc40ca9c3313.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p> <p>java.net.BindException：端口8080被占用</p> </li><li> <p>控制台乱码问题解决<br/> conf-logging.properties<br/> 修改<code>java.util.logging.ConsoleHandler.encoding = UTF-8</code></p>
<blockquote>
<p>Tomcat默认UTF-8，CMD命令窗口默认GBK，将UTF-8改为GBK即可解决乱码问题</p>
</blockquote> </li></ol>
<p><strong>IDEA集成Tomcat</strong></p>
<ol><li>点击Run -》 Edit Configurations</li><li>点击Defaults -》 Tomcat Servlet -》 Local</li><li>点击Configure -》Tomcat Home -》 选择tomcat所在路径</li></ol>
<p><strong>Linux下的安装</strong></p>
<ol><li>上传压缩包到/home路径：<code>put d:/apache-tomcat-9.0.58.tar.gz</code></li><li>解压压缩包：<code>tar -zxvf 压缩包名</code></li><li>进入bin目录下：<code>cd apache-tomcat-9.0.58/bin</code></li><li>启动tomcat服务：<code>./startup.sh</code></li><li>使用浏览器测试：浏览器打开对应Linux服务器ip地址:8080</li></ol>
<h4><a id="Java_WEB_1148"></a>Java WEB项目</h4>
<ol><li>新建项目模型，选择Java Enterprise<br/> 确定JDK版本、Appalication Server版本</li><li>右键Add Framework Support…</li><li>勾选Web Appalication选项</li></ol>
<p><strong>项目组成详解</strong></p>
<ul><li>src：存放Java源代码</li><li>web：存放项目相关资源（html、css、js、jsp、图片等）</li><li>WEB-INFO：存放相关配置的（web.xml等）</li></ul>
<p><strong>IDEA发布项目</strong></p>
<ol><li>点击Run -》 Edit Configurations</li><li>点击Tomcat Server -》 Deployment<br/> Application Context是项目访问路径，/代表默认路径，多个项目中只能有一个默认路径</li><li>点击Tomcat Server -》 Server<br/> 设置关联浏览器<br/> 两个Update resources设置<br/> 设置JDK、端口号</li><li>启动Tomcat服务</li><li>验证结果（浏览器）</li></ol>
<p><strong>通过war包发布项目</strong></p>
<ol><li>在项目的web路径下打war包：<code>jar -cvf myweb.war .</code></li><li>将打好的war包剪切到tomcat的webapps路径下</li><li>启动tomcat服务，自动解压war包</li><li>验证结果</li></ol>
<h4><a id="_1180"></a>配置文件</h4>
<p><strong>配置默认端口号</strong></p>
<p>主配置文件<mark>server.xml</mark></p>
<blockquote>
<p><code>&lt;Connector&gt;</code>标签中，port属性代表Tomcat默认端口号(8080)</p>
</blockquote>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/8c37cee6ed614bedbe0808a1b2a375b1.png"/></p>
<blockquote>
<p>http协议默认端口号为80，Tomcat默认端口号与其不一致，所以每次访问网站需要加上端口号<br/> 如果是80端口，就不需要加端口号<br/> 真正发布网站的时候，都需要将tomcat默认端口号改为80，这样在访问网站的时候就不需要加端口号了</p>
</blockquote>
<p><strong>配置虚拟目录</strong></p>
<ul><li>作用：可以发布任意目录下的项目</li></ul>
<ol><li> <p>编辑<mark>server.xml</mark> 配置文件，找到<code>&lt;Host&gt;</code>标签</p> </li><li> <p>加入以下内容<br/> <code>&lt;Context path="/mytest" docBase="e:/test" /&gt;</code><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/5730d0cfccfd4dcfbd1e529f7268d1c3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<blockquote>
<p><code>path</code>：访问资源的虚拟目录名称（表示在浏览器地址栏中的访问路径）<br/> <code>docBase</code>表示需要发布的项目的真实路径</p>
</blockquote> </li></ol>
<p><strong>配置虚拟主机</strong></p>
<ul><li>作用：可以指定访问路径的名称</li></ul>
<ol><li>编辑<mark>server.xml</mark> 配置文件，找到<code>&lt;Engine&gt;</code>标签</li><li>加入以下内容<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/57b3ab3d0e6f4cedb49d3f4a2165a50f.png#pic_center"/></li></ol>
<blockquote>
<p><code>name</code>：虚拟主机名称<br/> <code>appBase</code>：项目所保存的根路径<br/> <code>unpackWARs</code>：是否自动解压war包<br/> <code>autoDeploy</code>：是否自动发布<br/> <code>Context</code>：同虚拟目录</p>
</blockquote>
<ol start="3"><li>修改hosts文件<br/> 绑定IP地址和对应的域名<br/> 文件路径：<code>c:\Windows\System32\drivers\etc</code><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/74077ce4e40f4b959afed977cbf4b332.png#pic_center"/></li></ol>
<h3><a id="HTTP_1228"></a>HTTP协议</h3>
<h4><a id="_1230"></a>概述</h4>
<ul><li>HTTP(Hyper Text Transfer Protocol)：<mark>超文本传输协议</mark></li><li>HTTP协议是基于 TCP/IP 协议的（安全）</li><li>超文本：比普通文本更加强大（还有图片、音频等等）</li><li>传输协议：客户端和服务端的通信规则（握手规则）</li></ul>
<p><strong>组成部分</strong></p>
<ul><li>请求：客户端发起请求到服务器</li><li>响应：服务器收到客户端的请求后发起响应给客户端</li></ul>
<blockquote>
<p>除了手动发起的请求外，JavaScript、CSS、图片等资源会自动发起请求</p>
</blockquote>
<h4><a id="_1244"></a>协议的请求</h4>
<p><strong>请求的组成部分</strong></p>
<ol><li> <p>请求行：请求方式 提交路径(提交参数) HTTP/版本号</p> </li><li> <p>请求头</p>
<table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>Accept</td><td>客户端浏览器所支持的MIME类型</td></tr><tr><td>Accept-Encoding</td><td>客户端浏览器所支持的压缩编码格式。最常用的就是gzip压缩</td></tr><tr><td>Accept-Language</td><td>客户端浏览器所支持的语言。一般都是zh_CN或en_US等</td></tr><tr><td>Referer</td><td>告知服务器，当前请求的来源</td></tr><tr><td>Content-Type</td><td>请求正文所支持的MIME类型</td></tr><tr><td>Content-Length</td><td>请求正文的长度</td></tr><tr><td>User-Agent</td><td>浏览器相关信息</td></tr><tr><td>Connection</td><td>连接的状态。Keep-Alive保持连接</td></tr><tr><td>If-Modified-Since</td><td>客户端浏览器缓存文件的最后修改时间</td></tr><tr><td>Cookie</td><td>会话管理相关，非常的重要</td></tr></tbody></table></li><li> <p>请求空行：普通换行，用于区分请求头和请求体</p> </li><li> <p>请求体：只有POST提交方式才有请求体，用于显示提交参数</p> </li></ol>
<p><strong>请求的方式</strong></p>
<p><mark>GET</mark><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/be211d169a644f59ad98739fe2b3a413.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p><mark>POST</mark><br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/99bf353f22f14c42b9ff530c6fbfec21.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<blockquote>
<p>只有POST请求方式存在请求体，GET请求方式没有请求体<br/> get提交的参数在请求行中，post提交的参数在请求体中</p>
</blockquote>
<h4><a id="_1282"></a>协议的响应</h4>
<p><strong>响应的组成部分</strong></p>
<ol><li> <p>响应行：请求方式 HTTP/版本号 状态码 状态描述<br/> <mark>常见状态码</mark></p>
<table><thead><tr><th>状态码</th><th>说明</th></tr></thead><tbody><tr><td>200</td><td>一切OK</td></tr><tr><td>302/307</td><td>请求重定向，两次请求，地址栏发生变化</td></tr><tr><td>304</td><td>请求资源未发生变化，使用缓存</td></tr><tr><td>404</td><td>请求资源未找到</td></tr><tr><td>500</td><td>服务器错误</td></tr></tbody></table></li><li> <p>响应头</p>
<table><thead><tr><th>名称</th><th>说明</th></tr></thead><tbody><tr><td>Location</td><td>请求重定向的地址，常与302，307配合使用</td></tr><tr><td>Server</td><td>服务器相关信息</td></tr><tr><td>Content-Type</td><td>响应正文的MIME类型</td></tr><tr><td>Content-Length</td><td>响应正文的长度</td></tr><tr><td>Content-Disposition</td><td>告知客户端浏览器，以下载的方式打开响应正文</td></tr><tr><td>Refresh</td><td>定时刷新</td></tr><tr><td>Last-Modified</td><td>服务器资源的最后修改时间</td></tr><tr><td>Set-Cookie</td><td>会话管理相关，非常的重要</td></tr><tr><td>Expires:-1</td><td>服务器资源到客户端浏览器后的缓存时间</td></tr><tr><td>Catch-Control:no-catch</td><td>不要缓存</td></tr></tbody></table></li><li> <p>响应空行：普通换行，用于区分响应头和响应体</p> </li><li> <p>响应体：将资源文件发送给客户端浏览器进行解析</p> </li></ol>
<h3><a id="_1316"></a>发布资源案例</h3>
<p><strong>发布静态资源</strong></p>
<ol><li> <p>创建一个Java WEB项目</p> </li><li> <p>将静态页面所需资源导入到项目的web目录下</p> </li><li> <p>修改web.xml配置文件，修改默认主页</p> <pre><code class="prism language-xml"><span class="token comment">&lt;!--在web.xml中加入--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file-list</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file</span><span class="token punctuation">&gt;</span></span>/路径/文件名.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file-list</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>将项目部署到tomcat中</p> </li><li> <p>启动tomcat服务</p> </li><li> <p>打开浏览器查看页面</p> </li></ol>
<h4><a id="Servlet_1339"></a>Servlet介绍</h4>
<ul><li>Servlet是运行在Java服务器端的程序，用于接收和响应来自客户端基于HTTP协议的请求。</li><li>如果想实现Servlet的功能，可以通过实现<mark>javax.servlet.Servlet</mark>接口或者继承它的实现类。</li><li>核心方法：service()，任何客户端的请求都会经过该方法。</li></ul>
<p><strong>发布动态资源</strong></p>
<ol><li> <p>创建一个JavaWEB项目</p> </li><li> <p>将静态页面所需资源导入到项目的web目录下</p> </li><li> <p>修改web.xml配置文件，修改默认主页</p> </li><li> <p>在项目的src路径下编写一个类，实现Servlet接口</p> </li><li> <p>重写service方法，输出一句话即可</p> </li><li> <p>修改web.xml配置文件，配置servlet相关资源</p> <pre><code class="prism language-xml"><span class="token comment">&lt;!--Servlet声明--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>自定义名称<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>java全类名（包名.类名）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--Servlet映射--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>和声明中的名称保持一致<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/访问路径(浏览器地址栏要输入的访问路径)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>将项目部署到tomcat中</p> </li><li> <p>启动tomcat服务</p> </li><li> <p>打开浏览器测试功能</p> </li></ol>
<p><strong>执行流程</strong></p>
<ol><li>通过浏览器访问到指定的资源路径</li><li>通过url-pattern找到对应的name标签</li><li>通过name找到对应的Servlet声明</li><li>在声明中找到对应的Java实现类</li><li>执行service方法</li></ol>
<h3><a id="Servlet_1387"></a>Servlet</h3>
<h4><a id="_1389"></a>概述</h4>
<ul><li>Servlet是运行在Java服务器端的程序，用于接收和响应来自客户端基于HTTP协议的请求</li><li>是一个接口(javax.servlet.Servlet)，常用实现类：GenericServlet、HttpServlet(继承自GenericServlet)</li><li>所有的客户端请求都会经过service方法进行处理</li><li>初始化会调用init方法，销毁时会调用destroy方法</li></ul>
<h4><a id="_1396"></a>执行过程</h4>
<ol><li>客户端浏览器向Tomcat服务器发起请求</li><li>Tomcat服务器解析请求地址(URL)</li><li>Tomcat根据地址找到对应的项目</li><li>找到项目中的web.xml文件</li><li>解析请求资源地址(URI)</li><li>找到项目的资源(对应的Java类)</li><li>执行service方法，响应给客户端浏览器</li></ol>
<p><strong>关系视图</strong></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/0a33e42273f64b7e8f5231df68f1e151.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_18,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="_1411"></a>实现方式</h4>
<ol><li>实现<mark>Servlet</mark>接口，实现所有的抽象方法，该方式支持最大程度的自定义</li><li>继承<mark>GenericServlet</mark>抽象类，必须重写<mark>service</mark>方法，其他方法可选择重写。该方式让我们开发servlet变得简单。但是这种方式与HTTP协议无关</li><li>继承<mark>HttpServlet</mark>抽象类，需要重写<mark>doGet</mark>和<mark>doPost</mark>方法。该方式表示请求和响应都需要和HTTP协议相关</li></ol>
<h4><a id="_1417"></a>生命周期</h4>
<ul><li>对象的生命周期，就是对象从出生到死亡的过程。即：出生 =》活着 =》死亡。官方说法是对象创建到销毁的过程</li><li>出生：请求第一次到达Servlet时，对象就创建出来，并且初始化成功。只出生一次，将对象放到内存中</li><li>活着：服务器提供服务的整个过程中，该对象一直存在，每次都是执行service方法</li><li>死亡：当服务器停止时，或者服务器宕机时，对象死亡</li></ul>
<blockquote>
<p>出生对应的是<code>init</code>方法<br/> 活着对应的是<code>service</code>方法(<code>doGet</code>和<code>doPost</code>方法)<br/> 死亡对应的是<code>destroy</code>方法</p>
</blockquote>
<p><strong>结论：</strong> Servlet对象只会创建一次，销毁一次。所以Servlet对象只有一个实例。如果一个对象实例在应用中是唯一的存在，那么就称他为单例模式</p>
<h4><a id="_1430"></a>线程安全问题</h4>
<ul><li>由于Servlet采用的是单例设计模式，也就是整个应用中只有一个实例对象。所以我们需要分析这个唯一的实例对象中的类成员是否线程安全</li><li>模拟用户登录功能来查看Servlet线程是否安全</li></ul>
<p><strong>结论：</strong> 一个浏览器代表一个线程，多个浏览器代表多个线程。按理说应该是每个浏览器查看的都是自己的信息。但结果浏览器中数据混乱。因此，我们可以认为<mark>Servlet是线程不安全的！</mark></p>
<p><strong>解决：</strong> 定义类成员要谨慎。如果是共用的，并且只会在初始化时赋值，其它时间都是获取的话，那么是没问题的。如果不是共用的，或者每次使用都有可能对其赋值，那就要考虑线程安全的问题了，可以将其定义到doGet或doPost方法内或者使用同步功能即可</p>
<h4><a id="_1439"></a>映射方式</h4>
<ol><li> <p>具体名称的方式。访问的资源路径必须和映射配置完全相同 <mark>【常用】</mark></p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>study.servlet.Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p><code>/</code> 开头 + 通配符的方式。只要符合目录结构即可，不用考虑结尾是什么</p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>study.servlet.Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/Demo2/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>通配符 + 固定格式结尾的方式。只要符合固定结尾格式即可，不用考虑前面的路径</p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>study.servlet.Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>Demo2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>*.test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ol>
<p><strong>注意：</strong> 优先级问题。越是具体的优先级越高，越是模糊的 优先级越低。<mark>第一种 &gt; 第二种 &gt; 第三种</mark></p>
<p><strong>多路径映射</strong></p>
<ul><li>我们可以给一个Servlet配置多个访问映射，从而根据不同的请求路径来实现不同的功能</li><li>场景分析<br/> 如果访问的资源路径是/vip，商品价格打9折<br/> 如果访问的资源路径是/vvip，商品价格打5折<br/> 如果访问的资源路径是其它，商品价格不打折</li><li>采用第二种映射方式实现多路径映射(<code>/</code> + 通配符)</li></ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo3</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取浏览器路径</span>
        <span class="token class-name">String</span> requestURI <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 分隔路径</span>
        <span class="token class-name">String</span> path <span class="token operator">=</span> requestURI<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>requestURI<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 路径判断，区分价格</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"/vip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"100元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"/vvip"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"200元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"300元"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_1525"></a>创建时机</h4>
<ol><li>第一次访问时创建 
  <ul><li>优势：减少对服务器内存的浪费。提高了服务器启动的效率</li><li>弊端：如果有一些要在应用加载时就做的初始化操作无法完成</li></ul> </li><li>服务器加载时创建 
  <ul><li>优势：提前创建好对象，提高了首次执行的效率。可以完成一些应用加载时要完成的初始化操作</li><li>弊端：对服务器内存占用较多，影响了服务器启动的效率</li></ul> </li><li>修改Servlet创建时机。在<code>&lt;servlet&gt;</code>标签中，添加<code>&lt;load-on-startup&gt;</code>标签<br/> <code>&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</code><br/> <mark>正整数代表服务器加载时创建，值越小，优先级越高。负整数或不写代表第一次访问时创建</mark></li></ol>
<h4><a id="Servlet_1537"></a>默认Servlet</h4>
<ul><li>默认Servlet是由服务器提供的一个Servlet。它配置在 Tomcat 的 conf 目录中的 web.xml 中</li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2dbf1857d3704993a876ddc4870345bd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<ul><li>它的映射路径是<code>&lt;url-pattern&gt;/&lt;url-pattern&gt;</code>。我们在发送请求时，首先会在我们项目中的web.xml 中查找映射配置，找到则执行。但是当找不到对应的Servlet 路径时，就去找默认的 Servlet ，由默认Servlet 处理。所以，一切都是Servlet</li></ul>
<h3><a id="ServletConfig_1544"></a>ServletConfig</h3>
<ul><li>ServletConfig 是Servlet 的配置参数对象，在Servlet 的规范中，允许为每一个Servlet 都提供一些 初始化的配置。所以，每个Servlet 都有一个自己的ServletConfig</li><li>作用：在Servlet 的初始化时，把一些配置信息（键值对的形式）传递给Servlet</li><li>生命周期：和Servlet 相同</li></ul>
<h4><a id="_1550"></a>配置方式</h4>
<ul><li>在<code>&lt;servlet&gt;</code>标签中，通过 <code>&lt;init-param&gt;</code>标签来配置。有两个子标签 
  <ul><li><code>&lt;param-name&gt;</code>：代表初始化参数的key</li><li><code>&lt;param-value&gt;</code>：代表初始化参数的value</li></ul> </li></ul>
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>servletConfigDemo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>study.servlet.servletConfigDemo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
      
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>encoding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>desc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>This is ServletConfig<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4><a id="_1571"></a>常用方法</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>String</td><td>getInitParameter(String name)</td><td>根据参数名称获取参数的值</td></tr><tr><td>Enumeration</td><td>getInitParameterNames()</td><td>获取所有参数名称的枚举</td></tr><tr><td>String</td><td>getServletName()</td><td>获取Servlet的名称</td></tr><tr><td>ServletContext</td><td>getServletContext()</td><td>获取ServletContext对象</td></tr></tbody></table>
<p><strong>通过init方法，来对ServletConfig对象进行赋值</strong></p>
<pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token class-name">ServletConfig</span> config<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">ServletConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>枚举项遍历</strong></p>
<pre><code class="prism language-java"><span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span>keys<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token class-name">String</span> key <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> value <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">"--"</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">// ServletConfigDemo测试代码</span>
<span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletConfig</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Enumeration</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletConfigDemo</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">ServletConfig</span> config<span class="token punctuation">;</span>
    <span class="token comment">// 通过init方法对config赋值，获取ServletConfig对象</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">ServletConfig</span> config<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 根据name获取value</span>
        <span class="token class-name">String</span> encoding <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"encoding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"encoding:"</span> <span class="token operator">+</span> encoding<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取所有name并遍历</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> value <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"---"</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 获取Servlet-name</span>
        <span class="token class-name">String</span> sname <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getServletName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Servlet-name："</span> <span class="token operator">+</span> sname<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取ServletContext对象</span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>servletContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="ServletContext_1649"></a>ServletContext</h3>
<ul><li>ServletContext 是应用上下文对象（应用域对象）。每一个应用中只有一个 ServletContext 对象</li><li>作用：可以配置和获得应用的全局初始化参数，可以实现Servlet 之间的数据共享</li><li>生命周期：应用一加载则创建，应用被停止则销毁</li></ul>
<h4><a id="_1655"></a>域对象</h4>
<ul><li>域对象指的是对象有作用域，也就是作用范围。域对象可以实现数据的共享。不同作用范围的域对象，共享数据的能力也不一样</li><li>在Servlet 规范中，一共有4个域对象。ServletContext 就是其中的一个。他也是web 应用中最大的作用域，也叫 application 域。它可以实现整个应用之间的数据共享</li></ul>
<h4><a id="_1660"></a>配置方式</h4>
<ul><li>在<code>&lt;web-app&gt;</code>标签中，通过<code>&lt;context-param&gt;</code>标签来配置。有两个子标签 
  <ul><li><code>&lt;param-name&gt;</code>：代表全局初始化参数的key</li><li><code>&lt;param-value&gt;</code>：代表全局初始化参数的value</li></ul> </li></ul>
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>globalencoding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>globaldesc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>This is ServletContext<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4><a id="_1677"></a>常用方法</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>String</td><td>getInitParameter(String name)</td><td>根据名称获取全局配置的参数</td></tr><tr><td>String</td><td>getContextPath()</td><td>获取当前应用的访问虚拟目录</td></tr><tr><td>String</td><td>getRealPath(String path)</td><td>根据虚拟目录获取应用部署的磁盘绝对路径</td></tr></tbody></table>
<blockquote>
<p><code>HttpServlet</code>类继承自<code>GenericServlet</code>类<br/> <code>GenericServlet</code>类中有<code>getServletContext</code>方法，可以直接获取<code>ServletContext</code>对象</p>
</blockquote>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>setAttribute(String name, Object value)</td><td>向应用域对象中存储数据</td></tr><tr><td>Object</td><td>getAttribute(String name)</td><td>通过名称获取应用域对象中的数据</td></tr><tr><td>void</td><td>removeAttribute(String name)</td><td>通过名称移除应用域对象中的数据</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Enumeration</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletContextDemo</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span><span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getInitParameterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> names<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> value <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"===="</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> contextPath <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> realPath <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"虚拟目录为："</span> <span class="token operator">+</span> contextPath <span class="token operator">+</span> <span class="token string">"&lt;br&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"真实目录为："</span> <span class="token operator">+</span> realPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

        servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"use"</span><span class="token punctuation">,</span><span class="token string">"lisi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1734"></a>注解开发</h3>
<p><strong>Servlet3.0 规范</strong></p>
<ul><li>我们使用的是Tomcat 9版本。JavaEE规范要求是8.对应的Servlet 版本应该是4.x 版本。但是，在企业开发中，稳定要远比追求新版本重要。所以我们会降低版本使用，用的是Servlet 3.1版本。</li><li>其实我们之前的操作全部是基于 Servlet 2.5版本规范的，也就是借助于配置文件的方式。后来随着软件开发逐步的演变，基于注解的配置开始流行。而Servlet 3.0版本也就开始支持注解开发了</li><li>Servlet 3.0版本既保留了2.5版本的配置方式，同时有支持了全新的注解配置方式。它可以完全不需要 web.xml 配置文件，就能实现 Servlet 的配置，同时还有一些其他的新特性。</li></ul>
<h4><a id="_1742"></a>自动注解开发</h4>
<p><strong>实现步骤</strong></p>
<ol><li>创建一个 web 项目</li><li>定义一个类，继承HttpServlet</li><li>重写 doGet 和 doPost方法</li><li>在类上使用@WebServlet 注解并配置Servlet</li><li>部署并启动项目</li><li>通过浏览器测试</li></ol>
<pre><code class="prism language-java"><span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/servletDemo"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletDemo</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span><span class="token punctuation">{<!-- --></span>
    
<span class="token punctuation">}</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/84827924427e4ee791c564ec6f3dce48.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="_1763"></a>手动创建容器(了解)</h4>
<ul><li>Servlet 3.0 规范除了使用自动注解的配置方式外，还支持手动创建 Servlet 容器的方式。如果使用必须遵循其编写规范。在3.0 版本加入了一个新的接口：ServletContainerInitializer，需要重写onStartup方法</li></ul>
<p><strong>步骤</strong></p>
<ol><li> <p>定义一个类，继承HttpServlet</p> </li><li> <p>重写 doGet 和 doPost方法</p> </li><li> <p>定义一个类，实现ServletContainerInitializer接口</p> </li><li> <p>在src 目录下创建一个META-INF的包</p> </li><li> <p>在 META-INF 包下创建一个services 的包</p> </li><li> <p>在 services 包下创建一个 javax.servlet.ServletContainerInitializer 的文件</p> </li><li> <p>文件中的内容为容器实现类的全类名</p> </li><li> <p>在容器实现类中的 onStartup 方法中完成注册 Servlet</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onStartup</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> set<span class="token punctuation">,</span> <span class="token class-name">ServletContext</span> servletContext<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1.创建ServletDemo类的对象</span>
    <span class="token class-name">ServletDemo</span> servletDemo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2. 在ServletContext 对象中添加Servlet，并得到Servlet的动态配置对象</span>
    <span class="token class-name">ServletRegistration<span class="token punctuation">.</span>Dynamic</span> registration <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">addServlet</span><span class="token punctuation">(</span><span class="token string">"ServletDemo"</span><span class="token punctuation">,</span> servletDemo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3. 配置Servlet</span>
    registration<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">"/servletDemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 映射访问资源的路径</span>
    registration<span class="token punctuation">.</span><span class="token function">setLoadOnStartup</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 设置Servlet加载时机</span>
<span class="token punctuation">}</span>
</code></pre> </li><li> <p>部署并启动项目</p> </li><li> <p>通过浏览器测试</p> </li></ol>
<h3><a id="1_1801"></a>学生管理系统1</h3>
<ul><li>需求：添加学生信息到Java服务器中的本地文件</li></ul>
<p><strong>步骤</strong></p>
<ol><li>创建一个 web 项目</li><li>创建一个用于保存学生信息的html文件</li><li>创建一个类，继承HttpServlet</li><li>重写doGet 和 doPost 方法</li><li>在web.xml 文件中修改默认主页和配置 Servlet</li><li>在doGet 方法中接收表单数据保存到文件中，并响应给浏览器结果</li><li>部署并启动项目</li><li>通过浏览器测试</li></ol>
<blockquote>
<p>获取表单数据<br/> <code>req.getParameter(name值)</code>：就可以通过HttpServletRequest 对象中的方法 通过表单的name属性获取到对应的表单数据</p>
<p>响应数据<br/> <code>PrintWriter pw = resp.getWriter()</code>：通过 HttpServletResponse 对象中的方法获取输出流对象<br/> <code>pw.println("Save Success")</code>：将指定内容响应到浏览器中</p>
</blockquote>
<pre><code class="prism language-html"><span class="token comment">&lt;!--studentAdd.html--&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>添加学生<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/add<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        姓名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        年龄：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>age<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        成绩：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>number<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>score<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>添加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<pre><code class="prism language-xml"><span class="token comment">&lt;!--web.xml--&gt;</span>
<span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">"</span></span>
         <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>4.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--配置首页--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file-list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file</span><span class="token punctuation">&gt;</span></span>/studentAdd.html<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file-list</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--Servlet声明--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>StudentServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">&gt;</span></span>studentServlet.add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">&gt;</span></span>StudentServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">// add.java</span>
<span class="token keyword">package</span> <span class="token namespace">studentServlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">studentServlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> add <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取对应表单内容</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> age <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> score <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"score"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 封装学生对象</span>
        <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 保存到本地文件</span>
        <span class="token class-name">BufferedWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span><span class="token string">"E:\\Java\\code\\StudentServlet\\stu.txt"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>stu<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> stu<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 响应给浏览器</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"添加成功，将在3秒后跳转到首页!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Refresh"</span><span class="token punctuation">,</span><span class="token string">"3;url=/index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_1910"></a>请求对象</h3>
<p><strong>请求：</strong> 获取资源。在BS架构中，就是客户端浏览器向服务端发出询问。</p>
<p><strong>请求对象：</strong> 就是在项目中用于发送请求的对象(<code>ServletRequest</code>和<code>HttpServletRequest</code>)</p>
<blockquote>
<p>ServletRequest 和 HttpServletRequest 都是接口，但是Tomcat 服务器会帮我们处理好实现类的赋值等工作，我们不需要关心这些</p>
</blockquote>
<h4><a id="_1918"></a>获取各种路径</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>String</td><td>getContextPath()</td><td>获取虚拟目录名称</td></tr><tr><td>String</td><td>getServletPath()</td><td>获取Servlet映射路径</td></tr><tr><td>String</td><td>getRemoteAddr()</td><td>获取访问者ip地址</td></tr><tr><td>String</td><td>getQueryString()</td><td>获取请求的消息数据</td></tr><tr><td>String</td><td>getRequestURI()</td><td>获取统一资源标识符</td></tr><tr><td>StringBuffer</td><td>getRequestURL()</td><td>获取统一资源定位符</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> contextPath <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> servletPath <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getServletPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> remoteAddr <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> queryString <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> requestURI <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">StringBuffer</span> requestURL <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"contextPath= "</span> <span class="token operator">+</span> contextPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"servletPath= "</span> <span class="token operator">+</span> servletPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"remoteAddr= "</span> <span class="token operator">+</span> remoteAddr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"queryString= "</span> <span class="token operator">+</span> queryString<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"requestURI= "</span> <span class="token operator">+</span> requestURI<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"requestURL= "</span> <span class="token operator">+</span> requestURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_1967"></a>获取请求头</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>String</td><td>getHeader(String name)</td><td>根据请求头名称获取一个值</td></tr><tr><td>Enumeration</td><td>getHeaders(String name)</td><td>根据请求头名称获取多个值</td></tr><tr><td>Enumeration</td><td>getHeaderNames()</td><td>获取所有请求头名称</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Enumeration</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request2"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo2</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"host"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">"user-agent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> headers <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token string">"user-agent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>headers<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> headers<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"==============="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getHeaderNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2011"></a>获取请求参数信息</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>String</td><td>getParameter(String name)</td><td>根据名称获取数据</td></tr><tr><td>String[]</td><td>getParameterValues(String name)</td><td>根据名称获取所有数据</td></tr><tr><td>Enumeration</td><td>getParameterNames()</td><td>获取所有名称</td></tr><tr><td>Map&lt;String,String[]&gt;</td><td>getParameterMap()</td><td>获取所有参数的键值对</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Enumeration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request3"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo3</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"================"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> hobby <span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token function">getParameterValues</span><span class="token punctuation">(</span><span class="token string">"hobby"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hobby<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"==================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> parameterNames <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>parameterNames<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> parameterNames<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> value <span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token function">getParameterValues</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"==================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> parameterMap <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> key <span class="token operator">:</span> parameterMap<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value <span class="token operator">=</span> parameterMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">" === "</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>获取请求参数并封装对象</strong></p>
<ol><li>手动封装方式<br/> 成员变量名称和参数name属性值保持一致</li><li>反射封装方式<br/> 属性描述器：<code>PropertyDescriptor</code>(根据名称获取到对象中对应的get和set方法)</li><li>工具类封装方式<br/> <code>beanutils</code>工具类，<code>populate</code>方法<br/> 在发布之前，还需要进入File-Project Structure<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/d3405879d31540fdb00720c94928b0b9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span><span class="token class-name">IntrospectionException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span><span class="token class-name">PropertyDescriptor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationTargetException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   封装对象------反射方式
* */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo5</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取所有数据</span>
        <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> map <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 封装学生对象</span>
        <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 遍历集合</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> name <span class="token operator">:</span> map<span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 获取Student对象的属性描述器</span>
                <span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> stu<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 获取对应的set方法</span>
                <span class="token class-name">Method</span> writeMethod <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 执行方法</span>
                writeMethod<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>stu<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IntrospectionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InvocationTargetException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>beanutils<span class="token punctuation">.</span></span><span class="token class-name">BeanUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   封装对象------工具类方式
	需要导包：BeanUtils
* */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo6</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取所有数据</span>
        <span class="token class-name">Map</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> map <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 封装学生对象</span>
        <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">populate</span><span class="token punctuation">(</span>stu<span class="token punctuation">,</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2162"></a>流对象获取请求信息</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>BufferedReader</td><td>getReader()</td><td>获取字符输入流</td></tr><tr><td>ServletInputStream</td><td>getInputStream()</td><td>获取字节输入流</td></tr></tbody></table>
<blockquote>
<p>用IO流获取请求信息时，不支持get方式，只支持post提交方式<br/> 获得到的流对象都不是自己new出来的，不需要close释放资源，会由请求对象处理并释放</p>
</blockquote>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>beanutils<span class="token punctuation">.</span></span><span class="token class-name">BeanUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">BufferedReader</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   流对象获取数据
* */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request7"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo7</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 字符流(必须是post请求方式)</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> line<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 字节流</span>
        <span class="token class-name">ServletInputStream</span> is <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> len<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2215"></a>中文乱码问题</h4>
<ul><li>GET方式<br/> 没有乱码问题，在Tomcat 8 版本后已经解决</li><li>POST方式<br/> 有乱码问题，可以通过 setCharacterEncoding() 方法来解决（编码格式要和页面编码格式一致）</li></ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   中文乱码问题
* */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request8"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo8</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2243"></a>请求域</h4>
<ul><li>请求域(request域)：可以在一次请求范围内进行共享数据。</li><li>一般用于请求转发的多个资源中共享数据</li><li>请求对象操作共享数据方法 
  <table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>setAttribute(String name, Object value)</td><td>向请求域对象中存储数据</td></tr><tr><td>Object</td><td>getAttribute(String name)</td><td>通过名称获取请求域对象中的数据</td></tr><tr><td>void</td><td>removeAttribute(String name)</td><td>通过名称移除请求域对象中的数据</td></tr></tbody></table> </li></ul>
<h4><a id="_2254"></a>请求转发</h4>
<ul><li>请求转发：客户端的一次请求到达以后，发现需要借助其他 Servlet 来实现功能(浏览器请求，A发现做不了，转发给B去做)</li><li>特点 
  <ul><li>浏览器地址栏不变</li><li>域对象中的数据不丢失</li><li>负责转发的Servlet 转发前后的响应正文会丢失</li><li>由转发的目的地来响应客户端</li></ul> </li></ul>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>RequestDispatcher</td><td>getRequestDispatcher(String name)</td><td>获取请求调度对象</td></tr><tr><td>void</td><td>forward(ServletRequest req, ServletResponse resp)</td><td>实现转发(用请求调度对象调用)</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>request</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   请求转发
* */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request9"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo9</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 设置共享数据</span>
        req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取请求调度对象</span>
        <span class="token class-name">RequestDispatcher</span> rd <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">"/request10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 请求转发</span>
        rd<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>request</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   转发目的
* */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request10"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo10</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取共享数据</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2313"></a>请求包含</h4>
<ul><li>请求包含：可以合并其他Servlet 中的功能一起响应给客户端(浏览器请求，A只能做一半，另一半让B做)</li><li>特点 
  <ul><li>浏览器地址栏不变</li><li>域对象中的数据不丢失</li><li>被包含的 Servlet 响应头会丢失</li></ul> </li></ul>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>RequestDispatcher</td><td>getRequestDispatcher(String name)</td><td>获取请求调度对象</td></tr><tr><td>void</td><td>include(ServletRequest req, ServletResponse resp)</td><td>实现包含</td></tr></tbody></table>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>request</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   请求包含
* */</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/request11"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestDemo11</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 设置共享数据</span>
        req<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取请求调度对象</span>
        <span class="token class-name">RequestDispatcher</span> rd <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">"/request10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 请求转发</span>
        rd<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_2350"></a>响应对象</h3>
<ul><li>响应：回馈结果。在 BS 架构中，就是服务器给客户浏览器反馈结果</li><li>响应对象：就是在项目中用于发送响应的对象<br/> <code>ServletResponse</code>（接口）<br/> <code>HttpServletResponse</code>（继承自ServletResponse，基于http协议的接口） 
  <blockquote>
<p>和请求对象一样，不需要我们去写实现类，在Tomcat 服务器创建好，在执行 <code>doGet</code> 或者 <code>doPost</code> 方法时，服务器会把相应的实现类对象传递</p>
</blockquote> </li></ul>
<h4><a id="_2358"></a>常见状态码</h4>
<table><thead><tr><th>状态码</th><th>说明</th></tr></thead><tbody><tr><td>200</td><td>成功</td></tr><tr><td>302</td><td>重定向</td></tr><tr><td>304</td><td>请求资源未改变，使用缓存</td></tr><tr><td>400</td><td>请求错误，常见于请求参数错误</td></tr><tr><td>404</td><td>请求资源未找到</td></tr><tr><td>405</td><td>请求方式不支持</td></tr><tr><td>500</td><td>服务器错误</td></tr></tbody></table>
<h4><a id="_2370"></a>字节流响应消息</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>ServletOutputStream</td><td>getOutputStream()</td><td>获取响应字节输出流对象</td></tr><tr><td>void</td><td>setContentType(“text/html;charset=UTF-8”)</td><td>设置响应内容类型，解决中文乱码问题</td></tr></tbody></table>
<p><strong>步骤：</strong></p>
<ol><li>获取字节输出流对象</li><li>定义一个消息（一个字符串）</li><li>通过字节流对象输出</li></ol>
<blockquote>
<p>获取到的字节输出流对象不需要close释放，会由响应对象处理并释放</p>
</blockquote>
<pre><code class="prism language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 获取字节输出流</span>
	<span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"字节输出流响应消息"</span><span class="token punctuation">;</span>
    os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>未出现乱码问题：浏览器默认gbk编码，idea默认UTF-8编码；但是<code>getBytes</code>方法在将字符串转为字节数组时，如果不传递参数指定编码，就会根据当前系统平台默认编码进行转换，Windows系统默认编码为gbk，和浏览器一致，故未出现乱码</p>
</blockquote>
<pre><code class="prism language-java"><span class="token comment">// 统一编码格式为UTF-8并解决乱码问题</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 设置相应内容类型，并设置编码格式（告知浏览器应该采用的编码格式）</span>
	resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 获取字节输出流</span>
	<span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"字节输出流响应消息"</span><span class="token punctuation">;</span>
	os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2409"></a>字符流响应消息</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>PrintWriter</td><td>getWriter()</td><td>获取响应字符输出流对象</td></tr><tr><td>void</td><td>setContentType(“text/html;charset=UTF-8”)</td><td>设置响应内容类型，解决中文乱码问题</td></tr></tbody></table>
<blockquote>
<p>步骤和上面字节流一样，同样不需要自己close释放资源</p>
</blockquote>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 设置相应内容类型，并设置编码格式（告知浏览器应该采用的编码格式）</span>
	resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 获取字符输出流对象</span>
	<span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"字符输出流响应消息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2429"></a>响应图片</h4>
<ol><li>通过文件的相对路径获取绝对路径(getRealPath)</li><li>创建字节输入流对象，关联读取的图片路径</li><li>通过响应对象获取字节输出流对象</li><li>循环读取和写出图片</li></ol>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">String</span> realPath <span class="token operator">=</span> <span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">"/img/tx.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 创建字节输入流对象，关联图片</span>
	<span class="token class-name">BufferedInputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 获取字节输出流对象，响应图片</span>
	<span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 循环读写</span>
	<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 释放资源</span>
	is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2455"></a>设置缓存</h4>
<ul><li>缓存：对于不经常变化的数据，我们可以设置合理的缓存时间，以避免浏览器频繁请求服务器。以此来提高效率</li></ul>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>setDateHeader(String name,long time)</td><td>设置消息头添加缓存</td></tr></tbody></table>
<blockquote>
<p>例：<code>resp.setDateHeader("Expires",System.currentTimeMillis() + 1*60*60*1000);</code> 设置一个小时缓存时间<br/> Expires 就是过期的意思<br/> 时间单位为毫秒，1秒等于1000毫秒</p>
</blockquote>
<h4><a id="_2467"></a>定时刷新</h4>
<ul><li>定时刷新：过了指定时间后，页面自动进行跳转</li></ul>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>setHeader(String name,String value)</td><td>设置消息头定时刷新</td></tr></tbody></table>
<blockquote>
<p>例：<code>resp.setHeader("Refresh","3;URL=要跳转的路径")</code><br/> 单位为秒</p>
</blockquote>
<h4><a id="_2478"></a>请求重定向</h4>
<ul><li>请求重定向：客户端的一次请求到达后，发现需要借助其他Servlet 来实现功能</li><li>特点：浏览器地址栏会发生改变，两次请求，请求域对象中不能共享数据，可以重定向到其他服务器</li><li>重定向实现原理 
  <ol><li>设置响应状态码为302：<code>resp.setStatus(302);</code></li><li>设置响应的资源路径(响应到哪里去，通过响应消息头 location 来指定)：<code>resp.setHeader("location","/response/responseDemo")</code></li></ol> </li><li>响应对象重定向方法 
  <table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>sendRedirect(String name)</td><td>设置重定向</td></tr></tbody></table> </li></ul>
<h4><a id="_2490"></a>文件下载</h4>
<ol><li>创建字节输入流，关联读取的文件</li><li>设置响应消息头支持的类型：<code>resp.setHeader("Content-Type","application/octet-stream")</code><br/> Content-Type：消息头名称，代表所支持的类型<br/> application/octet-stream：消息头参数，代表应用的类型为字节流</li><li>设置响应消息头以下载方式打开资源：<code>resp.setHeader("Content-Disposition","attachment;filename=下载的文件名称")</code><br/> Content-Disposition：消息头名称，代表处理形式<br/> attachment;filename=xxx：消息头参数，代表附件的形式进行处理，filename代表指定下载文件的名称</li><li>通过响应对象获取字节输出流对象</li><li>循环读写</li><li>释放资源</li></ol>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 创建字节输入流，关联读取的文件</span>
	<span class="token class-name">String</span> realPath <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">"/img/tx.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">BufferedInputStream</span> bis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>realPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 设置响应消息头支持的类型</span>
	resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 设置响应消息头以下载方式打开资源</span>
	resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Disposition"</span><span class="token punctuation">,</span><span class="token string">"attachment;filename=file.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 通过响应对象获取字节输出流对象</span>
	<span class="token class-name">ServletOutputStream</span> os <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> len<span class="token punctuation">;</span>
	<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> bis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 释放资源</span>
	bis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="2_2525"></a>学生管理系统2</h3>
<ul><li>资源准备 
  <ol><li>创建一个 web 项目</li><li>在web 目录下创建一个 index.html，包含两个超链接标签（添加学生、查看学生）</li><li>在 web目录下创建一个 addStudent.html，用于实现添加功能的表单页面</li><li>在 src 下创建一个 Student 类，用于封装学生信息</li></ol> </li></ul>
<pre><code class="prism language-java"><span class="token comment">// list.java</span>
<span class="token keyword">package</span> <span class="token namespace">studentServlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">studentServlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/list"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> list <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">"E:\\Java\\code\\StudentServlet\\stu.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Student</span> student <span class="token operator">:</span> list<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>student<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> student<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> student<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;br&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-html"><span class="token comment">&lt;!--index.html--&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>学生信息管理系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>学生信息管理系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/studentAdd.html<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>添加学生信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>查看学生信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3><a id="Cookie_2593"></a>Cookie</h3>
<h4><a id="_2595"></a>会话</h4>
<ul><li>会话：浏览器和服务器之间的多次请求和响应</li><li>为了实现一些功能，浏览器和服务器之间可能会产生多次的请求和响应，从浏览器访问服务器开始，到访问服务器结束（关闭浏览器、到了过期时间）。这期间产生的多次请求和响应加在一起就称之为浏览器和服务器之间的一次会话</li><li>会话过程所产生的一些数据，可以通过会话技术(Cookie 和 Session)保存。</li></ul>
<h4><a id="_2601"></a>概述</h4>
<ul><li><strong>Cookie：</strong> 客户端会话管理技术<br/> 把要共享的数据保存到客户端<br/> 每次请求时，把会话信息带到服务器端，从而实现多次请求的数据共享</li><li>作用：可以保存客户端访问网站的相关内容，从而保证每次访问时先从本地缓存中获取，以此提高效率</li><li>特点： 
  <ul><li>是一个普通的Java类</li><li>两个必须属性：name 和value</li><li>发送：<code>HttpServletResponse.addCookie(Cookie对象)</code></li><li>每个网站最多20个Cookie，浏览器存储的Cookie总数不大于300个，每个Cookie大小限制在4kb</li><li>获取所有Cookie对象：<code>HttpServletRequest.getCookie()</code></li></ul> </li></ul>
<h4><a id="Cookie_2614"></a>Cookie属性</h4>
<table><thead><tr><th>属性名</th><th>作用</th><th>是否重要</th></tr></thead><tbody><tr><td>name</td><td>Cookie的名称</td><td>必须属性</td></tr><tr><td>value</td><td>Cookie的值(不支持中文)</td><td>必须属性</td></tr><tr><td>path</td><td>Cookie的路径</td><td>重要</td></tr><tr><td>domain</td><td>Cookie的域名</td><td>重要</td></tr><tr><td>maxAge</td><td>Cookie的存活时间(s)</td><td>重要</td></tr><tr><td>version</td><td>Cookie的版本号</td><td>不重要</td></tr><tr><td>comment</td><td>Cookie的描述</td><td>不重要</td></tr></tbody></table>
<h4><a id="_2626"></a>方法</h4>
<table><thead><tr><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>Cookie(String name, String value)</td><td>构造方法创建对象</td></tr><tr><td>属性对应的set和get方法</td><td>赋值和获取值(name有final修饰，无set方法)</td></tr></tbody></table>
<ul><li>向客户端添加Cookie：<code>void HttpServletResponse.addCookie(Cookie cookie)</code></li><li>获取所有的Cookie：<code>Cookie[] HttpServletRequest.getCookies()</code></li></ul>
<h4><a id="_2636"></a>练习</h4>
<ul><li>需求说明：通过Cookie记录最后访问时间，并在浏览器上显示出来</li><li>最终目的：掌握Cookie的基本使用，从创建到添加客户端，再到从服务器端获取</li><li>实现步骤 
  <ol><li>通过响应对象写出一个提示信息</li><li>创建Cookie对象，指定name和value</li><li>设置Cookie最大存活时间</li><li>通过响应对象将Cookie对象添加到客户端</li><li>通过请求对象获取Cookie对象</li><li>将Cookie对象中的访问时间写出</li></ol> </li></ul>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 通过响应对象写出一个提示信息</span>
	resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"您的最后访问时间为："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;br&gt;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 创建Cookie对象，指定name和value</span>
	<span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 设置Cookie最大存活时间</span>
	cookie<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 通过响应对象将Cookie对象添加到客户端</span>
	resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 通过请求对象获取Cookie对象</span>
	<span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 将Cookie对象中的访问时间写出</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Cookie</span> ck <span class="token operator">:</span> cookies<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>ck<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token class-name">String</span> value <span class="token operator">=</span> ck<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 格式化时间</span>
			<span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd HH:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> lastTime <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>lastTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2677"></a>注意事项</h4>
<ul><li><mark>数量限制</mark><br/> 每个网站最多只能用20个Cookie，且大小不能超过4kb，所有网站的Cookie总数不超过300个</li><li><mark>名称限制</mark><br/> Cookie的名称只能包含ASCII码表中的字母、数字字符。不能包含逗号、分号、空格，不能以$开头。<br/> Cookie的值不支持中文</li><li><mark>存活时间限制</mark>：<code>setMaxAge()</code>方法接收数字<br/> 负整数：当前会话有效，浏览器关闭则清除（默认）<br/> 0：立即清除<br/> 正整数：以秒为单位设置存活时间</li><li><mark>访问路径限制</mark><br/> 取自第一次访问的资源路径前缀<br/> 只要以这个前缀开头（包括子级路径）就能获取到，反之获取不到<br/> 设置路径：<code>setPath()</code>方法设置指定路径</li></ul>
<h3><a id="Session_2693"></a>Session</h3>
<ul><li>HttpSession：服务器端会话管理技术<br/> 本质也是采用客户端会话管理技术 
  <blockquote>
<p>只不过在客户端保存的是一个特殊标识，而共享的数据保存到了服务器端的内存对象中。<br/> 每次请求时，会将特殊标识带到服务器端，根据这个标识来找到对应的内存空间，从而实现数据共享<br/> <mark>是Servlet规范中四大域对象之一的会话域对象</mark></p>
</blockquote> </li><li>作用：可以实现数据共享 
  <table><thead><tr><th>域对象</th><th>功能</th><th>作用</th></tr></thead><tbody><tr><td>ServletContext</td><td>应用域</td><td>在整个应用之间实现数据共享</td></tr><tr><td>ServletRequest</td><td>请求域</td><td>在当前的请求或请求转发之间实现数据共享</td></tr><tr><td>HttpSession</td><td>会话域</td><td>在当前会话范围之间实现数据共享</td></tr></tbody></table> </li></ul>
<h4><a id="_2707"></a>常用方法</h4>
<table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>setAttribute(String name, Object value)</td><td>设置共享数据</td></tr><tr><td>Object</td><td>getAttribute(String name)</td><td>获取共享数据</td></tr><tr><td>void</td><td>removeAttribute(String name)</td><td>移除共享数据</td></tr><tr><td>String</td><td>getId()</td><td>获取唯一标识名称</td></tr><tr><td>void</td><td>Invalidate()</td><td>让session立即失效</td></tr></tbody></table>
<h4><a id="_2717"></a>对象获取</h4>
<ul><li>HttpSession 是一个接口，对应的实现类对象是通过HttpServletRequest 对象来获取 
  <table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>HttpSession</td><td>getSession()</td><td>获取HttpSession对象</td></tr><tr><td>HttpSession</td><td>getSession(boolean create)</td><td>获取HttpSession对象，未获取到是否自动创建（默认true）</td></tr></tbody></table> </li></ul>
<h4><a id="_2725"></a>练习</h4>
<ul><li>需求说明：通过第一个Servlet 设置共享数据用户名，并在第二个Servlet 获取到</li><li>最终目的：掌握HttpSession 的基本使用，如何获取和使用</li><li>实现步骤 
  <ol><li>在第一个 Servlet 中获取请求的用户名</li><li>获取 HttpSession 对象</li><li>将用户名设置到共享数据中</li><li>在第二个 Servlet 中获取 HttpSession 对象</li><li>获取共享数据用户名</li><li>将获取到的用户名响应给客户端浏览器</li></ol> </li></ul>
<pre><code class="prism language-java"><span class="token comment">// Session01</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 在第一个 Servlet 中获取请求的用户名</span>
	<span class="token class-name">String</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 获取 HttpSession 对象</span>
	<span class="token class-name">HttpSession</span> session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 将用户名设置到共享数据中</span>
	session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">// session02</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 在第二个 Servlet 中获取 HttpSession 对象</span>
	<span class="token class-name">HttpSession</span> session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 获取共享数据用户名</span>
	<span class="token class-name">Object</span> username <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 将获取到的用户名响应给客户端浏览器</span>
	<span class="token class-name">PrintWriter</span> pw <span class="token operator">=</span> resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	pw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>username<span class="token operator">+</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_2764"></a>注意事项</h4>
<ul><li>唯一标识的查看：借助浏览器开发者工具</li><li>浏览器禁用Cookie<br/> 方式一：通过提示信息告知用户，大部分网站采用的解决方式【推荐】<br/> 方式二：通过<code>resp.enconeURL</code>方法实现url重写（地址栏拼接jsessionid）【了解】</li><li>钝化和活化 
  <ul><li>钝化：序列化。把长时间不用，但还不到过期时间的HttpSession进行序列化，写到磁盘上</li><li>活化：相反的状态</li></ul> </li><li>钝化时间<br/> <mark>第一种情况：</mark> 当访问量很大时，服务器会根据getLastAccessTime 来进行排序，对长时间不用，但还没到过期时间的HttpSession进行序列化<br/> <mark>第二种情况：</mark> 当服务器进行重启的时候，为了保持客户HttpSession 中的数据，也要对其进行序列化</li></ul>
<blockquote>
<p>HttpSession 的序列化由服务器自动完成，我们无需关心</p>
</blockquote>
<h3><a id="JSP_2779"></a>JSP</h3>
<ul><li>JSP(Java Server Pages)：是一种动态网页技术标准</li><li>JSP 部署在服务器上，可以处理客户端发送的请求，并根据请求内容动态的生成 HTML、XML 或其他格式文档的 Web网页，然后再响应给客户端。</li><li>Jsp 是基于Java 语言的，它的本质就是 Servlet</li></ul>
<table><thead><tr><th>类别</th><th>使用场景</th></tr></thead><tbody><tr><td>HTML</td><td>开发静态资源，无法添加动态资源</td></tr><tr><td>CSS</td><td>美化页面</td></tr><tr><td>JavaScript</td><td>给网页添加一些动态效果</td></tr><tr><td>Servlet</td><td>编写Java 代码，实现后台功能处理</td></tr><tr><td>JSP</td><td>包含了显示页面技术，也具备Java代码功能</td></tr></tbody></table>
<h4><a id="_2793"></a>快速入门</h4>
<ol><li>创建一个web项目</li><li>在web 目录下创建一个 index.jsp 文件</li><li>在文件中写一句内容为：这是我的第一个jsp</li><li>部署并启动项目</li><li>通过浏览器测试</li></ol>
<pre><code class="prism language-jsp">&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    第一个jsp
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<h4><a id="_2814"></a>执行过程</h4>
<ol><li>客户端浏览器发送请求到Tomcat 服务器</li><li>Tomcat 服务器解析请求地址</li><li>找到具体的应用</li><li>找到对应的jsp文件</li><li>将jsp文件翻译为.java的文件</li><li>编译Java文件</li><li>响应给客户端</li></ol>
<p><strong>文件内容介绍</strong></p>
<ul><li>生成的Java 文件目录<br/> 继承自 HttpJspBase类，而HttpJspBase继承自 HttpServlet(<mark>JSP本质上就是一个 Servlet</mark>)<br/> jsp显示页面本质上就是通过获取输出流对象并通过write写出</li></ul>
<h4><a id="_2830"></a>语法</h4>
<ul><li>JSP注释：<code>&lt;%-- 注释的内容 --%&gt;</code></li><li>Java代码块：<code>&lt;% Java代码 %&gt;</code></li><li>JSP表达式：<code>&lt;%=表达式%&gt;</code></li><li>JSP声明：<code>&lt;%! 声明变量或方法 %&gt;</code></li></ul>
<blockquote>
<p><code>System.out.println()</code>：普通输出语句，输出在控制台上<br/> <code>out.println()</code>：JspWriter 对象，将内容输出在浏览器页面上，不会自动换行<br/> <code>&lt;%="要输出的内容"%&gt;</code>就相当于<code>out.println("要输出的内容")</code><br/> 在声明中，如果加<code>!</code>，代表声明的是成员变量；如果不加<code>!</code>，代表声明的是局部变量；如果是声明方法，就必须加<code>!</code></p>
</blockquote>
<h4><a id="_2842"></a>指令</h4>
<ul><li>page 指令：<code>&lt;%@ page 属性名=属性值 属性名=属性值... %&gt;</code>
<table><thead><tr><th>属性名</th><th>作用</th></tr></thead><tbody><tr><td>contentType</td><td>响应正文支持的类型和设置编码格式</td></tr><tr><td>language</td><td>使用的语言，默认是Java</td></tr><tr><td>errorPage</td><td>当前页面出现异常后跳转的页面</td></tr><tr><td>isErrorPage</td><td>是否抓住异常，如果为true则页面中就可以使用异常对象，默认是false</td></tr><tr><td>import</td><td>导包 import= “java.util.ArrayList”</td></tr><tr><td>session</td><td>是否创建 HttpSession 对象，默认是true</td></tr><tr><td>buffer</td><td>设定 JspWriter 输出jsp内容缓存的大小，默认8kb</td></tr><tr><td>pageEncoding</td><td>翻译jsp时所用的编码格式</td></tr><tr><td>isEIgnored</td><td>是否忽略EL表达式，默认是false</td></tr></tbody></table> </li><li>include 指令：可以包含其他页面<br/> <code>&lt;%@ include file=包含的页面 %&gt;</code></li><li>taglib 指令：可以引入外部标签库<br/> <code>&lt;%@ taglib uri=标签库的地址 prefix=前缀名称 %&gt;</code></li></ul>
<h4><a id="_2861"></a>注意事项</h4>
<ul><li>九大隐式对象（不用创建，可以直接使用） 
  <table><thead><tr><th>隐式对象名称</th><th>代表实际对象</th></tr></thead><tbody><tr><td>request</td><td>javax.servlet.http.HttpServletRequest</td></tr><tr><td>response</td><td>javax.servlet.http.HttpServletResponse</td></tr><tr><td>session</td><td>javax.servlet.http.HttpSession</td></tr><tr><td>application</td><td>javax.servlet.ServletContext</td></tr><tr><td>page</td><td>java.lang.Object</td></tr><tr><td>config</td><td>javax.servlet.ServletConfig</td></tr><tr><td>exception</td><td>java.lang.Throwable</td></tr><tr><td>out</td><td>javax.servlet.jsp.JspWriter</td></tr><tr><td>pageContext</td><td>javax.servlet.jsp.PageContext</td></tr></tbody></table> </li><li>PageContext 对象 
  <ul><li>是 JSP 独有的， Servlet 中没有</li><li>是四大域对象之一的页面域对象，还可以操作其他三个域对象中的属性</li><li>可以获取其他八个隐式对象</li><li>生命周期是随着 JSP 的创建而存在，随着 JSP 的结束而消失。每个JSP 页面都有一个 PageContext 对象</li></ul> </li></ul>
<p><strong>四大域对象</strong></p>
<table><thead><tr><th>域对象名称</th><th>范围</th><th>级别</th><th>备注</th></tr></thead><tbody><tr><td>PageContext</td><td>页面范围</td><td>最小，只能在当前页面使用</td><td>因范围太小，开发中用的很少</td></tr><tr><td>ServletRequest</td><td>请求范围</td><td>一次请求或当前请求转发用</td><td>请求转发之后，再次转发时请求域丢失</td></tr><tr><td>HttpSession</td><td>会话范围</td><td>多次请求数据共享时使用</td><td>多次请求共享数据，但不同的客户端不能共享</td></tr><tr><td>ServletContext</td><td>应用范围</td><td>最大，整个应用都可以使用</td><td>尽量少用，如果对数据有修改需要做同步处理</td></tr></tbody></table>
<h4><a id="MVC_2890"></a>MVC模型</h4>
<ul><li><mark>M(Model)：模型。</mark> 用于封装数据，封装的是数据模型</li><li><mark>V(View)：视图。</mark> 用于显示数据，动态资源用 JSP页面，静态资源用 HTML 页面</li><li><mark>C(Controller)：控制器。</mark> 用于处理请求和响应，例如 Servlet</li></ul>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/db52e8bdb8e0412191aa62c9c575d323.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h3><a id="3_2899"></a>学生管理系统3</h3>
<p><strong>登录功能</strong></p>
<ol><li>创建一个web目录</li><li>在web目录下创建一个index.jsp</li><li>在页面中获取会话域中的用户名，获取到了就显示添加和查看功能的超链接，没获取到就显示登录功能的超链接</li><li>在web目录下创建一个login.jsp。实现登录页面</li><li>创建 LoginServlet，获取用户名和密码</li><li>如果用户名为空，则重定向到登录页面</li><li>如果不为空，将用户名添加到会话域中，再重定向到首页</li></ol>
<pre><code class="prism language-jsp">&lt;%-- login.jsp --%&gt;
&lt;%--
  Created by IntelliJ IDEA.
  User: lihao
  Date: 2022/2/24
  Time: 20:25
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;登录&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;学生信息管理系统--登录&lt;/h1&gt;
&lt;hr&gt;
&lt;form action="/login" method="post"&gt;
    用户名:&lt;input type="text" name="username"&gt;
    密码:&lt;input type="password" name="password"&gt;
    &lt;button type="submit"&gt;登录&lt;/button&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="prism language-java"><span class="token comment">// login.java</span>
<span class="token keyword">package</span> <span class="token namespace">studentServlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpSession</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> login <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> password <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> username <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"账号不能为空，请重新输入（2s后返回...）"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Refresh"</span><span class="token punctuation">,</span><span class="token string">"2;URL=/login.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"abc123"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
                resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">"/index.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"账号密码不正确，请重新输入（2s后返回...）"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                resp<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Refresh"</span><span class="token punctuation">,</span><span class="token string">"2;URL=/login.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-jsp">&lt;%-- index.jsp --%&gt;
&lt;%--
  Created by IntelliJ IDEA.
  User: lihao
  Date: 2022/2/24
  Time: 19:58
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;学生信息管理系统&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;学生信息管理系统&lt;/h1&gt;
    &lt;hr&gt;
    &lt;% if(session.getAttribute("username") == null){ %&gt;
    &lt;a href="/login.jsp"&gt;请登录&lt;/a&gt;
    &lt;% } else { %&gt;
    &lt;a href="/add.jsp"&gt;添加学生信息&lt;/a&gt;
    &lt;a href="/list"&gt;查看学生信息&lt;/a&gt;
    &lt;% } %&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="prism language-jsp">&lt;%-- list.jsp --%&gt;
&lt;%@ page import="java.util.ArrayList" %&gt;
&lt;%@ page import="studentServlet.bean.Student" %&gt;
&lt;%--
  Created by IntelliJ IDEA.
  User: lihao
  Date: 2022/2/24
  Time: 20:30
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;查看学生&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;table width="600px" border="1px" align="center"&gt;
        &lt;tr&gt;
            &lt;th&gt;姓名&lt;/th&gt;
            &lt;th&gt;年龄&lt;/th&gt;
            &lt;th&gt;成绩&lt;/th&gt;
        &lt;/tr&gt;
        &lt;%
            ArrayList&lt;Student&gt; students = (ArrayList&lt;Student&gt;) session.getAttribute("students");
            for(Student stu : students){
        %&gt;
            &lt;tr&gt;
                &lt;td&gt;&lt;%=stu.getUsername()%&gt;&lt;/td&gt;
                &lt;td&gt;&lt;%=stu.getAge()%&gt;&lt;/td&gt;
                &lt;td&gt;&lt;%=stu.getScore()%&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;% } %&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="prism language-java"><span class="token comment">// list.java</span>
<span class="token keyword">package</span> <span class="token namespace">studentServlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">studentServlet<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Student</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/list"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> list <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token string">"E:\\Java\\code\\StudentServlet\\stu.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> split <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>split<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        req<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"students"</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span><span class="token string">"/list.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="EL_3079"></a>EL表达式</h3>
<ul><li>EL(Expression Language)：表达式语言</li><li>在 JSP 2.0 规范中加入的内容，也是 Servlet 规范的一部分</li><li>作用：在 JSP 页面中获取数据，让我们的 JSP 脱离 Java代码块和 JSP 表达式</li><li>语法：<code>${表达式内容}</code></li></ul>
<h4><a id="_3086"></a>快速入门</h4>
<ol><li>创建一个web 项目</li><li>在web 目录下创建 jsp文件</li><li>在文件中向域对象添加数据</li><li>使用三种方式获取域对象中的数据(Java代码块、JSP表达式、EL表达式)</li><li>部署并启动项目</li><li>通过浏览器测试</li></ol>
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>
  <span class="token class-name">Created</span> by <span class="token class-name">IntelliJ</span> <span class="token class-name">IDEA<span class="token punctuation">.</span>
  User</span><span class="token operator">:</span> lihao
  <span class="token class-name">Date</span><span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">25</span>
  <span class="token class-name">Time</span><span class="token operator">:</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">04</span>
  <span class="token class-name">To</span> change <span class="token keyword">this</span> template use <span class="token class-name">File</span> <span class="token operator">|</span> <span class="token class-name">Settings</span> <span class="token operator">|</span> <span class="token class-name">File</span> <span class="token class-name">Templates</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>html<span class="token punctuation">&gt;</span></span>
<span class="token generics"><span class="token punctuation">&lt;</span>head<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>title<span class="token punctuation">&gt;</span></span>EL表达式快速入门<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>body<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span> request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>java代码块<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span> out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span><span class="token operator">&gt;</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span> jsp表达式 <span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%=</span>request<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token operator">&gt;</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>EL表达式<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    $<span class="token punctuation">{<!-- --></span>username<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre>
<h4><a id="_3121"></a>获取数据</h4>
<ol><li>获取基本数据类型的数据<br/> <code>${数据名}</code></li><li>获取自定义对象类型的数据<br/> <code>${对象名.属性名}</code><br/> 这里获取到对象的成员变量的原理是通过调用get方法获取，所以不必担心private私有问题</li><li>获取数组类型的数据<br/> <code>${数组名[索引]}</code></li><li>获取List 集合类型的数据<br/> <code>${集合[索引]}</code></li><li>获取 Map 集合类型的数据<br/> <code>${集合.key值}</code>：获取key对应的value</li></ol>
<pre><code class="prism language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ page <span class="token keyword">import</span><span class="token operator">=</span><span class="token string">"study.servlet.bean.Student"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>@ page <span class="token keyword">import</span><span class="token operator">=</span><span class="token string">"java.util.ArrayList"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>@ page <span class="token keyword">import</span><span class="token operator">=</span><span class="token string">"java.util.HashMap"</span> <span class="token operator">%</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>
  <span class="token class-name">Created</span> by <span class="token class-name">IntelliJ</span> <span class="token class-name">IDEA<span class="token punctuation">.</span>
  User</span><span class="token operator">:</span> lihao
  <span class="token class-name">Date</span><span class="token operator">:</span> <span class="token number">2022</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">25</span>
  <span class="token class-name">Time</span><span class="token operator">:</span> <span class="token number">10</span><span class="token operator">:</span><span class="token number">10</span>
  <span class="token class-name">To</span> change <span class="token keyword">this</span> template use <span class="token class-name">File</span> <span class="token operator">|</span> <span class="token class-name">Settings</span> <span class="token operator">|</span> <span class="token class-name">File</span> <span class="token class-name">Templates</span><span class="token punctuation">.</span>
<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>html<span class="token punctuation">&gt;</span></span>
<span class="token generics"><span class="token punctuation">&lt;</span>head<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>title<span class="token punctuation">&gt;</span></span>EL表达式获取数据<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
<span class="token generics"><span class="token punctuation">&lt;</span>body<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">%</span>
        <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ccc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"28"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"stu"</span><span class="token punctuation">,</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"arr"</span><span class="token punctuation">,</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"map"</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>EL表达式获取数据<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    $<span class="token punctuation">{<!-- --></span>stu<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>     <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>获取自定义对象类型的数据<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    $<span class="token punctuation">{<!-- --></span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>       <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>获取数组类型的数据<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    $<span class="token punctuation">{<!-- --></span>list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token generics"><span class="token punctuation">&lt;</span>br<span class="token punctuation">&gt;</span></span>      <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>获取<span class="token class-name">List</span> 集合类型的数据<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
    $<span class="token punctuation">{<!-- --></span>map<span class="token punctuation">.</span>user<span class="token punctuation">}</span>         <span class="token operator">&lt;</span><span class="token operator">%</span><span class="token operator">--</span>获取 <span class="token class-name">Map</span> 集合类型的数据<span class="token operator">--</span><span class="token operator">%</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span>
</code></pre>
<h4><a id="_3175"></a>注意事项</h4>
<ul><li>EL 表达式没有空指针异常</li><li>EL 表达式没有索引越界异常</li><li>EL 表达式没有字符串的拼接</li></ul>
<p><strong>使用细节</strong></p>
<ul><li>EL 表达式能够获取到四大域对象的数据，根据名称从小到大在域对象中查找</li><li>还可以获取 JSP 其他八个隐式对象，并调用对象中的方法</li></ul>
<h4><a id="_3186"></a>运算符</h4>
<ul><li>关系运算符 
  <table><thead><tr><th>运算符</th><th>作用</th><th>示例</th><th>结果</th></tr></thead><tbody><tr><td>== 或 eq</td><td>等于</td><td>${5 == 5} 或 ${5 eq 5}</td><td>true</td></tr><tr><td>!= 或 ne</td><td>不等于</td><td>${5 != 5} 或 ${5 ne 5}</td><td>false</td></tr><tr><td>&lt; 或 lt</td><td>小于</td><td>${3 &lt; 5} 或 ${3 lt 5}</td><td>true</td></tr><tr><td>&gt; 或 gt</td><td>大于</td><td>${3 &gt; 5} 或 ${3 gt 5}</td><td>false</td></tr><tr><td>&lt;= 或 le</td><td>小于等于</td><td>${3 &lt;= 5} 或 ${3 le 5}</td><td>true</td></tr><tr><td>&gt;= 或 ge</td><td>大于等于</td><td>${3 &gt;= 5} 或 ${3 ge 5}</td><td>false</td></tr></tbody></table> </li><li>逻辑运算符 
  <table><thead><tr><th>运算符</th><th>作用</th><th>示例</th><th>结果</th></tr></thead><tbody><tr><td>&amp;&amp; 或 and</td><td>并且</td><td>${A &amp;&amp; B} 或 ${A and B}</td><td>true / false</td></tr><tr><td>|| 或 or</td><td>或者</td><td>${A || B} 或 ${A or B}</td><td>true / false</td></tr><tr><td>! 或 not</td><td>取反</td><td>${!A} 或 ${not A}</td><td>true / false</td></tr></tbody></table> </li><li>其他运算符 
  <table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>empty</td><td>1. 判断对象是否为null<br/>2. 判断字符串是否为空字符串<br/>3. 判断容器元素是否为0</td></tr><tr><td>条件 ? 表达式1 : 表达式2</td><td>三元运算符</td></tr></tbody></table> </li></ul>
<h4><a id="_3209"></a>隐式对象</h4>
<table><thead><tr><th>隐式对象名称</th><th>对应JSP隐式对象</th><th>说明</th></tr></thead><tbody><tr><td>pageContext</td><td>pageContext</td><td>功能完全相同</td></tr><tr><td>applicationScope</td><td>无</td><td>操作应用域对象数据</td></tr><tr><td>sessionScope</td><td>无</td><td>操作会话域对象数据</td></tr><tr><td>requestScope</td><td>无</td><td>操作请求域对象数据</td></tr><tr><td>pageScope</td><td>无</td><td>操作页面域对象数据</td></tr><tr><td>header</td><td>无</td><td>获取请求头数据</td></tr><tr><td>headerValues</td><td>无</td><td>获取请求头数据(多个值)</td></tr><tr><td>param</td><td>无</td><td>获取请求参数数据</td></tr><tr><td>paramValues</td><td>无</td><td>获取请求参数数据(多个值)</td></tr><tr><td>initParam</td><td>无</td><td>获取全局配置参数数据</td></tr><tr><td>cookie</td><td>无</td><td>获取Cookie对象</td></tr></tbody></table>
<pre><code class="prism language-jsp">&lt;%--
  Created by IntelliJ IDEA.
  User: lihao
  Date: 2022/2/25
  Time: 10:21
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;隐式对象&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;%--pageContext对象，可以获取其他三个域对象和JSP中八个隐式对象--%&gt;
    ${pageContext.request.requestURL}&lt;br&gt;

    &lt;%--applicationScope sessionScope requestScope pageScope 操作四大域对象中的数据--%&gt;
    ${pageContext.setAttribute("username","zhangsan")}
    ${pageScope.username}&lt;br&gt;

    &lt;%--header headerValues 获取请求头数据--%&gt;
    ${header["connection"]}
    ${headerValues["connection"][0]}
    ${header.connection}&lt;br&gt;

    &lt;%--param paramValues 获取请求参数数据--%&gt;
    ${param.username}
    ${paramValues.hobby[0]}&lt;br&gt;

    &lt;%--initParam 获取全局配置参数--%&gt;
    ${initParam.globaldesc}&lt;br&gt;

    &lt;%--cookie 获取cookie信息--%&gt;
    ${cookie}   &lt;%--直接写cookie获取到的是一个map集合--%&gt;
    &lt;br&gt;
    ${cookie.JSESSIONID.value}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3><a id="JSTL_3266"></a>JSTL</h3>
<ul><li>JSTL(Java Server Pages Standarded Tag Library)：JSP 标准标签库</li><li>主要提供给开发人员一个标准通用的标签库</li><li><mark>开发人员可以利用这些标签来取代 JSP 页面上的Java代码，从而提高程序的可读性，降低程序的维护难度</mark></li></ul>
<table><thead><tr><th>组成</th><th>作用</th><th>说明</th></tr></thead><tbody><tr><td>core</td><td>核心标签库</td><td>通用的逻辑处理</td></tr><tr><td>fmt</td><td>国际化</td><td>不同地域显示不同语言</td></tr><tr><td>functions</td><td>EL 函数</td><td>EL 表达式可以使用的方法</td></tr><tr><td>sql</td><td>操作数据库</td><td>了解</td></tr><tr><td>xml</td><td>操作XML</td><td>了解</td></tr></tbody></table>
<h4><a id="_3280"></a>核心标签</h4>
<table><thead><tr><th>标签名称</th><th>功能分类</th><th>属性</th><th>作用</th></tr></thead><tbody><tr><td>&lt;标签名:if&gt;</td><td>流程控制</td><td>核心标签库</td><td>用于条件判断</td></tr><tr><td>&lt;标签名:choose&gt;<br/>&lt;标签名:when&gt;<br/>&lt;标签名:otherwise&gt;</td><td>流程控制</td><td>核心标签库</td><td>用于多条件判断</td></tr><tr><td>&lt;标签名:forEach&gt;</td><td>迭代遍历</td><td>核心标签库</td><td>用于循环遍历</td></tr></tbody></table>
<p><strong>使用步骤</strong></p>
<ol><li>创建一个 web 项目</li><li>在 web目录下创建一个 WEB-INF 目录</li><li>在 WEB-INF 目录下创建一个 libs 目录，将 JSTL 的 jar 包导入</li><li>创建 JSP 文件，通过 taglib 导入 JSTL 标签库</li><li>对流程控制和迭代遍历的标签进行使用</li><li>部署并启动项目</li><li>通过浏览器查看</li></ol>
<pre><code class="prism language-jsp">&lt;%@ page import="java.util.ArrayList" %&gt;&lt;%--
  Created by IntelliJ IDEA.
  User: lihao
  Date: 2022/2/25
  Time: 10:45
  To change this template use File | Settings | File Templates.
--%&gt;
&lt;%@ page contentType="text/html;charset=UTF-8" language="java" %&gt;

&lt;%--导入核心库并起标签名--%&gt;
&lt;%@ taglib uri="http://java.sun.com/jstl/core_rt" prefix="c" %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;JSTL【JSP标准标签库】&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    ${pageContext.setAttribute("score","A")}

    &lt;%--对成绩进行判断--%&gt;
    &lt;c:if test="${score eq 'A'}"&gt;
        优秀
    &lt;/c:if&gt;
    &lt;hr&gt;

    &lt;%--多条件判断--%&gt;
    &lt;c:choose&gt;
        &lt;c:when test="${score eq 'A'}"&gt;优秀&lt;/c:when&gt;
        &lt;c:when test="${score eq 'B'}"&gt;良好&lt;/c:when&gt;
        &lt;c:when test="${score eq 'C'}"&gt;及格&lt;/c:when&gt;
        &lt;c:when test="${score eq 'D'}"&gt;较差&lt;/c:when&gt;
        &lt;c:otherwise&gt;成绩非法&lt;/c:otherwise&gt;
    &lt;/c:choose&gt;
    &lt;hr&gt;

    &lt;%--循环遍历--%&gt;
    &lt;%
        ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();
        list.add("aaa");
        list.add("bbb");
        list.add("ccc");
        list.add("ddd");
        pageContext.setAttribute("list",list);
    %&gt;
    &lt;c:forEach items="${list}" var="str"&gt;
        ${str}&lt;br&gt;
    &lt;/c:forEach&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3><a id="Filter_3349"></a>Filter</h3>
<ul><li>在程序中访问服务器资源时，当一个请求到来，服务器首先判断是否有过滤器与请求资源相关联，如果有，过滤器可以将请求拦截下来，完成一些特定的功能，再由过滤器决定是否交给请求资源。如果没有相关联的过滤器则像之前那样直接请求资源了。响应也是类似的</li><li>过滤器一般完成用于通用的操作，例如：登录验证、统一编码处理、敏感字符过滤等等…</li></ul>
<h4><a id="_3354"></a>概述</h4>
<ul><li>是一个接口。如果想实现过滤器的功能，必须实现该接口</li><li>核心方法 
  <table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>init(FilterConfig config)</td><td>初始化方法</td></tr><tr><td>void</td><td>doFilter(ServletRequest request, ServletResponse response, FilterChain chain)</td><td>对请求资源和响应资源过滤</td></tr><tr><td>void</td><td>destroy()</td><td>销毁方法</td></tr></tbody></table> </li><li>配置方式<br/> 方式一：配置文件（web.xml）<br/> 方式二：注解方式</li></ul>
<h4><a id="FilterChain_3367"></a>FilterChain</h4>
<ul><li>FilterChain 是一个接口，代表过滤器链对象。由Servlet 容器提供实现类对象。直接使用即可</li><li>过滤器可以定义多个，就会组成过滤器链</li><li>核心方法 
  <table><thead><tr><th>返回值</th><th>方法名</th><th>说明</th></tr></thead><tbody><tr><td>void</td><td>doFilter(ServletRequest request, ServletResponse response)</td><td>放行方法</td></tr></tbody></table> </li></ul>
<blockquote>
<p>如果有多个过滤器，在第一个过滤器中调用下一个过滤器，依此类推。直到到达最终访问资源。<br/> 如果只有一个过滤器，放行时，就会直接到达最终访问资源</p>
</blockquote>
<h4><a id="_3379"></a>过滤器使用</h4>
<ul><li>需求说明：通过 Filter 过滤器解决多个资源写出中文乱码的问题</li><li>实现步骤 
  <ol><li>创建一个 web 项目</li><li>创建两个 Servlet 功能类，都向客户端写出中文数据</li><li>创建一个 Filter 过滤器实现类，重写 doFilter 核心方法</li><li>在方法内解决中文乱码，并放行</li><li>部署并启动项目</li><li>通过浏览器测试</li></ol> </li></ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">"/filter01"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> filter <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">FilterConfig</span> filterConfig<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"filter执行了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 处理乱码</span>
        servletResponse<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 放行</span>
        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>servletRequest<span class="token punctuation">,</span>servletResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_3414"></a>使用细节</h4>
<ul><li>配置方式<br/> 注解方式：<code>@WebFilter(拦截路径)</code><br/> 配置文件方式<pre><code class="prism language-xml"><span class="token comment">&lt;!--声明--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>全类名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--映射--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/拦截路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li>多个过滤器使用顺序<br/> 如果有多个过滤器，取决于过滤器映射的顺序</li></ul>
<h4><a id="_3434"></a>生命周期</h4>
<ul><li>创建<br/> 当应用加载时实例化对象并执行init初始化方法</li><li>服务<br/> 对象提供服务的过程，执行 doFilter 方法</li><li>销毁<br/> 当应用卸载时或服务器停止时对象销毁。执行 destroy 方法</li></ul>
<h4><a id="FilterConfig_3443"></a>FilterConfig</h4>
<blockquote>
<p>FilterConfig 是一个接口。代表过滤器的配置对象，可以加载一些初始化参数</p>
</blockquote>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>String</td><td>getFilterName()</td><td>获取过滤器对象名称</td></tr><tr><td>String</td><td>getInitParameter(String name)</td><td>根据name获取 value</td></tr><tr><td>Enumeration&lt;String&gt;</td><td>getInitParameterNames()</td><td>获取所有参数的key</td></tr><tr><td>ServletContext</td><td>getServletContext()</td><td>获取应用上下文对象</td></tr></tbody></table>
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>全类名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
      
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>username<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>zhangsan<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h4><a id="_3467"></a>五种拦截行为</h4>
<blockquote>
<p>Filter 过滤器默认拦截的是请求，但是在实际开发中，我们还有请求转发和请求包含，以及由服务器触发调用的全局错误页面。默认情况下过滤器是不参与过滤的，要想使用，就需要我们配置</p>
</blockquote>
<p><strong>拦截方式</strong></p>
<pre><code class="prism language-xml"><span class="token comment">&lt;!--声明--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>全类名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--映射--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/拦截路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
      
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dispatcher</span><span class="token punctuation">&gt;</span></span>REQUEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dispatcher</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dispatcher</span><span class="token punctuation">&gt;</span></span>FORWARD<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dispatcher</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dispatcher</span><span class="token punctuation">&gt;</span></span>INCLUDE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dispatcher</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dispatcher</span><span class="token punctuation">&gt;</span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dispatcher</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dispatcher</span><span class="token punctuation">&gt;</span></span>ASYNC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dispatcher</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<blockquote>
<p>REQUEST：默认值，浏览器直接请求的资源会被过滤器拦截</p>
<p>FORWARD：转发访问资源会被过滤器拦截</p>
<p>INCLUDE：包含访问资源</p>
<p>ERROR：全局错误跳转资源</p>
<p>ASYNC：异步访问资源</p>
</blockquote>
<p><strong>全局错误页面配置</strong></p>
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>error-page</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--根据异常类型配置--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exception-type</span><span class="token punctuation">&gt;</span></span>java.lang.exception<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exception-type</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>/error.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>error-page</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>error-page</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--根据状态码配置--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>error-code</span><span class="token punctuation">&gt;</span></span>404<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>error-code</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>/error.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>error-page</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3><a id="Listener_3519"></a>Listener</h3>
<ul><li>观察者设计模式，所有的监听器都是基于观察者设计模式的</li><li>三个组成部分 
  <ol><li>事件源：触发事件的对象</li><li>事件：触发的动作，封装了事件源</li><li>监听器：当事件源触发事件后，可以完成功能</li></ol> </li><li>在程序当中，我们可以对：对象的创建销毁、域对象中属性的变化、会话相关内容进行监听</li><li>Servlet 规范中共计 8 个监听器，监听器都是以接口形式提供，具体功能需要我们自己来完成</li></ul>
<h4><a id="_3529"></a>监听器</h4>
<p><strong>监听对象的创建和销毁的监听器</strong></p>
<p><mark>ServletContextListener</mark>：用于监听 ServletContext 对象的创建和销毁</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>contextInitialized(ServletContextEvent sce)</td><td>对象创建时执行该方法</td></tr><tr><td>void</td><td>contextDestroyed(ServletContextEvent sce)</td><td>对象销毁时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：ServletContextEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 ServletContext<br/> 真正的事件指的是创建或销毁 ServletContext 对象的操作</p>
</blockquote>
<p><mark>HttpSessionListener</mark>：用于监听 HttpSession 对象的创建和销毁</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>sessionCreated(HttpSessionEvent se)</td><td>对象创建时执行该方法</td></tr><tr><td>void</td><td>sessionDestroyed(HttpSessionEvent se)</td><td>对象销毁时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：HttpSessionEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 HttpSession<br/> 真正的事件指的是创建或销毁 HttpSession 对象的操作</p>
</blockquote>
<p><mark>ServletRequestListener</mark>：用于监听 ServletRequest 对象的创建和销毁</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>requestInitialized(ServletRequestEvent sre)</td><td>对象创建时执行该方法</td></tr><tr><td>void</td><td>requestDestroyed(ServletRequestEvent sre)</td><td>对象销毁时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：ServletRequestEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 ServletRequest<br/> 真正的事件指的是创建或销毁 ServletRequest 对象的操作</p>
</blockquote>
<p><strong>监听域对象属性变化的监听器</strong></p>
<p><mark>ServletContextAttributeListener</mark>：用于监听 ServletContext 应用域中属性的变化</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>attributeAdded(ServletContextAttributeEvent scae)</td><td>域中添加属性时执行该方法</td></tr><tr><td>void</td><td>attributeRemoved(ServletContextAttributeEvent scae)</td><td>域中移除属性时执行该方法</td></tr><tr><td>void</td><td>attributeReplaced(ServletContextAttributeEvent scae)</td><td>域中替换属性时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：ServletContextAttributeEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 ServletContext<br/> 真正的事件指的是添加、移除、替换应用域中属性的操作</p>
</blockquote>
<p><mark>HttpSessionAttributeListener</mark>：用于监听 HttpSession 会话域中属性的变化</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>attributeAdded(HttpSessionBindingEvent se)</td><td>域中添加属性时执行该方法</td></tr><tr><td>void</td><td>attributeRemoved(HttpSessionBindingEvent se)</td><td>域中移除属性时执行该方法</td></tr><tr><td>void</td><td>attributeReplaced(HttpSessionBindingEvent se)</td><td>域中替换属性时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：HttpSessionBindingEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 HttpSession<br/> 真正的事件指的是添加、移除、替换会话域中属性的操作</p>
</blockquote>
<p><mark>ServletRequestAttributeListener</mark>：用于监听 ServletRequest 请求域中属性的变化</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>attributeAdded(ServletRequestAttributeEvent srae)</td><td>域中添加属性时执行该方法</td></tr><tr><td>void</td><td>attributeRemoved(ServletRequestAttributeEvent srae)</td><td>域中移除属性时执行该方法</td></tr><tr><td>void</td><td>attributeReplaced(ServletRequestAttributeEvent srae)</td><td>域中替换属性时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：ServletRequestAttributeEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 ServletRequest<br/> 真正的事件指的是添加、移除、替换请求域中属性的操作</p>
</blockquote>
<p><strong>监听会话相关的感知型监听器</strong></p>
<blockquote>
<p>感知型监听器：在定义好之后就可以直接使用，不需要再通过注解或xml文件进行配置</p>
</blockquote>
<p><mark>HttpSessionBindingListener</mark>：用于感知对象和会话域绑定的监听器</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>valueBound(HttpSessionBindingEvent event)</td><td>数据添加到会话域中（绑定）时执行该方法</td></tr><tr><td>void</td><td>valueUnbound(HttpSessionBindingEvent event)</td><td>数据从会话域中移除（解绑）时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：HttpSessionBindingEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 HttpSession<br/> 真正的事件指的是添加、移除会话域中数据的操作</p>
</blockquote>
<p><mark>HttpSessionActivationListener</mark>：用于感知会话域对象钝化和活化的监听器</p>
<p><strong>核心方法</strong></p>
<table><thead><tr><th>返回值</th><th>方法名</th><th>作用</th></tr></thead><tbody><tr><td>void</td><td>sessionWillPassivate(HttpSessionEvent se)</td><td>会话域中数据钝化时执行该方法</td></tr><tr><td>void</td><td>sessionDidActivate(HttpSessionEvent se)</td><td>会话域中数据活化时执行该方法</td></tr></tbody></table>
<blockquote>
<p>参数：HttpSessionEvent 代表事件对象<br/> 事件对象中封装了事件源，也就是 HttpSession<br/> 真正的事件指的是会话域中数据钝化、活化的操作</p>
</blockquote>
<h4><a id="_3645"></a>监听器的使用</h4>
<ul><li>监听对象的<br/> ServletContextListener<br/> HttpSessionListener<br/> ServletRequestListener</li></ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>listener</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContextEvent</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletContextListener</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebListener</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/listener01"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@WebListener</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> listener01 <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> servletContextEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"监听到了对象的创建"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> servletContextEvent<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 添加属性</span>
        servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 替换属性</span>
        servletContext<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"李四"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 移除属性</span>
        servletContext<span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> servletContextEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"监听到了对象的销毁"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul><li>监听属性变化的<br/> ServletContextAttributeListener<br/> HttpSessionAttributeListener<br/> ServletRequestAttributeListener</li></ul>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>listener</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/listener02"</span><span class="token punctuation">)</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> listener02 <span class="token keyword">implements</span> <span class="token class-name">ServletContextAttributeListener</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeAdded</span><span class="token punctuation">(</span><span class="token class-name">ServletContextAttributeEvent</span> servletContextAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"监听到了属性的添加"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> servletContextAttributeEvent<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> username <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeRemoved</span><span class="token punctuation">(</span><span class="token class-name">ServletContextAttributeEvent</span> servletContextAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"监听到了属性的移除"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> servletContextAttributeEvent<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> username <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">attributeReplaced</span><span class="token punctuation">(</span><span class="token class-name">ServletContextAttributeEvent</span> servletContextAttributeEvent<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"监听到了属性的替换"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletContext</span> servletContext <span class="token operator">=</span> servletContextAttributeEvent<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> username <span class="token operator">=</span> servletContext<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul><li>会话相关的感知型<br/> HttpSessionBindingListener<br/> HttpSessionActivationListener</li></ul>
<p><strong>配置监听器</strong></p>
<ul><li>注解方式：<code>@WebListener</code></li><li>xml文档方式<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">&gt;</span></span>监听器对象实现类的全路径<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ul>
<h3><a id="_3738"></a>学生管理系统优化</h3>
<h4><a id="_3740"></a>解决乱码</h4>
<blockquote>
<p>使用过滤器实现所有资源的编码统一</p>
</blockquote>
<ol><li>将请求和响应对象转换为和HTTP相关的HttpServletRequest和HttpServletResponse</li><li>设置编码格式</li><li>放行</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">studentSystem<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span><span class="token string">"/*"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EncodingFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 将请求和响应对象转换为和HTTP相关的HttpServletRequest和HttpServletResponse</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> servletRequest<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span> servletResponse<span class="token punctuation">;</span>
        <span class="token comment">// 设置编码格式</span>
        request<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 放行</span>
        filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_3772"></a>检查登录</h4>
<blockquote>
<p>使用过滤器解决登录检查</p>
</blockquote>
<ol><li>将请求和响应对象转换为和HTTP相关的HttpServletRequest和HttpServletResponse</li><li>获取会话域对象中的数据</li><li>判断用户名</li><li>重定向(或定时刷新)到登录页面或放行</li></ol>
<blockquote>
<p>注解配置过滤器时指定多个拦截路径<br/> <code>@WebFilter(value = {"/拦截路径一", "/拦截路径二", ...})</code></p>
</blockquote>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">studentSystem<span class="token punctuation">.</span>filter</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebFilter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpSession</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebFilter</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"/add.jsp"</span><span class="token punctuation">,</span> <span class="token string">"/list.jsp"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginFilter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">ServletRequest</span> servletRequest<span class="token punctuation">,</span> <span class="token class-name">ServletResponse</span> servletResponse<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> filterChain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 将请求和响应对象转换为和HTTP相关的HttpServletRequest和HttpServletResponse</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">)</span> servletRequest<span class="token punctuation">;</span>
        <span class="token class-name">HttpServletResponse</span> response <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">)</span> servletResponse<span class="token punctuation">;</span>
        <span class="token comment">// 获取会话域对象中的数据</span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> username <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> password <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 判断用户名</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"abc123"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            filterChain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 输出提示信息并设置定时刷新到登录页面</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"您还未登录，请登录后再试。(2s后为您跳转到登录页面)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Refresh"</span><span class="token punctuation">,</span><span class="token string">"2:URL=/login.jsp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="JSP_3816"></a>优化JSP页面</h4>
<blockquote>
<p>通过EL表达式和JSTL替换之前的Java代码块和JSP表达式</p>
</blockquote>
<p><strong>完整代码</strong>：<a href="https://github.com/HelloCode66/StudentSystem">https://github.com/HelloCode66/StudentSystem</a></p>
<hr/>
<h2><a id="MYSQL_3823"></a>MYSQL</h2>
<h3><a id="_3825"></a>基本概念</h3>
<h4><a id="_3827"></a>数据库</h4>
<ul><li>用于存储和管理数据的仓库</li><li>英文单词为 DataBase。简称 DB</li><li>它的存储空间很大，可以存放百万条、千万条、上亿条数据</li><li>使用统一的方式操作数据库—SQL</li></ul>
<h4><a id="Mysql_3834"></a>Mysql</h4>
<ul><li>MySQL是一个最流行的关系型数据库管理系统之一。由瑞典 MySQL AB公司开发，后被 Oracle 公司收购</li><li>关系型数据库是将数据保存在不同的数据表中，而不是将所有数据放在一个大仓库内，而且表与表之间还可以有关联关系。这样就提高了访问速度以及提高了灵活性</li><li>MySQL 所使用的SQL语句是用于访问数据库最常用的标准化语言</li><li>免费（6版本之前）</li></ul>
<h4><a id="_3841"></a>安装</h4>
<ul><li>为了能够更好的体现真实开发环境，将MySQL 安装在 Linux 系统上，以此来模拟公司的数据库服务器</li><li>具体的安装步骤就不做说明了，网上很多</li><li>在Windows下使用SQLyog连接数据库，下载安装方法网上也很多</li></ul>
<h3><a id="DDL_3847"></a>DDL</h3>
<h4><a id="_3849"></a>数据库、数据表、数据的关系</h4>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/115c8380423f4391a5b0177f9c86df5e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<ul><li>MySQL服务器中可以创建多个数据库</li><li>每个数据库可以包含多张数据表</li><li>每个数据表中可以存储多条数据记录</li><li>客户端通过数据库管理系统来操作MySQL数据库</li></ul>
<h4><a id="SQL_3859"></a>SQL的介绍</h4>
<ul><li>SQL(Structured Query Language)：结构化查询语言。其实就是定义了操作所有关系型数据库的一种规则</li><li>通用语法规则<br/> SQL语句可以单行或者多行书写，以分号结尾<br/> 可使用空格和缩进来增强语句的可读性<br/> MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写<br/> 单行注释：<code>--注释内容</code> <code>#注释内容</code>(MySQL特有)<br/> 多行注释：<code>/*注释内容*/</code></li><li>SQL分类<br/> DDL(Data Definition Language)：数据定义语言。用来操作数据库、表、列等<br/> DML(Data Manipulation Language)：数据操作语言。用来对数据库中表的数据进行增删改<br/> DQL(Data Query Language)：数据查询语言。用来查询数据库中表的记录（数据）<br/> DCL(Data Control Language)：数据控制语言。用来定义数据库的访问权限和安全级别，以及创建用户</li></ul>
<h4><a id="_3874"></a>查询和创建数据库</h4>
<ul><li>查询所有数据库<br/> <code>SHOW DATABASES;</code></li><li>查询数据库的创建语句<br/> <code>SHOW CREATE DATABASE 数据库名称;</code></li><li>创建数据库<br/> <code>CREATE DATABASE 数据库名称;</code></li><li>创建数据库（判断，如果不存在则创建）<br/> <code>CREATE DATABASE IF NOT EXISTS 数据库名称;</code></li><li>创建数据库（指定字符集）<br/> <code>CREATE DATABASE 数据库名称 CHARACTER SET 字符集名称;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询所有数据库</span>
<span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询数据库的创建语句</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> mysql<span class="token punctuation">;</span>

<span class="token comment">-- 创建数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db1<span class="token punctuation">;</span>

<span class="token comment">-- 创建数据库并判断，如果不存在则创建</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> db2<span class="token punctuation">;</span>

<span class="token comment">-- 创建数据库并指定字符集</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db3 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8<span class="token punctuation">;</span>

<span class="token comment">-- 查看数据库的字符集</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db3<span class="token punctuation">;</span>


<span class="token comment">-- 练习：创建db4数据库、如果不存在则创建，并指定字符集为gbk</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> db4 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> gbk<span class="token punctuation">;</span>
<span class="token comment">-- 查看编码验证</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db4<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_3913"></a>修改、删除、使用数据库</h4>
<ul><li>修改数据库（修改字符集）<br/> <code>ALTER DATABASE 数据库名称 CHARACTER SET 字符集名称;</code></li><li>删除数据库<br/> <code>DROP DATABASE 数据库名称;</code></li><li>删除数据库（判断，如果存在则删除）<br/> <code>DROP DATABASE IF EXISTS 数据库名称;</code></li><li>使用数据库<br/> <code>USE 数据库名称;</code></li><li>查看当前使用的数据库<br/> <code>SELECT DATABASE();</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 修改数据库（字符集）</span>
<span class="token keyword">ALTER</span> <span class="token keyword">DATABASE</span> db4 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8<span class="token punctuation">;</span>
<span class="token comment">-- 查看db4字符集</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db4<span class="token punctuation">;</span>

<span class="token comment">-- 删除数据库</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> db1<span class="token punctuation">;</span>

<span class="token comment">-- 删除数据库（判断，存在则删除）</span>
<span class="token keyword">DROP</span> <span class="token keyword">DATABASE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> db2<span class="token punctuation">;</span>

<span class="token comment">-- 使用数据库</span>
<span class="token keyword">USE</span> db3<span class="token punctuation">;</span>

<span class="token comment">-- 查看当前使用的数据库</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_3945"></a>查询数据表</h4>
<ul><li>查询所有的数据表<br/> <code>SHOW TABLES;</code></li><li>查询表结构<br/> <code>DESC 表名;</code></li><li>查询表字符集<br/> <code>SHOW TABLE STATUS FROM 库名 LIKE '表名';</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 使用mysql数据库</span>
<span class="token keyword">USE</span> mysql<span class="token punctuation">;</span>

<span class="token comment">-- 查询所有数据表</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询表结构</span>
<span class="token keyword">DESC</span> <span class="token keyword">USER</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询表字符集</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> mysql <span class="token operator">LIKE</span> <span class="token string">'user'</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_3968"></a>创建数据表</h4>
<ul><li> <p>创建数据表</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名<span class="token punctuation">(</span>字段<span class="token punctuation">)</span> 数据类型 约束<span class="token punctuation">,</span>
    列名<span class="token punctuation">(</span>字段<span class="token punctuation">)</span> 数据类型 约束<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    列名<span class="token punctuation">(</span>字段<span class="token punctuation">)</span> 数据类型 约束
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>数据类型<br/> <mark>int</mark>：整数类型<br/> <mark>double</mark>：小数类型<br/> <mark>date</mark>：日期类型。包含年月日，格式：yyyy-MM-dd</p> <p><mark>datetime</mark>：日期类型。包含年月日时分秒，格式：yyyy-MM-dd HH:mm:ss<br/> <mark>timestamp</mark>：时间戳类型。包含年月日时分秒，格式yyyy-MM-dd HH:mm:ss<br/> 如果不给该字段赋值、或赋值为null，则默认使用当前系统时间自动赋值<br/> <mark>varchar(长度)</mark>：字符串类型<br/> …</p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建数据表</span>
<span class="token comment">-- 创建一个product 商品类（商品编号、商品名称、商品价格、商品库存、上架时间）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> product <span class="token punctuation">(</span>
	id <span class="token keyword">INT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	price <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span>
	stock <span class="token keyword">INT</span><span class="token punctuation">,</span>
	insert_time <span class="token keyword">DATE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看product 表详细结构</span>
<span class="token keyword">DESC</span> product<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4006"></a>数据表的修改</h4>
<ul><li>修改表名<br/> <code>ALTER TABLE 表名 RENAME TO 新表名;</code></li><li>修改表的字符集<br/> <code>ALTER TABLE 表名 CHARACTER SET 字符集名称;</code></li><li>单独添加一列<br/> <code>ALTER TABLE 表名 ADD 列名 数据类型;</code></li><li>修改某列的数据类型<br/> <code>ALTER TABLE 表名 MODIFY 列名 新数据类型;</code></li><li>修改列名和数据类型<br/> <code>ALTER TABLE 表名 CHANGE 列名 新列名 新数据类型;</code></li><li>删除某一列<br/> <code>ALTER TABLE 表名 DROP 列名</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 修改表名</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product <span class="token keyword">RENAME</span> <span class="token keyword">TO</span> product2<span class="token punctuation">;</span>

<span class="token comment">-- 查看原字符集</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> db3 <span class="token operator">LIKE</span> <span class="token string">'product2'</span><span class="token punctuation">;</span>
<span class="token comment">-- 修改表的字符集</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product2 <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> gbk<span class="token punctuation">;</span>

<span class="token comment">-- 给product2添加一列color</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product2 <span class="token keyword">ADD</span> color <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 将color数据类型修改为int</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product2 <span class="token keyword">MODIFY</span> color <span class="token keyword">INT</span><span class="token punctuation">;</span>
<span class="token comment">-- 查看表的详细结构</span>
<span class="token keyword">DESC</span> product2<span class="token punctuation">;</span>

<span class="token comment">-- 将color修改为address</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product2 CHANGE color address <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除address列</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> product2 <span class="token keyword">DROP</span> address<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4045"></a>数据表的删除</h4>
<ul><li>删除数据表<br/> <code>DROP TABLE 表名;</code></li><li>删除数据表（判断，如果存在则删除）<br/> <code>DROP TABLE IF EXISTS 表名;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 删除product2表</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> product2<span class="token punctuation">;</span>

<span class="token comment">-- 删除表并判断</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> product2<span class="token punctuation">;</span> 
</code></pre>
<h3><a id="DML_4060"></a>DML</h3>
<h4><a id="_4062"></a>新增表数据</h4>
<ul><li>给指定列添加数据<br/> <code>INSERT INTO 表名(列名1,列名2,...)VALUES(值1,值2,...);</code></li><li>给全部列添加数据<br/> <code>INSERT INTO 表名 VALUES(值1,值2,...);</code></li><li>批量添加数据<br/> <code>INSERT INTO 表名(列名1,列名2,...)VALUES(值1,值2,...),(值1,值2,...),...;</code><br/> <code>INSERT INTO 表名 VALUES(值1,值2,...),(值1,值2,...),...;</code></li></ul>
<p><mark>列名和值的数量以及数据类型要对应，除了数字类型，其他数据类型的数据都需要加引号（单引双引都行，推荐单引）。</mark></p>
<pre><code class="prism language-sql"><span class="token comment">-- 向product表添加一条数据（给全部列添加数据）</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token punctuation">(</span>id<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> stock<span class="token punctuation">,</span> insert_time<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'手机'</span><span class="token punctuation">,</span> <span class="token number">2999</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">'2022-02-26'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'电脑'</span><span class="token punctuation">,</span> <span class="token number">3999</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token string">'2022-02-27'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 向product表中添加指定数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token punctuation">(</span>id<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'电视'</span><span class="token punctuation">,</span> <span class="token number">1999.99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 批量添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'冰箱'</span><span class="token punctuation">,</span> <span class="token number">999.99</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">'2022-02-26'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'空调'</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'2030-01-01'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4086"></a>修改和删除表数据</h4>
<ul><li>修改表中的数据<br/> <code>UPDATE 表名 SET 列名1=值1,列名2=值2,...[WHERE条件];</code><br/> <mark>修改语句中必须加条件，如果不加条件，则会将所有数据都修改</mark></li><li>删除表中的数据<br/> <code>DELETE FROM 表名 [WHERE 条件];</code><br/> <mark>删除语句中必须加条件，如果不加条件，则会将所有数据都删除</mark></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 修改手机价格为3500</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price<span class="token operator">=</span><span class="token number">3500</span> <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'手机'</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改电脑的价格为4800、库存为46</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price<span class="token operator">=</span><span class="token number">4800</span><span class="token punctuation">,</span> stock<span class="token operator">=</span><span class="token number">46</span> <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'电脑'</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除product 表中的空调信息</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'空调'</span><span class="token punctuation">;</span>
<span class="token comment">-- 删除product 表中库存为10的商品信息</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>
</code></pre>
<h3><a id="DQL_4108"></a>DQL</h3>
<h4><a id="_4110"></a>查询语法</h4>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span>
	字段列表
<span class="token keyword">FROM</span>
	表名列表
<span class="token keyword">WHERE</span>
	条件列表
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span>
	分组字段
<span class="token keyword">HAVING</span>
	分组后的过滤条件
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	排序
<span class="token keyword">LIMIT</span>
	分页
</code></pre>
<p><mark>这些语句不一定全部出现，但要按照上面的顺序</mark></p>
<h4><a id="_4131"></a>查询全部</h4>
<ul><li> <p>查询全部的表数据<br/> <code>SELECT * FROM 表名;</code></p> </li><li> <p>查询指定字段的表数据<br/> <code>SELECT 列名1,列名2,... FROM 表名;</code></p> </li><li> <p>去除重复查询<br/> <code>SELECT DISTINCT 列名1,列名2,... FROM 表名;</code></p> </li><li> <p>计算列的值（四则运算）<br/> <code>SELECT 列名1 运算符(+ - * /) 列名2 FROM 表名;</code></p>
<blockquote>
<p><mark>如果某一列为null，可以进行替换</mark>：<code>IFNULL (表达式1,表达式2)</code><br/> 表达式1：想替换的列<br/> 表达式2：想替换的值</p>
</blockquote> </li><li> <p>起别名查询<br/> <code>SELECT 列名 AS 别名 FROM 表名;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 准备数据（创建数据库以及表）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db1<span class="token punctuation">;</span>
<span class="token keyword">USE</span> db1<span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> product<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span><span class="token punctuation">,</span>			<span class="token comment">-- 商品编号</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">-- 商品名称</span>
	price <span class="token keyword">DOUBLE</span><span class="token punctuation">,</span>		<span class="token comment">-- 商品价格</span>
	brand <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">-- 商品品牌</span>
	stock <span class="token keyword">INT</span><span class="token punctuation">,</span>		<span class="token comment">-- 商品库存</span>
	insert_time <span class="token keyword">DATE</span> 	<span class="token comment">-- 添加时间</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加测试数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'华为手机'</span><span class="token punctuation">,</span> <span class="token number">5999</span><span class="token punctuation">,</span> <span class="token string">'华为'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'2018-03-10'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小米手机'</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token string">'小米'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'2019-02-10'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'苹果手机'</span><span class="token punctuation">,</span> <span class="token number">3999</span><span class="token punctuation">,</span> <span class="token string">'苹果'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token string">'2018-07-23'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'华为电脑'</span><span class="token punctuation">,</span> <span class="token number">4999</span><span class="token punctuation">,</span> <span class="token string">'华为'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">'2020-10-27'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'小米电脑'</span><span class="token punctuation">,</span> <span class="token number">5996</span><span class="token punctuation">,</span> <span class="token string">'小米'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">'2021-03-29'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'苹果电脑'</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token string">'苹果'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">'2022-02-26'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'联想电脑'</span><span class="token punctuation">,</span> <span class="token number">6999</span><span class="token punctuation">,</span> <span class="token string">'联想'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'2023-03-14'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 查询全部的表数据</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 查询指定字段的表数据（name、price、brand）</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span> price<span class="token punctuation">,</span> brand <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 查询品牌</span>
<span class="token keyword">SELECT</span> brand <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>
<span class="token comment">-- 查询品牌，去除重复</span>
<span class="token keyword">SELECT</span>	<span class="token keyword">DISTINCT</span> brand <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 查询商品名称和库存，库存数量在原有的基础上加10</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>stock<span class="token operator">+</span><span class="token number">10</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>
<span class="token comment">-- 查询商品名称和库存，库存数量在原有的基础上加10，进行null值判断</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>IFNULL<span class="token punctuation">(</span>stock<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>
<span class="token comment">-- 查询商品名称和库存，库存数量在原有的基础上加10，进行null值判断，起别名为getSum</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>IFNULL<span class="token punctuation">(</span>stock<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10</span> <span class="token keyword">AS</span> getSum <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>IFNULL<span class="token punctuation">(</span>stock<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">10</span> getSum <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>		<span class="token comment">-- 起别名时AS可以省略（空格隔开）</span>
</code></pre>
<h4><a id="_4196"></a>条件查询</h4>
<ul><li>查询条件分类</li></ul>
<table><thead><tr><th>符号</th><th>功能</th></tr></thead><tbody><tr><td>&gt;</td><td>大于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&gt;=</td><td>大于等于</td></tr><tr><td>&lt;=</td><td>小于等于</td></tr><tr><td>=</td><td>等于</td></tr><tr><td>&lt;&gt; 或 !=</td><td>不等于</td></tr><tr><td>BETWEEN…AND…</td><td>在某个范围之内（都包含）</td></tr><tr><td>IN(…)</td><td>多选…</td></tr><tr><td>LIKE 占位符</td><td>模糊查询；占位符<code>_</code>表示单个任意字符，<code>%</code>表示多个</td></tr><tr><td>IS NULL</td><td>是NULL</td></tr><tr><td>IS NOT NULL</td><td>不是 NULL</td></tr><tr><td>AND 或 &amp;&amp;</td><td>并且</td></tr><tr><td>OR 或 ||</td><td>或者</td></tr><tr><td>NOT 或 !</td><td>非，不是</td></tr></tbody></table>
<ul><li>条件查询语法<br/> <code>SELECT 列名列表 FROM 表名 WHERE 条件;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询库存大于20的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询品牌为华为的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> brand <span class="token operator">=</span> <span class="token string">'华为'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询金额在4000-6000之间的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> price <span class="token operator">&gt;</span> <span class="token number">4000</span> <span class="token operator">AND</span> price <span class="token operator">&lt;</span> <span class="token number">6000</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> price <span class="token operator">BETWEEN</span> <span class="token number">4000</span> <span class="token operator">AND</span> <span class="token number">6000</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询库存为14、30、23的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock <span class="token operator">=</span> <span class="token number">14</span> <span class="token operator">OR</span> stock <span class="token operator">=</span> <span class="token number">30</span> <span class="token operator">OR</span> stock <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询库存为null的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询库存不为null的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> stock <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询名称以小米为开头的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'小米%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询名称第二个字是为的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'_为%'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询名称为四个字符的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'____'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询名称中包含电脑的商品信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%电脑%'</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4254"></a>聚合函数查询</h4>
<ul><li> <p>聚合函数的介绍<br/> 将一列数据作为一个整体，进行纵向的计算</p> </li><li> <p>聚合函数分类</p>
<table><thead><tr><th>函数名</th><th>功能</th></tr></thead><tbody><tr><td>COUNT(列名)</td><td>统计数量（一般选用不为null的列）</td></tr><tr><td>MAX(列名)</td><td>最大值</td></tr><tr><td>MIN(列名)</td><td>最小值</td></tr><tr><td>SUM(列名)</td><td>求和</td></tr><tr><td>AVG(列名)</td><td>平均值</td></tr></tbody></table></li><li> <p>聚合函数查询语法<br/> <code>SELECT 函数名(列名) FROM 表名 [WHERE 条件];</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 计算product表中总记录条数</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 获取最高价格</span>
<span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 获取最低库存</span>
<span class="token keyword">SELECT</span> <span class="token function">MIN</span><span class="token punctuation">(</span>stock<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 获取总库存数量</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>stock<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 获取品牌为苹果的总库存数量</span>
<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>stock<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> brand <span class="token operator">=</span> <span class="token string">'苹果'</span><span class="token punctuation">;</span>

<span class="token comment">-- 获取品牌为小米的平均商品价格</span>
<span class="token keyword">SELECT</span> <span class="token function">AVG</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> brand <span class="token operator">=</span> <span class="token string">'小米'</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4292"></a>排序查询</h4>
<ul><li>排序查询语法<br/> <code>SELECT 列名列表 FROM 表名 [WHERE 条件] ORDER BY 列名 排序方式, 列名 排序方式, ...;</code></li><li>排序方式<br/> <mark>ASC</mark>升序【默认】<br/> <mark>DESC</mark>降序<br/> 如果有多个排序条件，只有当前面的条件值一样时，才会判断第二条件</li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 按照库存升序排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> stock <span class="token keyword">ASC</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询名称中包含手机的商品信息，按照金额降序排序</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> NAME <span class="token operator">LIKE</span> <span class="token string">'%手机%'</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">DESC</span><span class="token punctuation">;</span>

<span class="token comment">-- 按照金额升序排序，如果金额相同，按照库存降序排列</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> price <span class="token keyword">ASC</span><span class="token punctuation">,</span> stock <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4312"></a>分组查询</h4>
<ul><li> <p>分组查询语法</p> <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 列名列表 <span class="token keyword">FROM</span> 表名 <span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件<span class="token punctuation">]</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 分组列名
<span class="token punctuation">[</span><span class="token keyword">HAVING</span> 分组后的条件过滤<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 排序列名 排序方式<span class="token punctuation">]</span>
</code></pre> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 按照品牌分组，获取每组商品的总金额</span>
<span class="token keyword">SELECT</span> brand<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> brand<span class="token punctuation">;</span>

<span class="token comment">-- 对金额大于4000元的商品，按照品牌分组，获取每组商品的总金额</span>
<span class="token keyword">SELECT</span> brand<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> price <span class="token operator">&gt;</span> <span class="token number">4000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> brand<span class="token punctuation">;</span>

<span class="token comment">-- 对金额大于4000元的商品，按照品牌分组，获取每组商品的总金额，只显示总金额大于7000元的</span>
<span class="token keyword">SELECT</span> brand<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">AS</span> getsum <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> price <span class="token operator">&gt;</span> <span class="token number">4000</span> <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> brand <span class="token keyword">HAVING</span> getsum <span class="token operator">&gt;</span> <span class="token number">7000</span><span class="token punctuation">;</span>

<span class="token comment">-- 对金额大于4000元的商品，按照品牌分组，获取每组商品的总金额，只显示总金额大于7000元的，并按照总金额的降序进行排序</span>
<span class="token keyword">SELECT</span> brand<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token keyword">AS</span> getsum <span class="token keyword">FROM</span> product 
<span class="token keyword">WHERE</span> price <span class="token operator">&gt;</span> <span class="token number">4000</span> 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> brand 
<span class="token keyword">HAVING</span> getsum <span class="token operator">&gt;</span> <span class="token number">7000</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> getsum <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4340"></a>分页查询</h4>
<ul><li> <p>分页查询语法</p> <pre><code class="prism language-sql"><span class="token keyword">SELECT</span> 列名列表 <span class="token keyword">FROM</span> 表名
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> 条件<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">GROUP</span> <span class="token keyword">BY</span> 分组列名<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">HAVING</span> 分组后的条件过滤<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 排序列名 排序方式<span class="token punctuation">]</span>
<span class="token keyword">LIMIT</span> 当前页数<span class="token punctuation">,</span>每页显示的条数<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>当前页数 = (当前页数 - 1) * 每页显示的条数</p>
</blockquote> </li></ul>
<pre><code class="prism language-sql"><span class="token comment"># 每页显示3条数据</span>

<span class="token comment">-- 第一页 当前页数 = (1 - 1) * 3</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 第二页 当前页数 = (2 - 1) * 3</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">LIMIT</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 第三页 当前页数 = (3 - 1) * 3</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">LIMIT</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>LIMIT后的两个参数可以理解为：从几号索引开始，一页显示几个<br/> 故第一页：从0索引开始，显示3个（0，1，2）<br/> 第二页：从3索引开始，显示3个（3，4，5）<br/> 第三页：从6索引开始，显示3个（6，7，8）<br/> …</p>
</blockquote>
<h3><a id="_4374"></a>约束</h3>
<ul><li> <p>什么是约束<br/> 对表中的数据进行限定，保证数据的正确性、有效性、完整性</p> </li><li> <p>约束的分类</p>
<table><thead><tr><th>约束</th><th>作用</th></tr></thead><tbody><tr><td>PRIMARY KEY</td><td>主键约束</td></tr><tr><td>PRIMARY KEY AUTO_INCREMENT</td><td>主键自增</td></tr><tr><td>UNIQUE</td><td>唯一约束</td></tr><tr><td>NOT NULL</td><td>非空约束</td></tr><tr><td>FOREIGN KEY</td><td>外键约束</td></tr><tr><td>FOREIGN KEY ON UPDATE CASCADE</td><td>外键级联更新</td></tr><tr><td>FOREIGN KEY ON DELETE CASCADE</td><td>外键级联删除</td></tr></tbody></table></li></ul>
<h4><a id="_4391"></a>主键约束</h4>
<ul><li> <p>特点<br/> 主键约束默认包含非空和唯一两个功能<br/> 一张表只能有一个主键<br/> 主键一般用于表中数据的唯一标识</p> </li><li> <p>建表时添加主键约束</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名 数据类型 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    列名 数据类型 约束
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>删除主键约束<br/> <code>ALTER TABLE 表名 DROP PRIMARY KEY;</code></p> </li><li> <p>建表以后单独添加主键<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型 PRIMARY KEY;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建学生表(编号、姓名、年龄) 编号为主键</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询学生表的详细信息</span>
<span class="token keyword">DESC</span> students<span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">-- 添加失败，主键不能为空</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">-- 添加失败，主键唯一</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除主键</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>

<span class="token comment">-- 建表后单独添加主键约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">MODIFY</span> id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4438"></a>主键自增约束</h4>
<ul><li> <p>建表时添加主键自增约束</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名 数据类型 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    列名 数据类型 约束
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>添加自增约束之后，主键内容就可以写null，会自动进行加一操作</p>
</blockquote> </li><li> <p>删除主键自增约束<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型;</code></p> </li><li> <p>建表后单独添加主键自增约束<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型 AUTO_INCREMENT;</code></p> </li></ul>
<p><mark>MySQL中的自增约束，必须配合主键的约束一起来使用！</mark></p>
<pre><code class="prism language-sql"><span class="token comment">-- 创建学生表(编号、姓名、年龄) 编号设为主键自增</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> students<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询学生表的详细信息</span>
<span class="token keyword">DESC</span> students<span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> students <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除自增约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">MODIFY</span> id <span class="token keyword">INT</span><span class="token punctuation">;</span>		<span class="token comment">-- 只删除自增约束，不会删除主键约束</span>

<span class="token comment">-- 建表后单独添加自增约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> students <span class="token keyword">MODIFY</span> id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4481"></a>唯一约束</h4>
<ul><li> <p>建表时添加唯一约束</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名 数据类型 <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    列名 数据类型 约束
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>删除唯一约束<br/> <code>ALTER TABLE 表名 DROP INDEX 列名;</code></p> </li><li> <p>建表后单独添加唯一约束<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型 UNIQUE;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建学生表（编号、姓名、年龄）  编号设为主键自增，年龄设为唯一</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 查询学生表的详细信息</span>
<span class="token keyword">DESC</span> student<span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除唯一约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> student <span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> age<span class="token punctuation">;</span>

<span class="token comment">-- 建表后单独添加唯一约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> student <span class="token keyword">MODIFY</span> age <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4520"></a>非空约束</h4>
<ul><li> <p>建表时添加非空约束</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名 数据类型 <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    列名 数据类型 约束
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>删除非空约束<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型;</code></p> </li><li> <p>建表后单独添加非空约束<br/> <code>ALTER TABLE 表名 MODIFY 列名 数据类型 NOT NULL;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建学生表（编号、姓名、年龄）  编号设为主键自增，姓名设为非空，年龄设为唯一</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询学生表的详细信息</span>
<span class="token keyword">DESC</span> student<span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除非空约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> student <span class="token keyword">MODIFY</span> NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加非空约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> student <span class="token keyword">MODIFY</span> NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4558"></a>外键约束</h4>
<ul><li> <p>为什么要有外键约束？<br/> 当表与表之间的数据有相关联性的时候，如果没有相关的数据约束，则无法保证数据的准确性！<br/> 比如用户和订单，表与表之间也有关联</p> </li><li> <p>外键约束的作用<br/> 让表与表之间产生关联关系，从而保证数据的准确性！</p> </li><li> <p>建表时添加外键约束</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名{
	列名 数据类型 约束<span class="token punctuation">,</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">CONSTRAINT</span> 外键名 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>本表外键列名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主表主键列名<span class="token punctuation">)</span>
}<span class="token punctuation">;</span>
</code></pre> </li><li> <p>删除外键约束<br/> <code>ALTER TABLE 表名 DROP FOREIGN KEY 外键名;</code></p> </li><li> <p>建表后单独添加外键约束</p> <pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span>
<span class="token keyword">CONSTRAINT</span> 外键名 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>本表外键列名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主键列名<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>外键名一般取两个表的首字母_fk编号<br/> 例如：ou_fk1</p>
</blockquote> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 建表时添加外键约束</span>
<span class="token comment">-- 创建user表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> 		<span class="token comment">-- 姓名</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加用户数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">USER</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建orderlist订单表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orderlist<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- id</span>
	number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>		<span class="token comment">-- 订单编号</span>
	uid <span class="token keyword">INT</span><span class="token punctuation">,</span> 				<span class="token comment">-- 外键列</span>
	<span class="token keyword">CONSTRAINT</span> ou_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加订单数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'001'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'002'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'003'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'004'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加一个订单，但是没有真实用户,添加失败</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'005'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除李四用户，删除失败</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除外键约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> orderlist <span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> ou_fk1<span class="token punctuation">;</span> 

<span class="token comment">-- 添加外键约束</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> orderlist <span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> ou_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4624"></a>外键级联操作(了解)</h4>
<ul><li>什么是级联更新<br/> 当对主表中的数据进行修改时，从表中有关联的数据也会随之修改</li><li>什么是级联删除<br/> 当主表中的数据删除时，从表中的数据也会随之删除</li></ul>
<blockquote>
<p>级联操作在真实开发中很少使用，因为它耦合性太强，牵一发动全身</p>
</blockquote>
<ul><li> <p>添加级联更新</p> <pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span>
<span class="token keyword">CONSTRAINT</span> 外键名 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>本表外键列名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主键列名<span class="token punctuation">)</span>
<span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>添加级联删除</p> <pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span>
<span class="token keyword">CONSTRAINT</span> 外键名 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>本表外键列名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主键列名<span class="token punctuation">)</span>
<span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>同时添加级联更新和级联删除</p> <pre><code class="prism language-sql"><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> 表名 <span class="token keyword">ADD</span>
<span class="token keyword">CONSTRAINT</span> 外键名 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>本表外键列名<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> 主表名<span class="token punctuation">(</span>主键列名<span class="token punctuation">)</span>
<span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>
</code></pre> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 添加外键约束，同时添加级联更新和级联删除</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> orderlist <span class="token keyword">ADD</span>
<span class="token keyword">CONSTRAINT</span> ou_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">;</span>

<span class="token comment">-- 将李四这个用户id修改为3,订单表中的uid也自动修改</span>
<span class="token keyword">UPDATE</span> <span class="token keyword">USER</span> <span class="token keyword">SET</span> id<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 将李四这个用户删除，订单表中的该用户所属的订单也自动修改</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> id<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>
</code></pre>
<h3><a id="_4670"></a>多表操作</h3>
<ul><li>多表概念<br/> 通俗的讲就是多张数据表，而表与表之间是可以有一定的关联关系，这种关联关系通过外键约束实现。</li><li>多表的分类<br/> 一对一<br/> 一对多<br/> 多对多</li></ul>
<h4><a id="_4679"></a>一对一</h4>
<ul><li>适用场景<br/> 例如人和身份证。一个人只有一个身份证，一个身份证只能对应一个人</li><li>建表原则<br/> 在任意一个表建立外键，去关联另外一个表的主键</li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db5数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db5<span class="token punctuation">;</span>

<span class="token comment">-- 使用db5数据库</span>
<span class="token keyword">USE</span> db5<span class="token punctuation">;</span>

<span class="token comment">-- 创建person表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> person<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>			<span class="token comment">-- 姓名</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> person <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建card表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> card<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>		<span class="token comment">-- 主键id</span>
	number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">UNIQUE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>		<span class="token comment">-- 身份证号</span>
	pid <span class="token keyword">INT</span> <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>					<span class="token comment">-- 外键列</span>
	<span class="token keyword">CONSTRAINT</span> cp_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>pid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> person<span class="token punctuation">(</span>id<span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> card <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'12345'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'56789'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4714"></a>一对多</h4>
<ul><li>适用场景<br/> 用户和订单。一个用户可以有多个订单<br/> 商品分类和商品。一个分类下可以有多个商品</li><li>建表原则<br/> 在多的一方，建立外键约束，来关联一的一方主键</li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建user表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>			<span class="token comment">-- 姓名</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">USER</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建orderlist表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orderlist<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 订单编号</span>
	uid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键链</span>
	<span class="token keyword">CONSTRAINT</span> ou_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'001'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'002'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'003'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'004'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4744"></a>多对多</h4>
<ul><li>适用场景<br/> 学生和课程。一个学生可以选择多个课程，一个课程也可以被多个学生选择</li><li>建表原则<br/> 需要借助第三张中间表，中间表至少包含两个列。这两个列作为中间表的外键，分别关联两张表的主键</li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建student表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>			<span class="token comment">-- 姓名</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建course表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> course<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>			<span class="token comment">-- 课程名称</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'高数'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'线代'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建中间表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> stu_course<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 主键id</span>
	sid <span class="token keyword">INT</span><span class="token punctuation">,</span>	<span class="token comment">-- 用于和student表中的id进行外键关联</span>
	cid <span class="token keyword">INT</span><span class="token punctuation">,</span>	<span class="token comment">-- 用于和course表中的id进行外键关联</span>
	<span class="token keyword">CONSTRAINT</span> sc_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>sid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> student<span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">-- 添加外键约束</span>
	<span class="token keyword">CONSTRAINT</span> sc_fk2 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> course<span class="token punctuation">(</span>id<span class="token punctuation">)</span>	<span class="token comment">-- 添加外键约束</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> stu_course <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_4783"></a>多表查询</h4>
<p><strong>多表查询分类</strong></p>
<ul><li> <p>内连接查询</p> </li><li> <p>外连接查询</p> </li><li> <p>子查询</p> </li><li> <p>自关联查询</p> </li></ul>
<p><strong>数据准备</strong></p>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db4数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db4<span class="token punctuation">;</span>

<span class="token comment">-- 使用db4数据库</span>
<span class="token keyword">USE</span> db4<span class="token punctuation">;</span>

<span class="token comment">-- 创建user表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 用户id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 用户姓名</span>
	age <span class="token keyword">INT</span>					<span class="token comment">-- 用户年龄</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">USER</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 订单表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orderlist<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 订单id</span>
	number <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 订单编号</span>
	uid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键字段</span>
	<span class="token keyword">CONSTRAINT</span> ou_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'001'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'002'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'003'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'004'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'005'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'006'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orderlist <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'007'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 商品分类表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> category<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 商品分类id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>			<span class="token comment">-- 商品分类名称</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> category <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'手机数码'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'电脑办公'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'烟酒茶糖'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'鞋靴箱包'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 商品表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> product<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 商品id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 商品名称</span>
	cid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键字段</span>
	<span class="token keyword">CONSTRAINT</span> cp_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> category<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token keyword">VALUES</span> 
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'华为手机'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'小米手机'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'联想电脑'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'苹果电脑'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'中华香烟'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'玉溪香烟'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token string">'计生用品'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 中间表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> us_pro<span class="token punctuation">(</span>
	upid <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 中间表id</span>
	uid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键字段，需要和用户表的主键产生关联</span>
	pid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键字段，需要和商品表的主键产生关联</span>
	<span class="token keyword">CONSTRAINT</span> up_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>uid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token keyword">USER</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">CONSTRAINT</span> up_fk2 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>pid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> product<span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> us_pro <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>内连接查询</strong></p>
<ul><li>查询原理<br/> 内连接查询的是两张表有交集的部分数据（有主外键关联的数据）</li><li>查询语法<br/> 显示内连接：<code>SELECT 列名 FROM 表名1 [INNER] JOIN 表名2 ON 条件;</code><br/> 隐式内连接：<code>SELECT 列名 FROM 表名1,表名2 WHERE 条件;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	显示内连接
*/</span>

<span class="token comment">-- 查询用户信息和他对应的订单信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> orderlist <span class="token keyword">ON</span> orderlist<span class="token punctuation">.</span>uid <span class="token operator">=</span> <span class="token keyword">user</span><span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- 查询用户信息和对应的订单信息，起别名</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> u <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> orderlist o <span class="token keyword">ON</span> o<span class="token punctuation">.</span>uid <span class="token operator">=</span> u<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- 查询用户姓名、年龄和订单号</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span>name<span class="token punctuation">,</span>		<span class="token comment">-- 用户姓名</span>
	u<span class="token punctuation">.</span>age<span class="token punctuation">,</span>		<span class="token comment">-- 用户年龄</span>
	o<span class="token punctuation">.</span>number	<span class="token comment">-- 订单编号</span>
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u 		<span class="token comment">-- 用户表</span>
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>
	orderlist o 	<span class="token comment">-- 订单表</span>
<span class="token keyword">ON</span>
	o<span class="token punctuation">.</span>uid <span class="token operator">=</span> u<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
	
<span class="token comment">/*
	隐式内连接
*/</span>

<span class="token comment">-- 查询用户姓名，年龄，订单编号</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span>name<span class="token punctuation">,</span>		<span class="token comment">-- 用户姓名</span>
	u<span class="token punctuation">.</span>age<span class="token punctuation">,</span>		<span class="token comment">-- 用户年龄</span>
	o<span class="token punctuation">.</span>number	<span class="token comment">-- 订单编号</span>
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u<span class="token punctuation">,</span>
	orderlist o
<span class="token keyword">WHERE</span>
	o<span class="token punctuation">.</span>uid<span class="token operator">=</span>u<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<p><strong>外连接查询</strong></p>
<ul><li> <p>左外连接</p>
<ul><li>查询原理<br/> 查询左表的全部数据，和左右两张表有交集部分的数据</li><li>查询语法<br/> <code>SELECT 列名 FROM 表名1 LEFT [OUTER] JOIN 表名2 ON 条件;</code></li></ul> </li><li> <p>右外连接</p>
<ul><li>查询原理<br/> 查询右表的全部数据，和左右两张表有交集部分的数据</li><li>查询语法<br/> <code>SELECT 列名 FROM 表名1 RIGHT [OUTER] JOIN 表名2 ON 条件;</code></li></ul> <pre><code class="prism language-sql"><span class="token comment">-- 查询所有用户信息，以及用户对应的订单信息</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	orderlist o
<span class="token keyword">ON</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
	
<span class="token comment">-- 所有订单信息，以及订单所属的用户信息</span>
<span class="token keyword">SELECT</span>
	o<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	u<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u
<span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	orderlist o
<span class="token keyword">ON</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
</code></pre> </li></ul>
<p><strong>子查询</strong></p>
<ul><li>概念<br/> 查询语句中嵌套了查询语句，我们就将嵌套的查询称为子查询</li><li>结果是单行单列的 
  <ul><li>查询作用<br/> 可以将查询的结果作为另一条语句的查询条件，使用运算符判断（=、&gt;、&gt;=、&lt;、&lt;=de等）</li><li>查询语法<br/> <code>SELECT 列名 FROM 表名 WHERE 列名=(SELECT 列名 FROM 表名 [WHERE 条件]);</code></li></ul> </li><li>结果是多行单列的 
  <ul><li>查询作用<br/> 可以作为条件，使用运算符 IN 或 NOT IN 进行判断</li><li>查询语法<br/> <code>SELECT 列名 FROM 表名 WHERE 列名 [NOT] IN (SELECT 列名 FROM 表名 [WHERE 条件]);</code></li></ul> </li><li>结果是多行多列的 
  <ul><li>查询作用<br/> 查询的结果可以作为一张虚拟表参与查询</li><li>查询语法<br/> <code>SELECT 列名 FROM 表名 [别名], (SELECT 列名 FROM 表名 [WHERE 条件] [别名] [WHERE 条件]);</code></li></ul> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询年龄最高的用户姓名</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>age <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> age<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询张三和李四的订单信息</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orderlist <span class="token keyword">WHERE</span> uid <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> id <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询订单表中id大于4的订单信息和所属用户信息</span>
<span class="token keyword">SELECT</span>
	o<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
	u<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> orderlist <span class="token keyword">WHERE</span> id <span class="token operator">&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> o
<span class="token keyword">ON</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
</code></pre>
<p><strong>自关联查询</strong></p>
<ul><li>概念<br/> 在同一张表中数据有关联性，我们可以把这张表当成多个表来查询</li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建员工表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> employee<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 员工编号</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 员工姓名</span>
	mgr <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 上级编号</span>
	salary <span class="token keyword">DOUBLE</span>				<span class="token comment">-- 员工工资</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> employee <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">'孙悟空'</span><span class="token punctuation">,</span> <span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">9000.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1002</span><span class="token punctuation">,</span> <span class="token string">'猪八戒'</span><span class="token punctuation">,</span> <span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">8000.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">'沙和尚'</span><span class="token punctuation">,</span> <span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">8500.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1004</span><span class="token punctuation">,</span> <span class="token string">'小白龙'</span><span class="token punctuation">,</span> <span class="token number">1005</span><span class="token punctuation">,</span> <span class="token number">7900.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1005</span><span class="token punctuation">,</span> <span class="token string">'唐僧'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">15000.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1006</span><span class="token punctuation">,</span> <span class="token string">'武松'</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">7600.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1007</span><span class="token punctuation">,</span> <span class="token string">'李逵'</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">7400.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1008</span><span class="token punctuation">,</span> <span class="token string">'林冲'</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">8100.00</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">1009</span><span class="token punctuation">,</span> <span class="token string">'宋江'</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">16000.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询所有员工的姓名及其直接上级的姓名，没有上级的员工也需要查询</span>
<span class="token keyword">SELECT</span>
	e1<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	e1<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	e1<span class="token punctuation">.</span>mgr<span class="token punctuation">,</span>
	e2<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	e2<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	employee e1
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	employee e2
<span class="token keyword">ON</span>
	e1<span class="token punctuation">.</span>mgr<span class="token operator">=</span>e2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5036"></a>练习</h4>
<ol><li>查询用户的编号、姓名、年龄、订单编号</li><li>查询所有的用户。用户的编号、姓名、年龄、订单编号</li><li>查询所有的订单。用户的编号、姓名、年龄、订单编号</li><li>查询用户年龄大于23岁的信息。显示用户的编号、姓名、年龄、订单编号</li><li>查询张三和李四用户的信息。显示用户的编号、姓名、年龄、订单编号</li><li>查询商品分类的编号、分类名称、分类下的商品名称</li><li>查询所有的商品分类。商品分类的编号、分类名称、分类下的商品名称</li><li>查询所有的商品信息。商品分类的编号、分类名称、分类下的商品名称</li><li>查询所有的用户和所有的商品。显示用户的编号、姓名、年龄、商品名称</li><li>查询张三和李四这两个用户可以看到的商品。显示用户的编号、姓名、年龄、商品名称</li></ol>
<pre><code class="prism language-sql"><span class="token comment">-- 1.查询用户的编号、姓名、年龄、订单编号</span>
<span class="token keyword">SELECT</span> 
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number 
<span class="token keyword">FROM</span> 
	<span class="token keyword">USER</span> <span class="token keyword">AS</span> u 
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> 
	orderlist <span class="token keyword">AS</span> o 
<span class="token keyword">ON</span> 
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>

<span class="token comment">-- 2.查询所有的用户。用户的编号、姓名、年龄、订单编号</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	orderlist o
<span class="token keyword">ON</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>

<span class="token comment">-- 3.查询所有的订单。用户的编号、姓名、年龄、订单编号</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u
<span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	orderlist o
<span class="token keyword">ON</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>

<span class="token comment">-- 4.查询用户年龄大于23岁的信息。显示用户的编号、姓名、年龄、订单编号</span>
<span class="token comment"># 方式1</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> age<span class="token operator">&gt;</span><span class="token number">23</span><span class="token punctuation">)</span> u<span class="token punctuation">,</span>
	orderlist o
<span class="token keyword">WHERE</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
<span class="token comment"># 方式2</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u<span class="token punctuation">,</span>
	orderlist o
<span class="token keyword">WHERE</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid
	<span class="token operator">AND</span>
	u<span class="token punctuation">.</span>age <span class="token operator">&gt;</span> <span class="token number">23</span><span class="token punctuation">;</span>


<span class="token comment">-- 5.查询张三和李四用户的信息。显示用户的编号、姓名、年龄、订单编号</span>
<span class="token comment"># 方式1</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> u<span class="token punctuation">,</span>
	orderlist o
<span class="token keyword">WHERE</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">;</span>
<span class="token comment"># 方式2</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	o<span class="token punctuation">.</span>number
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u<span class="token punctuation">,</span>
	orderlist o
<span class="token keyword">WHERE</span>
	u<span class="token punctuation">.</span>id<span class="token operator">=</span>o<span class="token punctuation">.</span>uid
	<span class="token operator">AND</span>
	u<span class="token punctuation">.</span>name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token comment">-- 6.查询商品分类的编号、分类名称、分类下的商品名称</span>
<span class="token comment"># 方式1</span>
<span class="token keyword">SELECT</span>
	c<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	c<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	category c
<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span>
	product p
<span class="token keyword">ON</span>
	c<span class="token punctuation">.</span>id<span class="token operator">=</span>p<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>
<span class="token comment"># 方式2</span>
<span class="token keyword">SELECT</span>
	c<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	category c<span class="token punctuation">,</span>
	product p
<span class="token keyword">WHERE</span>
	c<span class="token punctuation">.</span>id<span class="token operator">=</span>p<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>

<span class="token comment">-- 7.查询所有的商品分类。商品分类的编号、分类名称、分类下的商品名称</span>
<span class="token keyword">SELECT</span>
	c<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	category c
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	product p
<span class="token keyword">ON</span>
	c<span class="token punctuation">.</span>id<span class="token operator">=</span>p<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>

<span class="token comment">-- 8.查询所有的商品信息。商品分类的编号、分类名称、分类下的商品名称</span>
<span class="token keyword">SELECT</span>
	c<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	category c
<span class="token keyword">RIGHT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span>
	product p
<span class="token keyword">ON</span>
	c<span class="token punctuation">.</span>id<span class="token operator">=</span>p<span class="token punctuation">.</span>cid<span class="token punctuation">;</span>

<span class="token comment">-- 9.查询所有的用户和所有的商品。显示用户的编号、姓名、年龄、商品名称</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	<span class="token keyword">USER</span> u<span class="token punctuation">,</span>
	product p<span class="token punctuation">,</span>
	us_pro up
<span class="token keyword">WHERE</span>
	up<span class="token punctuation">.</span>uid<span class="token operator">=</span>u<span class="token punctuation">.</span>id
	<span class="token operator">AND</span>
	up<span class="token punctuation">.</span>pid<span class="token operator">=</span>p<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- 10.查询张三和李四这两个用户可以看到的商品。显示用户的编号、姓名、年龄、商品名称</span>
<span class="token keyword">SELECT</span>
	u<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	u<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	u<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
	p<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	<span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">USER</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> u<span class="token punctuation">,</span>
	product p<span class="token punctuation">,</span>
	us_pro up
<span class="token keyword">WHERE</span>
	up<span class="token punctuation">.</span>uid<span class="token operator">=</span>u<span class="token punctuation">.</span>id
	<span class="token operator">AND</span>
	up<span class="token punctuation">.</span>pid<span class="token operator">=</span>p<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre>
<h3><a id="_5201"></a>视图</h3>
<ul><li>视图：是一种虚拟存在的数据表，这个数据表并不在数据库中实际存在</li><li>作用：将一些较为复杂的查询语句的结果，封装到一个虚拟表中，后期再有相同需求时，直接查询该虚拟表即可</li></ul>
<h4><a id="_5206"></a>数据准备</h4>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db5数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db5<span class="token punctuation">;</span>

<span class="token comment">-- 使用db5数据库</span>
<span class="token keyword">USE</span> db5<span class="token punctuation">;</span>

<span class="token comment">-- 创建country表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> country<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 国家id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>			<span class="token comment">-- 国家名称</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> country <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'中国'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'美国'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'俄罗斯'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建city表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> city<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 城市id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 城市名称</span>
	cid <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 外键列</span>
	<span class="token keyword">CONSTRAINT</span> cc_fk1 <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>cid<span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> country<span class="token punctuation">(</span>id<span class="token punctuation">)</span>	<span class="token comment">-- 添加外键约束</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> city <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'纽约'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'莫斯科'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5236"></a>创建和查询</h4>
<ul><li>创建视图语法<br/> <code>CREATE VIEW 视图名称 [(列表列名)] AS 查询语句;</code></li><li>查询视图语法<br/> <code>SELECT * FROM 视图名称;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建city_country视图，保存城市和国家的信息（使用指定列名）</span>
<span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> city_country <span class="token punctuation">(</span>city_id<span class="token punctuation">,</span> city_name<span class="token punctuation">,</span> country_name<span class="token punctuation">)</span> <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span>
	c1<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	c1<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	c2<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	city c1<span class="token punctuation">,</span>
	country c2
<span class="token keyword">WHERE</span>
	c1<span class="token punctuation">.</span>cid<span class="token operator">=</span>c2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">-- 查询视图</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> city_country<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5260"></a>修改和删除</h4>
<ul><li> <p>修改视图数据语法<br/> <code>UPDATE 视图名称 SET 列名=值 WHERE 条件;</code></p> </li><li> <p>修改视图结构语法<br/> <code>ALTER VIEW 视图名称 (列名列表) AS 查询语句;</code></p> </li><li> <p>删除视图语法<br/> <code>DROP VIEW [IF EXISTS] 视图名称;</code></p> </li></ul>
<blockquote>
<p>注意：修改视图数据后，原表数据也会随之修改</p>
</blockquote>
<pre><code class="prism language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> city_country<span class="token punctuation">;</span>
<span class="token comment">-- 修改视图数据，将北京修改为深圳</span>
<span class="token keyword">UPDATE</span> city_country <span class="token keyword">SET</span> city_name<span class="token operator">=</span><span class="token string">'深圳'</span> <span class="token keyword">WHERE</span> city_name<span class="token operator">=</span><span class="token string">'北京'</span><span class="token punctuation">;</span>

<span class="token comment">-- 将视图中的country_name修改为name</span>
<span class="token keyword">ALTER</span> <span class="token keyword">VIEW</span> city_country <span class="token punctuation">(</span>city_id<span class="token punctuation">,</span> city_name<span class="token punctuation">,</span> NAME<span class="token punctuation">)</span> <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span>
	c1<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
	c1<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
	c2<span class="token punctuation">.</span>name
<span class="token keyword">FROM</span>
	city c1<span class="token punctuation">,</span>
	country c2
<span class="token keyword">WHERE</span>
	c1<span class="token punctuation">.</span>cid<span class="token operator">=</span>c2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
	
<span class="token comment">-- 删除视图</span>
<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> city_country<span class="token punctuation">;</span>
</code></pre>
<h3><a id="_5293"></a>数据库备份和恢复</h3>
<p><strong>命令行方式</strong></p>
<ul><li> <p>备份<br/> 登录到MySQL服务器，输入：<code>mysqldump -u root -p 数据库名称 &gt; 文件保存路径</code></p> <pre><code class="prism language-shell">mysqldump -u root -p db5 <span class="token operator">&gt;</span> /root/db5.sql
</code></pre> </li><li> <p>恢复</p>
<ol><li>登录MySQL数据库：<code>mysql -u root -p</code></li><li>删除已备份的数据库：<code>DROP DATABASE db5;</code></li><li>重新创建名称相同的数据库：<code>CREATE DATABASE db5;</code></li><li>使用该数据库：<code>USE db5;</code></li><li>导入文件执行：<code>source 备份文件全路径;</code></li></ol> </li></ul>
<blockquote>
<p>所谓的备份，就是将一些sql语句存储起来，恢复就是执行这些sql语句，重新创建数据库中的内容</p>
</blockquote>
<p><strong>图形化界面方式</strong></p>
<blockquote>
<p>这个方法比较简单，选中需要操作的数据库右键选择备份即可<br/> 恢复的时候删除原数据库再重新创建，然后选中新建的这个数据库，右键导入即可</p>
</blockquote>
<h3><a id="_5320"></a>存储过程和函数</h3>
<ul><li>存储过程和函数是事先经过编译并存储在数据库中的一段SQL语句的集合</li><li>存储过程和函数的好处 
  <ul><li>提高代码的复用性</li><li>减少数据在数据库和应用服务器之间的传输，提高效率</li><li>减少代码层面的业务处理</li></ul> </li><li>存储过程和函数的区别 
  <ul><li>存储函数必须有返回值</li><li>存储过程可以没有返回值</li></ul> </li></ul>
<h4><a id="_5331"></a>创建和调用</h4>
<ul><li> <p>创建存储过程</p> <pre><code class="prism language-sql"><span class="token comment">-- 修改结束分隔符</span>
<span class="token keyword">DELIMITER</span> $

<span class="token comment">-- 创建存储过程</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名称<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SQL</span> 语句列表<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token comment">-- 修改结束分隔符</span>
<span class="token keyword">DELIMITER</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>调用存储过程<br/> <code>CALL 存储过程名称(实际参数);</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 数据准备</span>

<span class="token comment">-- 创建db6数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db6<span class="token punctuation">;</span>

<span class="token comment">-- 使用db6数据库</span>
<span class="token keyword">USE</span> db6<span class="token punctuation">;</span>

<span class="token comment">-- 创建学生表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 学生id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 学生姓名</span>
	age <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 学生年龄</span>
	gender <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 学生性别</span>
	score <span class="token keyword">INT</span> 				<span class="token comment">-- 学生成绩</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 按照性别进行分组，查询每组学生的总成绩。按照总成绩的升序排序</span>
<span class="token keyword">SELECT</span> gender<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> getsum <span class="token keyword">FROM</span> student <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> gender <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> getsum <span class="token keyword">ASC</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">-- 创建stu_group() 存储过程，封装 分组查询总成绩，并按照总成绩升序排序的功能</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> stu_group<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SELECT</span> gender<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> getsum <span class="token keyword">FROM</span> student <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> gender <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> getsum <span class="token keyword">ASC</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用存储过程</span>
<span class="token keyword">CALL</span> stu_group<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5394"></a>查看和删除</h4>
<ul><li>查看数据库中所有的存储过程<br/> <code>SELECT * FROM mysql.proc WHERE db='数据库名称';</code></li><li>删除存储过程<br/> <code>DROP PROCEDURE [IF EXISTS] 存储过程名称;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查看db6数据库中所有的存储过程</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">proc</span> <span class="token keyword">WHERE</span> db<span class="token operator">=</span><span class="token string">'db6'</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除存储过程</span>
<span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> stu_group<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5409"></a>变量</h4>
<ul><li>定义变量<br/> <code>DECLARE 变量名 数据类型 [DEFAULT 默认值];</code></li><li>变量赋值方式一<br/> <code>SET 变量名=变量值;</code></li><li>变量赋值方式二<br/> <code>SELECT 列名 INTO 变量名 FROM 表名 [WHERE 条件];</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 定义一个int类型变量，并赋默认值为10</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义变量</span>
	<span class="token keyword">DECLARE</span> num <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">10</span><span class="token punctuation">;</span>
	<span class="token comment">-- 使用变量</span>
	<span class="token keyword">SELECT</span> num<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用pro_test1存储过程</span>
<span class="token keyword">CALL</span> pro_test1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/*
	变量赋值
*/</span>

<span class="token comment">-- 定义一个varchar类型变量并赋值</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test2<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义变量</span>
	<span class="token keyword">DECLARE</span> NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">-- 为变量赋值</span>
	<span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'存储过程'</span><span class="token punctuation">;</span>
	<span class="token comment">-- 使用变量</span>
	<span class="token keyword">SELECT</span> NAME<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用pro_test2存储过程</span>
<span class="token keyword">CALL</span> pro_test2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">-- 定义两个int类型的变量，用于存储男女同学的总分数</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test3<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义两个变量</span>
	<span class="token keyword">DECLARE</span> men<span class="token punctuation">,</span>women <span class="token keyword">INT</span><span class="token punctuation">;</span>
	<span class="token comment">-- 为变量赋值</span>
	<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">INTO</span> men <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> gender <span class="token operator">=</span> <span class="token string">'男'</span><span class="token punctuation">;</span>
	<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">INTO</span> women <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> gender <span class="token operator">=</span> <span class="token string">'女'</span><span class="token punctuation">;</span>
	<span class="token comment">-- 使用变量</span>
	<span class="token keyword">SELECT</span> men<span class="token punctuation">,</span>women<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用pro_test3</span>
<span class="token keyword">CALL</span> pro_test3<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="if_5479"></a>if语句</h4>
<ul><li> <p>if语句标准语法</p> <pre><code class="prism language-sql"><span class="token keyword">IF</span> 判断条件<span class="token number">1</span> <span class="token keyword">THEN</span> 执行的<span class="token keyword">sql</span>语句<span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token keyword">ELSEIF</span> 判断条件<span class="token number">2</span> <span class="token keyword">THEN</span> 执行的<span class="token keyword">sql</span>语句<span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">]</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token keyword">ELSE</span> 执行的<span class="token keyword">sql</span>语句n<span class="token punctuation">;</span><span class="token punctuation">]</span>
<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
</code></pre> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	定义一个int类型的变量，用于存储班级总成绩
	定义一个varchar变量，用于存储分数描述
	根据总成绩判断：
		380分以上	学习优秀
		320~380		学习不错
		320以下		学习一般
*/</span>

<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test4<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义变量</span>
	<span class="token keyword">DECLARE</span> total <span class="token keyword">INT</span><span class="token punctuation">;</span>
	<span class="token keyword">DECLARE</span> info <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">-- 查询班级总成绩为total赋值</span>
	<span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">INTO</span> total <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>
	<span class="token comment">-- 判断</span>
	<span class="token keyword">IF</span> total <span class="token operator">&gt;=</span> <span class="token number">380</span> <span class="token keyword">THEN</span>
		<span class="token keyword">SET</span> info <span class="token operator">=</span> <span class="token string">'学习优秀'</span><span class="token punctuation">;</span>
	<span class="token keyword">ELSEIF</span> total <span class="token operator">BETWEEN</span> <span class="token number">320</span> <span class="token operator">AND</span> <span class="token number">380</span> <span class="token keyword">THEN</span> 
		<span class="token keyword">SET</span> info <span class="token operator">=</span> <span class="token string">'学习不错'</span><span class="token punctuation">;</span>
	<span class="token keyword">ELSE</span>
		<span class="token keyword">SET</span> info <span class="token operator">=</span> <span class="token string">'学习一般'</span><span class="token punctuation">;</span>
	<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
	<span class="token comment">-- 使用变量</span>
	<span class="token keyword">SELECT</span> total<span class="token punctuation">,</span>info<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用pro_test4</span>
<span class="token keyword">CALL</span> pro_test4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5528"></a>参数传递</h4>
<ul><li> <p>存储过程的参数和返回值</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> 存储过程名称<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">IN</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">OUT</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">INOUT</span><span class="token punctuation">]</span> 参数名 数据类型<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SQL</span>语句列表<span class="token punctuation">;</span>
<span class="token keyword">END</span>$
</code></pre>
<blockquote>
<p>IN：代表输入参数，需要由调用者传递实际数据（默认）<br/> OUT：代表输出参数，该参数可以作为返回值<br/> INOUT：代表既可以作为输入参数，也可以作为输出参数</p>
</blockquote> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	输入总成绩变量，代表学生总成绩
	输出分数描述变量，代表学生总成绩的描述信息
	根据总成绩判断
		380分及以上	学习优秀
		320~380		学习不错
		320分及以下	学习一般
*/</span>

<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test5<span class="token punctuation">(</span><span class="token operator">IN</span> total <span class="token keyword">INT</span><span class="token punctuation">,</span><span class="token keyword">OUT</span> info <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 对总成绩判断</span>
	<span class="token keyword">IF</span> total <span class="token operator">&gt;=</span> <span class="token number">380</span> <span class="token keyword">THEN</span>
		<span class="token keyword">SET</span> info <span class="token operator">=</span> <span class="token string">'学习优秀'</span><span class="token punctuation">;</span>
	<span class="token keyword">ELSEIF</span> total <span class="token operator">BETWEEN</span> <span class="token number">320</span> <span class="token operator">AND</span> <span class="token number">380</span> <span class="token keyword">THEN</span>
		<span class="token keyword">SET</span> info <span class="token operator">=</span> <span class="token string">'学习不错'</span><span class="token punctuation">;</span>
	<span class="token keyword">ELSE</span>
		<span class="token keyword">SET</span> INFO <span class="token operator">=</span> <span class="token string">'学习一般'</span><span class="token punctuation">;</span>
	<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用存储过程</span>
<span class="token keyword">CALL</span> pro_test5<span class="token punctuation">(</span><span class="token number">383</span><span class="token punctuation">,</span> <span class="token variable">@info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">CALL</span> pro_test5<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">SUM</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token keyword">FROM</span> student<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">@info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SELECT</span> <span class="token variable">@info</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="while_5577"></a>while循环</h4>
<ul><li> <p>while 循环语法</p> <pre><code class="prism language-sql">初始化语句<span class="token punctuation">;</span>
<span class="token keyword">WHILE</span> 条件判断语句 <span class="token keyword">DO</span>
	循环体语句<span class="token punctuation">;</span>
	条件控制语句<span class="token punctuation">;</span>
<span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span>
</code></pre> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 计算1~100之间的偶数和</span>

<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> pro_test6<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义求和变量</span>
	<span class="token keyword">DECLARE</span> result <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token comment">-- 定义初始化变量</span>
	<span class="token keyword">DECLARE</span> num <span class="token keyword">INT</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token comment">-- while 循环</span>
	<span class="token keyword">WHILE</span> num <span class="token operator">&lt;=</span> <span class="token number">100</span> <span class="token keyword">DO</span>
		<span class="token keyword">IF</span> num <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">THEN</span>
			<span class="token keyword">SET</span> result <span class="token operator">=</span> result <span class="token operator">+</span> num<span class="token punctuation">;</span>
		<span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>
		
		<span class="token keyword">SET</span> num <span class="token operator">=</span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">END</span> <span class="token keyword">WHILE</span><span class="token punctuation">;</span>
	<span class="token comment">-- 查询求和结果</span>
	<span class="token keyword">SELECT</span> result<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用存储过程</span>
<span class="token keyword">CALL</span> pro_test6<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5618"></a>存储函数</h4>
<ul><li> <p>存储函数和存储过程是非常相似的，区别在于存储函数必须有返回值</p> </li><li> <p>创建存储函数</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> 函数名称<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> 返回值类型
<span class="token keyword">BEGIN</span>
		<span class="token keyword">SQL</span>语句列表<span class="token punctuation">;</span>
		<span class="token keyword">RETURN</span> 结果<span class="token punctuation">;</span>
<span class="token keyword">END</span>$
</code></pre> </li><li> <p>调用存储函数<br/> <code>SELECT 函数名称(实际参数);</code></p> </li><li> <p>删除函数<br/> <code>DROP FUNCTION 函数名称;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 定义存储函数，获取学生表中成绩大于95分的学生数量</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> fun_test<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">INT</span>
<span class="token keyword">BEGIN</span>
	<span class="token comment">-- 定义变量</span>
	<span class="token keyword">DECLARE</span> s_count <span class="token keyword">INT</span><span class="token punctuation">;</span>
	<span class="token comment">-- 查询数量并赋值</span>
	<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">INTO</span> s_count <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> score <span class="token operator">&gt;</span> <span class="token number">95</span><span class="token punctuation">;</span>
	<span class="token comment">-- 返回</span>
	<span class="token keyword">RETURN</span> s_count<span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 调用函数</span>
<span class="token keyword">SELECT</span> fun_test<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除函数</span>
<span class="token keyword">DROP</span> <span class="token keyword">FUNCTION</span> fun_test<span class="token punctuation">;</span>
</code></pre>
<h3><a id="_5663"></a>触发器</h3>
<ul><li> <p>触发器是与表有关的数据库对象，可以在insert、update、delete 之前或之后触发并执行触发器中定义的SQL语句</p> </li><li> <p>这种特性可以协助应用系统在数据库端确保数据的完整性、日志记录、数据校验等操作</p> </li><li> <p>可以使用别名 <code>NEW</code> 或者 <code>OLD</code>来引用触发器中发生变化的内容记录</p> </li><li> <p>触发器分类</p> </li></ul>
<table><thead><tr><th>触发器类型</th><th>OLD</th><th>NEW</th></tr></thead><tbody><tr><td>INSERT 型触发器</td><td>无（因为插入前无数据）</td><td>NEW表示将要或者已经新增的数据</td></tr><tr><td>UPDATE 型触发器</td><td>OLD表示修改之前的数据</td><td>NEW表示将要或已经修改后的数据</td></tr><tr><td>DELETE 型触发器</td><td>OLD表示将要或者已经删除的数据</td><td>无（因为删除后状态无数据）</td></tr></tbody></table>
<h4><a id="_5677"></a>触发器的操作</h4>
<ul><li> <p>创建触发器</p> <pre><code class="prism language-sql"><span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> 触发器名称
BEFORE<span class="token operator">|</span><span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span><span class="token operator">|</span><span class="token keyword">UPDATE</span><span class="token operator">|</span><span class="token keyword">DELETE</span>
<span class="token keyword">ON</span> 表名
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
	触发器要执行的功能
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre> </li><li> <p>数据准备</p> <pre><code class="prism language-sql"><span class="token comment">-- 创建db7数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db7<span class="token punctuation">;</span>

<span class="token comment">-- 使用db7数据库</span>
<span class="token keyword">USE</span> db7<span class="token punctuation">;</span>

<span class="token comment">-- 创建账户表account</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> account<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 账户id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 姓名</span>
	money <span class="token keyword">DOUBLE</span>				<span class="token comment">-- 余额</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建日志表account_log</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> account_log<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 日志id</span>
	operation <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 操作类型 (insert update delete)</span>
	operation_time <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>		<span class="token comment">-- 操作时间</span>
	operation_id <span class="token keyword">INT</span><span class="token punctuation">,</span>			<span class="token comment">-- 操作表的id</span>
	operation_param <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>		<span class="token comment">-- 操作参数</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>INSERT 型触发器</p> <pre><code class="prism language-sql"><span class="token comment">-- 创建insert型触发器，用于对account表新增数据进行日志的记录</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> account_insert
<span class="token keyword">AFTER</span> <span class="token keyword">INSERT</span>
<span class="token keyword">ON</span> account
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account_log <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'INSERT'</span><span class="token punctuation">,</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> new<span class="token punctuation">.</span>id<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token string">'插入后{id='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token string">',name='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">',money='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>money<span class="token punctuation">,</span><span class="token string">'}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 向account表添加一条数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询account表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>

<span class="token comment">-- 查询account_log表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account_log<span class="token punctuation">;</span>
</code></pre> </li><li> <p>UPDATE 型触发器</p> <pre><code class="prism language-sql"><span class="token comment">-- 创建update型触发器，用于对account表修改数据进行日志记录</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> account_update
<span class="token keyword">AFTER</span> <span class="token keyword">UPDATE</span>
<span class="token keyword">ON</span> account
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account_log <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'UPDATE'</span><span class="token punctuation">,</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> new<span class="token punctuation">.</span>id<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token string">'更新前{id='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token string">',name='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">',money='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>money<span class="token punctuation">,</span><span class="token string">'}'</span><span class="token punctuation">,</span><span class="token string">'更新后{id='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token string">',name='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">',money='</span><span class="token punctuation">,</span>new<span class="token punctuation">.</span>money<span class="token punctuation">,</span><span class="token string">'}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 修改account表中李四的金额为2000</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> money <span class="token operator">=</span> <span class="token number">2000</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询account表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>

<span class="token comment">-- 查询account_log表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account_log<span class="token punctuation">;</span>
</code></pre> </li><li> <p>DELETE 型触发器</p> <pre><code class="prism language-sql"><span class="token comment">-- 创建delete型触发器，用于对account表删除的数据进行日志的记录</span>
<span class="token keyword">DELIMITER</span> $

<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> account_delete
<span class="token keyword">AFTER</span> <span class="token keyword">DELETE</span>
<span class="token keyword">ON</span> account
<span class="token keyword">FOR EACH ROW</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account_log <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'DELETE'</span><span class="token punctuation">,</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> old<span class="token punctuation">.</span>id<span class="token punctuation">,</span> CONCAT<span class="token punctuation">(</span><span class="token string">'删除前{id='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>id<span class="token punctuation">,</span><span class="token string">',name='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>name<span class="token punctuation">,</span><span class="token string">',money='</span><span class="token punctuation">,</span>old<span class="token punctuation">.</span>money<span class="token punctuation">,</span><span class="token string">'}'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span>$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>

<span class="token comment">-- 删除account表中王五</span>
<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> account <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'王五'</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询account表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>

<span class="token comment">-- 查询account_log表</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account_log<span class="token punctuation">;</span>
</code></pre> </li></ul>
<h4><a id="_5802"></a>查看和删除</h4>
<ul><li>查看触发器<br/> <code>SHOW TRIGGERS;</code></li><li>删除触发器<br/> <code>DROP TRIGGER 触发器名称;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查看触发器</span>
<span class="token keyword">SHOW</span> TRIGGERS<span class="token punctuation">;</span>

<span class="token comment">-- 删除account_delete触发器</span>
<span class="token keyword">DROP</span> <span class="token keyword">TRIGGER</span> account_delete<span class="token punctuation">;</span>
</code></pre>
<h3><a id="_5817"></a>事务</h3>
<blockquote>
<p>事务：一条或多条SQL语句组成一个执行单元，其特点是这个单元要么同时成功要么同时失败<br/> 单元中的每条SQL语句都相互依赖，形成一个整体<br/> 如果某条SQL语句失败或者出现错误，那么这个单元就会撤回到事务最初的状态<br/> 如果单元中所有的SQL语句都执行成功，则事务就顺利执行</p>
</blockquote>
<h4><a id="_5824"></a>基本使用</h4>
<ul><li>开启事务<br/> <code>START TRANSACTION;</code></li><li>回滚事务<br/> <code>ROLLBACK;</code></li><li>提交事务<br/> <code>COMMIT;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db8数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db8<span class="token punctuation">;</span>

<span class="token comment">-- 使用db8数据库</span>
<span class="token keyword">USE</span> db8<span class="token punctuation">;</span>

<span class="token comment">-- 创建账户表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> account<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 账户id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 账户名称</span>
	money <span class="token keyword">DOUBLE</span>				<span class="token comment">-- 账户余额</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> account <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">-- 张三给李四转账500元</span>

<span class="token comment">-- 开启事务</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 1. 张三账户-500</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">500</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'张三'</span><span class="token punctuation">;</span>

出错了<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token comment">-- 2.李四账户+500</span>
<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> money <span class="token operator">=</span> money <span class="token operator">+</span> <span class="token number">500</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'李四'</span><span class="token punctuation">;</span>

<span class="token comment">-- 回滚事务</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>

<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_5871"></a>提交方式</h4>
<ul><li> <p>事务提交方式</p>
<ul><li>自动提交（MySQL默认）</li><li>手动提交</li></ul> </li><li> <p>查看事务提交方式<br/> <code>SELECT @@AUTOCOMMIT;</code></p>
<blockquote>
<p>0代表手动提交<br/> 1代表自动提交</p>
</blockquote> </li><li> <p>修改事务提交方式<br/> <code>SET @@AUTOCOMMIT = 数字;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询事务提交方式</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@autocommit</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改事务提交方式</span>
<span class="token keyword">SET</span> @<span class="token variable">@autocommit</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> money <span class="token operator">=</span> <span class="token number">2000</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">-- 临时修改，并未提交</span>

<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="ACID_5899"></a>四大特征(ACID)</h4>
<ul><li>原子性(Atomicty)<br/> 原子性指事物包含的所有操作要么全部成功，要么全部失败回滚<br/> 因此事务的操作如果成功就必须要完全应用到数据库，如果操作失败则不能对数据库有任何影响</li><li>一致性(Consistency)<br/> 一致性是指事务必须使数据库从一个一致性状态变换到另一个一致性状态<br/> 也就是说一个事务执行之前和执行之后都必须处于一致性状态</li><li>隔离性(Isolcation)<br/> 隔离性是当多个用户并发访问数据库时，比如操作同一张表时，数据库为每一个用户开启的事务<br/> 不能被其他事务的操作所干扰，多个并发事务之间要相互隔离</li><li>持久性(Durability)<br/> 持久性是指一个事务一旦提交了，那么对数据库中的数据的改变就是永久性的<br/> 即便是在数据库系统遇到故障的情况下也不会丢失提交事务的操作</li></ul>
<h4><a id="_5914"></a>隔离级别</h4>
<ul><li> <p>事务的隔离级别<br/> 多个客户端操作时，各个客户端的事务之间应该是隔离的，相互独立的，不受影响的<br/> 而如果多个事务操作同一批数据时，就会产生不同的问题，我们需要设置不同的隔离级别来解决这些问题</p> </li><li> <p>隔离级别分类</p>
<table><thead><tr><th>隔离级别</th><th>名称</th><th>会引发的问题</th></tr></thead><tbody><tr><td>read uncommitted</td><td>读未提交</td><td>脏读、不可重复读、幻读</td></tr><tr><td>read committed</td><td>读已提交</td><td>不可重复读、幻读</td></tr><tr><td>repeatable read</td><td>可重复读</td><td>幻读</td></tr><tr><td>serializable</td><td>串行化</td><td>无</td></tr></tbody></table></li><li> <p>引发的问题</p>
<table><thead><tr><th>问题</th><th>现象</th></tr></thead><tbody><tr><td>脏读</td><td>在一个事务处理过程中读取到了另一个未提交事务中的数据，导致两次查询结果不一致</td></tr><tr><td>不可重复读</td><td>在一个事务处理过程中读取到了另一个事务中修改并已提交的数据，导致两次查询不一致</td></tr><tr><td>幻读</td><td>查询某数据不存在，准备插入此纪录，但执行插入时发现此纪录已存在，无法插入。或者查询数据不存在执行删除操作，却发现删除成功</td></tr></tbody></table></li><li> <p>查询数据库隔离级别<br/> <code>SELECT @@TX_ISOLATION;</code></p> </li><li> <p>修改数据库隔离级别<br/> <code>SET GLOBAL TRANSACTION ISOLATION LEVEL 级别字符串;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询事务隔离级别</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改事务隔离级别（修改后需要重新连接）</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> <span class="token keyword">READ</span> <span class="token keyword">COMMITTED</span><span class="token punctuation">;</span>
</code></pre>
<ul><li> <p>总结</p>
<table><thead><tr><th>序号</th><th>隔离级别</th><th>名称</th><th>脏读</th><th>不可重复读</th><th>幻读</th><th>数据库默认隔离级别</th></tr></thead><tbody><tr><td>1</td><td>read uncommitted</td><td>读未提交</td><td>是</td><td>是</td><td>是</td><td></td></tr><tr><td>2</td><td>read committed</td><td>读已提交</td><td>否</td><td>是</td><td>是</td><td>Oracle</td></tr><tr><td>3</td><td>repeatable read</td><td>可重复读</td><td>否</td><td>否</td><td>是</td><td>MySQL</td></tr><tr><td>4</td><td>serializable</td><td>串行化</td><td>否</td><td>否</td><td>否</td><td></td></tr></tbody></table><p><strong>注意</strong> ：隔离级别从小到大安全性越来越高，但是效率越来越低，所以不建议修改数据库默认的隔离级别</p> </li></ul>
<h3><a id="_5961"></a>存储引擎</h3>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ed8da153d5904ce59546d4a17b159ee2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="_5966"></a>体系结构</h4>
<ul><li>客户端连接<br/> 支持接口：支持的客户端连接，例如：C、Java、PHP等语言来连接MySQL数据库</li><li>第一层：网络连接层<br/> 连接池：管理、缓冲用户的连接，线程处理等需要缓存的需求</li><li>第二层：核心服务层 
  <ul><li>管理服务和工具：系统的管理和控制工具，例如备份恢复、复制、集群等</li><li>SQL接口：接受SQL命令，并且返回查询结果</li><li>查询解析器：验证和解析SQL命令，例如过滤条件、语法结构等</li><li>缓存：如果缓存当中有想查询的数据，则直接将缓存中的数据返回。没有的话重新查询</li></ul> </li><li>第三层：存储引擎层<br/> 插件式存储引擎：管理和操作数据的一种机制，包括（存储数据、如何更新、查询数据等）</li><li>第四层：系统文件层<br/> 文件系统：配置文件、数据文件、日志文件、错误文件、二进制文件等等的保存</li></ul>
<h4><a id="_5982"></a>存储引擎</h4>
<ul><li>在生活中，引擎就是整个机器运行的核心（发动机），不同的引擎具备不同的功能，应用于不同的场景之中</li><li>MySQL数据库使用不同的机制存取表文件，包括存储方式、索引技巧、锁定水平等不同的功能。这些不同的技术以及配套的功能称为存储索引</li><li>Oracle、SQL server等数据库只有一种存储引擎。而MySQL针对不同的需求，配置不同的存储索引，就会让数据库采取不同处理数据的方式和扩展功能</li><li>MySQL支持的存储引擎有很多，常用的有三种：InnoDB、MyISAM、MEMORY</li><li>特性对比 
  <ul><li>MyISAM存储引擎：访问快，不支持事务和外键操作</li><li>InnoDB存储引擎：支持事务和外键操作，支持并发控制，占用磁盘空间大（MySQL 5.5版本后默认）</li><li>MEMORY存储引擎：内存存储，速度快，不安全。适合小量快速访问的数据</li></ul> </li></ul>
<h4><a id="_5993"></a>基本操作</h4>
<ul><li> <p>查询数据库支持的存储引擎<br/> <code>SHOW ENGINES;</code></p> </li><li> <p>查询某个数据库中所有数据表的存储引擎<br/> <code>SHOW TABLE STATUS FROM 数据库名称;</code></p> </li><li> <p>查询某个数据库中某个数据表的存储索引<br/> <code>SHOW TABLE STATUS FROM 数据库名称 WHERE NAME = '数据表名称';</code></p> </li><li> <p>创建数据表，指定存储引擎</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> 表名<span class="token punctuation">(</span>
	列名 数据类型<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span> <span class="token operator">=</span> 引擎名称<span class="token punctuation">;</span>
</code></pre> </li><li> <p>修改数据表的存储引擎<br/> <code>ALTER TABLE 表名 ENGINE = 引擎名称;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 查询数据库支持的存储引擎</span>
<span class="token keyword">SHOW</span> ENGINES<span class="token punctuation">;</span>

<span class="token comment">-- 查询db4数据库所有表的存储引擎</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> db4<span class="token punctuation">;</span>

<span class="token comment">-- 查看db4数据库中category表的存储引擎</span>
<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> db4 <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'category'</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建数据表并指定存储引擎</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> engine_test<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span> <span class="token operator">=</span> MYISAM<span class="token punctuation">;</span>

<span class="token keyword">SHOW</span> <span class="token keyword">TABLE</span> <span class="token keyword">STATUS</span> <span class="token keyword">FROM</span> db4 <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'engine_test'</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改数据表的存储引擎</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> engine_test <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">INNODB</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_6038"></a>存储引擎的选择</h4>
<ul><li>MyISAM 
  <ul><li>特点：不支持事务和外键操作。读取速度快，节约资源</li><li>使用场景：以查询操作为主，只有很少的更新和删除操作，并且对事务的完整性、并发性要求不是很高</li></ul> </li><li>InnoDB 
  <ul><li>特点：MySQL的默认存储引擎，支持事务和外键操作</li><li>使用场景：对事务的完整性有比较高的要求，在并发条件下要求数据的一致性，读写频繁的操作</li></ul> </li><li>MEMORY 
  <ul><li>特点：将所有数据保存在内存中，在需要快速定位记录和其他类似数据环境下，可以提供更快的访问</li><li>使用场景：通常用于更新不太频繁的小表，用来快速得到访问的结果</li></ul> </li></ul>
<p><strong>总结</strong> ：针对不同的需求场景，来选择最适合的存储引擎即可。如果不确定，则使用默认的存储引擎</p>
<h3><a id="_6052"></a>索引</h3>
<ul><li>MySQL索引：是帮助MySQL高效获取数据的一种数据结构。所以，索引的本质就是数据结构</li><li>在表数据之外，数据系统还维护着满足特定查找算法的数据结构，这些数据结构以某种方式指向数据，这样就可以在这些数据结构上实现高级查找算法，这种数据结构就是索引</li></ul>
<h4><a id="_6057"></a>分类</h4>
<ul><li>按照功能分类 
  <ul><li>普通索引：最基本的索引，没有任何限制</li><li>唯一索引：索引列的值必须唯一，但允许有空值。如果是组合索引，则列值组合必须唯一</li><li>主键索引：一种特殊的唯一索引，不允许有空值。在建表时有主键列同时创建主键索引</li><li>联合索引：顾名思义，就是将单列索引进行组合</li><li>外键索引：只有InnoDB引擎支持外键索引，用来保证数据的一致性、完整性和实现级联操作</li><li>全文索引：快速匹配全部文档的方式。InnoDB引擎5.6版本后才支持全文索引。MEMORY引擎不支持</li></ul> </li><li>按照结构分类 
  <ul><li>BTree索引：MySQL使用最频繁的一个索引数据结构，是InnoDB和MyISAM存储索引默认的索引类型，底层是基于B+Tree数据结构</li><li>Hash索引：MySQL中Memory存储引擎默认支持的索引类型</li></ul> </li></ul>
<h4><a id="_6070"></a>创建和查询</h4>
<ul><li> <p>创建索引</p> <pre><code class="prism language-sql"><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span> <span class="token operator">|</span> FULLTEXT<span class="token punctuation">]</span> <span class="token keyword">INDEX</span> 索引名称
<span class="token punctuation">[</span><span class="token keyword">USING</span> 索引类型<span class="token punctuation">]</span> 	<span class="token comment">-- 默认是BTREE</span>
<span class="token keyword">ON</span> 表名<span class="token punctuation">(</span>列名<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>查看索引<br/> <code>SHOW INDEX FROM 表名;</code></p> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db9数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db9<span class="token punctuation">;</span>

<span class="token comment">-- 使用db9数据库</span>
<span class="token keyword">USE</span> db9<span class="token punctuation">;</span>

<span class="token comment">-- 创建student表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span><span class="token punctuation">,</span>
	score <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'周七'</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">-- 为student表中的name列创建一个普通索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> idx_name <span class="token keyword">ON</span> student<span class="token punctuation">(</span>NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 为student表中的age列创建一个唯一索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_age <span class="token keyword">ON</span> student<span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询索引（主键列自带主键索引）</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>

<span class="token comment">-- 查询db4中的product表(外键列自带外键索引)</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_6117"></a>添加和删除</h4>
<ul><li>添加索引<br/> 普通索引：<code>ALTER TABLE 表名 ADD INDEX 索引名称(列名);</code><br/> 组合索引：<code>ALTER TABLE 表名 ADD INDEX 索引名称(列名1,列名2,...);</code><br/> 主键索引：<code>ALTER TABLE 表名 ADD PRIMARY KEY(主键列名);</code><br/> 外键索引：<code>ALTER TABLE 表名 ADD CONSTRAINT 外键名 FOREIGN KEY (本表外键列名) REFERENCES 主表名(主键列名);</code><br/> 唯一索引：<code>ALTER TABLE 表名 ADD UNIQUE 索引名称(列名);</code><br/> 全文索引：<code>ALTER TABLE 表名 ADD FULLTEXT 索引名称(列名);</code></li><li>删除索引<br/> <code>DROP INDEX 索引名称 ON 表名;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 为student表中score列添加唯一索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> student <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span> idx_score<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询student表的索引</span>
<span class="token keyword">SHOW</span> <span class="token keyword">INDEX</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>

<span class="token comment">-- 删除索引</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> idx_score <span class="token keyword">ON</span> student<span class="token punctuation">;</span>
</code></pre>
<h4><a id="_6140"></a>索引的原理</h4>
<ul><li>索引是在存储引擎中实现的，不同的存储引擎所支持的索引也不一样，这里主要介绍InnoDB 引擎的BTree索引</li><li>BTree索引类型是基于B+Tree数据结构的，而B+Tree数据结构又是BTree数据结构的变种。通常使用在数据库和操作系统中的文件系统，特点是能够保持数据稳定有序</li><li>需要理解的 
  <ul><li>磁盘存储</li><li>BTree</li><li>B+Tree</li></ul> </li></ul>
<p><strong>磁盘存储</strong></p>
<ul><li>系统从磁盘读取数据到内存时是以磁盘块（block）为基本单位的</li><li>位于同一个磁盘块中的数据会被一次性读取出来，而不是需要什么取什么</li><li>InnoDB 存储引擎中有页（page）的概念，页是其磁盘管理的最小单位。InnoDB存储引擎中默认每个页的大小为 16 KB</li><li>InnoDB 引擎将若干个地址连接磁盘块，以此来达到页的大小 16 KB，在查询数据时如果一个页中的每条数据都能有助于定位数据记录的位置，这将会减少磁盘 I/O 次数，提高查询效率</li></ul>
<p><strong>BTree</strong></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/7d75927e247e44c89d70d561ad85f916.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<ul><li>在每一个结点上，除了保存键值外，还会保存真实的数据</li><li>左边存小的，右边存大的，类似二叉树</li><li>但是在查询数据时，涉及到的磁盘块数据都会被读取出来，会增加查询数据时磁盘的IO次数，效率并不高</li></ul>
<p><strong>B+Tree</strong></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ea8bb2cfafcf4dd3a128e43a1e70adf8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<ul><li>在每一个结点上，只保存键值，并不保存真实的数据</li><li>在叶子结点上保存着真实数据</li><li>所有的叶子结点之间都有连接指针</li><li>好处 
  <ul><li>提高查询速度</li><li>减少磁盘的IO次数</li><li>树型结构较小</li></ul> </li></ul>
<h4><a id="_6178"></a>设计原则</h4>
<ul><li>创建索引遵循的原则 
  <ol><li>对查询频次较高，且数据量比较大的表建立索引</li><li>使用唯一索引，区分度越高，使用索引的效率越高</li><li>索引字段的选择，最佳候选应当从where子句的条件中提取</li><li>索引虽然可以有效的提升查询数据的效率，但并不是多多益善</li></ol> </li><li>最左匹配原则（使用组合索引） 
  <ul><li>例如：为user表中的name、address、phone 列添加组合索引<br/> <code>ALTER TABLE user ADD INDEX idx_three(name,address,phone);</code></li><li>此时，组合索引idx_three实际建立了(name)、(name,address)、(name,address,phone)三个索引</li><li>下面的三个SQL语句都可以命中索引<br/> <code>SELECT * FROM user WHERE address = ‘北京’ AND phone = '12345' AND name = '张三';</code><br/> <code>SELECT * FROM user WHERE name = '张三' AND address = '北京';</code><br/> <code>SELECT * FROM user WHERE name = '张三';</code></li><li>这三条SQL语句在检索时分别会使用以下索引进行数据匹配<br/> (name,address,phone)<br/> (name,address)<br/> (name)</li><li>索引字段出现的顺序可以是任意的，MySQL 优化器会帮我们自动的调整where 条件中的顺序</li><li>如果组合索引中最左边的列不在查询条件中，则不会命中索引<br/> <code>SELECT * FROM user WHERE address = '北京';</code></li></ul> </li></ul>
<h3><a id="_6201"></a>锁</h3>
<ul><li> <p>锁机制：数据库为了保证数据的一致性，在共享的资源被并发访问时变得安全所设计的一种规则</p> </li><li> <p>锁机制类似多线程中的同步，作用就是可以保证数据的一致性和安全性</p> </li><li> <p>按操作分类</p>
<ul><li>共享锁：也叫读锁。针对同一份数据，多个事务读取操作可以同时加锁而不相互影响，但是不能修改数据</li><li>排他锁：也叫写锁。当前的操作没有完成前，会阻断其他操作的读取和写入</li></ul> </li><li> <p>按粒度分类</p>
<ul><li>表级锁：会锁定整张表。开销小，加锁快。锁定粒度大，发生锁冲突概率高，并发度低。不会出现死锁情况</li><li>行级锁：会锁定当前行。开销大，加锁慢。锁定粒度小，发生锁冲突概率低，并发度高。会出现死锁情况</li></ul> </li><li> <p>按使用方式分类</p>
<ul><li>悲观锁：每次查询数据时都认为别人会修改，很悲观，所以查询时加锁</li><li>乐观锁：每次查询时都认为别人不会修改，很乐观，但是更新时会判断一下在此期间别人有没有去更新这个数据</li></ul> </li><li> <p>不同存储引擎支持的锁</p>
<table><thead><tr><th>存储引擎</th><th>表锁</th><th>行锁</th></tr></thead><tbody><tr><td>InnoDB</td><td>支持</td><td>支持</td></tr><tr><td>MyISAM</td><td>支持</td><td>不支持</td></tr><tr><td>MEMORY</td><td>支持</td><td>不支持</td></tr></tbody></table></li></ul>
<blockquote>
<p><strong>注意：</strong> 在下面所有的锁的操作中，只提到了修改操作，但是增删都是和修改一样的</p>
</blockquote>
<h4><a id="InnoDB_6232"></a>InnoDB共享锁</h4>
<ul><li>共享锁特点<br/> 数据可以被多个事务查询，但是不能修改<br/> InnoDB引擎默认加的是行锁，如果不采用带索引的列加锁时加的就是表锁</li><li>创建共享锁格式<br/> <code>SELECT语句 LOCK IN SHARE MODE;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	数据准备
*/</span>

<span class="token comment">-- 创建db10数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db10<span class="token punctuation">;</span>

<span class="token comment">-- 使用db10数据库</span>
<span class="token keyword">USE</span> db10<span class="token punctuation">;</span>

<span class="token comment">-- 创建student表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	age <span class="token keyword">INT</span><span class="token punctuation">,</span>
	score <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口1
*/</span>

<span class="token comment">-- 开启事务</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据，并加入共享锁</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE</span> <span class="token keyword">MODE</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询分数为99的数据，并加入共享锁</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> score <span class="token operator">=</span> <span class="token number">99</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE</span> <span class="token keyword">MODE</span><span class="token punctuation">;</span>

<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口2
*/</span>

<span class="token comment">-- 开启事务</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据（普通查询没有问题）</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据，也加入共享锁(共享锁和共享锁之间相互兼容)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE</span> <span class="token keyword">MODE</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为1的数据，姓名改为张三三(修改失败，出现锁的情况，只有在窗口一提交事务之后才能修改成功)</span>
<span class="token keyword">UPDATE</span> student <span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'张三三'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为2的数据，将姓名修改为李四四(修改成功，InnoDB引擎默认加的是行锁)</span>
<span class="token keyword">UPDATE</span> student <span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'李四四'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为3的数据，姓名改为王五五(修改失败，锁，InnoDB如果不采用带索引的列加锁时加的就是表锁)</span>
<span class="token keyword">UPDATE</span> student <span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'王五五'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">-- 提交事务(窗口2没提交事务时修改的内容在窗口1中不能查询到)</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="InnoDB_6309"></a>InnoDB排他锁</h4>
<ul><li>排他锁特点<br/> 加锁的数据，不能被其他事务加锁查询或修改（普通查询可以）<br/> 锁和锁之间不能共存</li><li>创建排他锁的格式<br/> <code>SELECT语句 FOR UPDATE;</code></li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口1
*/</span>

<span class="token comment">-- 开启事务</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据，并加入排他锁</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> score <span class="token operator">=</span> <span class="token number">99</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span><span class="token punctuation">;</span>
<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口2
*/</span>

<span class="token comment">-- 开启事务</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据(成功，普通查询没问题)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据，并加入共享锁(失败，排他锁和共享锁不兼容)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">LOCK</span> <span class="token operator">IN</span> <span class="token keyword">SHARE</span> <span class="token keyword">MODE</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据，并加入排他锁(失败，排他锁和排他锁也不兼容)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student <span class="token keyword">WHERE</span> id <span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">FOR</span> <span class="token keyword">UPDATE</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为1的数据，姓名改为张三(失败，会出现锁的情况，只有窗口1提交事务后才能修改)</span>
<span class="token keyword">UPDATE</span> student <span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'张三'</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 提交事务</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="MyISAM__6356"></a>MyISAM 读锁</h4>
<ul><li>读锁特点<br/> 所有连接只能查询数据，不能修改<br/> MyISAM存储引擎只能添加表锁，且不支持事务</li><li>读锁语法格式 
  <ul><li>加锁：<code>LOCK TABLE 表名 READ;</code></li><li>解锁：<code>UNLOCK TABLES;</code></li></ul> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建product表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> product<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	price <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span> <span class="token operator">=</span> MYISAM<span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> product <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'华为手机'</span><span class="token punctuation">,</span> <span class="token number">4999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'小米手机'</span><span class="token punctuation">,</span> <span class="token number">2999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'苹果'</span><span class="token punctuation">,</span> <span class="token number">8999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'中兴'</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口1
*/</span>

<span class="token comment">-- 为product表添加读锁</span>
<span class="token keyword">LOCK</span> <span class="token keyword">TABLE</span> product <span class="token keyword">READ</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询id为1的数据</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为1的数据，金额改为4999(失败，读锁中所有连接只能读取数据不能修改数据)</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price <span class="token operator">=</span> <span class="token number">4999</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 解锁</span>
<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口2
*/</span>

<span class="token comment">-- 查询id为1的数据</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">-- 修改id为1的数据，金额改为5999(失败，读锁中所有连接只能读取数据不能修改数据)</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price <span class="token operator">=</span> <span class="token number">5999</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="MyISAM__6408"></a>MyISAM 写锁</h4>
<ul><li>写锁特点<br/> 其他连接不能查询和修改数据（当前连接下可以查询和修改）</li><li>写锁语法格式 
  <ul><li>加锁：<code>LOCK TABLE 表名 WRITE;</code></li><li>解锁：<code>UNLOCK TABLES;</code></li></ul> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口1
*/</span>

<span class="token comment">-- 为product表添加写锁</span>
<span class="token keyword">LOCK</span> <span class="token keyword">TABLE</span> product <span class="token keyword">WRITE</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询(没有问题)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 修改(没有问题)</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price <span class="token operator">=</span> <span class="token number">1999</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">-- 解锁</span>
<span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-sql"><span class="token comment">/*
	窗口2
*/</span>

<span class="token comment">-- 查询(失败，出现锁，只有窗口1解锁后才能成功)</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> product<span class="token punctuation">;</span>

<span class="token comment">-- 修改(失败，出现锁，只有窗口1解锁后才能成功)</span>
<span class="token keyword">UPDATE</span> product <span class="token keyword">SET</span> price <span class="token operator">=</span> <span class="token number">2999</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre>
<h4><a id="_6446"></a>悲观锁和乐观锁</h4>
<ul><li>悲观锁<br/> 就是很悲观，它对于数据被外界修改的操作持保守态度，认为数据随时会修改<br/> 整个数据处理中需要将数据加锁。悲观锁一般都是依靠关系型数据库提供的锁机制<br/> 我们之前所学习的锁机制都是悲观锁</li><li>乐观锁<br/> 就是很乐观，每次自己操作数据的时候认为没有人会来修改它，所以不去加锁<br/> 但是在更新的时候会去判断在此期间数据有没有被修改<br/> 需要用户自己去实现，不会发生并发抢占资源，只有在提交操作的时候检查是否违反数据完整性</li></ul>
<p><strong>乐观锁实现方式</strong>（了解）</p>
<ul><li>方式一 
  <ul><li>给数据表中添加一个version列，每次更新后都将这个列的值加1</li><li>读取数据时，将版本号读取出来，再执行更新的时候，比较版本号</li><li>如果相同则执行更新，如果不同，说明此条数据已经发生了变化</li><li>用户自行根据这个通知来决定怎么处理，比如重新开始一遍，或者放弃本次更新</li></ul> </li><li>方式二 
  <ul><li>和版本号方式基本一样，给数据表加入一个列，名称无所谓，数据类型是 timestamp</li><li>每次更新后都将最新时间插入到此列</li><li>读取数据时，将时间读取出来，在执行更新的时候，比较时间</li><li>如果相同则更新，如果不相同，说明此条数据已经发生了变化</li></ul> </li></ul>
<pre><code class="prism language-sql"><span class="token comment">-- 创建city表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> city<span class="token punctuation">(</span>
	id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	VERSION <span class="token keyword">INT</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> city <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'北京'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'上海'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'广州'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'深圳'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 将北京修改为北京市</span>
<span class="token comment">-- 1. 将北京的版本号读取出来</span>
<span class="token keyword">SELECT</span> VERSION <span class="token keyword">FROM</span> city <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'北京'</span><span class="token punctuation">;</span>		<span class="token comment">-- 1</span>
<span class="token comment">-- 2. 修改北京为北京市，版本号+1，并对比版本号是否相同</span>
<span class="token keyword">UPDATE</span> city <span class="token keyword">SET</span> NAME <span class="token operator">=</span> <span class="token string">'北京市'</span><span class="token punctuation">,</span> VERSION <span class="token operator">=</span> VERSION <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'北京'</span> <span class="token operator">AND</span> VERSION <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre>
<h3><a id="MyCat_6488"></a>MyCat</h3>
<blockquote>
<p>本部分内容理解就行，在最终项目时可能才会用到，后期还需要单独的学习</p>
</blockquote>
<blockquote>
<p>随着互联网的发展，数据的量级也是不断地增长，从GB 到 TB 到 PB。对数据的各种操作也是越来越困难，一台数据库服务器已经无法满足海量数据的存储需求，所以多台数据库服务器构成的数据库集群成了必然的方式。不过，还要保证数据的一致性，查询效率等，同时又要解决多台服务器间的通信、负载均衡等问题</p>
</blockquote>
<ul><li> <p>MyCat可以针对多台服务器做统一的管理，连接时只需要连接MyCat</p> </li><li> <p>Mycat是一款出色的数据库集群软件，不仅支持MySQL，常用关系型数据库也都支持</p> </li><li> <p>其实就是一个数据库中间件产品，支持MySQL集群。提供高可用性数据分片集群</p> </li><li> <p>我们可以像使用MySQL一样使用MyCat。对于开发人员来说几乎感觉不到MyCat 的存在</p> </li></ul>
<h4><a id="_6500"></a>安装</h4>
<ol><li>MyCat官网<br/> http://www.mycat.io</li><li>通过CRT工具上传到linux<br/> <code>put D:\Mycat-server-1.6.7.1-release-20190627191042-linux.tar.gz</code></li><li>解压并查看<br/> <code>tar -zxvf mycat.tar.gz</code><br/> <code>cd mycat</code><br/> <code>ls</code></li><li>为mycat目录授权<br/> <code>chmod -R 777 mycat</code></li><li>配置环境变量<br/> 编辑文件：<code>vi /etc/profile</code><br/> 添加内容：<code>export MYCAT_HOME=/root/mycat</code>(最下方)<br/> 加载文件：<code>source /etc/profile</code></li><li>启动mycat<br/> 进入目录：<code>cd /root/mycat/bin</code><br/> 执行启动：<code>./mycat start</code></li><li>查看端口监听<br/> <code>netstat -ant|grep 8066</code></li><li>SQLyog连接mycat<br/> 默认用户名：root<br/> 默认密码：123456<br/> 默认端口号：8066</li></ol>
<h4><a id="_6526"></a>集群环境</h4>
<ul><li>集群模型 
  <ul><li>MyCat MySQL 主服务器</li><li>MySQL 从服务器</li></ul> </li><li>克隆虚拟机</li><li>修改第二个虚拟机的网卡，重新生成MAC地址</li><li>修改第二个服务器MySQL 配置文件 uuid 
  <ul><li>编辑配置文件：<code>vi /var/lib/mysql/auto.cnf</code></li><li>将 server-uuid 更改一个数字即可</li></ul> </li><li>启动相关服务 
  <ul><li>关闭两台服务器的防火墙：<code>systemctl stop firewalld</code></li><li>启动两台服务器的MySQL：<code>service mysqld restart</code></li><li>启动两台服务器的MyCat：<code>cd /root/mycat/bin</code> <code>./mycat restart</code></li><li>查看两台服务器的监听端口：<code>netstat -ant|grep 3306</code> <code>netstat -ant|grep 8066</code></li></ul> </li></ul>
<h4><a id="_6542"></a>主从复制</h4>
<ul><li>为了使用MyCat进行读写分离，我们先要配置MySQL 数据库的主从复制</li><li>从服务器自动同步主服务器的数据，从而达到数据一致</li><li>进而，我们可以在写操作时，只操作主服务器，而读操作，就可以操作从服务器了</li></ul>
<p><strong>配置</strong></p>
<p><mark>主服务器</mark></p>
<ol><li> <p>在第一个服务器上，编辑mysql配置文件</p>
<ul><li>编辑mysql配置文件：<code>vi /etc/my.cnf</code></li><li>在[mysqld]下面加上</li></ul> <pre><code class="prism language-shell">// log-bin代表开启主从复制，server-id代表主从服务器的唯一标识
log-bin<span class="token operator">=</span>mysql-bin
server-id<span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">innodb_flush_log_at_trx_commit</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">sync_binlog</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre> </li><li> <p>查看主服务器的配置</p>
<ul><li>重启mysql：<code>service mysqld restart</code></li><li>登录mysql：<code>mysql -u root -p</code></li><li>查看主服务的配置：<code>show master status;</code><br/> 需要记住 File 列和 Position 列的数据，将来配置从服务器需要使用</li></ul> </li></ol>
<p><mark>从服务器</mark></p>
<ol><li> <p>在第二个服务器上，编辑mysql配置文件</p>
<ul><li>编辑mysql配置文件：<code>vi /etc/my.cnf</code></li><li>在[mysqld]下面加上：<code>server-id=2</code></li></ul> </li><li> <p>登录mysql：<code>mysql -u root -p</code></p> </li><li> <p>执行</p> <pre><code class="prism language-sql"><span class="token keyword">use</span> mysql<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> slave_master_info<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> slave_relay_log_info<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> slave_worker_info<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> innodb_index_stats<span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> innodb_table_stats<span class="token punctuation">;</span>
source <span class="token operator">/</span>usr<span class="token operator">/</span><span class="token keyword">share</span><span class="token operator">/</span>mysql<span class="token operator">/</span>mysql_system_tables<span class="token punctuation">.</span><span class="token keyword">sql</span><span class="token punctuation">;</span>
</code></pre> </li><li> <p>重启mysql，重新登录，配置从节点</p>
<ul><li>重启mysql：<code>service mysqld restart</code></li><li>重新登录mysql：<code>mysql -u root -p</code></li><li>执行：<code>change master to master_host='192.168.59.143',master_port=3306,master_user='root',master_password='itheima',master_log_file='mysql-bin.000001',master_log_pos=154;</code></li><li>开启从节点：<code>start slave;</code></li><li>查询结果：<code>show slave status\G;</code><br/> Slave_IO_Running和Slave_SQL_Running都为YES才表示同步成功。</li></ul> </li><li> <p>测试：在主服务器上创建一个db1数据库，查看从服务器上是否自动同步</p> </li></ol>
<h4><a id="_6604"></a>读写分离</h4>
<ul><li>写操作只写入主服务器，由于有主从复制，从服务器中也会自动同步数据</li><li>读操作是读取从服务器中的数据</li></ul>
<p><strong>配置</strong></p>
<ul><li> <p>修改主服务器 server.xml：<code>vi /root/mycat/conf/server.xml</code></p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>MyCat密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>schemas<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>MyCat逻辑数据库显示的名字（虚拟数据库名）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>修改主服务器 schema.xml：<code>vi /root/mycat/conf/schema.xml</code></p> <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mycat:schema</span> <span class="token name">SYSTEM</span> <span class="token string">"schema.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mycat:</span>schema</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>mycat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://io.mycat/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schema</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>和MyCat逻辑数据库名一致<span class="token punctuation">"</span></span> <span class="token attr-name">checkSQLschema</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">sqlMaxLimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schema</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db1<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataHost</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">maxCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span> <span class="token attr-name">minCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">balance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
			  <span class="token attr-name">writeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">dbType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span> <span class="token attr-name">dbDriver</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>native<span class="token punctuation">"</span></span> <span class="token attr-name">switchType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token attr-name">slaveThreshold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heartbeat</span><span class="token punctuation">&gt;</span></span>select user()<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heartbeat</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 主服务器负责写的操作 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>writeHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostM1<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token comment">&lt;!-- 从服务器负责读的操作 --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>readHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostS1<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.59.182:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>writeHost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataHost</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mycat:</span>schema</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>重启MyCat<br/> 进入mycat路径：<code>cd /root/mycat/bin</code><br/> 重启mycat：<code>./mycat restart</code><br/> 查看端口监听：<code>netstat -ant|grep 8066</code></p> </li></ul>
<h4><a id="_6648"></a>分库分表</h4>
<ul><li>分库分表：将庞大的数据量拆分为不同的数据库和数据表进行存储</li><li>水平拆分<br/> 根据表的数据逻辑关系，将同一表中的数据按照某种条件，拆分到多台数据库服务器上，也叫做横向拆分<br/> 例如：一张 1000万的大表，按照一模一样的结构，拆分成4个250万的小表，分别保存到4个数据库中</li><li>垂直拆分<br/> 根据业务的维度，将不同的表切分到不同的数据库上，也叫做纵向拆分<br/> 例如：所有的动物表都保存到动物库中，所有的水果表都保存到水果库中，同类型的表保存在同一个库中</li></ul>
<p><strong>水平拆分</strong></p>
<ul><li> <p>修改主服务器中 server.xml：<code>vi /root/mycat/conf/server.xml</code></p> <pre><code class="prism language-xml"><span class="token comment">&lt;!--配置主键方式 0代表本地文件方式--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sequnceHandlerType<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>修改主服务器中 sequence_conf.properties：<code>vi /root/mycat/conf/sequence_conf.properties</code></p> <pre><code class="prism language-xml">#default global sequence
GLOBAL.HISIDS=			# 可以自定义关键字
GLOBAL.MINID=10001		# 最小值
GLOBAL.MAXID=20000		# 最大值
</code></pre> </li><li> <p>修改主服务器中 schema.xml：<code>vi /root/mycat/conf/schema.xml</code></p> <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mycat:schema</span> <span class="token name">SYSTEM</span> <span class="token string">"schema.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mycat:</span>schema</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>mycat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://io.mycat/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schema</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HEIMADB<span class="token punctuation">"</span></span> <span class="token attr-name">checkSQLschema</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">sqlMaxLimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1,dn2,dn3<span class="token punctuation">"</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mod-long<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schema</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db1<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn2<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db2<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn3<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db3<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataHost</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">maxCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span> <span class="token attr-name">minCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">balance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
			  <span class="token attr-name">writeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">dbType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span> <span class="token attr-name">dbDriver</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>native<span class="token punctuation">"</span></span> <span class="token attr-name">switchType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token attr-name">slaveThreshold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heartbeat</span><span class="token punctuation">&gt;</span></span>select user()<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heartbeat</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 主服务器负责写的操作 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>writeHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostM1<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token comment">&lt;!-- 从服务器负责读的操作 --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>readHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostS2<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.59.182:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>writeHost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataHost</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mycat:</span>schema</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li><li> <p>修改主服务器中 rule：<code>vi /root/mycat/conf/rule.xml</code></p> <pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mod-long<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>io.mycat.route.function.PartitionByMod<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!-- 指定节点数量 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>count<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>function</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ul>
<p><strong>垂直拆分</strong></p>
<ul><li> <p>修改主服务器中 schema.xml：<code>vi /root/mycat/conf/schema.xml</code></p> <pre><code class="prism language-xml"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mycat:schema</span> <span class="token name">SYSTEM</span> <span class="token string">"schema.dtd"</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mycat:</span>schema</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>mycat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://io.mycat/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>schema</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>HEIMADB<span class="token punctuation">"</span></span> <span class="token attr-name">checkSQLschema</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> <span class="token attr-name">sqlMaxLimit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>product<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1,dn2,dn3<span class="token punctuation">"</span></span> <span class="token attr-name">rule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mod-long<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
		
		<span class="token comment">&lt;!-- 动物类数据表 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dog<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">autoIncrement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn4<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cat<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">autoIncrement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn4<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    
       <span class="token comment">&lt;!-- 水果类数据表 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>apple<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">autoIncrement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn5<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>banana<span class="token punctuation">"</span></span> <span class="token attr-name">primaryKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">autoIncrement</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">dataNode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn5<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>schema</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn1<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db1<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn2<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db2<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn3<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db3<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn4<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db4<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataNode</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dn5<span class="token punctuation">"</span></span> <span class="token attr-name">dataHost</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>db5<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataHost</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost1<span class="token punctuation">"</span></span> <span class="token attr-name">maxCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span> <span class="token attr-name">minCon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">balance</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>
			  <span class="token attr-name">writeType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">dbType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mysql<span class="token punctuation">"</span></span> <span class="token attr-name">dbDriver</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>native<span class="token punctuation">"</span></span> <span class="token attr-name">switchType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token attr-name">slaveThreshold</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heartbeat</span><span class="token punctuation">&gt;</span></span>select user()<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heartbeat</span><span class="token punctuation">&gt;</span></span>
		<span class="token comment">&lt;!-- 主服务器负责写的操作 --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>writeHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostM1<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>localhost:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span>
				   <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token comment">&lt;!-- 从服务器负责读的操作 --&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>readHost</span> <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>hostS1<span class="token punctuation">"</span></span> <span class="token attr-name">url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>192.168.59.182:3306<span class="token punctuation">"</span></span> <span class="token attr-name">user</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span> <span class="token attr-name">password</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itheima<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>writeHost</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataHost</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">mycat:</span>schema</span><span class="token punctuation">&gt;</span></span>
</code></pre> </li></ul>
<hr/>
<h2><a id="JDBC_6754"></a>JDBC</h2>
<blockquote>
<p>JDBC(Java DataBase Connectivity java数据库连接) 是一种用于执行SQL语句的Java API，可以为多种关系型数据库提供统一访问，它是由一组用Java语言编写的类和接口组成的</p>
</blockquote>
<ul><li>本质：其实就是Java官方提供的一套规范（接口）。用于帮助开发人员快速实现不同关系型数据库的连接</li></ul>
<h3><a id="_6760"></a>快速入门</h3>
<ol><li>导入jar包</li><li>注册驱动</li><li>获取数据库连接</li><li>获取执行者对象</li><li>执行sql语句并返回结果</li><li>处理结果</li><li>释放资源</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo01</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 导入jar包</span>
        <span class="token comment">// 注册驱动</span>
        <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 获取连接</span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db2"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"lh18391794828"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 获取执行者对象</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 执行sql语句，并接收结果</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user"</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 处理结果</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        <span class="token comment">// 释放资源</span>
        con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_6807"></a>功能类详解</h3>
<p><strong>DriverManager 驱动管理对象</strong></p>
<ol><li> <p>注册驱动<br/> 注册给定的驱动程序：<code>static void registerDriver(Driver driver);</code><br/> 写代码使用：<code>Class.forName("com.mysql.jdbc.Driver");</code><br/> 在com.mysql.jdbc.Driver类中存在静态代码块</p> <pre><code class="prism language-java"><span class="token keyword">static</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>SQL <span class="token class-name">Exception</span> <span class="token class-name">E</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"Can't register driver!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>我们不需要通过DriverManager调用静态方法registerDriver()，因为只要Driver类被使用，就会执行其静态代码块完成注册驱动<br/> mysql 5之后可以省略注册驱动的步骤。在jar包中，存在一个java.sql.Driver配置文件，文件中指定了 com.mysql.jdbc.Driver</p>
</blockquote> </li><li> <p>获取数据库连接<br/> 获取数据库连接对象：<code>static Connection getConnection(String url,String user,String password);</code><br/> 返回值：Connection 数据库连接对象</p>
<blockquote>
<p>连接成功返回Connection对象，连接失败则会报错<br/> url：指定连接的路径。语法：<code>jdbc:mysql://ip地址(域名):端口号/数据库名称</code><br/> user：用户名<br/> password：密码</p>
</blockquote> </li></ol>
<p><strong>Connection 数据库连接对象</strong></p>
<ol><li>获取执行者对象<br/> 获取普通执行者对象：<code>Statement createStatement();</code><br/> 获取预编译执行者对象：<code>PreparedStatement prepareStatement(String sql);</code></li><li>管理事务<br/> 开启事务：<code>setAutoCommit(boolean autoCommit);</code> 参数为false，则开启事务<br/> 提交事务：<code>commit();</code><br/> 回滚事务：<code>rollback();</code></li><li>释放资源<br/> 立即将数据库连接对象释放：<code>void close();</code></li></ol>
<p><strong>Statement 执行者对象</strong></p>
<ol><li>执行DML语句：<code>int executeUpdate(String sql);</code><br/> 返回值int：返回影响的行数<br/> 参数sql：可以执行insert、update、delete语句</li><li>执行DQL语句：<code>ResultSet executeQuery(String sql);</code><br/> 返回值ResultSet：封装查询的结果<br/> 参数sql：可以执行select语句</li><li>释放资源<br/> 立即将执行者对象释放：<code>void close();</code></li></ol>
<p><strong>ResultSet 结果集对象</strong></p>
<ol><li>判断结果集中是否还有数据：<code>boolean next();</code><br/> 有数据返回true，并将索引向下移动一行<br/> 没有数据返回false</li><li>获取结果集中的数据：<code>XXX getXXX("列名");</code><br/> XXX代表数据类型（要获取某列数据，就指这一列的数据类型）<br/> 例如：<code>String getString("name");</code> <code>int getInt("age");</code></li><li>释放资源<br/> 立即将结果集对象释放：<code>void close();</code></li></ol>
<h3><a id="_6872"></a>案例</h3>
<blockquote>
<p>使用 JDBC 技术完成对student 表的 CRUD 操作</p>
</blockquote>
<h4><a id="_6876"></a>数据准备</h4>
<p><strong>创建数据库和数据表</strong></p>
<pre><code class="prism language-sql"><span class="token comment">-- 创建db11数据库</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> db11<span class="token punctuation">;</span>

<span class="token comment">-- 使用db11数据库</span>
<span class="token keyword">USE</span> db11<span class="token punctuation">;</span>

<span class="token comment">-- 创建student表</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> student<span class="token punctuation">(</span>
	sid <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>	<span class="token comment">-- 学生id</span>
	NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>			<span class="token comment">-- 学生姓名</span>
	age <span class="token keyword">INT</span><span class="token punctuation">,</span>				<span class="token comment">-- 学生年龄</span>
	birthday <span class="token keyword">DATE</span> 				<span class="token comment">-- 学生生日</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 添加数据</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> student <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'1999-09-23'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">'1998-08-10'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">'1996-06-06'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'赵六'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token string">'1994-10-20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>创建Student类</strong></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f94e528e632c45c09fe5c1d75029a202.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASGVsbG8gQ29kZS4=,size_12,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Demo</span><span class="token punctuation">.</span>domain<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> sid<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> sid<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Integer</span> age<span class="token punctuation">,</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sid <span class="token operator">=</span> sid<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>birthday <span class="token operator">=</span> birthday<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> sid<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSid</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> sid<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sid <span class="token operator">=</span> sid<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Date</span> <span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> birthday<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBirthday</span><span class="token punctuation">(</span><span class="token class-name">Date</span> birthday<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>birthday <span class="token operator">=</span> birthday<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Student{"</span> <span class="token operator">+</span>
                <span class="token string">"sid="</span> <span class="token operator">+</span> sid <span class="token operator">+</span>
                <span class="token string">", name='"</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", age="</span> <span class="token operator">+</span> age <span class="token operator">+</span>
                <span class="token string">", birthday="</span> <span class="token operator">+</span> birthday <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>注意：<br/> 自定义类的功能是为了封装表中每列数据，成员变量和列要保持一致<br/> 所有基本数据类型需要使用对应的包装类，以免表中null值无法赋值</p>
</blockquote>
<h4><a id="_6974"></a>需求实现</h4>
<ol><li>查询所有学生信息</li><li>根据id查询学生信息</li><li>新增学生信息</li><li>修改学生信息</li><li>删除学生信息</li></ol>
<h4><a id="_6982"></a>代码展示</h4>
<p><strong>查询所有学生信息</strong></p>
<pre><code class="prism language-java"><span class="token comment">/*
	查询所有学生信息
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">ResultSet</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 1.注册驱动</span>
		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 2.获取数据库连接</span>
		con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db11"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.获取执行者对象</span>
		stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4.执行sql语句，并接收返回的结果集</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
		res <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 5.处理结果集</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token class-name">Integer</span> sid <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> name <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Integer</span> age <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Date</span> birthday <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>sid<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>birthday<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 6.释放资源</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				res<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 将集合对象返回</span>
	<span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>根据id查询学生信息</strong></p>
<pre><code class="prism language-java"><span class="token comment">/*
	根据id查询学生信息
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Student</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">ResultSet</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 1.注册驱动</span>
		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 2.获取数据库连接</span>
		con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db11"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.获取执行者对象</span>
		stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4.执行sql语句，并接收返回的结果集</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student WHERE sid = "</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
		res <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 5.处理结果集</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			<span class="token class-name">Integer</span> sid <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> name <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Integer</span> age <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Date</span> birthday <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">// 封装学生对象</span>
            stu<span class="token punctuation">.</span><span class="token function">setSid</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span><span class="token punctuation">;</span>
            stu<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
            stu<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 6.释放资源</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>res <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				res<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 将对象返回</span>
    <span class="token keyword">return</span> stu<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>新增学生信息</strong></p>
<pre><code class="prism language-java"><span class="token comment">/*
	添加学生信息
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Student</span> stu<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 1.注册驱动</span>
		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 2.获取数据库连接</span>
		con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db11"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.获取执行者对象</span>
		stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4.执行sql语句，并接收返回的结果集</span>
		<span class="token class-name">Date</span> d <span class="token operator">=</span> stu<span class="token punctuation">.</span><span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> birthday <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO student VALUES ('"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>birthday<span class="token operator">+</span><span class="token string">"')"</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 5.处理结果集</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 6.释放资源</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 将结果返回</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>修改学生信息</strong></p>
<pre><code class="prism language-java"><span class="token comment">/*
	修改学生信息
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Student</span> stu<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 1.注册驱动</span>
		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 2.获取数据库连接</span>
		con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db11"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.获取执行者对象</span>
		stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4.执行sql语句，并接收返回的结果集</span>
		<span class="token class-name">Date</span> d <span class="token operator">=</span> stu<span class="token punctuation">.</span><span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> birthday <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"UPDATE student SET sid='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',name='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',age='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',birthday='"</span><span class="token operator">+</span>birthday<span class="token operator">+</span><span class="token string">"' WHERE sid='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 5.处理结果集</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 6.释放资源</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 将结果返回</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>删除学生信息</strong></p>
<pre><code class="prism language-java"><span class="token comment">/*
	删除学生信息
*/</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 1.注册驱动</span>
		<span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 2.获取数据库连接</span>
		con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://192.168.23.129:3306/db11"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.获取执行者对象</span>
		stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 4.执行sql语句，并接收返回的结果集</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"DELETE FROM student WHERE sid='"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 5.处理结果集</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">// 6.释放资源</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
				stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 将结果返回</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_7284"></a>工具类</h3>
<h4><a id="_7286"></a>抽取工具类</h4>
<ol><li> <p>编写配置文件<br/> 在src目录下创建config.properties 配置文件</p> <pre><code class="prism language-properties">driverClass=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3006/db4
username=root
password=密码
</code></pre> </li><li> <p>编写JDBC 工具类</p> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Demo</span><span class="token punctuation">.</span>utils<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Driver</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtils</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 私有构造方法</span>
    <span class="token keyword">private</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    
    <span class="token comment">// 2. 声明所需要的配置变量</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> driverClass<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> con<span class="token punctuation">;</span>
    
    <span class="token comment">// 3. 提供静态代码块。读取配置文件的信息为变量赋值，注册驱动</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 读取配置文件的信息为变量赋值</span>
            <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"config.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Properties</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            prop<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            driverClass <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            url <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            username <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            password <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 注册驱动</span>
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
            
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 4. 提供获取数据库连接方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> con<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 5. 提供释放资源的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">Statement</span> stat<span class="token punctuation">,</span> <span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">Statement</span> stat<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol>
<h4><a id="_7395"></a>优化学生案例</h4>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Demo</span><span class="token punctuation">.</span>dao<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Demo</span><span class="token punctuation">.</span>domain<span class="token punctuation">.</span>Student<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">study<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">Demo</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span>JDBCUtils<span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentDaoImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StudentDao</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*
        查询所有学生信息
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取执行者对象</span>
            stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 执行sql语句，并接收返回的结果集</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
            res <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 处理结果集</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Integer</span> sid <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> name <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Integer</span> age <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Date</span> birthday <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span>sid<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>birthday<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 释放资源</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span> stat<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将集合对象返回</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
        条件查询，根据id获取学生信息
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Student</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取执行者对象</span>
            stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 执行sql语句，并接收返回的结果集</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student WHERE sid = "</span> <span class="token operator">+</span> id<span class="token punctuation">;</span>
            res <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 处理结果集</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Integer</span> sid <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> name <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Integer</span> age <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">Date</span> birthday <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 封装学生对象</span>
                stu<span class="token punctuation">.</span><span class="token function">setSid</span><span class="token punctuation">(</span>sid<span class="token punctuation">)</span><span class="token punctuation">;</span>
                stu<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                stu<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
                stu<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>birthday<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 释放资源</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>stat<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将对象返回</span>
        <span class="token keyword">return</span> stu<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
        新增学生信息
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Student</span> stu<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取执行者对象</span>
            stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 执行sql语句，并接收返回的结果集</span>
            <span class="token class-name">Date</span> d <span class="token operator">=</span> stu<span class="token punctuation">.</span><span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> birthday <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO student VALUES ('"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"','"</span><span class="token operator">+</span>birthday<span class="token operator">+</span><span class="token string">"')"</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 处理结果集</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 释放资源</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将结果返回</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
        修改学生信息
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Student</span> stu<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取执行者对象</span>
            stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 执行sql语句，并接收返回的结果集</span>
            <span class="token class-name">Date</span> d <span class="token operator">=</span> stu<span class="token punctuation">.</span><span class="token function">getBirthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SimpleDateFormat</span> sdf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> birthday <span class="token operator">=</span> sdf<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"UPDATE student SET sid='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',name='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',age='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"',birthday='"</span><span class="token operator">+</span>birthday<span class="token operator">+</span><span class="token string">"' WHERE sid='"</span><span class="token operator">+</span>stu<span class="token punctuation">.</span><span class="token function">getSid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 处理结果集</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 释放资源</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将结果返回</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*
        删除学生信息
    */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Statement</span> stat <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取执行者对象</span>
            stat <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 执行sql语句，并接收返回的结果集</span>
            <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"DELETE FROM student WHERE sid='"</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> stat<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 处理结果集</span>

        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 释放资源</span>
            <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 将结果返回</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_7592"></a>注入攻击</h3>
<ul><li>什么是SQL注入攻击<br/> 就是利用SQL语句的漏洞来对系统进行攻击</li></ul>
<pre><code class="prism language-java"><span class="token comment">/*
        使用Statement的登录方法，有注入攻击
     */</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findByLoginNameAndPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> loginName<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//定义必要信息</span>
	<span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">Statement</span> st <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.获取连接</span>
		conn <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//2.定义SQL语句</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user WHERE loginname='"</span><span class="token operator">+</span>loginName<span class="token operator">+</span><span class="token string">"' AND password='"</span><span class="token operator">+</span>password<span class="token operator">+</span><span class="token string">"'"</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//3.获取操作对象，执行sql语句，获取结果集</span>
		st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		rs <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//4.获取结果集</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//5.封装</span>
            user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setUid</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"uid"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setUcode</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"ucode"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"gender"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setDutydate</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"dutydate"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setBirthday</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            user<span class="token punctuation">.</span><span class="token function">setLoginname</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"loginname"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//6.返回</span>
		<span class="token keyword">return</span> user<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>st<span class="token punctuation">,</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>在上面代码中，登录时账户随便输入，密码输入bbb’ or ‘1’ = '1 就会直接登录成功<br/> 执行者对象会执行<code>SELECT * FROM user WHERE loginname='aaa' AND password='bbb' or '1' = '1'</code>语句</p>
</blockquote>
<ul><li> <p>SQL注入攻击的原理</p>
<ul><li>按照正常道理来说，我们在密码处输入的内容，都应该认为是密码的组成</li><li>但是现在Statement对象在执行sql语句时，将密码的一部分内容当作查询条件来执行了</li></ul> </li><li> <p>SQL注入攻击的解决</p>
<ul><li> <p>PreparedStatement 预编译执行者对象</p>
<ul><li>在执行sql语句之前，将sql语句进行提前编译。明确sql语句的格式后，就不会改变了。剩余的内容都会认为是参数</li><li>SQL语句中的参数使用<code>?</code>作为占位符</li></ul> </li><li> <p>为<code>?</code>占位符赋值的方法：<code>setXxx(参数1,参数2);</code></p>
<ul><li> <p>Xxx代表：数据类型</p> </li><li> <p>参数1：? 的位置编号(编号从1开始)</p> </li><li> <p>参数2：? 的实际参数</p> <pre><code class="prism language-java"><span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM user WHERE loginname=? AND password=?"</span><span class="token punctuation">;</span>
<span class="token class-name">PreparedStatement</span> st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
st<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>loginName<span class="token punctuation">)</span><span class="token punctuation">;</span>
st<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>

rs <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> </li></ul> </li><li> <p>执行SQL 语句</p>
<ul><li>执行 insert、update、delete 语句：<code>int executeUpdate();</code></li><li>执行select 语句：<code>ResultSet executeQuery();</code></li></ul> </li></ul> </li></ul>
<h3><a id="_7677"></a>事务管理</h3>
<ol><li> <p>JDBC 如何管理事务</p>
<ul><li>管理事务的功能类：Connection 
    <ul><li>开启事务：<code>setAutoCommit(boolean autoCommit);</code> 参数为false，则开启事务</li><li>提交事务：<code>commit();</code></li><li>回滚事务：<code>rollback();</code></li></ul> </li></ul> </li><li> <p>演示批量添加数据并在业务层管理事务</p> <pre><code class="prism language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchAdd</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取数据库连接对象</span>
	<span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">//开启事务</span>
		con<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">User</span> user <span class="token operator">:</span> users<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			<span class="token comment">//1.创建ID,并把UUID中的-替换</span>
			<span class="token class-name">String</span> uid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//2.给user的uid赋值</span>
			user<span class="token punctuation">.</span><span class="token function">setUid</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token comment">//3.生成员工编号</span>
			user<span class="token punctuation">.</span><span class="token function">setUcode</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//出现异常</span>
			<span class="token comment">//int n = 1 / 0;</span>

			<span class="token comment">//4.保存</span>
				userDao<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">//提交事务</span>
		con<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token comment">//回滚事务</span>
		<span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            con<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//释放资源</span>
        <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol>
<h3><a id="_7730"></a>连接池</h3>
<blockquote>
<p>数据库连接是一种关键的、有限的、昂贵的资源，这一点在多用户的网页应用体现的尤为突出</p>
<p>对数据库连接的管理能显著影响到整个应用程序的<mark>性能指标</mark>，数据库连接池正是针对这个问题提出来的</p>
</blockquote>
<ul><li>数据库连接池<mark>负责分配</mark>、<mark>管理和释放数据库连接</mark>，它允许应用程序<mark>重复使用</mark>一个现有的数据库连接，而不是再重新建立一个。这项技术能明显提高对数据库操作的性能</li></ul>
<h4><a id="_7738"></a>自定义数据库连接池</h4>
<p><strong>DataSource</strong></p>
<ul><li>javax.sql.DataSource 接口：数据源（数据库连接池）。<mark>Java官方提供的数据库连接池规范（接口）</mark></li><li>如果想完成数据库连接池技术，就必须实现<mark>DataSource</mark> 接口</li><li>核心功能：获取数据库连接对象：<code>Connection getConnection();</code></li></ul>
<p><strong>自定义数据库连接池</strong></p>
<ol><li>定义一个类，实现DataSource 接口</li><li>定义一个容器，用于保存多个 Connection 连接对象</li><li>定义静态代码块，通过 JDBC 工具类获取10个连接保存到容器中</li><li>重写 getConnection方法，从容器中获取一个连接并返回</li><li>定义 getSize方法，用于获取容器的大小并返回</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo01</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   自定义数据库连接池
* */</span>

<span class="token keyword">import</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">JDBCUtils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLFeatureNotSupportedException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>logging<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDataSource</span> <span class="token keyword">implements</span> <span class="token class-name">DataSource</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1.准备容器。保存多个连接对象（通过Collections的方法获取一个线程安全的集合对象）</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> pool <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">synchronizedList</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 2. 定义静态代码块，通过工具类获取10个连接对象</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token class-name">JDBCUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pool<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 3. 重写getConnection方法，获取连接对象</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pool<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">Connection</span> con <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> con<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"连接数量已用尽"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 4. 定义getSize方法，获取连接池容器的大小</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> pool<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> iface<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isWrapperFor</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> iface<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PrintWriter</span> <span class="token function">getLogWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLogWriter</span><span class="token punctuation">(</span><span class="token class-name">PrintWriter</span> out<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLoginTimeout</span><span class="token punctuation">(</span><span class="token keyword">int</span> seconds<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getLoginTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Logger</span> <span class="token function">getParentLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLFeatureNotSupportedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>测试</strong></p>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo01</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDataSourceTest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 1. 创建连接池对象</span>
        <span class="token class-name">MyDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 2.通过连接池对象获取连接对象</span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3. 查询学生表全部信息</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 用完还是关闭连接了，r存在问题</span>
        con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_7879"></a>归还连接</h4>
<ul><li>归还数据库连接的方式 
  <ul><li>继承方式</li><li>装饰设计模式</li><li>适配器设计模式</li><li>动态代理方式</li></ul> </li></ul>
<p><strong>继承方式</strong>（行不通）</p>
<ul><li> <p>通过打印连接对象，发现DriverManager 获取的连接实现类是JDBC4Connection</p> </li><li> <p>那我们就可以自定义一个类，继承JDBC4Connection 这个类，重写close()方法，完成连接对象的归还</p> </li><li> <p>实现步骤</p>
<ol><li>定义一个类，继承JDBC4Connection</li><li>定义Connection 连接对象和连接池容器对象的成员变量</li><li>通过有参构造方法完成对成员变量的赋值</li><li>重写close方法，将连接对象添加到池中</li></ol> </li><li> <p>继承方式归还数据库连接存在问题</p>
<blockquote>
<p>通过查看JDBC 工具类获取连接的方法发现：我们虽然自定义了一个子类，完成了归还连接的操作。但是DriverManager 获取的还是 JDBC4Connection 这个对象，并不是我们的子类对象，而我们又不能整体去修改驱动包中类的功能，所以继承方式行不通</p>
</blockquote> </li></ul>
<p><strong>装饰设计模式</strong></p>
<ol><li> <p>装饰设计模式归还数据库连接的思想</p>
<ul><li>我们可以自定义一个类，实现Connection 接口。这样就具备了和 JDBC4Connection 相同的行为了</li><li>重写 close()方法，完成连接的归还。其余功能还调用mysql 驱动包实现类原有的方法即可</li></ul> </li><li> <p>实现步骤</p>
<ol><li>定义一个类，实现Connection接口</li><li>定义 Connection 连接对象和连接池容器对象的成员变量</li><li>通过有参构造方法完成对成员变量的赋值</li><li>重写 close() 方法，将连接对象添加到池中</li><li>剩余方法，只需要调用mysql 驱动包的连接对象完成即可</li><li>在自定义的连接池中，将获取的连接对象通过自定义连接对象进行包装</li></ol> <pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo02</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Executor</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConnection2</span> <span class="token keyword">implements</span> <span class="token class-name">Connection</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> con<span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> pool<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyConnection2</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> pool<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>con <span class="token operator">=</span> con<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pool <span class="token operator">=</span> pool<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CallableStatement</span> <span class="token function">prepareCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareCall</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">nativeSQL</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">nativeSQL</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> autoCommit<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span>autoCommit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getAutoCommit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isClosed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">isClosed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">DatabaseMetaData</span> <span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setReadOnly</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> readOnly<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setReadOnly</span><span class="token punctuation">(</span>readOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isReadOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">isReadOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCatalog</span><span class="token punctuation">(</span><span class="token class-name">String</span> catalog<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setCatalog</span><span class="token punctuation">(</span>catalog<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCatalog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getCatalog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTransactionIsolation</span><span class="token punctuation">(</span><span class="token keyword">int</span> level<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setTransactionIsolation</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getTransactionIsolation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getTransactionIsolation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">SQLWarning</span> <span class="token function">getWarnings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getWarnings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">clearWarnings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">clearWarnings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CallableStatement</span> <span class="token function">prepareCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareCall</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getTypeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getTypeMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTypeMap</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setTypeMap</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setHoldability</span><span class="token punctuation">(</span><span class="token keyword">int</span> holdability<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setHoldability</span><span class="token punctuation">(</span>holdability<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getHoldability</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getHoldability</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Savepoint</span> <span class="token function">setSavepoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">setSavepoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Savepoint</span> <span class="token function">setSavepoint</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">setSavepoint</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token class-name">Savepoint</span> savepoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span>savepoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">releaseSavepoint</span><span class="token punctuation">(</span><span class="token class-name">Savepoint</span> savepoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">releaseSavepoint</span><span class="token punctuation">(</span>savepoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Statement</span> <span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetHoldability<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">,</span>resultSetHoldability<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetHoldability<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">,</span>resultSetHoldability<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CallableStatement</span> <span class="token function">prepareCall</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetType<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetConcurrency<span class="token punctuation">,</span> <span class="token keyword">int</span> resultSetHoldability<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareCall</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>resultSetType<span class="token punctuation">,</span>resultSetConcurrency<span class="token punctuation">,</span>resultSetHoldability<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span> autoGeneratedKeys<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>autoGeneratedKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columnIndexes<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>columnIndexes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PreparedStatement</span> <span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> columnNames<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>columnNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Clob</span> <span class="token function">createClob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createClob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Blob</span> <span class="token function">createBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">NClob</span> <span class="token function">createNClob</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createNClob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">SQLXML</span> <span class="token function">createSQLXML</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createSQLXML</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token keyword">int</span> timeout<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setClientInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLClientInfoException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setClientInfo</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setClientInfo</span><span class="token punctuation">(</span><span class="token class-name">Properties</span> properties<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLClientInfoException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setClientInfo</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getClientInfo</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getClientInfo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Properties</span> <span class="token function">getClientInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getClientInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Array</span> <span class="token function">createArrayOf</span><span class="token punctuation">(</span><span class="token class-name">String</span> typeName<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elements<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createArrayOf</span><span class="token punctuation">(</span>typeName<span class="token punctuation">,</span>elements<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Struct</span> <span class="token function">createStruct</span><span class="token punctuation">(</span><span class="token class-name">String</span> typeName<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> attributes<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">createStruct</span><span class="token punctuation">(</span>typeName<span class="token punctuation">,</span>attributes<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSchema</span><span class="token punctuation">(</span><span class="token class-name">String</span> schema<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setSchema</span><span class="token punctuation">(</span>schema<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getSchema</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getSchema</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">abort</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> executor<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span>executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNetworkTimeout</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> executor<span class="token punctuation">,</span> <span class="token keyword">int</span> milliseconds<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        con<span class="token punctuation">.</span><span class="token function">setNetworkTimeout</span><span class="token punctuation">(</span>executor<span class="token punctuation">,</span>milliseconds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getNetworkTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">getNetworkTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> iface<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span>iface<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isWrapperFor</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> iface<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> con<span class="token punctuation">.</span><span class="token function">isWrapperFor</span><span class="token punctuation">(</span>iface<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <pre><code class="prism language-java"><span class="token comment">// 重写getConnection方法，获取连接对象</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pool<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token class-name">Connection</span> con <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 通过自定义的连接对原有的对象进行包装</span>
		<span class="token class-name">MyConnection2</span> myCon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyConnection2</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>pool<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> myCon<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"连接数量已用尽"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> </li></ol>
<ul><li>存在的问题<br/> 实现Connection 接口后，有大量的方法需要在自定义类中进行重写</li></ul>
<p><strong>适配器设计模式</strong></p>
<ol><li>思想 
  <ul><li>可以提供一个适配器类，实现Connection 接口，将所有的方法进行实现（除了close方法）</li><li>自定义连接类只需要继承这个适配器类，重写需要改进的close()方法即可</li></ul> </li><li>步骤 
  <ol><li>定义一个适配器类，实现Connection 接口</li><li>定义 Connection 连接对象的成员变量</li><li>通过有参构造方法完成对成员变量的赋值</li><li>重写所有方法（除了close），调用mysql 驱动包的连接对象完成即可</li><li>定义一个连接类，继承适配器类</li><li>定义 Connection 连接对象和连接池容器对象的成员变量，并通过有参构造进行赋值</li><li>重写 close()方法，完成归还连接</li><li>在自定义连接池中，将获取的连接对象通过自定义连接对象进行包装</li></ol> </li></ol>
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConnection3</span> <span class="token keyword">extends</span> <span class="token class-name">MyAdapter</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> con<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> pool<span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">MyConnection3</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">&gt;</span></span> pool<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>con <span class="token operator">=</span> con<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pool <span class="token operator">=</span> pool<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        pool<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul><li>存在的问题<br/> 自定义连接类虽然很简洁了，但适配器还是我们自己编写的，也比较麻烦</li></ul>
<h4><a id="_8263"></a>动态代理</h4>
<ul><li> <p>动态代理：在不改变目标对象方法的情况下对方法进行增强</p> </li><li> <p>组成</p>
<ul><li>被代理的对象：真实的对象</li><li>代理对象：内存中的一个对象</li></ul> </li><li> <p>要求：代理对象必须和被代理对象实现相同的接口</p> </li><li> <p>实现：<code>Proxy.newProxyInstance()</code></p>
<ul><li> <p>三个参数<br/> 类加载器：和被代理对象使用相同的类加载器（<code>对象.getClass().getClassLoader()</code>）<br/> 接口类型的Class数组:和被代理对象使用相同接口(<code>new Class[]{接口名.class}</code>)<br/> 代理规则：完成代理增强的功能（匿名内部类方式<code>new InvocationHandler(){}</code>）</p>
<blockquote>
<p>代理规则这个内部类中需要重写一个抽象方法：<code>invoke</code><br/> invoke方法三个参数，第一个参数proxy不用管<br/> 第二个method方法对象，用来表示被代理对象中的每个方法（被代理对象的每个方法在执行前都会先经过invoke方法）<br/> 第三个参数args表示被代理对象对应的形参</p>
</blockquote> </li></ul> </li></ul>
<p><strong>动态代理方式归还数据库连接</strong></p>
<ol><li>思想 
  <ul><li>我们可以通过 Proxy 来完成对Connection 实现类对象的代理</li><li>代理过程中判断如果执行的是close方法，就将连接归还池中。如果是其他方法则调用连接对象原来的功能即可</li></ul> </li><li>步骤 
  <ol><li>定义一个类，实现 DataSource 接口</li><li>定义一个容器，用于保存多个 Connection 连接对象</li><li>定义静态代码块，通过 JDBC 工具类获取10个连接保存到容器中</li><li>重写 getConnection 方法，从容器中获取一个连接</li><li>通过 Proxy 代理，如果是close 方法，就将连接归还池中。如果是其他方法则调用原有功能</li><li>定义 getSize方法，用于获取容器的大小并返回</li></ol> </li></ol>
<pre><code class="prism language-java"><span class="token comment">/*
    *   动态代理方式
*/</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>pool<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token class-name">Connection</span> con <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">Connection</span> proxyCon <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span><span class="token punctuation">)</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>con<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{<!-- --></span><span class="token class-name">Connection</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token comment">/*
		*   执行Connection实现类连接对象所有方法都会经过invoke
		* */</span>

			<span class="token annotation punctuation">@Override</span>
			<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"close"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					pool<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">return</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> proxyCon<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"连接数量已用尽"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul><li>存在的问题<br/> 我们自己写的连接池技术不够完善，功能也不够强大</li></ul>
<h4><a id="_8334"></a>开源数据库连接池</h4>
<p><strong>C3P0 数据库连接池</strong></p>
<ul><li>使用步骤 
  <ul><li>导入jar包</li><li>导入配置文件到src目录下</li><li>创建 C3P0 连接池对象</li><li>获取数据库连接进行使用</li></ul> </li></ul>
<p><mark>注意： C3P0的配置文件会自动加载，但是必须叫 c3p0-config.xml 或 c3p0-config.properties</mark></p>
<pre><code class="prism language-xml"><span class="token comment">&lt;!--配置文件--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 使用默认的配置读取连接池对象 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>default-config</span><span class="token punctuation">&gt;</span></span>
  	<span class="token comment">&lt;!--  连接参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://192.168.23.129:3306/db11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>lh密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 连接池参数 --&gt;</span>
    <span class="token comment">&lt;!--初始化连接数量--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--最大的连接数量--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--超时时间--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>3000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>default-config</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>named-config</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>otherc3p0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token comment">&lt;!--  连接参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost:3306/db15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>itheima<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- 连接池参数 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>1000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>named-config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c3p0-config</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">C3P0Test1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建c3p0数据库连接池对象</span>
        <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过连接池对象获取数据库连接</span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 执行操作</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>Druid 数据库连接池</strong></p>
<ul><li>步骤 
  <ul><li>导入jar包</li><li>编写配置文件，放在src 目录下</li><li>通过 Properties 集合加载配置文件</li><li>通过 Druid 连接池工厂类获取数据库连接池对象</li><li>获取数据库连接进行使用</li></ul> </li></ul>
<p><mark>注意：Druid 不会自动加载配置文件，需要手动加载，但是文件的名称可以自定义</mark></p>
<pre><code class="prism language-properties"># Druid配置文件
driverClassName=com.mysql.jdbc.Driver
url=jdbc:mysql://127.0.0.1:3306/db3
username=root
password=root
# 初始化连接数量
initialSize=5
# 最大连接数量
maxActive=10
# 超时时间
maxWait=3000
</code></pre>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo04</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidTest1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 获取配置文件的流对象</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">DruidTest1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 加载配置文件</span>
        <span class="token class-name">Properties</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        prop<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取数据库连接池对象</span>
        <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> <span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取数据库连接</span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 执行操作</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 释放资源</span>
        rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ps<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_8475"></a>连接池的工具类</h4>
<ol><li>私有化构造方法（不让其他人创建对象）</li><li>声明数据源变量</li><li>提供静态代码块。完成配置文件的加载以及获取数据库连接池对象</li><li>提供获取数据库连接的方法</li><li>提供获取数据库连接池对象的方法</li><li>释放资源</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   数据库连接池工具类
**/</span>



<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceUtils</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 私有化构造方法（不让其他人创建对象）</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSourceUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token comment">// 2.声明数据源变量</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token comment">// 3. 提供静态代码块。完成配置文件的加载以及获取数据库连接池对象</span>
    <span class="token keyword">static</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 完成配置文件的加载</span>
            <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">Properties</span> prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            prop<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 获取数据库连接池对象</span>
            dataSource <span class="token operator">=</span> <span class="token class-name">DruidDataSourceFactory</span><span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 4.提供获取数据库连接的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> con<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 5. 提供获取数据库连接池对象的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 6. 释放资源</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">Statement</span> stat<span class="token punctuation">,</span> <span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>rs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> con<span class="token punctuation">,</span> <span class="token class-name">Statement</span> stat<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                con<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>stat <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                stat<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token comment">/*
	测试类
*/</span>
<span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo04</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">DataSourceUtils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DruidTest2</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 通过连接池工具类获取数据库连接</span>
        <span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 执行操作</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"sid"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birthday"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>ps<span class="token punctuation">,</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3><a id="_8610"></a>框架</h3>
<blockquote>
<p>在之前的JDBC网页版案例中，定义必要的信息、获取数据库连接、释放资源都是重复的代码，我们最终的核心功能仅仅只是执行一条sql语句，所以我们可以抽取出一个 KDBC 模板类，来封装一些方法（<mark>update、query</mark>），专门帮我们执行增删改查的sql语句。<mark>将之前那些重复的操作，都抽取到模板类中的方法里，就能大大简化使用步骤</mark></p>
</blockquote>
<h4><a id="_8614"></a>源信息</h4>
<p><strong>DataBaseMetaData</strong>：数据库的源信息（了解）</p>
<ul><li><mark>java.sql.DataBaseMetaData</mark>封装了整个数据库的综合信息<br/> 例如： 
  <ul><li><code>String getDatabaseProductName()</code>：获取数据库产品的名称</li><li><code>int getDatabaseProductVersion()</code>：获取数据库产品的版本号</li></ul> </li></ul>
<p><strong>ParameterMetaData</strong>：参数的源信息</p>
<ul><li><mark>java.sql.ParameterMetaData</mark>封装的是预编译执行者对象中每个参数的类型和属性，这个对象可以通过预编译执行者对象中的<code>getParameterMetaData()</code>方法来获取</li><li>核心功能：<code>int getParameterCount()</code>用于获取sql语句中参数的个数</li></ul>
<p><strong>ResultSetMetaData</strong>：结果集的源信息</p>
<ul><li><mark>java.sql.ResultSetMetaData</mark>：封装的是结果集对象中列的类型和属性，这个对象可以通过结果集对象中的<code>getMetaData()</code>方法来获取</li><li>核心功能<br/> <code>int getColumnCount()</code>用于获取列的总数<br/> <code>String getColumnName(int i)</code>用于获取列名</li></ul>
<h4><a id="update_8635"></a>update方法</h4>
<ol><li>用于执行增删改功能的update()方法 
  <ol><li>定义所需成员变量（数据源、数据库连接、执行者、结果集）</li><li>定义有参构造，为数据源对象赋值</li><li>定义update()方法，参数：sql语句、sql语句所需参数</li><li>定义int类型变量，用于接收sql 语句执行后影响的行数</li><li>通过数据源获取一个数据库连接</li><li>通过数据库连接对象获取执行者对象并对sql语句预编译</li></ol> </li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo05</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">DataSourceUtils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token comment">/*
*   JDBC框架类
* */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCTemplate</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 1. 定义所需成员变量（数据源、数据库连接、执行者、结果集）</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> con<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">PreparedStatement</span> pst<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">ResultSet</span> rs<span class="token punctuation">;</span>

    <span class="token comment">// 2. 定义有参构造，为数据源对象赋值</span>
    <span class="token keyword">public</span> <span class="token class-name">JDBCTemplate</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataSource <span class="token operator">=</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3. 定义update()方法，参数：sql语句、sql语句所需参数</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>objs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 4. 定义int类型变量，用于接收sql 语句执行后影响的行数</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 5. 通过数据源获取一个数据库连接</span>
            con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 6. 通过数据库连接对象获取执行者对象并对sql语句预编译</span>
            pst <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 7.通过执行者对象获取参数源信息对象</span>
            <span class="token class-name">ParameterMetaData</span> parameterMetaData <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">getParameterMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 8.通过源信息对象获取sql语句中的参数个数</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> parameterMetaData<span class="token punctuation">.</span><span class="token function">getParameterCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 9.判断参数数量是否一致</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">!=</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"参数个数不匹配"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 10.为sql语句中问号占位符赋值</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                pst<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>objs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 11.执行sql语句并接收结果</span>
            result <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 12.释放资源</span>
            <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>pst<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 13.返回结果</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ol start="2"><li>测试</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo05</span><span class="token punctuation">;</span>

<span class="token comment">/*
*       模拟dao层
* */</span>

<span class="token keyword">import</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">DataSourceUtils</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCTemplateTest1</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">JDBCTemplate</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JDBCTemplate</span><span class="token punctuation">(</span><span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 删除数据测试</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"DELETE FROM student WHERE name=?"</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token string">"周七"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"删除失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 修改数据测试</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"UPDATE student SET age=? WHERE name=?"</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">37</span><span class="token punctuation">,</span><span class="token string">"周七"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"修改成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"修改失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 新增数据测试</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"INSERT INTO student VALUES (?,?,?,?)"</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token string">"周七"</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token string">"1997-07-07"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"添加成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"添加失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4><a id="_8760"></a>查询功能</h4>
<p><strong>方法介绍</strong></p>
<ul><li>查询一条记录并封装对象的方法：<code>queryForObject()</code></li><li>查询多条记录并封装集合的方法：<code>queryForList()</code></li><li>查询聚合函数并返回单条数据的方法：<code>queryForScalar()</code></li></ul>
<p><strong>实体类的编写</strong></p>
<ul><li> <p>定义一个类，提供一些成员变量<br/> <mark>注意：成员变量的数据类型和名称要和表中的列保持一致</mark></p> <pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token class-name">Integer</span> sid<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> birthday<span class="token punctuation">;</span>
<span class="token comment">// 其他就是标准类中的构造、get、set方法以及toString方法</span>
</code></pre> </li></ul>
<p><strong>处理结果集的接口</strong></p>
<ol><li>定义泛型接口 <code>ResultSetHandler&lt;T&gt;</code></li><li>定义用于处理结果集的泛型方法：<code>&lt;T&gt; T handler(ResultSet rs)</code></li></ol>
<p><mark>注意：此接口仅用于为不同处理结果集的方式提供规范，具体的实现类还需要自行编写</mark></p>
<p><strong>处理结果集的接口实现类BeanHandler</strong></p>
<ol><li>定义一个类，实现ResultSetHandler接口</li><li>定义Class对象类型变量</li><li>通过有参构造为变量赋值</li><li>重写handler方法。用于将一条记录封装到自定义对象中</li><li>声明自定义对象类型</li><li>创建传递参数的对象，为自定义对象赋值</li><li>判断结果集中是否有数据</li><li>通过结果集对象获取结果集源信息的对象</li><li>通过结果集源信息对象获取列数</li><li>通过循环遍历列数</li><li>通过结果集源信息对象获取列名</li><li>通过列名获取该列的数据</li><li>创建属性描述器对象，将获取到的值通过该对象的set方法进行赋值</li><li>返回封装好的对象</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo05<span class="token punctuation">.</span>handler</span><span class="token punctuation">;</span>

<span class="token comment">/*
    实现类1：用于将查询到的一条记录，封装为Student对象并返回

*/</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span><span class="token class-name">PropertyDescriptor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSetMetaData</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 定义一个类，实现ResultSetHandler接口</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 2. 定义Class对象类型变量</span>
    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">;</span>

    <span class="token comment">// 3. 通过有参构造为变量赋值</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanHandler</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanClass <span class="token operator">=</span> beanClass<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 4. 重写handler方法。用于将一条记录封装到自定义对象中</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 5. 声明自定义对象类型</span>
        <span class="token class-name">T</span> bean <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 6. 创建传递参数的对象，为自定义对象赋值</span>
            bean <span class="token operator">=</span> beanClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 7. 判断结果集中是否有数据</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 8. 通过结果集对象获取结果集源信息的对象</span>
                <span class="token class-name">ResultSetMetaData</span> metaData <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 9. 通过结果集源信息对象获取列数</span>
                <span class="token keyword">int</span> count <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 10. 通过循环遍历列数</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 11. 通过结果集源信息对象获取列名</span>
                    <span class="token class-name">String</span> columnName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 12. 通过列名获取该列的数据</span>
                    <span class="token class-name">Object</span> value <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 13. 创建属性描述器对象，将获取到的值通过该对象的set方法进行赋值</span>
                    <span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">(</span>columnName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>beanClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 获取set方法</span>
                    <span class="token class-name">Method</span> writeMethod <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 执行set方法，给成员变量赋值</span>
                    writeMethod<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 14. 返回封装好的对象</span>
        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><mark>用于查询一条记录并封装对象的方法 queryForObject()</mark></p>
<pre><code class="prism language-java"><span class="token comment">/*
*   执行查询的方法：将一条记录封装成一个自定义类型对象并返回
* */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">T</span> <span class="token function">queryForObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> rsh<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>objs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">T</span> obj <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 通过数据源获取一个数据库连接</span>
        con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过数据库连接对象获取执行者对象并对sql语句预编译</span>
        pst <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过执行者对象获取参数源信息对象</span>
        <span class="token class-name">ParameterMetaData</span> parameterMetaData <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">getParameterMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过源信息对象获取sql语句中的参数个数</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> parameterMetaData<span class="token punctuation">.</span><span class="token function">getParameterCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 判断参数数量是否一致</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">!=</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"参数个数不匹配"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 为sql语句中问号占位符赋值</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            pst<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>objs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 执行sql语句并接收结果</span>
        rs <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过BeanHandler 方式对结果处理</span>
        obj <span class="token operator">=</span> rsh<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 释放资源</span>
        <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>pst<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回结果</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryForObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 查询数据测试</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student WHERE sid=?"</span><span class="token punctuation">;</span>
    <span class="token class-name">Student</span> stu <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">queryForObject</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>处理结果集的接口实现类BeanListHandler</strong></p>
<ol><li>定义BeaanListHandler l类实现 ResultSetHandler接口</li><li>定义class 对象类型的变量</li><li>定义有参构造为变量赋值</li><li>重写handler方法，用于将结果集中的所有记录封装到集合中并返回</li><li>创建List集合对象</li><li>遍历结果集对象</li><li>创建传递参数的对象</li><li>通过结果集对象获取结果集的源信息对象</li><li>通过结果集源信息对象获取列数</li><li>通过循环遍历列数</li><li>通过结果集源信息获取列名</li><li>通过列名获取该列的数据</li><li>创建属性描述器对象，将获取到的值通过对象的set方法进行赋值</li><li>将封装好的对象添加到集合中</li><li>返回集合对象</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo05<span class="token punctuation">.</span>handler</span><span class="token punctuation">;</span>

<span class="token comment">/*
    实现类２：用于将查询到的一条记录，封装为Student对象并添加到集合返回
*/</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>beans<span class="token punctuation">.</span></span><span class="token class-name">PropertyDescriptor</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSetMetaData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 定义一个类，实现ResultSetHandler接口</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanListHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 2. 定义Class对象类型变量</span>
    <span class="token keyword">private</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">;</span>

    <span class="token comment">// 3. 通过有参构造为变量赋值</span>
    <span class="token keyword">public</span> <span class="token class-name">BeanListHandler</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> beanClass<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanClass <span class="token operator">=</span> beanClass<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 4. 重写handler方法。用于将多条记录封装到自定义对象中并添加到集合返回</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 5. 声明集合对象类型</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 6. 判断结果集中是否有数据</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 7. 创建传递参数的对象，为自定义对象赋值</span>
                <span class="token class-name">T</span> bean <span class="token operator">=</span> beanClass<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 8. 通过结果集对象获取结果集源信息的对象</span>
                <span class="token class-name">ResultSetMetaData</span> metaData <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 9. 通过结果集源信息对象获取列数</span>
                <span class="token keyword">int</span> count <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// 10. 通过循环遍历列数</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 11. 通过结果集源信息对象获取列名</span>
                    <span class="token class-name">String</span> columnName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 12. 通过列名获取该列的数据</span>
                    <span class="token class-name">Object</span> value <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 13. 创建属性描述器对象，将获取到的值通过该对象的set方法进行赋值</span>
                    <span class="token class-name">PropertyDescriptor</span> pd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyDescriptor</span><span class="token punctuation">(</span>columnName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>beanClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 获取set方法</span>
                    <span class="token class-name">Method</span> writeMethod <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 执行set方法，给成员变量赋值</span>
                    writeMethod<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>bean<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 将对象保存到集合中</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>bean<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 14. 返回封装好的对象</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><mark>queryForList实现和测试</mark></p>
<pre><code class="prism language-java"><span class="token comment">/*
*   执行查询的方法：将多条记录封装成一个自定义类型对象并添加到集合返回
* */</span>
<span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryForList</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> rsh<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>objs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 通过数据源获取一个数据库连接</span>
        con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过数据库连接对象获取执行者对象并对sql语句预编译</span>
        pst <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过执行者对象获取参数源信息对象</span>
        <span class="token class-name">ParameterMetaData</span> parameterMetaData <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">getParameterMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过源信息对象获取sql语句中的参数个数</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> parameterMetaData<span class="token punctuation">.</span><span class="token function">getParameterCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 判断参数数量是否一致</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">!=</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"参数个数不匹配"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 为sql语句中问号占位符赋值</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            pst<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>objs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 执行sql语句并接收结果</span>
        rs <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过BeanListHandler 方式对结果处理</span>
        list <span class="token operator">=</span> rsh<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 释放资源</span>
        <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>pst<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回结果</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryForList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 查询数据测试</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM student"</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> list<span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">queryForList</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanListHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Student</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Student</span> stu <span class="token operator">:</span> list<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>处理结果集的接口实现类ScalarHandler</strong></p>
<ol><li>定义ScalarHandler 类实现ResultSetHandler接口</li><li>重写handler方法，用于返回一个聚合函数的查询结果</li><li>定义Long类型变量</li><li>判断结果集对象是否有数据</li><li>通过结果集对象获取结果集源信息对象</li><li>通过结果集源信息对象获取第一列的列名</li><li>通过列名获取该列的数据</li><li>将结果返回</li></ol>
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">jdbc<span class="token punctuation">.</span>demo05<span class="token punctuation">.</span>handler</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSetMetaData</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>

<span class="token comment">// 1.定义ScalarHandler&lt;T&gt; 类实现ResultSetHandler&lt;T&gt;接口</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScalarHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 2.重写handler方法，用于返回一个聚合函数的查询结果</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 3.定义Long类型变量</span>
        <span class="token class-name">Long</span> value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 4.判断结果集对象是否有数据</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token comment">// 5.通过结果集对象获取结果集源信息对象</span>
                <span class="token class-name">ResultSetMetaData</span> metaData <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 6. 获取第一列的列名</span>
                <span class="token class-name">String</span> columnName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 7.根据列名获取该列的值</span>
                value <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 8.返回结果</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><mark>queryForScalar实现和测试</mark></p>
<pre><code class="prism language-java"><span class="token comment">/*
*   执行查询的方法：将聚合函数的查询结果返回
* */</span>
<span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">queryForScalar</span><span class="token punctuation">(</span><span class="token class-name">String</span> sql<span class="token punctuation">,</span> <span class="token class-name">ResultSetHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> rsh<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>objs<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token class-name">Long</span> value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 通过数据源获取一个数据库连接</span>
        con <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过数据库连接对象获取执行者对象并对sql语句预编译</span>
        pst <span class="token operator">=</span> con<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过执行者对象获取参数源信息对象</span>
        <span class="token class-name">ParameterMetaData</span> parameterMetaData <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">getParameterMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过源信息对象获取sql语句中的参数个数</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> parameterMetaData<span class="token punctuation">.</span><span class="token function">getParameterCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 判断参数数量是否一致</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">!=</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"参数个数不匹配"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 为sql语句中问号占位符赋值</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            pst<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>objs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 执行sql语句并接收结果</span>
        rs <span class="token operator">=</span> pst<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过ScalarHandler 方式对结果处理</span>
        value <span class="token operator">=</span> rsh<span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 释放资源</span>
        <span class="token class-name">DataSourceUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>con<span class="token punctuation">,</span>pst<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回结果</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-java"><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryForScalar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token comment">// 查询聚合函数测试</span>
	<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"SELECT COUNT(*) FROM student"</span><span class="token punctuation">;</span>
    <span class="token class-name">Long</span> value <span class="token operator">=</span> template<span class="token punctuation">.</span><span class="token function">queryForScalar</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ScalarHandler</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<hr/>
<h2><a id="Mybatis_9153"></a>Mybatis</h2>
<hr/>
<h2><a id="JavaScript_9155"></a>JavaScript</h2>
<hr/>
<h2><a id="jQuery_9157"></a>jQuery</h2>
<hr/>
<h2><a id="AJAX_9159"></a>AJAX</h2>
<hr/>
<h2><a id="Vue__Element_9161"></a>Vue + Element</h2>
<hr/>
<h2><a id="Redis_9163"></a>Redis</h2>
<hr/>
<h2><a id="Maven_9165"></a>Maven基础</h2>
<hr/>
<h2><a id="Web_9167"></a>Web项目实战-黑马页面</h2>
<hr/>
<blockquote>
<p>因为正文字数过多，后续内容请前往专栏查阅： <a href="https://blog.csdn.net/qq_24980365/category_11657214.html">《Java Web从入门到实战》</a></p>
</blockquote>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>