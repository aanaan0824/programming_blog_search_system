<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-kimbie-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p><font color="brown" size="5">sklearnå®ç°å¤šé¡¹å¼çº¿æ€§å›å½’_ä¸€å…ƒ/å¤šå…ƒ ã€Pythonæœºå™¨å­¦ä¹ ç³»åˆ—ï¼ˆå…«ï¼‰ã€‘<br/> </font></p>
<div class="toc">
<h3>æ–‡ç« ç›®å½•</h3>
<ul><li><a href="#1__15">1. å¤šé¡¹å¼ä¸€å…ƒå›å½’</a></li><li><a href="#2__88">2. å¤šé¡¹å¼å¤šå…ƒå›å½’</a></li></ul>
</div>
<p></p>
<hr/>
<p><font size="5">â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”É</font><br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/7cc703968fc94dd7a64c66270f4a6193.png"/><img alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/cb71c1556ec1478ea93e34098bdfbfac.gif"/><img alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/cb71c1556ec1478ea93e34098bdfbfac.gif"/><img alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/cb71c1556ec1478ea93e34098bdfbfac.gif"/><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/f9d8225c11fe42508a5bd938f8d99e24.png"/><br/> <font size="5">â€ƒâ€ƒâ€ƒâ€ƒÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”ÉÊšÊ•Ì¯â€¢Í¡Ë”â€¢Ì¯á·…Ê”É</font></p>
<hr/>
<p><font color="purple" size="4">å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¾¯å°å•¾ï¼</font><img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/3ed5e82a513a4a41b019a3b3d747ef7f.png"/></p>
<p><font color="brown" size="4">â€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/4e3c21f29fd0442a8bf8b90dcf152434.png"/>ä»Šå¤©åˆ†äº«çš„å†…å®¹æ˜¯ï¼Œé€šè¿‡pythonçš„sklearnæœºå™¨å­¦ä¹ åº“å®ç°å¤šé¡¹å¼çº¿æ€§å›å½’ã€‚blogå†…å®¹åˆ†ä¸ºä¸€å…ƒå’Œå¤šå…ƒä¸¤éƒ¨åˆ†ã€‚æ¬¢è¿å¤§å®¶è®¿é—®ï¼</font></p>
<hr/>
<h1><a id="1__15"></a>1. å¤šé¡¹å¼ä¸€å…ƒå›å½’</h1>
<p><font size="4">è‡ªè¡Œå‡†å¤‡ä¸€ç»„æ•°æ®ï¼Œæ»¡è¶³æœ‰ä¸¤åˆ—å¯ä»¥åšä¸€å…ƒå›å½’å³å¯ã€‚è¯»å–æ•°æ®å¹¶æŸ¥çœ‹æ•°æ®åˆ†å¸ƒæƒ…å†µï¼Œä»£ç å¦‚ä¸‹ï¼š</font></p>
<pre><code class="prism language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">)</span>
features <span class="token operator">=</span> <span class="token punctuation">[</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># è·å–æ•°æ®</span>
data <span class="token operator">=</span> df<span class="token punctuation">.</span>values


<span class="token comment"># ç‰¹å¾</span>
x_data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token comment"># æ ‡ç­¾</span>
y_data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>

<span class="token comment"># æŸ¥çœ‹æ•°æ®åˆ†å¸ƒçŠ¶å†µ</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_data<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><font color="brown" size="4">ç»˜åˆ¶å‡ºæ•£ç‚¹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/9f2eced768c84f3e983bee4da8a446fd.png"/></font></p>
<hr/>
<p><font color="brown" size="4">ä»¥æœ€é«˜é¡¹ä¸º5æ¬¡é¡¹ä¸ºä¾‹ï¼Œè¿›è¡Œå¤šå…ƒå›å½’çš„å»ºæ¨¡ï¼Œå¹¶ç»˜åˆ¶å‡ºæ›²çº¿å›¾ã€‚</font></p>
<pre><code class="prism language-python"><span class="token comment"># å°†x_dataè½¬ä¸ºäºŒç»´æ•°ç»„</span>
x_data <span class="token operator">=</span> x_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>

<span class="token comment"># åˆ›å»ºå¤šé¡¹å¼å¯¹è±¡,degreeè°ƒèŠ‚å¤šé¡¹å¼çš„ç‰¹å¾ 5è¡¨ç¤ºæœ€é«˜æ¬¡é¡¹ä¸º5æ¬¡é¡¹ xçš„5æ¬¡æ–¹</span>
poly_reg <span class="token operator">=</span> PolynomialFeatures<span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment"># æ•°æ®è½¬æ¢ x0--&gt;1  x1--&gt;x  x2--&gt;x^2  x3--&gt;x^3</span>
x_poly <span class="token operator">=</span> poly_reg<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x_data<span class="token punctuation">)</span>

<span class="token comment"># å»ºæ¨¡</span>
lin_reg <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_poly<span class="token punctuation">,</span> y_data<span class="token punctuation">)</span>

<span class="token comment"># å¯è§†åŒ–</span>
<span class="token comment"># ç»˜åˆ¶x,yæ•£ç‚¹å›¾</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> y_data<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">)</span>
<span class="token comment"># ç»˜åˆ¶x,y^æ›²çº¿å›¾</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_data<span class="token punctuation">,</span> lin_reg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_poly<span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><font color="brown" size="4">å› ä¸ºé€‰æ‹©çš„æ•°æ®ä¸­æ ·æœ¬ç›¸å¯¹è¾ƒå°‘ï¼Œç»˜åˆ¶å‡ºçš„æ›²çº¿å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/1da0f4bbb51e4528817cd6d6aa56c12f.png"/></font></p>
<hr/>
<p><font color="brown" size="4">ä»¥DataFrameçš„å½¢å¼è¾“å‡ºç³»æ•°ï¼Œä»¥åŠæˆªè·ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</font></p>
<pre><code class="prism language-python">point <span class="token operator">=</span> poly_reg<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span>features<span class="token punctuation">)</span>
coefs <span class="token operator">=</span> lin_reg<span class="token punctuation">.</span>coef_
inter <span class="token operator">=</span> lin_reg<span class="token punctuation">.</span>intercept_
combine <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">zip</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> coefs<span class="token punctuation">)</span><span class="token punctuation">]</span>
sort_coef <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>combine<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">,</span> <span class="token string">'coef'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sort_coef<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>inter<span class="token punctuation">)</span>
</code></pre>
<p><font color="brown" size="4">è¾“å‡ºç»“æœ:<br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/b1e10f9472804b69812f27d35bf238f1.png"/></font></p>
<hr/>
<p><font color="brown" size="4">åšé¢„æµ‹ï¼Œä»¥x=20ä¸ºä¾‹ï¼Œé¦–å…ˆéœ€è¦æŠŠæµ‹è¯•çš„æ•°æ®è½¬ä¸ºå¤šé¡¹å¼æ ¼å¼ã€‚ç„¶åæ‰èƒ½ä½¿ç”¨predict()æ–¹æ³•ã€‚</font></p>
<pre><code class="prism language-python">test <span class="token operator">=</span> poly_reg<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>lin_reg<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><font color="brown" size="4">é¢„æµ‹ç»“æœ:<br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/2bc8ba866ba24e48a44051921d1ea401.png"/></font></p>
<hr/>
<h1><a id="2__88"></a>2. å¤šé¡¹å¼å¤šå…ƒå›å½’</h1>
<p>åšå®Œä¸€å…ƒçš„å¤šé¡¹å¼å›å½’ï¼Œæ¥ä¸‹æ¥åšå¤šå…ƒçš„å¤šé¡¹å¼å›å½’ã€‚ä»¥æœ€é«˜é¡¹æŒ‡å®šä¸º4æ¬¡é¡¹ä¸ºä¾‹ï¼Œä½¿ç”¨å†…ç½®çš„åŠ åˆ©ç¦å°¼äºšæˆ¿ä»·æ•°æ®é›†ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> fetch_california_housing <span class="token keyword">as</span> fch
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures

<span class="token comment"># è¯»å–æ•°æ®é›†</span>
house_value <span class="token operator">=</span> fch<span class="token punctuation">(</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>house_value<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
y <span class="token operator">=</span> house_value<span class="token punctuation">.</span>target
<span class="token comment"># print(x.head())</span>

<span class="token comment"># å°†æ•°æ®é›†è¿›è¡Œå¤šé¡¹å¼è½¬åŒ–</span>
poly <span class="token operator">=</span> PolynomialFeatures<span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
x_ <span class="token operator">=</span> poly<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x_<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</code></pre>
<p><font size="4">ç®€å•æŸ¥çœ‹ä¸€ä¸‹æ•°æ®çš„ç»“æ„ï¼Œä»¥ä¾¿å¯¹åç»­ä»£ç çš„è¾“å‡ºçš„ç†è§£ã€‚ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°ï¼ŒåŸå§‹æ•°æ®xä¸­ï¼Œå…±æœ‰8ä¸ªç‰¹å¾ï¼Œç»è¿‡å¤šé¡¹å¼è½¬åŒ–åï¼Œç‰¹å¾æ•°å˜ä¸ºäº†495-1=494ä¸ªã€‚<br/> <img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/712c85c36ebd48d0ad58b21c8ca4e7b9.png"/></font></p>
<hr/>
<pre><code class="prism language-python"><span class="token comment"># å¯¹åŸå§‹æ•°æ®è¿›è¡Œçº¿æ€§å›å½’è¿›è¡Œæ‹Ÿåˆ</span>
reg <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># è®¡ç®—R^2</span>
score <span class="token operator">=</span> reg<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

<span class="token comment"># å¯¹å¤šé¡¹å¼åŒ–æ•°æ®é›†è¿›è¡Œçº¿æ€§å›å½’æ‹Ÿåˆ</span>
reg_ <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
<span class="token comment"># è·å–R2æŒ‡æ•°</span>
score_ <span class="token operator">=</span> reg_<span class="token punctuation">.</span>score<span class="token punctuation">(</span>x_<span class="token punctuation">,</span> y<span class="token punctuation">)</span> 

point <span class="token operator">=</span> poly<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span>house_value<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span>
coef <span class="token operator">=</span> reg_<span class="token punctuation">.</span>coef_
combine <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">*</span><span class="token builtin">zip</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> coef<span class="token punctuation">)</span><span class="token punctuation">]</span>
sort_coef <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>combine<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">,</span> <span class="token string">'coef'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sort_coef<span class="token punctuation">)</span>
</code></pre>
<p><font color="brown" size="4">è¾“å‡ºç³»æ•°ä¸æˆªè·ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br/> â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒ<img alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" src="https://img-blog.csdnimg.cn/170e94d0e3454acc992233305882d204.png"/></font></p>
<hr/>
<p><font color="red" size="5">æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™é‡Œï¼Œå°å•¾æ„Ÿè°¢æ‚¨çš„å…³æ³¨ä¸æ”¯æŒï¼<br/> ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿ğŸŒ¹ê§”ê¦¿</font></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>