<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-github-gist" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>Python处理Excel数据的方法</h3>
<ul><li><a href="#_6">电子表格格式</a></li><li><a href="#1_xlrd__31">1.使用 xlrd 来处理；</a></li><li><a href="#2_xlwt__112">2.使用 xlwt 来处理；</a></li><li><a href="#3_openpyxl__161">3.使用 openpyxl 来处理；</a></li><li><a href="#4Pandasexcel_229">4.使用Pandas库来处理excel数据</a></li><li><a href="#_350">其他</a></li></ul>
</div>
<br/> 当Excel中有大量需要进行处理的数据时，使用Python不失为一种便捷易学的方法。接下来，本文将详细介绍多种Python方法来处理Excel数据。
<p></p>
<blockquote>
<p>Excel处理经常用于数据可视化，那么如何利用提取到的Excel数据绘图呢？</p>
<p>本文搭配<a href="https://blog.csdn.net/woaiwulima/article/details/122974918?spm=1001.2014.3001.5501">Python绘图 \ 数据可视化</a>一起使用效果更佳。</p>
</blockquote>
<h1><a id="_6"></a>电子表格格式</h1>
<p>我们在日常工作中常常见到各种后缀的电子表格，例如最常见的xlsx以及较为常见的csv、xls等格式的表格。同样是电子表格，它们之间有什么区别吗？</p>
<p>xls为Excel早期表格格式。</p>
<p>xls格式是Excel2003版本及其以前版本所生成的文件格式。 其最大的特点就是：<strong>仅有65536行、256列</strong>。因此规模过大的数据不可以使用xls格式读写。</p>
<p>xlsx为Excel2007及其之后的表格格式，也是现在Excel表格的主流格式。</p>
<p>与xls相比，它可以存储1048576行、16384列数据，存储相同数据，xlsx格式要比xls格式文件要小得很多。</p>
<p>CSV为逗号分隔值文件。</p>
<p>CSV逗号分隔值文件格式，其以纯文本形式存储表格数据（数字和文本），可以用Excel软件打开。</p>
<p>xlrd模块既可读取xls文件也可读取xlsx文件；xlwt只可写xlsx文件；openpyxl可以读写xlsx文件；pandas可以同时读写xls、xlsx文件。</p>
<h1><a id="1_xlrd__31"></a>1.使用 xlrd 来处理；</h1>
<p><strong>xlrd命令</strong></p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd
book <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'excelFile.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 获取工作簿对象</span>
names <span class="token operator">=</span> book<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 获取所有工作表名称结果为列表</span>

mySheets <span class="token operator">=</span> book<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment"># 获取工作表list。</span>
sheet <span class="token operator">=</span> mySheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    <span class="token comment"># 通过索引顺序获取。</span>
sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>         <span class="token comment"># 通过索引顺序获取。</span>
sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">u'Sheet1'</span><span class="token punctuation">)</span>  <span class="token comment"># 通过名称获取 u表示后面字符串以 Unicode 格式 进行编码，一般用在中文字符串前面，以防乱码</span>

<span class="token comment"># 获取行数和列数</span>
nrows <span class="token operator">=</span> sheet<span class="token punctuation">.</span>nrows
ncols <span class="token operator">=</span> sheet<span class="token punctuation">.</span>ncols

<span class="token comment"># 获取一行和一列</span>
row <span class="token operator">=</span> sheet<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span>               <span class="token comment"># i是行数，从0开始计数，返回list对象。</span>
col <span class="token operator">=</span> sheet<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span>               <span class="token comment"># i是列数，从0开始计数，返回list对象。</span>

<span class="token comment"># 读取单元格数据</span>
cell <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>      <span class="token comment"># 直接获取单元格数据，i是行数，j是列数，行数和列数都是从0开始计数。</span>
cell <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">.</span>value    
</code></pre>
<p>示例1：Python读取Excel文件特定数据</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd
data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'excelFile.xlsx'</span><span class="token punctuation">)</span> <span class="token comment"># 打开xlsx文件</span>
table <span class="token operator">=</span> data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># 打开第一张表</span>
nrows <span class="token operator">=</span> table<span class="token punctuation">.</span>nrows <span class="token comment"># 获取表的行数</span>

<span class="token comment"># 循环逐行输出</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
   <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># 跳过第一行</span>
       <span class="token keyword">continue</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 取前五列数据</span>
</code></pre>
<p>示例2：Python读取Excel文件所有数据</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd

workbook <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span><span class="token string">'excelFile.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 打开一个xlsx文件</span>
worksheets <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 抓取所有sheet页的名称</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'worksheets is %s'</span> <span class="token operator">%</span>worksheets<span class="token punctuation">)</span>
worksheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span><span class="token string">u'Sheet1'</span><span class="token punctuation">)</span>  <span class="token comment"># 如果存在sheet1文件则定位到sheet1</span>


<span class="token triple-quoted-string string">"""
#遍历所有sheet对象
for worksheet_name in worksheets:
	worksheet = workbook.sheet_by_name(worksheet_name)
"""</span>

<span class="token comment"># 遍历sheet1中所有行row</span>
num_rows <span class="token operator">=</span> worksheet1<span class="token punctuation">.</span>nrows
<span class="token keyword">for</span> curr_row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
    row <span class="token operator">=</span> worksheet1<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span>curr_row<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'row%s is %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>curr_row<span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 遍历sheet1中所有列col</span>
num_cols <span class="token operator">=</span> worksheet1<span class="token punctuation">.</span>ncols
<span class="token keyword">for</span> curr_col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>
	col <span class="token operator">=</span> worksheet1<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span>curr_col<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'col%s is %s'</span> <span class="token operator">%</span><span class="token punctuation">(</span>curr_col<span class="token punctuation">,</span>col<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 遍历sheet1中所有单元格cell</span>
<span class="token keyword">for</span> rown <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_rows<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> coln <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_cols<span class="token punctuation">)</span><span class="token punctuation">:</span>
		cell <span class="token operator">=</span> worksheet1<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>rown<span class="token punctuation">,</span>coln<span class="token punctuation">)</span>
		<span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span>
</code></pre>
<h1><a id="2_xlwt__112"></a>2.使用 xlwt 来处理；</h1>
<p>使用xlwt模块写入Excel文件</p>
<p>xlwt模块只能写xls文件，不能写xlsx文件(写xlsx程序不会报错，但最后文件无法直接打开，会报错)。</p>
<p>默认保存在py文件相同路径下，如果该路径下有相同文件，会被新创建的文件覆盖。</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlwt

myWorkbook <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建Excel工作薄 若要写入中文则添加参数encoding = 'utf-8'</span>

sheet <span class="token operator">=</span> myWorkbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'New_Sheet'</span><span class="token punctuation">)</span>  <span class="token comment"># 创建Excel工作表</span>

<span class="token comment">##sheet.write(m,n,'内容1') # 向单元格写入内容</span>
myStyle <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>easyxf<span class="token punctuation">(</span><span class="token string">'font: name Times New Roman, color-index red, bold on'</span><span class="token punctuation">,</span> num_format_str<span class="token operator">=</span><span class="token string">'#,##0.00'</span><span class="token punctuation">)</span>   <span class="token comment"># 数据格式</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2022</span><span class="token punctuation">,</span> myStyle<span class="token punctuation">)</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>                          <span class="token comment"># 写入A3，数值等于1</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>                          <span class="token comment"># 写入B3，数值等于1</span>
sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> xlwt<span class="token punctuation">.</span>Formula<span class="token punctuation">(</span><span class="token string">"A3+B3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment"># 写入C3，数值等于2（A3+B3）,xlwt支持写入公式</span>

<span class="token comment"># 保存</span>
myWorkbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'excelFile.xls'</span><span class="token punctuation">)</span>
</code></pre>
<p>示例：新建excel文件并写入数据</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> xlwt
<span class="token comment"># 创建workbook和sheet对象</span>
workbook <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 注意Workbook的开头W要大写</span>
sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'sheet1'</span><span class="token punctuation">,</span>cell_overwrite_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
sheet2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">'sheet2'</span><span class="token punctuation">,</span>cell_overwrite_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 向sheet页中写入数据</span>
sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'sheet1'</span><span class="token punctuation">)</span>
sheet1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'sheet1_content'</span><span class="token punctuation">)</span>
sheet2<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'sheet2'</span><span class="token punctuation">)</span>
sheet2<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'sheet2_content'</span><span class="token punctuation">)</span>

<span class="token comment"># 保存该excel文件,有同名文件时直接覆盖</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'test.xls'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'创建excel文件完成！'</span><span class="token punctuation">)</span>
</code></pre>
<h1><a id="3_openpyxl__161"></a>3.使用 openpyxl 来处理；</h1>
<p>openpyxl可以对excel文件进行读写操作</p>
<p>openpyxl模块可实现对excel文件的读、写和修改，只能处理xlsx文件，不能处理xls文件。</p>
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>writer<span class="token punctuation">.</span>excel <span class="token keyword">import</span> ExcelWriter

wb <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span><span class="token string">u"成绩单.xlsx"</span><span class="token punctuation">)</span>

sheetnames <span class="token operator">=</span> wb<span class="token punctuation">.</span>sheetnames <span class="token comment"># 获得表单名字 </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheetnames<span class="token punctuation">)</span>

title <span class="token operator">=</span> sheet1<span class="token punctuation">.</span>title  <span class="token comment"># 获取工作表名称</span>
rows <span class="token operator">=</span> sheet1<span class="token punctuation">.</span>max_row  <span class="token comment"># 获取工作表行数</span>
cols <span class="token operator">=</span> sheet1<span class="token punctuation">.</span>max_column  <span class="token comment"># 获取工作表列数</span>

sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span>sheetnames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>column<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>

sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'grade'</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">u"成绩单_new.xlsx"</span><span class="token punctuation">)</span>  <span class="token comment"># 修改元素值并另存为xlsx文件</span>

sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active  <span class="token comment"># 获取活动表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>dimensions<span class="token punctuation">)</span>     <span class="token comment"># 获取表格的尺寸大小</span>

cell1 <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">'B7'</span><span class="token punctuation">]</span>         <span class="token comment"># 获取B7单元格的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cell1<span class="token punctuation">.</span>value<span class="token punctuation">)</span>  <span class="token comment"># cell1.value获取单元格B7中的值</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">'a2'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>   <span class="token comment"># 使用excel单元格的表示法，字母不区分大小写 获取第2行第1列的数据</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>row<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>column<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>coordinate<span class="token punctuation">)</span>  <span class="token comment"># 获取某个格子的行数、列数以及坐标</span>

cell <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">'A1:A5'</span><span class="token punctuation">]</span>  <span class="token comment"># 使用sheet['A1:A5']获取A1到A5的数据</span>
<span class="token comment">##print(cell)</span>
<span class="token comment"># 打印A1到A5的数据</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> cell<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
</code></pre>
<pre><code class="prism language-python"><span class="token comment"># openpyxl读取excel文件</span>

book <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 创建工作簿 如果写入中文为乱码，可添加参数encoding = 'utf-8'</span>
sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">'Sheet_name'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 创建工作表,0表示创建的工作表在工作薄最前面</span>
sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">,</span><span class="token string">'content1'</span><span class="token punctuation">)</span>  <span class="token comment"># 向单元格写入内容：</span>
book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'excelFile'</span><span class="token punctuation">)</span>  <span class="token comment"># 保存工作簿,默认保存在py文件相同路径下，如果该路径下有相同文件，会被新创建的文件覆盖。</span>
</code></pre>
<pre><code class="prism language-python"><span class="token comment"># openpyxl修改excel文件</span>

sheet<span class="token punctuation">.</span>insert_rows<span class="token punctuation">(</span>m<span class="token punctuation">)</span>和sheet<span class="token punctuation">.</span>insert_cols<span class="token punctuation">(</span>n<span class="token punctuation">)</span>分别表示在第m行、第n列前面插入行、列
sheet<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span>m<span class="token punctuation">)</span>和sheet<span class="token punctuation">.</span>delete_cols<span class="token punctuation">(</span>n<span class="token punctuation">)</span>分别表示删除第m行、第n列
修改单元格内容：sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'内容1'</span>或者sheet<span class="token punctuation">[</span><span class="token string">'B3'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'内容2'</span> 
在最后追加行：sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>可迭代对象<span class="token punctuation">)</span>
</code></pre>
<h1><a id="4Pandasexcel_229"></a>4.使用Pandas库来处理excel数据</h1>
<p>Pandas 可以从各种文件格式比如 CSV、JSON、SQL、Microsoft Excel 导入数据。</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

mydata <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token string">'sites'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"SZ"</span><span class="token punctuation">,</span> <span class="token string">"BJ"</span><span class="token punctuation">,</span> <span class="token string">"SS"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'number'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

myvar <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>mydata<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myvar<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
output:
  sites  number
0    SZ       1
1    BJ       2
2    SS       3
'''</span>
</code></pre>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

file_path <span class="token operator">=</span> <span class="token string">r'example.xlsx'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">)</span> <span class="token comment"># sheet_name不指定时默认返回全表数据</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>  <span class="token comment"># 打印表数据，如果数据太多，会略去中间部分</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 打印头部数据，仅查看数据示例时常用</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>  <span class="token comment"># 打印列标题</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>  <span class="token comment"># 打印行</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"ave"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># 打印指定列</span>

<span class="token comment"># 描述数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>写excel</p>
<pre><code class="prism language-python"><span class="token keyword">from</span> pandas <span class="token keyword">import</span> DataFrame

data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'zs'</span><span class="token punctuation">,</span> <span class="token string">'ls'</span><span class="token punctuation">,</span> <span class="token string">'ww'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token string">'woman'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
df <span class="token operator">=</span> DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'new.xlsx'</span><span class="token punctuation">)</span>
</code></pre>
<p>修改excel–以修改原Excel文件中gender列数据为例，把girl修改为female，boy修改为male：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">from</span> pandas <span class="token keyword">import</span> DataFrame

file_path <span class="token operator">=</span> <span class="token string">r'test.xlsx'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'girl'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'female'</span>
df<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'boy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'male'</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>

DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">'Sheet1'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>row_index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>val1<span class="token punctuation">,</span> val2<span class="token punctuation">,</span> val3<span class="token punctuation">]</span>  <span class="token comment"># 新增行</span>
df<span class="token punctuation">[</span>colo_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># 新增列</span>
</code></pre>
<p>示例1：读取excel数据</p>
<pre><code class="prism language-python"><span class="token comment"># 导入pandas模块</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 直接默认读取到这个Excel的第一个表单</span>
sheet <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'test.xlsx'</span><span class="token punctuation">)</span>

<span class="token comment"># 默认读取前5行数据</span>
data<span class="token operator">=</span>sheet<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"获取到所有的值:\n{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 格式化输出</span>

<span class="token comment"># 也可以通过指定表单名来读取数据</span>
sheet2<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'test.xlsx'</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">'test'</span><span class="token punctuation">)</span>
data2<span class="token operator">=</span>sheet2<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 默认读取前5行数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"获取到所有的值:\n{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 格式化输出</span>
</code></pre>
<p>示例2：操作Excel中的行列</p>
<pre><code class="prism language-python"><span class="token comment"># 导入pandas模块</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
sheet<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'test.xlsx'</span><span class="token punctuation">)</span>  <span class="token comment"># 这个会直接默认读取到这个Excel的第一个表单</span>

<span class="token comment"># 读取制定的某一行数据:</span>
data<span class="token operator">=</span>sheet<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values   <span class="token comment"># 0表示第一行 这里读取数据并不包含表头</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"读取指定行的数据：\n{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 读取指定的多行：</span>
data2<span class="token operator">=</span>sheet<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"读取指定行的数据：\n{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 获取行号输出：</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"输出行号列表"</span><span class="token punctuation">,</span>sheet<span class="token punctuation">.</span>index<span class="token punctuation">.</span>values<span class="token punctuation">)</span>

<span class="token comment"># 获取列名输出：</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"输出列标题"</span><span class="token punctuation">,</span>sheet<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>values<span class="token punctuation">)</span>
</code></pre>
<h1><a id="_350"></a>其他</h1>
<p>当收到的文件既有xls，又有xlsx时，先转换为统一格式再做统计修改更方便。</p>
<p>需要用到pywin32库，方法如下：</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">as</span> win32

fname <span class="token operator">=</span> <span class="token string">r"C:\User\Desktop\test.xlsx"</span>
excel <span class="token operator">=</span> win32<span class="token punctuation">.</span>gencache<span class="token punctuation">.</span>EnsureDispatch<span class="token punctuation">(</span><span class="token string">'Excel.Application'</span><span class="token punctuation">)</span>
wb <span class="token operator">=</span> excel<span class="token punctuation">.</span>Workbooks<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>fname<span class="token punctuation">)</span>

<span class="token comment"># wb.SaveAs(fname+"x", FileFormat = 51)    #FileFormat = 51 is for .xlsx extension</span>
wb<span class="token punctuation">.</span>SaveAs<span class="token punctuation">(</span>fname<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> FileFormat <span class="token operator">=</span> <span class="token number">56</span><span class="token punctuation">)</span>      <span class="token comment">#FileFormat = 56 is for .xls extension</span>
wb<span class="token punctuation">.</span>Close<span class="token punctuation">(</span><span class="token punctuation">)</span>
excel<span class="token punctuation">.</span>Application<span class="token punctuation">.</span>Quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>