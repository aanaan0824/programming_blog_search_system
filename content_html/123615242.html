<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h4><a id="_0"></a>一、数据库的建立</h4>
<p>安装Navicat for MySQL,用于连接Mysq数据库，可以进行可视化操作</p>
<p><img alt="请添加图片描述" src="https://img-blog.csdnimg.cn/b4f2fe43d37e4357a29776b203657e7b.png"/></p>
<p>打开之后，新建连接，输入连接名（自定义），主机名（IP地址localhost也就是本地的IP地址，localhost=127.0.0.1），端口号（默认端口号3306），用户名（root最高的账号），密码，这里测试的是连接本地MySQL数据库</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/40cf5d7fef744abcac2e0db16087f872.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>新建数据库，取名为test<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/012a40bd1cb44d3d88c2c350282d46d5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>在test数据库下建立三张表，student,teacher,grade</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/65d4b7aab8764bd485bf419b25f79b7a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/608745218587491799c042b46d023807.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e2f382045e484c22924d27ef208bb0b2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/223a1e22ff764d0490266cc2f5e8e1b1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<h4><a id="EF_43"></a>二、EF框架简介</h4>
<h5><a id="1ORM_45"></a>1、什么是ORM框架</h5>
<p>ORM全称为Object Relational Mapping ，即对象关系映射，作用在关系型数据库中和对象的一个映射。</p>
<pre><code class="prism language-c#">//student实体
public class student
{
    public string name;
    public int id;  
}
</code></pre>
<p>对应数据库：</p>
<table><thead><tr><th>表(student)</th><th>对象(student)</th></tr></thead><tbody><tr><td>标签(name,id)</td><td>字段(name, id)</td></tr><tr><td>数据(“张三”，1001)</td><td>值(“张三”，1001)</td></tr></tbody></table>
<h5><a id="2EF_67"></a>2、什么是EF框架</h5>
<p>EF框架全称是Entity Framework ，是ADO.NET中一套支持开发面向数据的软件应用框架，相当于c#的一个ORM框架。</p>
<p>EF框架的三种开发模式：DataBase First 数据库优先，Model First 模型优先，Code First代码优先。</p>
<h4><a id="EF_75"></a>三、EF框架的搭建</h4>
<p>创建一个控制台项目</p>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-uxOAzb1y-1647763959187)(C:\Users\Administrator\Desktop\c#\控制台.PNG)]</p>
<p>取名demo<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/48d7754a0f7048579027dc6036de995f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>打开管理NuGet程序包</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/f28b31ea43e24b888f1663cb3fec1447.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_10,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>安装**Microsoft.EntityFrameworkCore，**<strong>Microsoft.EntityFrameworkCore.Abstractions</strong>，<strong>Pomelo.EntityFrameworkCore.MySql</strong>，<strong>EntityFramework</strong>包<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/72f42abe75fa47eea19cf0f51c56fbfa.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>新建一个类，命名为MySQLDB;<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/4f02f5032a2e46258350268dd73459a8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>打开MySQLDB类，输入以下代码：</p>
<pre><code class="prism language-c#">using Microsoft.EntityFrameworkCore;    //引入包

namespace demo
{
    public class MySQLDB:DbContext      //继承与DbContext
    {
        string connstring         ="server=localhost;database=test;user=root;password=123456;charset=utf-8"
        protected override void OnConfiguring(DbContextOptionsBuider optionBuilder)
        {
            optionsBuilder.UseMySql(connstring, ServerVersion.AutoDetect(connstring));
        }
    }
}
</code></pre>
<p>新建三个类，分别为student.cs，teacher.cs，grade.cs对应数据库中的三张表；在类中各添加它们对应的属性；</p>
<p>student类</p>
<pre><code class="prism language-c#">namespace demo
{
    public class student
    {
        public int StudentID{get;set;}
        
        public string userName{get;set;}
        
        public int TeacherID{get;set;}
    }
}
</code></pre>
<p>teacher类</p>
<pre><code class="prism language-c#">namespace demo
{
    public class teacher
    {
        public int TeacherID{get;set;}
        
        public string TeacherName{get;set;}
    }
}
</code></pre>
<p>grade类</p>
<pre><code class="prism language-c#">namespace demo
{
        public class grade
        {
            public int GradeID{get;set;}
            
            public float Chinese{get;set;}
            
            public float Math{get;set;}
            
            public float English{get;set;}
            
            public int StudentID{get;set;}
        }
}

</code></pre>
<p>在MySQLDB类中，添加前三个类的DbSet</p>
<pre><code class="prism language-c#">using Microsoft.EntityFrameworkCore;    //引入包

namespace demo
{
    public class MySQLDB:DbContext      //继承与DbContext
    {
        string connstring                                                       = "server=localhost;database=test;user=root;password=123456;charset=utf-8";
        
        
        protected override void OnConfiguring(DbContextOptionsBuider                                                          optionBuilder)
        {
            optionsBuilder.UseMySql(connstring);
        }
    }
    
    
    public DbSet&lt;student&gt;student{get;set;}
    
    public DbSet&lt;teacher&gt;teacher{get;set;}
    
    public DbSet&lt;grade&gt; grade{get;set;}
}
</code></pre>
<p>建好之后的demo文件</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/ff65da76eb044dcda1ab75515e7eb27e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_9,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>打开main类，进行测试是否连接成功</p>
<pre><code class="prism language-c#">internal class main
{
    static void Main(string[] args)
    {
        using(var db = new MySQLDB)
        {
            Student stu = db.student.Find(1001);
            Console.WriteLine(stu.userName);
            
        }
        Console.ReadKey();
    }
}
</code></pre>
<p>运行结果：</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/536b95064fc54ba792e3bb111e56a480.png#pic_center"/></p>
<h4><a id="Linq_241"></a>三、Linq的链表查询</h4>
<p>1.添加学生信息</p>
<pre><code class="prism language-c#">void StudentAdd(student student)
{
    using(MySQLDB db = new MySQLDB())
    {
        int teracher_value = 0;
        var query = db.student.Tolist();
        for (int i=0; i&lt; query.Count;i++)
        {
            if(query[i].StudentID == student.StudentID)
            {
                if(query[i].TeacherID == student.TeacherID)
                {
                    teacher_value++;
                }
                Console.WriteLine("学号已存在，请重新输入");
                return;
            }
        }
        if(teacher_value == 0)
        {
            Console.WriteLine("教师不存在，请重新输入")
        }
        db.student.Add(student);
        db.SaveChanges();
        Console.WriteLine("添加成功");
    }
    
}
</code></pre>
<p>2.三张表连接查询<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b45a1779b2354ed09e19ca460b665a65.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA56yU5LiL55qE5pyo5rC0,size_20,color_FFFFFF,t_70,g_se,x_16#pic_center"/></p>
<p>结果:</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/48a3c617fe004559b4e3f07a4ea433fb.png#pic_center"/></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>