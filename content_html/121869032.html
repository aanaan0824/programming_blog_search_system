<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p>在日常工作中，可能需要结合网上现在的一些API或者公司提供的数据接口来得到相应的数据或者实现对应的功能。<br/> 因此API的调用和数据接口的访问都是做数据分析的一个常用操作，如何快速实现API和数据接口的调用，网上一般提供很多语言版本，但追根溯源采取的方式都是利用HTTP请求的方式来进行实现的。由于本人常用Python，本篇文章也主要采用Python来作为工具来进行介绍如何操作。<br/> </p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><ul><li><ul><li><a href="#API_3">API</a></li><li><a href="#_9">数据接口</a></li><li><a href="#API_14">API的调用和数据接口的调用</a></li><li><a href="#_20">调用的基础-请求方法</a></li><li><ul><li><a href="#GET__23">GET 请求</a></li><li><a href="#POST__25">POST 请求</a></li><li><a href="#GETPOST_28">GET和POST请求的区别</a></li><li><a href="#PythonGETPOST_37">Python实现GET请求和POST请求</a></li><li><ul><li><a href="#GET_40">GET请求</a></li><li><a href="#POST_51">POST请求</a></li><li><ul><li><a href="#POST_55">POST请求的三种提交形式</a></li></ul>
</li></ul>
</li><li><a href="#API_77">一个简单API请求的实例</a></li><li><ul><li><ul><li><a href="#GET_80">GET请求</a></li><li><a href="#POST_91">POST请求</a></li><li><a href="#_121">数据提取</a></li></ul>
</li></ul>
</li><li><a href="#_173">数据接口实例</a></li><li><ul><li><a href="#POST_175">POST请求调用数据接口</a></li><li><a href="#GET_217">GET请求调用数据接口</a></li></ul>
</li></ul>
</li><li><a href="#API_293">几种常见API调用实例</a></li><li><ul><li><ul><li><a href="#AIAPI_294">百度AI相关API</a></li><li><a href="#API_318">百度地图API</a></li><li><a href="#API_351">有道API</a></li><li><ul><li><a href="#uuid_391">uuid</a></li><li><a href="#sign_393">sign</a></li></ul>
</li></ul>
</li><li><a href="#API_399">常用API分享</a></li><li><a href="#_407">总结</a></li></ul>
</li></ul>
</li></ul>
</li></ul>
</div>
<p></p>
<h3><a id="API_3"></a>API</h3>
<p>API：简单来说就是一组协议、一个工具或者一组规则，定义不同应用程序之间的通信方法，把具体实现的过程隐藏起来，只暴露必须调用的部分给开发者使用。</p>
<p>上面的定义比较官方，这里简单举个例子来说明一下，比如在现在外面的麦当劳等快餐店都采取手机线上下单，前台拿餐的过程。而在这个过程，作为消费者通常在手机上选好对应的餐品然后点击下单付款，然后等待前台叫号拿餐即可。而这个过程具体怎么实现的我们并不知道，整个过程有对应的app或者小程序通信到厨房数据，然后厨师制作出餐。而这个APP和小程序就充当对应的API功能。</p>
<p>举一个简单的例子，一个社交平台它每天收到各种语言的评论信息，而作为对应的分析人员面对复杂的语言数据处理，是一个大难题，有人可能说开发一个模型来实现翻译整合功能，这个方法虽然听起来可行但是成本代价高，其次为了解决一个问题，而又去开发一个比较困难的问题。这个与原本的目标偏离越来越远，这个时候就可以借助国内比较成熟的翻译平台API,直接处理现有的数据。这样相对而言成本代价小，更便捷也更能快速实现现有的目标。而API的作用在这里就毋庸置疑了。</p>
<h3><a id="_9"></a>数据接口</h3>
<p>数据接口： 简单来说就是一组封装的数据集口令，就是按照对应的规则发送相应的参数，然后返回对应的相关数据信息。API的调用和数据接口的这两个在日常调用时很类似的，相对而言API的范围更宽广，实现的功能也比较多，而数据接口日常充当的就是一个取数工具比较多。</p>
<p>就比如说大型电商公司公司一般用统一的SKU来对商品进行管理，而比如这家公司是作为一个品牌商，它会在不同平台上面进行售卖，而在这些平台上面映射的商品标识ID就不同于公司的SKU。因为公司的SKU不仅基于商品而且还考虑各个地方仓库以及产品的各个型号，而这个映射相对而言就比较复杂。<br/> 而在处理不同平台的数据人员一般也不能直接使用公司的数据库来对商品进行分析，因为颗粒度太细，分析起来比较复杂困难，这个时候就可以根据对应功能的要求让开发在现有系统是开发一个单独的数据接口提供相应的公司，避免直接请求数据库过程复杂等相应信息。但数据接口相对实时的数据库存在一定的延迟。</p>
<h3><a id="API_14"></a>API的调用和数据接口的调用</h3>
<p>API和数据接口通过前面的举例论述，大致理解起来也比较简单，而具体怎么实现API的调用和数据接口的调用这里简单介绍一下。<br/> 简单来说API的调用和接口的调用都是类似一个HTTP请求，而调用最主要就是根据相应的规则将请求方式、请求头、URL、以及请求体封装好然后发送请求，就可以实现相应的调用。</p>
<p>但数据接口和API两个的调用相比较而言来，一般数据接口比较简单，很多情况下数据接口是在公司内网数据访问所以请求信息比较简单，而API大多是第三方企业开发对外的服务属于一种商业服务，相对而言为了保证请求的安全，考虑的更为全面，加入了AK、SK、签名、时间戳等信息比较复杂。<br/> 而追本溯源这两个调用都是类似HTTP请求，具体调用大致差不多，主要就是API调用中包含的请求参数的信息更多。而具体怎么实现下面将简单的介绍一下。</p>
<h3><a id="_20"></a>调用的基础-请求方法</h3>
<p>一般而言，常见的HTTP请求调用方式有很多，这方面的资源比较多，可以网上自己查阅，这里就简单说说常见的两种请求方法。</p>
<h4><a id="GET__23"></a>GET 请求</h4>
<p>GET请求简单来说就是从服务器上获取资源，可以载入到浏览器的缓存中。</p>
<h4><a id="POST__25"></a>POST 请求</h4>
<p>POST请求一般而言以表单形式向服务器发送请求，请求参数包含在请求体当中可能导致资源的创建和改变。POST请求的信息不能缓存在浏览器中。<br/> 这两个请求方法说起来很简单，但最重要的一点就是了解这两种请求的区别，从而为接口的设计和API的使用更加熟悉。</p>
<h4><a id="GETPOST_28"></a>GET和POST请求的区别</h4>
<p>1.GET请求请求长度最多1024kb，POST对请求数据没有限制。这一点原因是很多时候GET请求把对应的信息放在URL中，而URL的长度有限，导致GET请求的长度也受到一定的限制。而POST请求相应的参数信息放在请求体body中所以一般不受长度限制。<br/> 2.POST请求比GET更安全一些，因为GET请求中URL包含了相应的信息，页面会被浏览器缓存，其他人可以看到相应的信息。<br/> 3.GET产生一个TCP数据包，POST产生两个TCP数据包。<br/> GET请求的时候将header、data一起发送出去，然后服务器响应返回200。而POST则是先发送header，等待服务器响应100，然后发送data，最后服务器响应返回200.但在这里注意，POST请求分为两次，但是请求体body是紧随在header之后发送的，所以这之间时间可以微乎不计。<br/> 4.GET请求只支持URL编码，而POST相对而言有多种编码方式。<br/> 5.GET请求参数是通过URL传递的，多个参数以&amp;连接，POST请求放在request body中。<br/> 6.GET请求只支持ASCII字符，而POST没有限制。<br/> 一般而言浏览器输入网址可以直接访问的一般是GET请求。</p>
<h4><a id="PythonGETPOST_37"></a>Python实现GET请求和POST请求</h4>
<p>上面大篇幅的介绍了一些数据接口、API相关知识以及请求方法，使用起来比较简单，下面可以大致熟悉一下相应的请求方式。一般直接使用Python的request库就可以。</p>
<h5><a id="GET_40"></a>GET请求</h5>
<pre><code class="prism language-python"><span class="token keyword">import</span> request
<span class="token comment"># GET请求发送的参数一定要是字典的形式，可以发送多个参数。</span>
<span class="token comment"># 发送格式：{'key1':value1', 'key2':'value2', 'key3', 'value3'}</span>
<span class="token comment"># 样例不能运行</span>
url <span class="token operator">=</span><span class="token string">'http://www.xxxxx.com'</span>
params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user'</span><span class="token punctuation">:</span><span class="token string">'lixue'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">111112333</span><span class="token punctuation">}</span>
requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data <span class="token operator">=</span> parms<span class="token punctuation">)</span>
</code></pre>
<h5><a id="POST_51"></a>POST请求</h5>
<p>POST请求一般有三种提交形式：application/x-www-form-urlencoded、multipart/form-data、application/json.<br/> 具体查看是三种的哪一种请求方式：谷歌浏览器检查 → Network →选择加载文件 → Headers → Reuqest Headers → Content-Type<br/> 具体编码方式为下面三种，可以了解具体的请求实现，一般公司内部的数据接口设置了局域网所以有的可以不需要加header。</p>
<h6><a id="POST_55"></a>POST请求的三种提交形式</h6>
<p>1.最常见的post提交数据以form表单为主：application/x-www-form-urlencoded</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> request
data<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'k1'</span><span class="token punctuation">:</span><span class="token string">'v1'</span><span class="token punctuation">,</span><span class="token string">'k2'</span><span class="token punctuation">:</span><span class="token string">'v2'</span><span class="token punctuation">}</span>
headers<span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user-agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36'</span><span class="token punctuation">}</span>
requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>
</code></pre>
<p>2.以json格式提交数据：application/json</p>
<pre><code class="prism language-python">data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'user'</span><span class="token punctuation">:</span><span class="token string">'lixue'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">12233</span><span class="token punctuation">}</span>
data_json <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>params<span class="token punctuation">)</span>
requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">,</span>data <span class="token operator">=</span> data_json<span class="token punctuation">)</span>
</code></pre>
<p>3.一般用来传文件（爬虫很少用到）：multipart/form-data</p>
<pre><code class="prism language-python">files <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">'files'</span><span class="token punctuation">:</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'c://xxx.txt'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>headers <span class="token operator">=</span> headers<span class="token punctuation">,</span>files <span class="token operator">=</span> files<span class="token punctuation">)</span>
</code></pre>
<h4><a id="API_77"></a>一个简单API请求的实例</h4>
<p>通过上面简单的介绍，对于具体请求大致了解，这里搜集了一个简单的API聚合中心，提供了很多挺好用的功能。下面以这个简单API的作一个简单的示范<a href="https://api.apishop.net/common/weather/get15DaysWeatherByArea">API地址</a>。<br/> 这个小实例采取的是天气API接口获取近15天的天气。在使用这个API之前记得获取相应的apiKey和查看具体的使用文档。这个API网站一般对相应API提供一定的免费次数，可以充当学习使用，而且支持GET和POST请求。刚好可以适合练手。</p>
<h6><a id="GET_80"></a>GET请求</h6>
<pre><code class="prism language-python">params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"apiKey"</span><span class="token punctuation">:</span><span class="token string">'换成你的apikey'</span><span class="token punctuation">,</span>
    <span class="token string">"area"</span><span class="token punctuation">:</span><span class="token string">'武汉市'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
url <span class="token operator">=</span> <span class="token string">'https://api.apishop.net/common/weather/get15DaysWeatherByArea'</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>params<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre>
<h6><a id="POST_91"></a>POST请求</h6>
<p>这里的POST请求也就是对应上面的最常见的post提交数据以form表单为主：application/x-www-form-urlencoded</p>
<pre><code class="prism language-python">url <span class="token operator">=</span> <span class="token string">'https://api.apishop.net/common/weather/get15DaysWeatherByArea'</span>
params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">"apiKey"</span><span class="token punctuation">:</span><span class="token string">'换成你的apikey'</span><span class="token punctuation">,</span>
    <span class="token string">"area"</span><span class="token punctuation">:</span><span class="token string">'武汉市武昌区'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>params<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre>
<p>在调用这种API接口一般都需要进行一个状态码等返回信息测试，检查请求是否正常,可以按照下面的给出参考。</p>
<pre><code class="prism language-Python">params = {
    "apiKey":'换成你的apikey,
    "area":'武汉市',
}
url = 'https://api.apishop.net/common/weather/get15DaysWeatherByArea'
response = requests.post(url,params)
print(response.text)
if response.status_code != 200:
    raise ConnectionError(f'{url} status code is {response.status_code}.')
response = json.loads(response.content)
if 'desc' not in response.keys():
    raise ValueError(f'{url} miss key msg.')
if response['desc'] != '请求成功':
    print(11)
</code></pre>
<h6><a id="_121"></a>数据提取</h6>
<p>其实API的调用很简单，但其中最核心的其实是返回信息中数据的抽取，一般而言返回的信息都是json形式，需要从中用字典键值对方式提取数据，下面这块根据请求的数据返回相应的信息并提取出来，获取信息后面将会展示。</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd 
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> json
<span class="token keyword">def</span> <span class="token function">get_url</span><span class="token punctuation">(</span>area<span class="token punctuation">)</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'https://api.apishop.net/common/weather/get15DaysWeatherByArea'</span>
    params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"apiKey"</span><span class="token punctuation">:</span><span class="token string">'换成你的apikey'</span><span class="token punctuation">,</span>
        <span class="token string">"area"</span><span class="token punctuation">:</span>area<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>params<span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ConnectionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>url<span class="token punctuation">}</span></span><span class="token string"> status code is </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">.'</span></span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'desc'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>url<span class="token punctuation">}</span></span><span class="token string"> miss key msg.'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">[</span><span class="token string">'desc'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'请求成功'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response
<span class="token keyword">def</span>  <span class="token function">extract_data</span><span class="token punctuation">(</span>web_data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data<span class="token operator">=</span> web_data<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'dayList'</span><span class="token punctuation">]</span>
    weather_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'city'</span><span class="token punctuation">,</span><span class="token string">'daytime'</span><span class="token punctuation">,</span><span class="token string">'day_weather'</span><span class="token punctuation">,</span><span class="token string">'day_air_temperature'</span><span class="token punctuation">,</span><span class="token string">'day_wind_direction'</span><span class="token punctuation">,</span><span class="token string">'day_wind_power'</span><span class="token punctuation">,</span>                                           <span class="token string">'night_weather'</span><span class="token punctuation">,</span><span class="token string">'night_air_temperature'</span><span class="token punctuation">,</span><span class="token string">'night_wind_direction'</span><span class="token punctuation">,</span><span class="token string">'night_wind_power'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        city <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"area"</span><span class="token punctuation">]</span>
        daytime <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"daytime"</span><span class="token punctuation">]</span>
        daytime <span class="token operator">=</span> daytime<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>daytime<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>daytime<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        day_weather <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"day_weather"</span><span class="token punctuation">]</span>
        day_air_temperature <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'day_air_temperature'</span><span class="token punctuation">]</span>
        day_wind_direction <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"day_wind_direction"</span><span class="token punctuation">]</span>
        day_wind_power <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'day_wind_power'</span><span class="token punctuation">]</span>
        night_weather <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'night_weather'</span><span class="token punctuation">]</span>
        night_air_temperature <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"night_air_temperature"</span><span class="token punctuation">]</span>
        night_wind_direction <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'night_wind_direction'</span><span class="token punctuation">]</span>
        night_wind_power <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"night_wind_power"</span><span class="token punctuation">]</span>
        c <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"city"</span><span class="token punctuation">:</span> city<span class="token punctuation">,</span><span class="token string">"daytime"</span><span class="token punctuation">:</span> daytime<span class="token punctuation">,</span><span class="token string">"day_weather"</span><span class="token punctuation">:</span>day_weather<span class="token punctuation">,</span><span class="token string">"day_air_temperature"</span><span class="token punctuation">:</span>day_air_temperature<span class="token punctuation">,</span>
             <span class="token string">"day_wind_direction"</span><span class="token punctuation">:</span>day_wind_direction<span class="token punctuation">,</span><span class="token string">"day_wind_power"</span><span class="token punctuation">:</span>day_wind_power<span class="token punctuation">,</span><span class="token string">"night_weather"</span><span class="token punctuation">:</span>night_weather<span class="token punctuation">,</span>
             <span class="token string">"night_air_temperature"</span><span class="token punctuation">:</span>night_air_temperature<span class="token punctuation">,</span><span class="token string">"night_wind_direction"</span><span class="token punctuation">:</span>night_wind_direction<span class="token punctuation">,</span>
             <span class="token string">"night_wind_power"</span><span class="token punctuation">:</span>night_wind_power<span class="token punctuation">}</span>
        weather_data <span class="token operator">=</span> weather_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">,</span>ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
    weather_data<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">r"C:\Users\zhangfeng\Desktop\最近十五天天气.xlsx"</span><span class="token punctuation">,</span>index <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> weather_data
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请输入对应的城市"</span><span class="token punctuation">)</span>
    web_data <span class="token operator">=</span> get_url<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    weather_data <span class="token operator">=</span> extract_data<span class="token punctuation">(</span>web_data<span class="token punctuation">)</span>
</code></pre>
<p>部分结果如下图：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/461f979ec77f4bcdb487cfa8809b09c2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5bOwz4Bfz4A=,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h4><a id="_173"></a>数据接口实例</h4>
<p>在日常学习中数据接口的使用可能相对较少，数据接口的应用场景大多数情况下是应用在公司内部调取数据的情况下比较多，所以一般很少见到，这里展示工作中遇到的两个数据接口的使用，由于工作考虑，展示的代码属于样例，并不能调用。可以参考一下调用实现以及规范。</p>
<h5><a id="POST_175"></a>POST请求调用数据接口</h5>
<pre><code class="prism language-python"><span class="token comment"># 销售状态查询</span>
<span class="token keyword">def</span> <span class="token function">id_status</span><span class="token punctuation">(</span>id_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    id_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>id_dir<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span> 
    id_data<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'shop'</span><span class="token punctuation">,</span> <span class="token string">'Campaign Name'</span><span class="token punctuation">,</span><span class="token string">'Ad Group Name'</span><span class="token punctuation">,</span><span class="token string">'Item Id'</span><span class="token punctuation">]</span>  <span class="token comment"># 方便后期处理更改列名</span>
    id_data<span class="token punctuation">[</span><span class="token string">"Item Id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> id_data<span class="token punctuation">[</span><span class="token string">"Item Id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>
    id_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>id_data<span class="token punctuation">[</span><span class="token string">'Item Id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>id_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    id_list <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>id_list<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>id_list<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        id_list <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>id_list<span class="token punctuation">)</span>
    id1 <span class="token operator">=</span> id_list<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'，'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    request_url <span class="token operator">=</span> <span class="token string">"http://xxx.com"</span>
    <span class="token comment"># 通过item_id查询id状态</span>
    params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"item_id"</span><span class="token punctuation">:</span>id1<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    data_json <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token comment"># 属于POST第二种请求方式</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>request_url<span class="token punctuation">,</span> data <span class="token operator">=</span> data_json<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ConnectionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>request_url<span class="token punctuation">}</span></span><span class="token string"> status code is </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">.'</span></span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'message'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>request_url<span class="token punctuation">}</span></span><span class="token string"> miss key msg.'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'ok'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    data<span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token string">'result'</span><span class="token punctuation">]</span>
    ad_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Item Id'</span><span class="token punctuation">,</span><span class="token string">'saleStatusName'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        item_id <span class="token operator">=</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"item_id"</span><span class="token punctuation">]</span>
        saleStatusName <span class="token operator">=</span> data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'saleStatusName'</span><span class="token punctuation">]</span>
        c <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token string">"Item Id"</span><span class="token punctuation">:</span> item_id<span class="token punctuation">,</span>
         <span class="token string">"saleStatusName"</span><span class="token punctuation">:</span> saleStatusName<span class="token punctuation">,</span>
         <span class="token punctuation">}</span>
        ad_data <span class="token operator">=</span> ad_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">,</span>ignore_index <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
    total_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>ad_data<span class="token punctuation">,</span>id_data<span class="token punctuation">,</span>on <span class="token operator">=</span><span class="token string">'Item Id'</span><span class="token punctuation">,</span> how <span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>
    df_column <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token string">'shop'</span><span class="token punctuation">,</span> <span class="token string">'Campaign Name'</span><span class="token punctuation">,</span><span class="token string">'Ad Group Name'</span><span class="token punctuation">,</span><span class="token string">'Item Id'</span><span class="token punctuation">,</span><span class="token string">'saleStatusName'</span><span class="token punctuation">]</span>
    total_data <span class="token operator">=</span> total_data<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>columns<span class="token operator">=</span>df_column<span class="token punctuation">)</span>
    <span class="token keyword">return</span> total_data
</code></pre>
<h5><a id="GET_217"></a>GET请求调用数据接口</h5>
<pre><code class="prism language-python"><span class="token comment">### 库存数据查询</span>
<span class="token keyword">def</span> <span class="token function">Smart_investment_treasure</span><span class="token punctuation">(</span>investment_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    product_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>investment_dir<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>product_data<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
        product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token operator">=</span>product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>
        product_list<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        product_id <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>product_list<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        product_id<span class="token operator">=</span><span class="token string">'没有数据'</span> 
    <span class="token keyword">return</span> product_id    
<span class="token keyword">def</span> <span class="token function">stock_query</span><span class="token punctuation">(</span>investment_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
        product_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>investment_dir<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>product_data<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">:</span>
        product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token operator">=</span>product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span>
        product_list<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>product_data<span class="token punctuation">[</span><span class="token string">'商品ID'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        product_id <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>product_list<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        product_id<span class="token operator">=</span><span class="token string">'没有数据'</span> 
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>product_id<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        product_id <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">)</span>
    product_id <span class="token operator">=</span> product_id<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'，'</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    request_url <span class="token operator">=</span> <span class="token string">"http://xxx.com"</span>
    <span class="token comment"># 通过ali_sku查询erpsku</span>
    params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">"product_id"</span><span class="token punctuation">:</span>product_id<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>request_url<span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token comment">#属于GET请求</span>
    <span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ConnectionError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>request_url<span class="token punctuation">}</span></span><span class="token string"> status code is </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">}</span></span><span class="token string">.'</span></span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'msg'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>request_url<span class="token punctuation">}</span></span><span class="token string"> miss key msg.'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> response<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'success'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
    data<span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>
    <span class="token comment"># requestProductId = id.split(',')</span>
    id_state<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    overseas_stock<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    china_stock<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    id_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        inventory_data<span class="token operator">=</span> data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'list'</span><span class="token punctuation">]</span>
        overseas_inventory<span class="token operator">=</span><span class="token number">0</span>
        ep_sku_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        sea_test<span class="token operator">=</span><span class="token number">0</span>
        china_inventory<span class="token operator">=</span><span class="token number">0</span>
        test<span class="token operator">=</span><span class="token string">"paused"</span>
        id_test<span class="token operator">=</span><span class="token string">""</span>
        id_test<span class="token operator">=</span>data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'product_id'</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>inventory_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"simple_code"</span><span class="token punctuation">]</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"FR"</span><span class="token punctuation">,</span><span class="token string">"DE"</span><span class="token punctuation">,</span><span class="token string">"PL"</span><span class="token punctuation">,</span><span class="token string">"CZ"</span><span class="token punctuation">,</span><span class="token string">"RU"</span><span class="token punctuation">]</span> <span class="token keyword">and</span> inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"erp_sku"</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> ep_sku_list<span class="token punctuation">:</span>
                overseas_inventory<span class="token operator">+=</span>inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"ipm_sku_stock"</span><span class="token punctuation">]</span>
                ep_sku_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"erp_sku"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                sea_test<span class="token operator">=</span><span class="token number">1</span>
            <span class="token keyword">elif</span> inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"simple_code"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'CN'</span><span class="token punctuation">:</span>
                china_inventory<span class="token operator">+=</span><span class="token builtin">int</span><span class="token punctuation">(</span>inventory_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"ipm_sku_stock"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> overseas_inventory<span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">:</span>
            test<span class="token operator">=</span><span class="token string">"open"</span>
        <span class="token keyword">elif</span> overseas_inventory<span class="token operator">==</span><span class="token number">0</span> <span class="token keyword">and</span> china_inventory<span class="token operator">&gt;</span><span class="token number">100</span><span class="token punctuation">:</span>
            test<span class="token operator">=</span><span class="token string">"open"</span>
        id_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>id_test<span class="token punctuation">)</span>
        overseas_stock<span class="token punctuation">.</span>append<span class="token punctuation">(</span>overseas_inventory<span class="token punctuation">)</span>
        china_stock<span class="token punctuation">.</span>append<span class="token punctuation">(</span>china_inventory<span class="token punctuation">)</span>           
        id_state<span class="token punctuation">.</span>append<span class="token punctuation">(</span>test<span class="token punctuation">)</span>
    c<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">"id"</span><span class="token punctuation">:</span>id_list<span class="token punctuation">,</span>
       <span class="token string">"id_state"</span><span class="token punctuation">:</span>id_state<span class="token punctuation">,</span>
       <span class="token string">"海外仓库存"</span><span class="token punctuation">:</span>overseas_stock<span class="token punctuation">,</span>
       <span class="token string">"国内大仓"</span><span class="token punctuation">:</span>china_stock
       <span class="token punctuation">}</span>
    ad_data<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ad_data
</code></pre>
<h3><a id="API_293"></a>几种常见API调用实例</h3>
<h5><a id="AIAPI_294"></a>百度AI相关API</h5>
<p>百度API是市面上面比较成熟的API服务，在大二期间由于需要使用一些文本打标签和图像标注工作了解了百度API,避免了重复造轮子，当时百度API的使用比较复杂，参考文档很多不规范，之前也写过类似的百度API调用极其不稳定，但最近查阅了百度API参考文档，发现目前的调用非常简单。<br/> 通过安装百度开发的API第三方包，直接利用Python调包传参即可使用非常简单。这里展示一个具体使用，相应安装第三方库官方文档查阅。</p>
<pre><code class="prism language-python"><span class="token triple-quoted-string string">'''
第三方包名称：baidu-aip 
百度API 
""" 你的 APPID AK SK """
APP_ID = '你的 App ID'
API_KEY = '你的 Api Key'
SECRET_KEY = '你的 Secret Key'
参考文档：https://ai.baidu.com/ai-doc/NLP/tk6z52b9z
'''</span>
<span class="token keyword">from</span> aip <span class="token keyword">import</span> AipNlp
APP_ID <span class="token operator">=</span> <span class="token string">'xxxxxx'</span>
API_KEY <span class="token operator">=</span> <span class="token string">'换成你的apikey'</span>
SECRET_KEY <span class="token operator">=</span> <span class="token string">'换成你的SECRET_KEY'</span>
client <span class="token operator">=</span> AipNlp<span class="token punctuation">(</span>APP_ID<span class="token punctuation">,</span> API_KEY<span class="token punctuation">,</span> SECRET_KEY<span class="token punctuation">)</span>
text <span class="token operator">=</span> <span class="token string">"我还没饭吃"</span>
<span class="token comment"># 调用文本纠错 </span>
client<span class="token punctuation">.</span>ecnet<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/1ef21104af2344f7a31d82771f9866ea.png"/></p>
<h5><a id="API_318"></a>百度地图API</h5>
<p>这个API当时为了设计一个推荐体系引入经纬度换算地址，这样为数据计算带来极大的方便，而且对于一般人来说文本地址相比经纬度信息更加直观，然后结合Python一个第三方包实现两个地址之间经纬度计算得出相对的距离。</p>
<pre><code class="prism language-python"><span class="token comment"># https://lbsyun.baidu.com/</span>
<span class="token comment"># 计算校验SN(百度API文档说明需要此步骤)</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> warnings
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> urllib
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> json
<span class="token keyword">from</span> geopy<span class="token punctuation">.</span>distance <span class="token keyword">import</span> geodesic
location <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"输入所在的位置\n"</span><span class="token punctuation">)</span>  <span class="token comment"># "广州市天河区"</span>
ak <span class="token operator">=</span> <span class="token string">"ak1111"</span> <span class="token comment"># 参照自己的应用</span>
sk <span class="token operator">=</span> <span class="token string">"sk111111"</span> <span class="token comment"># 参照自己的应用</span>
url <span class="token operator">=</span> <span class="token string">"http://api.map.baidu.com"</span>
query <span class="token operator">=</span> <span class="token string">"/geocoding/v3/?address={0}&amp;output=json&amp;ak={1}&amp;callback=showLocation"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> ak<span class="token punctuation">)</span>
encodedStr <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>query<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token string">"/:=&amp;?#+!$,;'@()*[]"</span><span class="token punctuation">)</span>
sn <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote_plus<span class="token punctuation">(</span>encodedStr <span class="token operator">+</span> sk<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 使用requests获取返回的json</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"{0}{1}&amp;sn={2}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> query<span class="token punctuation">,</span> sn<span class="token punctuation">)</span><span class="token punctuation">)</span>
data1<span class="token operator">=</span>response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"showLocation&amp;&amp;showLocation("</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">")"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
lat <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"location"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lat"</span><span class="token punctuation">]</span>
lon <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"location"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lng"</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"纬度: "</span><span class="token punctuation">,</span> lat<span class="token punctuation">,</span> <span class="token string">" 经度: "</span><span class="token punctuation">,</span> lon<span class="token punctuation">)</span>
distance<span class="token operator">=</span>geodesic<span class="token punctuation">(</span><span class="token punctuation">(</span>lat<span class="token punctuation">,</span>lon<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">39.98028</span><span class="token punctuation">,</span><span class="token number">116.30495</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"距离{0}这个位置大概{1}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b04f8352be094eca9509c0cec2688b8b.png"/></p>
<h5><a id="API_351"></a>有道API</h5>
<p>在网上查阅了很多API,前面介绍的几种API,他们携带的请求参数信息相对比较简单，调用实现和基础请求没啥区别，这里找了一个相对而言比较多的请求参数的API,相对而言这种API数据付费API,它的安全性以及具体的实现都相对复杂,但是更适合商用。下面可以简单看看。</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> uuid
youdao_url <span class="token operator">=</span> <span class="token string">'https://openapi.youdao.com/api'</span>   <span class="token comment"># 有道api地址</span>
translate_text <span class="token operator">=</span> <span class="token string">"how are you!"</span>
input_text <span class="token operator">=</span> <span class="token string">""</span>
<span class="token comment"># 当文本长度小于等于20时，取文本</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>translate_text<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_text <span class="token operator">=</span> translate_text    
<span class="token comment"># 当文本长度大于20时，进行特殊处理</span>
<span class="token keyword">elif</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>translate_text<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    input_text <span class="token operator">=</span> translate_text<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>translate_text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> translate_text<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

uu_id <span class="token operator">=</span> uuid<span class="token punctuation">.</span>uuid1<span class="token punctuation">(</span><span class="token punctuation">)</span>
now_time <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app_id <span class="token operator">=</span> <span class="token string">'1111111'</span>
app_key <span class="token operator">=</span> <span class="token string">'11111111111'</span>
sign <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>app_id <span class="token operator">+</span> input_text <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uu_id<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>now_time<span class="token punctuation">)</span> <span class="token operator">+</span> app_key<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># sign生成</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'q'</span><span class="token punctuation">:</span>translate_text<span class="token punctuation">,</span>   <span class="token comment"># 翻译文本</span>
    <span class="token string">'from'</span><span class="token punctuation">:</span><span class="token string">"en"</span><span class="token punctuation">,</span>   <span class="token comment"># 源语言</span>
    <span class="token string">'to'</span><span class="token punctuation">:</span><span class="token string">"zh-CHS"</span><span class="token punctuation">,</span>   <span class="token comment"># 翻译语言</span>
    <span class="token string">'appKey'</span><span class="token punctuation">:</span>app_id<span class="token punctuation">,</span>   <span class="token comment"># 应用id</span>
    <span class="token string">'salt'</span><span class="token punctuation">:</span>uu_id<span class="token punctuation">,</span>   <span class="token comment"># 随机生产的uuid码</span>
    <span class="token string">'sign'</span><span class="token punctuation">:</span>sign<span class="token punctuation">,</span>   <span class="token comment"># 签名</span>
    <span class="token string">'signType'</span><span class="token punctuation">:</span><span class="token string">"v3"</span><span class="token punctuation">,</span>   <span class="token comment"># 签名类型，固定值</span>
    <span class="token string">'curtime'</span><span class="token punctuation">:</span>now_time<span class="token punctuation">,</span>   <span class="token comment"># 秒级时间戳</span>
<span class="token punctuation">}</span>
r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>youdao_url<span class="token punctuation">,</span> params <span class="token operator">=</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># 获取返回的json()内容</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"翻译后的结果："</span> <span class="token operator">+</span> r<span class="token punctuation">[</span><span class="token string">"translation"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># 获取翻译内容</span>
</code></pre>
<p>翻译后的结果：你好!<br/> 这个API调用中引用了几个真正商用中的一些为了安全性等设置的验证信息，比如uuid、sign、timestamp,这几个在API调用中也是老生常谈的几个概念，是比较全面的。下面简单介绍一下。</p>
<h6><a id="uuid_391"></a>uuid</h6>
<p>uuid码:UUID是一个128比特的数值，这个数值可以通过一定的算法计算出来。为了提高效率，常用的UUID可缩短至16位。UUID用来识别属性类型，在所有空间和时间上被视为唯一的标识。一般来说，可以保证这个值是真正唯一的任何地方产生的任意一个UUID都不会有相同的值。使用UUID的一个好处是可以为新的服务创建新的标识符。是一种独特的唯一标识符，python 第三方库uuid 提供对应的uuid生成方式，有以下的几种 uuid1(),uuid3(),uuid4(),uuid5()上面采用的是uuid1()生成，还可以使用uuid4()生成。具体的使用方法 可以参考<a href="https://www.cnblogs.com/yungiu/p/10255657.html">这篇博客</a>。</p>
<h6><a id="sign_393"></a>sign</h6>
<p>sign：一般为了防止被恶意抓包，通过数字签名等保证API接口的安全性。为了防止发送的信息被串改，发送方通过将一些字段要素按一定的规则排序后，在转化成密钥，通过加密机制发送，当接收方接受到请求后需要验证该信息是否被篡改过，也需要将对应的字段按照同样的规则生成验签sign，然后在于后台接收到的进行比对，可以发现信息是否被串改过。在上面的例子利用hashlib.sha256()来进行随机产生一段密钥，最后使用.hexdigest()返回最终的密钥。<br/> curtime：引入一个时间戳参数，保证接口仅在一分钟内有效，需要和客户端时间保持一致。避免重复访问。</p>
<p>有道API的sign构造可以到对应的<a href="https://ai.youdao.com/">官方文档</a>查看一下。因为每种API的签名构造大体都有很多不是相同的。所以一般以官方文档为主，这里对于签名的一些原理，个人只是大致了解，有想详细了解，可以自己查阅资料学习。</p>
<h4><a id="API_399"></a>常用API分享</h4>
<p>上面大致介绍了几种API的使用，但各有不同，但都是基于构造HTTP请求按照一定规则来实现的，下面补充一些可以练手也比较好用的API地址，大家可以用来平常数据获取以及学习参考。网上的API特别多，这里只是几个，有兴趣自己可以去了解，然后比较好用可以留言评论区分享出来。<br/> 1.<a href="https://www.juhe.cn/docs">聚合数据</a><br/> 2.<a href="https://ai.baidu.com/">百度大脑</a><br/> 3.<a href="https://www.apishop.net/">apishop</a><br/> 4.<a href="http://api.map.baidu.com">百度地图</a><br/> 5.<a href="https://lbs.qq.com/service/webService/webServiceGuide/webServiceSearch">腾讯地图</a><br/> 6.<a href="https://ai.youdao.com/?keyfrom=old-openapi#/">有道翻译</a></p>
<h4><a id="_407"></a>总结</h4>
<p>其实最近发现博客很久没更新，可能还是因为自己懒以及能力有限不知道该写什么，但上半年工作以及生活中发现，写作其实是一个很好的东西，可以把自己的想法记录下来，虽然可能很不成熟，但是其实对于自己的成长是很有帮助，写多了也就熟了，而且现在快餐式的互联网，让我们中断了很多思考，尤其是工作后发现，平常还是要多思考，多写作，也可以沉淀自己，后续会慢慢更新博客，但是频率可能不是很高，但是会慢慢多加入自己的思考和逻辑以及一些归纳，因为发现之前的博客太不成熟了哈哈哈。次也是一次成长吧，然后本人是在学数据分析数据挖掘的一个菜鸟，博客中可能出现的问题，希望大家积极指出，然后相互学习。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>