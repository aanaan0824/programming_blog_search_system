<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-dark" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>vue+neo4j+（neovis.js / neo4j-driver）纯前端实现知识图谱的集成</h3>
<ul><li><a href="#neo4j_2">neo4j是什么？</a></li><li><a href="#Neovisjs__8">一、Neovis.js 不用获取数据直接连接数据库绘图</a></li><li><a href="#visjs__echarts_95">二、vis.js 或者 echarts绘图</a></li><li><a href="#1_neo4jdriver__98">1、（发现一个神器） neo4j-driver 能够直接通过前端获取数据。</a></li><li><a href="#2echarts_158">2、使用echarts绘图</a></li><li><a href="#3visjs_333">3、使用vis.js绘图</a></li></ul>
</div>
<p></p>
<h1><a id="neo4j_2"></a>neo4j是什么？</h1>
<p>简单来说，这是一种比较热门的图数据库，图数据库以图形形式存储数据。 它以节点，关系和属性的形式存储应用程序的数据。 一个图由无数的节点和关系组成。<br/> 安装图数据库在这里就不介绍了，本篇主要介绍如何连接neo4j数据库，将知识图谱成功显示在前端页面中。</p>
<h1><a id="Neovisjs__8"></a>一、Neovis.js 不用获取数据直接连接数据库绘图</h1>
<p>1.、 Neovis.js与Neo4j的连接非常简单明了，并且Neovis 的数据格式与那neo4j数据库保持一致。在单个配置对象中定义标签、属性、节点和关系的样式和颜色。</p>
<p>首先下载依赖</p>
<pre><code> npm install -save neovis.js
</code></pre>
<p>在项目中引用</p>
<pre><code>import NeoVis from 'neovis.js';
</code></pre>
<p>创建用来绘图的DOM元素</p>
<pre><code class="prism language-typescript"><span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token string">"height:100%;"</span> ref<span class="token operator">=</span><span class="token string">"Screen"</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"left"</span> id<span class="token operator">=</span><span class="token string">"viz1"</span> ref<span class="token operator">=</span><span class="token string">"viz1"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
</code></pre>
<p>页面加载进来调用draw()画图函数</p>
<pre><code class="prism language-typescript">    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//neovis.js画图</span>
    methods<span class="token operator">:</span><span class="token punctuation">{<!-- --></span>
     <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token comment">//获取dom元素</span>
      <span class="token keyword">var</span> viz1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>viz1<span class="token punctuation">;</span>
      
      <span class="token comment">//创建veovis实例</span>
      <span class="token keyword">var</span> viz<span class="token punctuation">;</span>
      
      <span class="token comment">//配置项</span>
      <span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        container_id<span class="token operator">:</span> <span class="token string">"viz"</span><span class="token punctuation">,</span>
        <span class="token comment">//neo4j服务器地址，用户名 和 密码</span>
        server_url<span class="token operator">:</span> <span class="token string">"bolt://192.x.xxx.10:7687"</span><span class="token punctuation">,</span>
        server_user<span class="token operator">:</span> <span class="token string">"nexx4j"</span><span class="token punctuation">,</span>
        server_password<span class="token operator">:</span> <span class="token string">"KGxxx34"</span><span class="token punctuation">,</span>

        <span class="token operator">**</span><span class="token comment">///labels是节点央样式的配置：**</span>
        <span class="token operator">**</span><span class="token comment">/// caption ：节点显示的文字对应内容</span>
        <span class="token operator">**</span><span class="token comment">/// community： 节点颜色**</span>
        <span class="token operator">**</span><span class="token comment">/// size：节点大小**</span>
        <span class="token operator">**</span><span class="token comment">/// font：节点字体大小设置****</span>
        <span class="token operator">**</span><span class="token comment">//没有在这个地方配置的节点将会是默认样式**</span>
        labels<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"CITY"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> caption<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span> community<span class="token operator">:</span> <span class="token string">"#5496FF"</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> size<span class="token operator">:</span> <span class="token number">35</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">"#606266"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string-property property">"基本待遇政策"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> caption<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span> community<span class="token operator">:</span> <span class="token string">"#5496FF"</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span> font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> size<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">"#606266"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string-property property">"基本筹资政策"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> caption<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span> community<span class="token operator">:</span> <span class="token string">"#5496FF"</span><span class="token punctuation">,</span> size<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span> font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> size<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">"#606266"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        
        <span class="token operator">**</span><span class="token comment">///relationships是关系线段样式的配置：**</span>
        <span class="token operator">**</span><span class="token comment">/// caption ：线段显示的文字对应内容</span>
        <span class="token operator">**</span><span class="token comment">/// thickness： 线段粗细**</span>
        <span class="token operator">**</span><span class="token comment">/// font：节点字体大小设置****</span>
        <span class="token operator">**</span><span class="token comment">//没有在这个地方配置的线段将会是默认样式**</span>
        relationships<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token string-property property">"待遇支付政策"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> thickness<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> caption<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> size<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">"#606266"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string-property property">"待遇主体类别"</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> thickness<span class="token operator">:</span> <span class="token string">"count"</span><span class="token punctuation">,</span> caption<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> size<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span> color<span class="token operator">:</span> <span class="token string">"#606266"</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        
        <span class="token comment">//是否显示箭头</span>
        arrows<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

        hierarchical<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        
        <span class="token comment">// 分层结构或者默认 "hubsize"（默认）和"directed".</span>
        <span class="token comment">// hierarchical_sort_method: 'hubsize',</span>
        hierarchical_sort_method<span class="token operator">:</span> <span class="token string">'directed'</span><span class="token punctuation">,</span>

        <span class="token comment">//配置数据库查询语句，MATCH n RETURN n,尝试过不对，必须用 MATCH p=()--&gt;() RETURN p</span>
        initial_cypher<span class="token operator">:</span> <span class="token string">'MATCH p=()--&gt;() RETURN p'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      viz <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NeoVis</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
      viz<span class="token punctuation">.</span>_container <span class="token operator">=</span> viz1<span class="token punctuation">;</span>
      viz<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
</code></pre>
<h1><a id="visjs__echarts_95"></a>二、vis.js 或者 echarts绘图</h1>
<pre><code>由于这两者需要的数据格式与neo4j数据格式不同，所以需要先从前端获取数据，然后处理成我们需要的格式。
</code></pre>
<h1><a id="1_neo4jdriver__98"></a>1、（发现一个神器） neo4j-driver 能够直接通过前端获取数据。</h1>
<p>上代码， 首先下载依赖</p>
<pre><code class="prism language-typescript"> npm install <span class="token operator">-</span>save neo4j<span class="token operator">-</span>driver
</code></pre>
<p>再页面中引入</p>
<pre><code class="prism language-typescript"><span class="token keyword">var</span> neo4j <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">"neo4j-driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
   <span class="token operator">...</span>此处暂时省略<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>页面初次加载调用 this.executeCypher() 执行 Cypher 查询数据</p>
<pre><code class="prism language-typescript"> <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span>  query<span class="token operator">=</span> <span class="token string">'MATCH p=()--&gt;() RETURN p'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">executeCypher</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>executeCypher()方法定义： 该方法处理的数据格式为echarts适用格式</p>
<pre><code class="prism language-typescript">
    <span class="token comment">/**
         * 直接执行Cypher
         */</span>
    <span class="token function">executeCypher</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>echartsNode <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">//节点数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//关系线数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//echarts图例数据数</span>
      <span class="token comment">// 创建实例</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>driver <span class="token operator">=</span> neo4j<span class="token punctuation">.</span><span class="token function">driver</span><span class="token punctuation">(</span><span class="token string">'bolt://localhost:7687'</span><span class="token punctuation">,</span> neo4j<span class="token punctuation">.</span>auth<span class="token punctuation">.</span><span class="token function">basic</span><span class="token punctuation">(</span><span class="token string">'neo4j'</span><span class="token punctuation">,</span> <span class="token string">'KG****'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"🚀 ~ file: AuthorArticleSearch.vue ~ line 46 ~ mounted ~  this.drive"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

      <span class="token keyword">let</span> me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      me<span class="token punctuation">.</span>records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> session <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      session<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        me<span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>records <span class="token operator">=</span> result<span class="token punctuation">.</span>records<span class="token punctuation">;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"neo4j 查询结果"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span><span class="token function">closeLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Cypher 执行失败！"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">closeLoading</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeLoading'</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>以上我们就查询到了数据，紧接着开始处理数据，首先处理成适用echarts的数据格式</p>
<h1><a id="2echarts_158"></a>2、使用echarts绘图</h1>
<p>首先处理获取的数据</p>
<pre><code class="prism language-typescript">            <span class="token comment">/**
         * 直接执行Cypher
         */</span>
    <span class="token function">executeCypher</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>echartsNode <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">//节点数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//关系线数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//echarts图例数据数</span>
      <span class="token comment">// 创建实例</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>driver <span class="token operator">=</span> neo4j<span class="token punctuation">.</span><span class="token function">driver</span><span class="token punctuation">(</span><span class="token string">'bolt://localhost:7687'</span><span class="token punctuation">,</span> neo4j<span class="token punctuation">.</span>auth<span class="token punctuation">.</span><span class="token function">basic</span><span class="token punctuation">(</span><span class="token string">'neo4j'</span><span class="token punctuation">,</span> <span class="token string">'******'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"🚀 ~ file: AuthorArticleSearch.vue ~ line 46 ~ mounted ~  this.drive"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

      <span class="token keyword">let</span> me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      me<span class="token punctuation">.</span>records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> session <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      session<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        me<span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>records <span class="token operator">=</span> result<span class="token punctuation">.</span>records<span class="token punctuation">;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"neo4j 查询结果"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 开始处理数据</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> me<span class="token punctuation">.</span>records<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>echartsData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            name<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            category<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">.</span>labels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>echartsData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            name<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>end<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            category<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>end<span class="token punctuation">.</span>labels<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            source<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            target<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>end<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            name<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>relationship<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//删除arr中的重复对象</span>
        <span class="token keyword">var</span> arrId <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> legend <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>echartsData<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          legend<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> name<span class="token operator">:</span> item<span class="token punctuation">.</span>category <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>arrId<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            arrId<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>echartsNode<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>category <span class="token operator">=</span> <span class="token builtin">Array</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>legend<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span><span class="token function">closeLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Cypher 执行失败！"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>knowlegGraphshow <span class="token operator">=</span> <span class="token boolean">true</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">closeLoading</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeLoading'</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre>
<p>echarts配置：</p>
<pre><code class="prism language-typescript"><span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                    tooltip<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token comment">//弹窗</span>
                        show<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        <span class="token comment">// enterable: true,//鼠标是否可进入提示框浮层中</span>
                        <span class="token comment">// formatter: formatterHover,//修改鼠标悬停显示的内容</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    legend<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                        type<span class="token operator">:</span> <span class="token string">'scroll'</span><span class="token punctuation">,</span>
                        orient<span class="token operator">:</span> <span class="token string">'vertical'</span><span class="token punctuation">,</span>
                        left<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
                        top<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        bottom<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                        data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    series<span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token punctuation">{<!-- --></span>

                            categories<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>category<span class="token punctuation">,</span>
                            <span class="token comment">// categories: [{<!-- --></span>
                            <span class="token comment">//     name: "筹资渠道"</span>
                            <span class="token comment">// }],</span>
                            type<span class="token operator">:</span> <span class="token string">"graph"</span><span class="token punctuation">,</span>
                            layout<span class="token operator">:</span> <span class="token string">"force"</span><span class="token punctuation">,</span>
                            zoom<span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span>
                            symbolSize<span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
                            <span class="token comment">// 节点是否可以拖动</span>
                            draggable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            roam<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            hoverAnimation<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            <span class="token comment">// labelLayout: {<!-- --></span>
                            <span class="token comment">//     hideOverlap: true,</span>
                            <span class="token comment">// },</span>
                            legendHoverLink<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            nodeScaleRatio<span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token comment">//鼠标漫游缩放时节点的相应缩放比例，当设为0时节点不随着鼠标的缩放而缩放</span>
                            focusNodeAdjacency<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否在鼠标移到节点上的时候突出显示节点以及节点的边和邻接节点。</span>
                            <span class="token comment">// categories: categories,</span>
                            itemStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                color<span class="token operator">:</span> <span class="token string">"#67A3FF"</span><span class="token punctuation">,</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            edgeSymbol<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"arrow"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                            <span class="token comment">// edgeSymbolSize: [80, 10],</span>
                            edgeLabel<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                normal<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                    show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                                    textStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                        fontSize<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                    <span class="token function">formatter</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                        <span class="token keyword">return</span> x<span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            label<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                normal<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                    show<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                                    textStyle<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                        fontSize<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                    color<span class="token operator">:</span> <span class="token string">"#f6f6f6"</span><span class="token punctuation">,</span>
                                    textBorderColor<span class="token operator">:</span> <span class="token string">'#67A3FF'</span><span class="token punctuation">,</span>
                                    textBorderWidth<span class="token operator">:</span> <span class="token string">'1.3'</span><span class="token punctuation">,</span>
                                    <span class="token comment">// 多字换行</span>
                                    <span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                        <span class="token comment">// console.log(params);</span>
                                        <span class="token keyword">var</span> newParamsName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                        <span class="token keyword">var</span> paramsNameNumber <span class="token operator">=</span> params<span class="token punctuation">.</span>name<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
                                        <span class="token keyword">var</span> provideNumber <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token comment">//一行显示几个字</span>
                                        <span class="token keyword">var</span> rowNumber <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>paramsNameNumber <span class="token operator">/</span> provideNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                        <span class="token keyword">if</span> <span class="token punctuation">(</span>paramsNameNumber <span class="token operator">&gt;</span> provideNumber<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> rowNumber<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                                <span class="token keyword">var</span> tempStr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                                                <span class="token keyword">var</span> start <span class="token operator">=</span> p <span class="token operator">*</span> provideNumber<span class="token punctuation">;</span>
                                                <span class="token keyword">var</span> end <span class="token operator">=</span> start <span class="token operator">+</span> provideNumber<span class="token punctuation">;</span>
                                                <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> rowNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                                                    tempStr <span class="token operator">=</span> params<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> paramsNameNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
                                                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                                                    tempStr <span class="token operator">=</span> params<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">;</span>
                                                <span class="token punctuation">}</span>
                                                newParamsName <span class="token operator">+=</span> tempStr<span class="token punctuation">;</span>
                                            <span class="token punctuation">}</span>
                                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                                            newParamsName <span class="token operator">=</span> params<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
                                        <span class="token punctuation">}</span>
                                        <span class="token keyword">return</span> newParamsName<span class="token punctuation">;</span>
                                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            force<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
                                repulsion<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token comment">// 节点之间的斥力因子。支持数组表达斥力范围，值越大斥力越大。</span>
                                gravity<span class="token operator">:</span> <span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token comment">// 节点受到的向中心的引力因子。该值越大节点越往中心点靠拢。</span>
                                edgeLength<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token comment">// 边的两个节点之间的距离，这个距离也会受 repulsion影响 。值越大则长度越长</span>
                                layoutAnimation<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 因为力引导布局会在多次迭代后才会稳定，这个参数决定是否显示布局的迭代动画</span>
                                <span class="token comment">// 在浏览器端节点数据较多（&gt;100）的时候不建议关闭，布局过程会造成浏览器假死。</span>
                            <span class="token punctuation">}</span><span class="token punctuation">,</span>
                            data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">,</span>
                            links<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>links<span class="token punctuation">,</span>
                            <span class="token comment">// categories: this.categories</span>
                        <span class="token punctuation">}</span>

                    <span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
</code></pre>
<h1><a id="3visjs_333"></a>3、使用vis.js绘图</h1>
<p>下载依赖：</p>
<pre><code class="prism language-typescript">npm install <span class="token operator">-</span>s vis<span class="token punctuation">,</span>js
</code></pre>
<p>引入：</p>
<pre><code class="prism language-typescript"><span class="token comment">//import Vis from "vis";</span>
<span class="token keyword">const</span> Vis <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'vis-network/dist/vis-network.min'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'vis-network/dist/dist/vis-network.min.css'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>首先处理数据：</p>
<pre><code class="prism language-typescript">在这里插入代码片
         <span class="token comment">/**
         * 直接执行Cypher
         */</span>
    <span class="token function">executeCypher</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>echartsNode <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment">//节点数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//关系线数组</span>
      <span class="token comment">// 创建实例</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>driver <span class="token operator">=</span> neo4j<span class="token punctuation">.</span><span class="token function">driver</span><span class="token punctuation">(</span><span class="token string">'bolt://localhost:7687'</span><span class="token punctuation">,</span> neo4j<span class="token punctuation">.</span>auth<span class="token punctuation">.</span><span class="token function">basic</span><span class="token punctuation">(</span><span class="token string">'neo4j'</span><span class="token punctuation">,</span> <span class="token string">'KG****'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"🚀 ~ file: AuthorArticleSearch.vue ~ line 46 ~ mounted ~  this.drive"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">)</span>

      <span class="token keyword">let</span> me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      me<span class="token punctuation">.</span>records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> session <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>query <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
      session<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        me<span class="token punctuation">.</span>clearAll <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>records <span class="token operator">=</span> result<span class="token punctuation">.</span>records<span class="token punctuation">;</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"neo4j 查询结果"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>records<span class="token punctuation">)</span><span class="token punctuation">;</span>
       
        <span class="token comment">// 开始处理数据</span>
        <span class="token keyword">let</span> nodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> me<span class="token punctuation">.</span>records<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>end<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            from<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            to<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>end<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            label<span class="token operator">:</span> me<span class="token punctuation">.</span>records<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>_fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>relationship<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
            id<span class="token operator">:</span> i<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>echartsData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            label<span class="token operator">:</span> e<span class="token punctuation">,</span>
            id<span class="token operator">:</span> e<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span><span class="token function">closeLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Cypher 执行失败！"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        me<span class="token punctuation">.</span>driver<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
      <span class="token keyword">this</span><span class="token punctuation">.</span>nodesArray <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>echartsData  <span class="token comment">//节点数组</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>edgesArray <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nodesRelation <span class="token comment">//关系线数组</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>knowlegGraphshow <span class="token operator">=</span> <span class="token boolean">true</span>
       <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">closeLoading</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'closeLoading'</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
 
</code></pre>
<p>定义绘图dom元素</p>
<pre><code class="prism language-typescript"><span class="token comment">// width,height 画布的宽度，高度。 可以是百分比或像素，一般在dom元素上设置 --&gt;</span>
     <span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">"knowlegGraphshow == true"</span> id<span class="token operator">=</span><span class="token string">"network_id"</span> ref<span class="token operator">=</span><span class="token string">"network_id"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"network"</span> style<span class="token operator">=</span><span class="token string">"height: 100%;"</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> 
</code></pre>
<p>调用绘图方法：</p>
<pre><code class="prism language-typescript"> <span class="token comment">// vis.js画图</span>
    <span class="token function">visDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>network_id<span class="token punctuation">;</span>
      <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> nodes<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nodesArray<span class="token punctuation">,</span> edges<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>edgesArray <span class="token punctuation">}</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"🚀 ~ file: pageKnowlegGraph.vue ~ line 135 ~ visDraw ~ data"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
      <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        autoResize<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token comment">// / 设置节点样式</span>
        nodes<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          shape<span class="token operator">:</span> <span class="token string">"dot"</span><span class="token punctuation">,</span>
          size<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
          font<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//字体配置</span>
            size<span class="token operator">:</span> <span class="token number">20</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          color<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// border: "#2B7CE9", //节点边框颜色</span>
            background<span class="token operator">:</span> <span class="token string">"#97C2FC"</span><span class="token punctuation">,</span> <span class="token comment">//节点背景颜色</span>
            highlight<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">//节点选中时状态颜色</span>
              border<span class="token operator">:</span> <span class="token string">"#2B7CE9"</span><span class="token punctuation">,</span>
              background<span class="token operator">:</span> <span class="token string">"#D2E5FF"</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            hover<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
              <span class="token comment">//节点鼠标滑过时状态颜色</span>
              border<span class="token operator">:</span> <span class="token string">"#2B7CE9"</span><span class="token punctuation">,</span>
              background<span class="token operator">:</span> <span class="token string">"#D2E5FF"</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          borderWidth<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//节点边框宽度，单位为px</span>
          borderWidthSelected<span class="token operator">:</span> <span class="token number">2</span> <span class="token comment">//节点被选中时边框的宽度，单位为px</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 边线配置</span>
        edges<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          width<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          length<span class="token operator">:</span> <span class="token number">260</span><span class="token punctuation">,</span>
          color<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            color<span class="token operator">:</span> <span class="token string">"#848484"</span><span class="token punctuation">,</span>
            highlight<span class="token operator">:</span> <span class="token string">"#848484"</span><span class="token punctuation">,</span>
            hover<span class="token operator">:</span> <span class="token string">"#848484"</span><span class="token punctuation">,</span>
            inherit<span class="token operator">:</span> <span class="token string">"from"</span><span class="token punctuation">,</span>
            opacity<span class="token operator">:</span> <span class="token number">1.0</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          shadow<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          smooth<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//设置两个节点之前的连线的状态</span>
            enabled<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">//默认是true，设置为false之后，两个节点之前的连线始终为直线，不会出现贝塞尔曲线</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          arrows<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> to<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token comment">//箭头指向to</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//计算节点之前斥力，进行自动排列的属性</span>
        physics<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// enabled: true, //默认是true，设置为false后，节点将不会自动改变，拖动谁谁动。不影响其他的节点</span>
          <span class="token comment">// barnesHut: {<!-- --></span>
          <span class="token comment">//   gravitationalConstant: -4000,</span>
          <span class="token comment">//   centralGravity: 0.3,</span>
          <span class="token comment">//   springLength: 120,</span>
          <span class="token comment">//   springConstant: 0.04,</span>
          <span class="token comment">//   damping: 0.09,</span>
          <span class="token comment">//   avoidOverlap: 0</span>
          <span class="token comment">// },</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// physics: false,</span>
        <span class="token comment">//用于所有用户与网络的交互。处理鼠标和触摸事件以及导航按钮和弹出窗口</span>
        interaction<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          hover<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          dragNodes<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否能拖动节点</span>
          dragView<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//是否能拖动画布</span>
          <span class="token comment">// hover: true, //鼠标移过后加粗该节点和连接线</span>
          <span class="token comment">// multiselect: true, //按 ctrl 多选</span>
          <span class="token comment">// selectable: true, //是否可以点击选择</span>
          <span class="token comment">// selectConnectedEdges: true, //选择节点后是否显示连接线</span>
          <span class="token comment">// hoverConnectedEdges: true, //鼠标滑动节点后是否显示连接线</span>
          zoomView<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">//是否能缩放画布</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>network <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vis</span><span class="token punctuation">.</span><span class="token function">Network</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> data<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>源码已上传，需要的小伙伴可前往主页找到下载。</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>