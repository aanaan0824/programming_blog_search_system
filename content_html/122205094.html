<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<h1 id="cookie">cookie</h1>
<h3 id="1.%E4%BB%80%E4%B9%88%E6%98%AFcookie">1.什么是cookie</h3>
<p>Cookie意为“甜饼”，是由W3C组织提出，最早由Netscape社区发展的一种机制。目前Cookie已经成为标准，所有的主流浏览器如IE、Netscape、Firefox、Opera等都支持Cookie。</p>
<h3 id="2.%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8cookie">2.为什么要用cookie</h3>
<p>由于http协议是一种无状态的协议（客户端和服务端互相不认识）</p>
<p>Cookies是一些存储在用户电脑上的小文件。它是被设计用来保存一些站点的用户数据，这样能够让服务器为这样的用户定制内容。页面代码能够获取到Cookie值然后发送给服务器，比如Cookie中存储了所在地理位置，以后每次进入地图就可以默认定位到改地点。</p>
<h3 id="3.cookie%E7%9A%84%E5%8E%9F%E7%90%86"><strong>3.cookie的原理</strong></h3>
<p>cookie的执行原理：就是当客户端访问服务器的时候（服务器运用了cookie），服务器会生成一份cookie传输给客户端，客户端会自动把cookie保存起来，以后客户端每次访问服务器，都会自动的携带着这份cookie。</p>
<p>简单来说，就是当客户端访问服务器时，服务器会生成一个票据给客户端，当客户端收到票据的之后就保存起来，以后再访问服务器就会自动带着票据。</p>
<ul><li><strong>简易cookie原理示意图  </strong><strong>如下图所示：</strong></li></ul>
<p style="text-align:center;"><img alt="" src="image\1f96b5e6172c4296a864c19d66916573.png"/></p>
<p>  </p>
<h3 id="4.%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8cookie"><strong>4.安装使用cookie</strong></h3>
<p>1.安装</p>
<blockquote>
<p>npm i cookie-parser</p>
</blockquote>
<p>注：可以直接使用脚手架</p>
<blockquote>
<p>express --view=模板引擎名称 项目名称</p>
</blockquote>
<p>2.使用</p>
<p>在脚手架app.js中已经带有cookie：</p>
<blockquote>
<p>var cookieParser = require('cookie-parser');</p>
<p>app.use(cookieParser());//使用cookie-parser</p>
</blockquote>
<p>生成cookie：</p>
<blockquote>
<p>  //设置cookie<br/>   //在响应的时候，生成一份cookie(票据)<br/>   // res.cookie('xxcode',"abc");</p>
</blockquote>
<p> 在浏览器中显示：</p>
<p style="text-align:center;"><img alt="" src="image\bf74e8cc02c24223b59a527440a873f8.png"/></p>
<p>取出cookie：</p>
<blockquote>
<p>  console.log(req.cookies);</p>
</blockquote>
<p>在后端显示：</p>
<p style="text-align:center;"><img alt="" src="image\2c5f4bb8484b4226bea860e0d776fca5.png"/> </p>
<p>5.加密cookie</p>
<p> 在脚手架app.js中已经带有cookie：</p>
<blockquote>
<p>var cookieParser = require('cookie-parser');</p>
<p>app.use(cookieParser("xiaoxuesheng"));//签名 （加密） 要指定秘钥 ，什么名字都星行，列如："xiaoxuesheng"</p>
</blockquote>
<p>在users.js中</p>
<blockquote>
<p>//使用cookie<br/>   //加密存储<br/>   res.cookie("mycode","abc",{<!-- --><br/>     signed:true   //加密<br/>   })</p>
<p><br/> //取出cookie<br/>  let mycode = req.signedCookies.mycode</p>
</blockquote>
<p> </p>
<h3>5.cookie的特点：</h3>
<ul><li> <p>保存到客户端，容易被篡改(删除、禁用)</p> </li><li> <p>保存的数据量有限的</p> </li><li> <p>简单易懂好用</p> </li></ul>
<h3>6.cookie的缺点：</h3>
<ol><li>保存在客户端，容易被篡改。</li><li>大小受限，本身最大4kb。</li></ol>
<h1 id="session">session</h1>
<h3 id="1.%E4%BB%80%E4%B9%88%E6%98%AFsession">1.什么是session</h3>
<p>Session是另一种记录客户状态的机制，不同的是Cookie保存在客户端浏览器中，而Session保存在服务器上。客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录在服务器上。这就是Session。客户端浏览器再次访问时只需要从该Session中查找该客户的状态就可以了session是一种特殊的cookie。cookie是保存在客户端的，而session是保存在服务端。</p>
<h3>2.为什么要用session</h3>
<p>由于cookie 是存在用户端，而且它本身存储的尺寸大小也有限，最关键是用户可以是可见的，并可以随意的修改，很不安全。那如何又要安全，又可以方便的全局读取信息呢？于是，这个时候，一种新的存储会话机制：session 诞生了</p>
<h3>3.session原理</h3>
<p>当客户端第一次请求服务器的时候，服务器生成一份session保存在服务端，将该数据(session)的id以cookie的形式传递给客户端；以后的每次请求，浏览器都会自动的携带cookie来访问服务器(session数据id)。</p>
<ul><li><strong>简易cookie原理示意图  </strong><strong>如下图所示：</strong></li></ul>
<p style="text-align:center;"><strong><img alt="" src="image\e0ba6d258d26461d952d546fe35161e5.png"/></strong></p>
<p> </p>
<p></p>
<h3>4.安装使用session </h3>
<p>1.安装</p>
<blockquote>
<p>npm i express-session</p>
</blockquote>
<p>2.使用</p>
<blockquote>
<p>//引入session中间件<br/> let expressSession=require("express-session")</p>
<p>//使用session中间件<br/> app.use(expressSession({<!-- --><br/>   resave:true,//每次是否都刷新存储器<br/>   saveUninitialized:true, <br/>   secret:"xiaoxuesheng" //秘钥<br/> }))</p>
<p> </p>
</blockquote>
<p>3.代码示例</p>
<p>（1）使用session存储数据：</p>
<pre><code class="language-javascript">// 存储
router.get("/test", (req, res) =&gt; {
    req.session.yourcode = 'abc';
    res.send('ok')
})</code></pre>
<p>在浏览器中显示：</p>
<p style="text-align:center;"> <img alt="" src="image\fa0c90012a77461e899a5d94970ebc3d.png"/></p>
<p> 会显出id和后面的字符串，后端打印的“abc”没出现</p>
<p>（2）取出session数据：</p>
<pre><code class="language-javascript">router.get("/test2", (req, res) =&gt; {
    console.log(req.session);
    res.send("ookkkk")

})</code></pre>
<p> 在后端显示：</p>
<p style="text-align:center;"><img alt="" src="image\9b8f9a9d264b404b9923d9a223ceb435.png"/></p>
<p> 4.可以实现在不同的端实现的结果不一样</p>
<p>如在火狐浏览器：</p>
<p style="text-align:center;"><img alt="" src="image\e68628cab63a4365b545266dbb260ef4.png"/></p>
<h3>5. cookie和session的共同点</h3>
<p>cookie和session都是用来跟踪浏览器用户身份的会话方式。</p>
<h3>6.cookie和session区别</h3>
<ul><li> <p>cookie是保存在客户端的</p> </li><li> <p>cookie有大小限制</p> </li><li> <p>session是保存在服务器端</p> </li><li> <p>session更加安全</p> </li><li> <p>session会比较占用服务器性能，当访问增多时应用cookie</p> </li></ul>
</div>
</div>