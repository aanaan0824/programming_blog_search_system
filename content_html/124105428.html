<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p>phpexcel php操作excel的类库停止更新换成新的 phpoffice/phpspreadsheet</p>
<p></p>
<blockquote>
<pre>composer require dts/ebay-sdk-php
Using version ^17.0 for dts/ebay-sdk-php
./composer.json has been updated
Loading composer repositories with package information
Updating dependencies (including require-dev)
Package operations: 1 install, 0 updates, 0 removals
  - Installing dts/ebay-sdk-php (17.0.0): Downloading (100%)
Package phpoffice/phpexcel is abandoned, you should avoid using it. Use phpoffice/phpspreadsheet instead.
</pre>
</blockquote>
<p></p>
<p>当然</p>
<pre>composer update phpoffice/phpword</pre>
<p>word也一样</p>
<p>操作</p>
<p></p>
<pre><code>composer require phpoffice/phpspreadsheet</code></pre>
<p></p>
<p>报错</p>
<p></p>
<blockquote>
<pre>Problem 1
    - topthink/think-installer v1.0.12 requires composer-plugin-api ^1.0 -&gt; foun
d composer-plugin-api[2.0.0] but it does not match the constraint.
    - topthink/framework v5.0.21 requires topthink/think-installer ~1.0 -&gt; satis
fiable by topthink/think-installer[v1.0.12].
    - topthink/framework is locked to version v5.0.21 and an update of this pack
age was not requested.

You are using Composer 2, which some of your plugins seem to be incompatible wit
h. Make sure you update your plugins or report a plugin-issue to ask them to sup
port Composer 2.

Installation failed, reverting ./composer.json and ./composer.lock to their orig
inal content.</pre>
</blockquote>
<p></p>
<p>有包不支持你的 composer 2，需要用 composer 1 安装</p>
<pre>composer self-update --1</pre>
<p>安装 composer 1，若要安装 composer 2 可使用</p>
<pre>composer self-update --2</pre>
<p></p>
<p></p>
<p>更新后</p>
<p></p>
<blockquote>
<p>composer require phpoffice/phpspreadsheet<br/> topthink/think-installer contains a Composer plugin which is currently not in yo<br/> ur allow-plugins config. See https://getcomposer.org/allow-plugins<br/> Do you trust "topthink/think-installer" to execute code and wish to enable it no<br/> w? (writes "allow-plugins" to composer.json) [y,n,d,?]</p>
</blockquote>
<p><br/> 选择Y</p>
<p></p>
<p>\amazonerp&gt;composer require phpoffice/phpspre<br/> adsheet<br/> topthink/think-installer contains a Composer plugin which is currently not in yo<br/> ur allow-plugins config. See https://getcomposer.org/allow-plugins<br/> Do you trust "topthink/think-installer" to execute code and wish to enable it no<br/> w? (writes "allow-plugins" to composer.json) [y,n,d,?]</p>
<p>选择y</p>
<p><br/> The "topthink/think-installer" plugin was skipped because it requires a Plugin A<br/> PI version ("^1.0") that does not match your Composer installation ("2.3.0"). Yo<br/> u may need to run composer update with the "--no-plugins" option.<br/> Using version ^1.22 for phpoffice/phpspreadsheet<br/> ./composer.json has been updated<br/> The "topthink/think-installer" plugin was skipped because it requires a Plugin A<br/> PI version ("^1.0") that does not match your Composer installation ("2.3.0"). Yo<br/> u may need to run composer update with the "--no-plugins" option.<br/> Running composer update phpoffice/phpspreadsheet<br/> Loading composer repositories with package information<br/> Updating dependencies<br/> Your requirements could not be resolved to an installable set of packages.</p>
<p>  Problem 1<br/>     - topthink/think-installer v1.0.12 requires composer-plugin-api ^1.0 -&gt; foun<br/> d composer-plugin-api[2.3.0] but it does not match the constraint.<br/>     - karsonzhang/fastadmin-addons 1.1.4 requires topthink/think-installer &gt;=1.0<br/> .10 -&gt; satisfiable by topthink/think-installer[v1.0.12].<br/>     - karsonzhang/fastadmin-addons is locked to version 1.1.4 and an update of t<br/> his package was not requested.</p>
<p>You can also try re-running composer require with an explicit version constraint<br/> , e.g. "composer require phpoffice/phpspreadsheet:*" to figure out if any versio<br/> n is installable, or "composer require phpoffice/phpspreadsheet:^2.1" if you kno<br/> w which you need.</p>
<p>Installation failed, reverting ./composer.json and ./composer.lock to their orig<br/> inal content.</p>
<blockquote>
<p>吧compposer降级</p>
</blockquote>
<pre><code>D:\phpstudy_pro\WWW\24.comamazonerp\amazonerp&gt;composer self-update --1
Warning: You forced the install of 1.10.25 via --1, but 2.3.4 is the latest stab
le version. Updating to it via composer self-update --stable is recommended.
Upgrading to version 1.10.25 (1.x channel).

Use composer self-update --rollback to return to version 2.3.4</code></pre>
<p></p>
<p>composer require phpoffice/phpspre<br/> adsheet<br/> Warning from https://mirrors.aliyun.com/composer: Support for Composer 1 is depr<br/> ecated and some packages will not be available. You should upgrade to Composer 2<br/> . See https://blog.packagist.com/deprecating-composer-1-support/</p>
<p><br/>   [Composer\Downloader\TransportException]<br/>   The "https://mirrors.aliyun.com/composer/p/provider-2017%24b5821b2a546c33da<br/>   ac76e494e604e1154f84a17bbf22858644e5cb028529ff1d.json" file could not be do<br/>   wnloaded (HTTP/1.1 404 Not Found)<br/>  </p>
<blockquote>
<p>镜像没有这个文件，阿里云的镜像是 composer2.0的包</p>
</blockquote>
<p></p>
<h3 id="-composer-json-">修改当前项目的 <code>composer.json</code> 配置文件：</h3>
<p>打开命令行窗口（windows用户）或控制台（Linux、Mac 用户），进入你的项目的根目录（也就是 <code>composer.json</code> 文件所在目录），执行如下命令：</p>
<p>复制</p>
<pre><code>composer config repo.packagist composer https://packagist.phpcomposer.com</code></pre>
<p></p>
<p></p>
<pre><code>composer require phpoffice/phpspre
adsheet ^1.2</code></pre>
<p></p>
</div>
</div>