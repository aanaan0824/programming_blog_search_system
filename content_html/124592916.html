<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-tomorrow-night" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h2><a id="NPOI_0"></a>NPOI介绍：</h2>
<blockquote>
<p>NPOI是指构建在POI 3.x版本之上的一个程序，NPOI可以在没有安装Office的情况下对Word或Excel文档进行读写操作。<br/> NPOI是一个开源的C#读写Excel、WORD等微软OLE2组件文档的项目。</p>
</blockquote>
<h2><a id="NPOI_5"></a>NPOI优势：</h2>
<blockquote>
<p>1、您可以完全免费使用该框架<br/> 2、包含了大部分EXCEL的特性(单元格样式、数据格式、公式等等)<br/> 3、专业的技术支持服务(24*7全天候) (非免费)<br/> 4、支持处理的文件格式包括xls, xlsx, docx.<br/> 5、采用面向接口的设计架构( 可以查看 NPOI.SS 的命名空间)<br/> 6、同时支持文件的导入和导出<br/> 7、基于.net 2.0 也支持xlsx 和 docx格式(当然也支持.net 4.0)<br/> 8、来自全世界大量成功且真实的测试Cases<br/> 9、大量的实例代码<br/> 11、你不需要在服务器上安装微软的Office，可以避免版权问题。<br/> 12、使用起来比Office PIA的API更加方便，更人性化。<br/> 13、你不用去花大力气维护NPOI，NPOI Team会不断更新、改善NPOI，绝对省成本。<br/> 14、不仅仅对与Excel可以进行操作，对于doc、ppt文件也可以做对应的操作</p>
</blockquote>
<h2><a id="NPOIHSSFMicrosoft_Excel_BIFFExcel_972003_21"></a>下面使用到NPOI.HSSF进行实战（Microsoft Excel BIFF(Excel 97-2003)格式读写库）</h2>
<p>第一步首先是要引入NPOI依赖包了<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/4f520d07768c43e297e9b448db0de01e.png"/><br/> 第二步，准备Excel模板</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/a97b10c5470f40b6b2bf69f8bd0b5fce.png"/></p>
<p>第三步编写代码</p>
<p>以下仅展示核心代码</p>
<pre><code class="prism language-csharp">        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">PrintExcle</span><span class="token punctuation">(</span><span class="token class-name">HttpQueryData</span> httpQueryData<span class="token punctuation">,</span> <span class="token class-name">List<span class="token punctuation">&lt;</span>PrintData<span class="token punctuation">&gt;</span></span> prints<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name"><span class="token keyword">string</span></span> path<span class="token operator">=</span> <span class="token string">"Excel模板.xls"</span><span class="token punctuation">;</span><span class="token comment">//模板路径</span>
            <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword">var</span></span> localTemplatPath <span class="token operator">=</span> TempFileAccess<span class="token punctuation">.</span>TempDir <span class="token operator">+</span> <span class="token string">@"\" + httpQueryData.TaskNo + "</span> <span class="token string">" + prints[0].DeptName + random.Next(100000, 999999) + "</span>Excel模板<span class="token punctuation">.</span>xls"<span class="token punctuation">;</span><span class="token comment">//新生成文件路径以及文件名与格式</span>
            File<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>path <span class="token punctuation">,</span> localTemplatPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> fs <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">OpenRead</span><span class="token punctuation">(</span>localTemplatPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
            	<span class="token comment">//此处应该再判断文件的格式是xls还是xlsx，如果是xlsx则使用XSSFWorkbook</span>
            	<span class="token comment">//HSSFWorkbook:是操作Excel2003以前（包括2003）的版本、XSSFWorkbook:是操作Excel2007的版本</span>
                <span class="token class-name"><span class="token keyword">var</span></span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">HSSFWorkbook</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">GetSheetAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//基本信息（Row和Cell分别代表着行、列，计数都是从0开始，比如说Excel里面第一个格子就是0,0）</span>
                <span class="token comment">//此处代码是根据自己的模板去写GetRow与GetCell的值</span>
                <span class="token class-name"><span class="token keyword">var</span></span> rowIndex <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>httpQueryData<span class="token punctuation">.</span>TaskNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>httpQueryData<span class="token punctuation">.</span>InputDate<span class="token punctuation">)</span><span class="token punctuation">)</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>httpQueryData<span class="token punctuation">.</span>InputDate<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token char">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-dd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                rowIndex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>httpQueryData<span class="token punctuation">.</span>DelegateOrgName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>httpQueryData<span class="token punctuation">.</span>BusinessFromDisplay<span class="token punctuation">)</span><span class="token punctuation">;</span>

                rowIndex <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>prints<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>DeptName<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//****动态列表信息，先加行，在填入信息</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>prints<span class="token punctuation">.</span>Count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> prints<span class="token punctuation">.</span>Count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        sheet<span class="token punctuation">.</span><span class="token function">CopyRow</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token class-name"><span class="token keyword">int</span></span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                rowIndex <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> prints<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token class-name"><span class="token keyword">var</span></span> curRow <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token keyword">var</span></span> data <span class="token operator">=</span> prints<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>FactoryNo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>InspectionAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>CertificateRequirements<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    curRow<span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Remark<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    count <span class="token operator">=</span> count <span class="token operator">+</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    rowIndex <span class="token operator">=</span> rowIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                sheet<span class="token punctuation">.</span><span class="token function">GetRow</span><span class="token punctuation">(</span>rowIndex<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetCell</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetCellValue</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//保存</span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">FileStream</span> localFs <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">OpenWrite</span><span class="token punctuation">(</span>localTemplatPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    workbook<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>localFs<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    localFs<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            System<span class="token punctuation">.</span>Diagnostics<span class="token punctuation">.</span>Process<span class="token punctuation">.</span><span class="token function">Start</span><span class="token punctuation">(</span>localTemplatPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<p>最终效果<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/4dc454a50c5c47ecb4588dc206b50394.png"/></p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>