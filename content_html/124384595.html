<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atom-one-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h2><a id="httpswwwkancloudcnmanualthinkphp6_01037479httpswwwkancloudcnmanualthinkphp6_01037479_0"></a>官方文档：<a href="https://www.kancloud.cn/manual/thinkphp6_0/1037479">https://www.kancloud.cn/manual/thinkphp6_0/1037479</a></h2>
<h2><a id="composerhttpswwwkancloudcnthinkphpcomposerhttpswwwkancloudcnthinkphpcomposer_1"></a>composer文档：<a href="https://www.kancloud.cn/thinkphp/composer">https://www.kancloud.cn/thinkphp/composer</a></h2>
<h1><a id="TP6_2"></a>一.TP6下载安装</h1>
<h3><a id="_3"></a>安装要求：</h3>
<p><mark>php&gt;7.1.0</mark><br/> <mark>6.0版本开始，必须通过Composer方式安装和更新，所以你无法通过Git下载安装。</mark></p>
<h3><a id="composer_6"></a>安装composer</h3>
<h4><a id="1_composerexehttpsgetcomposerorgComposerSetupexe_7"></a>1.下载 <a href="https://getcomposer.org/Composer-Setup.exe">composer.exe</a></h4>
<h4><a id="2php_8"></a>2.安装注意选择系统环境变量以及php</h4>
<h3><a id="composertp6_9"></a>通过composer获取tp6</h3>
<p>然后在你选择的目录下打开cmd<br/> 通过</p>
<pre><code class="prism language-bash"><span class="token function">composer</span> create-project topthink/think tp
</code></pre>
<p>下载，然后你会发现<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/8b07daf77fbf453bb234b0730a3bf441.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> 表示下载成功！<br/> 然后再目录下可以看到tp这个文件夹。自此tp6下载完成。</p>
<h3><a id="tp6_19"></a>运行tp6</h3>
<p>我使用的使phpstudy_pro。用phpstudy创建站点，目录选着到tp5/public中，具体如图所示<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/cfdbdeadbc3c43528cc3ec92de363afd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_16,color_FFFFFF,t_70,g_se,x_16"/><br/> 选择完成后，我们就可以直接使用啦。不要忘记打开apache OR nginx啊，然后我们可以直接打开网址<br/> <a href="http://localhost:1470/">localhost:1470</a><br/> 观察到如下页面：<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2f8f857a225d43f6a47b9bc50fe0fd7a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_20,color_FFFFFF,t_70,g_se,x_16"/><br/> 好，至此你的tp6已经安装完成。</p>
<h3><a id="_28"></a>目录结构分析</h3>
<pre><code class="prism language-bash">www  WEB部署目录（或者子目录）
├─app           应用目录
│  ├─controller      控制器目录
│  ├─model           模型目录
│  ├─ <span class="token punctuation">..</span>.            更多类库目录
│  │
│  ├─common.php         公共函数文件
│  └─event.php          事件定义文件
│
├─config                配置目录
│  ├─app.php            应用配置
│  ├─cache.php          缓存配置
│  ├─console.php        控制台配置
│  ├─cookie.php         Cookie配置
│  ├─database.php       数据库配置
│  ├─filesystem.php     文件磁盘配置
│  ├─lang.php           多语言配置
│  ├─log.php            日志配置
│  ├─middleware.php     中间件配置
│  ├─route.php          URL和路由配置
│  ├─session.php        Session配置
│  ├─trace.php          Trace配置
│  └─view.php           视图配置
│
├─view            视图目录
├─route                 路由定义目录
│  ├─route.php          路由定义文件
│  └─ <span class="token punctuation">..</span>.   
│
├─public                WEB目录（对外访问目录）
│  ├─index.php          入口文件
│  ├─router.php         快速测试文件
│  └─.htaccess          用于apache的重写
│
├─extend                扩展类库目录
├─runtime               应用的运行时目录（可写，可定制）
├─vendor                Composer类库目录
├─.example.env          环境变量示例文件
├─composer.json         <span class="token function">composer</span> 定义文件
├─LICENSE.txt           授权说明文件
├─README.md             README 文件
├─think                 命令行入口文件
</code></pre>
<h3><a id="_74"></a>直接操作数据库</h3>
<p>首先数据库我们新建一个命名为"tp6test"<br/> 新建表"zk_user"<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/2a74e407634e4b8a9de1a4b809e946e7.png"/><br/> 三个字段<br/> 然后我们去tp/app下面新建一个文件夹命名为model<br/> 在model下面新建一个php，使其继承Model<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/e6a764c332ad487eb2c1dc6af2e923d2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_16,color_FFFFFF,t_70,g_se,x_16"/><br/> 然后再controller下面的index中新建一个函数名字随意，放入以下代码</p>
<pre><code class="prism language-bash">public <span class="token keyword">function</span> <span class="token function-name function">asd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token variable">$data</span> <span class="token operator">=</span> Db::name<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>-<span class="token operator">&gt;</span>select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> json_encode<span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>然后我们打开debug模式<br/> 在tp根目录下.example.env环境变量示例文件，改成.env文件后就可以了，然后修改一下数据库连接<br/> 在database.php中添加表前缀<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/877a5a6ae7bc48e4ad86e1c91cbf482b.png"/><br/> 然后我们访问<a href="http://localhost:1470/index.php/index/asd">http://localhost:1470/index.php/index/asd</a>就可以看到我们的数据啦<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/bd30a30ca6484eb6b1f02cbc5fe3a31d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_16,color_FFFFFF,t_70,g_se,x_16"/></p>
<h3><a id="JWT_98"></a>然后我们集成一下JWT</h3>
<p>1.客户端使用用户名和密码请求登录<br/> 2.服务端收到请求，验证用户名和密码<br/> 3.验证成功后，服务端会签发一个token，再把这个token返回给客户端<br/> 4.客户端收到token后可以把它存储起来，比如放到cookie中<br/> 5.客户端每次向服务端请求资源时需要携带服务端签发的token，可以在cookie或者header中携带<br/> 6.服务端收到请求，然后去验证客户端请求里面带着的token，如果验证成功，就向客户端返回请求数据</p>
<h2><a id="jwt_106"></a>安装jwt扩展</h2>
<pre><code class="prism language-bash"><span class="token function">composer</span> require firebase/php-jwt
</code></pre>
<p>安装成功项目文件夹为 firebase</p>
<p><img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/52e8b83cddc149ae8fb7580e4cc40a38.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5byg5aSa6ZiU,size_20,color_FFFFFF,t_70,g_se,x_16"/></p>
<h2><a id="_JWT_encode__decodetokentoken_114"></a>调用 JWT里面的 encode 和 decode方法进行生成token和验证token</h2>
<p>在common.php下面放入以下代码</p>
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>?php
// 应用公共文件
use Firebase<span class="token punctuation">\</span>JWT<span class="token punctuation">\</span>JWT<span class="token punctuation">;</span>
use Firebase<span class="token punctuation">\</span>JWT<span class="token punctuation">\</span>Key<span class="token punctuation">;</span>
/**
 * 生成验签
 * @param <span class="token variable">$uid</span> 用户id
 * @return mixed
 */
<span class="token keyword">function</span> signToken<span class="token punctuation">(</span><span class="token variable">$uid</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$key</span><span class="token operator">=</span><span class="token string">'abcdefg'</span><span class="token punctuation">;</span>         //自定义的一个随机字串用户于加密中常用的 盐  salt
    <span class="token variable">$token</span> <span class="token operator">=</span> array<span class="token punctuation">(</span>
        <span class="token string">"iss"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$key</span>,
        //<span class="token string">"aud"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$id</span>,//接收人，也就是发给谁
        <span class="token string">"iat"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>,//签发时间,当前时间
        <span class="token string">"nbf"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>+3,//生效时间,在生成时间后一点点
        <span class="token string">'exp'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>+10800,//过期时间，三个小时
        <span class="token string">'data'</span><span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token string">'uid'</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token variable">$uid</span><span class="token punctuation">]</span>//自定义信息
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    //  print_r<span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$jwt</span> <span class="token operator">=</span> JWT::encode<span class="token punctuation">(</span><span class="token variable">$token</span>, <span class="token variable">$key</span>, <span class="token string">"HS256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  //生成了 token
    <span class="token builtin class-name">return</span> <span class="token variable">$jwt</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

/**
 * 验证token
 * @param <span class="token variable">$token</span>
 * @return array<span class="token operator">|</span>int<span class="token punctuation">[</span><span class="token punctuation">]</span>
 */
<span class="token keyword">function</span> checkToken<span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">"token"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$token</span><span class="token punctuation">;</span>
    <span class="token variable">$key</span><span class="token operator">=</span><span class="token string">'abcdefg'</span><span class="token punctuation">;</span>     //自定义的一个随机字串用户于加密中常用的 盐  salt
    try <span class="token punctuation">{<!-- --></span>
        //延长有效期1分钟
        JWT::<span class="token variable">$leeway</span> <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>
        //对token解码，得到的一个对象，所以直接转成数组
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">(</span>array<span class="token punctuation">)</span>JWT::decode<span class="token punctuation">(</span><span class="token variable">$token</span>,new Key<span class="token punctuation">(</span><span class="token variable">$key</span>, <span class="token string">'HS256'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
        //获取token里面的相关信息并赋值给数据集
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        //定义Result变量的status字段
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10001</span><span class="token punctuation">;</span>
        //验证通过后返回<span class="token variable">$result</span>数据集
        <span class="token builtin class-name">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
        //如果验证失败，catch以下错误
    <span class="token punctuation">}</span>catch <span class="token punctuation">(</span>SignatureInvalidException <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        //定义result数据集状态码status和data的默认值
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10002</span><span class="token punctuation">;</span>
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>   <span class="token operator">=</span> <span class="token string">'验证失败！请重新登录'</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>catch <span class="token punctuation">(</span>BeforeValidException <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        //定义result数据集状态码status和data的默认值
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10003</span><span class="token punctuation">;</span>
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>   <span class="token operator">=</span> <span class="token string">'token未生效，请稍后！'</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>catch <span class="token punctuation">(</span>ExpiredException <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        //定义result数据集状态码status和data的默认值
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10004</span><span class="token punctuation">;</span>
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>   <span class="token operator">=</span> <span class="token string">'登录过期，请重新登录！'</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>catch <span class="token punctuation">(</span>Exception <span class="token variable">$exception</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        //定义result数据集状态码status和data的默认值
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10005</span><span class="token punctuation">;</span>
        <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>   <span class="token operator">=</span> <span class="token string">'未知错误，请重新登录！'</span><span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>



</code></pre>
<h3><a id="token_191"></a>完成登录接口返回token</h3>
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>?php
namespace app<span class="token punctuation">\</span>controller<span class="token punctuation">;</span>

use app<span class="token punctuation">\</span>BaseController<span class="token punctuation">;</span>

use think<span class="token punctuation">\</span>facade<span class="token punctuation">\</span>Db<span class="token punctuation">;</span>

class User extends BaseController
<span class="token punctuation">{<!-- --></span>
    public <span class="token keyword">function</span> <span class="token function-name function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span>-<span class="token operator">&gt;</span>request-<span class="token operator">&gt;</span>isPost<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{<!-- --></span>
            <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$this</span>-<span class="token operator">&gt;</span>request-<span class="token operator">&gt;</span>param<span class="token punctuation">(</span><span class="token string">'username'</span>,<span class="token string">''</span>,<span class="token string">'trim'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$this</span>-<span class="token operator">&gt;</span>request-<span class="token operator">&gt;</span>param<span class="token punctuation">(</span><span class="token string">'password'</span>,<span class="token string">''</span>,<span class="token string">'trim'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            //查询数据库
            <span class="token variable">$user</span> <span class="token operator">=</span> Db::name<span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span>-<span class="token operator">&gt;</span>where<span class="token punctuation">(</span><span class="token string">'username'</span>,<span class="token variable">$username</span><span class="token punctuation">)</span>-<span class="token operator">&gt;</span>select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token builtin class-name">return</span> json<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'status'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'fail'</span>,<span class="token string">'msg'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'用户名不存在?'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token variable">$getToken</span> <span class="token operator">=</span> signToken<span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token builtin class-name">return</span> json<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'status'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$user</span>,<span class="token string">'msg'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'登陆成功'</span>,<span class="token string">'token'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$getToken</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<h3><a id="tp6tokentoken_222"></a>利用tp6中间件去拦截检查是否携带token以及token是否正确</h3>
<pre><code class="prism language-bash"><span class="token operator">&lt;</span>?php

namespace app<span class="token punctuation">\</span>middleware<span class="token punctuation">;</span>

class Auth
<span class="token punctuation">{<!-- --></span>
    public <span class="token keyword">function</span> handle<span class="token punctuation">(</span><span class="token variable">$request</span>, <span class="token punctuation">\</span>Closure <span class="token variable">$next</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        //获取前端header请求信息并把token信息转在字符串
        <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$request</span>-<span class="token operator">&gt;</span>header<span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>empty<span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">))</span> <span class="token punctuation">{<!-- --></span>
            <span class="token builtin class-name">return</span> json<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'status'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'fail'</span>,<span class="token string">'msg'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$token</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        //调用JWTAuth里面的checkAdminToken<span class="token punctuation">(</span><span class="token punctuation">)</span>方法对token解码
        <span class="token variable">$result</span> <span class="token operator">=</span> checkToken<span class="token punctuation">(</span><span class="token variable">$token</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        //result得到包含有status/data字段的数据集
//        <span class="token builtin class-name">return</span> <span class="token variable">$next</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">!=</span><span class="token operator">=</span> <span class="token number">10001</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            //如果status 不等于10001，验证失败，返回错误提示
            <span class="token builtin class-name">return</span> json<span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            //否则验证通过，把result里面data数据传给<span class="token variable">$request</span>
            //经过测试，数据并不能传到￥request的header里面，也不知道怎么调用，很是烦躁
//            <span class="token variable">$request</span>-<span class="token operator">&gt;</span>loginMsg <span class="token operator">=</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            //执行下一步代码
            <span class="token builtin class-name">return</span> <span class="token variable">$next</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>