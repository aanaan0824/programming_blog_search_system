<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-atelier-sulphurpool-light" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<p></p>
<div class="toc">
<h3>文章目录</h3>
<ul><li><a href="#1_1">1、简介</a></li><li><a href="#2GetAsyncKeyState_4">2、GetAsyncKeyState</a></li><li><ul><li><a href="#21__10">2.1 函数声明</a></li><li><a href="#22__17">2.2 宏定义</a></li><li><a href="#23__49">2.3 代码示例</a></li></ul>
</li><li><a href="#3_GetKeyState_71">3. GetKeyState</a></li><li><ul><li><a href="#31__84">3.1 函数声明</a></li><li><a href="#32__91">3.2 宏定义</a></li></ul>
</li><li><a href="#4mouse_event_110">4、mouse_event</a></li><li><ul><li><a href="#41__118">4.1 函数声明</a></li><li><a href="#42__129">4.2 代码示例</a></li></ul>
</li><li><a href="#5keybd_event_320">5、keybd_event</a></li><li><ul><li><a href="#51__327">5.1 函数声明</a></li><li><a href="#52__338">5.2 代码示例</a></li></ul>
</li><li><a href="#6SendInput_414">6、SendInput</a></li><li><ul><li><a href="#61__415">6.1 函数声明</a></li><li><a href="#62__428">6.2 代码示例</a></li></ul>
</li><li><a href="#7SendMessagePostMessage_518">7、SendMessage/PostMessage</a></li><li><ul><li><a href="#71__524">7.1 函数声明</a></li><li><a href="#72__545">7.2 代码示例</a></li></ul>
</li><li><a href="#8_560">8、辅助工具</a></li><li><ul><li><a href="#81_spyexe_561">8.1 spy++.exe</a></li><li><a href="#82_Inspectexe_569">8.2 Inspect.exe</a></li><li><a href="#83__573">8.3 键盘键值列表</a></li></ul>
</li><li><a href="#_710">结语</a></li></ul>
</div>
<p></p>
<h1><a id="1_1"></a>1、简介</h1>
<p>通过C++可以模拟鼠标点击和键盘输入的操作，进而可以实现一些比较有趣的功能。</p>
<h1><a id="2GetAsyncKeyState_4"></a>2、GetAsyncKeyState</h1>
<p><font color="blue">GetAsyncKeyState函数适用于鼠标按钮。但是，它会检查物理鼠标按钮的状态，而不是物理按钮映射到的逻辑鼠标按钮。例如，调用GetAsyncKeyState (VK_LBUTTON) 始终返回物理鼠标左键的状态，无论它是映射到逻辑鼠标左键还是逻辑鼠标右键。</font></p>
<ul><li>确定在调用函数时某个键是向上还是向下，以及在上一次调用GetAsyncKeyState之后是否按下了该键。</li><li>您可以使用虚拟键代码常量VK_SHIFT、VK_CONTROL和VK_MENU作为 vKey参数的值。这给出了 SHIFT、CTRL 或 ALT 键的状态，而不区分左右。</li></ul>
<h2><a id="21__10"></a>2.1 函数声明</h2>
<ul><li>函数声明如下：</li></ul>
<pre><code class="prism language-c">SHORT <span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> <span class="token keyword">int</span> vKey
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="22__17"></a>2.2 宏定义</h2>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_DOWN</span><span class="token expression"><span class="token punctuation">(</span>VK_NONAME<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_NONAME<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span></span></span>
</code></pre>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEYDOWN</span><span class="token expression"><span class="token punctuation">(</span>vk_code<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>vk_code<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEYUP</span><span class="token expression"><span class="token punctuation">(</span>vk_code<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>vk_code<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span></span></span>
</code></pre>
<pre><code class="prism language-cpp"><span class="token keyword">while</span><span class="token punctuation">(</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"鼠标左键是否按下："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">KEY_DOWN</span><span class="token punctuation">(</span>VK_LBUTTON<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"是"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"否"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"鼠标右键是否按下："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">KEY_DOWN</span><span class="token punctuation">(</span>VK_RBUTTON<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"是"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"否"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"鼠标滚轮键是否按下："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">KEY_DOWN</span><span class="token punctuation">(</span>VK_MBUTTON<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"是"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"否"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre>
<h2><a id="23__49"></a>2.3 代码示例</h2>
<pre><code class="prism language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">GetMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">TranslateAccelerator</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>hwnd<span class="token punctuation">,</span> hAccelTable<span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">TranslateMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">DispatchMessage</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">switch</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">case</span> WM_KEYDOWN<span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetAsyncKeyState</span><span class="token punctuation">(</span>VK_ESCAPE<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x01</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> bRunning<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1><a id="3_GetKeyState_71"></a>3. GetKeyState</h1>
<p><font color="blue"> 检索指定虚拟键的状态。状态指定按键是向上、向下还是切换（开、关——每次按下键时交替）。</font></p>
<ul><li> <p>一个虚拟钥匙。如果所需的虚拟键是字母或数字（A 到 Z、a 到 z 或 0 到 9）， 则 nVirtKey必须设置为该字符的 ASCII 值。对于其他键，它必须是虚拟键码。</p> </li><li> <p>返回值指定指定虚拟键的状态，如下：<br/> 如果高位为1，则key为down；否则，它就起来了。<br/> 如果低位为 1，则键被切换。某个键（例如 CAPS LOCK 键）在打开时会被切换。如果低位为 0，则该键处于关闭状态且未切换。切换键时键盘上的切换键指示灯（如果有）将亮起，当键未切换时将熄灭。</p> </li><li> <p>应用程序调用GetKeyState以响应键盘输入消息。此函数在生成输入消息时检索键的状态。要检索所有虚拟键的状态信息，请使用GetKeyboardState函数。<br/> 要检索单个键的状态信息，请使用GetKeyState函数。无论是否已从消息队列中检索到相应的键盘消息，要检索单个键的当前状态，请使用GetAsyncKeyState函数。</p> </li></ul>
<p><font color="blue">注意：::GetKeyState()只能在键盘消息处理程序中使用，因为它只有在线程从消息队列中读取键盘消息时才会报告被查询键的状态，如果需要在键盘消息处理程序以外查询按键状态，则需要使用::GetAsyncKeyState()来代替。</font></p>
<h2><a id="31__84"></a>3.1 函数声明</h2>
<pre><code class="prism language-c">SHORT <span class="token function">GetKeyState</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> <span class="token keyword">int</span> nVirtKey
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="32__91"></a>3.2 宏定义</h2>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_ISPRESSED_CTRL</span>   <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x8000</span> <span class="token operator">&amp;</span> <span class="token function">GetKeyState</span><span class="token punctuation">(</span>VK_CONTROL<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_ISPRESSED_SHIFT</span>  <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x8000</span> <span class="token operator">&amp;</span> <span class="token function">GetKeyState</span><span class="token punctuation">(</span>VK_SHIFT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">KEY_ISPRESSED_ALT</span>    <span class="token expression"><span class="token punctuation">(</span><span class="token number">0x8000</span> <span class="token operator">&amp;</span> <span class="token function">GetKeyState</span><span class="token punctuation">(</span>VK_MENU<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">KEY_ISPRESSED</span><span class="token expression"><span class="token punctuation">(</span>Key<span class="token punctuation">)</span>   <span class="token punctuation">(</span><span class="token function">GetKeyState</span><span class="token punctuation">(</span>Key<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x8000</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span></span></span>
</code></pre>
<ul><li>判断按键是否被按下</li></ul>
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name function">IsKeyPressed</span><span class="token expression"><span class="token punctuation">(</span>nVirtKey<span class="token punctuation">)</span>   <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetKeyState</span><span class="token punctuation">(</span>nVirtKey<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SHORT<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
</code></pre>
<ul><li>判断按键切换状态（指示灯状态）</li></ul>
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">IsKeyToggled</span><span class="token expression"><span class="token punctuation">(</span>nVirtKey<span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">GetKeyState</span><span class="token punctuation">(</span>nVirtKey<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
</code></pre>
<h1><a id="4mouse_event_110"></a>4、mouse_event</h1>
<p><font color="blue">mouse_event函数合成鼠标运动和按钮点击。</font></p>
<p>::GetCursorPos，获取当前鼠标的位置；<br/> ::SetCursorPos，移动鼠标到某一位置；<br/> mouse_event，鼠标动作，单击等。<br/> mouse_even只能够发送前台消息，即仅对当前激活的窗体有效。它最好配合SetCursorPos(x,y)函数一起使用。</p>
<h2><a id="41__118"></a>4.1 函数声明</h2>
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">mouse_event</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwFlags<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dx<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dy<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwData<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> ULONG_PTR dwExtraInfo
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="42__129"></a>4.2 代码示例</h2>
<pre><code class="prism language-c">POINT lpPoint<span class="token punctuation">;</span>
<span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>lpPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">SetCursorPos</span><span class="token punctuation">(</span>lpPoint<span class="token punctuation">.</span>x<span class="token punctuation">,</span> lpPoint<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<pre><code class="prism language-c"><span class="token operator">::</span><span class="token function">SetCursorPos</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token operator">|</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>是在当前位置单击一次
</code></pre>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">MOUSE</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">//坐标变量</span>
    POINT point<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//移动类函数</span>
    <span class="token keyword">void</span>    <span class="token function">Move</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RelativeMove</span><span class="token punctuation">(</span><span class="token keyword">int</span> cx<span class="token punctuation">,</span><span class="token keyword">int</span> cy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RestorePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//锁定启用类</span>
    <span class="token keyword">void</span>    <span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//动作类</span>
    <span class="token keyword">void</span>    <span class="token function">LBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">LBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">LBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">LBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">RBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">MBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">MBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">MBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">MBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">MBRoll</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//移动鼠标到绝对位置（X坐标，Y坐标）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">Move</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token operator">=</span>x<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token operator">=</span>y<span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">SetCursorPos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//移动鼠标到相对位置（X位移，Y位移）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RelativeMove</span><span class="token punctuation">(</span><span class="token keyword">int</span> cx<span class="token punctuation">,</span><span class="token keyword">int</span> cy<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token operator">+=</span>cx<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token operator">+=</span>cy<span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">SetCursorPos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//保存当前位置（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//恢复鼠标位置（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RestorePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">SetCursorPos</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//锁定鼠标（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    POINT    pt<span class="token punctuation">;</span>
    RECT    rt<span class="token punctuation">;</span>

    <span class="token double-colon punctuation">::</span><span class="token function">GetCursorPos</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pt<span class="token punctuation">)</span><span class="token punctuation">;</span>
    rt<span class="token punctuation">.</span>left<span class="token operator">=</span>rt<span class="token punctuation">.</span>right<span class="token operator">=</span>pt<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    rt<span class="token punctuation">.</span>top<span class="token operator">=</span>rt<span class="token punctuation">.</span>bottom<span class="token operator">=</span>pt<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    rt<span class="token punctuation">.</span>right<span class="token operator">++</span><span class="token punctuation">;</span>
    rt<span class="token punctuation">.</span>bottom<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">ClipCursor</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//解锁鼠标（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">ClipCursor</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//左键单击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">LBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token operator">|</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//左键双击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">LBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token operator">|</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token operator">|</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//左键按下（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">LBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTDOWN<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//左键抬起（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">LBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_LEFTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//右键单击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_RIGHTDOWN<span class="token operator">|</span>MOUSEEVENTF_RIGHTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//右键双击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_RIGHTDOWN<span class="token operator">|</span>MOUSEEVENTF_RIGHTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_RIGHTDOWN<span class="token operator">|</span>MOUSEEVENTF_RIGHTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//右键按下（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_RIGHTDOWN<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//右键抬起（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">RBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_RIGHTUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//中键单击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">MBClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_MIDDLEDOWN<span class="token operator">|</span>MOUSEEVENTF_MIDDLEUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//中键双击（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">MBDbClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_MIDDLEDOWN<span class="token operator">|</span>MOUSEEVENTF_MIDDLEUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_MIDDLEDOWN<span class="token operator">|</span>MOUSEEVENTF_MIDDLEUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//中键按下（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">MBDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_MIDDLEDOWN<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//中键抬起（）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">MBUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_MIDDLEUP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//中键滚动（滚动位移）</span>
<span class="token keyword">void</span> <span class="token class-name">MOUSE</span><span class="token double-colon punctuation">::</span><span class="token function">MBRoll</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">SavePos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">mouse_event</span><span class="token punctuation">(</span>MOUSEEVENTF_WHEEL<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token operator">-&gt;</span>point<span class="token punctuation">.</span>y<span class="token punctuation">,</span>ch<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<h1><a id="5keybd_event_320"></a>5、keybd_event</h1>
<p><font color="blue">合成击键。系统可以使用这样的合成击键来生成WM_KEYUP或WM_KEYDOWN消息。键盘驱动程序的中断处理程序调用keybd_event函数。</font></p>
<p><font color="blue">注意：此功能已被取代。请改用SendInput。</font></p>
<p>应用程序可以模拟按下 PRINTSCRN 键以获得屏幕快照并将其保存到剪贴板。为此，调用keybd_event并将 bVk参数设置为VK_SNAPSHOT。</p>
<h2><a id="51__327"></a>5.1 函数声明</h2>
<pre><code class="prism language-c"><span class="token keyword">void</span> <span class="token function">keybd_event</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> BYTE      bVk<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> BYTE      bScan<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> DWORD     dwFlags<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> ULONG_PTR dwExtraInfo
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="52__338"></a>5.2 代码示例</h2>
<p>以下示例程序通过使用带有VK_NUMLOCK虚拟键的keybd_event来切换 NUM LOCK 灯。它采用一个布尔值，指示灯应该关闭 ( FALSE ) 还是打开 ( TRUE )。相同的技术可用于 CAPS LOCK 键 ( VK_CAPITAL ) 和 SCROLL LOCK 键 ( VK_SCROLL )。</p>
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;windows.h&gt;</span></span>

   <span class="token keyword">void</span> <span class="token function">SetNumLock</span><span class="token punctuation">(</span> BOOL bState <span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span>
      BYTE keyState<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      <span class="token function">GetKeyboardState</span><span class="token punctuation">(</span><span class="token punctuation">(</span>LPBYTE<span class="token punctuation">)</span><span class="token operator">&amp;</span>keyState<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>bState <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>keyState<span class="token punctuation">[</span>VK_NUMLOCK<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
          <span class="token punctuation">(</span><span class="token operator">!</span>bState <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>keyState<span class="token punctuation">[</span>VK_NUMLOCK<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// Simulate a key press</span>
         <span class="token function">keybd_event</span><span class="token punctuation">(</span> VK_NUMLOCK<span class="token punctuation">,</span>
                      <span class="token number">0x45</span><span class="token punctuation">,</span>
                      KEYEVENTF_EXTENDEDKEY <span class="token operator">|</span> <span class="token number">0</span><span class="token punctuation">,</span>
                      <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// Simulate a key release</span>
         <span class="token function">keybd_event</span><span class="token punctuation">(</span> VK_NUMLOCK<span class="token punctuation">,</span>
                      <span class="token number">0x45</span><span class="token punctuation">,</span>
                      KEYEVENTF_EXTENDEDKEY <span class="token operator">|</span> KEYEVENTF_KEYUP<span class="token punctuation">,</span>
                      <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">{<!-- --></span>
      <span class="token function">SetNumLock</span><span class="token punctuation">(</span> TRUE <span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">KEYBOARD</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span>    <span class="token function">PressStr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">PressKey</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">KeyDown</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span>    <span class="token function">KeyUp</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//按键（虚拟键值）</span>
<span class="token keyword">void</span> <span class="token class-name">KEYBOARD</span><span class="token double-colon punctuation">::</span><span class="token function">PressKey</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">keybd_event</span><span class="token punctuation">(</span>bVk<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token double-colon punctuation">::</span><span class="token function">keybd_event</span><span class="token punctuation">(</span>bVk<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>KEYEVENTF_KEYUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//按下（虚拟键值）</span>
<span class="token keyword">void</span> <span class="token class-name">KEYBOARD</span><span class="token double-colon punctuation">::</span><span class="token function">KeyDown</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">keybd_event</span><span class="token punctuation">(</span>bVk<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//抬起（虚拟键值）</span>
<span class="token keyword">void</span> <span class="token class-name">KEYBOARD</span><span class="token double-colon punctuation">::</span><span class="token function">KeyUp</span><span class="token punctuation">(</span>BYTE bVk<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token double-colon punctuation">::</span><span class="token function">keybd_event</span><span class="token punctuation">(</span>bVk<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>KEYEVENTF_KEYUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//发送字符串（字符串）</span>
<span class="token keyword">void</span> <span class="token class-name">KEYBOARD</span><span class="token double-colon punctuation">::</span><span class="token function">PressStr</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">0x60</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token number">0x7B</span><span class="token punctuation">)</span>
            <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">PressKey</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            <span class="token keyword">this</span><span class="token operator">-&gt;</span><span class="token function">PressKey</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<h1><a id="6SendInput_414"></a>6、SendInput</h1>
<h2><a id="61__415"></a>6.1 函数声明</h2>
<p><font color="blue">合成击键、鼠标动作和按钮点击。</font></p>
<p>SendInput函数将 INPUT 结构中的事件串行插入到键盘或鼠标输入流中。这些事件不会与用户（使用键盘或鼠标）或通过调用keybd_event、mouse_event或对SendInput的其他调用插入的其他键盘或鼠标输入事件穿插。</p>
<p>此功能不会重置键盘的当前状态。调用该函数时已按下的任何键都可能会干扰该函数生成的事件。为避免此问题，请使用GetAsyncKeyState函数检查键盘的状态并根据需要进行更正。</p>
<pre><code class="prism language-c">UINT <span class="token function">SendInput</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> UINT    cInputs<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPINPUT pInputs<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> <span class="token keyword">int</span>     cbSize
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="62__428"></a>6.2 代码示例</h2>
<pre><code class="prism language-c"><span class="token comment">//**********************************************************************</span>
<span class="token comment">//</span>
<span class="token comment">// Sends Win + D to toggle to the desktop</span>
<span class="token comment">//</span>
<span class="token comment">//**********************************************************************</span>
<span class="token keyword">void</span> <span class="token function">ShowDesktop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">OutputString</span><span class="token punctuation">(</span>L<span class="token string">"Sending 'Win-D'\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    INPUT inputs<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">ZeroMemory</span><span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_KEYBOARD<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>wVk <span class="token operator">=</span> VK_LWIN<span class="token punctuation">;</span>
   
    inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_KEYBOARD<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>wVk <span class="token operator">=</span> VK_D<span class="token punctuation">;</span>

    inputs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_KEYBOARD<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>wVk <span class="token operator">=</span> VK_D<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> KEYEVENTF_KEYUP<span class="token punctuation">;</span>

    inputs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_KEYBOARD<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>wVk <span class="token operator">=</span> VK_LWIN<span class="token punctuation">;</span>
    inputs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>ki<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> KEYEVENTF_KEYUP<span class="token punctuation">;</span>

    UINT uSent <span class="token operator">=</span> <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token function">ARRAYSIZE</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">,</span> inputs<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>uSent <span class="token operator">!=</span> <span class="token function">ARRAYSIZE</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">OutputString</span><span class="token punctuation">(</span>L<span class="token string">"SendInput failed: 0x%x\n"</span><span class="token punctuation">,</span> <span class="token function">HRESULT_FROM_WIN32</span><span class="token punctuation">(</span><span class="token function">GetLastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre>
<pre><code class="prism language-cpp"><span class="token comment">//鼠标移动到指定位置  </span>
<span class="token keyword">void</span> <span class="token function">MouseMove</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>  
    <span class="token keyword">double</span> fScreenWidth <span class="token operator">=</span> <span class="token double-colon punctuation">::</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CXSCREEN<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//获取屏幕分辨率宽度  </span>
    <span class="token keyword">double</span> fScreenHeight <span class="token operator">=</span> <span class="token double-colon punctuation">::</span><span class="token function">GetSystemMetrics</span><span class="token punctuation">(</span>SM_CYSCREEN<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//获取屏幕分辨率高度  </span>
    <span class="token keyword">double</span> fx <span class="token operator">=</span> x<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">65535.0f</span> <span class="token operator">/</span> fScreenWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">double</span> fy <span class="token operator">=</span> y<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">65535.0f</span> <span class="token operator">/</span> fScreenHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>  
    INPUT  Input <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_MOUSE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> MOUSEEVENTF_MOVE <span class="token operator">|</span> MOUSEEVENTF_ABSOLUTE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dx <span class="token operator">=</span> fx<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dy <span class="token operator">=</span> fy<span class="token punctuation">;</span>  
    <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Input<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token comment">//鼠标左键按下  </span>
<span class="token keyword">void</span> <span class="token function">MouseLeftDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">{<!-- --></span>  
    INPUT  Input <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_MOUSE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> MOUSEEVENTF_LEFTDOWN<span class="token punctuation">;</span>  
    <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Input<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token comment">//鼠标左键放开  </span>
<span class="token keyword">void</span> <span class="token function">MouseLeftUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>  
    INPUT  Input <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_MOUSE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> MOUSEEVENTF_LEFTUP<span class="token punctuation">;</span>  
    <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Input<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
      
<span class="token punctuation">}</span>  

<span class="token comment">//鼠标右键按下</span>
<span class="token keyword">void</span> <span class="token function">MouseRightDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token punctuation">{<!-- --></span>  
    INPUT  Input <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_MOUSE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> MOUSEEVENTF_RIGHTDOWN<span class="token punctuation">;</span>  
    <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Input<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  

<span class="token comment">//鼠标右键放开    </span>
<span class="token keyword">void</span> <span class="token function">MouseRightUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>  
    INPUT  Input <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>type <span class="token operator">=</span> INPUT_MOUSE<span class="token punctuation">;</span>  
    Input<span class="token punctuation">.</span>mi<span class="token punctuation">.</span>dwFlags <span class="token operator">=</span> MOUSEEVENTF_RIGHTUP<span class="token punctuation">;</span>  
    <span class="token function">SendInput</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>Input<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>INPUT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
</code></pre>
<h1><a id="7SendMessagePostMessage_518"></a>7、SendMessage/PostMessage</h1>
<p>当用户在键盘上键入时，具有键盘焦点的窗口的窗口过程接收击键消息。击键消息是WM_KEYDOWN、WM_KEYUP、WM_SYSKEYDOWN和WM_SYSKEYUP。典型的窗口过程会忽略除WM_KEYDOWN之外的所有击键消息。当用户按下某个键时，系统会发布WM_KEYDOWN消息。</p>
<p>当窗口过程收到WM_KEYDOWN消息时，它应该检查伴随消息的虚拟键代码以确定如何处理击键。虚拟键代码在消息的wParam参数中。通常，应用程序只处理由非字符键生成的击键，包括功能键、光标移动键和特殊用途键，如 INS、DEL、HOME 和 END。</p>
<p><font color="blue">这种方法不需要窗体在前端，甚至最小化也可以使用，但是此方法并不是在所有场合有效，特别是对于不响应鼠标消息的程序更是如此。在这种情况下，可以尝试使用mouse_event函数。</font></p>
<h2><a id="71__524"></a>7.1 函数声明</h2>
<p>将指定的消息发送到一个或多个窗口。SendMessage函数调用指定窗口的窗口过程，并且在窗口过程处理完消息后才返回。</p>
<p>要发送消息并立即返回，请使用SendMessageCallback或SendNotifyMessage函数。要将消息发布到线程的消息队列并立即返回，请使用PostMessage或PostThreadMessage函数。</p>
<pre><code class="prism language-c">LRESULT <span class="token function">SendMessage</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> HWND   hWnd<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> UINT   Msg<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> WPARAM wParam<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span> LPARAM lParam
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>在与创建指定窗口的线程关联的消息队列中放置（发布）一条消息，并在不等待线程处理消息的情况下返回。要在与线程关联的消息队列中发布消息，请使用PostThreadMessage函数。</p>
<pre><code class="prism language-c">BOOL <span class="token function">PostMessageA</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">,</span> optional<span class="token punctuation">]</span> HWND   hWnd<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span>           UINT   Msg<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span>           WPARAM wParam<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>in<span class="token punctuation">]</span>           LPARAM lParam
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a id="72__545"></a>7.2 代码示例</h2>
<pre><code class="prism language-c"><span class="token operator">::</span><span class="token function">SetCursorPos</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsMineIn</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">==</span>TRUE<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*::mouse_event(MOUSEEVENTF_RIGHTDOWN,x,y,0,0);
    ::mouse_event(MOUSEEVENTF_RIGHTUP,x,y,0,0);  */</span>
    pWnd<span class="token operator">-&gt;</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_RBUTTONDOWN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWnd<span class="token operator">-&gt;</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_RBUTTONUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">/*::mouse_event(MOUSEEVENTF_LEFTDOWN,x,y,0,0);
    ::mouse_event(MOUSEEVENTF_LEFTUP,x,y,0,0);*/</span>            
    pWnd<span class="token operator">-&gt;</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_LBUTTONDOWN<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    pWnd<span class="token operator">-&gt;</span><span class="token function">SendMessage</span><span class="token punctuation">(</span>WM_LBUTTONUP<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">|</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>               
</code></pre>
<h1><a id="8_560"></a>8、辅助工具</h1>
<h2><a id="81_spyexe_561"></a>8.1 spy++.exe</h2>
<p><a href="https://docs.microsoft.com/zh-cn/visualstudio/debugger/introducing-spy-increment?view=vs-2022">https://docs.microsoft.com/zh-cn/visualstudio/debugger/introducing-spy-increment?view=vs-2022</a></p>
<p>Spy++ 有两个版本。 第一个版本，名为 Spy++ (spyxx.exe)，用于显示发送到在 32 位进程中运行的窗口的消息。 例如，在 32 位进程中运行的 Visual Studio。 因此，可以使用 Spy++ 来显示发送到“解决方案资源管理器” 中的消息。 由于 Visual Studio 中大多数生成的默认配置都是在 32 位进程中运行的，因此如果已安装所需组件，则第一个版本的 Spy++ 就是在 Visual Studio 中的“工具”菜单上可用的那一个。</p>
<p>第二个版本，名为 Spy++（64 位）(spyxx_amd64.exe)，用于显示发送到在 64 位进程中运行的窗口的消息。 例如，在 64 位操作系统上，记事本在 64 位进程中运行。 因此，可以使用 Spy++（64 位）来显示发送到记事本的消息。 Spy++ （64 位）通常位于…\Visual Studio 安装文件夹\Common7\Tools\spyxx_amd64.exe。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/670a05042b734282b9462f79f8686e2d.png"/></p>
<h2><a id="82_Inspectexe_569"></a>8.2 Inspect.exe</h2>
<p><a href="https://docs.microsoft.com/zh-cn/windows/win32/winauto/inspect-objects">https://docs.microsoft.com/zh-cn/windows/win32/winauto/inspect-objects</a><br/> 检查 (Inspect.exe) 是基于Windows的工具，可用于选择任何 UI 元素并查看元素的辅助功能数据。 可以查看 Microsoft UI 自动化 属性和控制模式，以及 Microsoft Active Accessibility (MSAA) 属性。 通过检查，还可以测试UI 自动化树中自动化元素的导航结构，以及 Microsoft Active Accessibility 层次结构中的可访问对象。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/af8ffd582d0b4aafbeffa9ef17cec991.png"/></p>
<h2><a id="83__573"></a>8.3 键盘键值列表</h2>
<pre><code class="prism language-c"><span class="token comment">/* Virtual Keys, Standard Set*/</span>
VK_LBUTTON     <span class="token number">0x01</span>
VK_RBUTTON     <span class="token number">0x02</span>
VK_CANCEL      <span class="token number">0x03</span>
VK_MBUTTON     <span class="token number">0x04</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LBUTTON</span>        <span class="token expression"><span class="token number">0x01</span>    </span><span class="token comment">//鼠标左键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RBUTTON</span>        <span class="token expression"><span class="token number">0x02</span>    </span><span class="token comment">//鼠标右键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CANCEL</span>         <span class="token expression"><span class="token number">0x03</span>    </span><span class="token comment">//Ctrl + Break</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_MBUTTON</span>        <span class="token expression"><span class="token number">0x04</span>    </span><span class="token comment">//鼠标中键/* NOT contiguous with L &amp; RBUTTON */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_BACK</span>           <span class="token expression"><span class="token number">0x08</span>   </span><span class="token comment">//Backspace 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_TAB</span>            <span class="token expression"><span class="token number">0x09</span>   </span><span class="token comment">//Tab 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CLEAR</span>          <span class="token expression"><span class="token number">0x0C</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RETURN</span>         <span class="token expression"><span class="token number">0x0D</span>   </span><span class="token comment">//回车键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SHIFT</span>          <span class="token expression"><span class="token number">0x10</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CONTROL</span>        <span class="token expression"><span class="token number">0x11</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_MENU</span>           <span class="token expression"><span class="token number">0x12</span>   </span><span class="token comment">//Alt 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PAUSE</span>          <span class="token expression"><span class="token number">0x13</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CAPITAL</span>        <span class="token expression"><span class="token number">0x14</span>   </span><span class="token comment">//Caps Lock 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_KANA</span>           <span class="token expression"><span class="token number">0x15</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_HANGEUL</span>        <span class="token expression"><span class="token number">0x15</span> </span><span class="token comment">/* old name - should be here for compatibility */</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_HANGUL</span>         <span class="token expression"><span class="token number">0x15</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_JUNJA</span>          <span class="token expression"><span class="token number">0x17</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_FINAL</span>          <span class="token expression"><span class="token number">0x18</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_HANJA</span>          <span class="token expression"><span class="token number">0x19</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_KANJI</span>          <span class="token expression"><span class="token number">0x19</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_ESCAPE</span>         <span class="token expression"><span class="token number">0x1B</span>   </span><span class="token comment">//Esc 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CONVERT</span>        <span class="token expression"><span class="token number">0x1C</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NONCONVERT</span>     <span class="token expression"><span class="token number">0x1D</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_ACCEPT</span>         <span class="token expression"><span class="token number">0x1E</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_MODECHANGE</span>     <span class="token expression"><span class="token number">0x1F</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SPACE</span>          <span class="token expression"><span class="token number">0x20</span>   </span><span class="token comment">//空格</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PRIOR</span>          <span class="token expression"><span class="token number">0x21</span>   </span><span class="token comment">//Page Up 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NEXT</span>           <span class="token expression"><span class="token number">0x22</span>   </span><span class="token comment">//Page Down 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_END</span>            <span class="token expression"><span class="token number">0x23</span>   </span><span class="token comment">//End 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_HOME</span>           <span class="token expression"><span class="token number">0x24</span>   </span><span class="token comment">//Home 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LEFT</span>           <span class="token expression"><span class="token number">0x25</span>  </span><span class="token comment">/*方向键*/</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_UP</span>             <span class="token expression"><span class="token number">0x26</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RIGHT</span>          <span class="token expression"><span class="token number">0x27</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_DOWN</span>           <span class="token expression"><span class="token number">0x28</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SELECT</span>         <span class="token expression"><span class="token number">0x29</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PRINT</span>          <span class="token expression"><span class="token number">0x2A</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_EXECUTE</span>        <span class="token expression"><span class="token number">0x2B</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SNAPSHOT</span>       <span class="token expression"><span class="token number">0x2C</span>   </span><span class="token comment">//Print Screen 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_INSERT</span>         <span class="token expression"><span class="token number">0x2D</span>  </span><span class="token comment">//Insert键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_DELETE</span>         <span class="token expression"><span class="token number">0x2E</span>  </span><span class="token comment">//Delete键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_HELP</span>           <span class="token expression"><span class="token number">0x2F</span></span></span>
</code></pre>
<pre><code class="prism language-bash">VK_0 thru VK_9 are the same as ASCII <span class="token string">'0'</span> thru <span class="token string">'9'</span> <span class="token punctuation">(</span>0x30 - 0x39<span class="token punctuation">)</span>
VK_A thru VK_Z are the same as ASCII <span class="token string">'A'</span> thru <span class="token string">'Z'</span> <span class="token punctuation">(</span>0x41 - 0x5A<span class="token punctuation">)</span> 
</code></pre>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LWIN</span>           <span class="token expression"><span class="token number">0x5B</span> </span><span class="token comment">//左WinKey(104键盘才有)</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RWIN</span>           <span class="token expression"><span class="token number">0x5C</span> </span><span class="token comment">//右WinKey(104键盘才有)</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_APPS</span>           <span class="token expression"><span class="token number">0x5D</span> </span><span class="token comment">//AppsKey(104键盘才有)</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD0</span>        <span class="token expression"><span class="token number">0x60</span> </span><span class="token comment">//小键盘0-9</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD1</span>        <span class="token expression"><span class="token number">0x61</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD2</span>        <span class="token expression"><span class="token number">0x62</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD3</span>        <span class="token expression"><span class="token number">0x63</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD4</span>        <span class="token expression"><span class="token number">0x64</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD5</span>        <span class="token expression"><span class="token number">0x65</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD6</span>        <span class="token expression"><span class="token number">0x66</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD7</span>        <span class="token expression"><span class="token number">0x67</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD8</span>        <span class="token expression"><span class="token number">0x68</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMPAD9</span>        <span class="token expression"><span class="token number">0x69</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_MULTIPLY</span>       <span class="token expression"><span class="token number">0x6A</span> </span><span class="token comment">//乘</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_ADD</span>                <span class="token expression"><span class="token number">0x6B</span> </span><span class="token comment">//加</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SEPARATOR</span>      <span class="token expression"><span class="token number">0x6C</span> </span><span class="token comment">//除</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SUBTRACT</span>       <span class="token expression"><span class="token number">0x6D</span> </span><span class="token comment">//减</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_DECIMAL</span>        <span class="token expression"><span class="token number">0x6E</span> </span><span class="token comment">//小数点</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_DIVIDE</span>         <span class="token expression"><span class="token number">0x6F</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F1</span>             <span class="token expression"><span class="token number">0x70</span> </span><span class="token comment">//功能键F1-F24</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F2</span>             <span class="token expression"><span class="token number">0x71</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F3</span>             <span class="token expression"><span class="token number">0x72</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F4</span>             <span class="token expression"><span class="token number">0x73</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F5</span>             <span class="token expression"><span class="token number">0x74</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F6</span>             <span class="token expression"><span class="token number">0x75</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F7</span>             <span class="token expression"><span class="token number">0x76</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F8</span>             <span class="token expression"><span class="token number">0x77</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F9</span>             <span class="token expression"><span class="token number">0x78</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F10</span>            <span class="token expression"><span class="token number">0x79</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F11</span>            <span class="token expression"><span class="token number">0x7A</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F12</span>            <span class="token expression"><span class="token number">0x7B</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F13</span>            <span class="token expression"><span class="token number">0x7C</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F14</span>            <span class="token expression"><span class="token number">0x7D</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F15</span>            <span class="token expression"><span class="token number">0x7E</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F16</span>            <span class="token expression"><span class="token number">0x7F</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F17</span>            <span class="token expression"><span class="token number">0x80</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F18</span>            <span class="token expression"><span class="token number">0x81</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F19</span>            <span class="token expression"><span class="token number">0x82</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F20</span>            <span class="token expression"><span class="token number">0x83</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F21</span>            <span class="token expression"><span class="token number">0x84</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F22</span>            <span class="token expression"><span class="token number">0x85</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F23</span>            <span class="token expression"><span class="token number">0x86</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_F24</span>            <span class="token expression"><span class="token number">0x87</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NUMLOCK</span>        <span class="token expression"><span class="token number">0x90</span> </span><span class="token comment">//Num Lock 键</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_SCROLL</span>         <span class="token expression"><span class="token number">0x91</span> </span><span class="token comment">//Scroll Lock 键</span></span>
</code></pre>
<pre><code class="prism language-bash">VK_L* <span class="token operator">&amp;</span> VK_R* - left and right Alt, Ctrl and Shift virtual keys.
Used only as parameters to GetAsyncKeyState<span class="token punctuation">(</span><span class="token punctuation">)</span> and GetKeyState<span class="token punctuation">(</span><span class="token punctuation">)</span>.
No other API or message will distinguish left and right keys <span class="token keyword">in</span> this way.
</code></pre>
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LSHIFT</span>           <span class="token expression"><span class="token number">0xA0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RSHIFT</span>          <span class="token expression"><span class="token number">0xA1</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LCONTROL</span>        <span class="token expression"><span class="token number">0xA2</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RCONTROL</span>        <span class="token expression"><span class="token number">0xA3</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_LMENU</span>           <span class="token expression"><span class="token number">0xA4</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_RMENU</span>           <span class="token expression"><span class="token number">0xA5</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span><span class="token expression"><span class="token punctuation">(</span>WINVER <span class="token operator">&gt;=</span> <span class="token number">0x0400</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PROCESSKEY</span>      <span class="token expression"><span class="token number">0xE5</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">/* WINVER &gt;= 0x0400 */</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_ATTN</span>            <span class="token expression"><span class="token number">0xF6</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_CRSEL</span>           <span class="token expression"><span class="token number">0xF7</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_EXSEL</span>           <span class="token expression"><span class="token number">0xF8</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_EREOF</span>           <span class="token expression"><span class="token number">0xF9</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PLAY</span>            <span class="token expression"><span class="token number">0xFA</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_ZOOM</span>            <span class="token expression"><span class="token number">0xFB</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_NONAME</span>          <span class="token expression"><span class="token number">0xFC</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_PA1</span>             <span class="token expression"><span class="token number">0xFD</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">VK_OEM_CLEAR</span>       <span class="token expression"><span class="token number">0xFE</span></span></span>
</code></pre>
<h1><a id="_710"></a>结语</h1>
<p><code>如果您觉得该方法或代码有一点点用处，可以给作者点个赞，或打赏杯咖啡；</code>╮(￣▽￣)╭<br/> <code>如果您感觉方法或代码不咋地</code>//(ㄒoㄒ)//<code>，就在评论处留言，作者继续改进；</code>o_O???<br/> <code>如果您需要相关功能的代码定制化开发，可以留言私信作者；</code>(✿◡‿◡)<br/> <code>感谢各位大佬童鞋们的支持！</code>( ´ ▽´ )ﾉ ( ´ ▽´)っ！！！</p>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>