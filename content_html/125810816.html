<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="htmledit_views" id="content_views">
<p id="main-toc"><strong>🤞目录🤞</strong></p>
<p id="%E4%B8%80.%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C-toc" style="margin-left:0px;"><a href="https://blog.csdn.net/m0_62218217/article/details/125149381?spm=1001.2014.3001.5501#t0" title="💖">💖</a><a href="#%E4%B8%80.%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">一. 准备工作</a></p>
<p id="1)%20%E5%88%9B%E5%BB%BA%20web%20%E9%A1%B9%E7%9B%AE-toc" style="margin-left:40px;">💎<a href="#1%29%20%E5%88%9B%E5%BB%BA%20web%20%E9%A1%B9%E7%9B%AE">1) 创建 web 项目</a></p>
<p id="2)%20%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-toc" style="margin-left:40px;">💎<a href="#2%29%20%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84">2) 创建目录结构</a></p>
<p id="3)%20%E9%85%8D%E7%BD%AE%20pom.xml-toc" style="margin-left:40px;">💎<a href="#3%29%20%E9%85%8D%E7%BD%AE%20pom.xml">3) 配置 pom.xml</a></p>
<p id="%E4%BA%8C.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81-toc" style="margin-left:0px;"><a href="https://blog.csdn.net/m0_62218217/article/details/125149381?spm=1001.2014.3001.5501#t0" title="💖">💖</a><a href="#%E4%BA%8C.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81">二. 数据库操作代码</a></p>
<p id="1.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1-toc" style="margin-left:40px;">💎<a href="#1.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1">1. 数据库设计</a></p>
<p id="1.1%20ER%E5%9B%BE-toc" style="margin-left:80px;"><a href="#1.1%20ER%E5%9B%BE">1.1 ER图</a></p>
<p id="1.2%C2%A0ER%E5%9B%BE%E8%BD%AC%E5%8C%96%E4%B8%BA%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E5%B9%B6%E4%BC%98%E5%8C%96-toc" style="margin-left:80px;"><a href="#1.2%C2%A0ER%E5%9B%BE%E8%BD%AC%E5%8C%96%E4%B8%BA%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E5%B9%B6%E4%BC%98%E5%8C%96">1.2 ER图转化为关系模型并优化</a></p>
<p id="1.3%20%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E8%A1%A8%E7%BB%93%E6%9E%84-toc" style="margin-left:80px;"><a href="#1.3%20%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E8%A1%A8%E7%BB%93%E6%9E%84">1.3 创建数据库/表结构</a></p>
<p id="2.%20%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93-toc" style="margin-left:40px;">💎<a href="#2.%20%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93">2. 封装数据库</a></p>
<p id="%C2%A01.%C2%A0%20DBUtil%20%E7%B1%BB%EF%BC%88JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89-toc" style="margin-left:80px;"><a href="#%C2%A01.%C2%A0%20DBUtil%20%E7%B1%BB%EF%BC%88JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89">1.  DBUtil 类（JDBC连接数据库）</a></p>
<p id="2.%20%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB-toc" style="margin-left:80px;"><a href="#2.%20%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB">2. 创建实体类</a></p>
<p id="2.1%20User-toc" style="margin-left:80px;"><a href="#2.1%20User">        </a><a href="#2.1%20User">2.1 User</a></p>
<p id="2.2%20Section-toc" style="margin-left:80px;"><a href="#2.2%20Section">        </a><a href="#2.2%20Section">2.2 Section</a></p>
<p id="2.3%20Topic-toc" style="margin-left:80px;"><a href="#2.3%20Topic">        </a><a href="#2.3%20Topic">2.3 Topic</a></p>
<p id="2.4%20Reply-toc" style="margin-left:80px;"><a href="#2.4%20Reply">        </a><a href="#2.4%20Reply">2.4 Reply</a></p>
<p id="2.5%20Key-toc" style="margin-left:80px;"><a href="#2.5%20Key">        </a><a href="#2.5%20Key">2.5 Key</a></p>
<p id="3.%20%E5%B0%81%E8%A3%85%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E7%B1%BB-toc" style="margin-left:80px;"><a href="#3.%20%E5%B0%81%E8%A3%85%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E7%B1%BB">3. 封装对数据库的增删查改类</a></p>
<p id="3.1%20UserDao-toc" style="margin-left:80px;"><a href="#3.1%20UserDao">        </a><a href="#3.1%20UserDao">3.1 UserDao</a></p>
<p id="3.2%20SectionDao-toc" style="margin-left:80px;"><a href="#3.2%20SectionDao">        </a><a href="#3.2%20SectionDao">3.2 SectionDao</a></p>
<p id="3.3%20TopicDao-toc" style="margin-left:80px;"><a href="#3.3%20TopicDao">        </a><a href="#3.3%20TopicDao">3.3 TopicDao</a></p>
<p id="3.4%20ReplyDao-toc" style="margin-left:80px;"><a href="#3.4%20ReplyDao">        </a><a href="#3.4%20ReplyDao">3.4 ReplyDao</a></p>
<p id="3.5%20KeyDao-toc" style="margin-left:80px;"><a href="#3.5%20KeyDao">        </a><a href="#3.5%20KeyDao">3.5 KeyDao</a></p>
<p id="%E4%B8%89.%20%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:0px;"><a href="https://blog.csdn.net/m0_62218217/article/details/125149381?spm=1001.2014.3001.5501#t0" title="💖">💖</a><a href="#%E4%B8%89.%20%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">三. 约定前后端交互接口</a></p>
<p id="0.%20%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2-toc" style="margin-left:40px;">💎<a href="#0.%20%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2">0. 前端页面</a></p>
<p id="1.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%88%97%E8%A1%A8%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#1.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%88%97%E8%A1%A8%E9%A1%B5">1. 实现论坛列表页</a></p>
<p id="1.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#1.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">1.1约定前后端交互接口</a></p>
<p id="1.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#1.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">1.2 实现服务器代码</a></p>
<p id="1.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#1.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">1.3 编写客户端代码</a></p>
<p id="2.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%BB%E8%B4%B4%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#2.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%BB%E8%B4%B4%E9%A1%B5">2. 实现论坛主贴页</a></p>
<p id="2.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#2.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">2.1约定前后端交互接口</a></p>
<p id="2.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#2.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">2.2 实现服务器代码</a></p>
<p id="2.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#2.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">2.3 编写客户端代码</a></p>
<p id="3.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%9B%9E%E5%A4%8D%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#3.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%9B%9E%E5%A4%8D%E9%A1%B5">3. 实现论坛回复页</a></p>
<p id="3.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#3.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">3.1约定前后端交互接口</a></p>
<p id="3.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#3.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">3.2 实现服务器代码</a></p>
<p id="3.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#3.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">3.3 编写客户端代码</a></p>
<p id="4.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#4.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83%E9%A1%B5">4. 实现论坛个人中心页</a></p>
<p id="4.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#4.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">4.1约定前后端交互接口</a></p>
<p id="4.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#4.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">4.2 实现服务器代码</a></p>
<p id="4.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#4.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">4.3 编写客户端代码</a></p>
<p id="5.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%8F%91%E5%B8%83%E5%B8%96%E5%AD%90%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#5.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%8F%91%E5%B8%83%E5%B8%96%E5%AD%90%E9%A1%B5">5. 实现论坛发布帖子页</a></p>
<p id="5.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#5.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">5.1约定前后端交互接口</a></p>
<p id="5.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#5.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">5.2 实现服务器代码</a></p>
<p id="%C2%A05.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#%C2%A05.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81"> 5.3 编写客户端代码</a></p>
<p id="6.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E7%99%BB%E5%BD%95%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#6.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E7%99%BB%E5%BD%95%E9%A1%B5">6. 实现论坛登录页</a></p>
<p id="6.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#6.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">6.1约定前后端交互接口</a></p>
<p id="6.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#6.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">6.2 实现服务器代码</a></p>
<p id="6.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#6.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">6.3 编写客户端代码</a></p>
<p id="7.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E5%86%8C%E9%A1%B5-toc" style="margin-left:40px;">💎<a href="#7.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E5%86%8C%E9%A1%B5">7. 实现论坛注册页</a></p>
<p id="7.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3-toc" style="margin-left:80px;"><a href="#7.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">7.1约定前后端交互接口</a></p>
<p id="7.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#7.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">7.2 实现服务器代码</a></p>
<p id="7.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#7.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">7.3 编写客户端代码</a></p>
<p id="8.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E9%94%80-toc" style="margin-left:40px;">💎<a href="#8.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E9%94%80">8. 实现论坛注销</a></p>
<p id="8.1%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81-toc" style="margin-left:80px;"><a href="#8.1%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">8.1实现服务器代码</a></p>
<hr id="hr-toc"/>
<p>【大家好，我是<strong>爱干饭的猿</strong>，如果喜欢这篇文章，<strong>点个赞</strong>👍，<strong>关注一下吧，</strong>后续会持续分享其他项目的相关操作和Linux相关知识<strong>】</strong></p>
<p>上一篇文章：<a class="link-info" href="https://blog.csdn.net/m0_62218217/article/details/125149381?spm=1001.2014.3001.5501" title="《前端项目 - 论坛信息管理系统（纯页面）》">《前端项目 - 论坛信息管理系统（纯页面）》</a></p>
<p>本篇文章介绍的《论坛信息管理系统》源码链接放在文章末尾了，感兴趣的朋友可以看看。</p>
<hr/>
<p>上一篇文章中我们完成了论坛信息管理系统的前端页面，现在我们可以基于模板的方式，通过服务器把数据渲染到页面中，然后直接返回完整的页面给浏览器。</p>
<p>目前比较主流的开发方式是“前后端分离”的方式，在这种方式下服务端不关注页面的内容，而是网页提供的数据。</p>
<p>网页可以通过ajax的方式和服务器之间交互数据，网页拿到数据之后再根据数据的内容渲染到页面上。</p>
<p><img alt="" height="525" src="image\eeb774c3ba184995a5eee0fb4bdd9327.png" width="1200"/></p>
<blockquote>
<div>
  此篇文章仅展示重要代码思路过程，项目源码在 gitee 中
 </div>
<div></div>
<div>
  链接：
  <a class="link-info" href="https://gitee.com/hao-min-chen/forum_management_information_system" title="《论坛信息管理系统》">《论坛信息管理系统》</a>
</div>
</blockquote>
<p><strong>效果展示</strong></p>
<p>论坛列表页：</p>
<p><img alt="" height="1034" src="image\e3ce1ce3fd754666a30d5354c84905f7.png" width="1200"/></p>
<p>论坛主贴页：</p>
<p><img alt="" height="1034" src="image\e33722d7846648a9b4d103f6f4108655.png" width="1200"/></p>
<p>论坛回帖页：</p>
<p><img alt="" height="1034" src="image\0644dac1d2a84193a27ddfa79a5cf3aa.png" width="1200"/></p>
<p>用户写帖子页：</p>
<p><img alt="" height="1034" src="image\e191811354ee4a43b9c5eb25a2013a94.png" width="1200"/></p>
<p>用户个人信息页：</p>
<p><img alt="" height="1034" src="image\9ee4e6934a8a40a08b43f7405956868e.png" width="1200"/></p>
<p>论坛登录页：<img alt="" height="1034" src="image\a271d23ed7104f82a040122fced79d9a.png" width="1200"/></p>
<p> 论坛注册页：</p>
<p><img alt="" height="1034" src="image\4d5f08305fba406fabba1e0df121fc3f.png" width="1200"/></p>
<hr/>
<p> </p>
<h1 id="%E4%B8%80.%20%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span style="color:#333333;"><strong>一. 准备工作</strong></span></h1>
<div></div>
<h2 id="1)%20%E5%88%9B%E5%BB%BA%20web%20%E9%A1%B9%E7%9B%AE"><span style="color:#333333;">1) </span><span style="color:#333333;">创建</span><span style="color:#333333;"> web </span><span style="color:#333333;">项目</span></h2>
<div></div>
<h2 id="2)%20%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span style="color:#333333;">2) </span><span style="color:#333333;">创建目录结构</span></h2>
<div></div>
<div>
<img alt="" height="1200" src="image\ce54c399cef2439e8201b2195c582bfb.png" width="330"/>
</div>
<p></p>
<h2 id="3)%20%E9%85%8D%E7%BD%AE%20pom.xml"><span style="color:#333333;">3) </span><span style="color:#333333;">配置</span><span style="color:#333333;"> pom.xml </span></h2>
<div></div>
<pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.example&lt;/groupId&gt;
    &lt;artifactId&gt;forum-inforation-management-system&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    
    &lt;!-- 指定最终 war 包的名称 --&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;

    &lt;properties&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;!-- 加入 servlet 依赖 --&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
            &lt;version&gt;3.1.0&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
            &lt;version&gt;5.1.49&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
            &lt;version&gt;2.12.4&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;version&gt;1.18.20&lt;/version&gt;
            &lt;scope&gt;compile&lt;/scope&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;


&lt;/project&gt;</code></pre>
<div></div>
<hr/>
<h1 id="%E4%BA%8C.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81">二. 数据库操作代码</h1>
<h2 id="1.%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1">1. 数据库设计</h2>
<h3 id="1.1%20ER%E5%9B%BE">1.1 ER图</h3>
<div>
<img alt="" height="1137" src="image\1a1e27dfd00b4a738ce63840af5f9216.png" width="859"/>
</div>
<p style="margin-left:.0001pt;text-align:left;"></p>
<h3 id="1.2%C2%A0ER%E5%9B%BE%E8%BD%AC%E5%8C%96%E4%B8%BA%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E5%B9%B6%E4%BC%98%E5%8C%96" style="margin-left:.0001pt;text-align:left;"><span style="color:#000000;"><strong><span style="color:#000000;"><strong>1.2 ER图转化为关系</strong></span></strong><strong><span style="color:#000000;"><strong>模型并优化</strong></span></strong></span></h3>
<blockquote>
<ol><li style="text-align:left;"><span style="color:#000000;"><span style="color:#000000;">管理员信息表</span><span style="color:#000000;">（</span><u><span style="color:#000000;"><u>管理员编号</u></span></u><span style="color:#000000;">，管理员名称，管理员密码</span><span style="color:#000000;">）</span></span></li><li style="text-align:left;"><span style="color:#000000;"><span style="color:#000000;">用户信息表</span><span style="color:#000000;">（</span><u><span style="color:#000000;"><u>用户编号</u></span></u><span style="color:#000000;">，用户名称，用户密码，用户生日，用户性别，用户性别，用户生日，用户职业，用户爱好，用户帖子数，用户等级，用户注册日期</span><span style="color:#000000;">）</span></span></li><li style="text-align:left;"><span style="color:#000000;"><span style="color:#000000;">版</span><span style="color:#000000;">块信息表</span><span style="color:#000000;">（</span><u><span style="color:#000000;"><u>版块编号，版主编号</u></span></u><span style="color:#000000;">，版块名称，版块说明，版块点击次数，版块主题数</span><span style="color:#000000;">）</span></span></li><li style="text-align:left;"><span style="color:#000000;"><span style="color:#000000;">主贴信息表</span><span style="color:#000000;">（</span><u><span style="color:#000000;"><u>主贴编号</u></span></u><u><span style="color:#000000;"><u>，</u></span></u><u><span style="color:#000000;"><u>主贴板块编号</u></span></u><u><span style="color:#000000;"><u>，</u></span></u><u><span style="color:#000000;"><u>主贴用户编号</u></span></u><span style="color:#000000;">，</span><span style="color:#000000;">主贴回复次数</span><span style="color:#000000;">，</span><span style="color:#000000;">主贴标题</span><span style="color:#000000;">，</span><span style="color:#000000;">主贴内容</span><span style="color:#000000;">，</span><span style="color:#000000;">主贴时间</span><span style="color:#000000;">，</span><span style="color:#000000;">主贴回复次数，</span><span style="color:#000000;">主贴点击次数</span><span style="color:#000000;">）</span></span></li><li style="text-align:left;"><span style="color:#000000;"><span style="color:#000000;">回复贴信息表</span><span style="color:#000000;">（</span><u><span style="color:#000000;"><u>回帖编号</u></span></u><u><span style="color:#000000;"><u>，</u></span></u><u><span style="color:#000000;"><u>回帖主题帖子编号</u></span></u><u><span style="color:#000000;"><u>，</u></span></u><u><span style="color:#000000;"><u>回帖的用户编号</u></span></u><span style="color:#000000;">，</span><span style="color:#000000;">回帖标题</span><span style="color:#000000;">，</span><span style="color:#000000;">回帖内容</span><span style="color:#000000;">，</span><span style="color:#000000;">回帖时间</span><span style="color:#000000;">，</span><span style="color:#000000;">回帖点击次数</span><span style="color:#000000;">）</span></span></li></ol>
</blockquote>
<div>
<h3 id="1.3%20%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%2F%E8%A1%A8%E7%BB%93%E6%9E%84"><strong>1.3 创建数据库/表结构</strong></h3>
<blockquote>
<div>
   根据在ER图中的实体，创建库表结构
  </div>
</blockquote>
<blockquote>
<div>
   db.sql
  </div>
</blockquote>
<div>
<pre><code class="language-sql">-- 创建数据库
if exit forum_management_information_system1 drop database `forum_management_information_system1`;
CREATE SCHEMA `forum_management_information_system1` DEFAULT CHARACTER SET utf8 ;

-- 创建管理员信息表
CREATE TABLE `admin` (
  `adminID` int NOT NULL AUTO_INCREMENT COMMENT '管理员编号',
  `adminName` varchar(20) NOT NULL COMMENT '管理员名称',
  `adminPassword` varchar(20) NOT NULL COMMENT '管理员密码',
  PRIMARY KEY (`adminID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3 COMMENT='管理员信息表';

-- 创建用户信息表
CREATE TABLE `user` (
  `uID` int NOT NULL AUTO_INCREMENT COMMENT '用户编号',
  `userName` varchar(20) NOT NULL COMMENT '用户昵称',
  `userPassword` varchar(20) NOT NULL COMMENT '用户密码',
  `userSex` varchar(20) NOT NULL COMMENT '用户性别',
  `userAge` int NOT NULL COMMENT '用户生日',
  `userOccupation` varchar(20) NOT NULL COMMENT '用户职业',
  `userHobby` varchar(20) NOT NULL COMMENT '用户爱好',
  `userPoint` int NOT NULL DEFAULT '0' COMMENT '用户积分',
  `userClass` int NOT NULL DEFAULT '0' COMMENT '用户等级',
  `userRegister` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '用户注册时间',
  PRIMARY KEY (`uID`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8mb3 COMMENT='用户信息表';

-- 板块信息表
CREATE TABLE `section` (
  `sID` int NOT NULL AUTO_INCREMENT COMMENT '板块编号',
  `uID` int NOT NULL COMMENT '版主编号（用户编号）',
  `sName` varchar(50) NOT NULL COMMENT '板块名称',
  `sStatement` text NOT NULL COMMENT '板块说明',
  `sClickCount` int NOT NULL DEFAULT '0' COMMENT '板块点击次数',
  `sTopicCount` int NOT NULL DEFAULT '0' COMMENT '板块主题数',
  PRIMARY KEY (`sID`),
  KEY `s_uID_idx` (`uID`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb3 COMMENT='板块信息表';

-- 主贴信息表
CREATE TABLE `topic` (
  `tID` int NOT NULL AUTO_INCREMENT COMMENT '主贴编号',
  `sID` int NOT NULL COMMENT '主贴板块编号',
  `uID` int NOT NULL COMMENT '主贴用户编号',
  `tTopic` varchar(20) NOT NULL COMMENT '主贴标题',
  `tContent` text NOT NULL COMMENT '主贴内容',
  `tTime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '主贴时间',
  `tReplyCount` int NOT NULL DEFAULT '0' COMMENT '主贴回复次数',
  `tClickCount` int NOT NULL DEFAULT '0' COMMENT '主贴点击次数',
  PRIMARY KEY (`tID`),
  KEY `t_uID_idx` (`uID`),
  KEY `t_sID_idx` (`sID`),
  CONSTRAINT `t_sID` FOREIGN KEY (`sID`) REFERENCES `section` (`sID`),
  CONSTRAINT `t_uID` FOREIGN KEY (`uID`) REFERENCES `user` (`uID`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8mb3 COMMENT='主贴信息表';

-- 回复贴信息表
CREATE TABLE `reply` (
  `rID` int NOT NULL AUTO_INCREMENT COMMENT '回帖编号',
  `tID` int NOT NULL COMMENT '回帖主题帖子编号（主贴信息表）',
  `uID` int NOT NULL COMMENT '回帖的用户编号',
  `rTopic` varchar(20) NOT NULL DEFAULT '回帖' COMMENT '回帖标题',
  `rContent` text NOT NULL COMMENT '回帖内容',
  `rTime` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '回帖时间',
  `rClickCount` int NOT NULL DEFAULT '0' COMMENT '回帖点击次数',
  PRIMARY KEY (`rID`)
) ENGINE=InnoDB AUTO_INCREMENT=24 DEFAULT CHARSET=utf8mb3 COMMENT='回复贴信息表';

-- 初始数据 （增加一个用户）
INSERT INTO `forum_management_information_system1`.`user` (`userName`, `userPassword`, `userSex`, `userAge`, `userOccupation`, `userHobby`) VALUES ('管理员', '123456', '男', '18', '管理员', '你猜');

-- 初始化板块数据
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '网易云', '小时候枕头上全是口水，长大后枕头上全是泪水；小时候微笑是一个心情，长大后微笑是一种表情；小时候哭着哭着就笑了，长大后笑着笑着就哭了。我们终于到了小时候最羡慕的年龄，但却没有成为小时候最想成为的人。——网易云音乐热评《当我已不再那么年轻》');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '码农', '码农Coding Peasant(s)：可以指在程序设计某个专业领域中的专业人士，或是从事软体撰写，程序开发、维护的专业人员。但一般Coder特指进行编写代码的编码员。');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '电影', '电影，也被称为运动画面或动态画面，即“映画”，是作品视觉艺术形式，通过使用移动图像来表达沟通思想，故事，认知，情感，价值观，或各类大气模拟体验。这些图像通常伴随着声音，很少有其他感官刺激。 “电影”一词是电影摄影的缩写，通常用于指代电影制作和电影业，以及由此产生的艺术形式。');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '体育', '（ physical education ，缩写 PE 或 P.E. ），是一种复杂的社会文化现象，它是一种以身体与智力活动为基本手段，根据人体生长发育、技能形成和机能提高等规律，达到促进全面发育、提高身体素质与全面教育水平、增强体质与提高运动能力、改善生活方式与提高生活质量的一种有意识、有目的、有组织的社会活动。');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '游戏', '游戏（英文: Game）是所有哺乳类动物，特别是灵长类动物学习生存的第一步。它是一种基于物质需求满足之上的，在一些特定时间、空间范围内遵循某种特定规则的，追求精神世界需求满足的社会行为方式，但同时这种行为方式也是哺乳类动物或者灵长类动物所需的一种降压减排的方式，不管是在出生幼年期，或者发育期，成熟期都会需要的一种行为方式。');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '旅行', '“旅”是旅行，外出，即为了实现某一目的而在空间上从甲地到乙地的行进过程；“游”是外出游览、观光、娱乐，即为达到这些目的所作的旅行。二者合起来即旅游。所以，旅行偏重于行，旅游不但有“行”，且有观光、娱乐含义。');
INSERT INTO `forum_management_information_system1`.`section` (`uID`, `sName`, `sStatement`) VALUES ('1', '明星', ' (拼音míng xīng，注音ㄇㄧㄥˊ ㄒㄧㄥ)汉语 词语 ，古书上指金星；旧时指 交际 场中有名的女子；现指在某个领域内有一定影响力的人物。 泛指有名的 演员 、 歌手 、 艺人 、 运动员 等。');
</code></pre>
</div>
<h2 id="2.%20%E5%B0%81%E8%A3%85%E6%95%B0%E6%8D%AE%E5%BA%93"><strong>2. 封装数据库</strong></h2>
<div>
<h3 id="%C2%A01.%C2%A0%20DBUtil%20%E7%B1%BB%EF%BC%88JDBC%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%89"><span style="color:#333333;"> 1.  DBUtil 类（JDBC连接数据库）</span></h3>
<div>
<img alt="" height="43" src="image\3cbdb915a0de40b5ace204f6f917c1d8.png" width="230"/>
</div>
<div>
<pre><code class="language-java">package forum.util;

import com.mysql.jdbc.jdbc2.optional.MysqlDataSource;
import lombok.SneakyThrows;

import javax.sql.DataSource;
import java.sql.Connection;

/**
 * @author haomin
 * @date 2022/06/29 17:23
 **/
public class DBUtil {
    private static final DataSource dataSource;

    static {
        MysqlDataSource mysqlDataSource = new MysqlDataSource();
        // 数据库路径要正确
        mysqlDataSource.setUrl("jdbc:mysql:///forum_management_information_system1?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai");
        mysqlDataSource.setUser("root");
        mysqlDataSource.setPassword("123456");
        dataSource = mysqlDataSource;
    }

    @SneakyThrows
    public static Connection connection() {
        return dataSource.getConnection();
    }

}</code></pre>
</div>
<h3 id="2.%20%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB">2. 创建实体类</h3>
</div>
<div>
<img alt="" height="180" src="image\b9434b1171f74fd88ed0a66ecd2547a0.png" width="229"/>
</div>
<blockquote>
<div>
<span style="color:#333333;">一般放对象的目录命名为model，根据model目录，其中存放的都是各种对象，例如</span>
<span style="color:#333333;"> User 类、Topic 类、Reply 类。</span>
</div>
</blockquote>
<blockquote>
<div>
<strong><span style="color:#333333;">使用@Data注解在类上时，不用再手动添加get/set等方法了，简化代码</span></strong>
</div>
</blockquote>
<h3 id="2.1%20User">2.1 User</h3>
<div>
<pre><code class="language-java">package forum.model;

import lombok.Data;

// 使用@Data注解在类上时，不用再手动添加get/set等方法了，简化代码
@Data
public class User {
    public Integer uID;
    public String username;
    public String password;
    public String userSex;
    public Integer userAge;
    public String userOccupation;
    public String userHobby;
    public Integer userPoint;
    public Integer userClass;
    public String userRegister;
}</code></pre>
<h3 id="2.2%20Section">2.2 Section</h3>
<pre><code class="language-java">package forum.model;

import lombok.Data;

@Data
public class Section {
    public Integer sID;
    public Integer uID;
    public String sName;
    public String sStatement;
    public Integer sClickCount;
    public Integer sTopicCount;
}</code></pre>
<h3 id="2.3%20Topic">2.3 Topic</h3>
<pre><code class="language-java">package forum.model;

import com.fasterxml.jackson.annotation.JsonFormat;
import lombok.Data;

import java.util.Date;

@Data
public class Topic {
    public Integer tID;
    public Integer sID;
    public Integer uID;
    public String username;
    public String tTopic;
    public String tContent;
    //@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    public String tTime;
    public Integer tReplyCount;
    public Integer tClickCount;
}</code></pre>
<h3 id="2.4%20Reply">2.4 Reply</h3>
<pre><code class="language-java">package forum.model;

import com.fasterxml.jackson.annotation.JsonFormat;

import java.util.Date;

public class Reply {
    public Integer rID;
    public Integer tID;
    public Integer uID;
    public String username;
    public String rTopic;
    public String rContent;
    public String rTime;
    public Integer rClickCount;
}</code></pre>
<h3 id="2.5%20Key">2.5 Key</h3>
<blockquote>
<p>为实现一个搜索功能，新建了一个Keyword实体</p>
</blockquote>
<pre><code class="language-java">package forum.model;

import lombok.Data;

@Data
public class Keyword {
    public String keyword;
}</code></pre>
<h3 id="3.%20%E5%B0%81%E8%A3%85%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E7%B1%BB">3. 封装对数据库的增删查改类</h3>
<p><img alt="" height="120" src="image\05ba8ec6dcd8470ab45a8f97df8903c6.png" width="230"/></p>
</div>
<blockquote>
<div>
<span style="color:#333333;">一般放数据库增删查改的目录命名为dao，根据dao目录，其中存放的都是各种数据库增删查改方法类，例如 UserDao 类</span>
<span style="color:#333333;">, SectionDao </span>
<span style="color:#333333;">类。</span>
</div>
</blockquote>
<div></div>
<div></div>
<h3 id="3.1%20UserDao"><span style="color:#333333;">3.1 UserDao</span></h3>
<div>
<pre><code class="language-java">package forum.dao;

import forum.model.User;
import forum.util.DBUtil;
import lombok.SneakyThrows;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

/**
 * @author haomin
 * @date 2022/06/29 17:22
 **/

// 从数据库查找user数据的方法类
public class UserDao {

    // 用户帖子数
    @SneakyThrows
    public int selectPointCountByUid(int uid){
        String sql = "select count(*) from topic where uID = ?";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,uid);
                try (ResultSet rs = ps.executeQuery()){
                    rs.next();
                    int count = rs.getInt("count(*)");
                    updatePointCountByUid(uid,count);
                    return count;
                }
            }
        }
    }

    // 更新主贴回复数
    @SneakyThrows
    public void updatePointCountByUid(int uID, int count) {
        String sql = "update user set userPoint = ? where uID = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,count);
                ps.setInt(2,uID);

                ps.executeUpdate();
            }
        }
    }

    // 用户等级
    public int selectClassCountByUid(int uid){
        int point = new UserDao().selectPointCountByUid(uid);
        int classCount = 0;
        if(point == 0){
            classCount = 0;
        }else if(point &lt; 5){
            classCount = 1;
        }else if(point &lt; 15){
            classCount = 2;
        }else if(point &lt; 30){
            classCount = 3;
        }else {
            classCount = 4;
        }
        updateClassCountByUid(uid,classCount);
        return classCount;
    }

    @SneakyThrows
    private void updateClassCountByUid(int uID, int classCount) {
        String sql = "update user set userClass = ? where uID = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,classCount);
                ps.setInt(2,uID);

                ps.executeUpdate();
            }
        }

    }

    // 查询用户ByUsernameAndPassword
    @SneakyThrows
    public User selectOneByUsernameAndPassword(String username,String password){
        String sql = "select uID, userSex, userAge,userOccupation, userHobby, userPoint, userClass, userRegister from user where userName = ? and userPassword = ?";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setString(1,username);
                ps.setString(2,password);

                System.out.println("DEBUG: " + ps);
                try (ResultSet rs = ps.executeQuery()){
                    if(!rs.next()){
                        return null;
                    }

                    User user = new User();
                    user.uID = rs.getInt("uID");
                    user.username = username;
                    user.password = password;
                    user.userSex = rs.getString("userSex");
                    user.userAge = rs.getInt("userAge");
                    user.userOccupation = rs.getString("userOccupation");
                    user.userHobby = rs.getString("userHobby");
                    user.userPoint = rs.getInt("userPoint");
                    user.userClass = rs.getInt("userClass");
                    String Time = rs.getString("userRegister");
                    user.userRegister = Time.substring(0,Time.length()-5);

                    return user;
                }
            }
        }
    }

    // 查询用户名ByUid
    @SneakyThrows
    public String selectUserNameByUid(int uid){
        String sql = "select username from user where uID = ?";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,uid);
                try (ResultSet rs = ps.executeQuery()){
                    if(!rs.next()){
                        return null;
                    }
                    String username = rs.getString("username");

                    return username;
                }
            }
        }
    }

    // 新建用户
    @SneakyThrows
    public User insert(String username, String password, String sex, int age, String occupation, String hobby) {
        String sql = "insert into user (username,userPassword,userSex,userAge,userOccupation,userHobby) values (?, ?, ?, ?, ?, ?)";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setString(1,username);
                ps.setString(2,password);
                ps.setString(3,sex);
                ps.setInt(4,age);
                ps.setString(5,occupation);
                ps.setString(6,hobby);

                ps.executeUpdate();
                System.out.println("新建用户完成");
                return new UserDao().selectOneByUsernameAndPassword(username,password);
            }
        }
    }
}</code></pre>
<h3 id="3.2%20SectionDao">3.2 SectionDao</h3>
<pre><code class="language-java">package forum.dao;

import forum.model.Section;
import forum.util.DBUtil;
import lombok.SneakyThrows;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

/**
 * @author haomin
 * @date 2022/06/30 11:32
 **/
public class SectionDao {

    // 得到板块集合ByUid
    @SneakyThrows
    public List&lt;Section&gt; selectListByUid(){
        List&lt;Section&gt; list = new ArrayList&lt;&gt;();
        String sql = "select sID, uID, sName, sStatement, sClickCount, sTopicCount from section;";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)){
                System.out.println("DEBUG: " + ps);
                try (ResultSet rs = ps.executeQuery()){
                    while (rs.next()){
                        Section section = new Section();
                        section.sID = rs.getInt("sID");
                        section.uID = rs.getInt("uID");
                        section.sName = rs.getString("sName");
                        section.sStatement = rs.getString("sStatement");
                        section.sClickCount = rs.getInt("sClickCount");
                        section.sTopicCount = new TopicDao().sTopicCount(section.sID);

                        list.add(section);
                    }
                }
            }
        }
        return list;
    }

    // 得到板块集合ByKeyWord
    @SneakyThrows
    public List&lt;Section&gt; selectSectionListByKeyword(String keyword) {
        List&lt;Section&gt; list = new ArrayList&lt;&gt;();
        String sql = "select * from section where sName like ?;";

        System.out.println(sql);
        try (Connection c = DBUtil.connection()) {
            System.out.println(sql);

            try (PreparedStatement ps = c.prepareStatement(sql)){
                System.out.println(sql);
                String key = "%"+keyword+"%";
                ps.setString(1,key);
                System.out.println(sql);

                try (ResultSet rs = ps.executeQuery()){
                    while (rs.next()){
                        Section section = new Section();
                        section.sID = rs.getInt("sID");
                        section.uID = rs.getInt("uID");
                        section.sName = rs.getString("sName");
                        section.sStatement = rs.getString("sStatement");
                        section.sClickCount = rs.getInt("sClickCount");
                        section.sTopicCount = new TopicDao().sTopicCount(section.sID);

                        list.add(section);
                    }
                }
            }
        }
        return list;
    }

    // 更新浏览次数
    @SneakyThrows
    public void update(int sid) {
        String sql = "update section set sClickCount = sClickCount+1 where sid = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,sid);

                ps.executeUpdate();
            }
        }
    }
}</code></pre>
<h3 id="3.3%20TopicDao">3.3 TopicDao</h3>
<pre><code class="language-java">package forum.dao;

import forum.model.Section;
import forum.model.Topic;
import forum.model.User;
import forum.util.DBUtil;
import lombok.SneakyThrows;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

/**
 * @author haomin
 * @date 2022/06/30 16:38
 **/
public class TopicDao {

    // 查询板块帖子数
    @SneakyThrows
    public int sTopicCount(Integer sID) {
        String sql = "select count(*) from topic where sID = ?";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,sID);
                try (ResultSet rs = ps.executeQuery()){
                    rs.next();
                    int count = rs.getInt("count(*)");

                    updateSTopicCount(sID, count);
                    return count;
                }
            }
        }
    }

    // 更新板块帖子数
    @SneakyThrows
    public void updateSTopicCount(int sID, int count) {
        String sql = "update section set sTopicCount = ? where sID = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,count);
                ps.setInt(2,sID);

                ps.executeUpdate();
            }
        }
    }

    // 得到主贴集合BySid
    @SneakyThrows
    public List&lt;Topic&gt; selectListByUid(int sid){
        List&lt;Topic&gt; list = new ArrayList&lt;&gt;();
        String sql = "select tID, uID, tTopic, tContent, tTime, tReplyCount, tClickCount from topic where sID = ? order by tTime desc";
        try(Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,sid);
                System.out.println("DEBUG: " + ps);
                try (ResultSet rs = ps.executeQuery()){
                    while (rs.next()){
                        Topic topic = new Topic();
                        topic.tID = rs.getInt("tID");
                        topic.sID = sid;
                        topic.uID = rs.getInt("uID");
                        topic.username = new UserDao().selectUserNameByUid(topic.uID);
                        topic.tTopic = rs.getString("tTopic");
                        topic.tContent = rs.getString("tContent");
                        String Time = rs.getString("tTime");
                        topic.tTime = Time.substring(0,Time.length()-5);

                        topic.tReplyCount = new ReplyDao().tReplyCount(topic.tID);
                        topic.tClickCount = rs.getInt("tClickCount");

                        list.add(topic);
                    }
                }
            }
        }
        return list;
    }

    // 得到主贴集合ByKeyword
    @SneakyThrows
    public List&lt;Topic&gt; selectTopicListByKeyword(String keyword) {
        List&lt;Topic&gt; list = new ArrayList&lt;&gt;();
        String sql = "select * from topic where tTopic like ?;";

        System.out.println(sql);
        try (Connection c = DBUtil.connection()) {
            System.out.println(sql);

            try (PreparedStatement ps = c.prepareStatement(sql)){
                System.out.println(sql);
                String key = "%"+keyword+"%";
                ps.setString(1,key);
                System.out.println(sql);

                try (ResultSet rs = ps.executeQuery()){
                    while (rs.next()){
                        Topic topic = new Topic();
                        topic.tID = rs.getInt("tID");
                        topic.sID = rs.getInt("sId");
                        topic.uID = rs.getInt("uID");
                        topic.username = new UserDao().selectUserNameByUid(topic.uID);
                        topic.tTopic = rs.getString("tTopic");
                        topic.tContent = rs.getString("tContent");
                        String Time = rs.getString("tTime");
                        topic.tTime = Time.substring(0,Time.length()-5);

                        topic.tReplyCount = new ReplyDao().tReplyCount(topic.tID);
                        topic.tClickCount = rs.getInt("tClickCount");

                        list.add(topic);
                    }
                }
            }
        }

        return list;
    }

    // 查询一个主贴ByTid
    @SneakyThrows
    public Topic selectTopicByTid(int tid) {
        String sql = "select sID, uID, tTopic, tContent, tTime, tReplyCount, tClickCount from topic where tID = ?";
        try(Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,tid);

                System.out.println("DEBUG: " + ps);
                try (ResultSet rs = ps.executeQuery()){
                    rs.next();

                    Topic topic = new Topic();
                    topic.tID = tid;
                    topic.sID = rs.getInt("sID");
                    topic.uID = rs.getInt("uID");
                    topic.username = new UserDao().selectUserNameByUid(topic.uID);
                    topic.tTopic = rs.getString("tTopic");
                    topic.tContent = rs.getString("tContent");
                    String Time = rs.getString("tTime");
                    topic.tTime = Time.substring(0,Time.length()-5);

                    topic.tReplyCount = new ReplyDao().tReplyCount(topic.tID);
                    topic.tClickCount = rs.getInt("tClickCount");

                    return topic;
                }
            }
        }
    }

    // 插入主贴
    @SneakyThrows
    public void insert(int sid, Integer uID, String title, String content) {
        String sql = "insert into topic (sID, uID, tTopic, tContent) values (?, ?, ?, ?)";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,sid);
                ps.setInt(2,uID);
                ps.setString(3,title);
                ps.setString(4,content);

                ps.executeUpdate();
                System.out.println("插入完成");
            }
        }
    }

    // 更新主贴浏览次数
    @SneakyThrows
    public void update(int tid) {
        String sql = "update topic set tClickCount = tClickCount+1 where tid = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,tid);

                ps.executeUpdate();
            }
        }
    }


}</code></pre>
<h3 id="3.4%20ReplyDao">3.4 ReplyDao</h3>
<pre><code class="language-java">package forum.dao;

import forum.model.Reply;
import forum.util.DBUtil;
import lombok.SneakyThrows;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.List;

/**
 * @author haomin
 * @date 2022/06/30 16:38
 **/
public class ReplyDao {

    // 查询主贴回复数
    @SneakyThrows
    public int tReplyCount(int tid){
        try (Connection c = DBUtil.connection()){
            String sql = "select count(*) from reply where tID = ?;";
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,tid);
                try (ResultSet rs = ps.executeQuery()){
                    rs.next();
                    int count = rs.getInt("count(*)");
                    updateTReplyCount(tid,count);
                    return count;
                }
            }
        }
    }

    // 更新主贴回复数
    @SneakyThrows
    public void updateTReplyCount(int tID, int count) {
        String sql = "update topic set tReplyCount = ? where tID = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,count);
                ps.setInt(2,tID);

                ps.executeUpdate();
            }
        }
    }

    // 根据tid查询所有回复
    @SneakyThrows
    public List&lt;Reply&gt; selectListByTid(int tid){
        List&lt;Reply&gt; list = new ArrayList&lt;&gt;();
        String sql = "select rID, uID, rTopic, rContent, rTime, rClickCount from reply where tid = ? order by rTime desc";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,tid);
                System.out.println("DEBUG: " + ps);

                try (ResultSet rs = ps.executeQuery()){
                    while (rs.next()){
                        Reply reply = new Reply();
                        reply.rID = rs.getInt("rID");
                        reply.tID = tid;
                        reply.uID = rs.getInt("uID");
                        reply.username = new UserDao().selectUserNameByUid(reply.uID);
                        reply.rTopic = rs.getString("rTopic");
                        reply.rContent = rs.getString("rContent");
                        String Time = rs.getString("rTime");
                        reply.rTime = Time.substring(0,Time.length()-5);
                        reply.rClickCount = rs.getInt("rClickCount");

                        list.add(reply);
                    }
                }

            }
        }
        return list;
    }

    // 插入主贴
    @SneakyThrows
    public void insert(int tid, Integer uID, String content) {
        try (Connection c = DBUtil.connection()){
            String sql = "insert into reply (tID,uID,rContent) values (?,?,?)";
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setInt(1,tid);
                ps.setInt(2,uID);
                ps.setString(3,content);

                ps.executeUpdate();
                System.out.println("插入完成");
            }
        }
    }
}</code></pre>
<h3 id="3.5%20KeyDao">3.5 KeyDao</h3>
<pre><code class="language-java">package forum.dao;

import forum.model.Keyword;
import forum.util.DBUtil;
import lombok.SneakyThrows;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

/**
 * @author haomin
 * @date 2022/07/04 10:11
 **/

public class KeyDao {

    // 插入查询的关键字
    @SneakyThrows
    public void insertKey (String keyword){
        String sql = "INSERT INTO `forum_management_information_system`.`key` (`keyword`) VALUES (?);";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.setString(1,keyword);

                ps.executeUpdate();
                System.out.println("插入完成");
            }
        }
    }

    // 更新主贴回复数
    @SneakyThrows
    public void updateTReplyCount(int tID, int count) {
        String sql = "update topic set tReplyCount = ? where tID = ?";
        try (Connection c = DBUtil.connection()) {
            try (PreparedStatement ps = c.prepareStatement(sql)) {
                ps.setInt(1,count);
                ps.setInt(2,tID);

                ps.executeUpdate();
            }
        }
    }

    // 查询是否存在关键字
    @SneakyThrows
    public String selectKey () {
        String sql = "select keyword from forum_management_information_system.key;";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                try (ResultSet rs = ps.executeQuery()){
                    if(rs.next()){
                        String keyword = rs.getString("keyword");
                        return keyword;
                    }else {
                        return null;
                    }

                }
            }
        }
    }

    // 删除关键字
    @SneakyThrows
    public void deleteKey () {
        String sql = "DELETE FROM `forum_management_information_system`.`key` WHERE (1 = 1);";
        try (Connection c = DBUtil.connection()){
            try (PreparedStatement ps = c.prepareStatement(sql)){
                ps.executeUpdate();
            }
        }
    }
}</code></pre>
</div>
</div>
<hr/>
<h1 id="%E4%B8%89.%20%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">三. 约定前后端交互接口</h1>
<h2 id="0.%20%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2">0. 前端页面</h2>
<blockquote>
<p>先把前端页面拷贝到当前项目</p>
</blockquote>
<p><img alt="" height="290" src="image\aa9bd69c56e543f9a804a65ccc3fc68d.png" width="272"/></p>
<blockquote>
<p>前端页面可见于上一篇博客：<a class="link-info" href="https://blog.csdn.net/m0_62218217/article/details/125149381?spm=1001.2014.3001.5501" title="《前端项目 - 论坛信息管理系统（纯页面）》">《前端项目 - 论坛信息管理系统（纯页面）》</a></p>
</blockquote>
<h2 id="1.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%88%97%E8%A1%A8%E9%A1%B5">1. 实现论坛列表页</h2>
<h3 id="1.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">1.1约定前后端交互接口</h3>
<pre><code>{
  "currentUser" : {
    "uID" : 17,
    "username" : "张三",
    "password" : "123",
    "userSex" : "男",
    "userAge" : 18,
    "userOccupation" : "大数据开发工程师",
    "userHobby" : "敲代码",
    "userPoint" : 1,
    "userClass" : 1,
    "userRegister" : "2022-07-08 15:01",
    "uid" : 17
  },
  "pointCount" : 1,
  "classCount" : 1,
  "sectionList" : [ {
    "sID" : 12,
    "uID" : 1,
    "sName" : "网易云",
    "sStatement" : "小时候枕头上全是口水，长大后枕头上全是泪水；小时候微笑是一个心情，长大后微笑是一种表情；小时候哭着哭着就笑了，长大后笑着笑着就哭了。我们终于到了小时候最羡慕的年龄，但却没有成为小时候最想成为的人。——网易云音乐热评《当我已不再那么年轻》",
    "sClickCount" : 2,
    "sTopicCount" : 3,
    "uid" : 1,
    "sname" : "网易云",
    "sclickCount" : 2,
    "sstatement" : "小时候枕头上全是口水，长大后枕头上全是泪水；小时候微笑是一个心情，长大后微笑是一种表情；小时候哭着哭着就笑了，长大后笑着笑着就哭了。我们终于到了小时候最羡慕的年龄，但却没有成为小时候最想成为的人。——网易云音乐热评《当我已不再那么年轻》"
    "sid" : 12,
    "stopicCount" : 3
  }, ...]
  "topicList" : null
}</code></pre>
<h3 id="1.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">1.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import com.fasterxml.jackson.databind.ObjectMapper;
import forum.dao.KeyDao;
import forum.model.Keyword;
import forum.model.SectionListResult;
import forum.model.User;
import forum.service.SectionService;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/06/30 11:21
 **/

@WebServlet("/section-list.json")
public class SectionListJsonServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        User currentUser = null;
        Keyword key = null;
        System.out.println("开始");

        HttpSession session = req.getSession(false);
        if(session != null){
            currentUser = (User) session.getAttribute("currentUser");
        }
        String keyword = new KeyDao().selectKey();

        SectionService sectionService = new SectionService();
        SectionListResult result = null;
        if(keyword == null) {
            result = sectionService.sectionListResult(currentUser);
            System.out.println("执行第一个");
        }else {
            System.out.println(keyword);
            result = sectionService.sectionListResult(currentUser,keyword);
            System.out.println("执行第二个");

        }

        ObjectMapper objectMapper = new ObjectMapper();
        String jsonString = objectMapper.writeValueAsString(result);

        resp.setCharacterEncoding("utf-8");
        resp.setContentType("application/json");
        resp.getWriter().printf(jsonString);
    }
}</code></pre>
<h3 id="1.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">1.3 编写客户端代码</h3>
<pre><code class="language-javascript">// 1. request /json/article_list.json
// 2. update dom tree
function renderAuthor(currentUser) {
    document.querySelector('.author-username').textContent = currentUser.username
    document.querySelector('.author-userSex').textContent = currentUser.userSex
    document.querySelector('.author-userAge').textContent = currentUser.userAge
    document.querySelector('.author-userOccupation').textContent = currentUser.userOccupation
    document.querySelector('.author-userHobby').textContent = "爱好：" + currentUser.userHobby
}

function renderCount(pointCount, classCount) {
    document.querySelector('.author-userPoint').textContent = pointCount
    document.querySelector('.author-userClass').textContent = classCount
}

function renderSectionList(sectionList, topicList) {
    console.log(sectionList)
    var container = document.querySelector('.section')
    console.log(container)

    for (var i in sectionList) {
        var section = sectionList[i]
        console.log(section)

        var html = `&lt;li&gt;` +
             `&lt;div class="板块信息"&gt;` +
                ` &lt;h3 class="板块名称"&gt;${section.sName}&lt;/h3&gt;` +
                 `&lt;div class="版主"&gt;版块ID: &lt;span class="版主名称"&gt;${section.sID}&lt;/span&gt;&lt;/div&gt;` +
                `&lt;p class="板块说明"&gt;${section.sStatement}&lt;/p&gt;` +

                ` &lt;div class="点击"&gt;` +
                     `&lt;div class="数量"&gt;` +
                        ` &lt;div&gt;浏览量&lt;/div&gt;` +
                        ` &lt;div&gt;${section.sClickCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                     `&lt;div&gt;` +
                         `&lt;div&gt;主贴数&lt;/div&gt;` +
                         `&lt;div&gt;${section.sTopicCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                 `&lt;/div&gt;` +

                 `&lt;div class="查看详情"&gt;` +
                     `&lt;a href="detail.html?sid=${section.sID}" target="_self"&gt;查看详情&gt;&gt;&lt;/a&gt;` +
                 `&lt;/div&gt;` +

             `&lt;/div&gt;&lt;/li&gt;`


        container.innerHTML += html
    }
}

function renderTopicList(topicList) {
    console.log(topicList)
    var container = document.querySelector('.topic')
    console.log(container)

    for (var i in topicList) {
        var topic = topicList[i]
        console.log(topic)


        var html = `&lt;li&gt;` +
             `&lt;div class="板块信息"&gt;` +
                 `&lt;h3 class="板块名称"&gt;${topic.tTopic}&lt;/h3&gt;` +
                ` &lt;p class="主贴时间"&gt;${topic.tTime}&lt;/p&gt;` +

                ` &lt;div class="版主"&gt;贴主: &lt;span class="版主名称"&gt;${topic.username}&lt;/span&gt;&lt;/div&gt;` +

                ` &lt;p class="板块说明"&gt;${topic.tContent}&lt;/p&gt;` +

                ` &lt;div class="点击"&gt;` +
                   `  &lt;div class="数量"&gt;` +
                         `&lt;div&gt;浏览量&lt;/div&gt;` +
                        ` &lt;div&gt;${topic.tClickCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                     `&lt;div&gt;` +
                         `&lt;div&gt;回复&lt;/div&gt;` +
                         `&lt;div&gt;${topic.tReplyCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                ` &lt;/div&gt;` +

                `&lt;div class="查看回复" style="display: block; margin: 10px auto 0 auto; align-items: center;
                text-align: center;color: black;user-select: none;cursor: pointer;"&gt;` +
                  `&lt;a href="reply.html?tid=${topic.tID}" target="_self" style="color: black;text-decoration:
                  none;font-size: 13px;"&gt;查看回复&gt;&gt;&lt;/a&gt;` +
                `&lt;/div&gt;` +
             `&lt;/div&gt;&lt;/li&gt;`


        container.innerHTML += html
    }
}

var xhr = new XMLHttpRequest()
xhr.open('get', '/section-list.json')
xhr.onload = function() {
    //alert(this.responseText);
    var data = JSON.parse(this.responseText)
    if(!data.currentUser){
        // 重定向
        // location = '/login.html'
        location.assign('/login.html')
        return
    }

    renderAuthor(data.currentUser)
    renderCount(data.pointCount, data.classCount)
    renderSectionList(data.sectionList)
    renderTopicList(data.topicList)
}
xhr.send()</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\ae735586d35a4fdc8fdfc5d42f39aabb.png" width="1200"/></p>
<h2 id="2.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%BB%E8%B4%B4%E9%A1%B5">2. 实现论坛主贴页</h2>
<h3 id="2.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">2.1约定前后端交互接口</h3>
<pre><code>{
  "currentUser" : {
    "uID" : 17,
    "username" : "张三",
    "password" : "123",
    "userSex" : "男",
    "userAge" : 18,
    "userOccupation" : "大数据开发工程师",
    "userHobby" : "敲代码",
    "userPoint" : 1,
    "userClass" : 1,
    "userRegister" : "2022-07-08 15:01",
    "uid" : 17
  },
  "pointCount" : 1,
  "classCount" : 1,
  "topicList" : [ {
    "tID" : 16,
    "sID" : 12,
    "uID" : 11,
    "username" : "管理员",
    "tTopic" : "窃取天上三分景",
    "tContent" : "小狐狸想去人间很久了，临行之前，她的姥姥赠她了一件宝物芙蓉面。 小狐狸得了这芙蓉面，欢喜极了，她摸了摸芙蓉面道：“姥姥，我得了芙蓉面也能行走人世吗？” “是啊，只要你戴上芙蓉面，这世上任何人的脸，都可以幻化，可你是妖，就算有了芙蓉面，也得学世人的姿态。” 小狐狸拿着芙蓉面思索半天，",
    "tTime" : "2022-07-08 13:50",
    "tReplyCount" : 4,
    "tClickCount" : 4,
    "uid" : 11,
    "treplyCount" : 4,
    "tclickCount" : 4,
    "ttime" : "2022-07-08 13:50",
    "tid" : 16,
    "tcontent" : "小狐狸想去人间很久了，临行之前，她的姥姥赠她了一件宝物芙蓉面。 小狐狸得了这芙蓉面，欢喜极了，她摸了摸芙蓉面道：“姥姥，我得了芙蓉面也能行走人世吗？” “是啊，只要你戴上芙蓉面，这世上任何人的脸，都可以幻化，可你是妖，就算有了芙蓉面，也得学世人的姿态。” 小狐狸拿着芙蓉面思索半天，",
    "ttopic" : "窃取天上三分景",
    "sid" : 12
  },...]
}</code></pre>
<h3 id="2.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">2.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import com.fasterxml.jackson.databind.ObjectMapper;
import forum.dao.KeyDao;
import forum.model.Keyword;
import forum.model.SectionListResult;
import forum.model.User;
import forum.service.SectionService;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/06/30 11:21
 **/

@WebServlet("/section-list.json")
public class SectionListJsonServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        User currentUser = null;
        Keyword key = null;
        System.out.println("开始");

        HttpSession session = req.getSession(false);
        if(session != null){
            currentUser = (User) session.getAttribute("currentUser");
        }
        String keyword = new KeyDao().selectKey();

        SectionService sectionService = new SectionService();
        SectionListResult result = null;
        if(keyword == null) {
            result = sectionService.sectionListResult(currentUser);
            System.out.println("执行第一个");
        }else {
            System.out.println(keyword);
            result = sectionService.sectionListResult(currentUser,keyword);
            System.out.println("执行第二个");

        }

        ObjectMapper objectMapper = new ObjectMapper();
        String jsonString = objectMapper.writerWithDefaultPrettyPrinter().writeValueAsString(result);

        resp.setCharacterEncoding("utf-8");
        resp.setContentType("application/json");
        resp.getWriter().printf(jsonString);
    }
}</code></pre>
<h3 id="2.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">2.3 编写客户端代码</h3>
<pre><code class="language-javascript">// 1. request /json/article_list.json
// 2. update dom tree
function renderAuthor(currentUser) {
    document.querySelector('.author-username').textContent = currentUser.username
    document.querySelector('.author-userSex').textContent = currentUser.userSex
    document.querySelector('.author-userAge').textContent = currentUser.userAge
    document.querySelector('.author-userOccupation').textContent = currentUser.userOccupation
    document.querySelector('.author-userHobby').textContent = "爱好：" + currentUser.userHobby
}

function renderCount(pointCount, classCount) {
    document.querySelector('.author-userPoint').textContent = pointCount
    document.querySelector('.author-userClass').textContent = classCount
}

function renderTopicList(topicList) {
    console.log(topicList)
    var container = document.querySelector('.topic')
    console.log(container)

    for (var i in topicList) {
        var topic = topicList[i]
        console.log(topic)


        var html = `&lt;li&gt;` +
             `&lt;div class="板块信息"&gt;` +
                 `&lt;h3 class="板块名称"&gt;${topic.tTopic}&lt;/h3&gt;` +
                ` &lt;p class="主贴时间"&gt;${topic.tTime}&lt;/p&gt;` +

                ` &lt;div class="版主"&gt;贴主: &lt;span class="版主名称"&gt;${topic.username}&lt;/span&gt;&lt;/div&gt;` +

                ` &lt;p class="板块说明"&gt;${topic.tContent}&lt;/p&gt;` +

                ` &lt;div class="点击"&gt;` +
                   `  &lt;div class="数量"&gt;` +
                         `&lt;div&gt;浏览量&lt;/div&gt;` +
                        ` &lt;div&gt;${topic.tClickCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                     `&lt;div&gt;` +
                         `&lt;div&gt;回复&lt;/div&gt;` +
                         `&lt;div&gt;${topic.tReplyCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                ` &lt;/div&gt;` +

                `&lt;div class="查看回复" style="display: block; margin: 10px auto 0 auto; align-items: center;
                text-align: center;color: black;user-select: none;cursor: pointer;"&gt;` +
                  `&lt;a href="reply.html?tid=${topic.tID}" target="_self" style="color: black;text-decoration:
                  none;font-size: 13px;"&gt;查看回复&gt;&gt;&lt;/a&gt;` +
                `&lt;/div&gt;` +
             `&lt;/div&gt;&lt;/li&gt;`


        container.innerHTML += html
    }
}

var xhr = new XMLHttpRequest()
xhr.open('get', '/topic-list.json' + location.search)

xhr.onload = function() {
    // 打印 json内容
    alert(this.responseText);
    console.log(this.responseText)
    var data = JSON.parse(this.responseText)
    if(!data.currentUser){
        // 重定向
        // location = '/login.html'
        location.assign('/login.html')
        return
    }

    renderAuthor(data.currentUser)
    renderCount(data.pointCount, data.classCount)
    renderTopicList(data.topicList)

}
xhr.send()</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\6b3e3083675e40a080c9ce3abcf6acae.png" width="1200"/></p>
<h2 id="3.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%9B%9E%E5%A4%8D%E9%A1%B5">3. 实现论坛回复页</h2>
<h3 id="3.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">3.1约定前后端交互接口</h3>
<pre><code>{
  "currentUser" : {
    "uID" : 17,
    "username" : "张三",
    "password" : "123",
    "userSex" : "男",
    "userAge" : 18,
    "userOccupation" : "大数据开发工程师",
    "userHobby" : "敲代码",
    "userPoint" : 1,
    "userClass" : 1,
    "userRegister" : "2022-07-08 15:01",
    "uid" : 17
  },
  "pointCount" : 1,
  "classCount" : 1,
  "replyList" : [ {
    "rID" : 39,
    "tID" : 16,
    "uID" : 17,
    "username" : "张三",
    "rTopic" : "回帖",
    "rContent" : "hello word",
    "rTime" : "2022-07-08 15:04",
    "rClickCount" : 0
  }, {
    "rID" : 32,
    "tID" : 16,
    "uID" : 11,
    "username" : "管理员",
    "rTopic" : "回帖",
    "rContent" : "有些人为了上前排连尊严都不要了，您怎么看呢？父亲？",
    "rTime" : "2022-07-08 13:54",
    "rClickCount" : 0
  }],
  "tid" : 16,
  "topic" : {
    "tID" : 16,
    "sID" : 12,
    "uID" : 11,
    "username" : "管理员",
    "tTopic" : "窃取天上三分景",
    "tContent" : "小狐狸想去人间很久了，临行之前，她的姥姥赠她了一件宝物芙蓉面。 小狐狸得了这芙蓉面，欢喜极了，她摸了摸芙蓉面道：“姥姥，我得了芙蓉面也能行走人世吗？” “是啊，只要你戴上芙蓉面，这世上任何人的脸，都可以幻化，可你是妖，就算有了芙蓉面，也得学世人的姿态。” 小狐狸拿着芙蓉面思索半天，",
    "tTime" : "2022-07-08 13:50",
    "tReplyCount" : 4,
    "tClickCount" : 6,
    "uid" : 11,
    "treplyCount" : 4,
    "tclickCount" : 6,
    "ttime" : "2022-07-08 13:50",
    "tid" : 16,
    "tcontent" : "小狐狸想去人间很久了，临行之前，她的姥姥赠她了一件宝物芙蓉面。 小狐狸得了这芙蓉面，欢喜极了，她摸了摸芙蓉面道：“姥姥，我得了芙蓉面也能行走人世吗？” “是啊，只要你戴上芙蓉面，这世上任何人的脸，都可以幻化，可你是妖，就算有了芙蓉面，也得学世人的姿态。” 小狐狸拿着芙蓉面思索半天，",
    "ttopic" : "窃取天上三分景",
    "sid" : 12
  }
}</code></pre>
<h3 id="3.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">3.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import com.fasterxml.jackson.databind.ObjectMapper;
import forum.dao.TopicDao;
import forum.model.ReplyListResult;
import forum.model.User;
import forum.service.ReplyService;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/07/01 17:05
 **/

@WebServlet("/reply-list.json")
public class ReplyListServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.setCharacterEncoding("utf-8");
        String tidString = req.getParameter("tid");
        int tid = Integer.parseInt(tidString);

        User currentUser = null;
        HttpSession session = req.getSession(false);
        if(session != null){
            currentUser = (User)session.getAttribute("currentUser");
        }

        // 浏览一次回帖页面，浏览次数加1
        new TopicDao().update(tid);

        ReplyService replyService = new ReplyService();
        ReplyListResult result = replyService.replyListResult(currentUser,tid);
        result.tid = tid;


        ObjectMapper objectMapper = new ObjectMapper();
        String jsonString = objectMapper.writerWithDefaultPrettyPrinter().writeValueAsString(result);

        resp.setCharacterEncoding("utf-8");
        resp.setContentType("application/json");
        resp.getWriter().println(jsonString);
    }
}</code></pre>
<h3 id="3.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">3.3 编写客户端代码</h3>
<pre><code class="language-javascript">function renderAuthor(currentUser) {
    document.querySelector('.author-username').textContent = currentUser.username
    document.querySelector('.author-userSex').textContent = currentUser.userSex
    document.querySelector('.author-userAge').textContent = currentUser.userAge
    document.querySelector('.author-userOccupation').textContent = currentUser.userOccupation
    document.querySelector('.author-userHobby').textContent = "爱好：" + currentUser.userHobby
}

function renderCount(pointCount, classCount) {
    document.querySelector('.author-userPoint').textContent = pointCount
    document.querySelector('.author-userClass').textContent = classCount
}

function renderDefineTid(tid){
    document.querySelector('.tid').value = tid;
}

function renderReplyList(topic,replyList){
    console.log(replyList)
    var container = document.querySelector('.reply')
    console.log(container)

    // 主贴
    var html = `&lt;li&gt;` +
         `&lt;div class="板块信息1"&gt;` +

             `&lt;h3 class="板块名称"&gt;${topic.tTopic}&lt;/h3&gt;` +
            ` &lt;p class="主贴时间"&gt;${topic.tTime}&lt;/p&gt;` +

            ` &lt;div class="版主"&gt;贴主: &lt;span class="版主名称"&gt;${topic.username}&lt;/span&gt;&lt;/div&gt;` +

            ` &lt;p class="板块说明"&gt;${topic.tContent}&lt;/p&gt;` +

                ` &lt;div class="点击"&gt;` +
                   `  &lt;div class="数量"&gt;` +
                         `&lt;div&gt;浏览量&lt;/div&gt;` +
                        ` &lt;div&gt;${topic.tClickCount}&lt;/div&gt;` +
                     `&lt;/div&gt;` +
                ` &lt;/div&gt;` +

         `&lt;/div&gt;&lt;/li&gt;`


    container.innerHTML += html


    //回帖
    for(var i in replyList){
        var reply = replyList[i]
        console.log(reply)

        var html = `&lt;li&gt;` +
                     `&lt;div class="板块信息"&gt;` +
                         `&lt;h3 class="板块名称"&gt;${reply.rTopic}&lt;/h3&gt;` +
                        ` &lt;p class="主贴时间"&gt;${reply.rTime}&lt;/p&gt;` +

                        ` &lt;div class="版主"&gt;&lt;span class="版主名称"&gt;${reply.username}&lt;/span&gt;&lt;/div&gt;` +
                        ` &lt;p class="板块说明"&gt;${reply.rContent}&lt;/p&gt;` +


                        /*` &lt;div class="点击"&gt;` +
                           `  &lt;div class="数量"&gt;` +
                                 `&lt;div&gt;点击次数&lt;/div&gt;` +
                                ` &lt;div&gt;100&lt;/div&gt;` +
                             `&lt;/div&gt;` +
                        ` &lt;/div&gt;` +*/
                     `&lt;/div&gt;&lt;/li&gt;`

                container.innerHTML += html
    }
}

var xhr = new XMLHttpRequest()
xhr.open('get','/reply-list.json' + location.search)

xhr.onload = function() {
    //alert(this.responseText);
    console.log(this.responseText)
    var data = JSON.parse(this.responseText)
    if(!data.currentUser){
        location.assign('/login.html')
        return
    }

    renderAuthor(data.currentUser)
    renderCount(data.pointCount, data.classCount)
    renderReplyList(data.topic,data.replyList)
    renderDefineTid(data.tid)
}
xhr.send()
</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\4db69086a9d540f8bb98b933d5942e4a.png" width="1200"/></p>
<h2 id="4.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83%E9%A1%B5">4. 实现论坛个人中心页</h2>
<h3 id="4.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">4.1约定前后端交互接口</h3>
<blockquote>
<p>个人中心的json数据来自于/section-list.json</p>
</blockquote>
<pre><code>{
  "currentUser" : {
    "uID" : 17,
    "username" : "张三",
    "password" : "123",
    "userSex" : "男",
    "userAge" : 18,
    "userOccupation" : "大数据开发工程师",
    "userHobby" : "敲代码",
    "userPoint" : 1,
    "userClass" : 1,
    "userRegister" : "2022-07-08 15:01",
    "uid" : 17
  }
}</code></pre>
<h3 id="4.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">4.2 实现服务器代码</h3>
<blockquote>
<p>个人中心的服务器代码来自于/section-list.json，和列表页服务器代码相同，再次不在赘述。</p>
</blockquote>
<h3 id="4.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">4.3 编写客户端代码</h3>
<pre><code class="language-javascript">function renderAuthor(currentUser) {
    document.querySelector('.author-username').value = currentUser.username
    document.querySelector('.author-userSex').value = currentUser.userSex
    document.querySelector('.author-userAge').value = currentUser.userAge
    document.querySelector('.author-userOccupation').value = currentUser.userOccupation
    document.querySelector('.author-userHobby').value = currentUser.userHobby
    document.querySelector('.author-userPoint').value = currentUser.userPoint
    document.querySelector('.author-userClass').value = currentUser.userClass
    document.querySelector('.author-userRegister').value = currentUser.userRegister
}

var xhr = new XMLHttpRequest()
xhr.open('get', '/section-list.json')
xhr.onload = function() {
    //alert(this.responseText);
    var data = JSON.parse(this.responseText)
    if(!data.currentUser){
        // 重定向
        // location = '/login.html'
        location.assign('/login.html')
        return
    }

    renderAuthor(data.currentUser)
}
xhr.send()</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\c80cc16534a9480c818716fdc71d963b.png" width="1200"/></p>
<h2 id="5.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E5%8F%91%E5%B8%83%E5%B8%96%E5%AD%90%E9%A1%B5">5. 实现论坛发布帖子页</h2>
<h3 id="5.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">5.1约定前后端交互接口</h3>
<pre><code>[请求] post /editor.do</code></pre>
<h3 id="5.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">5.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import forum.dao.TopicDao;
import forum.model.User;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/07/01 19:30
 **/

@WebServlet("/editor.do")
public class EditorDoServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.setCharacterEncoding("utf-8");
        String title = req.getParameter("title");
        String sidString = req.getParameter("type");
        int sid = Integer.parseInt(sidString);
        String content = req.getParameter("editor-markdown-doc");

        User currentUser = null;
        HttpSession session = req.getSession(false);
        if (session != null) {
            currentUser = (User) session.getAttribute("currentUser");
        }

        if (currentUser == null) {
            // 说明没有登录
            resp.sendRedirect("/login.html");
            return;
        }

        TopicDao topicDao = new TopicDao();
        topicDao.insert(sid,currentUser.uID,title,content);

        // 重定向到文章详情页
        resp.sendRedirect("/detail.html?sid=" + sid);
    }
}</code></pre>
<h3 id="%C2%A05.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81"> 5.3 编写客户端代码</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;写帖子&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/navigation bar.css"&gt;
    &lt;link rel="stylesheet" href="css/editor.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="导航栏"&gt;
        &lt;div class="left-logo"&gt;
            &lt;div class="logo"&gt;&lt;img src="img/系统图标.png" width="45"&gt;&lt;/div&gt;
            &lt;p&gt;论坛管理信息系统&lt;/p&gt;
        &lt;/div&gt;

        &lt;div class="占位"&gt;&lt;/div&gt;

        &lt;div class="right-function"&gt;
            &lt;a href="center.html"&gt;个人中心&lt;/a&gt;
            &lt;a href="list.html"&gt;主页&lt;/a&gt;
            &lt;a href="editor.html"&gt;写帖子&lt;/a&gt;
            &lt;a href="logout" target="_self"&gt;注销&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="blog-edit-container"&gt;
        &lt;form method="post" action="/editor.do"&gt;
            &lt;div class="title"&gt;
                &lt;input type="text" placeholder="在这里写下主贴标题" id="title" name="title"&gt;
                &lt;input type="text" placeholder="板块编号" id="type" name="type" style="    height: 40px;
    width: 80px;

    text-indent: 10px;
    border-radius: 10px;
    outline: none;
    border: none;
    background-color:rgba(255, 255, 255, 0.8);"&gt;

                &lt;button id="submit"&gt;发布帖子&lt;/button&gt;
            &lt;/div&gt;


        &lt;div id="editor" class="编辑器"&gt;&lt;/div&gt;
        &lt;link rel="stylesheet" href="editor.md/css/editormd.min.css" /&gt;
        &lt;script src="js/jquery.min.js"&gt;&lt;/script&gt;
        &lt;script src="editor.md/lib/marked.min.js"&gt;&lt;/script&gt;
        &lt;script src="editor.md/lib/prettify.min.js"&gt;&lt;/script&gt;
        &lt;script src="editor.md/editormd.js"&gt;&lt;/script&gt;


        &lt;/form&gt;
    &lt;/div&gt;

    &lt;script&gt;
        var content = '# 在这里写下一篇帖子 ##';
        var config = {
            // 这里的尺寸必须在这里设置. 设置样式会被 editormd 自动覆盖掉.
            width: "100%",
            // 高度 100% 意思是和父元素一样高. 要在父元素的基础上去掉标题编辑区的高度
            height: "100vh",
            // 编辑器中的初始内容
            markdown: content,
            // 指定 editor.md 依赖的插件路径
            path: "editor.md/lib/"
        };
        editormd("editor", config);

    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<h2 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="1034" src="image\1aebb51767b64e908ce74b6e6678b594.png" width="1200"/></h2>
<h2 id="6.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E7%99%BB%E5%BD%95%E9%A1%B5">6. 实现论坛登录页</h2>
<h3 id="6.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">6.1约定前后端交互接口</h3>
<pre><code>[请求] post /login.do</code></pre>
<h3 id="6.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">6.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import forum.dao.UserDao;
import forum.model.User;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/06/29 17:18
 **/

@WebServlet("/login.do")
public class LoginDoServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.setCharacterEncoding("utf-8");
        String username = req.getParameter("username");
        String password = req.getParameter("password");
        System.out.println("DEBUG: username = " + username);
        System.out.println("DEBUG: password = " + password);

        UserDao userDao = new UserDao();
        User user = userDao.selectOneByUsernameAndPassword(username,password);
        if(user == null){
            resp.sendRedirect("/login.html");
            return;
        }

        System.out.println(user);

        HttpSession session = req.getSession();
        session.setAttribute("currentUser",user);

        resp.sendRedirect("/");
    }
}</code></pre>
<h3 id="6.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">6.3 编写客户端代码</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;登录&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/navigation bar.css"&gt;
    &lt;link rel="stylesheet" href="css/login.css"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;div class="导航栏"&gt;
        &lt;div class="left-logo"&gt;
            &lt;div class="logo"&gt;&lt;img src="img/系统图标.png" width="45"&gt;&lt;/div&gt;
            &lt;p&gt;论坛管理信息系统&lt;/p&gt;
        &lt;/div&gt;

        &lt;div class="占位"&gt;&lt;/div&gt;

        &lt;div class="right-function"&gt;
            &lt;span class="center"&gt;&lt;/span&gt;
            &lt;a href="list.html"&gt;主页&lt;/a&gt;
            &lt;a href="editor.html" target="_blank"&gt;写帖子&lt;/a&gt;
            &lt;a href="logon.html"&gt;注册&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="主体区"&gt;
        &lt;div class="登录框"&gt;
            &lt;form action="/login.do" method="post"&gt;
                &lt;h2&gt;登录&lt;/h2&gt;
                &lt;div&gt;
                    &lt;span&gt;用户名&lt;/span&gt;
                    &lt;input type="text" class="text" name="username" placeholder="请输入用户名"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;密码&lt;/span&gt;
                    &lt;input type="password" class="text" name="password" placeholder="请输入密码"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;button class="提交"&gt;登录&lt;/button&gt;
                &lt;/div&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
<blockquote>
<p> 实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\a2c8752b4d0b402cb61e3dcdc8b6dfd3.png" width="1200"/></p>
<h2 id="7.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E5%86%8C%E9%A1%B5">7. 实现论坛注册页</h2>
<h3 id="7.1%E7%BA%A6%E5%AE%9A%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92%E6%8E%A5%E5%8F%A3">7.1约定前后端交互接口</h3>
<pre><code>[请求] post /logon.do</code></pre>
<h3 id="7.2%20%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">7.2 实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import forum.dao.UserDao;
import forum.model.User;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/07/03 08:34
 **/
@WebServlet("/logon.do")
public class LogonDoServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.setCharacterEncoding("utf-8");
        String username = req.getParameter("username");
        String sex = req.getParameter("sex");
        String age = req.getParameter("age");
        String occupation = req.getParameter("occupation");
        String hobby = req.getParameter("hobby");
        String password1 = req.getParameter("password1");
        String password2 = req.getParameter("password2");

        UserDao userDao = new UserDao();
        User user = userDao.insert(username,password1,sex,Integer.parseInt(password1),occupation,hobby);

        HttpSession session = req.getSession();
        session.setAttribute("currentUser",user);

        resp.sendRedirect("/");

    }
}</code></pre>
<h3 id="7.3%20%E7%BC%96%E5%86%99%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81">7.3 编写客户端代码</h3>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;注册&lt;/title&gt;
    &lt;link rel="stylesheet" href="css/navigation bar.css"&gt;
    &lt;link rel="stylesheet" href="css/logon.css"&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;div class="导航栏"&gt;
        &lt;div class="left-logo"&gt;
            &lt;div class="logo"&gt;&lt;img src="img/系统图标.png" width="45"&gt;&lt;/div&gt;
            &lt;p&gt;论坛管理信息系统&lt;/p&gt;
        &lt;/div&gt;

        &lt;div class="占位"&gt;&lt;/div&gt;

        &lt;div class="right-function"&gt;
            &lt;span class="center"&gt;&lt;/span&gt;
            &lt;a href="list.html"&gt;主页&lt;/a&gt;
            &lt;a href="editor.html" target="_blank"&gt;写帖子&lt;/a&gt;
            &lt;a href="login.html"&gt;登录&lt;/a&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="主体区"&gt;
        &lt;div class="注册框"&gt;
            &lt;form action="/logon.do" method="post"&gt;
                &lt;h2&gt;注册&lt;/h2&gt;
                &lt;div&gt;
                    &lt;span&gt;昵称&lt;/span&gt;
                    &lt;input type="text" class="text" placeholder="请输入昵称" name="username"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;年龄&lt;/span&gt;
                    &lt;input type="text" class="text" placeholder="请输入年龄" name="age"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;性别&lt;/span&gt;
                    &lt;input type="text" class="text" placeholder="请输入性别  男|女" name="sex"&gt;

                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;爱好&lt;/span&gt;
                    &lt;input type="text" class="text" placeholder="请输入爱好" name="hobby"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;职业&lt;/span&gt;
                    &lt;input type="text" class="text" placeholder="请输入职业" name="occupation"&gt;
                &lt;/div&gt;
&lt;!--                &lt;div&gt;--&gt;
&lt;!--                    &lt;span&gt;Email&lt;/span&gt;--&gt;
&lt;!--                    &lt;input type="text" class="text" placeholder="请输入Email" name="email"&gt;--&gt;
&lt;!--                &lt;/div&gt;--&gt;
                &lt;div&gt;
                    &lt;span&gt;密码&lt;/span&gt;
                    &lt;input type="password" class="text" placeholder="请输入密码" name="password1"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;span&gt;再次确认密码&lt;/span&gt;
                    &lt;input type="password" class="text" placeholder="请再次确认密码" name="password2"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;button class="提交"&gt;注册&lt;/button&gt;
                &lt;/div&gt;
            &lt;/form&gt;
        &lt;/div&gt;
    &lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\97ab83440d524c26ac056e3cb97b7dd0.png" width="1200"/></p>
<h2 id="8.%20%E5%AE%9E%E7%8E%B0%E8%AE%BA%E5%9D%9B%E6%B3%A8%E9%94%80">8. 实现论坛注销</h2>
<h3 id="8.1%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%A0%81">8.1实现服务器代码</h3>
<pre><code class="language-java">package forum.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

@WebServlet("/logout")
public class LogoutServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session != null) {
            session.removeAttribute("currentUser");
        }

        resp.sendRedirect("/");
    }
}
</code></pre>
<pre><code class="language-java">package forum.servlet;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * @author haomin
 * @date 2022/06/30 08:43
 **/

@WebServlet("")
public class IndexServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.sendRedirect("/list.html");
    }
}</code></pre>
<blockquote>
<p>重定向到论坛主页，但是服务器发现没有用户登录，继而重定向到用户登录页。</p>
</blockquote>
<blockquote>
<p>实现效果：</p>
</blockquote>
<p><img alt="" height="1034" src="image\731bc58aaa6245228732054bd258413c.png" width="1200"/></p>
<blockquote>
<p> 论坛信息管理系统主要重点就介绍到这里了，如果想看看项目源码，可以点击这里：<a class="link-info" href="https://gitee.com/hao-min-chen/forum_management_information_system" title="《论坛信息管理系统》">《论坛信息管理系统》</a></p>
</blockquote>
<blockquote>
<p>如果你喜欢这篇文章，请点赞加关注吧，或者如果你对与文章有什么困惑，可以私信我。</p>
<p>🏓🏓🏓 </p>
</blockquote>
</div>
</div>