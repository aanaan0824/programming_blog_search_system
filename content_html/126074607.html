<div class="article_content clearfix" id="article_content">
<link href="style.css" rel="stylesheet"/>
<div class="markdown_views prism-github-gist" id="content_views">
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<path d="M5,0 0,2.5 5,5z" id="raphael-marker-block" stroke-linecap="round" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
</svg>
<h1><a id="_1"></a>前言</h1>
<pre><code>一个需求

需要利用Python+第三方库wxauto 用于微信上自动获取聊天信息，从而根据自己需求对信息自动进行二次处理，
比如自动回复，再比如自动发送文件或者其他。
这边使用Python的第三方库`wxauto`来进行开发，而不是`itchat`
																--- 记录于2022年07月
</code></pre>
<p>使用Python3的第三方库<code>wxauto</code>, 它适用于Windows的微信客户端</p>
<blockquote>
<p>官网: https://github.com/cluic/wxauto</p>
</blockquote>
<h1><a id="_20"></a>原因</h1>
<blockquote>
<p>这边使用<code>wxauto</code>来进行开发，而不是<code>itchat</code>，原因如下</p>
</blockquote>
<p><code>itchat</code>都是之前的教程，<br/> 本质上是用的微信的网页端的接口来进行数据交互的。</p>
<p>如果你想要使用<code>itchat</code>的代码的话，</p>
<ul><li>1、先测试下你的账号是否还可以登录微信网页端</li></ul>
<blockquote>
<p>https://wx.qq.com/<br/> 腾讯官方虽然没有正式的发表声明，但是你搜一下可以看到相关信息<br/> 大概从去年开始（时间不太确定），大部分微信账号都不可以继续登录微信网页端，只有少部分账号还可以登录。<br/> 原因未知。</p>
</blockquote>
<ul><li>2、如果可以登录微信网页版 那么你可以关闭这个博客去网上找下<code>itchat</code>的代码来学习运行下，</li></ul>
<p>如果登录失败，那么或许你可以尝试下<code>wxauto</code>也就是这里所说的方法来运行下。</p>
<hr/>
<h1><a id="_49"></a>环境</h1>
<pre><code>Windows 10
Python 3.8.10
Windows 10的微信客户端版本：3.7.5.23 (英文版本)
</code></pre>
<blockquote>
<p>注：微信客户端中文版跟英文版都可以<br/> 没什么太大区别。</p>
</blockquote>
<h1><a id="_61"></a>安装</h1>
<blockquote>
<p>安装Python3的第三方库<code>wxauto</code>，具体步骤如下</p>
</blockquote>
<blockquote>
<p>官网: https://github.com/cluic/wxauto</p>
</blockquote>
<blockquote>
<p>在cmd窗口执行下面命令进行安装</p>
</blockquote>
<ul><li>安装第三方库<code>wxauto</code></li></ul>
<pre><code>python3 --version
python3 -m pip install wxauto -i https://pypi.tuna.tsinghua.edu.cn/simple 
</code></pre>
<ul><li>查看<code>wxauto</code>是否安装成功</li></ul>
<pre><code>python3 -c "import wxauto; print(wxauto.VERSION)"
</code></pre>
<h1><a id="_84"></a>使用步骤</h1>
<h2><a id="1_mainpy_86"></a>1. 新建main.py</h2>
<blockquote>
<p>这边第一篇只介绍获取默认窗口的聊天信息</p>
</blockquote>
<pre><code>from wxauto import *

# 获取当前微信客户端
wx = WeChat()

# 获取会话列表
wx.GetSessionList()


###############################
# 1、获取默认窗口聊天信息
###############################
def get_default_window_messages():
    # 默认是微信窗口当前选中的窗口
    # 输出当前聊天窗口聊天消息
    msgs = wx.GetAllMessage
    for msg in msgs:
        print('%s : %s' % (msg[0], msg[1]))

    # 获取更多聊天记录
    wx.LoadMoreMessage()
    msgs = wx.GetAllMessage
    for msg in msgs:
        print('%s : %s' % (msg[0], msg[1]))


if __name__ == '__main__':
    get_default_window_messages()

</code></pre>
<h2><a id="2__124"></a>2. 打开微信</h2>
<ul><li>windows10下打开微信客户端</li><li>正常扫码登录</li><li>打开微信窗口到前面，不要最小化或者缩小到底部菜单</li></ul>
<h2><a id="3__132"></a>3. 执行代码</h2>
<blockquote>
<p>打开cmd窗口，在cmd窗口执行:</p>
<p>如果没有安装第三方库，参考上面的<code>安装</code>步骤进行安装再执行下面命令</p>
</blockquote>
<pre><code>cd 你的main.py所在路径
python3 main.py
</code></pre>
<h2><a id="4__145"></a>4. 输出</h2>
<pre><code>cmd窗口正常输出你默认微信窗口的聊天信息
</code></pre>
<hr/>
<h1><a id="_155"></a>后续</h1>
<blockquote>
<p>这边刚开始写一下系列文章，想发展下自己的博客和微信公众号账号</p>
<p>如果对你有帮助，方便的话可以关注下 博客左侧的微信公众号（点击我的头像进入个人中心，位于左侧下方）</p>
<p>如有问题的话，也可通过公众号直接留言，这边有微信提醒，可以几小时内及时回复</p>
<p>也可直接在CSDN博客留言或者私信留言，这个没有微信提醒，所以这边可能一天或者几天内给回复</p>
</blockquote>
<blockquote>
<p>微信公众号所在位置：打开<code>个人中心</code>也就是这个链接<br/> https://blog.csdn.net/xiaozi_001?type=blog<br/> 左侧下方</p>
</blockquote>
<blockquote>
<p>如有需求，</p>
<p>想要对微信进行一些自动化操作来提高效率：</p>
<p>比如</p>
<ul><li> <p>自动群发不同聊天信息到几个微信群里</p> </li><li> <p>自动群发不同的图片到几个微信群里</p> </li><li> <p>自动群发不同的文件到几个微信群里</p> </li></ul>
</blockquote>
<hr/>
<ul><li>如果你本身懂代码的话</li></ul>
<blockquote>
<p>如果你本身懂代码的话, 直接看第三方库<code>wxauto</code>的使用，自己来写就可以了，</p>
<p>博客后续也会基于这个系列继续更新。</p>
<p>欢迎点赞留言提出问题，方便的话 点赞收藏 关注下微信公众号</p>
</blockquote>
<ul><li>如果你本身不懂代码</li></ul>
<blockquote>
<p>只是想要一个简单的微信处理工具来满足自己的需求的话</p>
<p>可以微信公众号留言或者私信留言，</p>
<p>发下你的具体需求，这边后续根据你的需求进行下二次开发</p>
<hr/>
<p>费用大概100RMB~500RMB不等，根据你的需求复杂度和开发耗时来确定</p>
<p>简单的功能，比如上面提到的，一般100RMB就可以了</p>
<p>复杂的需求，将根据你的需求复杂度和开发耗时来确定</p>
<hr/>
<p>一般这边满足需求，开发完毕并且给用户确认之后再付款</p>
</blockquote>
<blockquote>
<p>微信公众号所在位置：打开<code>个人中心</code>也就是这个链接<br/> https://blog.csdn.net/xiaozi_001?type=blog<br/> 左侧下方</p>
</blockquote>
<blockquote>
<p>如有需求，可关注下微信公众号留言或者直接私信留言</p>
<p>前者可以几小时内及时回复</p>
<p>后者可能看的不及时，大概一天或者几天内有回复</p>
</blockquote>
<hr/>
<blockquote>
<p>注：刚开始想业余时间做点订单，顺便想下自己接下来的职业规划</p>
<p>可兼职部分开发需求的订单，微信自动化，QQ自动化，静态官网开发等都可以</p>
<p>后续会发系列教程 如有需求欢迎沟通</p>
</blockquote>
<h1><a id="_242"></a>其他</h1>
<blockquote>
<p>如有问题 欢迎提出</p>
</blockquote>
<blockquote>
<p>如有疑问 欢迎留言</p>
</blockquote>
<blockquote>
<p>如有作用 欢迎点赞</p>
</blockquote>
<blockquote>
<p>如有失效 欢迎留言</p>
</blockquote>
<blockquote>
<p>2022年07月 可用</p>
</blockquote>
</div>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css" rel="stylesheet"/>
<link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css" rel="stylesheet"/>
</div>