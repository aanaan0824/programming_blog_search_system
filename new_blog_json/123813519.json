{"blogid": "123813519", "writerAge": "码龄1年", "writerBlogNum": "127", "writerCollect": "22", "writerComment": "11", "writerFan": "9", "writerGrade": "4级", "writerIntegral": "1321", "writerName": "succ3", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123813519.jpg", "writerRankTotal": "41949", "writerRankWeekly": "286529", "writerThumb": "18", "writerVisitNum": "73533", "blog_read_count": "1678", "blog_time": "于 2022-03-29 14:59:49 发布", "blog_title": "Upload-Labs-Linux", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>目录</h3>\n<ul><li><a href=\"#00x100x2_1\">00x1~00x2</a></li><li><a href=\"#00x3_6\">00x3</a></li><li><a href=\"#00x4_14\">00x4</a></li><li><a href=\"#00x5_20\">00x5</a></li><li><a href=\"#00x6_26\">00x6</a></li><li><a href=\"#00x7_30\">00x7</a></li><li><a href=\"#00x8_37\">00x8</a></li><li><a href=\"#00x9_47\">00x9</a></li><li><a href=\"#00x10_57\">00x10</a></li><li><a href=\"#00x1100x12_60\">00x11~00x12</a></li><li><a href=\"#00x13_66\">00x13</a></li><li><a href=\"#00x14_73\">00x14</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"00x100x2_1\"></a>00x1~00x2</h1>\n<p>上传一个图片文件，抓包改后缀为php<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\04290b5a0d4543649436ec4484231bf1.png\"/><br/> 到所在目录执行shell<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0a760915bde743eab2501bed1d561973.png\"/></p>\n<h1><a id=\"00x3_6\"></a>00x3</h1>\n<p>过滤了一些后缀，但像php3，phtml，php5…都没有禁。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1a4ff8bb614746e4932e3471c69274ed.png\"/><br/> 后缀改为php3<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\05534cf4610e48458a442235526f9a55.png\"/><br/> 进入目录拿flag<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\defb36b0dca342b1af8ac373b892183a.png\"/></p>\n<h1><a id=\"00x4_14\"></a>00x4</h1>\n<p>虽禁用了上面的扩展后缀，但我们还可以传一个2.php.a这样的文件，因为apache解析顺序是从右到左，解析.a时，解析不了，则会向前解析，解析.php</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f9d828a406134f9e8e2e2e80846071e3.png\"/><br/> 拿flag<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\aea97234d04b473985a827070fa9733f.png\"/></p>\n<h1><a id=\"00x5_20\"></a>00x5</h1>\n<p>这题与第四题感觉是互补，第四题大小写没用，这题大小写有用。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c4f1a4bb56b942d1b246e67dc60e9030.png\"/><br/> 原因：<br/> 第四题有这一句，转换为小写，而第五题没有。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\47012af7ab4c4d25a723a0ec98ed4f0e.png\"/></p>\n<h1><a id=\"00x6_26\"></a>00x6</h1>\n<p>这题据其他大佬说是在末尾加空格，确实它没有做删空格这一步，但是我上传能成功，但无法访问，暂不清楚是什么原因。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\71f2a4d1dc4a40ffbecc375a12288f87.png\"/></p>\n<h1><a id=\"00x7_30\"></a>00x7</h1>\n<p>这题是没有删.<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\934acae6cdd64d569871d4a17a439484.png\"/><br/> 上传一个.php.<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e102253296194e0cacf3ccd773d86125.png\"/><br/> 然后访问<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e3d0909a5dce42ce9a7d6e824669364b.png\"/></p>\n<h1><a id=\"00x8_37\"></a>00x8</h1>\n<p>如果这边是php+windows的组合，就可用<code>.php::$data</code>这种模式</p>\n<pre><code>Windows 下，如果上传的文件名中包含::$DATA 会在服务器生成一个同名且内容也相同的 php 文件，但是 Windows 中文件名不能包含特殊字符。\n\n如：test.php::$DATA 会在服务器上生成 test.php 文件\n</code></pre>\n<p>但这边是php+linux,不清楚咋做了…(望告之)</p>\n<h1><a id=\"00x9_47\"></a>00x9</h1>\n<p>这题可以用apache解析漏洞<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\977ed0846c304ec48fc27ed69d7d258a.png\"/><br/> 原因：<br/> 这边把解析后的文件名直接引用<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\23b00073fb5e4744b7ee0a167193f771.png\"/><br/> 并没用它经过过滤的<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7b9909bf1c5148f7a86d96503228ddb1.png\"/></p>\n<h1><a id=\"00x10_57\"></a>00x10</h1>\n<p>虽然它把php替换为空但是我们可以双写绕过<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e4c822209ba64f8ea6048e0b9f4c0803.png\"/></p>\n<h1><a id=\"00x1100x12_60\"></a>00x11~00x12</h1>\n<p>本来这两题可以用00截断（PHP&lt;5.3.29），但奈何php版本太高，00截断没用了<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1e4ff2620a3949b58569cb3b0ece164c.png\"/><br/> 如果可以用则可以：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1a56794a6c34495cba9b69e00964852f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b73add4adf4e45289fb45c8dcb229347.png\"/></p>\n<h1><a id=\"00x13_66\"></a>00x13</h1>\n<p><code>getReailFileType</code>这个函数的功能是检查文件的幻术头字节。<br/> 只要在文件的前面加上GIF89a就行了<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5284d643b8af47d7abf67582cdd01f48.png\"/><br/> 且这边应该是无法拿到flag的，因为这边除了上传图片就没其他函数了。</p>\n<p>而且这关的通关条件问上传图片马成功</p>\n<h1><a id=\"00x14_73\"></a>00x14</h1>\n<p>同上<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b70a27f33e0c415bbad459b896d2f4e9.png\"/></p>\n<p>待续…</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 1, "time": "2022-03-29 14:59:49", "summary": "目录上传一个图片文件，抓包改后缀为在这里插入图片描述到所在目录执行在这里插入图片描述过滤了一些后缀，但像，，都没有禁。在这里插入图片描述后缀改为在这里插入图片描述进入目录拿在这里插入图片描述虽禁用了上"}