{"blogid": "126737776", "writerAge": "码龄2年", "writerBlogNum": "74", "writerCollect": "5311", "writerComment": "4784", "writerFan": "8124", "writerGrade": "7级", "writerIntegral": "9368", "writerName": "跳楼梯企鹅", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126737776.jpg", "writerRankTotal": "1420", "writerRankWeekly": "18", "writerThumb": "3585", "writerVisitNum": "391378", "blog_read_count": "90", "blog_time": "于 2022-09-07 08:48:23 发布", "blog_title": "【SQL刷题】DAY14----SQL使用子查询专项练习", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<p style=\"margin-left:0;text-align:left;\">​<strong>博主昵称：跳楼梯企鹅</strong><br/><strong>博主主页面链接：</strong><a href=\"https://blog.csdn.net/weixin_50481708?spm=1000.2115.3001.5343\" title=\"博主主页传送门\">博主主页传送门</a></p>\n<p style=\"margin-left:0;text-align:left;\"><strong>博主专栏页面连接：</strong><a href=\"https://blog.csdn.net/weixin_50481708/category_11865870.html?spm=1001.2014.3001.5482\" title=\"专栏传送门--网路安全技术\">专栏传送门--网路安全技术</a><br/><strong>创作初心：本博客的初心为与技术朋友们相互交流，每个人的技术都存在短板，博主也是一样，虚心求教，希望各位技术友给予指导。</strong><br/><strong>博主座右铭：发现光，追随光，成为光，散发光;</strong><br/><strong>博主研究方向：渗透测试、机器学习 ;</strong><br/><strong>博主寄语：感谢各位技术友的支持，您的支持就是我前进的动力 ;</strong></p>\n<p style=\"margin-left:0;text-align:left;\"><strong>学习网站跳转链接：</strong><a href=\"https://www.nowcoder.com/link/pc_csdncpt_tltqe_sql\" title=\"牛客刷题网\">牛客刷题网</a></p>\n</blockquote>\n<h1 style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\a06dad502edf490f8b3c6df89c7aa077.jpeg\"/> </h1>\n<h1 style=\"text-align:left;\"><strong><strong><strong>前言</strong></strong></strong></h1>\n<p style=\"margin-left:0;text-align:center;\"><strong><span style=\"color:#fe2c24;\">给大家推荐一款很好的刷题软件</span></strong><u><span style=\"color:#0000ff;\"><u>牛客刷题网---一起学SQL</u></span></u></p>\n<p style=\"margin-left:0;text-align:left;\"><img alt=\"\" height=\"878\" src=\"..\\..\\static\\image\\3baf77ca8d92417ea3b2b32cb9f27eb6.png\" width=\"1200\"/></p>\n<p style=\"margin-left:0;text-align:left;\"> 博主为什么喜欢用这个网站学习呢？</p>\n<p style=\"margin-left:0;text-align:left;\"><strong>主要原因有三点：</strong></p>\n<p style=\"margin-left:0;text-align:left;\"><strong><span style=\"color:#ff9900;\">1.内部含有大量面试题库</span></strong></p>\n<p style=\"margin-left:0;text-align:left;\"><strong><span style=\"color:#ff9900;\">2.覆盖行业范围比较全面</span></strong></p>\n<p style=\"margin-left:0;text-align:left;\"><strong><span style=\"color:#ff9900;\">3.刷题的题目是按照简单到难的过程</span></strong></p>\n<h1 style=\"text-align:left;\"><strong><strong><strong>一、SQL使用子查询</strong></strong></strong></h1>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）子查询</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\"><span style=\"color:#956fe7;\">子查询是嵌套在另一个语句，如：</span><strong><span style=\"color:#956fe7;\">select，insert，update、delete</span></strong><span style=\"color:#956fe7;\">中的查询</span></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）嵌套子查询</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\"><span style=\"color:#ed7976;\">子查询可以嵌套在另外一个子查询中，SQL Server最多支持32个嵌套级别</span></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）相关子程序</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\"><span style=\"color:#ff9900;\">①相关子查询是</span><strong><span style=\"color:#ff9900;\">使用外部查询的值的子查询</span></strong><span style=\"color:#ff9900;\">。即，</span><strong><span style=\"color:#ff9900;\">它取决于外部查询的值</span></strong></p>\n<p style=\"margin-left:0;text-align:left;\"><span style=\"color:#ff9900;\">②相关子查询不能作为简单子查询独立执行</span></p>\n<p style=\"margin-left:0;text-align:left;\"><span style=\"color:#ff9900;\">③对外部查询评估的每一行重复执行一次相关子查询。相关子查询也称为</span><strong><span style=\"color:#ff9900;\">重复子查询</span></strong><span style=\"color:#ff9900;\">。</span></p>\n<h1 style=\"text-align:left;\"><strong><strong><strong>二、刷题</strong></strong></strong></h1>\n<h2 style=\"text-align:left;\"><strong><strong><strong>1.刷题一</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）题目</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">题目：返回购买价格为 10 美元或以上产品的顾客列表</p>\n<p style=\"margin-left:0;text-align:left;\">描述：OrderItems表示订单商品表，含有字段订单号：order_num、订单价格：item_price；Orders表代表订单信息表，含有顾客id：cust_id和订单号：order_num</p>\n<p style=\"margin-left:0;text-align:left;\"><img alt=\"\" height=\"789\" src=\"..\\..\\static\\image\\f2387fb713d543aea9c7610c27115481.png\" width=\"1103\"/></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）示例</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">输入：\n\nDROP TABLE IF EXISTS `OrderItems`;\n\n  CREATE TABLE IF NOT EXISTS `OrderItems`(\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\n    item_price INT(16) NOT NULL COMMENT '售出价格'\n\n  );\n\n  INSERT `OrderItems` VALUES ('a1',10),('a2',1),('a2',1),('a4',2),('a5',5),('a2',1),('a7',7);\n\n\n  DROP TABLE IF EXISTS `Orders`;\n\n  CREATE TABLE IF NOT EXISTS `Orders`(\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\n    cust_id VARCHAR(255) NOT NULL COMMENT '顾客id'\n\n  );\n\n  INSERT `Orders` VALUES ('a1','cust10'),('a2','cust1'),('a2','cust1'),('a4','cust2'),('a5','cust5'),('a2','cust1'),('a7','cust7');\n\n\n输出：\n\n\ncust10</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）代码</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">select cust_idfrom Orderswhere order_num in (\n\n    select order_num\n\n    from OrderItems\n\n    where item_price &gt;=10\n\n)</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（4）运行结果</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">​<img alt=\"\" height=\"752\" src=\"..\\..\\static\\image\\2a7335b8c2b548c999ab0b652d07cff9.png\" width=\"1182\"/></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>2.刷题二</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）题目</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">题目：确定哪些订单购买了 prod_id 为 BR01 的产品（一）</p>\n<p style=\"margin-left:0;text-align:left;\">描述：表OrderItems代表订单商品信息表，prod_id为产品id；Orders表代表订单表有cust_id代表顾客id和订单日期order_date</p>\n<p><img alt=\"\" height=\"725\" src=\"..\\..\\static\\image\\54d5b97d21d64bc1b0d68f50dbb51157.png\" width=\"1174\"/></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）示例</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">输入：\n\nDROP TABLE IF EXISTS `OrderItems`;\n\n  CREATE TABLE IF NOT EXISTS `OrderItems`(\n\n    prod_id VARCHAR(255) NOT NULL COMMENT '产品id',\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号'\n\n  );\n\n  INSERT `OrderItems` VALUES ('BR01','a0001'),('BR01','a0002'),('BR02','a0003'),('BR02','a0013');\n\n\n  DROP TABLE IF EXISTS `Orders`;\n\n  CREATE TABLE IF NOT EXISTS `Orders`(\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\n    cust_id VARCHAR(255) NOT NULL COMMENT '顾客id',\n\n    order_date TIMESTAMP NOT NULL COMMENT '下单时间'\n\n  );\n\n  INSERT `Orders` VALUES ('a0001','cust10','2022-01-01 00:00:00'),('a0002','cust1','2022-01-01 00:01:00'),('a0003','cust1','2022-01-02 00:00:00'),('a0013','cust2','2022-01-01 00:20:00');\n\n\n输出：\n\n\ncust10|2022-01-01 00:00:00\n\ncust1|2022-01-01 00:01:00</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）代码</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">select cust_id,order_datefrom Orderswhere order_num in\n\n(select order_numfrom OrderItemswhere prod_id = 'BR01')</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（4）运行结果</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">​<img alt=\"\" height=\"878\" src=\"..\\..\\static\\image\\d4e21da77db0478bab9d4b6c97240d6d.png\" width=\"1187\"/></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>3.刷题三</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）题目</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">题目：返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（一）</p>\n<p style=\"margin-left:0;text-align:left;\">描述：你想知道订购 BR01 产品的日期，有表OrderItems代表订单商品信息表，prod_id为产品id；Orders表代表订单表有cust_id代表顾客id和订单日期order_date；Customers表含有cust_email 顾客邮件和cust_id顾客id</p>\n<p style=\"margin-left:0;text-align:left;\"><img alt=\"\" height=\"739\" src=\"..\\..\\static\\image\\3a00274bf6d24e5b8bf7a3e976bd5b3e.png\" width=\"1174\"/></p>\n<p> </p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）示例</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">输入：\n\nDROP TABLE IF EXISTS `OrderItems`;\n\n  CREATE TABLE IF NOT EXISTS `OrderItems`(\n\n    prod_id VARCHAR(255) NOT NULL COMMENT '产品id',\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号'\n\n  );\n\n  INSERT `OrderItems` VALUES ('BR01','a0001'),('BR01','a0002'),('BR02','a0003'),('BR02','a0013');\n\n\n  DROP TABLE IF EXISTS `Orders`;\n\n  CREATE TABLE IF NOT EXISTS `Orders`(\n\n    order_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\n    cust_id VARCHAR(255) NOT NULL COMMENT '顾客id',\n\n    order_date TIMESTAMP NOT NULL COMMENT '下单时间'\n\n  );\n\n  INSERT `Orders` VALUES ('a0001','cust10','2022-01-01 00:00:00'),('a0002','cust1','2022-01-01 00:01:00'),('a0003','cust1','2022-01-02 00:00:00'),('a0013','cust2','2022-01-01 00:20:00');\n\nDROP TABLE IF EXISTS `Customers`;CREATE TABLE IF NOT EXISTS `Customers`(\n\n    cust_id VARCHAR(255) NOT NULL COMMENT '顾客id',\n\n    cust_email VARCHAR(255) NOT NULL COMMENT '顾客email'\n\n  );INSERT `Customers` VALUES ('cust10','cust10@cust.com'),('cust1','cust1@cust.com'),('cust2','cust2@cust.com');\n\n\n输出：\n\n\ncust10@cust.com\n\ncust1@cust.com</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）代码</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">select\n\n    Customers.cust_emailfrom\n\n    Ordersleft join OrderItems on OrderItems.order_num = Orders.order_numleft join Customers on Customers.cust_id = Orders.cust_idwhere\n\n    OrderItems.prod_id = \"BR01\"</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（4）运行结果</strong></strong></strong></h3>\n<p><img alt=\"\" height=\"919\" src=\"..\\..\\static\\image\\0e45b7eca27b4739adbdd8a9f0123f5c.png\" width=\"1177\"/></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>4.刷题四</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）题目</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">题目：返回每个顾客不同订单的总金额</p>\n<p style=\"margin-left:0;text-align:left;\">描述：我们需要一个顾客 ID 列表，其中包含他们已订购的总金额。OrderItems表代表订单信息，OrderItems表有订单号：order_num和商品售出价格：item_price、商品数量：quantity。</p>\n<p style=\"margin-left:0;text-align:left;\"><img alt=\"\" height=\"889\" src=\"..\\..\\static\\image\\fd4b24265db847389874b53b15a3fe7b.png\" width=\"1190\"/></p>\n<p> </p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）示例</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">输入：\n\nDROP TABLE IF EXISTS `OrderItems`;CREATE TABLE IF NOT EXISTS `OrderItems`(\n\norder_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\nitem_price INT(16) NOT NULL COMMENT '售出价格',\n\nquantity INT(16) NOT NULL COMMENT '商品数量'\n\n);INSERT `OrderItems` VALUES ('a0001',10,105),('a0002',1,1100),('a0002',1,200),('a0013',2,1121),('a0003',5,10),('a0003',1,19),('a0003',7,5);\n\nDROP TABLE IF EXISTS `Orders`;CREATE TABLE IF NOT EXISTS `Orders`(\n\n  order_num VARCHAR(255) NOT NULL COMMENT '商品订单号',\n\n  cust_id VARCHAR(255) NOT NULL COMMENT '顾客id'\n\n);INSERT `Orders` VALUES ('a0001','cust10'),('a0003','cust1'),('a0013','cust2');\n\n\n输出：\n\n\ncust2|2242.000\n\ncust10|1050.000\n\ncust1|104.000</code></pre>\n<p style=\"margin-left:.0001pt;text-align:left;\"></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）代码</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">SELECT \n\n    o.cust_id,\n\n    sum(oi.item_price * oi.quantity) AS total_orderedFROM Orders o JOIN OrderItems oi\n\n    USING (order_num)GROUP BY o.cust_idORDER BY total_ordered DESC</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（4）运行结果</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\"><img alt=\"\" height=\"985\" src=\"..\\..\\static\\image\\71eedba0655140a2af1aae3f9b47e06e.png\" width=\"1200\"/></p>\n<p> </p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>5.刷题五</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（1）题目</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">题目：从 Products 表中检索所有的产品名称以及对应的销售总数</p>\n<p style=\"margin-left:0;text-align:left;\">描述： Products 表中检索所有的产品名称：prod_name、产品id：prod_id</p>\n<p style=\"margin-left:0;text-align:left;\">OrderItems代表订单商品表，订单产品：prod_id、售出数量：quantity</p>\n<p style=\"margin-left:0;text-align:left;\">​<img alt=\"\" height=\"839\" src=\"..\\..\\static\\image\\8ab9da907e1b46b684d02f2abc80817f.png\" width=\"1190\"/></p>\n<p> </p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（2）示例</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:left;\">输入：</p>\n<pre><code class=\"language-sql\">DROP TABLE IF EXISTS `Products`;CREATE TABLE IF NOT EXISTS `Products` (\n\n`prod_id` VARCHAR(255) NOT NULL COMMENT '产品 ID',\n\n`prod_name` VARCHAR(255) NOT NULL COMMENT '产品名称'\n\n);INSERT INTO `Products` VALUES ('a0001','egg'),\n\n('a0002','sockets'),\n\n('a0013','coffee'),\n\n('a0003','cola');\n\nDROP TABLE IF EXISTS `OrderItems`;CREATE TABLE IF NOT EXISTS `OrderItems`(\n\nprod_id VARCHAR(255) NOT NULL COMMENT '产品id',\n\nquantity INT(16) NOT NULL COMMENT '商品数量'\n\n);INSERT `OrderItems` VALUES ('a0001',105),('a0002',1100),('a0002',200),('a0013',1121),('a0003',10),('a0003',19),('a0003',5);\n\n\n输出：\n\n\negg|105.000\n\nsockets|1300.000\n\ncoffee|1121.000\n\ncola|34.000</code></pre>\n<p style=\"margin-left:.0001pt;text-align:left;\"></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（3）代码</strong></strong></strong></h3>\n<pre><code class=\"language-sql\">select\n\n  prod_name,\n\n  sum(quantity) as quant_soldfrom\n\n  Products,\n\n  OrderItemswhere\n\n  OrderItems.prod_id = Products.prod_idgroup by\n\n  prod_name</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>（4）运行结果</strong></strong></strong></h3>\n<p style=\"margin-left:0;text-align:left;\">​<img alt=\"\" height=\"1057\" src=\"..\\..\\static\\image\\6a8bf06c4a3a41ff9a7a34f7e4553a6b.png\" width=\"1200\"/></p>\n<p></p>\n<p style=\"margin-left:0;text-align:center;\"><strong><span style=\"color:#ff9900;\">本篇文章为SQL刷题第十四天</span></strong></p>\n<p style=\"margin-left:0;text-align:center;\"><strong><span style=\"color:#fe2c24;\">欢迎各位小伙伴点击右边链接和博主一起学习</span></strong><a href=\"https://www.nowcoder.com/link/pc_csdncpt_tltqe_sql\" title=\"点击学习\">点击学习</a></p>\n<p style=\"margin-left:.0001pt;text-align:left;\">​</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-09-07 08:48:23", "summary": "博主昵称：跳楼梯企鹅博主主页面链接：博主主页传送门博主主页传送门博主专栏页面连接：专栏传送门网路安全技术专栏传送门网路安全技术创作初心：本博客的初心为与技术朋友们相互交流，每个人的技术都存在短板，博主"}