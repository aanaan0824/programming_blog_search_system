{"blogid": "122351006", "writerAge": "码龄4年", "writerBlogNum": "28", "writerCollect": "55", "writerComment": "31", "writerFan": "212", "writerGrade": "2级", "writerIntegral": "386", "writerName": "闲齁齁", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122351006.jpg", "writerRankTotal": "45181", "writerRankWeekly": "115368", "writerThumb": "43", "writerVisitNum": "21909", "blog_read_count": "5530", "blog_time": "已于 2022-06-17 10:59:34 修改", "blog_title": "C#连接Oracle数据库", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"1COracle_0\"></a>1.C#连接Oracle数据库</h2>\n<p>C#连接Oracle数据库目前常用的有三种方式：<br/> （1）System.Data.OracleClient.dll（微软）<br/> （2）Oracle.DataAccess.Client.dll（Oracle，也称ODP.NET）<br/> （3）Oracle.ManagedDataAccess.dll（Oracle）<br/> 第一个需要在客户端安装数据库，且已经过时了，但是还是可以继续使用的。第二个不需要在客户端安装数据库，可以直接访问服务器上的数据库，但是区分x86和x64，也是比较麻烦的，所以我比较推荐第三种。<br/> 第三种使用前需要先下载Oracle.ManagedDataAccess.dll文件，这个下载地址百度搜一下吧，我也忘了我是在哪下载的了。<br/> 主要的我认为就是个连接字符串，粘贴一下连接字符串：</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//数据源</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=xxx.xxx.xxx.xxx)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=***)));Persist Security Info=True;User ID=***;Password=***;\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">OracleConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OracleConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//实例化</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>我感觉还是比较简单的，在这因为创建项目的框架导致也走了不少弯路。xxx代表的是服务器地址，1521是Oracle数据库的默认端口号，另外三处的***就是数据库实例名称，用户名和密码。</p>\n<h2><a id=\"2COracle_16\"></a>2.C#连接Oracle数据库，执行操作语句</h2>\n<pre><code class=\"prism language-csharp\"> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from table\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">OracleCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OracleCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">OracleDataAdapter</span> da <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OracleDataAdapter</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">DataSet</span> ds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//定义数据集</span>\n            da<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>在这里我感觉我走的路比较麻烦了，因为我把查出来的表数据填充到了dataset里面，然后在下面我又使用循环把dataset里的数据取出来放进了datatable里面，在这大家如果有好的方法可以一同交流。</p>\n<h2><a id=\"3datagridviewdatatable_26\"></a>3.把datagridview的数据填充到datatable里</h2>\n<pre><code class=\"prism language-csharp\">            <span class=\"token comment\">//将datagridview数据转换成datatable</span>\n            <span class=\"token class-name\">DataTable</span> tabl <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            tabl <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token keyword\">as</span> <span class=\"token class-name\">DataTable</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>这个填充写法好像有很大的局限性，但是我使用中没出什么问题。</p>\n<h2><a id=\"4_35\"></a>4.字符串拆分</h2>\n<pre><code class=\"prism language-csharp\">                <span class=\"token comment\">//循环取出导入Excel的datatable的数据</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> CID <span class=\"token operator\">=</span> tabl<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"地址\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//把地址进行拆分，例如1-2-1-1，拆分成1,2,1,1</span>\n                <span class=\"token class-name\">String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> nameStrArray <span class=\"token operator\">=</span> CID<span class=\"token punctuation\">.</span><span class=\"token function\">Split</span><span class=\"token punctuation\">(</span><span class=\"token char\">'-'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"5_43\"></a>5.添加操作</h2>\n<pre><code class=\"prism language-csharp\">                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"添加语句\"</span>；\n                <span class=\"token class-name\">OracleCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OracleCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> kl <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>返回受影响的行数kl，我的想法可能不是很正规，因为我也是第一次接触Oracle数据库，大家有什么意见或者对此有不同的想法，欢迎指正。大家共同学习，共同进步。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-06-17 10:59:34", "summary": "连接数据库连接数据库目前常用的有三种方式：微软，也称第一个需要在客户端安装数据库，且已经过时了，但是还是可以继续使用的。第二个不需要在客户端安装数据库，可以直接访问服务器上的数据库，但是区分和，也是比"}