{"blogid": "125142168", "writerAge": "码龄4年", "writerBlogNum": "65", "writerCollect": "219", "writerComment": "108", "writerFan": "60", "writerGrade": "4级", "writerIntegral": "835", "writerName": "晓之以理的喵~~", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125142168.jpg", "writerRankTotal": "23749", "writerRankWeekly": "15110", "writerThumb": "78", "writerVisitNum": "74011", "blog_read_count": "4931", "blog_time": "于 2022-06-06 10:34:20 发布", "blog_title": "SQL实现将多行记录合并成一行", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><strong>SQL实现将多行记录合并成一行</strong></p>\n<blockquote>\n<p>我们在数据开发的过程中，经常会遇到这样的需求，就是将多行合并为一行，并且用特定字符隔开。</p>\n</blockquote>\n<h1><a id=\"1_3\"></a>1、数据处理前</h1>\n<p><img alt=\"数据处理前\" src=\"..\\..\\static\\image\\9a8524cbfe2a4229b6a08ee6a16368b4.png\"/></p>\n<h1><a id=\"2_5\"></a>2，结果数据展示</h1>\n<p><img alt=\"数据处理后\" src=\"..\\..\\static\\image\\f4bad91a632b4fc6ac83f73e30ef7a61.png\"/></p>\n<h1><a id=\"3hive_7\"></a>3，hive处理方式</h1>\n<p>在hive里面，用concat_ws函数处理<br/> 格式： concat_ws(‘分隔符’,collect_set/collect_list(字段))<br/> 参数释义：<br/> concat_ws：多行合并一行函数<br/> collect_set：合成数组,数据已去重<br/> collect_list：合成数组, 数据未去重</p>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SQL</span>脚本：\n<span class=\"token keyword\">select</span> school<span class=\"token punctuation\">,</span>concat_ws<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>collect_set<span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> student\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> school<span class=\"token punctuation\">;</span>\n</code></pre>\n<h1><a id=\"4MySQL_19\"></a>4，MySQL处理方式</h1>\n<p>GROUP_CONCAT(字段 分隔符)<br/> 注意：MySQL在GROUP_CONCAT函数中，去重需要使用distinct 关键字，如果需要先排序再合并，也可以使用order by 关键字。</p>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">select</span> school<span class=\"token punctuation\">,</span>GROUP_CONCAT<span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> student\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> school<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>我是喵，有问题随时沟通哟~~~</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-06-06 10:34:20", "summary": "实现将多行记录合并成一行我们在数据开发的过程中，经常会遇到这样的需求，就是将多行合并为一行，并且用特定字符隔开。、数据处理前数据处理前，结果数据展示数据处理后，处理方式在里面，用函数处理格式：分隔符字"}