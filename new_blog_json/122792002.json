{"blogid": "122792002", "writerAge": "码龄3年", "writerBlogNum": "2", "writerCollect": "19", "writerComment": "1", "writerFan": "0", "writerGrade": "1级", "writerIntegral": "23", "writerName": "这个代码长到不想看了", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122792002.jpg", "writerRankTotal": "247671", "writerRankWeekly": "1337417", "writerThumb": "0", "writerVisitNum": "4380", "blog_read_count": "2363", "blog_time": "已于 2022-02-05 18:40:21 修改", "blog_title": "VS2019中使用C++初步实现winform界面", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<ul><li>新建项目<br/> 打开VS，新建一个C++的空项目，这里注意最好是一个空项目，而不是控制台项目或者其他类型，虽然项目使用方便但是后续会报错，同时文章最后会给出一些常用错误的解决方法。</li><li>加入winform的引用<br/> 首先进行设置，在项目属性-&gt;高级-&gt;\"Common Language Runtime Support\"里选中“Common Language Runtime Support(/clr)”。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2ea3f4020aa94504b5992d66f0dc6f5e.png\"/> 这一步之后，才可以在项目的引用中，添加引用，分别引用System和System.Window.Forms，如图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1a53df81e69e4adebc755f262b54a1e0.png\"/></li><li>创建一个新的类<br/> 创建一个新的类，点击VS主界面菜单栏的项目–&gt;添加类。类的名称自定义，这里命名为UseWinforms，基类中填Form。<br/> 随后在自动生成的头文件代码中，添加System和Form的引用。</li></ul>\n<pre><code class=\"prism language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">once</span></span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> System<span class=\"token operator\">::</span>Windows<span class=\"token operator\">::</span>Forms<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">public</span> ref <span class=\"token keyword\">class</span> <span class=\"token class-name\">UseWinforms</span> <span class=\"token operator\">:</span> <span class=\"token base-clause\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">Form</span></span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">UseWinforms</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<ul><li>主程序<br/> 创建一个主程序来调用这个类。</li></ul>\n<pre><code class=\"prism language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;windows.h&gt;</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"UseWinforms.h\"</span></span>\n\n<span class=\"token keyword\">int</span> APIENTRY <span class=\"token function\">WinMain</span><span class=\"token punctuation\">(</span>HINSTANCE hInstance<span class=\"token punctuation\">,</span> HINSTANCE hPrevInstance<span class=\"token punctuation\">,</span> LPSTR lpCmdLine<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> nCmdShow<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token class-name\">Application</span><span class=\"token operator\">::</span><span class=\"token function\">Run</span><span class=\"token punctuation\">(</span>gcnew <span class=\"token function\">UseWinforms</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>保存，运行，就可以看到熟悉的winform窗口了。</p>\n<ul><li>一些 debug过程<br/> 报错一：vs2019 C++/CLI 或 C++/CX 不支持两阶段名称查找；请使用 /Zc:twoPhase-<br/> 解决方法：项目-&gt;属性-&gt;配置属性-&gt;c/c++ -&gt;语言<br/> 把“符合模式”改为“否”<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9e3d93e032ef4cfb8b2d1211c4b789bb.png\"/><br/> 参考：https://blog.csdn.net/qq_33435149/article/details/110289698<br/> 报错二：LNK2019 无法解析的外部符号 _main，函数 “int __cdecl invoke_main(void)“<br/> 这一问题的根本原因是在新建项目时选择了控制台项目。<br/> 解决方法：<br/> 项目属性-&gt;预处理器：控制台改为WINDOWS<br/> 链接器-&gt;系统-&gt;子系统改为窗口WINDOWS<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0b4133e65db446af9a3a1d0b4786bbec.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9e25e11558764c649fcb021897ca5d4a.png\"/><br/> 参考： https://blog.csdn.net/qq_36917144/article/details/112557109</li><li>更进一步的<br/> 给这个空白的窗口增加一个按钮，在生成的类的cpp文件中增加修改一部分代码，代码如下</li></ul>\n<pre><code class=\"prism language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span><span class=\"token string\">&lt;windows.h&gt;</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"UseWinforms.h\"</span></span>\n\n<span class=\"token class-name\">UseWinforms</span><span class=\"token operator\">::</span><span class=\"token function\">UseWinforms</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n\tSystem<span class=\"token operator\">::</span>Windows<span class=\"token operator\">::</span>Forms<span class=\"token operator\">::</span>Button<span class=\"token operator\">^</span> button1 <span class=\"token operator\">=</span> gcnew Button<span class=\"token punctuation\">;</span><span class=\"token comment\">//创建按钮</span>\n\t<span class=\"token keyword\">this</span><span class=\"token operator\">-&gt;</span>Controls<span class=\"token operator\">-&gt;</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>button1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//把按钮附加到我们的窗体上</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>这时运行就会得到一个有着按钮的窗口。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f917ce2653234796b0a4c1f42512394b.png\"/><br/> 目前实现到这一部分，如果只是为了一个界面，在C++中这么大费周章的使用winform当然不值得，所以后续还会继续更新，更加合适的使用winform。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C++", "cpp": 1, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-02-05 18:40:21", "summary": "新建项目打开，新建一个的空项目，这里注意最好是一个空项目，而不是控制台项目或者其他类型，虽然项目使用方便但是后续会报错，同时文章最后会给出一些常用错误的解决方法。加入的引用首先进行设置，在项目属性高级"}