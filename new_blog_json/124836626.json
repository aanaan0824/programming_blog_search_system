{"blogid": "124836626", "writerAge": "码龄5年", "writerBlogNum": "198", "writerCollect": "882", "writerComment": "42", "writerFan": "440", "writerGrade": "5级", "writerIntegral": "2190", "writerName": "明如正午", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124836626.jpg", "writerRankTotal": "8850", "writerRankWeekly": "3509", "writerThumb": "155", "writerVisitNum": "161542", "blog_read_count": "1571", "blog_time": "已于 2022-05-18 13:23:02 修改", "blog_title": "C#【必备技能篇】Winform实现多语言切换（.resx文件的应用）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>Winform实现多语言切换（.resx文件的应用）</h3>\n<ul><li><a href=\"#_1\">前言</a></li><li><a href=\"#1_3\">1.窗体控件添加</a></li><li><a href=\"#2resx_7\">2.添加资源文件.resx</a></li><li><a href=\"#3resx_17\">3.复制多个资源文件.resx(根据语言数量来定)</a></li><li><a href=\"#4MutliLanguage_31\">4.创建通用类MutliLanguage</a></li><li><a href=\"#5_149\">5.编写主窗体代码</a></li><li><a href=\"#6Form1_262\">6.获取上次存储的语言进行界面初始化【Form1窗体关键代码】</a></li><li><a href=\"#7ListboxLanguageCurrentSelectedLanguageForm1_287\">7.Listbox的内容显示不同的语言（建立Language的枚举，成员变量CurrentSelectedLanguage）【Form1窗体关键代码】</a></li><li><a href=\"#8_336\">8.运行效果：</a></li><li><a href=\"#_342\">总结：</a></li><li><a href=\"#_346\">源码链接：</a></li><li><a href=\"#_349\">另一种方法思路</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_1\"></a>前言</h1>\n<p>在实际的项目开发中，软件需要实现多语言切换。本文通过一个实际的例子，可以让你学习到这个技能。</p>\n<h1><a id=\"1_3\"></a>1.窗体控件添加</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7699a9c004dd414da34eaafe73b1e7ee.png\"/></p>\n<h1><a id=\"2resx_7\"></a>2.添加资源文件.resx</h1>\n<ul><li>当Form1的Localizable属性为False时，没有Form1.resx资源文件<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\27a64c8dad244619909eb11532fa2e23.png\"/></li><li>当Form1的Localizable属性为True时，生成Form1.resx资源文件<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8b706b8920094d1390cd733d94e662e7.png\"/></li><li>Form1.resx中的内容<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d2503ea460dc4610832647182a839512.png\"/></li></ul>\n<h1><a id=\"3resx_17\"></a>3.复制多个资源文件.resx(根据语言数量来定)</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7c08ae6a150b41d3b003131ef48a50a4.png\"/></p>\n<ul><li>当前有的.resx<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4dfdd3bc9e394e5cb32d4180cc26d65c.png\"/></li><li>复制Form1.resx并粘贴，重命名为Form1.en-US.resx和Form1.zh-CN.resx<br/> 注：Form1不能更改，必须和窗体名称保持一致<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ebb25b0ddeba4926b7d764b8fc01528c.png\"/></li><li>添加上一步复制的.resx到项目中<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\11143ae1235b4a548182fee72ccd817f.png\"/></li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\31f38a47cc2344a78156beb6599c4ed6.png\"/></p>\n<ul><li>更改Form1.en-US中的内容为英文<br/> <strong>注：控制不同语言文字的长度，使文字在控件内可以完全显示</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\699a39bedda140eab67b56435362612b.png\"/></li></ul>\n<h1><a id=\"4MutliLanguage_31\"></a>4.创建通用类MutliLanguage</h1>\n<ul><li>需要首先【在Properties.Settings中添加DefaultLanguage】，见下图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\bbfabf963be842efa3a125ade7d9a870.png\"/></li><li>通用类MutliLanguage的源码</li></ul>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>ComponentModel</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">MultiLanguageDemo</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">MultiLanguage</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> DefaultLanguage <span class=\"token operator\">=</span> <span class=\"token string\">\"zh-CN\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">/// &lt;summary&gt;</span>\n        <span class=\"token comment\">/// 修改默认语言</span>\n        <span class=\"token comment\">/// &lt;/summary&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"lang\"&gt;待设置默认语言&lt;/param&gt;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">SetDefaultLanguage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> lang<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            Thread<span class=\"token punctuation\">.</span>CurrentThread<span class=\"token punctuation\">.</span>CurrentUICulture <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Globalization<span class=\"token punctuation\">.</span>CultureInfo</span><span class=\"token punctuation\">(</span>lang<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            DefaultLanguage <span class=\"token operator\">=</span> lang<span class=\"token punctuation\">;</span>\n            Properties<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">.</span>DefaultLanguage <span class=\"token operator\">=</span> lang<span class=\"token punctuation\">;</span><span class=\"token comment\">//【在Properties.Settings中添加DefaultLanguage】</span>\n            Properties<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">.</span><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/// &lt;summary&gt;</span>\n        <span class=\"token comment\">/// 加载语言</span>\n        <span class=\"token comment\">/// &lt;/summary&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"form\"&gt;加载语言的窗口&lt;/param&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"formType\"&gt;窗口的类型&lt;/param&gt;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">LoadLanguage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Form</span> form<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Type</span> formType<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>form <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\">ComponentResourceManager</span> resources <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ComponentResourceManager</span><span class=\"token punctuation\">(</span>formType<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$this\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">,</span> resources<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/// &lt;summary&gt;</span>\n        <span class=\"token comment\">/// 加载语言</span>\n        <span class=\"token comment\">/// &lt;/summary&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"control\"&gt;控件&lt;/param&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"resources\"&gt;语言资源&lt;/param&gt;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Control</span> control<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ComponentResourceManager</span> resources<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>control <span class=\"token keyword\">is</span> <span class=\"token class-name\">MenuStrip</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//将资源与控件对应</span>\n                resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>control<span class=\"token punctuation\">,</span> control<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">MenuStrip</span> ms <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>MenuStrip<span class=\"token punctuation\">)</span>control<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ms<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ToolStripMenuItem</span> c <span class=\"token keyword\">in</span> ms<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token comment\">//遍历菜单</span>\n                        <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> resources<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>control <span class=\"token keyword\">is</span> <span class=\"token class-name\">StatusStrip</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//将资源与控件对应</span>\n                resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>control<span class=\"token punctuation\">,</span> control<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">StatusStrip</span> ts <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>StatusStrip<span class=\"token punctuation\">)</span>control<span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ToolStripItem</span> c <span class=\"token keyword\">in</span> ts<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token comment\">//遍历菜单</span>\n                    resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n           <span class=\"token comment\">//需要大家去完善</span>\n\n\n            <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Control</span> c <span class=\"token keyword\">in</span> control<span class=\"token punctuation\">.</span>Controls<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> resources<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">/// &lt;summary&gt;</span>\n        <span class=\"token comment\">/// 遍历菜单</span>\n        <span class=\"token comment\">/// &lt;/summary&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"item\"&gt;菜单项&lt;/param&gt;</span>\n        <span class=\"token comment\">/// &lt;param name=\"resources\"&gt;语言资源&lt;/param&gt;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ToolStripMenuItem</span> item<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ComponentResourceManager</span> resources<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item <span class=\"token keyword\">is</span> <span class=\"token class-name\">ToolStripMenuItem</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                resources<span class=\"token punctuation\">.</span><span class=\"token function\">ApplyResources</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">,</span> item<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">ToolStripMenuItem</span> tsmi <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>ToolStripMenuItem<span class=\"token punctuation\">)</span>item<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tsmi<span class=\"token punctuation\">.</span>DropDownItems<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ToolStripMenuItem</span> c <span class=\"token keyword\">in</span> tsmi<span class=\"token punctuation\">.</span>DropDownItems<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token function\">Loading</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> resources<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"5_149\"></a>5.编写主窗体代码</h1>\n<ul><li>Form1的源码</li></ul>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>ComponentModel</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Drawing</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">MultiLanguageDemo</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">Form</span></span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">Language</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            ChineseSimplified<span class=\"token punctuation\">,</span><span class=\"token comment\">//简体中文</span>\n            English <span class=\"token comment\">//英语</span>\n                    <span class=\"token comment\">//....如果有别的语言，另外添加</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">//当前选择的语言</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Language</span> CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//获取上次存储的语言，进行界面的更新</span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> language <span class=\"token operator\">=</span> Properties<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">.</span>DefaultLanguage<span class=\"token punctuation\">;</span>\n\n            MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">SetDefaultLanguage</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">LoadLanguage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token type-expression class-name\">Form1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"zh-cn\"</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">;</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"en-us\"</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">;</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Connect_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"建立连接\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"Connect Success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Disconnect_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"断开连接\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"Disconnect Success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">lbl_LanguageSelect_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">//第一步：判断当前是什么语言</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>lbl_Language<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"中文-简体\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">SetDefaultLanguage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"en-US\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">SetDefaultLanguage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"zh-CN\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Form</span> form <span class=\"token keyword\">in</span> Application<span class=\"token punctuation\">.</span>OpenForms<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token function\">LoadAll</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">LoadAll</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Form</span> form<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>Name <span class=\"token operator\">==</span> <span class=\"token string\">\"Form1\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">LoadLanguage</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">,</span> <span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token type-expression class-name\">Form1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">//如果还有别的窗体，这里要完善一下</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"6Form1_262\"></a>6.获取上次存储的语言进行界面初始化【Form1窗体关键代码】</h1>\n<pre><code class=\"prism language-csharp\">  <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//获取上次存储的语言，进行界面的更新</span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> language <span class=\"token operator\">=</span> Properties<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">.</span>Default<span class=\"token punctuation\">.</span>DefaultLanguage<span class=\"token punctuation\">;</span>\n\n            MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">SetDefaultLanguage</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            MultiLanguage<span class=\"token punctuation\">.</span><span class=\"token function\">LoadLanguage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token type-expression class-name\">Form1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"zh-cn\"</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">;</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token string\">\"en-us\"</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">;</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"7ListboxLanguageCurrentSelectedLanguageForm1_287\"></a>7.Listbox的内容显示不同的语言（建立Language的枚举，成员变量CurrentSelectedLanguage）【Form1窗体关键代码】</h1>\n<ul><li>创建枚举+增加成员变量</li></ul>\n<pre><code class=\"prism language-csharp\">  <span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">Language</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            ChineseSimplified<span class=\"token punctuation\">,</span><span class=\"token comment\">//简体中文</span>\n            English <span class=\"token comment\">//英语</span>\n                    <span class=\"token comment\">//....如果有别的语言，另外添加</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">//当前选择的语言</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">Language</span> CurrentSelectedLanguage <span class=\"token operator\">=</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">;</span>\n</code></pre>\n<ul><li>完成上述后，可以更方便地编写按钮事件代码，不同语言下添加不同的语言内容【因为Listbox的内容无法在.resx资源文件中添加】</li></ul>\n<pre><code class=\"prism language-csharp\">  <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Connect_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"建立连接\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"Connect Success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Disconnect_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>CurrentSelectedLanguage<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>ChineseSimplified<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"断开连接\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> Language<span class=\"token punctuation\">.</span>English<span class=\"token punctuation\">:</span>\n                    listBox1<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>DateTime<span class=\"token punctuation\">.</span>Now<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HH:mm:ss\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"Disconnect Success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"8_336\"></a>8.运行效果：</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a23bdbd33f104a25824769e7218c642b.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c615f5a8407b4aefb8b002745a5f7b4d.png\"/></p>\n<ul><li>刚打开软件时，语言为上次关闭时的语言<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a6f6d72f4b5b4927b78069e9375a51e9.png\"/></li></ul>\n<h1><a id=\"_342\"></a>总结：</h1>\n<ul><li>多语言实现的关键是:利用资源文件.resx来实现！</li><li>4、6、7点很关键！</li></ul>\n<h1><a id=\"_346\"></a>源码链接：</h1>\n<p><a href=\"https://download.csdn.net/download/sinat_40003796/85405096\">https://download.csdn.net/download/sinat_40003796/85405096</a></p>\n<h1><a id=\"_349\"></a>另一种方法思路</h1>\n<p>归结起来，要在C#的WinForm中实现国际化，至少需要做好以下几点：<br/> （1）准备所需资源文件（如本文中提到的英文和中文资源文件）；<br/> （2）引入命名空间（包括：System.Reflection、System.Resources、System.Threading和System.Globalization）；<br/> （3）实例化资源管理器（即ResourceManager）；<br/> （4）设置当前进程的语言区域；<br/> （5）通过资源管理器从指定的资源文件中获取所需值。</p>\n<p>具体可以参考源码进行理解：<br/> 源码链接：<a href=\"https://mp.csdn.net/mp_download/manage/download/UpDetailed\">https://mp.csdn.net/mp_download/manage/download/UpDetailed</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-05-18 13:23:02", "summary": "实现多语言切换文件的应用前言窗体控件添加添加资源文件复制多个资源文件根据语言数量来定创建通用类编写主窗体代码获取上次存储的语言进行界面初始化窗体关键代码的内容显示不同的语言建立的枚举，成员变量窗体关键"}