{"blogid": "126712540", "writerAge": "码龄14年", "writerBlogNum": "37", "writerCollect": "16", "writerComment": "6", "writerFan": "4", "writerGrade": "4级", "writerIntegral": "874", "writerName": "牛角上的男孩", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126712540.jpg", "writerRankTotal": "25274", "writerRankWeekly": "29308", "writerThumb": "8", "writerVisitNum": "43152", "blog_read_count": "214", "blog_time": "于 2022-09-05 20:35:59 发布", "blog_title": "循环登录提示“您为登录或者认证已过期，请重新登录”", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"1__0\"></a>1. 项目场景</h1>\n<p>host os：Kylin-Server-10-SP1<br/> docker： docker-ce-18.09.7<br/> cloud: openstack queens</p>\n<hr/>\n<h1><a id=\"2__8\"></a>2. 问题描述及原因分析</h1>\n<p>云平台web输入正确的用户名和密码后，出现提示“您为登录或者认证已过期，请重新登录”，一直循环往复，登录不了，如下如：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4c6d279cedef4f94a9b1b4e5ccec2866.png\"/><br/> 通过F12进入调试模式，然后重新输入再次登录，获取到Internal Server Error及You can’t write a against a read only slave，如下信息：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ed9915dde44349d7bbd63881e86e1314.png\"/><br/> 针对Internal Server Error进一步点击，查看reponse,也是报You can’t write a against a read only slave，从WEB架构了解到采用了redis作为token的缓存，怀疑redis缓存只读不可写有关，进入redis容器，通过redis-cli连接，例如：redis-cli -h x.x.x.x -a $redis_password，进入redis交互模式，执行FLUSHDB，出现了页面的报错，如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cedc203be5b248338d21aceaf51b035c.png\"/>验证了猜想，故是redis的问题，简单粗暴的方式就把redis停掉，然后删除数据，重新初始化生成，如下：</p>\n<pre><code>docker stop redis_sentinel redis\nrm -rf /var/lib/docker/volumes/redis/_data/*\ndocker start redis_sentinel redis\n</code></pre>\n<p>若是三控，则三个节点均要执行。</p>\n<p>还有可能是时间终端与服务器时间不一致等等情况。</p>\n<hr/>\n<h1><a id=\"3__28\"></a>3. 解决方案</h1>\n<p>redis的问题，简单粗暴的方式就把redis停掉，然后删除数据，重新初始化生成，如下：</p>\n<pre><code>docker stop redis_sentinel redis\nrm -rf /var/lib/docker/volumes/redis/_data/*\ndocker start redis_sentinel redis\n</code></pre>\n<p>若是三控，则三个节点均要执行。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-05 20:35:59", "summary": "项目场景：：问题描述及原因分析云平台输入正确的用户名和密码后，出现提示您为登录或者认证已过期，请重新登录，一直循环往复，登录不了，如下如：在这里插入图片描述通过进入调试模式，然后重新输入再次登录，获取"}