{"blogid": "126655735", "writerAge": "ç é¾„1å¹´", "writerBlogNum": "104", "writerCollect": "2010", "writerComment": "2015", "writerFan": "4815", "writerGrade": "6çº§", "writerIntegral": "6075", "writerName": "çˆ±åƒè±†çš„åœŸè±†", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126655735.jpg", "writerRankTotal": "2569", "writerRankWeekly": "69", "writerThumb": "1986", "writerVisitNum": "46205", "blog_read_count": "522", "blog_time": "äºÂ 2022-09-02 14:56:24Â å‘å¸ƒ", "blog_title": "EasyExcelçŸ¥è¯†ã€Javaç¨‹åºè¿›è¡Œè¯»å†™ç”ŸæˆExcelæ“ä½œã€‘", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<ul><li><strong>ğŸ’‚ ä¸ªäººä¸»é¡µ:</strong> <a href=\"https://blog.csdn.net/m0_64550837?type=blog\" title=\"çˆ±åƒè±†çš„åœŸè±†\">çˆ±åƒè±†çš„åœŸè±†</a></li><li> <p>ğŸŒˆæ¬¢è¿åŠ å…¥ç¤¾åŒºï¼Œç¦åˆ©å¤šå¤šå“¦ï¼<a href=\"https://bbs.csdn.net/forums/tudou?spm=1001.2014.3001.6682\" title=\"åœŸè±†ç¤¾åŒº\">åœŸè±†ç¤¾åŒº</a></p> </li><li><strong>ğŸ¤Ÿæ•°æ®åº“ä¸“æ æ›´æ–°å®Œæ¯•ï¼š</strong><a href=\"https://blog.csdn.net/m0_64550837/category_11975024.html?spm=1001.2014.3001.5482\" title=\"æ•°æ®åº“çŸ¥è¯†\">æ•°æ®åº“çŸ¥è¯†</a></li><li><strong>ğŸ¤ŸJDBCä¸“æ æ›´æ–°å®Œæ¯•ï¼š</strong><a href=\"https://blog.csdn.net/m0_64550837/category_11978727.html?spm=1001.2014.3001.5482\" title=\"JDBCçŸ¥è¯†\">JDBCçŸ¥è¯†</a></li><li><strong>ğŸ¤ŸMybatisä¸“æ æ›´æ–°å®Œæ¯•ï¼š</strong><a href=\"https://mp.csdn.net/mp_blog/manage/column/columnManage/11981278\" title=\"MybatisçŸ¥è¯†\">MybatisçŸ¥è¯†</a></li><li>ğŸ’¬ å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ã€<strong>æ¬¢è¿å…³æ³¨ã€ç‚¹èµã€æ”¶è—(ä¸€é”®ä¸‰è¿)å’Œè®¢é˜…ä¸“æ å“¦</strong></li></ul>\n</blockquote>\n<p id=\"main-toc\"><strong>ç›®å½•</strong></p>\n<p id=\"1%EF%BC%8CEasy%20Excel%E5%85%A5%E9%97%A8-toc\" style=\"margin-left:0px;\"><a href=\"#1%EF%BC%8CEasy%20Excel%E5%85%A5%E9%97%A8\">1ï¼ŒEasy Excelå…¥é—¨</a></p>\n<p id=\"1.1%EF%BC%9AEasy%20Excel%E6%A6%82%E8%BF%B0-toc\" style=\"margin-left:40px;\"><a href=\"#1.1%EF%BC%9AEasy%20Excel%E6%A6%82%E8%BF%B0\">1.1ï¼šEasy Excelæ¦‚è¿°</a></p>\n<p id=\"1.2%EF%BC%9AEasy%20Excel%E7%89%B9%E7%82%B9-toc\" style=\"margin-left:40px;\"><a href=\"#1.2%EF%BC%9AEasy%20Excel%E7%89%B9%E7%82%B9\">1.2ï¼šEasy Excelç‰¹ç‚¹</a></p>\n<p id=\"1.3%EF%BC%9A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-toc\" style=\"margin-left:40px;\"><a href=\"#1.3%EF%BC%9A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">1.3ï¼šç¯å¢ƒæ­å»º</a></p>\n<p id=\"1.3.1%EF%BC%9A%E6%B5%8B%E8%AF%95%E7%88%B6%E9%A1%B9%E7%9B%AE-toc\" style=\"margin-left:80px;\"><a href=\"#1.3.1%EF%BC%9A%E6%B5%8B%E8%AF%95%E7%88%B6%E9%A1%B9%E7%9B%AE\">1.3.1ï¼šæµ‹è¯•çˆ¶é¡¹ç›®</a></p>\n<p id=\"1.3.2%EF%BC%9A%E6%B5%8B%E8%AF%95excel%E9%A1%B9%E7%9B%AE-toc\" style=\"margin-left:80px;\"><a href=\"#1.3.2%EF%BC%9A%E6%B5%8B%E8%AF%95excel%E9%A1%B9%E7%9B%AE\">1.3.2ï¼šæµ‹è¯•excelé¡¹ç›®</a></p>\n<p id=\"1.4%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C-toc\" style=\"margin-left:40px;\"><a href=\"#1.4%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C\">1.4ï¼šåŸºæœ¬æ“ä½œ</a></p>\n<p id=\"1.4.1%EF%BC%9A%E6%B5%8B%E8%AF%95JavaBean-toc\" style=\"margin-left:80px;\"><a href=\"#1.4.1%EF%BC%9A%E6%B5%8B%E8%AF%95JavaBean\">1.4.1ï¼šæµ‹è¯•JavaBean</a></p>\n<p id=\"1.4.2%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84-toc\" style=\"margin-left:80px;\"><a href=\"#1.4.2%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84\">1.4.2ï¼šæµ‹è¯•æ–‡ä»¶è·¯å¾„</a></p>\n<p id=\"1.4.3%EF%BC%9A%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C-toc\" style=\"margin-left:80px;\"><a href=\"#1.4.3%EF%BC%9A%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C\">1.4.3ï¼šå†™å…¥æ“ä½œ</a></p>\n<p id=\"1.4.4%EF%BC%9A%E8%AF%BB%E5%87%BA%E6%93%8D%E4%BD%9C-toc\" style=\"margin-left:80px;\"><a href=\"#1.4.4%EF%BC%9A%E8%AF%BB%E5%87%BA%E6%93%8D%E4%BD%9C\">1.4.4ï¼šè¯»å‡ºæ“ä½œ</a></p>\n<p id=\"1.5%EF%BC%9A%E5%A4%8D%E6%9D%82%E6%93%8D%E4%BD%9C-toc\" style=\"margin-left:40px;\"><a href=\"#1.5%EF%BC%9A%E5%A4%8D%E6%9D%82%E6%93%8D%E4%BD%9C\">1.5ï¼šå¤æ‚æ“ä½œ</a></p>\n<p id=\"1.5.1%EF%BC%9A%E5%A4%8D%E5%90%88%E8%A1%A8%E5%A4%B4-toc\" style=\"margin-left:80px;\"><a href=\"#1.5.1%EF%BC%9A%E5%A4%8D%E5%90%88%E8%A1%A8%E5%A4%B4\">1.5.1ï¼šå¤åˆè¡¨å¤´</a></p>\n<p id=\"1.5.2%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8-toc\" style=\"margin-left:80px;\"><a href=\"#1.5.2%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8\">1.5.2ï¼šå†™æ“ä½œï¼šå¤šè¡¨</a></p>\n<p id=\"1.5.3%EF%BC%9A%E8%AF%BB%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8-toc\" style=\"margin-left:80px;\"><a href=\"#1.5.3%EF%BC%9A%E8%AF%BB%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8\">1.5.3ï¼šè¯»æ“ä½œï¼šå¤šè¡¨</a></p>\n<p id=\"1.5.4%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E5%AF%B9%E8%B1%A1-toc\" style=\"margin-left:80px;\"><a href=\"#1.5.4%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E5%AF%B9%E8%B1%A1\">1.5.4ï¼šå†™æ“ä½œï¼šå¤šå¯¹è±¡</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h1 id=\"1%EF%BC%8CEasy%20Excel%E5%85%A5%E9%97%A8\"><strong>1ï¼ŒEasy Excelå…¥é—¨</strong></h1>\n<h2 id=\"1.1%EF%BC%9AEasy%20Excel%E6%A6%82%E8%BF%B0\">1.1ï¼šEasy Excelæ¦‚è¿°</h2>\n<p> EasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ç®€å•ã€çœå†…å­˜çš„è¯»å†™Excelçš„å¼€æºé¡¹ç›®ã€‚åœ¨å°½å¯èƒ½èŠ‚çº¦å†…å­˜çš„æƒ…å†µä¸‹æ”¯æŒè¯»å†™ç™¾Mçš„Excelå·¥å…·ã€‚</p>\n<p>å®˜ç½‘:<a href=\"https://easyexcel.opensource.alibaba.com/\" title=\"EasyExcelå®˜æ–¹æ–‡æ¡£ - åŸºäºJavaçš„Excelå¤„ç†å·¥å…· | Easy Excel\">EasyExcelå®˜æ–¹æ–‡æ¡£ - åŸºäºJavaçš„Excelå¤„ç†å·¥å…· | Easy Excel</a></p>\n<p>githubåœ°å€ï¼š<a href=\"https://github.com/alibaba/easyexcel\" title=\"GitHub - alibaba/easyexcel: å¿«é€Ÿã€ç®€æ´ã€è§£å†³å¤§æ–‡ä»¶å†…å­˜æº¢å‡ºçš„javaå¤„ç†Excelå·¥å…·\">GitHub - alibaba/easyexcel: å¿«é€Ÿã€ç®€æ´ã€è§£å†³å¤§æ–‡ä»¶å†…å­˜æº¢å‡ºçš„javaå¤„ç†Excelå·¥å…·</a></p>\n<h2 id=\"1.2%EF%BC%9AEasy%20Excel%E7%89%B9%E7%82%B9\">1.2ï¼šEasy Excelç‰¹ç‚¹</h2>\n<p>Javaè§£æã€ç”ŸæˆExcelæ¯”è¾ƒæœ‰åçš„æ¡†æ¶æœ‰Apache poiã€jxlï¼Œä½†ä»–ä»¬éƒ½å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜å°±æ˜¯éå¸¸çš„è€—å†…å­˜ã€‚</p>\n<p>EasyExcel é‡å†™äº†poiï¼Œä½¿ä¸€ä¸ª3Mçš„excelåªéœ€è¦å‡ Må†…å­˜ï¼Œå¹¶ä¸”å†å¤§çš„excelä¸ä¼šå‡ºç°å†…å­˜æº¢å‡ºã€‚</p>\n<p>64Må†…å­˜1åˆ†é’Ÿå†…è¯»å–75M(46Wè¡Œ25åˆ—)çš„Excelã€‚</p>\n<h2 id=\"1.3%EF%BC%9A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA\">1.3ï¼šç¯å¢ƒæ­å»º</h2>\n<h3 id=\"1.3.1%EF%BC%9A%E6%B5%8B%E8%AF%95%E7%88%B6%E9%A1%B9%E7%9B%AE\">1.3.1ï¼šæµ‹è¯•çˆ¶é¡¹ç›®</h3>\n<p>é¡¹ç›®åï¼šzx-test-parent</p>\n<p><img alt=\"\" height=\"163\" src=\"..\\..\\static\\image\\ef4f2180f91643e580085137d20c5511.png\" width=\"223\"/></p>\n<ul><li> <p>ä¿®æ”¹pomæ–‡ä»¶</p> </li></ul>\n<blockquote>\n<p> </p>\n<pre>&lt;dependencies&gt;\n    &lt;!--æµ‹è¯•--&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</pre>\n</blockquote>\n<h3 id=\"1.3.2%EF%BC%9A%E6%B5%8B%E8%AF%95excel%E9%A1%B9%E7%9B%AE\">1.3.2ï¼šæµ‹è¯•excelé¡¹ç›®</h3>\n<p>é¡¹ç›®åï¼šzx-test-excel  </p>\n<p><img alt=\"\" height=\"128\" src=\"..\\..\\static\\image\\7b7bf01550d446af877500e04c00b82a.png\" width=\"340\"/></p>\n<p> </p>\n<p>ä¿®æ”¹pomï¼Œæ·»åŠ ä¾èµ–</p>\n<blockquote>\n<pre>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.alibaba&lt;/groupId&gt;\n        &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;\n        &lt;version&gt;3.1.1&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;</pre>\n<p> </p>\n</blockquote>\n<p><img alt=\"\" height=\"305\" src=\"..\\..\\static\\image\\76a7f5165b2e4d6e8e000fa465adba2f.png\" width=\"359\"/> </p>\n<h2 id=\"1.4%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C\">1.4ï¼šåŸºæœ¬æ“ä½œ</h2>\n<p><img alt=\"\" height=\"333\" src=\"..\\..\\static\\image\\2e66353e155f4c968c3e5bfe125355ee.png\" width=\"349\"/> </p>\n<h3 id=\"1.4.1%EF%BC%9A%E6%B5%8B%E8%AF%95JavaBean\">1.4.1ï¼šæµ‹è¯•JavaBean</h3>\n<p>å¸¸ç”¨çš„æ³¨è§£ï¼š</p>\n<p><img alt=\"\" height=\"468\" src=\"..\\..\\static\\image\\5137affa8d164cb691dbd969bc40c1b5.png\" width=\"876\"/></p>\n<p> </p>\n<pre><code class=\"language-java\">@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@ColumnWidth(30)\n@HeadRowHeight(30)\npublic class Student1 {\n    @ExcelProperty(\"ç¼–å·\")\n    private String id;\n    @ExcelProperty(\"å§“å\")\n    @ContentFontStyle(fontName = \"æ¥·ä½“\",italic = BooleanEnum.TRUE,color = Font.ITALIC)\n    private String name;\n    @ExcelProperty({\"åŸºæœ¬ä¿¡æ¯\",\"å¹´é¾„\"})\n    private Integer age;\n    @ExcelProperty({\"åŸºæœ¬ä¿¡æ¯\",\"ç”µè¯\"})\n    private String phone;\n    @ExcelProperty({\"å¯é€‰ä¿¡æ¯\",\"é‚®ä»¶\"})\n    private String Email;\n    @ExcelProperty({\"å¯é€‰ä¿¡æ¯\",\"ç”Ÿæ—¥\"})\n    @DateTimeFormat(\"yyyy-MM-dd HH:mm\")\n    private Date birthday;\n\n}</code></pre>\n<h3 id=\"1.4.2%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84\">1.4.2ï¼šæµ‹è¯•æ–‡ä»¶è·¯å¾„</h3>\n<pre><code class=\"language-java\">    public String path(){\n        return this.getClass().getResource(\"/\").getPath();\n    }</code></pre>\n<h3 id=\"1.4.3%EF%BC%9A%E5%86%99%E5%85%A5%E6%93%8D%E4%BD%9C\">1.4.3ï¼šå†™å…¥æ“ä½œ</h3>\n<ul><li> <p>excel å±äº officeç»„ä»¶ä¸€ä¸ªè½¯ä»¶</p> </li><li> <p>å­˜åœ¨è‹¥å¹²ç‰ˆæœ¬ï¼Œå¤§ä½“ä¸Šåˆ’åˆ†2ç§æƒ…å†µï¼Œ2007å‰çš„ï¼Œ2007å¹´åçš„</p>\n<ul><li> <p>2003ç‰ˆï¼šæ‰©å±•å xlsï¼Œå†…å®¹æ¯”è¾ƒå°‘ï¼Œæœ€å¤§å•å…ƒæ ¼ <code>IV65536</code> ï¼Œ256åˆ—(IV)</p> </li><li> <p>2007ç‰ˆï¼šæ‰©å±•å xlsxï¼Œå†…å®¹è¾ƒå¤šï¼Œæœ€å¤§å•å…ƒæ ¼ <code>XFD1048576</code>ï¼Œ16384åˆ—(XFD)</p> </li></ul></li></ul>\n<pre><code class=\"language-java\">   // æ¨¡æ‹Ÿæ•°æ®\n    public List&lt;Student1&gt; getDate(){\n        //æ¨¡æ‹Ÿåæ¡æ•°æ®\n        ArrayList&lt;Student1&gt; student1s = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 10; i++) {\n            Student1 student1 = new Student1(i+\"\",\"åœŸè±†\"+i,i,\"115\"+i,\"626\"+i,new Date());\n            student1s.add(student1);\n        }\n        return student1s;\n    }\n    //åˆ›å»ºæµ‹è¯•å†™ç¨‹åº\n    @Test\n    public void testWrite(){\n        //å†™å…¥ä½ç½®ï¼š%classpath%/\n        //æ–‡ä»¶åç§°ï¼šstudent-demo.xls\n        //è¡¨åï¼šåœŸè±†\n        //1,æ–‡ä»¶ä½ç½®\n        String file = path()+\"student_demo1.xls\";\n        //2 å†™æ“ä½œ\n        EasyExcel.write(file, Student1.class).sheet(\"åœŸè±†\").doWrite(getDate());\n    }</code></pre>\n<h3 id=\"1.4.4%EF%BC%9A%E8%AF%BB%E5%87%BA%E6%93%8D%E4%BD%9C\">1.4.4ï¼šè¯»å‡ºæ“ä½œ</h3>\n<p>å¤„ç†ç±»ï¼š</p>\n<ul><li> <p>å¤„ç†ç±»éœ€è¦å®ç° <code>AnalysisEventListener</code> æ¥å£</p> </li></ul>\n<pre><code class=\"language-java\">package com.czxy.read;\n\nimport com.alibaba.excel.context.AnalysisContext;\nimport com.alibaba.excel.event.AnalysisEventListener;\nimport com.czxy.excel.Student1;\n\npublic class StudentDataListener1 extends AnalysisEventListener&lt;Student1&gt; {\n\n    @Override\n    public void invoke(Student1 student1, AnalysisContext analysisContext) {\n        System.out.println(student1);\n    }\n\n    @Override\n    public void doAfterAllAnalysed(AnalysisContext analysisContext) {\n\n    }\n}\n</code></pre>\n<pre><code class=\"language-java\"> //æµ‹è¯•è¯»å‡ºexcelç¨‹åº\n    @Test\n    public void testRead(){\n        String file = path()+\"student_demo1.xls\";\n        //è¯»æ“ä½œ\n        EasyExcel.read(file, Student1.class, new StudentDataListener1()).sheet(\"åœŸè±†\").doRead();\n    }</code></pre>\n<h2 id=\"1.5%EF%BC%9A%E5%A4%8D%E6%9D%82%E6%93%8D%E4%BD%9C\">1.5ï¼šå¤æ‚æ“ä½œ</h2>\n<h3 id=\"1.5.1%EF%BC%9A%E5%A4%8D%E5%90%88%E8%A1%A8%E5%A4%B4\">1.5.1ï¼šå¤åˆè¡¨å¤´</h3>\n<pre><code class=\"language-java\">package com.czxy.excel;\n\nimport com.alibaba.excel.annotation.ExcelProperty;\nimport com.alibaba.excel.annotation.format.DateTimeFormat;\nimport com.alibaba.excel.annotation.write.style.ColumnWidth;\nimport com.alibaba.excel.annotation.write.style.ContentFontStyle;\nimport com.alibaba.excel.annotation.write.style.HeadRowHeight;\nimport com.alibaba.excel.enums.BooleanEnum;\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\n\nimport java.awt.*;\nimport java.util.Date;\n\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@ColumnWidth(30)\n@HeadRowHeight(30)\npublic class Student2 {\n    @ExcelProperty(\"ç¼–å·\")\n    private String id;\n    @ExcelProperty(\"å§“å\")\n    @ContentFontStyle(fontName = \"æ¥·ä½“\",italic = BooleanEnum.TRUE,color = Font.ITALIC)\n    private String name;\n    @ExcelProperty({\"åŸºæœ¬ä¿¡æ¯\",\"å¹´é¾„\"})\n    private Integer age;\n    @ExcelProperty({\"åŸºæœ¬ä¿¡æ¯\",\"ç”µè¯\"})\n    private String phone;\n    @ExcelProperty({\"å¯é€‰ä¿¡æ¯\",\"é‚®ä»¶\"})\n    private String Email;\n    @ExcelProperty({\"å¯é€‰ä¿¡æ¯\",\"ç”Ÿæ—¥\"})\n    @DateTimeFormat(\"yyyy-MM-dd HH:mm\")\n    private Date birthday;\n\n}\n</code></pre>\n<h3 id=\"1.5.2%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8\">1.5.2ï¼šå†™æ“ä½œï¼šå¤šè¡¨</h3>\n<pre><code class=\"language-java\"> //å¾—åˆ°æ ¹ç›®å½•è·¯å¾„\n    public String path(){\n        return this.getClass().getResource(\"/\").getPath();\n    }\n    // æ¨¡æ‹Ÿæ•°æ®\n    public List&lt;Student1&gt; getDate(){\n        //æ¨¡æ‹Ÿåæ¡æ•°æ®\n        ArrayList&lt;Student1&gt; student1s = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 10; i++) {\n            Student1 student1 = new Student1(i+\"\",\"åœŸè±†\"+i,i,\"115\"+i,\"626\"+i,new Date());\n            student1s.add(student1);\n        }\n        return student1s;\n    }\n    //åˆ›å»ºæµ‹è¯•ä¹¦å†™å¤šè¡¨\n    @Test\n    public void testWrite(){\n        //å†™å…¥ä½ç½®ï¼š%classpath%/\n        //æ–‡ä»¶åç§°ï¼šstudent-demo.xls\n        //è¡¨åï¼šåœŸè±†\n        //1,æ–‡ä»¶ä½ç½®\n        String file = path()+\"student_demo2.xls\";\n        //2 å†™æ“ä½œ\n        ExcelWriter excelWriter = EasyExcel.write(file, Student2.class).build();\n        //å†™å…¥å¤šä¸ªsheet\n        WriteSheet writeSheet1 = EasyExcel.writerSheet(\"çˆ±åƒè±†çš„\").build();\n        excelWriter.write(getDate(),writeSheet1);\n        //å†™å…¥ç¬¬äºŒä¸ªsheet\n        WriteSheet writeSheet2 = EasyExcel.writerSheet(\"åœŸè±†\").build();\n        excelWriter.write(getDate(),writeSheet2);\n        excelWriter.finish();\n    }</code></pre>\n<h3 id=\"1.5.3%EF%BC%9A%E8%AF%BB%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E8%A1%A8\">1.5.3ï¼šè¯»æ“ä½œï¼šå¤šè¡¨</h3>\n<p>å…·æœ‰ç¼“å­˜å¤„ç†ç±»</p>\n<pre><code class=\"language-java\">package com.czxy.read;\n\nimport com.alibaba.excel.context.AnalysisContext;\nimport com.alibaba.excel.event.AnalysisEventListener;\nimport com.czxy.excel.Student2;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\npublic class StudentDataListener2 extends AnalysisEventListener&lt;Student2&gt; {\n\n    //åˆ›å»ºä¸€ä¸ªé›†åˆç”¨äºä¿å­˜å­¦ç”Ÿ\n    private List&lt;Student2&gt; student2List = new ArrayList&lt;&gt;();\n    //åˆ›å»ºä¸€ä¸ªå˜é‡ç”¨äºåˆ¤æ–­\n    private Integer size = 4;\n    @Override\n    public void invoke(Student2 student2, AnalysisContext analysisContext) {\n        student2List.add(student2);\n        if (student2List.size()&gt;size){\n            print();\n        }\n    }\n    //é‡æ–°åˆ›å»ºä¸€ä¸ªæ–¹æ³•\n    public void print(){\n            student2List.forEach(System.out::println);\n        System.out.println(\"============\");\n        //æ‰“å°å®Œæˆä¹‹åè¿›è¡Œæ¸…ç©ºé›†åˆ\n        student2List.clear();\n    }\n    //è¯¥æ–¹æ³•\n    @Override\n    public void doAfterAllAnalysed(AnalysisContext analysisContext) {\n        System.out.println(\"æ‰“å°å®Œæˆ\");\n        //å¦‚æœé›†åˆä¸­è¿˜æœ‰æ•°æ®è¿›è¡Œæ‰“å°\n       if (!student2List.isEmpty()){\n           print();\n       }\n       student2List.clear();\n    }\n}\n</code></pre>\n<p>è¯»æ“ä½œ </p>\n<pre><code class=\"language-java\">    @Test\n    public void testRead(){\n        String file = path()+\"student_demo2.xls\";\n        //è¯»æ“ä½œ\n        ExcelReader excelReader = EasyExcel.read(file, Student2.class, new StudentDataListener2()).build();\n        ReadSheet readSheet1 = EasyExcel.readSheet(\"çˆ±åƒè±†çš„\").build();\n        excelReader.read(readSheet1);\n        ReadSheet readSheet2 = EasyExcel.readSheet(\"åœŸè±†\").build();\n        excelReader.read(readSheet2);\n        excelReader.finish();\n    }</code></pre>\n<h3 id=\"1.5.4%EF%BC%9A%E5%86%99%E6%93%8D%E4%BD%9C%EF%BC%9A%E5%A4%9A%E5%AF%B9%E8%B1%A1\">1.5.4ï¼šå†™æ“ä½œï¼šå¤šå¯¹è±¡</h3>\n<p>Student</p>\n<pre><code class=\"language-java\">@Data\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Student {\n    @ExcelProperty(\"å§“å\")\n    private String name;\n    @ExcelProperty(\"å¹´é¾„\")\n    private Integer age;\n}</code></pre>\n<p>Book</p>\n<pre><code class=\"language-java\">@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@HeadRowHeight(50)\n@HeadFontStyle(fontName = \"é»‘ä½“\",italic =  BooleanEnum.TRUE, color = Font.COLOR_RED, underline = 2)\npublic class Book {\n    @ExcelProperty(\"ç¼–å·\")\n    private String id;\n\n    @ExcelProperty({\"ä½œè€…ä¿¡æ¯\",\"å§“å\"})\n    private String authorName;\n\n    @ExcelProperty({\"ä½œè€…ä¿¡æ¯\",\"å¹´é¾„\"})\n    private Integer authorAge;\n\n    @ExcelProperty({\"ä¹¦ç±åŸºæœ¬ä¿¡æ¯\",\"æ ‡é¢˜\"})\n    private String title;\n\n    @ContentFontStyle(fontName = \"æ¥·ä¹¦\",italic =  BooleanEnum.TRUE, color = Font.COLOR_RED, underline = -1)\n    @ExcelProperty({\"ä¹¦ç±åŸºæœ¬ä¿¡æ¯\",\"ä»·æ ¼\"})\n    private Double price;\n    @ExcelProperty({\"ä¹¦ç±åŸºæœ¬ä¿¡æ¯\",\"å‡ºç‰ˆæ—¥æœŸ\"})\n    @DateTimeFormat(\"yyyyå¹´MMæœˆddæ—¥\")\n    private Date publishDate;\n}</code></pre>\n<p> å®ç°</p>\n<pre><code class=\"language-java\">public class TestManyObject {\n\n    // è·å¾—å½“å‰é¡¹ç›®çš„è¿è¡Œæ—¶çš„æ ¹ç›®å½•\n    public String getPath() {\n        return this.getClass().getResource(\"/\").getPath();\n    }\n\n    // æ¨¡æ‹Ÿæ•°æ®\n    public List&lt;Student&gt; getStudentData() {\n        List&lt;Student&gt; list = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 20; i++) {\n            list.add(new Student(\"å¼ ä¸‰\" + i, 18 + i));\n        }\n        return list;\n    }\n\n    public List&lt;Book&gt; getBookData() {\n        List&lt;Book&gt; list = new ArrayList&lt;&gt;();\n        for (int i = 0; i &lt; 20; i++) {\n            list.add(new Book(i+\"\" , \"å¼ ä¸‰\" + i , 18 +i, \"åè›‹æ˜¯æ€ä¹ˆ\"+i, 998d+i, new Date()));\n        }\n        return list;\n    }\n\n    // éå†mapå³å¯\n    private Map&lt;Class&lt;?&gt;, List&lt;?&gt;&gt; getData() {\n        Map&lt;Class&lt;?&gt;, List&lt;?&gt;&gt; map = new HashMap&lt;&gt;();\n        map.put(Student.class, getStudentData());\n        map.put(Book.class, getBookData());\n        return map;\n    }\n\n    @Test\n    public void testManyObject() {\n        String file = getPath() + \"many_object.xlsx\";\n        //1 å¼€å§‹å†™\n        ExcelWriter excelWriter = EasyExcel.write(file).build();\n        //2 ä¾æ¬¡å†™æ¯ä¸€ä¸ªå¯¹è±¡\n        for(Map.Entry&lt;Class&lt;?&gt;, List&lt;?&gt;&gt; entry : getData().entrySet()) {\n            Class&lt;?&gt; clazz = entry.getKey();            //ç±»å‹\n            List&lt;?&gt; data = entry.getValue();            //æ•°æ®\n            WriteSheet writeSheet = EasyExcel.writerSheet(clazz.getSimpleName()).head(clazz).build();\n            excelWriter.write(data, writeSheet);\n        }\n\n        //3 å†™å®Œæˆ\n        excelWriter.finish();\n    }\n}</code></pre>\n</div>\n</div>", "first_tag": "Java", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 0, "php": 0, "time": "2022-09-02 14:56:24", "summary": "ä¸ªäººä¸»é¡µçˆ±åƒè±†çš„åœŸè±†çˆ±åƒè±†çš„åœŸè±†æ¬¢è¿åŠ å…¥ç¤¾åŒºï¼Œç¦åˆ©å¤šå¤šå“¦ï¼åœŸè±†ç¤¾åŒºåœŸè±†ç¤¾åŒºæ•°æ®åº“ä¸“æ æ›´æ–°å®Œæ¯•ï¼šæ•°æ®åº“çŸ¥è¯†æ•°æ®åº“çŸ¥è¯†ä¸“æ æ›´æ–°å®Œæ¯•ï¼šçŸ¥è¯†çŸ¥è¯†ä¸“æ æ›´æ–°å®Œæ¯•ï¼šçŸ¥è¯†çŸ¥è¯†å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ã€æ¬¢è¿å…³æ³¨ã€ç‚¹èµã€æ”¶è—ä¸€"}