{"blogid": "125098349", "writerAge": "码龄158天", "writerBlogNum": "12", "writerCollect": "3647", "writerComment": "567", "writerFan": "2988", "writerGrade": "5级", "writerIntegral": "4164", "writerName": "政胤.", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125098349.jpg", "writerRankTotal": "4763", "writerRankWeekly": "39637", "writerThumb": "1625", "writerVisitNum": "123288", "blog_read_count": "34689", "blog_time": "于 2022-06-03 08:45:05 发布", "blog_title": "Python爬虫抢购某宝秒杀商品", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>某宝秒杀，用毫秒级的精准度来抢购！<br/> 你还在为各种活动秒杀 抢不过别人而烦恼吗?</p>\n<p>应粉丝要求 今天出一期 利用Python爬虫 抢购秒杀商品的文章<br/> 目录<br/> ​ 1，项目环境</p>\n<p>​ 2，某宝抢购流程分析</p>\n<p>​ 3，程序实现思路</p>\n<p>​ 4，代码实践与梳理</p>\n<p><strong>项目环境</strong><br/> ​ 操作系统：Windows 10</p>\n<p>​ 开发环境：python3.7</p>\n<p>​ IDE：Pycharm</p>\n<p>​ 自动化模块：Selenium</p>\n<p>​ 安装命令：pip install selenium</p>\n<p>​ 浏览器版本：Google Chrome 99.0.4844.51</p>\n<p>​ 浏览器驱动版本：ChromeDriver 99.0.4844.51</p>\n<p> 注意: ​ 浏览器驱动版本与浏览器版本要一致！</p>\n<p><strong>某宝抢购流程分析</strong><br/> ​ 1，登录网站</p>\n<p>​ 2，购物车选中抢购商品</p>\n<p>​ 3，结算购买</p>\n<p>​ 4，提交订单</p>\n<p>​ 关键：快速完成前面流程，当订单进入提交页面时，付款时间不影响抢购。</p>\n<p>程序实现思路<br/> ​ 购物流程都是固定没有变化的，因此可以把购物流程步骤用代码编辑好交给selenium去自动执行。</p>\n<p>​ 项目结构：驱动直接复制放入项目根路径</p>\n<p><img alt=\"555d332cfbe9ef29e9fed1b14cd03e49.png\" src=\"..\\..\\static\\image\\555d332cfbe9ef29e9fed1b14cd03e49.png\"/></p>\n<p><strong>1，导入对应类库实现对浏览器的操作</strong><br/>  </p>\n<pre><code>from selenium import webdriver\nimport datetime    \nimport time\n\n#自动打开浏览器并且最大化窗口\ndriver = webdriver.Chrome()\ndriver.maximize_window()</code></pre>\n<p><br/> ​ 执行上述代码，浏览器会自动打开并显示如下,证明我们已经开始通过代码操控浏览器了。</p>\n<p><img alt=\"fa3208f670255d39e379d3e920d22f33.png\" src=\"..\\..\\static\\image\\fa3208f670255d39e379d3e920d22f33.png\"/></p>\n<p><strong>2,用代码实现购物流程</strong><br/> 2.1 访问某宝：</p>\n<pre><code>driver.get('https://www.taobao.com')</code></pre>\n<p><br/><br/> 2.2登录某宝：</p>\n<p><img alt=\"c9ebb19f0b22f1969371656a5fc70f59.png\" src=\"..\\..\\static\\image\\c9ebb19f0b22f1969371656a5fc70f59.png\"/></p>\n<p> </p>\n<pre><code>if driver.find_element_by_partial_link_text('亲，请登录'):\n        driver.find_element_by_partial_link_text('亲，请登录').click()</code></pre>\n<p><br/><br/> 2.3 进入购物车</p>\n<pre><code>#跳转到购物车页面\ndriver.get('https://cart.taobao.com/cart.htm')</code></pre>\n<p>2.4 选中所有商品</p>\n<p><img alt=\"4f7c10d31522c2942f93431ca726a8ab.png\" src=\"..\\..\\static\\image\\4f7c10d31522c2942f93431ca726a8ab.png\"/></p>\n<pre><code>#寻找全选选项并勾选\nif driver.find_element_by_id(\"J_SelectAll1\"):\n      driver.find_element_by_id(\"J_SelectAll1\").click()</code></pre>\n<p><br/><br/> 2.5 对比时间,提交结算(重点)</p>\n<pre><code>def buy(buy_time):  #buy_time 购买时间\n    while True:\n        now = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S.%f')\n        print('当前时间:%s'%now)\n\n        #判断是否到达抢购时间\n        if now&gt;buy_time:\n            try:\n                driver.find_element_by_partial_link_text('结 算').click()\n            except:\n                pass\n        #对比时间，循环提交订单\n        while True:\n                try:\n                    if driver.find_element_by_link_text('提交订单'):\n                        driver.find_element_by_link_text('提交订单').click()\n                        print(f\"抢购成功，请尽快付款\")\n                except:\n                    print(f\"再次尝试提交订单\")\n            time.sleep(0.01)</code></pre>\n<p><br/>  </p>\n<p><br/> ​ 这样就可以通过设定的段时间去定时定点抢购商品啦！</p>\n<p>   </p>\n<p><img alt=\"0b0157f40c8c531074c2e9368a4a5eac.png\" src=\"..\\..\\static\\image\\0b0157f40c8c531074c2e9368a4a5eac.png\"/></p>\n<pre><code>print(f\"再次尝试提交订单\")\n        time.sleep(0.01)</code></pre>\n<pre><code>[外链图片转存中...(img-oA7Q06eg-1648366756452)]\n\n​    **这样就可以通过设定的段时间去定时定点抢购商品啦！**</code></pre>\n<p><img alt=\"d40d8a6028e3855d0ceaf4ce0c386c80.png\" src=\"..\\..\\static\\image\\d40d8a6028e3855d0ceaf4ce0c386c80.png\"/></p>\n<p>政胤每天都走在刑的第一线</p>\n<p>大家给点个免费的关注吧</p>\n<p>感谢</p>\n<p> </p>\n</div>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-06-03 08:45:05", "summary": "某宝秒杀，用毫秒级的精准度来抢购！你还在为各种活动秒杀抢不过别人而烦恼吗应粉丝要求今天出一期利用爬虫抢购秒杀商品的文章目录，项目环境，某宝抢购流程分析，程序实现思路，代码实践与梳理项目环境操作系统：开"}