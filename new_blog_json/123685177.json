{"blogid": "123685177", "writerAge": "码龄2年", "writerBlogNum": "2", "writerCollect": "61", "writerComment": "18", "writerFan": "2", "writerGrade": "1级", "writerIntegral": "63", "writerName": "3EoIPrime", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123685177.jpg", "writerRankTotal": "176978", "writerRankWeekly": "1132796", "writerThumb": "24", "writerVisitNum": "8825", "blog_read_count": "8537", "blog_time": "已于 2022-03-25 15:15:54 修改", "blog_title": "安装GPU版本的pytorch（解决pytorch安装时默认安装CPU版本的问题）保姆级教程", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"1anaconda_0\"></a>1、安装anaconda</h1>\n<p><a href=\"https://www.anaconda.com/\">anaconda官网：www.anaconda.com</a></p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1a3d41e92ffb41f18b6079c123bd1c9d.png\"/></p>\n<h1><a id=\"2_4\"></a>2、修改下载源为清华源</h1>\n<p>由于pytorch的服务器在国外，直连下载的话很慢，所以选用清华镜像源下载</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token comment\"># 添加清华镜像</span>\nconda config <span class=\"token operator\">--</span>add channels https:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>tuna<span class=\"token punctuation\">.</span>tsinghua<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>anaconda<span class=\"token operator\">/</span>pkgs<span class=\"token operator\">/</span>free<span class=\"token operator\">/</span>\nconda config <span class=\"token operator\">--</span>add channels https:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>tuna<span class=\"token punctuation\">.</span>tsinghua<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>anaconda<span class=\"token operator\">/</span>pkgs<span class=\"token operator\">/</span>main<span class=\"token operator\">/</span>\n<span class=\"token comment\"># 添加pytorch镜像</span>\nconda config <span class=\"token operator\">--</span>add channels https:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>tuna<span class=\"token punctuation\">.</span>tsinghua<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>anaconda<span class=\"token operator\">/</span>cloud<span class=\"token operator\">/</span>pytorch<span class=\"token operator\">/</span>\n<span class=\"token comment\"># for legacy win-64</span>\nconda config <span class=\"token operator\">--</span>add channels https:<span class=\"token operator\">/</span><span class=\"token operator\">/</span>mirrors<span class=\"token punctuation\">.</span>tuna<span class=\"token punctuation\">.</span>tsinghua<span class=\"token punctuation\">.</span>edu<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>anaconda<span class=\"token operator\">/</span>cloud<span class=\"token operator\">/</span>peterjc123<span class=\"token operator\">/</span>\nconda config <span class=\"token operator\">--</span><span class=\"token function\">set</span> show_channel_urls yes\n\n</code></pre>\n<h1><a id=\"3_18\"></a>3、创建虚拟环境</h1>\n<p>打开anaconda prompt<br/> 在&gt;后面输入<code>conda create -n Pytorch-env python==3.7</code></p>\n<pre><code class=\"prism language-powershell\">conda create <span class=\"token operator\">-</span>n Pytorch<span class=\"token operator\">-</span>env python==3<span class=\"token punctuation\">.</span>7\n</code></pre>\n<p><em><strong>tips冷知识：无论是在安装Tensorflow2还是Pytorch等深度学习框架时，请务必注意你需要安装的函数库版本号与python版本的对应关系！！！</strong></em><br/> <s>（这边建议选择python3.7或3.8的版本，不要问我为什么）</s></p>\n<h1><a id=\"4_29\"></a>4、激活并进入你创建好的虚拟环境</h1>\n<pre><code class=\"prism language-powershell\">conda activate Pytorch<span class=\"token operator\">-</span>env\n</code></pre>\n<p>现在正式开始进入pytorch的安装</p>\n<h1><a id=\"5anacondapytorch_37\"></a>5、anaconda指令安装pytorch</h1>\n<p><a href=\"https://pytorch.org/\">Pytorch官网：https://pytorch.org</a></p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e1ab57ab072241cdb33790209cfef582.png\"/></p>\n<p>复制图中红框的指令：<code>conda install pytorch torchvision torchaudio cudatoolkit=10.2</code></p>\n<p>！！！注意：不要全部复制：<code>conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch-lts</code><br/> 需要删除<code>-c</code>后面的语句</p>\n<p>主要是因为-c pytorch表示指定使用pytorch channel，这个服务器位于国外，下载速度很慢，使用刚刚添加进的清华镜像源可以得到一个较快的下载速度。</p>\n<p><em><strong>tips：解释一下</strong></em></p>\n<p><em><strong>Stable：稳定版本<br/> LTS：（Long Term Support）长期支持版本<br/> Preview：预览版本</strong></em></p>\n<p><em><strong>推荐使用Stable或者LTS版本</strong></em></p>\n<p>在anaconda prompt中鼠标右键粘贴复制指令，回车运行。</p>\n<p><img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\7f6fcd66606943a9848099fce6f85ed6.png\"/></p>\n<h1><a id=\"6_60\"></a>6、耐心等待</h1>\n<h1><a id=\"7_62\"></a>7、安装完成（但是问题来了！）</h1>\n<p>此时，你满心欢喜地进入Pycharm，设置好你的conda解释器，开始跑Pytorch的代码了。好的，首先让我检查一下Pytorch是否使用GPU加速：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> torch \ntorch<span class=\"token punctuation\">.</span>cuda<span class=\"token punctuation\">.</span>is_available<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>OMG！得到的答案是“False”！寄！</p>\n<p>为什么呢？这是网上几乎所以人的安装方法，而他们跑出来却是“True”，作者一开始就是这样想的，明明安装都没有报错的。</p>\n<p>于是又进入刚刚创建的虚拟环境中。。。</p>\n<p>在你创建的“Pytorch-env”虚拟环境查看一下环境中所用的第三方库</p>\n<p><code>conda list</code><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\caa78e66277f4b1e8de731caf7f9caa8.png\"/>突然发现：我明明安装的是基于CUDA的GPU版本，为什么安装的pytorch 和 torchvision 都是CPU版本的？？？<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\0bfdd499de6745ac8adf240f50887f86.png\"/><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\4e1527dfaf4c4f258edf3214277fe2ee.png\"/></p>\n<p>tips：作者在此时经历了无数次卸载重装pytorch，结果都是一样的。</p>\n<p>直到我发现了它：<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\f178fc38bb0d4d1abbba8f766fe037eb.png\"/><br/> 问题就在这，安装pytorch时会默认安装这个cpuonly库，就是这个函数库导致我们安装的pytorch是CPU版本的。</p>\n<p>解决方法：直接<code>conda uninstall cpuonly</code><br/> 他会提示你当你卸载cpuonly后一些函数库的版本改变（其中就包括pytorch 和 torchvision）</p>\n<p>等待安装，loading…</p>\n<p>安装完成后，就可以看到pytorch 和 torchvision 都是 GPU 版本了<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\eb6efa5bf07b48138cd6d3e206eabf72.png\"/>这时候你再</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> torch \ntorch<span class=\"token punctuation\">.</span>cuda<span class=\"token punctuation\">.</span>is_available<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>返回：“True” ！</p>\n<h1><a id=\"8cpuonly_107\"></a>8、如果函数库中没有cpuonly怎么办？</h1>\n<p>还有一种情况我也见到过，就是你在输入<code>conda list</code>查看函数库，发现函数库中并没有cpuonly函数库，但我的pytorch还是cpu版本的那么该怎么办呢？</p>\n<p>解决方法：<code>conda install cpuonly</code><br/> 你先自行给它装上cpuonly函数库<br/> 然后，你再卸载它<code>conda uninstall cpuonly</code></p>\n<p>==<br/> over ~</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-03-25 15:15:54", "summary": "、安装官网：在这里插入图片描述、修改下载源为清华源由于的服务器在国外，直连下载的话很慢，所以选用清华镜像源下载添加清华镜像添加镜像、创建虚拟环境打开在后面输入冷知识：无论是在安装还是等深度学习框架时，"}