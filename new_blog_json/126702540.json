{"blogid": "126702540", "writerAge": "码龄12年", "writerBlogNum": "372", "writerCollect": "611", "writerComment": "70", "writerFan": "1487", "writerGrade": "5级", "writerIntegral": "4321", "writerName": "biyezuopin", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126702540.jpg", "writerRankTotal": "4589", "writerRankWeekly": "2785", "writerThumb": "396", "writerVisitNum": "98286", "blog_read_count": "529", "blog_time": "于 2022-09-05 12:17:27 发布", "blog_title": "基于C++的即时通信软件设计", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>目录<br/> — 、 概 述 1<br/> 1 . 1 设 计 目 的 ： 1<br/> 1 . 2 设 计 内 容 ： 1<br/> 1 . 2 . 1 功 能 设 计 ： 1<br/> 1 . 2 . 2 界 面 设 计 ： 1<br/> 1 . 2 . 3 客 户 端 、 服 务 器 设 计 ： 1<br/> 1 . 3 设 计 要 求 ： 1<br/> 二 、 设 计 任 务 分 析 1<br/> 2 . 1 功 能 设 计 分 析 ： 1<br/> 2 . 2 界 面 设 计 ： 1<br/> 2. 3 客 户 端 、 服 务 器 设 计 ： 1<br/> 2 . 3 . 1 客 户 端 设 计 ： 1<br/> 2 . 3 . 2 服 务 器 端 设 计 ： 1<br/> 三 、 总 体 设 计 2<br/> 3. 1 界 面 设 计 结 果 2<br/> 3 . 1 . 1 登 陆 、 注 册 对 话 框 2<br/> 3 . 1 . 2 主 界 面 对 话 框 2<br/> 3 . 2 客 户 端 程 序 处 理 流 程 图 ： 3<br/> 3. 3 服 务 器 端 程 序 处 理 流 程 图 4<br/> 四 、 程 序 实 现 5<br/> 4. 1 消 息 结 构 体 ： 5<br/> 4 . 1 . 1 消 息 结 构 体 5<br/> 4 . 1 . 2 消 息 模 板 ： 5<br/> 4 . 1 . 3 解 释 ： 5<br/> 4 . 2 客 户 端 程 序 实 现 ： 5<br/> 4 . 2 . 1 客 户 端 自 定 义 套 接 字 类 （ 继 承 M F C 抽 象 类 C S O C K E T ） 实 现 ： 5<br/> 4 . 2 . 2 登 陆 、 注 册 对 话 框 实 现 ： 6<br/> 4 . 2 . 3 主 对 话 框 实 现 ： 7<br/> 4 . 3 服 务 器 程 序 实 现 ： 10<br/> 五 、 运 行 结 果 ： 15<br/> 5 . 1 登 陆 、 注 册 ： 15<br/> 5 . 2 消 息 发 送 ： 17<br/> 5 . 2 . 1 单 发 消 息 ： 17<br/> 5 . 2 . 2 群 发 消 息 ： 18<br/> 5 . 3 文 件 发 送 ： 19<br/> 六 、 心 得 与 体 会 20<br/> 6 . 1 遇 到 的 问 题 及 解 决 方 案 20<br/> 6 . 1 . 1 服 务 器 如 何 与 多 个 客 户 端 进 行 交 互 ？ 20<br/> 6 . 1 . 2 : 如 何 实 现 客 户 端 消 息 的 非 阻 塞 式 接 收 ？ 20<br/> 6 . 2 心 得 与 体 会 ： 21<br/> 参 考 文 献 ： 21<br/> — 、概述<br/> 1… 1 设 计 目 的 ：<br/> 设计一个基于 LAN 的即时通信软件，实现在局域网下可靠的、稳定的即时通信功能以及其从属的附加功能。 1 . 2 设 计 内 容 ：<br/> 1… 2 . 1 功 能 设 计 ：<br/> ·实现一对一的单播通信，包括消息发送与接收以及文件的发送与接收；<br/> ·实现一对多的多播通信，包括消息的发送与接收；<br/> ·附加功能：实现登陆、注册、获取当前在线情况等功能；<br/> 1 . 2 . 2 界 面 设 计 ：<br/> ·客户端的交互界面设计。<br/> 1 . 2 . 3 客 户 端 、 服 务 器 设 计 ：<br/> ·客户端需要完成的功能；<br/> ·服务器需要完成的功能；<br/> ·客户端、服务器的交互设计；<br/> 1… 3 设 计 要 求 ：<br/> 结合《计算机网络》课程所学的知识以及查阅相应的资料完成相应的设计内容， 且需要保证设计的质量以及程序的可靠性和稳定性。<br/> 二、设计任务分析<br/> 2… 1 功 能 设 计 分 析 ：<br/> ·实现一对一的单播、多播通信:<br/> 主要运用消息转发技术，需要服务器来处理消息的解析和转发；其中消息的解析包括获取消息的发送者、接收者、类别；本文转载自http://www.biyezuopin.vip/onews.asp?id=15303针对不同的解析结果需要做出不同的响应。<br/> ·实现附加功能：<br/> 实现登陆、注册、获取当前在线情况等功能；将客户端对附加功能的调用当作特殊的请求消息发送给服务器，服务器解析后做出不同的响应。 2 . 2 界 面 设 计 ：<br/> 客户端界面需要有较好的交互性，因此需要设计：<br/> ·登陆、注册对话框：包括用户名输入框、登陆和注册按钮；<br/> ·主界面对话框：包括消息发送编辑框、消息接收显示区、好友在线情况显示区、发送按钮、以及登陆按钮； 2 . 3 客 户 端 、 服 务 器 设 计 ：<br/> 2 . 3 . 1 客 户 端 设 计 ：<br/> ·获取客户所发送的消息内容;<br/> ·根据客户要求封装消息并发送消息；<br/> ·接收服务器发来的消息;<br/> ·解析接收的消息并执行对应响应的功能；<br/> 2… 3 . 2 服 务 器 端 设 计 ：<br/> ·获取客户端发来的消息<br/> ·解析消息并执行对应的处理<br/> ·将处理结果封装成消息发送给指定客户</p>\n<pre><code>// MySocket.cpp : implementation file\n//\n\n#include \"stdafx.h\"\n#include \"LanMessage.h\"\n#include \"MySocket.h\"\n\n#ifdef _DEBUG\n#define new DEBUG_NEW\n#undef THIS_FILE\nstatic char THIS_FILE[] = __FILE__;\n#endif\n\n/\n// CMySocket\n\nCMySocket::CMySocket()\n{\n}\n\nCMySocket::~CMySocket()\n{\n}\nvoid CMySocket::OnReceive(int n)//消息响应处理\n{\n\tif(dlg-&gt;online)//在线才进行响应\n\t{\n    mes trans;\n\tif(!Receive((void*)&amp;trans,sizeof(trans))){return;}//获取服务器消息\n\tCString txt1=trans.from,txt2=\"在线用户\";\n\tif(txt1==txt2)//如果是\"在线客户\"消息\n\t{\n\tCString show;\n\tshow.Format(\"当前用户：%s\\r\\n%s:%s\",dlg-&gt;me,trans.from,trans.content);\n\tdlg-&gt;m_online=show;\n    dlg-&gt;UpdateData(false);//刷新主界面\n\t}\n\telse if(trans.from[0]=='_')//如果是文件消息\n\t{\n\t\tCStdioFile put;\n\t\tCString name=trans.from;\n\t\tname=name.Mid(1);//获取文件名\n\t\tif(!put.Open(name,CFile::modeCreate|CFile::modeWrite))//将文件内容存储\n\t\t{\tAfxMessageBox(\"创建文件失败！\");return;}\n\t\telse put.WriteString(trans.content);\n\t\tput.Close();\n\t}\n\telse {//如果是普通消息\n\tCString show;\n\tshow.Format(\"From %s:%s\\r\\n\",trans.from,trans.content);\n\tdlg-&gt;m_show+=show;\n    dlg-&gt;UpdateData(false);//刷新主界面\n\t}\n\t}\n}\n// Do not edit the following lines, which are needed by ClassWizard.\n#if 0\nBEGIN_MESSAGE_MAP(CMySocket, CSocket)\n\t//{<!-- -->{AFX_MSG_MAP(CMySocket)\n\t//}}AFX_MSG_MAP\nEND_MESSAGE_MAP()\n#endif\t// 0\n\n/\n// CMySocket member functions\n\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\602a57b44caa4788949e423a8d6afe75.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a94fbc3d1e5e4dc49616a594db92b5c5.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\af56ceeab67e491986e4c082fda9f64e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c77823b872ef420da6cdbcd912565750.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3509ec7cf481444bae5e7f2f55dc3495.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f057190a0b5b4ae8893fd23fa2d76cdc.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b5e8e2ee82f6490eabcc9d012bb03904.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8ed5b7ffd1d547958382c81ef3987ec3.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1d0d1c9b63ff4d1d800927df7c044bc6.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\63668ac2629b4d8491a63a97780d2139.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\43736c4d66c34dbaaaafdda973ff2b2d.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0f3d826458b5446f91d45804a4a65ae1.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5e1eb52656534cf993cd9a23f957ddbd.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4a9a97c1979c49e6a38c46e8cfd86b5f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1c20f9531c0c4a8899a3bdd6bea73521.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f34d2334a1bd4923afe2a52cbfaada99.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C++", "cpp": 1, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-05 12:17:27", "summary": "目录、概述设计目的：设计内容：功能设计：界面设计：客户端、服务器设计：设计要求：二、设计任务分析功能设计分析：界面设计：客户端、服务器设计：客户端设计：服务器端设计：三、总体设计界面设计结果登陆、注册"}