{"blogid": "122932986", "writerAge": "码龄5年", "writerBlogNum": "145", "writerCollect": "4530", "writerComment": "2385", "writerFan": "48915", "writerGrade": "7级", "writerIntegral": "9646", "writerName": "IT学习日记", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122932986.jpg", "writerRankTotal": "1194", "writerRankWeekly": "295", "writerThumb": "2820", "writerVisitNum": "404926", "blog_read_count": "4935", "blog_time": "已于 2022-02-21 10:26:24 修改", "blog_title": "PHP8.0环境详细安装教程", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<br/>\n<hr/>\n<blockquote>\n<ul><li><strong>💂 个人主页:</strong> <font color=\"1E88E5\"><a href=\"https://blog.csdn.net/qq_40891009\">IT学习日记</a></font></li><li><strong>🤟 版权:</strong> 本文由【IT学习日记】原创、在CSDN首发、需要转载请联系博主</li><li>💬 如果文章对你有帮助、<strong><font color=\"1E88E5\">欢迎关注、点赞、收藏(一键三连)和订阅专栏哦</font></strong></li><li>💅 <strong><font color=\"1E88E5\">想寻找共同成长的小伙伴，请点击【<a href=\"https://app.yinxiang.com/fx/93d441d2-7cb6-4c13-9b16-5d2df3085984\">技术圈子</a>】</font></strong></li></ul>\n</blockquote>\n<hr/>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><ul><li><ul><li><a href=\"#PHP_12\">一、PHP环境安装流程</a></li><li><ul><li><a href=\"#1PHP_16\">1、下载PHP包(在线或者压缩包方式都可)</a></li><li><a href=\"#2_28\">2、解压压缩包</a></li><li><a href=\"#3_36\">3、指定配置信息</a></li><li><a href=\"#4_64\">4、编译中可能出现的异常和解决方案</a></li><li><a href=\"#5_227\">5、编译和安装</a></li><li><a href=\"#6php_260\">6、查看php安装情况</a></li></ul>\n</li><li><a href=\"#_274\">二、管理各种配置文件</a></li><li><a href=\"#php_311\">三、管理php</a></li><li><a href=\"#_362\">写在最后</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h3><a id=\"PHP_12\"></a>一、PHP环境安装流程</h3>\n<p>  说明：最近在搭建个人网站，环境有用到PHP，特此记录。本文安装案例是以PHP8.0.0版本为示例，<strong>开始安装前建议先将第三步骤抛出异常的依赖安装，这样安装的时候就无需逐个解决问题。</strong></p>\n<h4><a id=\"1PHP_16\"></a>1、下载PHP包(在线或者压缩包方式都可)</h4>\n<p>  建议：提前创建好压缩包地址，方便后续对文件管理，下载地址：https://www.php.net/downloads.php</p>\n<p>  在线下载(如果网速很慢，则离线下载上传到服务器)：wget https://www.php.net/distributions/php-8.0.0.tar.gz</p>\n<p>  离线下载后可通过rz命令上传到服务器：rz -be 文件名</p>\n<p><img alt=\"image-20220206164701929\" src=\"..\\..\\static\\image\\4a09acd3e5a50270e66efa175c87969f.png\"/></p>\n<hr/>\n<h4><a id=\"2_28\"></a>2、解压压缩包</h4>\n<p>  执行代码：tar -xvf php-8.0.0.tar.gz</p>\n<p><img alt=\"image-20220206173311010\" src=\"..\\..\\static\\image\\d9a90dd7bb70496c33a97b0120cc1507.png\"/></p>\n<hr/>\n<h4><a id=\"3_36\"></a>3、指定配置信息</h4>\n<p>  说明：在执行编译之前，需要配置此次编译和安装后的文件的存放位置以及安装的一些组件，<strong>在安装前务必要清楚，如果不了解，建议直接使用本文的代码，防止出现异常问题。</strong></p>\n<p>  了解概念：</p>\n<p>  1、源码安装需要经历步骤：配置(configure)、编译(make)、安装( make install )。</p>\n<p>  2、Configure则是一个可执行文件，可以配置很多选项(可以理解为我们在Windows安装时的图像化界面的功能)，可以通过./configure --help来查看选项具体含义。</p>\n<p>  其中–prefix选项作用是配置源码安装的路径，–with-config-file-path选项作用是设置php配置文件(php.ini)的存放位置，一般来说安装的时候只需要指定这两个路径即可，其他的则是指定php支持哪一些组件了。</p>\n<p>  3、延伸说明下指定存放路径的好处，其实可以类比在Windows等图形化系统的安装软件步骤，安装时指定软件的位置，方便后续对软件进行统一管理(删除，查找等)。</p>\n<p>  4、注意：下面的代码必须处于同一行上，建议先复制到文本上查看是否在同一行，然后再复制到服务器中执行(否则会出现很多莫名其妙的问题，相信你也不想花上几天时间去处理)。</p>\n<p>  至于其他参数选项的含义，可以打官方或者使用./configure --help来查看选项具体含义，建议添加自己需要的组件即可，如果不清楚，进入到解压的文件后直接执行下面的代码。</p>\n<pre><code class=\"prism language-java\"><span class=\"token punctuation\">.</span>/configure <span class=\"token operator\">--</span>prefix<span class=\"token operator\">=</span><span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>install<span class=\"token operator\">/</span>php8 <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>config<span class=\"token operator\">-</span>file<span class=\"token operator\">-</span>path<span class=\"token operator\">=</span><span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>install<span class=\"token operator\">/</span>php8<span class=\"token operator\">/</span>etc <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>curl <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>freetype <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>gd <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>jpeg  <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>gettext <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>kerberos <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>libdir<span class=\"token operator\">=</span>lib64 <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>libxml <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>mysqli <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>openssl <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>pdo<span class=\"token operator\">-</span>mysql  <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>pdo<span class=\"token operator\">-</span>sqlite <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>pear <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>sockets <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>mhash <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>ldap<span class=\"token operator\">-</span>sasl <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>xsl <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>zlib <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>zip <span class=\"token operator\">-</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>bz2 <span class=\"token operator\">--</span><span class=\"token keyword\">with</span><span class=\"token operator\">-</span>iconv  <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>fpm <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>pdo  <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>bcmath  <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>mbregex <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>mbstring <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>opcache <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>pcntl  <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>shmop <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>soap <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>sockets <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>sysvsem <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>xml <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>sysvsem <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>cli <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>opcache <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>intl <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>calendar <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span><span class=\"token keyword\">static</span> <span class=\"token operator\">--</span>enable<span class=\"token operator\">-</span>mysqlnd\n</code></pre>\n<p>  5、配置成功后会出现下面提示：</p>\n<p><img alt=\"image-20220208155945357\" src=\"..\\..\\static\\image\\2d138dcffc5d71c520fa71251b64d33d.png\"/></p>\n<hr/>\n<h4><a id=\"4_64\"></a>4、编译中可能出现的异常和解决方案</h4>\n<p>  说明，新服务器在执行configure脚本设置配置之前，需要存在的相关依赖脚本整合，下面会对每一个异常问题做具体说明：</p>\n<pre><code>yum install dnf\ndnf install libxml2-devel\ndnf install sqlite-devel\ndnf -y install bzip2-devel\ndnf -y install libcurl-devel\ndnf -y install libpng-devel\ndnf -y install libjpeg-devel\ndnf -y install freetype-devel\ndnf -y install libicu-devel\nyum install oniguruma-devel -y\ndnf -y install libxslt-devel\ndnf -y install libzip-devel\n</code></pre>\n<p>  1、异常信息：</p>\n<p><img alt=\"image-20220206173718813\" src=\"..\\..\\static\\image\\27e72549d2a953e6ea44c7757ebfd0ff.png\"/></p>\n<pre><code>configure: error: Package requirements (libxml-2.0 &gt;= 2.9.0) were not met:\nNo package 'libxml-2.0' found\n</code></pre>\n<p>  解决方案：dnf install libxml2-devel</p>\n<p>  2、异常信息：</p>\n<p><img alt=\"image-20220206173919732\" src=\"..\\..\\static\\image\\ef4602fb8b8023b84c7ef10d82ec6cbf.png\"/></p>\n<pre><code>-bash: dnf: command not found\n</code></pre>\n<p>  解决方案：yum install dnf</p>\n<p>  3、异常信息：</p>\n<p><img alt=\"image-20220206174403895\" src=\"..\\..\\static\\image\\ac24c56b6d17993f312984337fce4015.png\"/></p>\n<pre><code>configure: error: Package requirements (sqlite3 &gt; 3.7.4) were not met:\nNo package 'sqlite3' found\n</code></pre>\n<p>  解决方案：dnf install sqlite-devel</p>\n<p>  4、异常信息：</p>\n<p><img alt=\"image-20220206175158134\" src=\"..\\..\\static\\image\\366f7c868be0f7c73adb91752123190e.png\"/></p>\n<pre><code>checking for BZip2 in default path... not found\nconfigure: error: Please reinstall the BZip2 distribution\n</code></pre>\n<p>  解决方案：dnf -y install bzip2-devel</p>\n<p>  5、异常信息：</p>\n<p><img alt=\"image-20220206175450008\" src=\"..\\..\\static\\image\\43899149bd426bbf42f2b7bc7deba97a.png\"/></p>\n<pre><code>configure: error: Package requirements (libcurl &gt;= 7.29.0) were not met:\nNo package 'libcurl' found\n</code></pre>\n<p>  解决方案：dnf -y install libcurl-devel</p>\n<p>  6、异常信息：</p>\n<p><img alt=\"image-20220206175615010\" src=\"..\\..\\static\\image\\23250963b39ec4052d81f25adf4a92b1.png\"/></p>\n<pre><code>configure: error: Package requirements (libpng) were not met:\nNo package 'libpng' found\n</code></pre>\n<p>  解决方案：dnf -y install libpng-devel</p>\n<p>  7、异常信息：</p>\n<pre><code>configure: error: Package requirements (libjpeg) were not met:\nPackage 'libjpeg', required by 'virtual:world', not found\n</code></pre>\n<p>  解决方案：dnf -y install libjpeg-devel</p>\n<p>  8、异常信息：</p>\n<pre><code>configure: error: Package requirements (freetype2) were not met:\nPackage 'freetype2', required by 'virtual:world', not found\n</code></pre>\n<p>  解决方案：dnf -y install freetype-devel</p>\n<p>  9、异常信息：</p>\n<p><img alt=\"image-20220206180127070\" src=\"..\\..\\static\\image\\a00fd7933976f1f1504d558d5916735b.png\"/></p>\n<pre><code>configure: error: Package requirements (icu-uc &gt;= 50.1 icu-io icu-i18n) were not met:\nPackage 'icu-uc', required by 'virtual:world', not found\nPackage 'icu-io', required by 'virtual:world', not found\nPackage 'icu-i18n', required by 'virtual:world', not found\n</code></pre>\n<p>  解决方案：dnf -y install libicu-devel</p>\n<p>  10、异常信息：</p>\n<pre><code>configure: error: Package requirements (oniguruma) were not met:\nNo package 'oniguruma' found\n</code></pre>\n<p>  解决方案：yum install oniguruma-devel -y</p>\n<p>  11、异常信息：</p>\n<pre><code>configure: error: Package requirements (libxslt &gt;= 1.1.0) were not met:\nNo package 'libxslt' found\n</code></pre>\n<p>  解决方案：dnf -y install libxslt-devel</p>\n<p>  12、异常信息：</p>\n<pre><code>configure: error: Package requirements (libzip &gt;= 0.11 libzip != 1.3.1 libzip != 1.7.0) were not met:\nPackage 'libzip', required by 'virtual:world', not found\n</code></pre>\n<p>  解决方案：dnf -y install libzip-devel</p>\n<p>  13、异常信息：</p>\n<pre><code>configure: error: Package requirements (libzip &gt;= 0.11 libzip != 1.3.1 libzip != 1.7.0) were not met:\nRequested 'libzip &gt;= 0.11' but version of libzip is 0.10.1\n</code></pre>\n<p>  解决方案：</p>\n<p>  1、先删除原来的安装：yum remove libzip-devel libzip</p>\n<p>  2、在线下载对应的版本：wget https://libzip.org/download/libzip-1.3.2.tar.gz --no-check-certificate</p>\n<p>  4、进入解压后的文件夹，执行配置脚本：./confugure</p>\n<p>  5、编译并安装：make &amp; make install</p>\n<p>  6、安装完成后，查询/usr/local/lib目录下是否有pkgconfig目录，有的话执行命令export PKG_CONFIG_PATH=\"/usr/local/lib/pkgconfig/\"指定PKG_CONFIG_PATH，然后重新执行切换php解压之后的文件夹，执行./configure脚本即可</p>\n<hr/>\n<h4><a id=\"5_227\"></a>5、编译和安装</h4>\n<p>  配置完成后，执行make指令对源代码进行编译，执行make install指令对源代码进行安装，也可以同时执行这两个指令，具体如下(注意：编译和安装都是在解压后的php文件夹下执行-即存在configure脚本的目录):</p>\n<p>​ 1、编译：make</p>\n<p><img alt=\"image-20220208170518841\" src=\"..\\..\\static\\image\\7e8bfe611769e7eaa18e9b1cd591f145.png\"/></p>\n<p>​ 2、安装：make install</p>\n<p><img alt=\"image-20220208170619708\" src=\"..\\..\\static\\image\\e6539a9365eafc44cdffa079333e3134.png\"/></p>\n<p>  3、出现异常：cc: internal compiler error: Killed (program cc1)</p>\n<p>  原因：大概率是因为内存不够使用，可以先使用交换分区来解决，编译安装后再删除掉即可。</p>\n<p>  解决：</p>\n<pre><code>sudo dd if=/dev/zero of=/swapfile bs=64M count=16\nsudo mkswap /swapfile\nsudo swapon /swapfile\n</code></pre>\n<p>  取消交换分区：</p>\n<pre><code>sudo swapoff /swapfile\nsudo rm /swapfile\n</code></pre>\n<hr/>\n<h4><a id=\"6php_260\"></a>6、查看php安装情况</h4>\n<p>  切换到configure指定的安装路径的bin目录，执行版本查看：</p>\n<pre><code>/usr/local/install/php8/bin/php --version\n</code></pre>\n<p>  执行结果：</p>\n<p><img alt=\"image-20220208170643929\" src=\"..\\..\\static\\image\\f2297a3fb09361e17e5d45b05dd5ec17.png\"/></p>\n<hr/>\n<h3><a id=\"_274\"></a>二、管理各种配置文件</h3>\n<p>1、生成php.ini配置文件(在php源码压缩包目录下)：</p>\n<pre><code>cp php.ini-production /usr/local/install/php8/etc/php.ini\n</code></pre>\n<p>2、生成www配置文件：</p>\n<pre><code>cd /usr/local/install/php8/etc/php-fpm.d/\ncp www.conf.default www.conf\n</code></pre>\n<p>3、生成php-fpm配置文件：</p>\n<pre><code>cd /usr/local/install/php8/etc/\ncp php-fpm.conf.default php-fpm.conf\n</code></pre>\n<p>4、生成php-fpm可执行文件：</p>\n<pre><code>-- 创建存放配置文件的目录\nmkdir /usr/local/install/php8/fpm\n\n-- 从源码中复制一份fpm可执行脚本\ncp /usr/local/php/php-8.0.0/sapi/fpm/init.d.php-fpm /usr/local/install/php8/fpm/php-fpm\n\n-- 将php-fpm修改为可执行文件\nchmod 740 /usr/local/install/php8/fpm/php-fpm\n</code></pre>\n<hr/>\n<h3><a id=\"php_311\"></a>三、管理php</h3>\n<p>说明：本文推荐使用php-fpm进行管理php程序，php-fpm(FastCGI Process Manager：FastCGI进程管理器)是一个PHPFastCGI管理器，旨在将FastCGI进程管理整合进PHP包中(来源：百度百科)。</p>\n<p>优点：相对Spawn-FCGI，php-fpm在CPU和内存方面的控制都更胜一筹，而且前者很容易崩溃，必须用crontab进行监控，而php-fpm则没有这种烦恼。</p>\n<p>1、启动php-fpm:</p>\n<pre><code>/usr/local/install/php8/fpm/php-fpm start\n</code></pre>\n<p><img alt=\"image-20220208180228571\" src=\"..\\..\\static\\image\\42353e613f16c4e3304352b1582e3c38.png\"/></p>\n<p>2、查看php-fpm进程是否启动成功</p>\n<pre><code>ps aux | grep php | grep -v grep\n</code></pre>\n<p><img alt=\"image-20220208180409541\" src=\"..\\..\\static\\image\\cf746c0472b27c4aae7332ffbe45e93c.png\"/></p>\n<p>3、查看pfp-fpm占用的端口</p>\n<pre><code>ss -lntp | grep php\n</code></pre>\n<p><img alt=\"image-20220208180643917\" src=\"..\\..\\static\\image\\18b76d145639b84ce7277b2704c84bd7.png\"/></p>\n<p>4、执行php --version出现php command not found异常，解决步骤</p>\n<pre><code class=\"prism language-java\"><span class=\"token comment\">// 1、修改配置文件</span>\nvim <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile\n \n<span class=\"token comment\">//2、添加php环境变量(即configure脚本时指定的安装路径下的bin目录)</span>\nPATH<span class=\"token operator\">=</span>$PATH<span class=\"token operator\">:</span><span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>local<span class=\"token operator\">/</span>install<span class=\"token operator\">/</span>php8<span class=\"token operator\">/</span>bin\nexport PATH\n    \n<span class=\"token comment\">// 刷新配置文件</span>\nsource <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>profile\n    \n</code></pre>\n<p>5、大功告成</p>\n<p><img alt=\"image-20220208181510517\" src=\"..\\..\\static\\image\\1c7aefaa4e9bf5658d02545ee1b0a272.png\"/></p>\n<hr/>\n<h3><a id=\"_362\"></a>写在最后</h3>\n<p>  <strong>如果觉的文章有帮助，请给博主点赞、收藏、关注。</strong> 后续博主会带来更多优质、有质量的文章。</p>\n<p>  想要学习更多知识，了解更多开源项目，请点击下面添加博主，进入技术圈子(<strong>圈子所有资源全免费，但要求加入的小伙伴要有长久兴趣，如果只是一时冲动就不推荐加入，毕竟名额有限</strong>)。</p>\n<p>  加入技术圈子，除了遇到搭建问题免费指导，还能第一时间收到行业最新咨询和认识各专业大佬！</p>\n<p><img alt=\"白色简约动画引导关注\" src=\"https://img-blog.csdnimg.cn/img_convert/857e8f4d730964d1edeb848808a57b6a.gif#pic_center\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 1, "time": "2022-02-21 10:26:24", "summary": "个人主页学习日记版权本文由学习日记原创、在首发、需要转载请联系博主如果文章对你有帮助、欢迎关注、点赞、收藏一键三连和订阅专栏哦想寻找共同成长的小伙伴，请点击技术圈子文章目录一、环境安装流程、下载包在线"}