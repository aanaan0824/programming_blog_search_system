{"blogid": "120629823", "writerAge": "码龄2年", "writerBlogNum": "498", "writerCollect": "6003", "writerComment": "435", "writerFan": "87080", "writerGrade": "6级", "writerIntegral": "7472", "writerName": "码农研究僧", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_120629823.jpg", "writerRankTotal": "1602", "writerRankWeekly": "303", "writerThumb": "1159", "writerVisitNum": "848718", "blog_read_count": "6858", "blog_time": "于 2021-10-06 21:30:03 发布", "blog_title": "mysql:Can‘t connect to local MySQL server through socket ‘/var/run/mysqld/mysqld.sock‘解决方法", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>目录</h3>\n<ul><li><a href=\"#_2\">前言</a></li><li><a href=\"#1__11\">1. 原理</a></li><li><a href=\"#2__15\">2. 解决方案</a></li><li><ul><li><a href=\"#21__20\">2.1 软链接</a></li><li><a href=\"#22__47\">2.2 配置文件</a></li></ul>\n</li><li><a href=\"#3__67\">3. 万能方法</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_2\"></a>前言</h1>\n<p>在管理数据库的时候，服务器出现了如下问题</p>\n<pre><code class=\"prism language-java\"><span class=\"token class-name\">ERROR</span> <span class=\"token number\">2002</span> <span class=\"token punctuation\">(</span>HY000<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token class-name\">Can</span><span class=\"token string\">'t connect to local MySQL server through socket '</span><span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>run<span class=\"token operator\">/</span>mysqld<span class=\"token operator\">/</span>mysqld<span class=\"token punctuation\">.</span>sock' <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>截图如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\067195341a1446a9a7051d650de42a3c.png\"/></p>\n<h1><a id=\"1__11\"></a>1. 原理</h1>\n<p>出现以上问题，主要是因为默认连接数据库的主机名-p 为localhost作为主机名。通过该主机名连接mysql服务器的时候，会以socket的方式进行连接，而配置文件的“/etc/mysql.cnf”的路径，未找到相应的socket文件，就会引发此错误</p>\n<h1><a id=\"2__15\"></a>2. 解决方案</h1>\n<p>知道原理便可以修复bug<br/> 主要是路径找不到了<br/> 那我们可以修改配置文件或者是设置一个软链接</p>\n<h2><a id=\"21__20\"></a>2.1 软链接</h2>\n<p>设置软链接，主要是能找到这个socket的文件<br/> 设置方式如下</p>\n<pre><code class=\"prism language-shell\">root@gaokaoli:/opt/mycat/conf<span class=\"token comment\"># ls /var/lib/mysql/mysql.sock</span>\nls: cannot access <span class=\"token string\">'/var/lib/mysql/mysql.sock'</span><span class=\"token builtin class-name\">:</span> No such <span class=\"token function\">file</span> or directory\nroot@gaokaoli:/opt/mycat/conf<span class=\"token comment\"># mkdir /var/lib/mysql</span>\nroot@gaokaoli:/opt/mycat/conf<span class=\"token comment\"># ls /var/lib/mysql/mysql.sock</span>\nls: cannot access <span class=\"token string\">'/var/lib/mysql/mysql.sock'</span><span class=\"token builtin class-name\">:</span> No such <span class=\"token function\">file</span> or directory\nroot@gaokaoli:/opt/mycat/conf<span class=\"token comment\"># ln -s /storage/db/mysql/mysql.sock /var/lib/mysql/mysql.sock</span>\nroot@gaokaoli:/opt/mycat/conf<span class=\"token comment\"># ls /var/lib/mysql/mysql.sock</span>\n/var/lib/mysql/mysql.sock\n\n</code></pre>\n<p>截图如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c517af40d05c422a85c007521bd62344.png\"/><br/> 注意事项：</p>\n<p>以上设置软链接的同时还需要创建一个mysql文件<br/> 不然会出现：</p>\n<pre><code class=\"prism language-java\">ln<span class=\"token operator\">:</span> creating symbolic link `<span class=\"token operator\">/</span><span class=\"token keyword\">var</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>mysql<span class=\"token operator\">/</span>mysql<span class=\"token punctuation\">.</span>sock’<span class=\"token operator\">:</span> <span class=\"token class-name\">No</span> such file or directory\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9b882caa082c48fd80a4050f2930950e.png\"/></p>\n<h2><a id=\"22__47\"></a>2.2 配置文件</h2>\n<p>修改配置文件主要通过etc上的<code>/etc/php.ini</code>这个文件<br/> 主要修改以下文件路径相同即可</p>\n<pre><code class=\"prism language-java\"><span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span>\ndatadir<span class=\"token operator\">=</span><span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>db<span class=\"token operator\">/</span>mysql\nsocket<span class=\"token operator\">=</span><span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>db<span class=\"token operator\">/</span>mysql<span class=\"token operator\">/</span>mysql<span class=\"token punctuation\">.</span>sock\n\n \n<span class=\"token punctuation\">[</span>client<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">default</span><span class=\"token operator\">-</span>character<span class=\"token operator\">-</span>set<span class=\"token operator\">=</span>utf8\nsocket<span class=\"token operator\">=</span><span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>db<span class=\"token operator\">/</span>mysql<span class=\"token operator\">/</span>mysql<span class=\"token punctuation\">.</span>sock\n \n<span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">default</span><span class=\"token operator\">-</span>character<span class=\"token operator\">-</span>set<span class=\"token operator\">=</span>utf8\nsocket<span class=\"token operator\">=</span><span class=\"token operator\">/</span>storage<span class=\"token operator\">/</span>db<span class=\"token operator\">/</span>mysql<span class=\"token operator\">/</span>mysql<span class=\"token punctuation\">.</span>sock\n</code></pre>\n<p>之后重启mysql服务即可</p>\n<h1><a id=\"3__67\"></a>3. 万能方法</h1>\n<p>发现复制软连接之后没反应或者找不到其配置文件</p>\n<p>建议重新下载一个mysql的包 重新安装一遍</p>\n<ul><li>输入wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm</li><li>输入rpm -ivh mysql-community-release-el7-5.noarch.rpm</li><li>输入yum install mysql-server</li></ul>\n<p>或者查看这篇文章<br/> <a href=\"https://blog.csdn.net/Aria_Miazzy/article/details/92803246\">ERROR 2002 (HY000): Can’t connect to local MySQL server through socket ‘/var/run/mysqld/mysqld.sock’</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 1, "time": "2021-10-06 21:30:03", "summary": "目录前言原理解决方案软链接配置文件万能方法前言在管理数据库的时候，服务器出现了如下问题截图如下：在这里插入图片描述原理出现以上问题，主要是因为默认连接数据库的主机名为作为主机名。通过该主机名连接服务器"}