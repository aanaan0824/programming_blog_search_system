{"blogid": "126548293", "writerAge": "ç é¾„3å¹´", "writerBlogNum": "86", "writerCollect": "2391", "writerComment": "2111", "writerFan": "4710", "writerGrade": "6çº§", "writerIntegral": "6412", "writerName": "èµµå››å¸æœº", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126548293.jpg", "writerRankTotal": "2434", "writerRankWeekly": "19", "writerThumb": "2122", "writerVisitNum": "210186", "blog_read_count": "74", "blog_time": "äºÂ 2022-09-07 10:02:41Â å‘å¸ƒ", "blog_title": "ã€Spring Cloudã€‘æ–°é—»å¤´æ¡å¾®æœåŠ¡é¡¹ç›®ï¼šå®æ—¶åˆ›å»ºESç´¢å¼•å¹¶å¼•å…¥MongoDBå®ç°æœç´¢å†å²è®°å½•åŠå…³é”®è¯è”æƒ³", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><img alt=\"8420b26844034fab91b6df661ae68671.png\" src=\"..\\..\\static\\image\\8420b26844034fab91b6df661ae68671.png\"/></p>\n<p><strong>ä¸ªäººç®€ä»‹ï¼š </strong></p>\n<blockquote>\n<p>&gt; ğŸ“¦ä¸ªäººä¸»é¡µï¼š<a href=\"https://blog.csdn.net/weixin_45750572?type=blog\" title=\"èµµå››å¸æœº\">èµµå››å¸æœº</a><br/> &gt; ğŸ†å­¦ä¹ æ–¹å‘ï¼šJAVAåç«¯å¼€å‘ <br/> &gt; â°å¾€æœŸæ–‡ç« ï¼š<a href=\"https://blog.csdn.net/weixin_45750572/article/details/125534014\" title=\"SpringBooté¡¹ç›®æ•´åˆå¾®ä¿¡æ”¯ä»˜\">SpringBooté¡¹ç›®æ•´åˆå¾®ä¿¡æ”¯ä»˜</a><br/> &gt; ğŸ””åšä¸»æ¨èç½‘ç«™ï¼š<a href=\"https://www.nowcoder.com/link/pc_csdncpt_zssj_sf\" title=\"ç‰›å®¢ç½‘ åˆ·é¢˜|é¢è¯•|æ‰¾å·¥ä½œç¥å™¨\">ç‰›å®¢ç½‘ åˆ·é¢˜|é¢è¯•|æ‰¾å·¥ä½œç¥å™¨</a><br/> &gt; ğŸ“£ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ï¼<br/> &gt; ğŸ’–å–œæ¬¢çš„è¯éº»çƒ¦ç‚¹ç‚¹å…³æ³¨å–”ï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘çš„æœ€å¤§åŠ¨åŠ›ã€‚</p>\n</blockquote>\n<p><strong>å‰è¨€ï¼š</strong></p>\n<blockquote>\n<p>æœ€è¿‘åœ¨åšä¸€ä¸ªåŸºäºSpringCloud+Springboot+Dockerçš„æ–°é—»å¤´æ¡å¾®æœåŠ¡é¡¹ç›®ï¼Œç”¨çš„æ˜¯é»‘é©¬çš„æ•™ç¨‹ï¼Œç°åœ¨é¡¹ç›®å¼€å‘è¿›å…¥äº†å°¾å£°ï¼Œæˆ‘æ‰“ç®—é€šè¿‡å†™æ–‡ç« çš„å½¢å¼è¿›è¡Œæ¢³ç†ä¸€éï¼Œå¹¶ä¸”ä¼šå°†æ¢³ç†è¿‡ç¨‹ä¸­å‘ç°çš„Bugè¿›è¡Œä¿®å¤ï¼Œæœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹æˆ‘ä¹Ÿä¼šç»§ç»­åšå‡ºæ”¹è¿›ã€‚è¿™ä¸€ç³»åˆ—çš„æ–‡ç« æˆ‘å°†ä¼šæ”¾å…¥å¾®æœåŠ¡é¡¹ç›®ä¸“æ ä¸­ï¼Œè¿™ä¸ªé¡¹ç›®é€‚åˆåˆšæ¥è§¦å¾®æœåŠ¡çš„äººä½œä¸ºç»ƒæ‰‹é¡¹ç›®ï¼Œå‡å¦‚ä½ å¯¹è¿™ä¸ªé¡¹ç›®æ„Ÿå…´è¶£ä½ å¯ä»¥è®¢é˜…æˆ‘çš„ä¸“æ è¿›è¡ŒæŸ¥çœ‹ï¼Œéœ€è¦èµ„æ–™å¯ä»¥ç§ä¿¡æˆ‘ï¼Œå½“ç„¶è¦æ˜¯èƒ½ç»™æˆ‘ç‚¹ä¸ªå°å°çš„å…³æ³¨å°±æ›´å¥½äº†ï¼Œä½ ä»¬çš„æ”¯æŒæ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›ã€‚</p>\n<p>å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå¯ä»¥ç³»ç»Ÿå­¦ä¹ çš„ç½‘ç«™ï¼Œé‚£ä¹ˆæˆ‘æ¨èçš„æ˜¯ç‰›å®¢ç½‘ï¼Œä¸ªäººæ„Ÿè§‰ç”¨ç€è¿˜æ˜¯ä¸é”™çš„ï¼Œé¡µé¢å¾ˆæ•´æ´ï¼Œè€Œä¸”å†…å®¹ä¹Ÿå¾ˆå…¨é¢ï¼Œè¯­æ³•ç»ƒä¹ ï¼Œç®—æ³•é¢˜ç»ƒä¹ ï¼Œé¢è¯•çŸ¥è¯†æ±‡æ€»ç­‰ç­‰éƒ½æœ‰ï¼Œè®ºå›ä¹Ÿå¾ˆæ´»è·ƒï¼Œä¼ é€é—¨é“¾æ¥ï¼š<a href=\"https://www.nowcoder.com/link/pc_csdncpt_zssj_sf\" title=\"ç‰›å®¢åˆ·é¢˜ç¥å™¨\">ç‰›å®¢åˆ·é¢˜ç¥å™¨</a></p>\n</blockquote>\n<h1>ä¸€ï¼šæ–‡ç« è‡ªåŠ¨æ„å»ºç´¢å¼•</h1>\n<h2>1.éœ€æ±‚åˆ†æ</h2>\n<p>        åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å®Œæˆäº†åˆ©ç”¨Elastic Searchæ¥å¯¹æ–‡ç« è¿›è¡Œæ£€ç´¢ï¼Œåœ¨ä¸€å¼€å§‹æ—¶å€™æˆ‘ä»¬å…ˆæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œç„¶åå°±æ˜¯å¯¹ä»¥å‰æäº¤çš„æ–‡ç« è¿›è¡Œæ‰¹é‡åˆ›å»ºç´¢å¼•ã€‚ä½†æ˜¯å¯¹äºåé¢å‘å¸ƒçš„æ–‡ç« æˆ‘ä»¬å°±ä¸åº”è¯¥å†åƒå‰é¢é‚£æ ·æ‰¹é‡åˆ›å»ºç´¢å¼•äº†ï¼Œä¼šå­˜åœ¨ä¸€ä¸ªæ—¶é—´å·®é—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥é’ˆå¯¹å‘å¸ƒçš„æ–‡ç« å®æ—¶åˆ›å»ºä¸€ä¸ªESç´¢å¼•ã€‚</p>\n<h2>2.å®ç°æ€è·¯</h2>\n<p><img alt=\"\" height=\"357\" src=\"..\\..\\static\\image\\098e95ed1574475b9ea7904ae5280f48.png\" width=\"1151\"/></p>\n<p>        å®ç°æ€è·¯æ˜¯åœ¨æ–‡ç« å¾®æœåŠ¡å°†å®¡æ ¸æˆåŠŸçš„æ–‡ç« ä¿å­˜ä¹‹å‰å°±å°†å…¶è£…å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åè®©æœç´¢å¾®æœåŠ¡è¿›è¡Œæ¶ˆæ¯çš„æ‹‰å–å¹¶æ¶ˆè´¹ã€‚ä¸ºä»€ä¹ˆä¸é€‰æ‹©ç›´æ¥åœ¨æ–‡ç« å®¡æ ¸æˆåŠŸä¹‹ååœ¨è‡ªåª’ä½“ç«¯å°±å°†æ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—å‘¢ï¼Ÿè¦çŸ¥é“æˆ‘ä»¬åˆ›å»ºçš„æ˜ å°„è¡¨ä¸­æ˜¯æœ‰æ–‡ç« é™æ€URLï¼ˆå³MinIOä¸­çš„è·¯å¾„ï¼‰çš„ï¼Œè¿™ä¸ªURLåªæœ‰åœ¨æ–‡ç« å¾®æœåŠ¡ä¸­æˆåŠŸå°†æ–‡ç« ä¿å­˜å€¼MinIOä¸­æ‰èƒ½ç”Ÿæˆï¼Œå› æ­¤éœ€è¦åœ¨æ–‡ç« å¾®æœåŠ¡ä¸­è¿›è¡Œæ¶ˆæ¯çš„å‘é€ã€‚ </p>\n<h2>3.ä»£ç å®ç°</h2>\n<p>â‘ åœ¨ArticleFreemarkerServiceImplä¸­æ”¹é€ ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"language-java\">/**\n * å¼‚æ­¥ç”Ÿæˆé™æ€é¡µé¢åˆ°Minio\n * @param apArticle\n * @param apArticleContent\n */\n@Override\n@Async\npublic void buildArticleToMinIO(ApArticle apArticle, String apArticleContent) {\n    StringWriter out = new StringWriter();\n    if(StringUtils.isNotBlank(apArticleContent)){\n        //3.ä¿®æ”¹ap_articleè¡¨ï¼Œä¿å­˜static_urlå­—æ®µ\n        ApArticle article = new ApArticle();\n        article.setId(apArticle.getId());\n        article.setStaticUrl(path);\n        apArticleMapper.updateById(article);\n\n        //4.åˆ›å»ºç´¢å¼•ï¼Œå‘é€æ¶ˆæ¯\n        createArticleESIndex(article,apArticleContent,path);\n    }\n}\n\n@Autowired\nprivate KafkaTemplate&lt;String,String&gt; kafkaTemplate;\n\n/**\n * åˆ›å»ºç´¢å¼•ï¼Œå‘é€æ¶ˆæ¯\n * @param article\n * @param apArticleContent\n * @param path\n */\nprivate void createArticleESIndex(ApArticle article, String apArticleContent, String path) {\n    SearchArticleVo searchArticleVo = new SearchArticleVo();\n    BeanUtils.copyProperties(apArticleContent,searchArticleVo);\n    searchArticleVo.setContent(apArticleContent);\n    searchArticleVo.setStaticUrl(path);\n\n    //å‘é€æ¶ˆæ¯\n    kafkaTemplate.send(ArticleConstas.ARTICLE_ES_SYNC_TOPIC, JSON.toJSONString(searchArticleVo));\n}</code></pre>\n<p>â‘¡åœ¨æ–‡ç« å¾®æœåŠ¡çš„nacosçš„é…ç½®ä¸­å¿ƒæ·»åŠ å¦‚ä¸‹é…ç½®</p>\n<pre><code class=\"language-java\">kafka:\n    bootstrap-servers: 12.8.10.10:9092\n    producer:\n      retries: 10\n      key-serializer: org.apache.kafka.common.serialization.StringSerializer\n      value-serializer: org.apache.kafka.common.serialization.StringSerializer</code></pre>\n<p>â‘¢æœç´¢å¾®æœåŠ¡ä¸­æ·»åŠ kafkaçš„é…ç½®,nacosé…ç½®å¦‚ä¸‹</p>\n<pre><code class=\"language-java\">spring:\n  kafka:\n    bootstrap-servers: 19.1.20.30:9092\n    consumer:\n      group-id: ${spring.application.name}\n      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer\n      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer</code></pre>\n<p>â‘£å®šä¹‰ç›‘å¬é˜Ÿåˆ—è¿›è¡Œæ¶ˆæ¯çš„æ¶ˆè´¹</p>\n<pre><code class=\"language-java\">package com.my.search.listener;\n\nimport com.alibaba.fastjson.JSON;\nimport com.baomidou.mybatisplus.core.toolkit.StringUtils;\nimport com.my.common.constans.ArticleConstas;\nimport com.my.model.search.vos.SearchArticleVo;\nimport lombok.extern.slf4j.Slf4j;\nimport org.elasticsearch.action.index.IndexRequest;\nimport org.elasticsearch.client.RequestOptions;\nimport org.elasticsearch.client.RestHighLevelClient;\nimport org.elasticsearch.common.xcontent.XContentType;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.kafka.annotation.KafkaListener;\nimport org.springframework.stereotype.Component;\n\nimport java.io.IOException;\n\n\n@Slf4j\n@Component\npublic class SyncArticleListener {\n    @Autowired\n    private RestHighLevelClient restHighLevelClient;\n\n    @KafkaListener(topics = ArticleConstas.ARTICLE_ES_SYNC_TOPIC)\n    public void onMessage(String message) {\n        if(StringUtils.isNotBlank(message)) {\n            log.info(\"æ¥æ”¶åˆ°æ¶ˆæ¯:{}\",message);\n\n            SearchArticleVo vo = JSON.parseObject(message, SearchArticleVo.class);\n            IndexRequest indexRequest = new IndexRequest(\"app_info_article\");\n            indexRequest.id(vo.getId().toString());\n            indexRequest.source(message, XContentType.JSON);\n            try {\n                restHighLevelClient.index(indexRequest, RequestOptions.DEFAULT);\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>\n<h1>äºŒï¼šæœç´¢è®°å½•</h1>\n<h2>1.éœ€æ±‚åˆ†æ</h2>\n<p>        åœ¨ç§»åŠ¨ç«¯è¿›è¡Œæœç´¢æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥è®°å½•æ¯ä¸ªç”¨æˆ·çš„æœç´¢è®°å½•ï¼Œå¹¶ä¸”è¿˜è¦è¿›è¡Œå›æ˜¾ã€‚è¿™æ—¶å€™ä½ å¯èƒ½ä¼šæƒ³åˆ°ç”¨MySQLå¯¹æ¯ä¸ªç”¨æˆ·éƒ½å»ºç«‹ä¸€å¼ æœç´¢è®°å½•è¡¨ï¼Œå½“ç”¨æˆ·é‡ä¸å¤§æ—¶å€™è¿™æ ·åšç¡®å®å¯ä»¥ï¼Œä½†æ˜¯éšç€ç”¨æˆ·é‡çš„å¢åŠ ï¼Œå°±éœ€è¦åˆ›å»ºæˆåƒä¸Šä¸‡å¼ è¡¨ï¼Œè€Œä¸”æˆ‘ä»¬ä¸€èˆ¬åªè®°å½•ç”¨æˆ·çš„æœ‰é™æ¡æœç´¢è®°å½•ï¼Œè¿™æ ·å°±ä¼šå­˜åœ¨è¡¨å¾ˆå¤šä½†æ˜¯æ¯å¼ è¡¨å­˜å‚¨çš„æ•°æ®å¾ˆå°‘çš„æƒ…å†µï¼Œå®¹æ˜“é€ æˆèµ„æºæµªè´¹ï¼Œè€Œä¸”æ•ˆç‡ä¸é«˜ï¼Œç»´æŠ¤å›°éš¾ï¼Œè¿™æ—¶å€™ç”¨MongoDBè¿›è¡Œå­˜å‚¨å°±æ¯”è¾ƒåˆé€‚ã€‚</p>\n<h2>2.å®ç°æ€è·¯</h2>\n<p>        å‰é¢æˆ‘ä»¬åœ¨ç”¨æˆ·è¾“å…¥å…³é”®è¯è¿›è¡Œæœç´¢æ—¶å¯ä»¥å‘é€ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚å°†æœç´¢å…³é”®å­—è¿›è¡Œä¿å­˜ï¼Œä¿å­˜ä¹‹å‰éœ€è¦åˆ¤æ–­è¯¥æœç´¢è®°å½•æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™æ›´æ–°æœç´¢æ—¶é—´ï¼Œå¦åˆ™è¿˜è¦åˆ¤æ–­æ•°æ®é‡æ˜¯å¦è¶…è¿‡10æ¡ï¼Œé€»è¾‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>\n<p><img alt=\"\" height=\"521\" src=\"..\\..\\static\\image\\263f94d123ef48d8aa260792b4162f79.png\" width=\"1185\"/></p>\n<h2>3.ä»£ç å®ç°</h2>\n<p>åœ¨tbug-headlines-searchä¸­æ–°å¢ApUserSearchServiceå¹¶å¢åŠ insertæ–¹æ³•</p>\n<pre><code class=\"language-java\">@Autowired\nprivate MongoTemplate mongoTemplate;\n/**\n * ä¿å­˜æœç´¢è®°å½•\n * @param keyWord\n * @param userId\n */\n@Override\n@Async\npublic void insert(String keyWord, Integer userId) {\n    log.info(\"ä¿å­˜æœç´¢å†å²...\");\n    //1.æŸ¥è¯¢å½“å‰ç”¨æˆ·æœç´¢å…³é”®è¯\n    Query query = Query.query(Criteria.where(\"userId\").is(userId).and(\"keyword\").is(keyWord));\n    ApUserSearch apUserSearch = mongoTemplate.findOne(query,ApUserSearch.class);\n\n    //2.å­˜åœ¨è¯¥å…³é”®è¯ï¼Œæ›´æ–°æ—¶é—´\n    if(apUserSearch != null) {\n        log.info(\"å…³é”®è¯{}å·²å­˜åœ¨ï¼Œæ›´æ–°æ—¶é—´\",keyWord);\n        apUserSearch.setCreatedTime(new Date());\n        mongoTemplate.save(apUserSearch);\n        return;\n    }\n\n    //3.ä¸å­˜åœ¨å…³é”®è¯\n    log.info(\"ä¸å­˜åœ¨è¯¥å…³é”®è¯\");\n    apUserSearch = new ApUserSearch();\n    apUserSearch.setUserId(userId);\n    apUserSearch.setKeyword(keyWord);\n    apUserSearch.setCreatedTime(new Date());\n\n    Query query1 = Query.query(Criteria.where(\"userId\").is(userId));\n    query1.with(Sort.by(Sort.Direction.DESC,\"createdTime\"));\n\n    List&lt;ApUserSearch&gt; userSearchList = mongoTemplate.find(query1, ApUserSearch.class);\n    //3.1æœç´¢è®°å½•æ¡æ•°ä¸å¤§äº10\n    if(userSearchList == null || userSearchList.size() &lt; 10) {\n        log.info(\"æœç´¢è®°å½•æ•°ä¸å¤§äº10ï¼Œä¿å­˜å…³é”®è¯{}\",keyWord);\n        mongoTemplate.save(apUserSearch);\n    } else {\n        //3.2æœç´¢è®°å½•æ¡æ•°å¤§äº10\n        //3.2.1è·å–æ—¶é—´æœ€æ—§çš„æ•°æ®\n        ApUserSearch apUserSearch1 = userSearchList.get(userSearchList.size() - 1);\n        log.info(\"å…³é”®è¯{}æ›¿æ¢æˆ{}\",apUserSearch1.getKeyword(),keyWord);\n        //3.2.2æ›¿æ¢æœ€åä¸€æ¡è®°å½•\n        mongoTemplate.findAndReplace(Query.query(Criteria.where(\"id\").is(apUserSearch1.getId())),apUserSearch);\n    }\n\n}</code></pre>\n<p>åœ¨ArticleSearchServiceImplçš„searchæ–¹æ³•ä¸­å¢åŠ å¼‚æ­¥è°ƒç”¨æ–¹æ³•ï¼š</p>\n<pre><code class=\"language-java\">//å¼‚æ­¥è°ƒç”¨ä¿å­˜å†å²è®°å½•\nApUser user = AppThreadLocalUtils.getUser();\n//ç”¨æˆ·ä¿¡æ¯ä¸ä¸ºç©ºå¹¶ä¸”ä¸ºé¦–é¡µæœç´¢æ‰è¿›è¡Œä¿å­˜\nif(user != null &amp;&amp; dto.getFromIndex() == 0) {\n    apUserSearchService.insert(dto.getSearchWords(),user.getId());\n}</code></pre>\n<p>å›æ˜¾æœç´¢å†å²è®°å½•</p>\n<pre><code class=\"language-java\">/**\n * åŠ è½½å†å²è®°å½•\n * @return\n */\n@Override\npublic ResponseResult loadHistory() {\n    log.info(\"åŠ è½½ç”¨æˆ·å†å²æœç´¢è®°å½•...\");\n    //1.è·å–å½“å‰ç”¨æˆ·id\n    ApUser user = AppThreadLocalUtils.getUser();\n    if(user != null) {\n        Integer userId = user.getId();\n\n        //2.æŸ¥è¯¢è¯¥ç”¨æˆ·å†å²æœç´¢è®°å½•\n        Query query = Query.query(Criteria.where(\"userId\").is(userId));\n        query.with(Sort.by(Sort.Direction.DESC,\"createdTime\"));\n        List&lt;ApUserSearch&gt; searchList = mongoTemplate.find(query, ApUserSearch.class);\n        \n        //3.è¿”å›ç»“æœ\n        return ResponseResult.okResult(searchList);\n    } else {\n        return ResponseResult.errorResult(AppHttpCodeEnum.NEED_LOGIN);\n    }\n}</code></pre>\n<p>è‡³äºåˆ é™¤å†å²æœç´¢è®°å½•è¿™é‡Œå°±ä¸æ”¾ä»£ç äº†ï¼Œå¯ä»¥è‡ªå·±å°è¯•å®ç°ä¸€ä¸‹ã€‚</p>\n<h1>ä¸‰ï¼šå…³é”®è¯è”æƒ³</h1>\n<h2>1.éœ€æ±‚åˆ†æ</h2>\n<p>ç›¸ä¿¡å¤§å®¶éƒ½æœ‰ç”¨è¿‡ç™¾åº¦æœç´¢ï¼Œå½“æˆ‘ä»¬è¾“å…¥å…³é”®å­—ä¹‹åä¼šæœ‰æœç´¢æç¤ºï¼Œå¦‚ä¸‹å›¾ï¼š</p>\n<p><img alt=\"\" height=\"437\" src=\"..\\..\\static\\image\\09f2d3867c9e402180591673d39eb362.png\" width=\"742\"/></p>\n<p> è€Œæˆ‘ä»¬ä¹Ÿè¦åœ¨ç§»åŠ¨ç«¯å®ç°è¿™ä¸ªæ•ˆæœã€‚</p>\n<h2>2.å®ç°æ€è·¯</h2>\n<p>        å…¶å®èƒ½å¤Ÿå®ç°å…³é”®å­—çš„è”æƒ³ï¼Œä¸»è¦è¿˜æ˜¯è¦é ç»´æŠ¤ä¸€ä¸ªæœç´¢è¯æ•°æ®åº“ï¼Œå½“ç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®å­—æ—¶å€™å°±ä¼šä¸æ–­å‘é€è¯·æ±‚åˆ°è¯¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢å¹¶è¿”å›ï¼Œæ•°æ®åº“ä¸­å­˜å‚¨çš„ä¸€èˆ¬æ˜¯æœç´¢é¢‘ç‡æ¯”è¾ƒé«˜çš„ä¸€äº›è¯ï¼Œé€šå¸¸åœ¨ä¼ä¸šä¸­æœ‰ä¸¤éƒ¨åˆ†æ¥æºï¼š</p>\n<ul><li>è‡ªå·±ç»´æŠ¤æœç´¢è¯ï¼Œé€šè¿‡åˆ†æç”¨æˆ·æœç´¢é¢‘ç‡è¾ƒé«˜çš„è¯ï¼ŒæŒ‰ç…§æ’åä½œä¸ºæœç´¢è¯</li><li>ç¬¬ä¸‰æ–¹è·å–ï¼Œå…³é”®è¯è§„åˆ’å¸ˆï¼ˆç™¾åº¦ï¼‰ã€5118ã€çˆ±ç«™ç½‘</li></ul>\n<h2>3. ä»£ç å®ç°</h2>\n<p>å‰é¢è¯´åˆ°å½“æ£€æµ‹åˆ°ç”¨æˆ·è¾“å…¥çš„å…³é”®å­—æœ‰å‘ç”Ÿå˜åŒ–æ—¶å€™å°±ä¼šå‘é€æŸ¥è¯¢è¯·æ±‚ï¼Œè€Œæˆ‘ä»¬éœ€è¦å¿«é€Ÿå“åº”è¿™ä¸ªè¯·æ±‚ï¼Œå› æ­¤ä½¿ç”¨MongoDBæ¯”è¾ƒåˆé€‚ï¼Œå…¶æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p>\n<table><thead><tr><th></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>æ¥å£è·¯å¾„</td><td>/api/v1/associate/search</td></tr><tr><td>è¯·æ±‚æ–¹å¼</td><td>POST</td></tr><tr><td>å‚æ•°</td><td>UserSearchDto</td></tr><tr><td>å“åº”ç»“æœ</td><td>ResponseResult</td></tr></tbody></table>\n<p>æ–°å¢ApAssociateWordsServiceå¹¶å¢åŠ å¦‚ä¸‹æ–¹æ³•ï¼š</p>\n<pre><code class=\"language-java\">@Autowired\nprivate MongoTemplate mongoTemplate;\n\n/**\n * è·å–è”æƒ³è¯\n * @param dto\n * @return\n */\n@Override\npublic ResponseResult getAssociationWord(UserSearchDto dto) {\n    if(dto == null || StringUtils.isBlank(dto.getSearchWords())) {\n        return  ResponseResult.errorResult(AppHttpCodeEnum.PARAM_INVALID);\n    }\n\n    //åˆ†é¡µæŸ¥è¯¢\n    if(dto.getPageSize() &gt; 20) {\n        dto.setPageSize(20);\n    }\n\n    //æ¨¡ç³ŠæŸ¥è¯¢\n    Query query = Query.query(Criteria.where(\"associateWords\").regex(\".*\\\\\" + dto.getSearchWords() + \".*\"));\n    query.limit(dto.getPageSize());\n    List&lt;ApAssociateWords&gt; apAssociateWords = mongoTemplate.find(query, ApAssociateWords.class);\n    return ResponseResult.okResult(apAssociateWords);\n}\n</code></pre>\n<p></p>\n<p>ä¸‹ç¯‡é¢„å‘Šï¼šKafka Streamå®ç°æ–‡ç« çƒ­åº¦å®æ—¶è®¡ç®—</p>\n<p> å‹æƒ…é“¾æ¥ï¼š <a class=\"link-info\" href=\"https://www.nowcoder.com/link/pc_csdncpt_zssj_sf\" title=\"ç‰›å®¢ç½‘  åˆ·é¢˜|é¢è¯•|æ‰¾å·¥ä½œç¥å™¨\">ç‰›å®¢ç½‘  åˆ·é¢˜|é¢è¯•|æ‰¾å·¥ä½œç¥å™¨</a></p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 0, "time": "2022-09-07 10:02:41", "summary": "ä¸ªäººç®€ä»‹ï¼šä¸ªäººä¸»é¡µï¼šèµµå››å¸æœºèµµå››å¸æœºå­¦ä¹ æ–¹å‘ï¼šåç«¯å¼€å‘å¾€æœŸæ–‡ç« ï¼šé¡¹ç›®æ•´åˆå¾®ä¿¡æ”¯ä»˜é¡¹ç›®æ•´åˆå¾®ä¿¡æ”¯ä»˜åšä¸»æ¨èç½‘ç«™ï¼šç‰›å®¢ç½‘åˆ·é¢˜é¢è¯•æ‰¾å·¥ä½œç¥å™¨ç‰›å®¢ç½‘åˆ·é¢˜é¢è¯•æ‰¾å·¥ä½œç¥å™¨ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ï¼å–œ"}