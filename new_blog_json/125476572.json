{"blogid": "125476572", "writerAge": "码龄1年", "writerBlogNum": "45", "writerCollect": "42", "writerComment": "11", "writerFan": "59", "writerGrade": "3级", "writerIntegral": "566", "writerName": "amateur12", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125476572.jpg", "writerRankTotal": "38766", "writerRankWeekly": "364885", "writerThumb": "18", "writerVisitNum": "22276", "blog_read_count": "730", "blog_time": "已于 2022-07-20 11:03:34 修改", "blog_title": "ThinkPHP 6使用 mongoDB", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>在config/database.php添加mongoDB数据库配置信息：</p>\n<pre><code class=\"language-php\">        // 更多的数据库配置信息\n        'mongodb'=&gt;[\n            // 数据库类型\n            'type'              =&gt; 'mongo',\n            // 服务器地址\n            'hostname'          =&gt; '127.0.0.1',\n            // 数据库名\n            'database'          =&gt; 'test',\n            // 用户名\n            'username'          =&gt; '',\n            // 密码\n            'password'          =&gt; '',\n            // 端口\n            'hostport'          =&gt; '27017',\n            // 数据库连接参数\n            'params'            =&gt; [],\n            // 数据库调试模式\n            'debug'             =&gt; env('database.debug', true),\n            // 数据库部署方式:0 集中式(单一服务器),1 分布式(主从服务器)\n            'deploy'            =&gt; 0,\n            // 数据库读写是否分离 主从式有效\n            'rw_separate'       =&gt; false,\n            // 监听SQL\n            'trigger_sql'       =&gt; true,\n            // 读写分离后 主服务器数量\n            'master_num'        =&gt; 1,\n            // 指定从服务器序号\n            'slave_no'          =&gt; '',\n            // 是否严格检查字段是否存在\n            'fields_strict'     =&gt; true,\n            // 是否需要断线重连\n            'break_reconnect'   =&gt; false,\n            // 字段缓存路径\n            'schema_cache_path' =&gt; app()-&gt;getRuntimePath() . 'schema' . DIRECTORY_SEPARATOR,\n        ]</code></pre>\n<p>数据存入和读取的代码：</p>\n<pre><code class=\"language-php\">        Db::connect('mongodb')\n            -&gt;table('one')\n            -&gt;insert(['name'=&gt;123,'age'=&gt;18]);\n\n        $res = Db::connect('mongodb')\n            -&gt;table('one')\n            -&gt;select();\n\n        dd($res);</code></pre>\n<p>效果：</p>\n<p><img alt=\"\" height=\"283\" src=\"..\\..\\static\\image\\85ad5452d56d42e190b9155ba17a845a.png\" width=\"495\"/></p>\n<p><img alt=\"\" height=\"186\" src=\"..\\..\\static\\image\\27b06d2c2eff4b43823fb13480d45f6c.png\" width=\"515\"/></p>\n<p>补充一点mongoDB的知识：</p>\n<p>mongoDB使用场景：</p>\n<blockquote>\n<p>实时读取，对速度有要求，读取快</p>\n<p></p>\n<p>数据量大，并且数据保存价值不大，比如说文章的评论，尽管有数据持久化，但仍有丢失风险</p>\n<p></p>\n<p>不要求使用事务，不支持事务</p>\n</blockquote>\n<p>mongoDB使用案例：</p>\n<blockquote>\n<p>京东，存储商品信息,和关注功能.</p>\n<p>赶集网，记录pv浏览计数</p>\n<p>奇虎360，每天接受200亿次的查询</p>\n<p>百度云，存储500亿条关于文件源信息的记录.</p>\n<p>CERN粒子物理研究所，存储大型强子对撞机的数据</p>\n</blockquote>\n<p>mongoDB和Redis的区别： </p>\n<blockquote>\n<p>内存管理机制：Redis数据全部存储在内存，定期写入磁盘，当内存不够是，可以选择指定的LRU算法删除数据。Mongodb数据存在内存上，由Linux系统mmap实现，当内存不够时，只将热点数据放入内存，其他数据存在磁盘。</p>\n<p></p>\n<p>数据结构：Redis支持多种数据结构，包括Hash、set、list等。Mongodb支持比较单一，但支持丰富的数据表达，索引，最类似于关系型数据库，支持的查询语言比较丰富。 </p>\n</blockquote>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-07-20 11:03:34", "summary": "在添加数据库配置信息：更多的数据库配置信息数据库类型服务器地址数据库名用户名密码端口数据库连接参数数据库调试模式数据库部署方式集中式单一服务器分布式主从服务器数据库读写是否分离主从式有效监听读写分离后"}