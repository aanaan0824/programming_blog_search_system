{"blogid": "124839261", "writerAge": "码龄3年", "writerBlogNum": "26", "writerCollect": "305", "writerComment": "37", "writerFan": "1105", "writerGrade": "3级", "writerIntegral": "479", "writerName": "宋小童", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124839261.jpg", "writerRankTotal": "57056", "writerRankWeekly": "16669", "writerThumb": "43", "writerVisitNum": "30895", "blog_read_count": "1176", "blog_time": "已于 2022-05-19 12:28:01 修改", "blog_title": "康耐视Visionpro脚本编写教程二", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>本文已参与[新人创作礼]活动，一起来开启掘金创作之路。</p>\n<h1><a id=\"__1\"></a>第二步 开始脚本的编写</h1>\n<p>上一章我们说到了输出项的配置，那么本文就目前的输出，做一个脚本的编写；<br/> 首先我们需要构建一个脚本。</p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\c5716a680e51186c72a323caecdd2ed2.png\"/><br/> 这里的脚本分为VB和c#，又都分为低级脚本和高级脚本。我们本文主要讲的就是c#的高级脚本，C# Advanced Script<br/> 我们先创建一个高级脚本：</p>\n<p><strong>在工具组先配置完的情况下可以直接进行脚本的编写，在脚本写完又增加了新的工具时，需要增加一些配置，我们后续再讲，本文不再讲解</strong></p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\9712a56d4c30b77fe62d6b57d2c237b4.png\"/><br/> 和编程一样，脚本的编写也要遵循先定义，后赋值，再使用的步骤。</p>\n<h2><a id=\"_14\"></a>定义工具</h2>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\26a73787f77e112b2cd038a0ad7a9007.png\"/></p>\n<pre><code class=\"prism language-js\">    <span class=\"token comment\">//首先需要给输出项赋值，作为我们的判断依据，必须有初始值</span>\n    mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patCount\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patZuoBiao\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span><span class=\"token string\">\" 0.00,0.00\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//定义模板匹配工具并且赋值</span>\n    CogPMAlignTool pat <span class=\"token operator\">=</span> mToolBlock<span class=\"token punctuation\">.</span>Tools<span class=\"token punctuation\">[</span><span class=\"token string\">\"CogPMAlignTool1\"</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> CogPMAlignTool<span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"_25\"></a>使用工具</h2>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\9fbd2d790c5bf63856ee958b5b156cb7.png\"/><br/> 此处工具是自动全部运行，我们也可以讲工具改为手动控制运行，本文不作讲解，有兴趣的朋友可以自行研究。<br/> 模板定位工具有很多自己的属性，我们可以根据我们的需求去查找我们需要的属性，并且再脚本中运用。</p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\acc48f19abcde269f723f569caeabacb.png\"/><br/> 通过添加终端可以添加工具的所有属性。<br/> 我们这次使用的是模板的个数和坐标，不需要从终端添加，我们不做细致的讲解。</p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\694d2d78b6d2b6d42c98c161d3b49ad3.png\"/></p>\n<pre><code class=\"prism language-js\"> <span class=\"token comment\">//工具运行结束后，我们需要判断工具是否正常运行</span>\n    <span class=\"token comment\">//本文由宋小童创建于2020/05/18</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> pat<span class=\"token punctuation\">.</span>RunStatus<span class=\"token punctuation\">.</span>Result <span class=\"token operator\">==</span> CogToolResultConstants<span class=\"token punctuation\">.</span>Accept<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n    \n    \n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patCount\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">;</span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patZuoBiao\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"工具运行失败\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n     \n</code></pre>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\b630e59ddc7fd7ce601bc84c42bf3796.png\"/></p>\n<pre><code class=\"prism language-js\">\n    mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patCount\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patZuoBiao\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span><span class=\"token string\">\" 0.00,0.00\"</span><span class=\"token punctuation\">;</span>\n    CogPMAlignTool pat <span class=\"token operator\">=</span> mToolBlock<span class=\"token punctuation\">.</span>Tools<span class=\"token punctuation\">[</span><span class=\"token string\">\"CogPMAlignTool1\"</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> CogPMAlignTool<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Run each tool using the RunTool function</span>\n    <span class=\"token function\">foreach</span><span class=\"token punctuation\">(</span>ICogTool tool <span class=\"token keyword\">in</span> mToolBlock<span class=\"token punctuation\">.</span>Tools<span class=\"token punctuation\">)</span>\n      mToolBlock<span class=\"token punctuation\">.</span><span class=\"token function\">RunTool</span><span class=\"token punctuation\">(</span>tool<span class=\"token punctuation\">,</span> ref message<span class=\"token punctuation\">,</span> ref result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//工具运行结束后，我们需要判断工具是否正常运行</span>\n    <span class=\"token comment\">//本文由宋小童创建于2020/05/18</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> pat<span class=\"token punctuation\">.</span>RunStatus<span class=\"token punctuation\">.</span>Result <span class=\"token operator\">==</span> CogToolResultConstants<span class=\"token punctuation\">.</span>Accept<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n      <span class=\"token comment\">//模板的个数赋值给输出的个数</span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patCount\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> pat<span class=\"token punctuation\">.</span>Results<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> \n      <span class=\"token comment\">//模板的第二个坐标的值赋给我们的输出；</span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patZuoBiao\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> pat<span class=\"token punctuation\">.</span>Results<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">GetPose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>TranslationX<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\",\"</span> <span class=\"token operator\">+</span> pat<span class=\"token punctuation\">.</span>Results<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">GetPose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>TranslationY<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patCount\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"error\"</span><span class=\"token punctuation\">;</span>\n      mToolBlock<span class=\"token punctuation\">.</span>Outputs<span class=\"token punctuation\">[</span><span class=\"token string\">\"patZuoBiao\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"工具运行失败\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n     \n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    \n    \n</code></pre>\n<p>然后我们手动运行工具组，打开模板工具，进入结果</p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\9174692c810f454c0dbc859f2a1fde89.png\"/><br/> 查看第二个模板的坐标数据为1569.1 1255.66<br/> 然后返回我们的工具组，查看我们输出的结果里面的坐标值</p>\n<p><img alt=\"image.png\" src=\"..\\..\\static\\image\\2e396668d778d8483efb4b10c229f78d.png\"/><br/> 发现结果完全一致，说明我们的脚本目前已经完成了编写，且输出的结果没有问题。</p>\n<h3><a id=\"c_90\"></a>本文主要讲解了脚本的编写，后续我们还会讲到再c#中怎么调用我们输出的结果和图像。</h3>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-05-19 12:28:01", "summary": "本文已参与新人创作礼活动，一起来开启掘金创作之路。第二步开始脚本的编写上一章我们说到了输出项的配置，那么本文就目前的输出，做一个脚本的编写；首先我们需要构建一个脚本。这里的脚本分为和，又都分为低级脚本"}