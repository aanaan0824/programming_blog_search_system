{"blogid": "124309171", "writerAge": "码龄6年", "writerBlogNum": "12", "writerCollect": "85", "writerComment": "8", "writerFan": "1106", "writerGrade": "2级", "writerIntegral": "219", "writerName": "孤独的根号三号程序员", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124309171.jpg", "writerRankTotal": "96580", "writerRankWeekly": "14192", "writerThumb": "44", "writerVisitNum": "15132", "blog_read_count": "3270", "blog_time": "已于 2022-05-05 23:01:43 修改", "blog_title": "C#对于数据库的增删查改", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><strong>首先，放出主界面供大家观摩。</strong><br/> 温馨提示，再进行增删查改之前需要手动建立数据库和数据表及对应字段。在注释当中，有很多知识点，可以停留一会好好消化。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\53461eadd2fd4e438c50c6d0e98f939f.png\"/></p>\n<p><strong>功能1、向数据库中增加数据</strong><br/> 在相应区域输入完毕后，点击“插入”按钮即可。</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//增加</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">==</span><span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入完整的个人信息！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">select</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"select Snumber from db_Information where Snumber='\"</span><span class=\"token operator\">+</span>textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span><span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlDataAdapter</span> sd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataSet</span> ds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> n <span class=\"token operator\">=</span> sd<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db_Information\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">!=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"该学号已存在！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> insert <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into db_Information(Snumber,Sclass,Sname,Ssex,Sage) values ('\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"')\"</span><span class=\"token punctuation\">;</span>\n                    comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>insert<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示插入成功</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"插入成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"插入失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code>            //Command对象常用的方法\n            //ExecuteNonQuery   ：常用于执行非select命令，比如insert、delete、update，并返回该命令所影响的行数，即该命令增加、删除、更改了多少行。\n            //ExecuteScalar     ：用于执行select命令，并返回数据中第一行第一列的值，常用于执行用到count或sum函数的select命令。\n            //ExecuteReader     ：执行select命令，并返回一个DataReader对象，该对象是一个只能向前读的数据集。\n</code></pre>\n<p><strong>功能2、向数据库中删除数据</strong><br/> 在学号那一栏输入学号，按“按学号删除”按钮即可</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button2_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//删除</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被删除者的学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> delete <span class=\"token operator\">=</span> <span class=\"token string\">\"delete from db_Information where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>delete<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示删除成功</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"删除成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"删除失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>功能3、向数据库中查找数据</strong><br/> 在学号那一栏输入学号，按“按学号查找”按钮即可</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button3_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//查找</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被查找者的学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">select</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from db_Information where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span><span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改          </span>\n\n                <span class=\"token class-name\">SqlDataReader</span> sdr <span class=\"token operator\">=</span> comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//SqlDataReader是一个对象集，用于从数据源中读取只读的数据。</span>\n                <span class=\"token keyword\">try</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">.</span>HasRows<span class=\"token punctuation\">)</span><span class=\"token comment\">//判断数据库中是否有数据</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        sdr<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//跳到查询的数据集中的第一行</span>\n                        textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Snumber\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//还可用下标代替，第1列的下标从0开始，以此类推</span>\n                        textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sclass\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//</span>\n                        textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sname\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//</span>\n                        textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Ssex\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//</span>\n                        textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sage\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//</span>\n                    <span class=\"token punctuation\">}</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"查询成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SqlException</span> ex<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code>            //SqlDataReader对象的常用属性\n            //HasRows：          判断数据库中是否有数据\n            //FieldCount:        获取当前行的列数\n            //RecordsAffected:   获取执行SQL语句所增、删、改的行数\n            //Read:              令SqlDataReader对象前进到下一条记录\n            //Get:               读取数据集当前行的某一列的数据\n            //Close:             关闭SqlDataReader对象\n</code></pre>\n<p><strong>功能4、向数据库中更改数据</strong><br/> 在学号那一栏输入学号，在带有“新”标签的栏输入完整的且新的数据，按“按学号更改”按钮即可</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button4_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//更改</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的旧学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox6<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的新学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox7<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox8<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox9<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的新个人信息！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> update <span class=\"token operator\">=</span> <span class=\"token string\">\"update db_Information set Snumber='\"</span><span class=\"token operator\">+</span>textBox6<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span> <span class=\"token string\">\"',Sclass='\"</span> <span class=\"token operator\">+</span> textBox7<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Sname='\"</span> <span class=\"token operator\">+</span> textBox8<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Ssex='\"</span> <span class=\"token operator\">+</span> textBox9<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Sage='\"</span> <span class=\"token operator\">+</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"' where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示更改成功</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更改成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更改失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                \n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>功能5、读取该表中所有数据</strong><br/> 按“读取内容”按钮即可</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button5_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//读取</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n            con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> duqu <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from db_Information\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>duqu<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n            <span class=\"token class-name\">SqlDataReader</span> sdr <span class=\"token operator\">=</span> comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">DataTable</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//法一显示在dataGridView1</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">Load</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//BindingSource bd = new BindingSource();//法二显示在dataGridView1</span>\n            <span class=\"token comment\">//bd.DataSource = sdr;</span>\n            <span class=\"token comment\">//dataGridView1.DataSource = bd;</span>\n\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"学号\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"班级\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"姓名\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"性别\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"年龄\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//ColumnHeadersDefaultCellstyle可以将列标题设置为居中</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>其他功能</strong></p>\n<pre><code class=\"prism language-cpp\">        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_CellClick</span><span class=\"token punctuation\">(</span>object sender<span class=\"token punctuation\">,</span> DataGridViewCellEventArgs e<span class=\"token punctuation\">)</span><span class=\"token comment\">//显示</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token operator\">&gt;=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                DataGridViewRow row <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button6_Click</span><span class=\"token punctuation\">(</span>object sender<span class=\"token punctuation\">,</span> EventArgs e<span class=\"token punctuation\">)</span><span class=\"token comment\">//清除内容</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox6<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox7<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox8<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox9<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_CellFormatting</span><span class=\"token punctuation\">(</span>object sender<span class=\"token punctuation\">,</span> DataGridViewCellFormattingEventArgs e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span>CellStyle<span class=\"token punctuation\">.</span>Alignment <span class=\"token operator\">=</span> DataGridViewContentAlignment<span class=\"token punctuation\">.</span>MiddleCenter<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//将DataGridView单元格里面的内容设置为居中</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"_241\"></a>最后，附上源码，如有不懂欢迎咨询。</h2>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> 数据库的增删改查\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">Form</span></span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//增加</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">==</span><span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入完整的个人信息！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">select</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"select Snumber from db_Information where Snumber='\"</span><span class=\"token operator\">+</span>textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span><span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlDataAdapter</span> sd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataSet</span> ds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> n <span class=\"token operator\">=</span> sd<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"db_Information\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">!=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"该学号已存在！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> insert <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into db_Information(Snumber,Sclass,Sname,Ssex,Sage) values ('\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"')\"</span><span class=\"token punctuation\">;</span>\n                    comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>insert<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                    <span class=\"token comment\">//Command对象常用的方法</span>\n                    <span class=\"token comment\">//ExecuteNonQuery   ：常用于执行非select命令，比如insert、delete、update，并返回该命令所影响的行数，即该命令增加、删除、更改了多少行。</span>\n                    <span class=\"token comment\">//ExecuteScalar     ：用于执行select命令，并返回数据中第一行第一列的值，常用于执行用到count或sum函数的select命令。</span>\n                    <span class=\"token comment\">//ExecuteReader     ：执行select命令，并返回一个DataReader对象，该对象是一个只能向前读的数据集。</span>\n\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示插入成功</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"插入成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"插入失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button2_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//删除</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被删除者的学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> delete <span class=\"token operator\">=</span> <span class=\"token string\">\"delete from db_Information where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>delete<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示删除成功</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"删除成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"删除失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button3_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//查找</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被查找者的学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token keyword\">select</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from db_Information where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span><span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改          </span>\n\n                <span class=\"token comment\">//SqlDataReader对象的常用属性</span>\n                <span class=\"token comment\">//HasRows：          判断数据库中是否有数据</span>\n                <span class=\"token comment\">//FieldCount:        获取当前行的列数</span>\n                <span class=\"token comment\">//RecordsAffected:   获取执行SQL语句所增、删、改的行数</span>\n                <span class=\"token comment\">//Read:              令SqlDataReader对象前进到下一条记录</span>\n                <span class=\"token comment\">//Get:               读取数据集当前行的某一列的数据</span>\n                <span class=\"token comment\">//Close:             关闭SqlDataReader对象</span>\n\n                <span class=\"token class-name\">SqlDataReader</span> sdr <span class=\"token operator\">=</span> comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//SqlDataReader是一个对象集，用于从数据源中读取只读的数据。</span>\n                <span class=\"token keyword\">try</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">.</span>HasRows<span class=\"token punctuation\">)</span><span class=\"token comment\">//判断数据库中是否有数据</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        sdr<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//跳到查询的数据集中的第一行</span>\n                        textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Snumber\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//还可用下标代替，第1列的下标从0开始，以此类推</span>\n                        textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sclass\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//</span>\n                        textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sname\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//</span>\n                        textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Ssex\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//</span>\n                        textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">[</span><span class=\"token string\">\"Sage\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//</span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"查询成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"查询失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    \n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SqlException</span> ex<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button4_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//更改</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的旧学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox6<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的新学号！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox7<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox8<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox9<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入被更改者的新个人信息！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> update <span class=\"token operator\">=</span> <span class=\"token string\">\"update db_Information set Snumber='\"</span><span class=\"token operator\">+</span>textBox6<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span> <span class=\"token string\">\"',Sclass='\"</span> <span class=\"token operator\">+</span> textBox7<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Sname='\"</span> <span class=\"token operator\">+</span> textBox8<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Ssex='\"</span> <span class=\"token operator\">+</span> textBox9<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"',Sage='\"</span> <span class=\"token operator\">+</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"' where Snumber='\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>update<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt32</span><span class=\"token punctuation\">(</span>comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//判断ExecuteNonQuery方法返回的参数是否大于0，大于0表示更改成功</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更改成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更改失败！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                \n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//关闭连接</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button5_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//读取内容</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> SQlstr <span class=\"token operator\">=</span> <span class=\"token string\">\"server=UIM-AIR-II;Uid=sa;Pwd=fzj666,.;database =Information\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>SQlstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建数据库连接对象</span>\n            con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//打开连接</span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> duqu <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from db_Information\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> comm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>duqu<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//Command对象对数据库进行增删查改</span>\n\n            <span class=\"token class-name\">SqlDataReader</span> sdr <span class=\"token operator\">=</span> comm<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">DataTable</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//法一显示在dataGridView1</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">Load</span><span class=\"token punctuation\">(</span>sdr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//BindingSource bd = new BindingSource();//法二显示在dataGridView1</span>\n            <span class=\"token comment\">//bd.DataSource = sdr;</span>\n            <span class=\"token comment\">//dataGridView1.DataSource = bd;</span>\n\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"学号\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"班级\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"姓名\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"性别\"</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText <span class=\"token operator\">=</span> <span class=\"token string\">\"年龄\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//ColumnHeadersDefaultCellstyle可以将列标题设置为居中</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">dataGridView1_CellClick</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewCellEventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//显示</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token operator\">&gt;=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\">DataGridViewRow</span> row <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button6_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span><span class=\"token comment\">//清除内容</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox6<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox7<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox8<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox4<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox9<span class=\"token punctuation\">.</span>Text  <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            textBox5<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span> textBox10<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">dataGridView1_CellFormatting</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewCellFormattingEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span>CellStyle<span class=\"token punctuation\">.</span>Alignment <span class=\"token operator\">=</span> DataGridViewContentAlignment<span class=\"token punctuation\">.</span>MiddleCenter<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//将DataGridView单元格里面的内容设置为居中</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-05-05 23:01:43", "summary": "首先，放出主界面供大家观摩。温馨提示，再进行增删查改之前需要手动建立数据库和数据表及对应字段。在注释当中，有很多知识点，可以停留一会好好消化。在这里插入图片描述功能、向数据库中增加数据在相应区域输入完"}