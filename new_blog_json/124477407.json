{"blogid": "124477407", "writerAge": "ç é¾„1å¹´", "writerBlogNum": "49", "writerCollect": "19", "writerComment": "4", "writerFan": "23", "writerGrade": "3çº§", "writerIntegral": "526", "writerName": "Wei&", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124477407.jpg", "writerRankTotal": "33938", "writerRankWeekly": "40938", "writerThumb": "26", "writerVisitNum": "21304", "blog_read_count": "996", "blog_time": "äºÂ 2022-04-28 17:22:39Â å‘å¸ƒ", "blog_title": "laravel8 excelå¯¼å‡º ï¼ˆæœ¬ç‰‡æ–‡ç« æ¨èä¸¤ç§æ–¹å¼ï¼‰", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<h2>ç¬¬ä¸€ç§ç®€å•æ–¹æ¡ˆ é€šè¿‡composerå®‰è£…</h2>\n<p>æ’ä»¶åº“ï¼š<a href=\"https://packagist.org/packages/maatwebsite/excel\" title=\"maatwebsite/excel - Packagist\">maatwebsite/excel - Packagist</a></p>\n<p>å®˜ç½‘ï¼š<a href=\"https://docs.laravel-excel.com/3.1/getting-started/\" title=\"Introduction | Laravel Excel\">Introduction | Laravel Excel</a></p>\n<p>å¯¼å‡ºæ­¥éª¤ï¼š<a href=\"https://docs.laravel-excel.com/3.1/exports/\" title=\"ğŸš€ 5 minute quick start | Laravel Excel\">ğŸš€ 5 minute quick start | Laravel Excel</a></p>\n<p>å®‰è£…å¯¹åº”çš„phpexcelæ’ä»¶</p>\n<pre><code class=\"language-php\">composer require maatwebsite/excel\n</code></pre>\n<p><br/> æ³¨ï¼šcomposeréœ€è¦åˆ‡æºæ“ä½œï¼Œå¦åˆ™ä¸‹è½½å°†å¯èƒ½ä¸ä¼šæˆåŠŸ</p>\n<p>å®‰è£…æˆåŠŸåï¼Œå°±æä¾›ç”Ÿæˆå¯¼å‡ºæ•°æ®çš„å‘½ä»¤ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ç”Ÿæˆå¯¼å‡ºæ•°æ®æ–‡ä»¶</p>\n<pre><code class=\"language-php\">php artisan make:export FangOwnerExport --model=Models/FangOwner\n</code></pre>\n<p>  ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶</p>\n<p><img alt=\"\" height=\"417\" src=\"..\\..\\static\\image\\12bac9df78604b138a7d482db7b9de6e.png\" width=\"1095\"/></p>\n<p>åœ¨ç›¸å¯¹çš„æ§åˆ¶å™¨å¯¼å‡ºexcel</p>\n<pre><code class=\"language-php\">    #å¼•å…¥\n    use Maatwebsite\\Excel\\Facades\\Excel;\n    #å¯¼å‡º\n    public function phpexcel(){\n        # å¯¹åº”æ–‡ä»¶ï¼Œå¯¼å‡ºæ ‡é¢˜\n        return Excel::download(new FirmExport(),'news.xlsx');\n    }</code></pre>\n<h2>ç¬¬äºŒç§ä½¿ç”¨å°†åŸæœ‰å¯¼å‡ºxlsxæ ¼å¼ è½¬å˜ä¸ºcsvæ ¼å¼ å¯ä»¥åœ¨å¤§æ•°æ®å¯¼å‡ºæ—¶ä¼˜åŒ–å¯¼å‡ºé€Ÿåº¦</h2>\n<p>è¯¦ç»†ä¹¦å†™ä¸€ä¸‹æ€è·¯ï¼Œä»…æä¾›å€Ÿé‰´</p>\n<p>1ã€åˆ›å»ºè·¯ç”±</p>\n<pre><code class=\"language-php\">#excelå¯¼å‡º\nRoute::get('bookexcel',[\\App\\Http\\Controllers\\admin\\AuthController::class,'fileexcel'])-&gt;name('book.excel');</code></pre>\n<p>2ã€å‰ç«¯ä½¿ç”¨</p>\n<p><img alt=\"\" height=\"151\" src=\"..\\..\\static\\image\\ad46dd8931dd4c43abb7149887249e6e.png\" width=\"1200\"/></p>\n<p><img alt=\"\" height=\"735\" src=\"..\\..\\static\\image\\cc1e611beaa0455c85b46be0cb1d93cc.png\" width=\"1200\"/></p>\n<p> </p>\n<p>3ã€åˆ›å»ºå…¬å…±å¯¼å‡ºæ–¹æ³•</p>\n<p> åœ¨appæ–‡ä»¶ä¸‹åˆ›å»ºcommonæ–‡ä»¶å¹¶ä¸”åˆ›å»ºcommon.php</p>\n<p><img alt=\"\" height=\"301\" src=\"..\\..\\static\\image\\e8f604f0f367478bb7c298ed379f1df6.png\" width=\"267\"/></p>\n<p> </p>\n<p> åœ¨composer.jsonæ–‡ä»¶ä¸­autoloadä¸­è¿›è¡Œä¹¦å†™</p>\n<p><img alt=\"\" height=\"269\" src=\"..\\..\\static\\image\\23f511ca2206476a99b29127c655d0f9.png\" width=\"730\"/></p>\n<pre><code class=\"language-php\">  \"files\": [\n           #å…¬å…±æ–¹æ³•è·¯å¾„\n            \"app/common/common.php\"\n        ]</code></pre>\n<p>åˆ·æ–°æ¡†æ¶ åœ¨å‘½ä»¤è¡Œ</p>\n<pre><code class=\"language-php\">composer dump-autoload</code></pre>\n<p>ä»¥ä¸Šæ“ä½œå°±æ˜¯å¯¹æ¡†æ¶ç”Ÿæˆå…±ç±»ï¼Œå®Œæˆååœ¨å…¬å…±ç±»ä¸­å°è£…ä¸€ä¸ªå¯¼å‡ºæ–¹æ³•</p>\n<pre><code class=\"language-php\">//åˆ¤æ–­æ˜¯å¦æœ‰è¯¥æ–¹æ³•\nif(!function_exists('phpexcel')){\n   //è¡¨å¤´ï¼Œæ ‡é¢˜ï¼Œæ•°æ®\n    function phpexcel($cell,$title,$data){\n        set_time_limit(0);\n        ini_set('memory_limit', '128M');\n        header('Content-Type: application/vnd.ms-execl');\n        header('Content-Disposition: attachment;filename=\"'.$title . '.csv\"');\n\n        //ä»¥å†™å…¥è¿½åŠ çš„æ–¹å¼æ‰“å¼€\n        $fp = fopen('php://output', 'a');\n \n        foreach($cell as $key =&gt; $item) {\n            $celldata[$key] = iconv('UTF-8', 'GBK//IGNORE', $item);\n        }\n        //å°†æ ‡é¢˜å†™åˆ°æ ‡å‡†è¾“å‡ºä¸­\n        fputcsv($fp, $celldata);\n        foreach($data as $row){\n            foreach($row as $key =&gt; $item) {\n                //è¿™é‡Œå¿…é¡»è½¬ç ï¼Œä¸ç„¶ä¼šä¹±ç \n                $row[$key] = iconv('UTF-8', 'GBK//IGNORE', $item);\n            }\n            fputcsv($fp, $row);\n        }\n        $res = ['file'=&gt;$title];\n        return response()-&gt;json($res);\n    }\n}</code></pre>\n<p>4ã€æ§åˆ¶å…¶è°ƒç”¨</p>\n<pre><code class=\"language-php\">   #å¯¼å‡º\n    public function fileexcel(Request $request){\n        //é˜²æ­¢æ•°æ®é‡å¤§å†…å­˜ä¸å¤Ÿ\n        ini_set('memory_limit', '256M');\n        //è‡ªå®šä¹‰å­—æ®µ\n        $cell=['id','æ–‡ç« æ ‡é¢˜','é‚®ç®±','åŠ å…¥æ—¶é—´'];\n        //è‡ªå®šä¹‰å¯¼å‡ºæ–‡ä»¶å\n        $title = $request-&gt;input('title','æ–‡ç« åˆ—è¡¨');\n        $title = $title.date('YmdHis');\n        //æ­¤æ–¹æ³•ä¸ºå¯¼å‡ºæ•°æ®æ¥æºï¼Œåœ¨åº“æ–‡ä»¶é‡Œï¼Œä½ å¯æ ¹æ®è‡ªå·±éœ€è¦çš„æ•°æ®æŸ¥æ•°æ®åº“\n        $res=Auths::get()-&gt;toarray();\n        $data=[];\n        foreach ($res as $k=&gt;$v){\n            $data[$k][]=$v['id'];\n            $data[$k][]=$v['auth_name'];\n            $data[$k][]=$v['auth_email'];\n            $data[$k][]=$v['created_at'];\n        }\n        //å¯¼å‡ºè¡¨æ ¼\n         return phpexcel($cell,$title,$data);\n    }</code></pre>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 1, "time": "2022-04-28 17:22:39", "summary": "ç¬¬ä¸€ç§ç®€å•æ–¹æ¡ˆé€šè¿‡å®‰è£…æ’ä»¶åº“ï¼šå®˜ç½‘ï¼šå¯¼å‡ºæ­¥éª¤ï¼šå®‰è£…å¯¹åº”çš„æ’ä»¶æ³¨ï¼šéœ€è¦åˆ‡æºæ“ä½œï¼Œå¦åˆ™ä¸‹è½½å°†å¯èƒ½ä¸ä¼šæˆåŠŸå®‰è£…æˆåŠŸåï¼Œå°±æä¾›ç”Ÿæˆå¯¼å‡ºæ•°æ®çš„å‘½ä»¤ï¼Œä½¿ç”¨æ­¤å‘½ä»¤ç”Ÿæˆå¯¼å‡ºæ•°æ®æ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶åœ¨ç›¸å¯¹çš„æ§åˆ¶å™¨å¯¼å‡ºå¼•å…¥"}