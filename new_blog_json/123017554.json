{"blogid": "123017554", "writerAge": "码龄5年", "writerBlogNum": "82", "writerCollect": "612", "writerComment": "73", "writerFan": "5307", "writerGrade": "5级", "writerIntegral": "1830", "writerName": "熊思宇", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123017554.jpg", "writerRankTotal": "9706", "writerRankWeekly": "1170", "writerThumb": "149", "writerVisitNum": "238971", "blog_read_count": "4216", "blog_time": "已于 2022-07-22 20:20:12 修改", "blog_title": "C# Winform ListView用法", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E6%B7%BB%E5%8A%A0%E6%A0%87%E9%A2%98-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%B7%BB%E5%8A%A0%E6%A0%87%E9%A2%98\">添加标题</a></p>\n<p id=\"%E6%98%BE%E7%A4%BA%E7%BD%91%E6%A0%BC-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%98%BE%E7%A4%BA%E7%BD%91%E6%A0%BC\">显示网格</a></p>\n<p id=\"%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%88%B0%E8%A1%A8%E6%A0%BC%E4%B8%AD-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%88%B0%E8%A1%A8%E6%A0%BC%E4%B8%AD\">添加数据到表格中</a></p>\n<p id=\"%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7-toc\" style=\"margin-left:0px;\"><a href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7\">自定义其他属性</a></p>\n<p id=\"%E7%BB%93%E6%9D%9F-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BB%93%E6%9D%9F\">结束</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<p></p>\n<h1 id=\"%E6%B7%BB%E5%8A%A0%E6%A0%87%E9%A2%98\">添加标题</h1>\n<p>在 Winfrom 界面中添加一个 ListView 组件，然后点击右上角的箭头，点击编辑列</p>\n<p><img alt=\"\" height=\"200\" src=\"..\\..\\static\\image\\ecbffa2278554706bd6d54c243a0f2e6.png\" width=\"300\"/></p>\n<p>添加下面标题，然后点击确定</p>\n<p><img alt=\"\" height=\"468\" src=\"..\\..\\static\\image\\94b6839ecd4143998d50507162489665.png\" width=\"575\"/></p>\n<p>此时 ListView 中还是一片空白，不能显示这些标题，在视图这里选择 Details</p>\n<p><img alt=\"\" height=\"170\" src=\"..\\..\\static\\image\\ee7243d6e7624b45b51916654e9f080b.png\" width=\"247\"/></p>\n<p>就会如下图所示，虽然标题出来了，内容确实一块白版，此时还是觉得 DataGridView 组件好用啊</p>\n<p><img alt=\"\" height=\"344\" src=\"..\\..\\static\\image\\1d237bb07e1b4fb196a090f867698283.png\" width=\"618\"/></p>\n<p></p>\n<h1 id=\"%E6%98%BE%E7%A4%BA%E7%BD%91%E6%A0%BC\">显示网格</h1>\n<p>此时，表格只是一片空白，可以在属性面板中设置，显示网格，如下图</p>\n<p> <img alt=\"\" height=\"300\" src=\"..\\..\\static\\image\\b0a39a2180dc412c885dee59c246254e.png\" width=\"388\"/></p>\n<p> 这时，就如下图所示，效果就出来了，但是里面还是缺点东西</p>\n<p><img alt=\"\" height=\"330\" src=\"..\\..\\static\\image\\87a8e4222a5c46b09bed682de2bf01cf.png\" width=\"613\"/></p>\n<p></p>\n<h1 id=\"%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E5%88%B0%E8%A1%A8%E6%A0%BC%E4%B8%AD\">添加数据到表格中</h1>\n<p>不会添加数据怎么办？直接从网上复制，如下：</p>\n<pre><code class=\"language-cs\">private void Button_Test_Click(object sender, EventArgs e)\n{\n    //数据更新，UI暂时挂起，直到EndUpdate绘制控件，可以有效避免闪烁并大大提高加载速度\n    this.listView1.BeginUpdate();\n    //添加5行数据\n    for (int i = 0; i &lt; 5; i++)   \n    {\n        ListViewItem lvi = new ListViewItem();\n        lvi.SubItems.Add(\"第1列,第\" + i + \"行\");\n        lvi.SubItems.Add(\"第2列,第\" + i + \"行\");\n        lvi.SubItems.Add(\"第3列,第\" + i + \"行\");\n        lvi.SubItems.Add(\"第4列,第\" + i + \"行\");\n        lvi.SubItems.Add(\"第5列,第\" + i + \"行\");\n        this.listView1.Items.Add(lvi);\n    }\n    //结束数据处理，UI界面一次性绘制。\n    this.listView1.EndUpdate(); \n}</code></pre>\n<p>运行后，我们看看效果，what? 第一行序号居然没有数据，这是什么鬼？</p>\n<p><img alt=\"\" height=\"335\" src=\"..\\..\\static\\image\\678f30973eed479eb8008a772a8f0dff.png\" width=\"608\"/></p>\n<p>断点看看，ListViewItem 数组索引 0 处居然是空的</p>\n<p><img alt=\"\" height=\"250\" src=\"..\\..\\static\\image\\2907cce3d93440b5b294f5806392c514.png\" width=\"400\"/></p>\n<p>用下面代码测试了一下，效果同上一模一样，在数组0处就是添加了一个默认空的数据进去</p>\n<pre><code class=\"language-cs\">private void Form1_Load(object sender, EventArgs e)\n{\n    ListViewItem litem = new ListViewItem();\n    for (int i = 0; i &lt; 5; i++)\n    {\n        litem.SubItems.Add(i.ToString());\n    }\n    Console.WriteLine(litem.SubItems.Count);\n}</code></pre>\n<p>找了一下资料，不知道怎么回事，但是我还是找到了解决方法：</p>\n<pre><code class=\"language-cs\">private void Button_Test_Click(object sender, EventArgs e)\n{\n    //数据更新，UI暂时挂起，直到EndUpdate绘制控件，可以有效避免闪烁并大大提高加载速度\n    listView1.BeginUpdate();\n    //添加5行数据\n    for (int i = 0; i &lt; 5; i++)   \n    {\n        int column = i + 1;\n        ListViewItem lvi = listView1.Items.Add(\"第1列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第2列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第3列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第4列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第5列,第\" + column + \"行\");\n    }\n    //结束数据处理，UI界面一次性绘制。\n    listView1.EndUpdate(); \n}</code></pre>\n<p>这种写法看着非常的淡疼，暂时也没其他办法了，有其他更好的写法欢迎留言告诉我。</p>\n<p><img alt=\"\" height=\"338\" src=\"..\\..\\static\\image\\803d6749389d4edd9bccc63b74784f51.png\" width=\"613\"/></p>\n<p>现在效果算是有了，但我想改变其中一个单元格的属性怎么办呢？</p>\n<p></p>\n<h1 id=\"%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7\">自定义其他属性</h1>\n<p>例1：改变背景颜色，和字体颜色</p>\n<pre><code class=\"language-cs\">private void Button_Test_Click(object sender, EventArgs e)\n{\n    //数据更新，UI暂时挂起，直到EndUpdate绘制控件，可以有效避免闪烁并大大提高加载速度\n    listView1.BeginUpdate();\n    //添加5行数据\n    for (int i = 0; i &lt; 5; i++)\n    {\n        int column = i + 1;\n        ListViewItem lvi = listView1.Items.Add(\"第1列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第2列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第3列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第4列,第\" + column + \"行\");\n        lvi.SubItems.Add(\"第5列,第\" + column + \"行\");\n        if (column % 2 == 0)\n        {\n            lvi.BackColor = Color.Red;\n            lvi.ForeColor = Color.White;\n        }\n        else\n        {\n            lvi.BackColor = Color.Green;\n            lvi.ForeColor = Color.Black;\n        }     \n    }\n    //结束数据处理，UI界面一次性绘制。\n    listView1.EndUpdate(); \n}</code></pre>\n<p>效果：</p>\n<p><img alt=\"\" height=\"332\" src=\"..\\..\\static\\image\\a1a1040a7982442da03df30ae518f5f9.png\" width=\"612\"/></p>\n<p> 其他的属性就不作演示了，写法差不多。</p>\n<p></p>\n<h1 id=\"%E7%BB%93%E6%9D%9F\">结束</h1>\n<p>如果这个帖子对你有用，欢迎关注 + 点赞 + 留言，谢谢</p>\n<p>end</p>\n<p></p>\n<p></p>\n<p></p>\n</div>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-07-22 20:20:12", "summary": "目录添加标题显示网格添加数据到表格中自定义其他属性结束添加标题在界面中添加一个组件，然后点击右上角的箭头，点击编辑列添加下面标题，然后点击确定此时中还是一片空白，不能显示这些标题，在视图这里选择就会如"}