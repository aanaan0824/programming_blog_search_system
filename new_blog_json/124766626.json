{"blogid": "124766626", "writerAge": "码龄9年", "writerBlogNum": "70", "writerCollect": "52", "writerComment": "26", "writerFan": "14", "writerGrade": "5级", "writerIntegral": "1802", "writerName": "宝哥66", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124766626.jpg", "writerRankTotal": "13434", "writerRankWeekly": "24068", "writerThumb": "33", "writerVisitNum": "186042", "blog_read_count": "3431", "blog_time": "已于 2022-05-14 21:43:21 修改", "blog_title": "MySQL 日期时间类型精确到毫秒", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>        MySQL 常用的日期时间类型常用的是datetime、timestamp。其中datetime占用5个字节（有些文档中说占用8个字节是不对的，默认也不会保存毫秒）。<br/> ​​​​​​​<img alt=\"\" src=\"..\\..\\static\\image\\addd6471343e4e9f930912ee0dcd4765.png\"/></p>\n<p>        DATETIME和TIMESTAMP两种数据类型，至于怎么选择需要看业务需求，其中DATETIME占用字节较多，但表示范围较大。TIMESTAMP不能用于分区列，因为这种数据类型受时区限制，会受数据库时区的影响。</p>\n<p>         创建表时使用sql，因为有需求保存时间需要精确到毫秒值，官网给出解释：MySQL has fractional seconds support for <a href=\"https://dev.mysql.com/doc/refman/5.7/en/time.html\" title=\"TIME\">TIME</a>, <a href=\"https://dev.mysql.com/doc/refman/5.7/en/datetime.html\" title=\"DATETIME\">DATETIME</a>, and <a href=\"https://dev.mysql.com/doc/refman/5.7/en/datetime.html\" title=\"TIMESTAMP\">TIMESTAMP</a> values, with up to microseconds (6 digits) precision: 意思是三种类型都支持小数秒，就是我们平常说的毫秒。因为timestamp占用字节较少，所以选用TIMESTAMP数据类型。</p>\n<div>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `s_schedule_log` (\n  `log_id` <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) unsigned <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT COMMENT <span class=\"hljs-string\">'log主健'</span>,\n  `job_id` <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'任务id'</span>,\n  `job_name` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">100</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'任务名称'</span>,\n  `execute_result` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">10</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'执行结果。字典EXECUTE_RESULT'</span>,\n  `result_info` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'执行结果信息'</span>,\n  `start_time` <span class=\"hljs-type\">TIMESTAMP</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'开始时间'</span>,\n  `end_time` <span class=\"hljs-type\">TIMESTAMP</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'结束时间'</span>,\n  `error_msg` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">'执行失败时的错误信息'</span>,\n  <span class=\"hljs-keyword\">PRIMARY</span> KEY (`log_id`) <span class=\"hljs-keyword\">USING</span> BTREE\n) ENGINE<span class=\"hljs-operator\">=</span>InnoDB <span class=\"hljs-keyword\">DEFAULT</span> CHARSET<span class=\"hljs-operator\">=</span>utf8 COMMENT<span class=\"hljs-operator\">=</span><span class=\"hljs-string\">'定时任务执行日志'</span></code></pre>\n</div>\n<p>        实际运行时发现并未保存毫秒值，运行截图以及数据截图如下<img alt=\"\" height=\"87\" src=\"..\\..\\static\\image\\7532aa930c2a46b9acb2201621de50c3.png\" width=\"880\"/><span title=\"点击并拖拽以改变尺寸\">​</span><img alt=\"\" height=\"86\" src=\"..\\..\\static\\image\\fed9f9f19a0f48f5bcfebb1f13711aa9.png\" width=\"852\"/><span title=\"点击并拖拽以改变尺寸\">​</span><img alt=\"\" height=\"119\" src=\"..\\..\\static\\image\\c0a60ec1e53942c0b6ca0f358f954de0.png\" width=\"1179\"/><span title=\"点击并拖拽以改变尺寸\">​</span></p>\n<p>        从图中可以看出代码插入更新时都已经携带毫秒部分，当时数据库中并未保存，查询官网发文：To define a column that includes a fractional seconds part, use the syntax <code><em><code>type_name</code></em>(<em><code>fsp</code></em>)</code>, where <em><code>type_name</code></em> is <a href=\"https://dev.mysql.com/doc/refman/5.7/en/time.html\" title=\"TIME\">TIME</a>, <a href=\"https://dev.mysql.com/doc/refman/5.7/en/datetime.html\" title=\"DATETIME\">DATETIME</a>, or <a href=\"https://dev.mysql.com/doc/refman/5.7/en/datetime.html\" title=\"TIMESTAMP\">TIMESTAMP</a>, and <em><code>fsp</code></em> is the fractional seconds precision. For example:</p>\n<div>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> t1 (t <span class=\"hljs-type\">TIME</span>(<span class=\"hljs-number\">3</span>), dt DATETIME(<span class=\"hljs-number\">6</span>));</code></pre>\n</div>\n<p>         The <em><code>fsp</code></em> value, if given, must be in the range 0 to 6. A value of 0 signifies that there is no fractional part. If omitted, the default precision is 0. (This differs from the standard SQL default of 6, for compatibility with previous MySQL versions.)</p>\n<p>        意思就是，毫秒部分需要以参数形式传参给数据类型，默认是不保存毫秒的，可以保存1-6位。如果需要保存三位的毫秒值，数据类型可以定义为DATETIME(3)或TIMESTAMP(3)，不需要保存毫秒的话，只需要将类型直接写为DATETIME TIMESTAMP。</p>\n<p></p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-05-14 21:43:21", "summary": "常用的日期时间类型常用的是、。其中占用个字节有些文档中说占用个字节是不对的，默认也不会保存毫秒。和两种数据类型，至于怎么选择需要看业务需求，其中占用字节较多，但表示范围较大。不能用于分区列，因为这种数"}