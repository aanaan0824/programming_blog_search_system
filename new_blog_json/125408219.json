{"blogid": "125408219", "writerAge": "码龄1年", "writerBlogNum": "7", "writerCollect": "10", "writerComment": "5", "writerFan": "74", "writerGrade": "2级", "writerIntegral": "106", "writerName": "她与月色长留", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125408219.jpg", "writerRankTotal": "93375", "writerRankWeekly": "690456", "writerThumb": "22", "writerVisitNum": "3585", "blog_read_count": "2497", "blog_time": "已于 2022-06-22 14:22:22 修改", "blog_title": "解决Mybatis-Plus或PageHelper多表分页查询总条数不对问题", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><ul><li><a href=\"#_1\">前言</a></li><li><a href=\"#_17\">一、问题说明</a></li><li><ul><li><a href=\"#1_35\">1、引入依赖</a></li><li><a href=\"#2MybatisPlus_49\">2、Mybatis-Plus配置</a></li><li><a href=\"#3mapper_84\">3、创建mapper层</a></li><li><a href=\"#4xxxMapperxml_133\">4、编写xxxMapper.xml文件</a></li><li><a href=\"#5_173\">5、测试一（不传任何条件，只分页）</a></li><li><ul><li><a href=\"#51_238\">5.1、结果总结</a></li><li><a href=\"#52_246\">5.2、结果分析</a></li></ul>\n</li><li><a href=\"#6_281\">6、测试二（传两个表的条件）</a></li><li><ul><li><a href=\"#61_294\">6.1、测试结果</a></li><li><a href=\"#62_338\">6.2、结果总结</a></li><li><a href=\"#63_346\">6.3、结果分析</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_356\">二、解决</a></li><li><ul><li><a href=\"#1_364\">1、没条件查询只分页</a></li><li><a href=\"#2_481\">2、两个表都有条件</a></li><li><a href=\"#3_554\">3、结果总结</a></li><li><a href=\"#4_564\">4、结果分析</a></li><li><a href=\"#5_588\">5、最终方案</a></li><li><ul><li><a href=\"#51_620\">5.1、坑</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_629\">三、结束语</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<h2><a id=\"_1\"></a>前言</h2>\n<blockquote>\n<p>项目老大说项目需要重构搜索功能，决定交给我这个比较闲的人！ 嗯 ？？？</p>\n</blockquote>\n<blockquote>\n<p>因为以前的项目数据不大，都不能说不大，是很少，所有搜索采用的是MySQL中的like模糊搜索操作的，他希望我改一下；</p>\n</blockquote>\n<blockquote>\n<p>我第一时间想到了ES，但他说没必要用ES，等以后数据量大了再换，现在只是稍微多了一些数据，没必要</p>\n</blockquote>\n<blockquote>\n<p>Ok！那我就用了MySQL自带的全文检索功能，因为本文主要说的还是Mybatis-Plus的问题，所以全文检索在下面只会提到怎么使用，以及一些问题</p>\n</blockquote>\n<blockquote>\n<p>好像说了一大堆废话，回归正题！</p>\n</blockquote>\n<blockquote>\n<p>项目以前分页搜索用的是PageHelper这个插件，但公司封装的3.0框架中已经封装了Mybatis-Plus，所以我采用了Mybatis-Plus的分页插件</p>\n</blockquote>\n<h2><a id=\"_17\"></a>一、问题说明</h2>\n<blockquote>\n<p><strong>场景：</strong></p>\n<p>老师表是有4条数据，每个老师对应2个学生</p>\n<p>使用的是两个表联查<code>letf join</code>加<code>Mybatis</code>的级联查询，一次性获取所有数据出现3个问题：</p>\n</blockquote>\n<blockquote>\n<p>1、数据总条数以及页数不对</p>\n</blockquote>\n<blockquote>\n<p>2、数据分页数量不对</p>\n</blockquote>\n<blockquote>\n<p>3、数据混乱</p>\n</blockquote>\n<blockquote>\n<p><strong>已下是我有问题的代码：</strong></p>\n</blockquote>\n<h3><a id=\"1_35\"></a>1、引入依赖</h3>\n<blockquote>\n<p>版本选择尽量<code>3.4+</code></p>\n</blockquote>\n<pre><code class=\"prism language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>com.baomidou<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>mybatis-plus-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">&gt;</span></span>3.5.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h3><a id=\"2MybatisPlus_49\"></a>2、Mybatis-Plus配置</h3>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@Configuration</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MybatisPlusConfig</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token comment\">/**\n     * 插件注册\n     *\n     * @param paginationInnerInterceptor 分页插件\n     * @return MybatisPlus拦截器\n     */</span>\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">MybatisPlusInterceptor</span> <span class=\"token function\">mybatisPlusInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">PaginationInnerInterceptor</span> paginationInnerInterceptor<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">MybatisPlusInterceptor</span> mp <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MybatisPlusInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        mp<span class=\"token punctuation\">.</span><span class=\"token function\">addInnerInterceptor</span><span class=\"token punctuation\">(</span>paginationInnerInterceptor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> mp<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//分页插件</span>\n    <span class=\"token annotation punctuation\">@Bean</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">PaginationInnerInterceptor</span> <span class=\"token function\">paginationInnerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">PaginationInnerInterceptor</span> pii <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PaginationInnerInterceptor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pii<span class=\"token punctuation\">.</span><span class=\"token function\">setMaxLimit</span><span class=\"token punctuation\">(</span><span class=\"token number\">20L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        pii<span class=\"token punctuation\">.</span><span class=\"token function\">setDbType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DbType</span><span class=\"token punctuation\">.</span>MYSQL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//当超过最大页数时不会报错</span>\n        pii<span class=\"token punctuation\">.</span><span class=\"token function\">setOverflow</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> pii<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"3mapper_84\"></a>3、创建mapper层</h3>\n<blockquote>\n<p>创建了一个返回实体类<code>TeacherVO</code>，包括老师信息以及学生信息，以及一个传入的参数类<code>TeacherRequestVo</code></p>\n</blockquote>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TeacherVO</span> <span class=\"token punctuation\">{<!-- --></span>\n     <span class=\"token comment\">/**\n     * 跟学生表关联的字段\n     */</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> classs<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> tname<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> tsex<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Date</span> tbirthday<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> prof<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> depart<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Student</span><span class=\"token punctuation\">&gt;</span></span> student<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@Data</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TeacherRequestVo</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> classs<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> tname<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> sname<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TeacherMapper</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseMapper</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Teacher</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">/**\n     * 获取老师所带班级中的所有老师及学生信息\n     * @param page mybatisplus自带的page类\n     * @param teacherRequestVo 传入的参数\n     * @return\n     */</span>\n    <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TeacherVO</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TeacherVO</span><span class=\"token punctuation\">&gt;</span></span> page<span class=\"token punctuation\">,</span> <span class=\"token class-name\">TeacherRequestVo</span> teacherRequestVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"4xxxMapperxml_133\"></a>4、编写xxxMapper.xml文件</h3>\n<pre><code class=\"prism language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resultMap</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GetAllMap<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.demo.entity.vo.TeacherVO<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token comment\">&lt;!--@mbg.generated--&gt;</span>\n    <span class=\"token comment\">&lt;!--@Table teacher--&gt;</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classs<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classs<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tname<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tname<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tsex<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tsex<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tbirthday<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TIMESTAMP<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tbirthday<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Prof<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>prof<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Depart<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>depart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>collection</span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>student<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\">ofType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.demo.entity.Student<span class=\"token punctuation\">\"</span></span>\n                <span class=\"token attr-name\">resultMap</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.consumer.mapper.StudentMapper.BaseResultMap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resultMap</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>getAll<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">resultMap</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GetAllMap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    select *\n    from teacher t\n    left join student s on t.classs = s.classs\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.size != null<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n            and s.size <span class=\"token cdata\">&lt;![CDATA[ &lt;= ]]&gt;</span> #{param2.size}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.classs != null and param2.classs != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n            and t.classs = #{param2.classs}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.sname != null and param2.sname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n            and s.Sname = #{param2.sname}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.tname != null and param2.tname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n            and t.Tname = #{param2.tname}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h3><a id=\"5_173\"></a>5、测试一（不传任何条件，只分页）</h3>\n<blockquote>\n<p>测试结果应该是二条数据，总数是四条</p>\n</blockquote>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/demo\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DemoController</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token annotation punctuation\">@Resource</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">TeacherMapper</span> teacherMapper<span class=\"token punctuation\">;</span>\n\n\n    <span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/test3\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TeacherVO</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">TeacherRequestVo</span> teacherRequestVo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TeacherVO</span><span class=\"token punctuation\">&gt;</span></span> teacherVOPage <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Page</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> teacherMapper<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span>teacherVOPage<span class=\"token punctuation\">,</span> teacherRequestVo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d72578a395ee43ca8c4e98c7d7d810fe.png\"/></p>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">\"records\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"total\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">4</span>,\n    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"current\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>,\n    <span class=\"token string\">\"orders\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"optimizeCountSql\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"searchCount\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"countId\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"maxLimit\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"pages\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h4><a id=\"51_238\"></a>5.1、结果总结</h4>\n<blockquote>\n<p>1、总条数正确</p>\n<p>2、页数正确</p>\n<p><strong>3、<code>数据不正确，返回条数不正确，应该返回两条数据，但现在只返回了一条</code></strong></p>\n</blockquote>\n<h4><a id=\"52_246\"></a>5.2、结果分析</h4>\n<blockquote>\n<p>查看它最终指向的sql语句</p>\n<p>找到在<code>SimpleExecutor</code>下的<code>doQuery</code>方法。</p>\n</blockquote>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0785113c80c04278b92baaa2fddb301c.png\"/></p>\n<blockquote>\n<p><strong>总条数的sql语句为：</strong></p>\n</blockquote>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total <span class=\"token keyword\">FROM</span> teacher t\n</code></pre>\n<blockquote>\n<p><strong>分页语句为：</strong></p>\n</blockquote>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span>\n   <span class=\"token keyword\">from</span> teacher t\n       <span class=\"token keyword\">left</span> <span class=\"token keyword\">join</span> student s <span class=\"token keyword\">on</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>classs <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">2</span>\n</code></pre>\n<blockquote>\n<p><strong>拿去数据库运行结果为：</strong></p>\n</blockquote>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8a98f071ae1d499e8da1e23c71f75182.png\"/></p>\n<blockquote>\n<p><strong>至此可以看出它只是获取了同一个老师下两个不同的学生信息</strong>；</p>\n<p>而不是我们想象的两个老师，分别对应多个学生；</p>\n<p>但总条数和条数正确</p>\n</blockquote>\n<h3><a id=\"6_281\"></a>6、测试二（传两个表的条件）</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\62f52c619bde4ce9bc5ec3fb5294265c.png\"/></p>\n<blockquote>\n<p>得到的结果应该是一个老师对应他下面的两个学生</p>\n<p>总条数是1</p>\n<p>总数是1</p>\n</blockquote>\n<h4><a id=\"61_294\"></a>6.1、测试结果</h4>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">\"records\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"total\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"current\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>,\n    <span class=\"token string\">\"orders\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"optimizeCountSql\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"searchCount\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"countId\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"maxLimit\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"pages\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h4><a id=\"62_338\"></a>6.2、结果总结</h4>\n<blockquote>\n<p>总条数不对</p>\n<p>页数虽然对，但是那是因为我们分页的数量是2，而学生表中正好是一个老师对应两个学生，所以才对，但只要当一个老师对应3个学生或者超过2的话，页数也就不会对了，这里就不给大家测试了，大家可以自行测试一下</p>\n<p>数据虽然看起来对的，但是跟页数是一样的道理，其实是错的</p>\n</blockquote>\n<h4><a id=\"63_346\"></a>6.3、结果分析</h4>\n<blockquote>\n<p>还是查看它最终执行的SQL语句：</p>\n</blockquote>\n<blockquote>\n<p>发现执行查询总条数的SQL语句有问题</p>\n</blockquote>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total <span class=\"token keyword\">FROM</span> teacher t <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> student s <span class=\"token keyword\">ON</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>classs <span class=\"token keyword\">WHERE</span> s<span class=\"token punctuation\">.</span>size <span class=\"token operator\">&lt;=</span> <span class=\"token number\">3</span> <span class=\"token operator\">AND</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> <span class=\"token string\">'804'</span>\n</code></pre>\n<h2><a id=\"_356\"></a>二、解决</h2>\n<blockquote>\n<p>在上面的测试中发现两个问题</p>\n<p>1、数据不对</p>\n<p>2、条数和页数不对</p>\n</blockquote>\n<h3><a id=\"1_364\"></a>1、没条件查询只分页</h3>\n<blockquote>\n<p>我们修改<code>xxxMapper.xml</code>中的<code>resultMap</code>采用级联查询</p>\n</blockquote>\n<pre><code class=\"prism language-xml\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>resultMap</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GetAllMap<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.demo.entity.vo.TeacherVO<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token comment\">&lt;!--@mbg.generated--&gt;</span>\n        <span class=\"token comment\">&lt;!--@Table teacher--&gt;</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classs<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classs<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tname<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tname<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tsex<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tsex<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tbirthday<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>TIMESTAMP<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>tbirthday<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Prof<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>prof<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>result</span> <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Depart<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">jdbcType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>VARCHAR<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>depart<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>collection</span> <span class=\"token attr-name\">property</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>student<span class=\"token punctuation\">\"</span></span>\n                    <span class=\"token attr-name\">ofType</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.demo.entity.Student1<span class=\"token punctuation\">\"</span></span>\n                    <span class=\"token attr-name\">column</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classs<span class=\"token punctuation\">\"</span></span>\n                    <span class=\"token attr-name\">select</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>getStudent<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>resultMap</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>getAll<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">resultMap</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GetAllMap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        select t.*\n        from teacher t\n                     left join student s on t.classs = s.classs\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.size != null<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and s.size <span class=\"token cdata\">&lt;![CDATA[ &lt;= ]]&gt;</span> #{param2.size}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.classs != null and param2.classs != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and t.classs = #{param2.classs}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.sname != null and param2.sname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and s.Sname = #{param2.sname}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.tname != null and param2.tname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and t.Tname = #{param2.tname}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span>\n    \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>getStudent<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">resultMap</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>com.qjj.demo.mapper.Student1Mapper.BaseResultMap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        select *\n        from student\n        where classs = #{classs}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5ec51d1564264bcf8da3b27888664195.png\"/></p>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">\"records\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>,\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"total\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">4</span>,\n    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"current\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>,\n    <span class=\"token string\">\"orders\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"optimizeCountSql\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"searchCount\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"countId\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"maxLimit\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"pages\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"2_481\"></a>2、两个表都有条件</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0c190ad3ceef4764bb698ef7b2536cdf.png\"/></p>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">\"records\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>,\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"804\"</span>,\n            <span class=\"token string\">\"tname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"李诚\"</span>,\n            <span class=\"token string\">\"tsex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n            <span class=\"token string\">\"tbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1958-12-02 00:00:00\"</span>,\n            <span class=\"token string\">\"prof\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"副教授\"</span>,\n            <span class=\"token string\">\"depart\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"计算机系\"</span>,\n            <span class=\"token string\">\"student\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"108\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"丘东\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1977-09-01 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n                <span class=\"token punctuation\">}</span>,\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token string\">\"sno\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"105\"</span>,\n                    <span class=\"token string\">\"sname\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"匡明\"</span>,\n                    <span class=\"token string\">\"ssex\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"男\"</span>,\n                    <span class=\"token string\">\"sbirthday\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1975-10-02 00:00:00\"</span>,\n                    <span class=\"token string\">\"classs\"</span><span class=\"token builtin class-name\">:</span> null,\n                    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"total\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"size\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>,\n    <span class=\"token string\">\"current\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>,\n    <span class=\"token string\">\"orders\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"optimizeCountSql\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"searchCount\"</span><span class=\"token builtin class-name\">:</span> true,\n    <span class=\"token string\">\"countId\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"maxLimit\"</span><span class=\"token builtin class-name\">:</span> null,\n    <span class=\"token string\">\"pages\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"3_554\"></a>3、结果总结</h3>\n<ol><li> <p><strong>无条件时</strong></p>\n<blockquote>\n<p>数量正确，数据重复，页数正确</p>\n</blockquote> </li><li> <p><strong>两表都有条件时：</strong></p>\n<blockquote>\n<p>总数不对，数据重复，页数不正确</p>\n</blockquote> </li></ol>\n<h3><a id=\"4_564\"></a>4、结果分析</h3>\n<blockquote>\n<p>查看最终sql语句</p>\n</blockquote>\n<blockquote>\n<p>查询总条数的SQL语句：</p>\n</blockquote>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> total <span class=\"token keyword\">FROM</span> teacher t <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> student s <span class=\"token keyword\">ON</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>classs <span class=\"token keyword\">WHERE</span> s<span class=\"token punctuation\">.</span>size <span class=\"token operator\">&lt;=</span> ? <span class=\"token operator\">AND</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> ?\n</code></pre>\n<blockquote>\n<p>查询老师表的SQL语句：</p>\n</blockquote>\n<pre><code class=\"prism language-sql\">  <span class=\"token keyword\">select</span> t<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span>\n        <span class=\"token keyword\">from</span> teacher t\n              <span class=\"token keyword\">left</span> <span class=\"token keyword\">join</span> student s <span class=\"token keyword\">on</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>classs\n        <span class=\"token keyword\">WHERE</span> s<span class=\"token punctuation\">.</span>size  <span class=\"token operator\">&lt;=</span> <span class=\"token number\">3</span>\n        <span class=\"token operator\">and</span> t<span class=\"token punctuation\">.</span>classs <span class=\"token operator\">=</span> <span class=\"token string\">\"804\"</span> <span class=\"token keyword\">LIMIT</span> <span class=\"token number\">2</span>\n</code></pre>\n<blockquote>\n<p>去数据库执行发现查询老师表的sql语句查出两条相同结果</p>\n</blockquote>\n<p>其实到这里很多人都知道怎么解决了，只要去除重复的数据，所有问题都可以解决，无论是用去重，还是<code>GROUP BY</code>都可以实现，我下面采用<code>GROUP BY</code></p>\n<h3><a id=\"5_588\"></a>5、最终方案</h3>\n<blockquote>\n<p>加上<code>GROUP BY</code>进行去重，其他地方都没改动</p>\n</blockquote>\n<pre><code class=\"prism language-xml\"> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>select</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>getAll<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">resultMap</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>GetAllMap<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        select t.classs,\n               t.Tname,\n               t.Tsex,\n               t.Tbirthday,\n               t.Prof,\n               t.Depart\n        from teacher t\n                     left join student s on t.classs = s.classs\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.size != null<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and s.size <span class=\"token cdata\">&lt;![CDATA[ &lt;= ]]&gt;</span> #{param2.size}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.classs != null and param2.classs != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and t.classs = #{param2.classs}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.sname != null and param2.sname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and s.Sname = #{param2.sname}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>if</span> <span class=\"token attr-name\">test</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>param2.tname != null and param2.tname != <span class=\"token punctuation\">'</span><span class=\"token punctuation\">'</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                and t.Tname = #{param2.tname}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>if</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>where</span><span class=\"token punctuation\">&gt;</span></span>\n        GROUP BY t.classs\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>select</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h4><a id=\"51_620\"></a>5.1、坑</h4>\n<p><code>进行分组的字段必须是主键</code>，不然会报错</p>\n<blockquote>\n<p>这里就不给大家展示测试结果了，没必要了，大家可自行测试</p>\n</blockquote>\n<blockquote>\n<p>到这里问题完美解决</p>\n</blockquote>\n<h2><a id=\"_629\"></a>三、结束语</h2>\n<p>本人写过的所有解决什么问题都是项目中花了超过1个多小时才解决的问题，希望这篇文章对同学们有所帮助，<code>不喜勿喷</code>，有任何问题都可以评论，最后送上我的两句座右铭：</p>\n<blockquote>\n<p><strong>任何人都不会在意你成功的过程,只在意你成功的结果,在你没有成功之前,切勿向别人强调过程；</strong></p>\n</blockquote>\n<blockquote>\n<p><strong>请不要假装努力，结果不会陪你演戏；</strong></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 0, "time": "2022-06-22 14:22:22", "summary": "文章目录前言一、问题说明、引入依赖、配置、创建层、编写文件、测试一不传任何条件，只分页、结果总结、结果分析、测试二传两个表的条件、测试结果、结果总结、结果分析二、解决、没条件查询只分页、两个表都有条件"}