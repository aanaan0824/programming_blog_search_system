{"blogid": "126619423", "writerAge": "码龄4年", "writerBlogNum": "164", "writerCollect": "4596", "writerComment": "2529", "writerFan": "25615", "writerGrade": "6级", "writerIntegral": "8079", "writerName": "fanstuck", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126619423.jpg", "writerRankTotal": "1632", "writerRankWeekly": "25", "writerThumb": "2607", "writerVisitNum": "326909", "blog_read_count": "579", "blog_time": "已于 2022-08-31 15:58:47 修改", "blog_title": "猿创征文｜时间序列分析算法之平稳时间序列预测算法和自回归模型(AR)详解+Python代码实现", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E5%89%8D%E8%A8%80-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%89%8D%E8%A8%80\">前言</a></p>\n<p id=\"%E4%B8%80%E3%80%81%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B%E7%AE%97%E6%B3%95-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%B8%80%E3%80%81%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B%E7%AE%97%E6%B3%95\">一、平稳时间序列预测算法</a></p>\n<p id=\"1.%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%9A%84%E5%88%86%E5%B8%83%E3%80%81%E5%9D%87%E5%80%BC%E5%92%8C%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:40px;\"><a href=\"#1.%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%9A%84%E5%88%86%E5%B8%83%E3%80%81%E5%9D%87%E5%80%BC%E5%92%8C%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0\">1.时间序列的分布、均值和协方差函数</a></p>\n<p id=\"%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83-toc\" style=\"margin-left:80px;\"><a href=\"#%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83\">概率分布</a></p>\n<p id=\"%E5%9D%87%E5%80%BC%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%9D%87%E5%80%BC%E5%87%BD%E6%95%B0\">均值函数</a></p>\n<p id=\"%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0\">自协方差函数</a></p>\n<p id=\"%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0\">自相关函数</a></p>\n<p id=\"2.%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:40px;\"><a href=\"#2.%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0\">2.平稳序列的自协方差和自相关函数</a></p>\n<p id=\"%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0\">自协方差函数</a></p>\n<p id=\"%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0\">自相关函数</a></p>\n<p id=\"%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%BA%8F%E5%88%97%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%E5%88%97%E7%9A%84%E6%80%A7%E8%B4%A8-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%BA%8F%E5%88%97%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%E5%88%97%E7%9A%84%E6%80%A7%E8%B4%A8\">平稳序列的自协方差序列和自相关函数列的性质</a></p>\n<p id=\"3.%E4%B8%A5%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97-toc\" style=\"margin-left:40px;\"><a href=\"#3.%E4%B8%A5%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97\">3.严平稳时间序列</a></p>\n<p id=\"4.%E5%AE%BD%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97-toc\" style=\"margin-left:40px;\"><a href=\"#4.%E5%AE%BD%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97\">4.宽平稳时间序列</a></p>\n<p id=\"5.%E8%81%94%E7%B3%BB%E5%92%8C%E5%8C%BA%E5%88%AB-toc\" style=\"margin-left:40px;\"><a href=\"#5.%E8%81%94%E7%B3%BB%E5%92%8C%E5%8C%BA%E5%88%AB\">5.联系和区别</a></p>\n<p id=\"%E8%81%94%E7%B3%BB-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%81%94%E7%B3%BB\">联系</a></p>\n<p id=\"%E5%8C%BA%E5%88%AB-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%8C%BA%E5%88%AB\">区别</a></p>\n<p id=\"6.%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97-toc\" style=\"margin-left:40px;\"><a href=\"#6.%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97\">6.白噪声序列</a></p>\n<p id=\"%E5%AE%9A%E4%B9%89-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%AE%9A%E4%B9%89\">定义</a></p>\n<p id=\"7.%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83%E5%BA%8F%E5%88%97-toc\" style=\"margin-left:40px;\"><a href=\"#7.%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83%E5%BA%8F%E5%88%97\">7.独立同分布序列</a></p>\n<p id=\"%E5%AE%9A%E4%B9%89-toc\" style=\"margin-left:80px;\"><a href=\"#%E5%AE%9A%E4%B9%89\">定义</a></p>\n<p id=\"%E4%BA%8C%E3%80%81%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B(Autoregressive%20model%2C%E7%AE%80%E7%A7%B0AR)-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%BA%8C%E3%80%81%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B%28Autoregressive%20model%2C%E7%AE%80%E7%A7%B0AR%29\">二、自回归模型(Autoregressive model,简称AR)</a></p>\n<p id=\"%E5%AE%9A%E4%B9%89-toc\" style=\"margin-left:40px;\"><a href=\"#%E5%AE%9A%E4%B9%89\">定义</a></p>\n<p id=\"%E5%BB%BA%E6%A8%A1%E6%AD%A5%E9%AA%A4-toc\" style=\"margin-left:40px;\"><a href=\"#%E5%BB%BA%E6%A8%A1%E6%AD%A5%E9%AA%A4\">建模步骤</a></p>\n<p id=\"%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A\">第一步：</a></p>\n<p id=\"%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A\">第二步：</a></p>\n<p id=\"%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A\">第三步：</a></p>\n<p id=\"%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A\">第四步：</a></p>\n<p id=\"%E6%A8%A1%E5%9E%8B%E5%88%A4%E5%AE%9A-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%A8%A1%E5%9E%8B%E5%88%A4%E5%AE%9A\">模型判定</a></p>\n<p id=\"%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0-toc\" style=\"margin-left:40px;\"><a href=\"#%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0\">案例实现</a></p>\n<p id=\"%E7%82%B9%E5%85%B3%E6%B3%A8%EF%BC%8C%E9%98%B2%E8%B5%B0%E4%B8%A2%EF%BC%8C%E5%A6%82%E6%9C%89%E7%BA%B0%E6%BC%8F%E4%B9%8B%E5%A4%84%EF%BC%8C%E8%AF%B7%E7%95%99%E8%A8%80%E6%8C%87%E6%95%99%EF%BC%8C%E9%9D%9E%E5%B8%B8%E6%84%9F%E8%B0%A2-toc\" style=\"margin-left:40px;\"><a href=\"#%E7%82%B9%E5%85%B3%E6%B3%A8%EF%BC%8C%E9%98%B2%E8%B5%B0%E4%B8%A2%EF%BC%8C%E5%A6%82%E6%9C%89%E7%BA%B0%E6%BC%8F%E4%B9%8B%E5%A4%84%EF%BC%8C%E8%AF%B7%E7%95%99%E8%A8%80%E6%8C%87%E6%95%99%EF%BC%8C%E9%9D%9E%E5%B8%B8%E6%84%9F%E8%B0%A2\">点关注，防走丢，如有纰漏之处，请留言指教，非常感谢</a></p>\n<p id=\"%E5%8F%82%E9%98%85-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%8F%82%E9%98%85\">参阅</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<hr/>\n<h1 id=\"%E5%89%8D%E8%A8%80\"><a id=\"_7\"></a>前言</h1>\n<p>平滑法花费了将近一个月的时间去讲解和模拟算法，讲解的非常详细了我个人认为，而且代码和原理理解起来也相对简单，代码实现起来也几乎没有什么难度。若是没有大家想要详细了解或者掌握时间序列分析算法的建议可以订阅本人专栏：<a class=\"link-info\" href=\"https://blog.csdn.net/master_hunter/category_10967944.html?spm=1001.2014.3001.5482\" title=\"一文速学-数学建模常用模型\">一文速学-数学建模常用模型</a>。里面涉及到各个场景的分析和预测模型基本都具备了，其中平滑法的所有方法：</p>\n<p><img alt=\"\" height=\"422\" src=\"..\\..\\static\\image\\311eea624db7490aa9c24c0961db8658.png\" width=\"983\"/></p>\n<p>都包含其中。接下来我们要对平稳时间序列预测算法进行研究和推导。但是平稳时间序列预测算法的基础理论还是蛮多蛮复杂的，需要我们对基础理论有了一定认知才能更轻松的掌握该算法。故我们的开篇第一章先将理论知识全部了解一遍。</p>\n<p>希望读者看完能够在评论区提出错误或者看法，博主会长期维护博客做及时更新。</p>\n<hr/>\n<h1 id=\"%E4%B8%80%E3%80%81%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E9%A2%84%E6%B5%8B%E7%AE%97%E6%B3%95\">一、平稳时间序列预测算法</h1>\n<p>这里的平稳是指<strong>宽平稳</strong>，其特性是序列的统计特性不随时间的平移而变化，即<strong>均值和协方差不随时间的平移而变化</strong>。 时间序列是指将某种现象某一个统计指标在不同时间上的各个数值，按时间先后顺序排列而形成的序列。平稳时间序列粗略地讲，一个时间序列，如果均值没有系统的变化（无趋势）、方差没有系统变化，且严格消除了周期性变化，就称之是平稳的。</p>\n<p>平稳时间序列是时间序列分析中最重要的特殊类型。到目前为止，时间序列分析基本上是以平稳时间序列为基础的，对于非平稳时间序列的统计分析，其方法和理论都很有局限性。</p>\n<p>这里我们需要了解关于时间序列的基本属性以及相应点的分布：</p>\n<h2 id=\"1.%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E7%9A%84%E5%88%86%E5%B8%83%E3%80%81%E5%9D%87%E5%80%BC%E5%92%8C%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0\"><span style=\"color:#0d0016;\"><strong>1.时间序列的分布、均值和协方差函数</strong></span></h2>\n<h3 id=\"%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83\">概率分布</h3>\n<p>由于确定时间序列的分布函数一般不可能，人们更加注意使用时间序列的各种特征量的描述，如均值函数、协方差函数、自相关函数、偏自相关函数等，这些特征量往往能代表随机变量的主要特征。</p>\n<h3 id=\"%E5%9D%87%E5%80%BC%E5%87%BD%E6%95%B0\">均值函数</h3>\n<p>一个时间序列<img alt=\"\\left \\{ X_{t},t=0,t=(-1,1),t=(-2,2),..., \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%2Ct%3D0%2Ct%3D%28-1%2C1%29%2Ct%3D%28-2%2C2%29%2C...%2C%20%5Cright%20%5C%7D\"/>的均值函数指：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"77\" src=\"..\\..\\static\\image\\99a22ad996824fafbf373ff7a5ad0f92.png\" width=\"275\"/></p>\n<p> <img alt=\"\\mu _{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cmu%20_%7Bt%7D\"/>即为<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>的均值函数，它实质上是一个实数列，均值表示随机过程在各个时刻的摆动中心。</p>\n<h3 id=\"%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%87%BD%E6%95%B0\">自协方差函数</h3>\n<p><img alt=\"\" height=\"67\" src=\"..\\..\\static\\image\\ce1f48ebceab4488b530da87b9de7624.png\" width=\"575\"/></p>\n<p> 对称性:<img alt=\"\\gamma (t,s)=\\gamma (s,t)\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cgamma%20%28t%2Cs%29%3D%5Cgamma%20%28s%2Ct%29\"/></p>\n<h3 id=\"%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0\">自相关函数</h3>\n<p class=\"img-center\"><img alt=\"\" height=\"81\" src=\"..\\..\\static\\image\\16dbcb541c764776844ead2e6e8bc3eb.png\" width=\"219\"/></p>\n<p> 自相关函数描述了时间序列的<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>自身的相关结构。时间序列的自相关函数具有对称性，且有<img alt=\"p(t,t)=1\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?p%28t%2Ct%29%3D1\"/></p>\n<h2 id=\"2.%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0\">2.平稳序列的自协方差和自相关函数</h2>\n<h3>自协方差函数</h3>\n<p>若<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>为平稳序列，假定<img alt=\"EX_{t}=0\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?EX_%7Bt%7D%3D0\"/>,则我们可以用以下记号表示平稳序列的自协方差函数：</p>\n<p><img alt=\"\" height=\"55\" src=\"..\\..\\static\\image\\fc47bd54a4774524b04461b86f3a7c66.png\" width=\"412\"/></p>\n<h3>自相关函数</h3>\n<p> 相应的，严平稳序列的自相关函数记为:</p>\n<p class=\"img-center\"><img alt=\"\" height=\"76\" src=\"..\\..\\static\\image\\cc7d9c55ef77423f9b615384fbb47713.png\" width=\"115\"/></p>\n<h3 id=\"%E5%B9%B3%E7%A8%B3%E5%BA%8F%E5%88%97%E7%9A%84%E8%87%AA%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%BA%8F%E5%88%97%E5%92%8C%E8%87%AA%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%E5%88%97%E7%9A%84%E6%80%A7%E8%B4%A8\"><span style=\"color:#0d0016;\">平稳序列的自协方差序列和自相关函数列的性质</span></h3>\n<p class=\"img-center\"><img alt=\"\" height=\"76\" src=\"..\\..\\static\\image\\0af2c757a14b4e7199696295c41e1eaa.png\" width=\"247\"/></p>\n<p>平稳时间序列分为严平稳时间序列与宽平稳时间序列。</p>\n<h2 id=\"3.%E4%B8%A5%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97\">3.严平稳时间序列</h2>\n<p>若对于时间t的任意n个值<img alt=\"t_{1}&lt;t_{2}&lt;...&lt;t_{n}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?t_%7B1%7D%3Ct_%7B2%7D%3C...%3Ct_%7Bn%7D\"/>，序列中的随机变量<img alt=\"X_{t_{1}+S},X_{t_{2}+S}...,X_{t_{n}+S}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt_%7B1%7D&amp;plus;S%7D%2CX_%7Bt_%7B2%7D&amp;plus;S%7D...%2CX_%7Bt_%7Bn%7D&amp;plus;S%7D\"/>联合分布与整数S无关，即有：</p>\n<p><img alt=\"\" height=\"47\" src=\"..\\..\\static\\image\\f7eb6f5b98bb4d67a79af0bb38b7dd8a.png\" width=\"644\"/></p>\n<p>则称<img alt=\"X_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt%7D\"/>为严平稳/狭义平稳/强平稳时间序列。严平稳的概率分布与时间无关。</p>\n<h2 id=\"4.%E5%AE%BD%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97\">4.宽平稳时间序列</h2>\n<p>如时间序列有有穷的二阶矩阵，且<img alt=\"X_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt%7D\"/>满足以下两个条件：</p>\n<p><img alt=\"\" height=\"59\" src=\"..\\..\\static\\image\\4a98e6c0f9204a5f83be468874fa9828.png\" width=\"368\"/></p>\n<p>则称该时间序列为宽平稳过程。<br/> 宽平稳过程各随机变量的均值为常数，且任意两个变量的协方差仅与时间间隔<img alt=\"(t-s)\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%28t-s%29\"/>有关。</p>\n<h2 id=\"5.%E8%81%94%E7%B3%BB%E5%92%8C%E5%8C%BA%E5%88%AB\"><span style=\"color:#0d0016;\">5.联系和区别</span></h2>\n<h3 id=\"%E8%81%94%E7%B3%BB\">联系</h3>\n<ul><li>若一个序列为严平稳序列，且有有穷的二阶矩阵，那么该序列也必为宽平稳序列。</li><li>若时间序列为<strong>正态序列</strong>(即它的任何有限维分布都是正态分布)，那么该序列为严平稳序列和宽平稳序列是相互等价的。</li></ul>\n<h3 id=\"%E5%8C%BA%E5%88%AB\">区别</h3>\n<ul><li>严平稳的概率分布随时间的平移而不变，宽平稳序列的均值和自协方差随时间的平移而不变。</li><li>一个严平稳序列，不一定是宽平稳序列;一个宽平稳序列也不一定是严平稳序列。</li></ul>\n<p>实际中讨论的平稳时间序列是宽平稳时间序列，指对任意时间下，序列的均值、方差存在并为常数，且自协方差函数与自相关系数只与时间间隔k有关。只有平稳时间序列才可以进行统计分析，因为平稳性保证了时间序列数据都是出自同一分布。可以使用单位根检验来检验时间序列的平稳性。</p>\n<p>若一个平稳时间序列的序列值之间没有相关性，那么就意味着这种数据前后没有规律，也就无法挖掘出有效的信息，这种序列称为纯随机序列。在纯随机序列中，有一种序列称为白噪声序列，这种序列随机且各期的方差一致。平稳时间序列分析在于充分挖掘时间序列之间的关系，<strong>当时间序列中的关系被提取出来后，剩下的序列就应该是个白噪声序列</strong>。</p>\n<h2 id=\"6.%E7%99%BD%E5%99%AA%E5%A3%B0%E5%BA%8F%E5%88%97\">6.白噪声序列</h2>\n<h3 id=\"%E5%AE%9A%E4%B9%89\">定义</h3>\n<p>若时间序列<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>满足下列性质：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"112\" src=\"..\\..\\static\\image\\a01e18e5e3ab461bb0fbe182474afeda.png\" width=\"250\"/></p>\n<p> 则称此序列为白噪声序列。<br/> 白噪声序列是一种特殊的宽平稳序列，也是一种最简单的平稳序列。</p>\n<h2 id=\"7.%E7%8B%AC%E7%AB%8B%E5%90%8C%E5%88%86%E5%B8%83%E5%BA%8F%E5%88%97\">7.<span style=\"color:#0d0016;\">独立同分布序列</span></h2>\n<h3>定义</h3>\n<p>如果时间序列<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>中的随机变量<img alt=\"X_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt%7D\"/>是相互独立的随机变量，且<img alt=\"X_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt%7D\"/>具有相同的分布（当<img alt=\"X_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?X_%7Bt%7D\"/>有一阶矩时，往往还假定<img alt=\"EX_{t}=0\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?EX_%7Bt%7D%3D0\"/>),则称<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>为独立同分布序列。</p>\n<p> 独立同分布序列<img alt=\"\\left \\{ X_{t} \\right \\}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20X_%7Bt%7D%20%5Cright%20%5C%7D\"/>是一个严平稳序列<br/> 一般来说，白噪声序列与独立同分布序列是不同的两种序列。<br/> 但是<span style=\"color:#008000;\">当</span><span style=\"color:#0d0016;\"><strong>白噪声序列为正态序列时，它也是独立同分布序列，此时我们称其为正态白噪声序列。</strong></span></p>\n<h1 id=\"%E4%BA%8C%E3%80%81%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B(Autoregressive%20model%2C%E7%AE%80%E7%A7%B0AR)\"><a id=\"_19\"></a>二、自回归模型(Auto<strong>r</strong>egressive model,简称AR)</h1>\n<h2>定义</h2>\n<p>自回归模型是统计上一种处理时间序列的方法，用同一变数例如x的之前各期，亦即<img alt=\"x_{1}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?x_%7B1%7D\"/>至<img alt=\"x_{t-1}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?x_%7Bt-1%7D\"/>来预测本期<img alt=\"x_{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?x_%7Bt%7D\"/>的表现，并假设它们为一线性关系。因为这是从回归分析中的线性回归发展而来，只是不用x预测y，而是用x预测 x(自己);所以叫做<strong>自回归</strong>。</p>\n<p>p阶自回归模型的自相关系数拖尾，偏自相关系数p阶截尾。</p>\n<p class=\"img-center\"><img alt=\"\" height=\"66\" src=\"..\\..\\static\\image\\b9ccf1fec6d242dc8baf20e3cfcc29f5.png\" width=\"208\"/></p>\n<p> 其中:c是常数项；<img alt=\"\\varepsilon _{t}\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Cvarepsilon%20_%7Bt%7D\"/>被假设为平均数等于0，标准差等于<img alt=\"\\sigma\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Csigma\"/>的随机误差值；<img alt=\"\\sigma\" class=\"mathcode\" src=\"https://latex.codecogs.com/gif.latex?%5Csigma\"/>被假设为对于任何的t都不变。</p>\n<p> 文字叙述为：X的期望值等于一个或数个落后期的线性组合，加常数项，加随机误差。</p>\n<h2 id=\"%E5%BB%BA%E6%A8%A1%E6%AD%A5%E9%AA%A4\">建模步骤</h2>\n<h3 id=\"%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A\">第一步：</h3>\n<p>对时间蓄力进行白噪音检测，若经检验判定序列为白噪声，则这种数据前后没有规律，也就无法挖掘出有效的信息。只有检测不是白噪音序列才能继续。</p>\n<h3 id=\"%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A\">第二步：</h3>\n<p>对序列作平稳性检验，若经检验判定为非平稳，则进行序列的平稳化处理，转第一步；否则转第三步；</p>\n<h3 id=\"%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A\">第三步：</h3>\n<p>对模型进行识别，估计其参数，转第四步；</p>\n<h3 id=\"%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A\">第四步：</h3>\n<p>检验模型的适用性，若检验通过，则得到拟合模型并可对序列做预测；否则转第三步；</p>\n<h2 id=\"%E6%A8%A1%E5%9E%8B%E5%88%A4%E5%AE%9A\">模型判定</h2>\n<p>对于观测到的时间序列，若通过白噪音检测确定是非白噪音，且经平稳性检验后确定为平稳后，常根据相关系数和偏相关系数来识别模型。判断该问题是否适用AR模型建模，以及大致确定阶数p。</p>\n<p>通过计算<strong>自相关系数SAF</strong>，和<strong>偏相关系数</strong><strong>PACF</strong>。</p>\n<p>如果一个时间序列满足以下两个条件:</p>\n<ul><li>ACF 具有拖尾性，即 ACF(k) 不会在 k 大于某个常数之后就恒等于 0。</li><li>PACF 具有截尾性，即 PACF(k) 在 k&gt;p 时变为 0。（<strong>用来确定阶数， PACF 在 p 阶延迟后未必严格为 0 ，而是在 0 附近的小范围内波动</strong>）</li></ul>\n<p>那么就可以尝试使用AR模型。</p>\n<h2 id=\"%E6%A1%88%E4%BE%8B%E5%AE%9E%E7%8E%B0\">案例实现</h2>\n<p>Python中用statsmodels.tsa.ar_model包中的AutoReg来实现自回归。</p>\n<pre><code class=\"language-python\">from statsmodels.tsa.ar_model import AutoReg</code></pre>\n<p> 该类函数参数为：</p>\n<pre><code class=\"language-python\">ar_model = AutoReg(endog,\n                   lags,\n                   trend='c',\n                   seasonal=False,\n                   exog=None,\n                   hold_back=None,\n                   period=None,\n                   missing='none',\n                   *,\n                   deterministic=None,\n                   old_names=False)</code></pre>\n<p>这里不展开一一讲解，想要详细了解的可以去看官方解释:</p>\n<p><a href=\"https://www.statsmodels.org/dev/generated/statsmodels.tsa.ar_model.AutoReg.html#statsmodels.tsa.ar_model.AutoReg\" title=\"statsmodels.tsa.ar_model.AutoReg — statsmodels\">statsmodels.tsa.ar_model.AutoReg — statsmodels</a></p>\n<p>通常情况下只需要输入序列endog和阶数lags：</p>\n<p>endog:接受类型为数组类型，一维时间序列。</p>\n<p>lags:模型阶数，如果是整数，则模型中包含的滞后数或要包含的滞后指数列表。例如，[1，4]将只包括lags为1和4，而lags=4将包括滞后1、2、3和4。</p>\n<pre><code class=\"language-python\">from statsmodels.tsa.ar_model import AutoReg\nimport numpy as np\n \n# 生成N(0,1)随机正态分布（白噪声）\nnoise = np.random.randn(200)\nwnoise = (noise-np.mean(noise))/np.std(noise)\n \n# 生成AR(2)线性序列 X(t)=0.5X(t-1)+0.1X(t-2)\nX = [20,10]  # 初值\nfor i in range(200):\n    x2 = 0.5*X[i+1]+0.1*X[i]+wnoise[i]\n    X.append(x2)\n \n# 2阶AR模型拟合（OLS）\nAR2_model = AutoReg(X, 2).fit()  \n# 模型预测第3到第202个时间点的数据\npredict = AR2_model.predict(2,201)  \n# 计算残差\nresidual = X[2:]-predict</code></pre>\n<p>我们模拟生成了AR线性蓄力之后，再进行AR2阶拟合得到预测值，之后使用matplotlib展示 ：</p>\n<pre><code class=\"language-python\">import matplotlib.pyplot as plt\nplt.figure()\nplt.subplot(311)\nplt.plot(X[2:])\nplt.subplot(312)\nplt.plot(predict)\nplt.subplot(313)\nplt.plot(residual)</code></pre>\n<p> <img alt=\"\" height=\"394\" src=\"..\\..\\static\\image\\b052d2ef1483463393862554741e1277.png\" width=\"591\"/></p>\n<hr/>\n<h2 id=\"%E7%82%B9%E5%85%B3%E6%B3%A8%EF%BC%8C%E9%98%B2%E8%B5%B0%E4%B8%A2%EF%BC%8C%E5%A6%82%E6%9C%89%E7%BA%B0%E6%BC%8F%E4%B9%8B%E5%A4%84%EF%BC%8C%E8%AF%B7%E7%95%99%E8%A8%80%E6%8C%87%E6%95%99%EF%BC%8C%E9%9D%9E%E5%B8%B8%E6%84%9F%E8%B0%A2\">点关注，防走丢，<strong>如有纰漏之处，请留言指教，非常感谢</strong></h2>\n<p>以上就是本期全部内容。我是fanstuck ，有问题大家随时留言讨论 ，我们下期见。</p>\n<p></p>\n<h1 id=\"%E5%8F%82%E9%98%85\">参阅</h1>\n<p><a href=\"https://blog.csdn.net/qq_45669448/article/details/104202262?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166191173516782425159483%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166191173516782425159483&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-104202262-null-null.142%5Ev42%5Epc_rank_34,185%5Ev2%5Econtrol&amp;utm_term=%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97&amp;spm=1018.2226.3001.4187\" title=\"平稳时间序列的相关概念_someday or one day的博客-CSDN博客_平稳时间序列\">平稳时间序列的相关概念_someday or one day的博客-CSDN博客_平稳时间序列</a></p>\n<p><a href=\"https://blog.csdn.net/hzk427/article/details/106984395?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166191173516782425159483%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166191173516782425159483&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-106984395-null-null.142%5Ev42%5Epc_rank_34,185%5Ev2%5Econtrol&amp;utm_term=%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97&amp;spm=1018.2226.3001.4187\" title=\"（五十一）时间序列分析二：平稳时间序列分析（ARMA）_小粉桥反手王的博客-CSDN博客_平稳时间序列\">（五十一）时间序列分析二：平稳时间序列分析（ARMA）_小粉桥反手王的博客-CSDN博客_平稳时间序列</a><a href=\"https://blog.csdn.net/qq_29831163/article/details/89448959\" title=\"时间序列模型 （六）：平稳时间序列模型 ：自回归AR 、移动平均 MA 、ARMA 模型_wamg潇潇的博客-CSDN博客_平稳时间序列模型\">时间序列模型 （六）：平稳时间序列模型 ：自回归AR 、移动平均 MA 、ARMA 模型_wamg潇潇的博客-CSDN博客_平稳时间序列模型</a><br/><a href=\"https://baike.baidu.com/item/%E5%B9%B3%E7%A8%B3%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/12722171?fr=aladdin\" title=\"平稳时间序列_百度百科\">平稳时间序列_百度百科</a></p>\n<p><a href=\"https://blog.csdn.net/qq_43578520/article/details/124109755?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166192751116780357297388%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=166192751116780357297388&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124109755-null-null.142%5Ev42%5Epc_rank_34&amp;utm_term=%E8%87%AA%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8Bpython%E4%BB%A3%E7%A0%81&amp;spm=1018.2226.3001.4187\" title=\"自回归模型AR(p)的python实现【案例】_Noema_pku的博客-CSDN博客_python自回归模型\">自回归模型AR(p)的python实现【案例】_Noema_pku的博客-CSDN博客_python自回归模型</a></p>\n<p><a href=\"https://zhuanlan.zhihu.com/p/435442095\" title=\"时间序列分析—自回归（AR） - 知乎瓷片\">时间序列分析—自回归（AR） - 知乎瓷片</a></p>\n</div>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-08-31 15:58:47", "summary": "目录前言一、平稳时间序列预测算法时间序列的分布、均值和协方差函数概率分布均值函数自协方差函数自相关函数平稳序列的自协方差和自相关函数自协方差函数自相关函数平稳序列的自协方差序列和自相关函数列的性质严平"}