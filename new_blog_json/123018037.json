{"blogid": "123018037", "writerAge": "码龄3年", "writerBlogNum": "15", "writerCollect": "207", "writerComment": "56", "writerFan": "1325", "writerGrade": "3级", "writerIntegral": "644", "writerName": "荥阳兔兔", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123018037.jpg", "writerRankTotal": "111695", "writerRankWeekly": "82078", "writerThumb": "66", "writerVisitNum": "57203", "blog_read_count": "4731", "blog_time": "已于 2022-02-19 18:34:12 修改", "blog_title": "Unity Emoji表情（图文混排）2022最详细教程", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_6\">前言</a></li><li><a href=\"#emoji_14\">一、emoji是什么？</a></li><li><ul><li><ul><li><a href=\"#font_color999AAA_emoji__17\"><font color=\"#999AAA\">emoji （日本在无线通信中所使用的视觉情感符号）</font></a></li></ul>\n</li></ul>\n</li><li><a href=\"#_27\">二、使用步骤</a></li><li><ul><li><a href=\"#1_28\">1.将源码文件导入自己的项目中</a></li><li><ul><li><a href=\"#EditorEmojiAtlasBakerEditor_29\">步骤一：将Editor目录文件EmojiAtlasBaker移入到自己的项目Editor目录下</a></li><li><a href=\"#Icon_EmojiAtlas__QQIconAtlasxml_31\">步骤二、导入Icon到自己项目中 (EmojiAtlas 跟 QQIconAtlas可先删除掉，步骤五可生成图集及xml文件)</a></li><li><a href=\"#EmojiEffectEmojiTextManagerScript_40\">步骤三、导入EmojiEffect跟EmojiTextManager脚本到项目Script目录下</a></li><li><a href=\"#Xml_42\">步骤四、在项目根目录下创建Xml文件夹，下面的两个文件是步骤五生成的文件，用于获取图集名称及信息</a></li><li><a href=\"#UnityToolBake_Emoji_Atlas_44\">步骤五、在Unity选线栏Tool-&gt;Bake Emoji Atlas会有这个选项，单击这个选项，会弹出以下界面（打包图集）</a></li></ul>\n</li><li><a href=\"#2_64\">2.实际应用</a></li><li><ul><li><a href=\"#XML_65\">一、在初始化时读取调用XML文件</a></li><li><a href=\"#_133\">二、服务器回调用户信息</a></li><li><a href=\"#_168\">三、获取数据进行处理演示</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_237\">三、项目运用后效果</a></li><li><a href=\"#_262\">四、每天一心灵鸡汤</a></li></ul>\n</div>\n<p></p>\n<hr color=\"#000000\" size='1\"'/>\n<h1><a id=\"_6\"></a>前言</h1>\n<p><font color=\"#999AAA\">在忙完项目以后，我又回来了，利用一些时间和心力去总结和思考一些东西。最近项目中玩家通过微信登录，登录后的微信昵称含有emoji表情，这样直接使用会显示乱码，C#无法直接处理，网上也没有比较好的解决方案，刚好找到了图文混排开源demo，顺便优化了一下脚本。</font></p>\n<hr color=\"#000000\" size='1\"'/>\n<p><font color=\"#999AAA\">提示：以下是本篇文章正文内容，下面案例可供参考</font></p>\n<h1><a id=\"emoji_14\"></a>一、emoji是什么？</h1>\n<h3><a id=\"font_color999AAA_emoji__17\"></a><font color=\"#999AAA\">emoji （日本在无线通信中所使用的视觉情感符号）</font></h3>\n<p><font color=\"#00f\"><strong>绘文字（日语：絵文字/えもじ emoji）是日本在无线通信中所使用的视觉情感符号，绘指图画，文字指的则是字符，可用来代表多种表情，如笑脸表示笑、蛋糕表示食物等。在中国大陆，emoji通常叫做“小黄脸”，或者直称emoji</strong></font></p>\n<p><font color=\"#ff00\"><strong>在NTTDoCoMo的i-mode系统电话系统中，绘文字的尺寸是12x12 像素，在传送时，一个图形有2个字节。Unicode编码为E63E到E757，而在Shift-JIS编码则是从F89F到F9FC。基本的绘文字共有176个符号，在C-HTML4.0的编程语言中，则另增添了76个情感符号。</strong></font></p>\n<p><font color=\"#FF60AF\"><strong>自苹果公司发布的iOS 5输入法中加入了emoji后，这种表情符号开始席卷全球，emoji已被大多数现代计算机系统所兼容的Unicode编码采纳，普遍应用于各种手机短信和社交网络中。</strong></font></p>\n<p><a href=\"https://apps.timwhitlock.info/emoji/tables/unicode#block-6b-additional-transport-and-map-symbols\"><font color=\"#ff00\"><strong>表情符号Unicode表官网</strong></font></a></p>\n<h1><a id=\"_27\"></a>二、使用步骤</h1>\n<h2><a id=\"1_28\"></a>1.将源码文件导入自己的项目中</h2>\n<h3><a id=\"EditorEmojiAtlasBakerEditor_29\"></a>步骤一：将Editor目录文件EmojiAtlasBaker移入到自己的项目Editor目录下</h3>\n<p><img alt=\"移入自己项目目录下\" src=\"..\\..\\static\\image\\e9cc02be27504dd2888007740700c3b4.png\"/></p>\n<h3><a id=\"Icon_EmojiAtlas__QQIconAtlasxml_31\"></a>步骤二、导入Icon到自己项目中 (EmojiAtlas 跟 QQIconAtlas可先删除掉，步骤五可生成图集及xml文件)</h3>\n<p>*<strong>注意</strong> Emojis跟QQ目录下的图片过多，打包项目时可存放到其他项目或者其他地方，减少打包的大小，这个两个目录的作用只是用于生成EmojiAtlas跟QQIconAtlas图集而已<br/> <img alt=\"导入Icon图标\" src=\"..\\..\\static\\image\\4b7ecef7b6e5412c99a4a2ec308d670f.png\"/><br/> Emojis目录下的图片<br/> <img alt=\"Emojis目录下的图片\" src=\"..\\..\\static\\image\\f5f59b253a31440daa2757607d90e88c.png\"/><br/> QQ目录下的文件<br/> <img alt=\"QQ目录下的文件\" src=\"..\\..\\static\\image\\e185fa1c9094469ebad2a9c0360b7961.png\"/></p>\n<h3><a id=\"EmojiEffectEmojiTextManagerScript_40\"></a>步骤三、导入EmojiEffect跟EmojiTextManager脚本到项目Script目录下</h3>\n<p><img alt=\"导入脚本\" src=\"..\\..\\static\\image\\dca7258588544356a8c58993a8b2f3bc.png\"/></p>\n<h3><a id=\"Xml_42\"></a>步骤四、在项目根目录下创建Xml文件夹，下面的两个文件是步骤五生成的文件，用于获取图集名称及信息</h3>\n<p><img alt=\"xml目录\" src=\"..\\..\\static\\image\\a8d44e6586e84373bd2af9cb27ccda5d.png\"/></p>\n<h3><a id=\"UnityToolBake_Emoji_Atlas_44\"></a>步骤五、在Unity选线栏Tool-&gt;Bake Emoji Atlas会有这个选项，单击这个选项，会弹出以下界面（打包图集）</h3>\n<p><strong>路径为自己项目的路径</strong><br/> <img alt=\"打包图集界面\" src=\"..\\..\\static\\image\\bb4f48ded35a47eea074955f7ee5879d.png\"/><br/> <strong>（一）命名方法</strong></p>\n<pre><code class=\"prism language-txt\">Emoji表情XML命名: EmojiXml\t\t\t图集命名: EmojiAtlas\n\nQQ表情XML命名: QQIconXml\t\t        图集命名:QQIconAtlas\n</code></pre>\n<p>设置好上面的参数。生成会把图片文件夹中的图片遍历打到一个Texture2D中，然后把每张图片在图集的位置大小记录下来，然后把这些数据存入xml文件中。在生成每个表情时可以设置UV来确定哪一个图片。<br/> 单击生成，会自动生成图集跟XML文件，见下图</p>\n<p><strong>（二）生成图集效果</strong><br/> <img alt=\"生成图集\" src=\"..\\..\\static\\image\\d30843cf6e974649b3ca66c6d1f30250.png\"/><br/> <strong>（三）生成XML配置文件</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\be7a06f027b9493fbdd30a79f977e201.png\"/><br/> <strong>（四）XML配置文件内容</strong><br/> <img alt=\"XML配置文件内容\" src=\"..\\..\\static\\image\\700d410dd8b24c4fbccd3ad9633fd52c.png\"/></p>\n<h2><a id=\"2_64\"></a>2.实际应用</h2>\n<h3><a id=\"XML_65\"></a>一、在初始化时读取调用XML文件</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">LitJson</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine<span class=\"token punctuation\">.</span>UI</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">IndexPanel</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">BaseUI</span></span>\n<span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Text</span> userNameTxt<span class=\"token punctuation\">;</span>\n\t<span class=\"token preprocessor property\"># 定义图集参数并在预制体上绑定</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Texture</span> emojiAtlas<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Texture</span> qqIconAtlas<span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\">// Use this for initialization</span>\n\t<span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">GetReadEmojiXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">ReadIconXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">ReadIconXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token operator\">+</span><span class=\"token string\">\"/Xml/QQIconXml.xml\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_EDITOR || UNITY_STANDALONE || UNITY_IOS</span>\n\t    path <span class=\"token operator\">=</span> <span class=\"token string\">\"file://\"</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">;</span>\n\t    <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n\t\t<span class=\"token class-name\">WWW</span> wWA<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WWW</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">///WWW读取在各个平台上都可使用</span>\n\t    <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> wWA<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">XmlDocument</span> XmlDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">XmlDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// Debug.LogError(\"-----------------QQ表情配置内容：\"+wWA.text);</span>\n\t\tXmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">LoadXml</span><span class=\"token punctuation\">(</span>wWA<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token class-name\">XmlNodeList</span> nodeList <span class=\"token operator\">=</span> XmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">SelectSingleNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ChildNodes<span class=\"token punctuation\">;</span>\n\t    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XmlElement</span> xe <span class=\"token keyword\">in</span> nodeList<span class=\"token punctuation\">)</span>\n\t    <span class=\"token punctuation\">{<!-- --></span>\n\t        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resStr <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span>Empty<span class=\"token punctuation\">;</span>\n\t        resStr <span class=\"token operator\">=</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"textTag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectWidth\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectHeight\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n\t        EmojiTextManager<span class=\"token punctuation\">.</span>Instance<span class=\"token punctuation\">.</span><span class=\"token function\">ParseNormalIcon</span><span class=\"token punctuation\">(</span>resStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">GetReadEmojiXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\tDebug<span class=\"token punctuation\">.</span><span class=\"token function\">LogErrorFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"---------------------Application数据路径为：\"</span><span class=\"token operator\">+</span>Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token operator\">+</span><span class=\"token string\">\"/Xml/EmojiXml.xml\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_EDITOR || UNITY_STANDALONE || UNITY_IOS</span>\n        path <span class=\"token operator\">=</span> <span class=\"token string\">\"file://\"</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">;</span>\n        <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n\t\t<span class=\"token class-name\">WWW</span> wWA<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WWW</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">///WWW读取在各个平台上都可使用</span>\n        <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> wWA<span class=\"token punctuation\">;</span> \n\t\t<span class=\"token class-name\">XmlDocument</span> XmlDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">XmlDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// Debug.LogError(\"-----------------Emoji表情配置内容：\"+wWA.text);</span>\n\t\tXmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">LoadXml</span><span class=\"token punctuation\">(</span>wWA<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">XmlNodeList</span> nodeList <span class=\"token operator\">=</span> XmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">SelectSingleNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ChildNodes<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XmlElement</span> xe <span class=\"token keyword\">in</span> nodeList<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resStr <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span>Empty<span class=\"token punctuation\">;</span>\n            resStr <span class=\"token operator\">=</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"emojiFileNames\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectWidth\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectHeight\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"textTag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText<span class=\"token punctuation\">;</span>\n            EmojiTextManager<span class=\"token punctuation\">.</span>Instance<span class=\"token punctuation\">.</span><span class=\"token function\">ParseEmojiInfo</span><span class=\"token punctuation\">(</span>resStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>在IndexPanel预制体上绑定图集跟EmojiTextManager脚本<br/> <img alt=\"脚本跟图集绑定\" src=\"..\\..\\static\\image\\faa718d88dbe49af963772188d061ae3.png\"/></p>\n<h3><a id=\"_133\"></a>二、服务器回调用户信息</h3>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token string\">\"code\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"20000\"</span>,\n  <span class=\"token string\">\"data\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">\"phonePrefix\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"+86\"</span>,\n    <span class=\"token string\">\"ip\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"111.111.11.111\"</span>,\n    <span class=\"token string\">\"avatar\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"group1/M00/00/10/rBKu4WHyN4GEfAhZAAAAAE40vZI779.jpg\"</span>,\n    <span class=\"token string\">\"inGame\"</span><span class=\"token builtin class-name\">:</span> false,\n    <span class=\"token string\">\"userName\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\u8365\">\\u8365</span><span class=\"token entity\" title=\"\\u9633\">\\u9633</span><span class=\"token entity\" title=\"\\uD83D\">\\uD83D</span><span class=\"token entity\" title=\"\\uDE1A\">\\uDE1A</span><span class=\"token entity\" title=\"\\u5154\">\\u5154</span><span class=\"token entity\" title=\"\\u5154\">\\u5154</span><span class=\"token entity\" title=\"\\uD83C\">\\uD83C</span><span class=\"token entity\" title=\"\\uDDE8\">\\uDDE8</span><span class=\"token entity\" title=\"\\uD83C\">\\uD83C</span><span class=\"token entity\" title=\"\\uDDF3\">\\uDDF3</span>\"</span>,\n    <span class=\"token string\">\"myInviteCode\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"70436160\"</span>,\n    <span class=\"token string\">\"token\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"ffJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJub2NlIjoxNjQ1MjYwNTkwMDI1LCJ1c2VybmFtZSI6Iis4NjoxNTIxODk2ODMyMSJ9.CIDWw9B0IwoQQqwXcnLWkvpv8lZWdEu3-KXukQNM4ff\"</span>,\n    <span class=\"token string\">\"hasThirdParty\"</span><span class=\"token builtin class-name\">:</span> false,\n    <span class=\"token string\">\"lastLoginTime\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">1645260589987</span>,\n    <span class=\"token string\">\"diamond\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">8242</span>,\n    <span class=\"token string\">\"phone\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"11111111111\"</span>,\n    <span class=\"token string\">\"gpsLat\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"111\"</span>,\n    <span class=\"token string\">\"inviteCode\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"111111\"</span>,\n    <span class=\"token string\">\"gpsLng\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"111111\"</span>,\n    <span class=\"token string\">\"connection\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n      <span class=\"token string\">\"port\"</span><span class=\"token builtin class-name\">:</span> 00,\n      <span class=\"token string\">\"host\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"11.111.111.1\"</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"id\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"70436160\"</span>,\n    <span class=\"token string\">\"gpsLoaction\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\u7279\">\\u7279</span><span class=\"token entity\" title=\"\\u6717\">\\u6717</span><span class=\"token entity\" title=\"\\u666e\">\\u666e</span><span class=\"token entity\" title=\"\\u5bb6\">\\u5bb6</span>\"</span>,\n    <span class=\"token string\">\"status\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token number\">0</span>\n  <span class=\"token punctuation\">}</span>,\n  <span class=\"token string\">\"message\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\u6210\">\\u6210</span><span class=\"token entity\" title=\"\\u529F\">\\u529F</span>\"</span>,\n  <span class=\"token string\">\"requestId\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1645260589\"</span>,\n  <span class=\"token string\">\"url\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"gateServer::/login\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>返回的json里面有userName，这里就是要处理的数据，可复制后面的Unicode字符串到Unicode编码转换开放平台上转换，转换结果如下：<br/> <img alt=\"转换结果\" src=\"..\\..\\static\\image\\ea823604253b440e82b7186bff2ef90c.png\"/></p>\n<h3><a id=\"_168\"></a>三、获取数据进行处理演示</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">LitJson</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine<span class=\"token punctuation\">.</span>UI</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">IndexPanel</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">BaseUI</span></span>\n<span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Text</span> userNameTxt<span class=\"token punctuation\">;</span>\n\t<span class=\"token preprocessor property\"># 定义图集参数并在预制体上绑定</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Texture</span> emojiAtlas<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">Texture</span> qqIconAtlas<span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\">// Use this for initialization</span>\n\t<span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">GetReadEmojiXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">ReadIconXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> userNameStr <span class=\"token operator\">=</span> <span class=\"token string\">\"\\u8365\\u9633\\uD83D\\uDE1A\\u5154\\u5154\\uD83C\\uDDE8\\uD83C\\uDDF3\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token preprocessor property\"># 传入方法中</span><span class=\"token return-type class-name\"><span class=\"token punctuation\">(</span>参数<span class=\"token punctuation\">:</span> Text文本<span class=\"token punctuation\">,</span> Unicode字符串<span class=\"token punctuation\">,</span> 图集<span class=\"token punctuation\">)</span></span>\n\t\tEmojiTextManager<span class=\"token punctuation\">.</span>Instance<span class=\"token punctuation\">.</span><span class=\"token function\">SetUITextThatHasEmoji</span><span class=\"token punctuation\">(</span>userNameTxt<span class=\"token punctuation\">,</span> usrNameStr<span class=\"token punctuation\">,</span> emojiAtlas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">ReadIconXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token operator\">+</span><span class=\"token string\">\"/Xml/QQIconXml.xml\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_EDITOR || UNITY_STANDALONE || UNITY_IOS</span>\n\t    path <span class=\"token operator\">=</span> <span class=\"token string\">\"file://\"</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">;</span>\n\t    <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n\t\t<span class=\"token class-name\">WWW</span> wWA<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WWW</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">///WWW读取在各个平台上都可使用</span>\n\t    <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> wWA<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">XmlDocument</span> XmlDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">XmlDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// Debug.LogError(\"-----------------QQ表情配置内容：\"+wWA.text);</span>\n\t\tXmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">LoadXml</span><span class=\"token punctuation\">(</span>wWA<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token class-name\">XmlNodeList</span> nodeList <span class=\"token operator\">=</span> XmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">SelectSingleNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ChildNodes<span class=\"token punctuation\">;</span>\n\t    <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XmlElement</span> xe <span class=\"token keyword\">in</span> nodeList<span class=\"token punctuation\">)</span>\n\t    <span class=\"token punctuation\">{<!-- --></span>\n\t        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resStr <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span>Empty<span class=\"token punctuation\">;</span>\n\t        resStr <span class=\"token operator\">=</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"textTag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectWidth\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectHeight\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n\t        EmojiTextManager<span class=\"token punctuation\">.</span>Instance<span class=\"token punctuation\">.</span><span class=\"token function\">ParseNormalIcon</span><span class=\"token punctuation\">(</span>resStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t    <span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">GetReadEmojiXml</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\tDebug<span class=\"token punctuation\">.</span><span class=\"token function\">LogErrorFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"---------------------Application数据路径为：\"</span><span class=\"token operator\">+</span>Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\"><span class=\"token keyword\">string</span></span> path <span class=\"token operator\">=</span> Application<span class=\"token punctuation\">.</span>streamingAssetsPath<span class=\"token operator\">+</span><span class=\"token string\">\"/Xml/EmojiXml.xml\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token preprocessor property\">#<span class=\"token directive keyword\">if</span> UNITY_EDITOR || UNITY_STANDALONE || UNITY_IOS</span>\n        path <span class=\"token operator\">=</span> <span class=\"token string\">\"file://\"</span><span class=\"token operator\">+</span>path<span class=\"token punctuation\">;</span>\n        <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">endif</span></span>\n\t\t<span class=\"token class-name\">WWW</span> wWA<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WWW</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">///WWW读取在各个平台上都可使用</span>\n        <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> wWA<span class=\"token punctuation\">;</span> \n\t\t<span class=\"token class-name\">XmlDocument</span> XmlDoc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">XmlDocument</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// Debug.LogError(\"-----------------Emoji表情配置内容：\"+wWA.text);</span>\n\t\tXmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">LoadXml</span><span class=\"token punctuation\">(</span>wWA<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">XmlNodeList</span> nodeList <span class=\"token operator\">=</span> XmlDoc<span class=\"token punctuation\">.</span><span class=\"token function\">SelectSingleNode</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"root\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>ChildNodes<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">XmlElement</span> xe <span class=\"token keyword\">in</span> nodeList<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> resStr <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span>Empty<span class=\"token punctuation\">;</span>\n            resStr <span class=\"token operator\">=</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"emojiFileNames\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectY\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectWidth\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"rectHeight\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText <span class=\"token operator\">+</span> <span class=\"token string\">\"|\"</span> <span class=\"token operator\">+</span> xe<span class=\"token punctuation\">[</span><span class=\"token string\">\"textTag\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>InnerText<span class=\"token punctuation\">;</span>\n            EmojiTextManager<span class=\"token punctuation\">.</span>Instance<span class=\"token punctuation\">.</span><span class=\"token function\">ParseEmojiInfo</span><span class=\"token punctuation\">(</span>resStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"_237\"></a>三、项目运用后效果</h1>\n<p><strong>编辑器效果</strong><br/> <img alt=\"编辑器效果\" src=\"..\\..\\static\\image\\530094807e0b43bc8b79d0895aee9d52.png\"/><br/> <strong>最终效果图</strong><br/> <img alt=\"emoji效果图\" src=\"..\\..\\static\\image\\04fb45189f704cf6bdf59507b20f66f6.png\"/><br/> 创作不易，记得😍一键😚三连😘支持一下！<br/> <img alt=\"抱着键盘女孩\" src=\"..\\..\\static\\image\\c064e5f5aa13441eaf1deb9b83e417a5.png\"/></p>\n<p>其他博客含有表情包的链接：<br/> 博客一：<a href=\"https://blog.csdn.net/cheng219101/article/details/87630284\">unity3d在UGUI中显示带表情的微信昵称</a><br/> 博客二：<a href=\"https://blog.csdn.net/mseol/article/details/73783386\">UGUI Text组件上动态显示Emoji</a></p>\n<p>*<strong>注意：</strong> 源码文本长度不够会报错<br/> GitHub源码地址：<a href=\"https://github.com/mcraiha/Unity-UI-emoji\">mcraiha/Unity-UI-emoji</a><br/> 博主优化后源码地址：<a href=\"https://download.csdn.net/download/weixin_45786770/77359554\">Unity开发对Emoji表情包图文混排进行处理显示（支持大多数表情）</a></p>\n<p>想了解更多，可以看一下csdn的<a href=\"https://edu.csdn.net/learn/32126/502684\">Unity商业级Emoji表情系统-11.TexturePacker的简单使用</a>教程(付费视频) 【其实本人也没看过🙈，哈哈~】</p>\n<hr color=\"#000000\" size='1\"'/>\n<h1><a id=\"_262\"></a>四、每天一心灵鸡汤</h1>\n<p><font color=\"#999AAA\">放下你的浮躁，放下你的懒惰，放下你的三分钟热度，放空你禁不住诱惑的大脑，放开你容易被任何事物吸引的眼睛，放淡你什么都想聊两句八卦的嘴巴，静下心来做你该做的事，该好好努力了！有时候真的努力后，你会发现自己要比想象的优秀很多。记住一句话，越努力，越幸运。<br/> <img alt=\"心灵鸡汤\" src=\"..\\..\\static\\image\\ee2f55ad6b554cceb92e9ed569534674.png\"/></font></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-02-19 18:34:12", "summary": "文章目录前言一、是什么？日本在无线通信中所使用的视觉情感符号二、使用步骤将源码文件导入自己的项目中步骤一：将目录文件移入到自己的项目目录下步骤二、导入到自己项目中跟可先删除掉，步骤五可生成图集及文件步"}