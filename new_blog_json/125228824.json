{"blogid": "125228824", "writerAge": "码龄5年", "writerBlogNum": "12", "writerCollect": "5", "writerComment": "0", "writerFan": "0", "writerGrade": "2级", "writerIntegral": "120", "writerName": "天河逐月", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125228824.jpg", "writerRankTotal": "110285", "writerRankWeekly": "211178", "writerThumb": "0", "writerVisitNum": "1886", "blog_read_count": "617", "blog_time": "已于 2022-06-10 22:17:38 修改", "blog_title": "C#调用matlab", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p> 在C#中有时需要用到调用matlab中的程序或模块，这里介绍其主要配置步骤。</p>\n<p>注意，前提是电脑上已安装matlab，然后才能进行配置。如果未安装matlab，则可以通过将需要调用的matlab模块编译为dll文件供C#调用，其具体步骤不再详细说明，可以自行查阅其他博主的博客。</p>\n<h1 style=\"margin-left:.0001pt;text-align:justify;\">第1步</h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">打开matlab，在命令窗口中输入“mex -setup”，回车后，选择 “mex –setup C++”。</p>\n<p><img alt=\"\" height=\"185\" src=\"..\\..\\static\\image\\cef884ec4195463592ef09501019229a.png\" width=\"553\"/></p>\n<p> 完成后，可见“MEX configured to…”提示。</p>\n<p><img alt=\"\" height=\"158\" src=\"..\\..\\static\\image\\ca0cadf743e94c7e9e3935d463839408.png\" width=\"553\"/></p>\n<h1> 第2步</h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">打开Visual Studio，新建项目。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">在解决方案资源管理器中，右键 “引用”，选择“添加引用”。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"203\" src=\"..\\..\\static\\image\\be631ca5a58a47b2b313c773aa47f4da.png\" width=\"294\"/></p>\n<p> 在“COM”中，选择“Matlab Application”，确定。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"267\" src=\"..\\..\\static\\image\\fcb92c4a02b04041a6a495605bdff26b.png\" width=\"346\"/></p>\n<h1 style=\"margin-left:.0001pt;text-align:justify;\">第3步</h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">在代码中，加上、</p>\n<pre><code class=\"language-cs\">using MLApp;</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\">然后定义一个对象</p>\n<pre><code class=\"language-cs\">MLAPPCLass myMatlab = new MLApp();</code></pre>\n<p> <img alt=\"\" height=\"304\" src=\"..\\..\\static\\image\\c9b319fdcee84d2f92fc1620bf01fd3e.png\" width=\"470\"/></p>\n<p> 此时会报错：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"115\" src=\"..\\..\\static\\image\\ecebd08545764ac9bc55535b19e67bf2.png\" width=\"319\"/></p>\n<p> 这时，右键“MLApp”，点击“属性”。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"121\" src=\"..\\..\\static\\image\\2fa3112d17df4e698b8908ca3d232360.png\" width=\"289\"/></p>\n<p> 将 “嵌入互操作类型”改为 “False”即可。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"278\" src=\"..\\..\\static\\image\\6f9bc142163941c5aba5fb94d0ce25db.png\" width=\"239\"/></p>\n<h1 style=\"margin-left:.0001pt;text-align:justify;\">第4步</h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">需要执行matlab程序时，可以输入</p>\n<pre><code class=\"language-cs\">myMatlab.Execute(\"str = ‘helloworld’;\");</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\">需要读取matlab中的变量时，可以输入</p>\n<pre><code class=\"language-cs\">string str = (string)myMatlab.GetVariable(\"str\", \"base\");</code></pre>\n<p></p>\n</div>\n</div>", "first_tag": "C#", "cpp": 1, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-06-10 22:17:38", "summary": "在中有时需要用到调用中的程序或模块，这里介绍其主要配置步骤。注意，前提是电脑上已安装，然后才能进行配置。如果未安装，则可以通过将需要调用的模块编译为文件供调用，其具体步骤不再详细说明，可以自行查阅其他"}