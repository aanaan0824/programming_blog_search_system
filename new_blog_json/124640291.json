{"blogid": "124640291", "writerAge": "码龄13年", "writerBlogNum": "140", "writerCollect": "332", "writerComment": "8", "writerFan": "1203", "writerGrade": "5级", "writerIntegral": "2321", "writerName": "wwwarewow", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124640291.jpg", "writerRankTotal": "12183", "writerRankWeekly": "5993", "writerThumb": "108", "writerVisitNum": "73300", "blog_read_count": "2030", "blog_time": "于 2022-05-07 22:09:46 发布", "blog_title": "Fastadmin ThinkPHP5 宝塔环境 下Redis的使用教程", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>6</p>\n<p>本篇是教程知道贴。</p>\n<p></p>\n<p>环境：</p>\n<p>Fastadmin最新版</p>\n<p>tp5</p>\n<p>宝塔</p>\n<p></p>\n<hr/>\n<p>1.首先在宝塔的安装面板，找到redis，点击安装。</p>\n<p><img alt=\"\" height=\"293\" src=\"..\\..\\static\\image\\58a28e1f44524672bdff4a8be8eb98de.png\" width=\"1200\"/></p>\n<p>2.安装完redis后，点击设置， 设置个密码</p>\n<p><img alt=\"\" height=\"681\" src=\"..\\..\\static\\image\\c120a8ee2f704df6984e534a408ca257.png\" width=\"798\"/></p>\n<p></p>\n<p>3.php环境安装redis扩展</p>\n<p><img alt=\"\" height=\"603\" src=\"..\\..\\static\\image\\1c0b905ed84f418ca9e1471db695cff1.png\" width=\"652\"/></p>\n<p>安装redis扩展的，一定要是部署的网站使用的php版本。 别搞错了。</p>\n<p></p>\n<p>4.在根目录的extend文件夹中创建文件 RedisPackage.php</p>\n<pre><code class=\"language-php\">&lt;?php\n\n// +----------------------------------------------------------------------\n// | Description: redis 缓存封装使用\n// +----------------------------------------------------------------------\n// | Author: phpAndy &lt;383916522@qq.com&gt;\n// +----------------------------------------------------------------------\n \n\n \nclass RedisPackage\n{\n    protected static $handler = null;\n    protected $options = [\n        'host' =&gt; '127.0.0.1',\n        'port' =&gt; 6379,\n        'password' =&gt; '这是你是之前设置的redis密码',\n        'select' =&gt; 0,\n        'timeout' =&gt; 20,//关闭时间 0:代表不关闭\n        'expire' =&gt; 0,\n        'persistent' =&gt; false,\n        'prefix' =&gt; '',\n    ];\n \n    public function __construct($options = [])\n    {\n        if (!extension_loaded('redis')) {   //判断是否有扩展(如果你的apache没reids扩展就会抛出这个异常)\n            throw new \\BadFunctionCallException('not support: redis');\n        }\n        if (!empty($options)) {\n            $this-&gt;options = array_merge($this-&gt;options, $options);\n        }\n        $func = $this-&gt;options['persistent'] ? 'pconnect' : 'connect';     //判断是否长连接\n        self::$handler = new \\Redis;\n        self::$handler-&gt;$func($this-&gt;options['host'], $this-&gt;options['port'], $this-&gt;options['timeout']);\n \n        if ('' != $this-&gt;options['password']) {\n            self::$handler-&gt;auth($this-&gt;options['password']);\n        }\n \n        if (0 != $this-&gt;options['select']) {\n            self::$handler-&gt;select($this-&gt;options['select']);\n        }\n    }\n \n    /**\n     * 写入缓存\n     * @param string $key 键名\n     * @param string $value 键值\n     * @param int $exprie 过期时间 0:永不过期\n     * @return bool\n     */\n    public static function set($key, $value, $exprie = 0)\n    {\n        if ($exprie == 0) {\n            $set = self::$handler-&gt;set($key, $value);\n        } else {\n            $set = self::$handler-&gt;setex($key, $exprie, $value);\n        }\n        return $set;\n    }\n \n    /**\n     * 读取缓存\n     * @param string $key 键值\n     * @return mixed\n     */\n    public static function get($key)\n    {\n        $fun = is_array($key) ? 'Mget' : 'get';\n        return self::$handler-&gt;{$fun}($key);\n    }\n \n    /**\n     * 获取值长度\n     * @param string $key\n     * @return int\n     */\n    public static function lLen($key)\n    {\n        return self::$handler-&gt;lLen($key);\n    }\n \n    /**\n     * 将一个或多个值插入到列表头部\n     * @param $key\n     * @param $value\n     * @return int\n     */\n    public static function LPush($key, $value, $value2 = null, $valueN = null)\n    {\n        return self::$handler-&gt;lPush($key, $value, $value2, $valueN);\n    }\n \n    /**\n     * 移出并获取列表的第一个元素\n     * @param string $key\n     * @return string\n     */\n    public static function lPop($key)\n    {\n        return self::$handler-&gt;lPop($key);\n    }\n \n \n}</code></pre>\n<p></p>\n<p>这个php文件是一个大佬写的，一时找不到在哪里了。</p>\n<p><strong><span style=\"color:#fe2c24;\">记得上面有个设置redis密码的地方，要改成自己的。</span></strong></p>\n<p><strong><span style=\"color:#fe2c24;\">记得上面有个设置redis密码的地方，要改成自己的。</span></strong></p>\n<p><strong><span style=\"color:#fe2c24;\">记得上面有个设置redis密码的地方，要改成自己的。</span></strong></p>\n<p></p>\n<p>5.在要使用Redis的Controller中，引入文件</p>\n<pre><code class=\"language-php\">import('RedisPackage', EXTEND_PATH);</code></pre>\n<p></p>\n<p>6. 使用</p>\n<pre><code class=\"language-php\">#设置\n\\RedisPackage::set('要设置的key','这是value');\n\n\n#获取\n$key = \\RedisPackage::get('已设置的key'));</code></pre>\n<p></p>\n<p>至此，宝塔面板+thinkphp环境 使用redis教程结束。</p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 1, "time": "2022-05-07 22:09:46", "summary": "本篇是教程知道贴。环境：最新版宝塔首先在宝塔的安装面板，找到，点击安装。安装完后，点击设置，设置个密码环境安装扩展安装扩展的，一定要是部署的网站使用的版本。别搞错了。在根目录的文件夹中创建文件缓存封装"}