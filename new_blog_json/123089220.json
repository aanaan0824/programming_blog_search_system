{"blogid": "123089220", "writerAge": "码龄2年", "writerBlogNum": "2", "writerCollect": "7", "writerComment": "9", "writerFan": "2", "writerGrade": "1级", "writerIntegral": "30", "writerName": "小高同学Turf", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123089220.jpg", "writerRankTotal": "154031", "writerRankWeekly": "1101314", "writerThumb": "1", "writerVisitNum": "2333", "blog_read_count": "2258", "blog_time": "已于 2022-02-23 15:52:58 修改", "blog_title": "java调用C#类库，java调用dll文件，超详细过程，理清步骤之后非常简单。", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>java调用C#类库，超详细过程，理清步骤之后非常简单。</p>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_10\">前言</a></li><li><a href=\"#CDLL_13\">一、编写C#类库代码，并生成DLL文件。</a></li><li><ul><li><a href=\"#1Visual_Studiovs2015CHelloWorld_14\">1.按如图步骤用Visual Studio(我用的vs2015)新建一个C#的类库项目，项目名称为HelloWorld。</a></li><li><a href=\"#2Hello_18\">2.重命名类名Hello</a></li><li><a href=\"#3_20\">3.类库代码</a></li><li><a href=\"#4dll_34\">4.右键项目，生成。编译成dll</a></li></ul>\n</li><li><a href=\"#java_38\">二、编写java代码</a></li><li><ul><li><a href=\"#1jni4netdll_39\">1.用jni4net工具把dll文件编译；</a></li><li><a href=\"#2dlljar_49\">2.将dll文件打包乘jar包</a></li><li><a href=\"#3jar_53\">3.拷贝文件并添加jar包依赖；</a></li><li><a href=\"#4java_80\">4.java代码</a></li></ul>\n</li><li><a href=\"#_94\">总结</a></li></ul>\n</div>\n<p></p>\n<hr color=\"#000000\" size='1\"'/>\n<h1><a id=\"_10\"></a>前言</h1>\n<p>最近在编写项目时候，遇到了java调用C#类库的情况，试了很多种方法，也遇到了很多坑。解决之后写下来。作为记录和分享给有用的朋友们。在这里我用的工具是jni4net-0.8.8.0，Visual Studio2015</p>\n<h1><a id=\"CDLL_13\"></a>一、编写C#类库代码，并生成DLL文件。</h1>\n<h2><a id=\"1Visual_Studiovs2015CHelloWorld_14\"></a>1.按如图步骤用Visual Studio(我用的vs2015)新建一个C#的类库项目，项目名称为HelloWorld。</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d311cbb39e9443c68df45a71269fb0a3.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f7fabf0c90754a19b959a6bc1c959af7.png\"/><br/> 创建C#类库项目步骤</p>\n<h2><a id=\"2Hello_18\"></a>2.重命名类名Hello</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0d177e49ce554a609e3f6a60eb9c6f29.png\"/></p>\n<h2><a id=\"3_20\"></a>3.类库代码</h2>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">namespace</span> <span class=\"token namespace\">HelloWorld</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Hello</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> <span class=\"token function\">display</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> a<span class=\"token punctuation\">,</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> b<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">return</span> a<span class=\"token operator\">+</span>b<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"4dll_34\"></a>4.右键项目，生成。编译成dll</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7388149f29cf413ea3a3d5fa0b0ede95.png\"/></p>\n<h1><a id=\"java_38\"></a>二、编写java代码</h1>\n<h2><a id=\"1jni4netdll_39\"></a>1.用jni4net工具把dll文件编译；</h2>\n<p>文件夹找到jni4net的bin目录，创建cmd命令文件，方便后续使用；<br/> 命令：.\\proxygen.exe “DLL所在路径” -wd “java项目根路径”<br/> 如：.\\proxygen.exe “D:\\Java\\HelloWorld.dll” -wd “E:\\Project\\Jni4netProject”<br/> 执行后java项目的根目录下会多出下图红色框中的文件和一个build.cmd文件<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\fe453ac9e4d44fb5b71d8a58646dbfa0.png\"/></p>\n<h2><a id=\"2dlljar_49\"></a>2.将dll文件打包乘jar包</h2>\n<p>将命令行切换到java项目的根目录下(和src同级目录)，执行命令build.cmd，java项目根目录下会编译出2个文件分别为HelloWorld.j4n.dll和HelloWorld.j4n.jar,<br/> 如下图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\289e89cf951c4467942fbbdd667d16ec.png\"/></p>\n<h2><a id=\"3jar_53\"></a>3.拷贝文件并添加jar包依赖；</h2>\n<p>然后将jni4net的lib目录下的jar文件和dll文件copy到java项目的根目录下，将C#项目的HelloWorld.dll的文件也copy到java项目的根目录下，<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6e9e73220a36483ba7405b136bb347aa.png\"/></p>\n<p>添加依赖的方式有多种(我用的第一种)，如：<br/> <strong>1.将HelloWorld.j4n.jar和jni4net.j-0.8.8.0.jar添加到File—Progect Structure --Modules–Depengdenies–</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2be7c5d302b748d19e6360ce6b0e10ea.png\"/><br/> 2.把jar包放到指定位置，在pom文件中添加依赖，如：</p>\n<pre><code class=\"prism language-java\">\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">&gt;</span></span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">&gt;</span></span>com<span class=\"token punctuation\">.</span>xgtx<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">&gt;</span></span><span class=\"token class-name\">ObcClient</span><span class=\"token punctuation\">.</span>j4n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">&gt;</span></span><span class=\"token number\">1.0</span><span class=\"token number\">.1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>scope<span class=\"token punctuation\">&gt;</span></span>system<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>scope<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>systemPath<span class=\"token punctuation\">&gt;</span></span><span class=\"token class-name\">C</span><span class=\"token operator\">:</span><span class=\"token operator\">/</span>dll<span class=\"token operator\">/</span><span class=\"token class-name\">ObcClient</span><span class=\"token punctuation\">.</span>j4n<span class=\"token punctuation\">.</span>jar<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>systemPath<span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>dependency<span class=\"token punctuation\">&gt;</span></span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>groupId<span class=\"token punctuation\">&gt;</span></span>com<span class=\"token punctuation\">.</span>xgtx<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>groupId<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>artifactId<span class=\"token punctuation\">&gt;</span></span>jni4net<span class=\"token punctuation\">.</span>j<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>artifactId<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>version<span class=\"token punctuation\">&gt;</span></span><span class=\"token number\">1.0</span><span class=\"token number\">.1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>version<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>scope<span class=\"token punctuation\">&gt;</span></span>system<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>scope<span class=\"token operator\">&gt;</span>\n\t\t\t<span class=\"token generics\"><span class=\"token punctuation\">&lt;</span>systemPath<span class=\"token punctuation\">&gt;</span></span><span class=\"token class-name\">C</span><span class=\"token operator\">:</span><span class=\"token operator\">/</span>dll<span class=\"token operator\">/</span>jni4net<span class=\"token punctuation\">.</span>j<span class=\"token operator\">-</span><span class=\"token number\">0.8</span><span class=\"token number\">.8</span><span class=\"token number\">.0</span><span class=\"token punctuation\">.</span>jar<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>systemPath<span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>dependency<span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"4java_80\"></a>4.java代码</h2>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">Bridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">setVerbose</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Bridge</span><span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">File</span> dll <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span>  <span class=\"token string\">\"HelloWorld.j4n.dll\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Bridge<span class=\"token punctuation\">.</span>LoadAndRegisterAssemblyFrom</span><span class=\"token punctuation\">(</span>dll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> result <span class=\"token operator\">=</span><span class=\"token class-name\"><span class=\"token namespace\">helloWorld<span class=\"token punctuation\">.</span></span>Hello</span><span class=\"token punctuation\">.</span><span class=\"token function\">display</span><span class=\"token punctuation\">(</span><span class=\"token number\">66</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"计算结果为：\"</span><span class=\"token operator\">+</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>并执行：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c3937120c83a4e8cbc27a07a85e37c02.png\"/><br/> 这里仅仅是展示了调用的一种方法，还可以通过实例化 C# 类库中的类 ，再去调用类中的方法。</p>\n<h1><a id=\"_94\"></a>总结</h1>\n<p><font color=\"#999AAA\">以上就是今天要讲的内容，本文仅仅简单介绍了java调用c#类库的过程示例，实际使用过程中还有很多坑，大家互相学习。</font></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Java", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 1, "sql": 0, "php": 0, "time": "2022-02-23 15:52:58", "summary": "调用类库，超详细过程，理清步骤之后非常简单。文章目录前言一、编写类库代码，并生成文件。按如图步骤用我用的新建一个的类库项目，项目名称为。重命名类名类库代码右键项目，生成。编译成二、编写代码用工具把文件"}