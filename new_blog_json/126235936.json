{"blogid": "126235936", "writerAge": "码龄12年", "writerBlogNum": "74", "writerCollect": "198", "writerComment": "368", "writerFan": "1133", "writerGrade": "5级", "writerIntegral": "1718", "writerName": "六月暴雪飞梨花", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126235936.jpg", "writerRankTotal": "11083", "writerRankWeekly": "208", "writerThumb": "204", "writerVisitNum": "43863", "blog_read_count": "373", "blog_time": "已于 2022-08-08 22:45:44 修改", "blog_title": "技术学习：Python（08）｜操作MySQL", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>活动地址：<a href=\"https://marketing.csdn.net/p/bdabfb52c5d56532133df2adc1a728fd\">CSDN21天学习挑战赛</a></p>\n</blockquote>\n<h1><a id=\"1_pipMySQL_3\"></a>🏮1 使用pip安装MySQL</h1>\n<h2><a id=\"11_PyMySQL_4\"></a>🎈1.1 什么是PyMySQL</h2>\n<p><code>PyMySQL</code> 是在<code> Python3.x</code> 版本中用于连接 MySQL 服务器的一个库，<code>Python2 </code>中则使用 <code>mysqldb</code>。<br/> <code>PyMySQL</code>的Github主页地址：<a href=\"https://github.com/PyMySQL/PyMySQL\">https://github.com/PyMySQL/PyMySQL</a><br/> <code>PyMySQL</code>的最新版本文档地址：<a href=\"https://pymysql.readthedocs.io/en/latest/\">https://pymysql.readthedocs.io/en/latest/</a></p>\n<h2><a id=\"12_pip_9\"></a>🎈1.2 查看pip的版本</h2>\n<p>针对Mac用户，只需要打开<code>终端</code>或者<code>iTerm</code>。</p>\n<pre><code class=\"prism language-shell\">Aion.Local $ pip3 --version\npip <span class=\"token number\">22.2</span>.2 from /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages/pip <span class=\"token punctuation\">(</span>python <span class=\"token number\">3.10</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>当然，你也可以使用其他命令查看当前机器的<code>pip</code>版本，<code>pip3 -V</code> 、 <code>pip3 --help</code>都是一些常用命令，希望记住。</p>\n<h2><a id=\"13_pip_17\"></a>🎈1.3 升级pip</h2>\n<pre><code class=\"prism language-shell\">Aion.Local $ pip3 <span class=\"token function\">install</span> --upgrade pip\nRequirement already satisfied: pip <span class=\"token keyword\">in</span> /Library/Frameworks/Python.framework/Versions/3.10/lib/python3.10/site-packages <span class=\"token punctuation\">(</span><span class=\"token number\">22.2</span>.1<span class=\"token punctuation\">)</span>\nCollecting pip\n  Using cached pip-22.2.2-py3-none-any.whl <span class=\"token punctuation\">(</span><span class=\"token number\">2.0</span> MB<span class=\"token punctuation\">)</span>\nInstalling collected packages: pip\n  Attempting uninstall: pip\n    Found existing installation: pip <span class=\"token number\">22.2</span>.1\n    Uninstalling pip-22.2.1:\n      Successfully uninstalled pip-22.2.1\nSuccessfully installed pip-22.2.2\n</code></pre>\n<p>升级<code>pip</code>也是很简单，一般情况下，使用命令行升级，多数都是使用<code>--upgrade</code>命令来升级。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1116304d773a4cd4856a4a824b0a9c2f.png\"/></p>\n<h2><a id=\"14_pippymysql_34\"></a>🎈1.4 使用pip安装pymysql</h2>\n<p>安装第三方的<code>mysql</code>，我们只需要按照下面的命令执行就可以了。</p>\n<pre><code class=\"prism language-shell\">Aion.Local $ pip3 <span class=\"token function\">install</span> pymysql\nCollecting pymysql\n  Downloading PyMySQL-1.0.2-py3-none-any.whl <span class=\"token punctuation\">(</span><span class=\"token number\">43</span> kB<span class=\"token punctuation\">)</span>\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=\"token number\">43.8</span>/43.8 kB <span class=\"token number\">35.4</span> kB/s eta <span class=\"token number\">0</span>:00:00\nInstalling collected packages: pymysql\nSuccessfully installed pymysql-1.0.2\n</code></pre>\n<h1><a id=\"_2_pythonPyMySQLMySQL_46\"></a>🏮 2 python使用PyMySQL驱动操作MySQL</h1>\n<h2><a id=\"_21_users_47\"></a>🎈 2.1 创建实验表（users）</h2>\n<p>首先，我们需要进入我们自己的数据，在我们自己的数据库创建一张实验需要的表。</p>\n<pre><code class=\"prism language-mysql\">DROP TABLE IF EXISTS `users`;\n\nCREATE TABLE `users` (\n    `id` INT(11) NOT NULL AUTO_INCREMENT COMMENT 'ID编号',\n\t`username` VARCHAR(128) NOT NULL COMMENT '账号/用户名',\n    `email` VARCHAR(255) COLLATE utf8_bin NOT NULL COMMENT '邮箱',\n    `password` VARCHAR(255) COLLATE utf8_bin NOT NULL COMMENT '密码',\n    PRIMARY KEY (`id`)\n) ENGINE = InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin AUTO_INCREMENT=1 COMMENT '用户表';\n</code></pre>\n<h2><a id=\"_22_PyMySQL_61\"></a>🎈 2.2 使用PyMySQL连接数据库</h2>\n<p>连接数据库的参数有很多，我们使用的时候基本上就常用的几个就可以了。具体的连接参数如下：</p>\n<blockquote>\n<p>pymysql.connections.Connection(*, user=None, password=‘’, host=None, database=None, unix_socket=None, port=0, charset=‘’, sql_mode=None, read_default_file=None, conv=None, use_unicode=True, client_flag=0, cursorclass=&lt;class ‘pymysql.cursors.Cursor’&gt;, init_command=None, connect_timeout=10, read_default_group=None, autocommit=False, local_infile=False, max_allowed_packet=16777216, defer_connect=False, auth_plugin_map=None, read_timeout=None, write_timeout=None, bind_address=None, binary_prefix=False, program_name=None, server_public_key=None, ssl=None, ssl_ca=None, ssl_cert=None, ssl_disabled=None, ssl_key=None, ssl_verify_cert=None, ssl_verify_identity=None, compress=None, named_pipe=None, passwd=None, db=None)</p>\n</blockquote>\n<p>我们常用的参数如下：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pymysql<span class=\"token punctuation\">.</span>cursors\n\n<span class=\"token comment\"># 连接到数据库</span>\nconnection <span class=\"token operator\">=</span> pymysql<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span>\n                             user<span class=\"token operator\">=</span><span class=\"token string\">'python_study_user'</span><span class=\"token punctuation\">,</span>\n                             password<span class=\"token operator\">=</span><span class=\"token string\">'xxxxxx'</span><span class=\"token punctuation\">,</span>\n                             database<span class=\"token operator\">=</span><span class=\"token string\">'python_study'</span><span class=\"token punctuation\">,</span>\n                             charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">,</span>\n                             cursorclass<span class=\"token operator\">=</span>pymysql<span class=\"token punctuation\">.</span>cursors<span class=\"token punctuation\">.</span>DictCursor<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>连接的参数说明：</p>\n<ul><li><code>host</code>：数据库服务器的主机</li><li><code>user</code>：登录的用户名</li><li><code>password</code>：登录的数据库密码</li><li><code>database</code>：登录的数据库，如果是None 表示不使用特定的数据库</li><li><code>charset</code>：编码字符集</li><li><code>cursorclass</code>：自定义光标类</li></ul>\n<p>其他参数请参考官方提供的文档：<a href=\"https://pymysql.readthedocs.io/en/latest/modules/connections.html\">connections</a></p>\n<h2><a id=\"_22_INSERT_87\"></a>🎈 2.2 操作数据库｜INSERT</h2>\n<pre><code class=\"prism language-python3\"><span class=\"token keyword\">with</span> connection<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> cursor<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 插入一条记录</span>\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">\"INSERT INTO `users` (`username`, `email`, `password`) VALUES (%s, %s)\"</span>\n    cursor<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'Aion.Liu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Aion.Liu@gmail.com'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Aion!@#QAZ_0808'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 手工提交.</span>\n    connection<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_23_SELECT_98\"></a>🎈 2.3 操作数据库｜SELECT</h2>\n<pre><code class=\"prism language-python3\"><span class=\"token keyword\">with</span> connection<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> cursor<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 读取数据</span>\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT `id`, `username`, `password` FROM `users` WHERE `email`=%s\"</span>\n    cursor<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'Aion.Liu@gmail.com'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    result <span class=\"token operator\">=</span> cursor<span class=\"token punctuation\">.</span>fetchone<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 打印的结果</span>\n<span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'id'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'username'</span>：<span class=\"token string\">'Aion.Liu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'password'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Aion!@#QAZ_0808'</span><span class=\"token punctuation\">}</span>\n</code></pre>\n<p>当然，可以多执行几次，看下效果：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e1b033b9dc594949adf7e71d2468109d.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5c88ee08dd25477cb136ef760abe56b0.png\"/><br/> 下面，我们看下数据库的数据：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\541ec4a40a4a46a8afb1fbdaaf24cdf7.png\"/></p>\n<h2><a id=\"_24__116\"></a>🎈 2.4 遇到的问题和解决方法</h2>\n<blockquote>\n<p>Q1：由于我升级了<code>Python</code>的版本，也升级了<code>pip</code>的版本，导致在执行过程中，出现找不到 <strong>pymysql</strong> 模块</p>\n</blockquote>\n<pre><code>import pymysql.cursors\nModuleNotFoundError: No module named 'pymysql'\n</code></pre>\n<p>解决方法：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 👇️ 没有PyMySQL，需要安装</span>\npip <span class=\"token function\">install</span> PyMySQL\n\n<span class=\"token comment\"># 👇️ python 3 中没有PyMySQL，需要安装(pip3.10 依赖)</span>\npip3 <span class=\"token function\">install</span> PyMySQL\n\n<span class=\"token comment\"># 👇️ 没有权限错误</span>\n<span class=\"token function\">sudo</span> pip3 <span class=\"token function\">install</span> PyMySQL\n\n<span class=\"token comment\"># 👇️ 环境中没有pip</span>\npython -m pip <span class=\"token function\">install</span> PyMySQL\n\n<span class=\"token comment\"># 👇️ python 3 中没有PyMySQL，需要安装(pip3.10 依赖)</span>\npython3 -m pip <span class=\"token function\">install</span> PyMySQL\n\n<span class=\"token comment\"># 👇️ for Anaconda 环境</span>\nconda <span class=\"token function\">install</span> -c anaconda pymysql\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-08-08 22:45:44", "summary": "活动地址：天学习挑战赛使用安装什么是是在版本中用于连接服务器的一个库，中则使用。的主页地址：的最新版本文档地址：查看的版本针对用户，只需要打开终端或者。当然，你也可以使用其他命令查看当前机器的版本，、"}