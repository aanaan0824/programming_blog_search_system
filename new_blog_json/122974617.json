{"blogid": "122974617", "writerAge": "码龄1年", "writerBlogNum": "41", "writerCollect": "210", "writerComment": "4", "writerFan": "362", "writerGrade": "3级", "writerIntegral": "490", "writerName": "Moster2469", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122974617.jpg", "writerRankTotal": "51818", "writerRankWeekly": "277756", "writerThumb": "65", "writerVisitNum": "29514", "blog_read_count": "6847", "blog_time": "已于 2022-05-16 23:15:38 修改", "blog_title": "Python处理Excel数据的方法", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-github-gist\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>Python处理Excel数据的方法</h3>\n<ul><li><a href=\"#_6\">电子表格格式</a></li><li><a href=\"#1_xlrd__31\">1.使用 xlrd 来处理；</a></li><li><a href=\"#2_xlwt__112\">2.使用 xlwt 来处理；</a></li><li><a href=\"#3_openpyxl__161\">3.使用 openpyxl 来处理；</a></li><li><a href=\"#4Pandasexcel_229\">4.使用Pandas库来处理excel数据</a></li><li><a href=\"#_350\">其他</a></li></ul>\n</div>\n<br/> 当Excel中有大量需要进行处理的数据时，使用Python不失为一种便捷易学的方法。接下来，本文将详细介绍多种Python方法来处理Excel数据。\n<p></p>\n<blockquote>\n<p>Excel处理经常用于数据可视化，那么如何利用提取到的Excel数据绘图呢？</p>\n<p>本文搭配<a href=\"https://blog.csdn.net/woaiwulima/article/details/122974918?spm=1001.2014.3001.5501\">Python绘图 \\ 数据可视化</a>一起使用效果更佳。</p>\n</blockquote>\n<h1><a id=\"_6\"></a>电子表格格式</h1>\n<p>我们在日常工作中常常见到各种后缀的电子表格，例如最常见的xlsx以及较为常见的csv、xls等格式的表格。同样是电子表格，它们之间有什么区别吗？</p>\n<p>xls为Excel早期表格格式。</p>\n<p>xls格式是Excel2003版本及其以前版本所生成的文件格式。 其最大的特点就是：<strong>仅有65536行、256列</strong>。因此规模过大的数据不可以使用xls格式读写。</p>\n<p>xlsx为Excel2007及其之后的表格格式，也是现在Excel表格的主流格式。</p>\n<p>与xls相比，它可以存储1048576行、16384列数据，存储相同数据，xlsx格式要比xls格式文件要小得很多。</p>\n<p>CSV为逗号分隔值文件。</p>\n<p>CSV逗号分隔值文件格式，其以纯文本形式存储表格数据（数字和文本），可以用Excel软件打开。</p>\n<p>xlrd模块既可读取xls文件也可读取xlsx文件；xlwt只可写xlsx文件；openpyxl可以读写xlsx文件；pandas可以同时读写xls、xlsx文件。</p>\n<h1><a id=\"1_xlrd__31\"></a>1.使用 xlrd 来处理；</h1>\n<p><strong>xlrd命令</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlrd\nbook <span class=\"token operator\">=</span> xlrd<span class=\"token punctuation\">.</span>open_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'excelFile.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取工作簿对象</span>\nnames <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span>sheet_names<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取所有工作表名称结果为列表</span>\n\nmySheets <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span>sheets<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>                 <span class=\"token comment\"># 获取工作表list。</span>\nsheet <span class=\"token operator\">=</span> mySheets<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>                    <span class=\"token comment\"># 通过索引顺序获取。</span>\nsheet <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span>sheet_by_index<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 通过索引顺序获取。</span>\nsheet <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span>sheet_by_name<span class=\"token punctuation\">(</span><span class=\"token string\">u'Sheet1'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 通过名称获取 u表示后面字符串以 Unicode 格式 进行编码，一般用在中文字符串前面，以防乱码</span>\n\n<span class=\"token comment\"># 获取行数和列数</span>\nnrows <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>nrows\nncols <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>ncols\n\n<span class=\"token comment\"># 获取一行和一列</span>\nrow <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>row_values<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>               <span class=\"token comment\"># i是行数，从0开始计数，返回list对象。</span>\ncol <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>col_values<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>               <span class=\"token comment\"># i是列数，从0开始计数，返回list对象。</span>\n\n<span class=\"token comment\"># 读取单元格数据</span>\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>cell_value<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 直接获取单元格数据，i是行数，j是列数，行数和列数都是从0开始计数。</span>\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value    \n</code></pre>\n<p>示例1：Python读取Excel文件特定数据</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlrd\ndata <span class=\"token operator\">=</span> xlrd<span class=\"token punctuation\">.</span>open_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'excelFile.xlsx'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 打开xlsx文件</span>\ntable <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>sheets<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 打开第一张表</span>\nnrows <span class=\"token operator\">=</span> table<span class=\"token punctuation\">.</span>nrows <span class=\"token comment\"># 获取表的行数</span>\n\n<span class=\"token comment\"># 循环逐行输出</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>nrows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">if</span> i <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 跳过第一行</span>\n       <span class=\"token keyword\">continue</span>\n   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">.</span>row_values<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 取前五列数据</span>\n</code></pre>\n<p>示例2：Python读取Excel文件所有数据</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlrd\n\nworkbook <span class=\"token operator\">=</span> xlrd<span class=\"token punctuation\">.</span>open_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'excelFile.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打开一个xlsx文件</span>\nworksheets <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>sheet_names<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 抓取所有sheet页的名称</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'worksheets is %s'</span> <span class=\"token operator\">%</span>worksheets<span class=\"token punctuation\">)</span>\nworksheet1 <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>sheet_by_name<span class=\"token punctuation\">(</span><span class=\"token string\">u'Sheet1'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 如果存在sheet1文件则定位到sheet1</span>\n\n\n<span class=\"token triple-quoted-string string\">\"\"\"\n#遍历所有sheet对象\nfor worksheet_name in worksheets:\n\tworksheet = workbook.sheet_by_name(worksheet_name)\n\"\"\"</span>\n\n<span class=\"token comment\"># 遍历sheet1中所有行row</span>\nnum_rows <span class=\"token operator\">=</span> worksheet1<span class=\"token punctuation\">.</span>nrows\n<span class=\"token keyword\">for</span> curr_row <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    row <span class=\"token operator\">=</span> worksheet1<span class=\"token punctuation\">.</span>row_values<span class=\"token punctuation\">(</span>curr_row<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'row%s is %s'</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>curr_row<span class=\"token punctuation\">,</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 遍历sheet1中所有列col</span>\nnum_cols <span class=\"token operator\">=</span> worksheet1<span class=\"token punctuation\">.</span>ncols\n<span class=\"token keyword\">for</span> curr_col <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_cols<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tcol <span class=\"token operator\">=</span> worksheet1<span class=\"token punctuation\">.</span>col_values<span class=\"token punctuation\">(</span>curr_col<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'col%s is %s'</span> <span class=\"token operator\">%</span><span class=\"token punctuation\">(</span>curr_col<span class=\"token punctuation\">,</span>col<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 遍历sheet1中所有单元格cell</span>\n<span class=\"token keyword\">for</span> rown <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_rows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token keyword\">for</span> coln <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>num_cols<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\tcell <span class=\"token operator\">=</span> worksheet1<span class=\"token punctuation\">.</span>cell_value<span class=\"token punctuation\">(</span>rown<span class=\"token punctuation\">,</span>coln<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"2_xlwt__112\"></a>2.使用 xlwt 来处理；</h1>\n<p>使用xlwt模块写入Excel文件</p>\n<p>xlwt模块只能写xls文件，不能写xlsx文件(写xlsx程序不会报错，但最后文件无法直接打开，会报错)。</p>\n<p>默认保存在py文件相同路径下，如果该路径下有相同文件，会被新创建的文件覆盖。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlwt\n\nmyWorkbook <span class=\"token operator\">=</span> xlwt<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建Excel工作薄 若要写入中文则添加参数encoding = 'utf-8'</span>\n\nsheet <span class=\"token operator\">=</span> myWorkbook<span class=\"token punctuation\">.</span>add_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'New_Sheet'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建Excel工作表</span>\n\n<span class=\"token comment\">##sheet.write(m,n,'内容1') # 向单元格写入内容</span>\nmyStyle <span class=\"token operator\">=</span> xlwt<span class=\"token punctuation\">.</span>easyxf<span class=\"token punctuation\">(</span><span class=\"token string\">'font: name Times New Roman, color-index red, bold on'</span><span class=\"token punctuation\">,</span> num_format_str<span class=\"token operator\">=</span><span class=\"token string\">'#,##0.00'</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 数据格式</span>\nsheet<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2022</span><span class=\"token punctuation\">,</span> myStyle<span class=\"token punctuation\">)</span>\nsheet<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>                          <span class=\"token comment\"># 写入A3，数值等于1</span>\nsheet<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>                          <span class=\"token comment\"># 写入B3，数值等于1</span>\nsheet<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> xlwt<span class=\"token punctuation\">.</span>Formula<span class=\"token punctuation\">(</span><span class=\"token string\">\"A3+B3\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\"># 写入C3，数值等于2（A3+B3）,xlwt支持写入公式</span>\n\n<span class=\"token comment\"># 保存</span>\nmyWorkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'excelFile.xls'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>示例：新建excel文件并写入数据</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlwt\n<span class=\"token comment\"># 创建workbook和sheet对象</span>\nworkbook <span class=\"token operator\">=</span> xlwt<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 注意Workbook的开头W要大写</span>\nsheet1 <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>add_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'sheet1'</span><span class=\"token punctuation\">,</span>cell_overwrite_ok<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nsheet2 <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>add_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'sheet2'</span><span class=\"token punctuation\">,</span>cell_overwrite_ok<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 向sheet页中写入数据</span>\nsheet1<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sheet1'</span><span class=\"token punctuation\">)</span>\nsheet1<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sheet1_content'</span><span class=\"token punctuation\">)</span>\nsheet2<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sheet2'</span><span class=\"token punctuation\">)</span>\nsheet2<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">'sheet2_content'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 保存该excel文件,有同名文件时直接覆盖</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xls'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'创建excel文件完成！'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"3_openpyxl__161\"></a>3.使用 openpyxl 来处理；</h1>\n<p>openpyxl可以对excel文件进行读写操作</p>\n<p>openpyxl模块可实现对excel文件的读、写和修改，只能处理xlsx文件，不能处理xls文件。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n<span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook\n<span class=\"token keyword\">from</span> openpyxl<span class=\"token punctuation\">.</span>writer<span class=\"token punctuation\">.</span>excel <span class=\"token keyword\">import</span> ExcelWriter\n\nwb <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">u\"成绩单.xlsx\"</span><span class=\"token punctuation\">)</span>\n\nsheetnames <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>sheetnames <span class=\"token comment\"># 获得表单名字 </span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheetnames<span class=\"token punctuation\">)</span>\n\ntitle <span class=\"token operator\">=</span> sheet1<span class=\"token punctuation\">.</span>title  <span class=\"token comment\"># 获取工作表名称</span>\nrows <span class=\"token operator\">=</span> sheet1<span class=\"token punctuation\">.</span>max_row  <span class=\"token comment\"># 获取工作表行数</span>\ncols <span class=\"token operator\">=</span> sheet1<span class=\"token punctuation\">.</span>max_column  <span class=\"token comment\"># 获取工作表列数</span>\n\nsheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">[</span>sheetnames<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>column<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\nsheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'grade'</span>\nwb<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">u\"成绩单_new.xlsx\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改元素值并另存为xlsx文件</span>\n\nsheet <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 获取表格的尺寸大小</span>\n\ncell1 <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'B7'</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># 获取B7单元格的数据</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell1<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># cell1.value获取单元格B7中的值</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'a2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 使用excel单元格的表示法，字母不区分大小写 获取第2行第1列的数据</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>coordinate<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取某个格子的行数、列数以及坐标</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1:A5'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 使用sheet['A1:A5']获取A1到A5的数据</span>\n<span class=\"token comment\">##print(cell)</span>\n<span class=\"token comment\"># 打印A1到A5的数据</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> i<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># openpyxl读取excel文件</span>\n\nbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建工作簿 如果写入中文为乱码，可添加参数encoding = 'utf-8'</span>\nsheet <span class=\"token operator\">=</span> book<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'Sheet_name'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建工作表,0表示创建的工作表在工作薄最前面</span>\nsheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">,</span><span class=\"token string\">'content1'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 向单元格写入内容：</span>\nbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'excelFile'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存工作簿,默认保存在py文件相同路径下，如果该路径下有相同文件，会被新创建的文件覆盖。</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># openpyxl修改excel文件</span>\n\nsheet<span class=\"token punctuation\">.</span>insert_rows<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>和sheet<span class=\"token punctuation\">.</span>insert_cols<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span>分别表示在第m行、第n列前面插入行、列\nsheet<span class=\"token punctuation\">.</span>delete_rows<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span>和sheet<span class=\"token punctuation\">.</span>delete_cols<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span>分别表示删除第m行、第n列\n修改单元格内容：sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">'内容1'</span>或者sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'B3'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'内容2'</span> \n在最后追加行：sheet<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>可迭代对象<span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"4Pandasexcel_229\"></a>4.使用Pandas库来处理excel数据</h1>\n<p>Pandas 可以从各种文件格式比如 CSV、JSON、SQL、Microsoft Excel 导入数据。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nmydata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token string\">'sites'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"SZ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"BJ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SS\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'number'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\nmyvar <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>mydata<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>myvar<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\noutput:\n  sites  number\n0    SZ       1\n1    BJ       2\n2    SS       3\n'''</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nfile_path <span class=\"token operator\">=</span> <span class=\"token string\">r'example.xlsx'</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">,</span> sheet_name <span class=\"token operator\">=</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># sheet_name不指定时默认返回全表数据</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印表数据，如果数据太多，会略去中间部分</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印头部数据，仅查看数据示例时常用</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印列标题</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印行</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">\"ave\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 打印指定列</span>\n\n<span class=\"token comment\"># 描述数据</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>describe<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>写excel</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> pandas <span class=\"token keyword\">import</span> DataFrame\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'zs'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ls'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ww'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gender'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'man'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'man'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'woman'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\ndf <span class=\"token operator\">=</span> DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'new.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>修改excel–以修改原Excel文件中gender列数据为例，把girl修改为female，boy修改为male：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">from</span> pandas <span class=\"token keyword\">import</span> DataFrame\n\nfile_path <span class=\"token operator\">=</span> <span class=\"token string\">r'test.xlsx'</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'girl'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'female'</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">'boy'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'male'</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span>\n\nDataFrame<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span>file_path<span class=\"token punctuation\">,</span> sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'Sheet1'</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> header<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\ndf<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span>row_index<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>val1<span class=\"token punctuation\">,</span> val2<span class=\"token punctuation\">,</span> val3<span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 新增行</span>\ndf<span class=\"token punctuation\">[</span>colo_name<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>  <span class=\"token comment\"># 新增列</span>\n</code></pre>\n<p>示例1：读取excel数据</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 导入pandas模块</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\"># 直接默认读取到这个Excel的第一个表单</span>\nsheet <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 默认读取前5行数据</span>\ndata<span class=\"token operator\">=</span>sheet<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"获取到所有的值:\\n{0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 格式化输出</span>\n\n<span class=\"token comment\"># 也可以通过指定表单名来读取数据</span>\nsheet2<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">,</span>sheet_name<span class=\"token operator\">=</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>\ndata2<span class=\"token operator\">=</span>sheet2<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 默认读取前5行数据</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"获取到所有的值:\\n{0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>data2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 格式化输出</span>\n</code></pre>\n<p>示例2：操作Excel中的行列</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 导入pandas模块</span>\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\nsheet<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 这个会直接默认读取到这个Excel的第一个表单</span>\n\n<span class=\"token comment\"># 读取制定的某一行数据:</span>\ndata<span class=\"token operator\">=</span>sheet<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>values   <span class=\"token comment\"># 0表示第一行 这里读取数据并不包含表头</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"读取指定行的数据：\\n{0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 读取指定的多行：</span>\ndata2<span class=\"token operator\">=</span>sheet<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>values\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"读取指定行的数据：\\n{0}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>data2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 获取行号输出：</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"输出行号列表\"</span><span class=\"token punctuation\">,</span>sheet<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 获取列名输出：</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"输出列标题\"</span><span class=\"token punctuation\">,</span>sheet<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"_350\"></a>其他</h1>\n<p>当收到的文件既有xls，又有xlsx时，先转换为统一格式再做统计修改更方便。</p>\n<p>需要用到pywin32库，方法如下：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> win32com<span class=\"token punctuation\">.</span>client <span class=\"token keyword\">as</span> win32\n\nfname <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\User\\Desktop\\test.xlsx\"</span>\nexcel <span class=\"token operator\">=</span> win32<span class=\"token punctuation\">.</span>gencache<span class=\"token punctuation\">.</span>EnsureDispatch<span class=\"token punctuation\">(</span><span class=\"token string\">'Excel.Application'</span><span class=\"token punctuation\">)</span>\nwb <span class=\"token operator\">=</span> excel<span class=\"token punctuation\">.</span>Workbooks<span class=\"token punctuation\">.</span>Open<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># wb.SaveAs(fname+\"x\", FileFormat = 51)    #FileFormat = 51 is for .xlsx extension</span>\nwb<span class=\"token punctuation\">.</span>SaveAs<span class=\"token punctuation\">(</span>fname<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> FileFormat <span class=\"token operator\">=</span> <span class=\"token number\">56</span><span class=\"token punctuation\">)</span>      <span class=\"token comment\">#FileFormat = 56 is for .xls extension</span>\nwb<span class=\"token punctuation\">.</span>Close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nexcel<span class=\"token punctuation\">.</span>Application<span class=\"token punctuation\">.</span>Quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-05-16 23:15:38", "summary": "处理数据的方法电子表格格式使用来处理；使用来处理；使用来处理；使用库来处理数据其他当中有大量需要进行处理的数据时，使用不失为一种便捷易学的方法。接下来，本文将详细介绍多种方法来处理数据。处理经常用于数"}