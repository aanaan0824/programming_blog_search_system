{"blogid": "126729798", "writerAge": "ç é¾„1å¹´", "writerBlogNum": "80", "writerCollect": "3793", "writerComment": "3341", "writerFan": "5954", "writerGrade": "7çº§", "writerIntegral": "9984", "writerName": "knighthood2001", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126729798.jpg", "writerRankTotal": "1343", "writerRankWeekly": "41", "writerThumb": "3306", "writerVisitNum": "159186", "blog_read_count": "153", "blog_time": "å·²äºÂ 2022-09-06 23:46:43Â ä¿®æ”¹", "blog_title": "ã€UIè‡ªåŠ¨åŒ–ã€‘å¾®ä¿¡ç¾¤èŠæœªæ·»åŠ äººæ•°ç»Ÿè®¡", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<p> ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”</p>\n<p><strong>ğŸ¥° åšå®¢é¦–é¡µï¼š<strong><strong><strong><a href=\"https://blog.csdn.net/knighthood2001?type=blog\" title=\"knighthood2001\">knighthood2001</a></strong></strong></strong></strong></p>\n<p><strong>ğŸ˜— æ¬¢è¿ç‚¹èµğŸ‘è¯„è®ºğŸ—¨ï¸</strong></p>\n<p><strong>â¤ï¸ çƒ­çˆ±pythonï¼ŒæœŸå¾…ä¸å¤§å®¶ä¸€åŒè¿›æ­¥æˆé•¿ï¼ï¼â¤ï¸</strong></p>\n<p><strong>ğŸ‘€<strong><strong><strong><a href=\"https://www.nowcoder.com/link/pc_csdncpt_knight_python\" title=\"ç»™å¤§å®¶æ¨èä¸€æ¬¾å¾ˆç«çˆ†çš„åˆ·é¢˜ã€é¢è¯•æ±‚èŒç½‘ç«™\">ç»™å¤§å®¶æ¨èä¸€æ¬¾å¾ˆç«çˆ†çš„åˆ·é¢˜ã€é¢è¯•æ±‚èŒç½‘ç«™</a></strong></strong></strong>ğŸ‘€</strong></p>\n<p><strong>æ¯æ—¥åˆ·é¢˜ï¼Œè·Ÿæˆ‘ä¸€èµ·æ¥å·©å›ºåŸºç¡€å’Œåˆ·é¢˜å§</strong></p>\n</blockquote>\n<p><strong>ç›®çš„ï¼šæœ¬æ¥æƒ³å†™ä¸ªå°å­¦ã€åˆä¸­ã€é«˜ä¸­ã€å¤§å­¦ä¸­ç­ç¾¤ä¸­æœªæ·»åŠ å¥½å‹çš„ç»Ÿè®¡ï¼Œç›®å‰å°±å…ˆæŠŠæœ€è¿‘å†™çš„åˆ†äº«å‡ºæ¥ï¼Œæ–¹ä¾¿ä¸€èµ·å­¦ä¹ ã€äº¤æµï¼</strong></p>\n<p><strong>æ­¥éª¤ï¼š</strong></p>\n<pre><code class=\"language-python\">import subprocess\nimport uiautomation as auto\nimport time\n# ToDo è¿™é‡Œéœ€è¦æ›´æ”¹å¾®ä¿¡æ‰€åœ¨åœ°å€ï¼Œå¯é€šè¿‡æ¡Œé¢å¾®ä¿¡å›¾æ ‡å³é”®æ‰“å¼€æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®æŸ¥æ‰¾åˆ°è·¯å¾„\nsubprocess.Popen('E:\\å¾®ä¿¡\\WeChat\\WeChat.exe')\n\nwechatWindow = auto.WindowControl(Name='å¾®ä¿¡', className=\"WeChatMainWndForPC\")</code></pre>\n<p>        é¦–å…ˆæ˜¯å¯¼å…¥ç›¸åº”çš„æ¨¡å—ï¼Œå¦‚uiautomationå’Œsubprocessï¼Œç„¶åä½¿ç”¨</p>\n<pre>subprocess.Popen()</pre>\n<p>        æ‰“å¼€å¾®ä¿¡ï¼ˆæ³¨æ„æ˜¯ç™»å½•çŠ¶æ€ï¼‰ï¼Œæ¥ç€å®šä¹‰å¾®ä¿¡çª—æ ¼å¯¹è±¡ï¼Œä½¿ç”¨inspect.exeå³å¯è½»æ¾æå®šã€‚</p>\n<pre><code class=\"language-python\"># è·å–å¾®ä¿¡çª—æ ¼çš„å®½å’Œé«˜\nw = wechatWindow.BoundingRectangle.width()\nh = wechatWindow.BoundingRectangle.height()\n# å°†å¾®ä¿¡ç§»åˆ°å·¦ä¸Šè§’ï¼Œæ–¹ä¾¿åç»­æ“ä½œ\nwechatWindow.MoveWindow(0, 0, w, h)</code></pre>\n<p>        è¿™é‡Œå°½é‡å°†å¾®ä¿¡ç§»åˆ°å·¦ä¸Šè§’ï¼Œå› ä¸ºåç»­ç‚¹å‡»å¾®ä¿¡ç”¨æˆ·æ—¶å€™ï¼Œéœ€è¦å³å‡»ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢å‡ºé”™ï¼ˆä¸ä¿¡çš„äººå¯ä»¥å»è¯•è¯•ï¼‰ </p>\n<p>        æ¥ä¸‹æ¥å®šä¹‰èŠå¤©ä¿¡æ¯å’ŒèŠå¤©æˆå‘˜çš„çª—æ ¼å¯¹è±¡ã€‚ </p>\n<pre><code class=\"language-python\">b = wechatWindow.ButtonControl(Name='èŠå¤©ä¿¡æ¯')\nb.Click()\nb1 = wechatWindow.ListControl(Name='èŠå¤©æˆå‘˜')\nb2 = wechatWindow.ButtonControl(Name='æŸ¥çœ‹æ›´å¤š')\nif b2.Exists():\n    b2.Click()\n</code></pre>\n<p><img alt=\"\" height=\"331\" src=\"..\\..\\static\\image\\40ce15bc71e9459ca1906fac90e5441a.png\" width=\"363\"/></p>\n<p></p>\n<pre><code class=\"language-python\"># é€‰æ¡†åº•éƒ¨\nrect_btm = b1.GetParentControl().BoundingRectangle.bottom</code></pre>\n<p>é€‰æ¡†å¦‚ä¸‹å›¾ </p>\n<p><img alt=\"\" height=\"562\" src=\"..\\..\\static\\image\\36db9d4fdde644c18cc4586e88a7b37a.png\" width=\"251\"/></p>\n<pre><code class=\"language-python\"># å®šä½å…·ä½“ç¾¤æˆå‘˜\nspecific_mem = b1.GetChildren()</code></pre>\n<p><strong>é‡ç‚¹ï¼š</strong></p>\n<pre><code class=\"language-python\">num = 0\nfor member in specific_mem:\n    if not b1.Exists(0, 0):\n        break\n    if member.Name == 'æ·»åŠ ' or member.Name == 'åˆ é™¤':\n        continue\n    if member.BoundingRectangle.bottom &gt; rect_btm:\n        auto.WheelDown(waitTime=0.01)\n    member.Click(15, 15)\n    # ä¸»è¦æ˜¯åˆ¤æ–­â€œæ·»åŠ åˆ°é€šè®¯å½•â€æŒ‰é’®æ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦æ·»åŠ å¥½å‹\n    mail = wechatWindow.ButtonControl(Name=\"æ·»åŠ åˆ°é€šè®¯å½•\")\n    if mail.Exists(0, 0):\n        num += 1\n        print(member.Name)\n    member.RightClick(15, 15)\n    if auto.IsKeyPressed(auto.Keys.VK_F4):\n        break\n\nprint('æœªæ·»åŠ çš„æˆå‘˜ä¸ªæ•°ï¼š', num)\nwechatWindow.MoveToCenter()</code></pre>\n<p>â‘ é¦–å…ˆå®šä¹‰numï¼Œç”¨æ¥è®¡ç®—æœªåŠ å¥½å‹çš„äººæ•°ï¼Œ</p>\n<p>â‘¡Exists(0, 0)å¤§è‡´æ„æ€è¡¨ç¤ºæœ€å¿«æ—¶é—´æœç´¢</p>\n<p>â‘¢å¯¹äºç¾¤ä¸­çš„æ·»åŠ ã€åˆ é™¤æŒ‰é’®ï¼Œæˆ‘ä»¬passå³å¯</p>\n<p>â‘£å¯¹äºæ˜¾ç¤ºä¸å‡ºçš„ç¾¤æˆå‘˜ï¼Œéœ€è¦è¿›è¡Œæ»šè½®æ»šåŠ¨ï¼Œé€šè¿‡åˆ¤æ–­æ§ä»¶åº•éƒ¨çš„ä½ç½®é«˜ä½ï¼Œå®è¡Œæ»šè½®æ»šåŠ¨ã€‚</p>\n<p>â‘¤ä¸»è¦æ˜¯åˆ¤æ–­â€œæ·»åŠ åˆ°é€šè®¯å½•â€æŒ‰é’®æ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­æ˜¯å¦æ·»åŠ å¥½å‹ï¼Œè¯¥æŒ‰é’®å­˜åœ¨ï¼Œåˆ™è®¡æ•°ã€‚</p>\n<p>â‘¥</p>\n<p><img alt=\"\" height=\"120\" src=\"..\\..\\static\\image\\50f937a520ae48ffb330becb57e4ec55.png\" width=\"178\"/></p>\n<p><strong>æˆ‘ä»¬åˆ¤æ–­å¥½åï¼Œéœ€è¦è®©è¯¥é€‰æ¡†æ¶ˆå¤±ï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å‡»é¼ æ ‡å³é”®æˆ–è€…ç‚¹å‡»å¤´åƒå³ä¸Šè§’éƒ¨åˆ†ï¼Œè¿™é‡Œç¬”è€…é‡‡ç”¨ç‚¹å‡»é¼ æ ‡å³é”®ï¼ˆå¼Šç«¯æ˜¯ä¸èƒ½ç”¨åœ¨è‡ªå·±åˆ›å»ºçš„ç¾¤ï¼‰ã€‚</strong></p>\n<p>â‘¦æœ€åæ‰“å°ï¼Œå¹¶å°†å¾®ä¿¡ç•Œé¢å±…ä¸­ã€‚</p>\n<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®ç°äº†ä¸€å¼€å¤´çš„ç›®çš„ã€‚ğŸ˜€ğŸ˜€</p>\n<p></p>\n</div>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-06 23:46:43", "summary": "åšå®¢é¦–é¡µï¼šæ¬¢è¿ç‚¹èµè¯„è®ºçƒ­çˆ±ï¼ŒæœŸå¾…ä¸å¤§å®¶ä¸€åŒè¿›æ­¥æˆé•¿ï¼ï¼ç»™å¤§å®¶æ¨èä¸€æ¬¾å¾ˆç«çˆ†çš„åˆ·é¢˜ã€é¢è¯•æ±‚èŒç½‘ç«™ç»™å¤§å®¶æ¨èä¸€æ¬¾å¾ˆç«çˆ†çš„åˆ·é¢˜ã€é¢è¯•æ±‚èŒç½‘ç«™æ¯æ—¥åˆ·é¢˜ï¼Œè·Ÿæˆ‘ä¸€èµ·æ¥å·©å›ºåŸºç¡€å’Œåˆ·é¢˜å§ç›®çš„ï¼šæœ¬æ¥æƒ³å†™ä¸ªå°å­¦ã€åˆä¸­ã€é«˜"}