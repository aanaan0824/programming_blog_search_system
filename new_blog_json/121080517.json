{"blogid": "121080517", "writerAge": "码龄5年", "writerBlogNum": "125", "writerCollect": "163", "writerComment": "35", "writerFan": "228", "writerGrade": "5级", "writerIntegral": "3183", "writerName": "qq_39704803", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121080517.jpg", "writerRankTotal": "11254", "writerRankWeekly": "21424", "writerThumb": "81", "writerVisitNum": "270678", "blog_read_count": "4346", "blog_time": "于 2021-11-01 15:25:30 发布", "blog_title": "nginx+php配置", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>一、下载文档</p>\n<p>1.下载php:<a href=\"https://windows.php.net/download/\" title=\" \"> </a><a class=\"has-card\" href=\"https://windows.php.net/download/\" title=\"https://windows.php.net/download/\"><span class=\"link-card-box\"><span class=\"link-title\">https://windows.php.net/download/</span><span class=\"link-link\"><img alt=\"\" class=\"link-link-icon\" src=\"..\\..\\static\\image\\icon-default.png\"/>https://windows.php.net/download/</span></span></a><a href=\"https://windows.php.net/download/\" title=\" \"> </a>(<span style=\"color:#fe2c24;\">注意，需下载正确的文件，最好下载Thread Safe安全版，我就是因为下载错文件，绕了好久。</span>）</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\7aca82fa4bd843c2bd4539cc58b9098b.png\"/></p>\n<p> 2.下载nginx: <a class=\"has-card\" href=\"http://nginx.org/en/download.html\" title=\"nginx: download\"><span class=\"link-card-box\"><span class=\"link-title\">nginx: download</span><span class=\"link-link\"><img alt=\"\" class=\"link-link-icon\" src=\"..\\..\\static\\image\\icon-default.png\"/>http://nginx.org/en/download.html</span></span></a></p>\n<p>二、配置nginx</p>\n<p>修改Nginx的conf文件,Nginx的配置文件默认位置为：<code>/etc/nginx/nginx.conf</code></p>\n<p>1. 去掉worker_processes前的#号，开启一个进程</p>\n<p>2. 添加events</p>\n<p>3. 设置http-&gt;设置server-&gt;支持php</p>\n<pre><code>...\nworker_processes  1;\n...\nevents {\n    worker_connections  1024;\n}\n....\nserver {\n        listen       801;\n        server_name  localhost;\n        ...\n\n      location / {\n            root   html;\n            index  index.html index.htm  index.php;\n        }\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n        \n        location ~ \\.php$ {\n            root      html;\n           fastcgi_pass   127.0.0.1:9000;\n           fastcgi_index  index.php;\n          fastcgi_param     SCRIPT_FILENAME    $document_root$fastcgi_script_name;\n           include        fastcgi_params;\n       }\n    }</code></pre>\n<p>4.测试nginx是否安装成功  <br/> 启动命令：start nginx <br/> 在浏览器输入：<a href=\"http://localhost:801/indexbb.php\" title=\"http://localhost:801/\">http://localhost:801/</a>，就会打开html下的index.html文件<br/> 如果不能正常打开，查看端口号是否被占用<br/><br/> 三、配置php</p>\n<p>复制php.ini-development，命名为“php.ini\"，开始进行配置</p>\n<p>1.查找doc_root，配置需访问的源码目录<br/>  </p>\n<pre><code>doc_root =\"D:/.../nginx-1.16.1/html\"</code></pre>\n<p>2.查找extension_dir,配置目录</p>\n<pre><code>extension_dir = \"D:/.../php-8.0.12/ext\"</code></pre>\n<p>3.查找cgi.fix_pathinfo，设置为0<br/> 搜索“php_mysql”，找到：”extension=php_mysql.dll和extension=php_mysqli.dll  去掉前面的“;”extension=php_mysql.dll和extension=php_mysqli.dll   （支持MYSQL数据库）</p>\n<p>四、配置完成后，在cmd输入“php-cgi.exe -b 127.0.0.1:9000” 命令，确保“127.0.0.1:9000“的地址与nginx.conf中的 location ~ \\.php$ 中的地址一样。如果cmd窗口关闭的话，服务关闭，就不能正常访问php页面，如果不需要cmd窗口，让服务在后台运行，可进行第五步骤</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\fdb6a51921d643f09208ad17cde69ef6.png\"/></p>\n<p>五：后台启动服务</p>\n<p>1.在php目录下新建文件php-cgi.vbs，用php-cgi.vbs文件启动php-cgi:打开php-cgi.vbs,写入启动编码：</p>\n<pre><code>set wscriptObj = CreateObject(\"Wscript.Shell\")\nwscriptObj.run \"php-cgi -b 127.0.0.1:9000\",0</code></pre>\n<p>2.在Nginx目录下新建启动项：runServer.bat和停止项stopServer.bat<br/> 在启动项runServer.bat中输入：</p>\n<pre><code>@echo off\necho Starting nginx...\ncd %~dp0nginx\nstart \"\" \"D:/.../nginx-1.16.1/nginx.exe\"\n\n#echo Starting mysql...\n#net start mysql\n\necho Starting PHP FastCGI...\ncd %~dp0PHP\nstart \"\" \"D:/.../php-8.0.12/php-cgi.vbs\"\n\npause\n\nExit</code></pre>\n<p>　在停止项stopServer.bat中输入：</p>\n<pre><code>@echo off\necho Stopping nginx...\ntaskkill /F /IM nginx.exe &gt; nul\necho Stopping PHP FastCGI...\ntaskkill /F /IM php-cgi.exe &gt; nul\necho Stopping mysql...\nnet stop mysql\npause\nexit</code></pre>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p>附上nginx.conf配置</p>\n<pre><code>\n#user  nobody;\nworker_processes  1;\n\n#error_log  logs/error.log;\n#error_log  logs/error.log  notice;\n#error_log  logs/error.log  info;\n\n#pid        logs/nginx.pid;\n\n\nevents {\n    worker_connections  1024;\n}\n\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    #log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n    #                  '$status $body_bytes_sent \"$http_referer\" '\n    #                  '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    #access_log  logs/access.log  main;\n\n    sendfile        on;\n    #tcp_nopush     on;\n\n    #keepalive_timeout  0;\n    keepalive_timeout  65;\n\n    gzip  on;\n    gzip_min_length 1k;\n    gzip_comp_level 9;\n    gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n    gzip_vary on;\n    gzip_disable \"MSIE [1-6]\\.\";\n\n    \n\n    server {\n        listen       801;\n        server_name  localhost;\n\n        #charset koi8-r;\n\n        #access_log  logs/host.access.log  main;\n\n      location / {\n            root   html;\n            index  index.html index.htm  index.php;\n        }\n\n        #error_page  404              /404.html;\n\n        # redirect server error pages to the static page /50x.html\n        #\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n\n        # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n        #\n        #location ~ \\.php$ {\n        #    proxy_pass   http://127.0.0.1;\n        #}\n\n        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n        \n        location ~ \\.php$ {\n            root      html;\n           fastcgi_pass   127.0.0.1:9000;\n           fastcgi_index  index.php;\n          fastcgi_param     SCRIPT_FILENAME    $document_root$fastcgi_script_name;\n           include        fastcgi_params;\n       }\n\n        # deny access to .htaccess files, if Apache's document root\n        # concurs with nginx's one\n        #\n        #location ~ /\\.ht {\n        #    deny  all;\n        #}\n    }\n\n\n    # another virtual host using mix of IP-, name-, and port-based configuration\n    #\n    #server {\n    #    listen       8000;\n    #    listen       somename:8080;\n    #    server_name  somename  alias  another.alias;\n\n    #    location / {\n    #        root  D:\\software\\nginx-1.16.1\\html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n\n    # HTTPS server\n    #\n    #server {\n    #    listen       443 ssl;\n    #    server_name  localhost;\n\n    #    ssl_certificate      cert.pem;\n    #    ssl_certificate_key  cert.key;\n\n    #    ssl_session_cache    shared:SSL:1m;\n    #    ssl_session_timeout  5m;\n\n    #    ssl_ciphers  HIGH:!aNULL:!MD5;\n    #    ssl_prefer_server_ciphers  on;\n\n    #    location / {\n    #        root   html;\n    #        index  index.html index.htm;\n    #    }\n    #}\n\n}\n</code></pre>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 1, "java": 0, "sql": 1, "php": 1, "time": "2021-11-01 15:25:30", "summary": "一、下载文档下载注意，需下载正确的文件，最好下载安全版，我就是因为下载错文件，绕了好久。下载二、配置修改的文件的配置文件默认位置为：去掉前的号，开启一个进程添加设置设置支持测试是否安装成功启动命令：在"}