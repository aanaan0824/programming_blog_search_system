{"blogid": "124976830", "writerAge": "码龄2年", "writerBlogNum": "3", "writerCollect": "6", "writerComment": "0", "writerFan": "4", "writerGrade": "1级", "writerIntegral": "33", "writerName": "小九y", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124976830.jpg", "writerRankTotal": "178495", "writerRankWeekly": "1098514", "writerThumb": "2", "writerVisitNum": "1594", "blog_read_count": "1054", "blog_time": "已于 2022-05-26 17:42:26 修改", "blog_title": "C#实现mysql数据库连接", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"Cmysql_0\"></a>C#实现mysql数据库连接</h1>\n<hr/>\n<p></p>\n<div class=\"toc\">\n<h3>目录</h3>\n<ul><li><a href=\"#Cmysql_0\">C#实现mysql数据库连接</a></li><li><ul><li><a href=\"#_8\">一、功能实现</a></li><li><a href=\"#_12\">二、相关驱动配置</a></li><li><a href=\"#_18\">三、具体功能实</a></li><li><a href=\"#CRUD_19\">简单CRUD实现</a></li><li><ul><li><a href=\"#1_20\">1.窗体显示</a></li><li><a href=\"#2_23\">2.相关代码</a></li><li><ul><li><a href=\"#_24\">全局变量定义</a></li><li><a href=\"#_31\">相关控件代码</a></li><li><ul><li><a href=\"#1_32\">1.“数据库连接”控件</a></li><li><a href=\"#2_49\">2.“查询”控件</a></li><li><a href=\"#3_63\">3.“删除”控件</a></li><li><a href=\"#4_83\">4.\"增加\"控件</a></li><li><a href=\"#5_108\">5.\"修改\"控件</a></li></ul>\n</li></ul>\n</li><li><a href=\"#3_136\">3.成果展示</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<hr/>\n<h2><a id=\"_8\"></a>一、功能实现</h2>\n<p>1、设计一个项目连接到自己的MySQL数据库，数据库包含至少三张表；<br/> 2、使用dataGridView控件显示表中的数据；<br/> 3、实现基本crud操作；</p>\n<h2><a id=\"_12\"></a>二、相关驱动配置</h2>\n<p>点击工具→NuGet包管理器→管理解决方案……<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a25570a488694d6194b57387c896cb1e.png\"/><br/> 浏览搜索mysql，下载MySQL.Data到当前项目<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7e1c740762004108add6b894e20b1458.png\"/></p>\n<h2><a id=\"_18\"></a>三、具体功能实</h2>\n<h2><a id=\"CRUD_19\"></a>简单CRUD实现</h2>\n<h3><a id=\"1_20\"></a>1.窗体显示</h3>\n<p>添加dataGridView和button控件如下<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\76cc0374c71147f6961f35a9d66d879a.png\"/></p>\n<h3><a id=\"2_23\"></a>2.相关代码</h3>\n<h4><a id=\"_24\"></a>全局变量定义</h4>\n<pre><code class=\"prism language-csharp\"><span class=\"token class-name\">MySqlConnection</span> x<span class=\"token punctuation\">;</span> <span class=\"token comment\">//连接数据库对象</span>\n<span class=\"token class-name\">MySqlDataAdapter</span> mda<span class=\"token punctuation\">;</span> <span class=\"token comment\">//适配器变量</span>\n<span class=\"token class-name\">DataSet</span> ds<span class=\"token punctuation\">;</span>  <span class=\"token comment\">//临时数据集</span>\n</code></pre>\n<h4><a id=\"_31\"></a>相关控件代码</h4>\n<h5><a id=\"1_32\"></a>1.“数据库连接”控件</h5>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> M_str_sqlcon <span class=\"token operator\">=</span> <span class=\"token string\">\"server=localhost;user id=用户名;password=密码;database=使用的数据库\"</span><span class=\"token punctuation\">;</span>                                                                                             \n            x <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MySqlConnection</span><span class=\"token punctuation\">(</span>M_str_sqlcon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"数据库连接成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h5><a id=\"2_49\"></a>2.“查询”控件</h5>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button3_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from student\"</span><span class=\"token punctuation\">;</span>\n            mda <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MySqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            ds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            mda<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"student\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//显示数据</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> ds<span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">[</span><span class=\"token string\">\"student\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h5><a id=\"3_63\"></a>3.“删除”控件</h5>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button6_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> index <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentCell<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> id <span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"delete from student where id=\"</span><span class=\"token operator\">+</span>id<span class=\"token operator\">+</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">MySqlCommand</span> cmd <span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span><span class=\"token function\">CreateCommand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n            cmd<span class=\"token punctuation\">.</span>CommandText <span class=\"token operator\">=</span> sql<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                conn<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"删除失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            x<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     \n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h5><a id=\"4_83\"></a>4.\"增加\"控件</h5>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button5_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mda <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> ds <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"导入数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> msg <span class=\"token operator\">=</span> <span class=\"token string\">\"是否确定该条数据的添加？\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OKCancel<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Exclamation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\">MySqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MySqlCommandBuilder</span><span class=\"token punctuation\">(</span>mda<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    mda<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"student\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加成功\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"错误信息\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h5><a id=\"5_108\"></a>5.\"修改\"控件</h5>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">button4_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mda <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> ds <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"导入数据\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> msg <span class=\"token operator\">=</span> <span class=\"token string\">\"是否确认修改？\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OKCancel<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Exclamation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\">MySqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MySqlCommandBuilder</span><span class=\"token punctuation\">(</span>mda<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//命令生成器。</span>\n                    <span class=\"token comment\">//适配器会自动更新用户在表上的操作到数据库中</span>\n                    mda<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>ds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"student\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"修改成功\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"错误信息\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"3_136\"></a>3.成果展示</h3>\n<p>数据库连接<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0e8fb6f5cba6404d8a9fd932d29cb6cb.png\"/><br/> 查询所有表格<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3a3ff1effd0843eda75b3792d4f4f4a8.png\"/><br/> 数据修改<br/> 修改前<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a4cdf6de041a4998af497329ee15ab4f.png\"/><br/> 修改后<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ded00a642cc741f8bf38130e63ebf57e.png\"/><br/> 数据添加<br/> 添加前<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9811dda12c04433fb4afd190ab7d82ca.png\"/><br/> 添加后<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\184ce51d489842a6b6c8277b49c97dc6.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6ceb38b7628b4b579645c119b6a12f9c.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6b7d7f283a504873980ea3cd31688a63.png\"/><br/> clone地址:https://gitee.com/quantum-ix/Cat.git</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-05-26 17:42:26", "summary": "实现数据库连接目录实现数据库连接一、功能实现二、相关驱动配置三、具体功能实简单实现窗体显示相关代码全局变量定义相关控件代码数据库连接控件查询控件删除控件增加控件修改控件成果展示一、功能实现、设计一个项"}