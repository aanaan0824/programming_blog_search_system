{"blogid": "124383210", "writerAge": "码龄3年", "writerBlogNum": "112", "writerCollect": "5597", "writerComment": "5226", "writerFan": "16776", "writerGrade": "7级", "writerIntegral": "12515", "writerName": "苏凉.py", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124383210.jpg", "writerRankTotal": "920", "writerRankWeekly": "99", "writerThumb": "4357", "writerVisitNum": "179534", "blog_read_count": "18583", "blog_time": "已于 2022-06-29 11:44:53 修改", "blog_title": "在python中读取和写入CSV文件（你真的会吗？）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night-eighties\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p><font size=\"3\"> 🐚作者简介：苏凉（专注于网络爬虫，数据分析）<br/> 🐳博客主页：<a href=\"https://blog.csdn.net/weixin_46277553?type=blog\">苏凉.py的博客</a><br/> 🌐系列专栏：<a href=\"https://blog.csdn.net/weixin_46277553/category_11760133.html?spm=1001.2014.3001.5482\">Python基础语法专栏</a><br/> 👑名言警句：海阔凭鱼跃，天高任鸟飞。<br/> 📰要是觉得博主文章写的不错的话，还望大家三连支持一下呀！！！<br/> 👉关注✨点赞👍收藏📂</font></p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章要点</h3>\n<ul><li><a href=\"#_11\">每日推荐</a></li><li><a href=\"#_16\">前言</a></li><li><ul><li><a href=\"#1CSV_23\">1.导入CSV库</a></li><li><a href=\"#2CSV_34\">2.对CSV文件进行读写</a></li><li><ul><li><a href=\"#21_CSV_35\">2.1 用列表形式写入CSV文件</a></li><li><a href=\"#22_CSV_57\">2.2 用列表形式读取CSV文件</a></li><li><a href=\"#23_csv_78\">2.3 用字典形式写入csv文件</a></li><li><a href=\"#24_csv_103\">2.4 用字典形式读取csv文件</a></li></ul>\n</li><li><a href=\"#csv_117\">附：csv读写的模式</a></li></ul>\n</li><li><a href=\"#_133\">结语</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_11\"></a>每日推荐</h1>\n<blockquote>\n<p><font color=\"red\" size=\"3\">给大家推荐一款神器。无论你是学生党还是上班族都可以使用，这里涵盖了面试题库，在线刷题，各个大厂的面试/笔试真题等。如果你还是学生，最重要的一点就是模拟面试功能，智能AI1v1面试，帮助你早日拿到大厂offer！点击链接即可直达！=&gt;<a href=\"https://www.nowcoder.com/link/pc_csdncpt_sl_python\">牛客网-找工作神器</a><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\44f14238d92f45b79043a6022fda7017.png\"/></font></p>\n</blockquote>\n<h1><a id=\"_16\"></a>前言</h1>\n<blockquote>\n<p><font color=\"blue\">CSV(Comma-Separated Values)即逗号分隔值，一种以逗号分隔按行存储的文本文件，所有的值都表现为字符串类型（注意：数字为字符串类型）。<br/> 如果CSV中有中文，应以utf-8编码读写.</font></p>\n</blockquote>\n<h2><a id=\"1CSV_23\"></a>1.导入CSV库</h2>\n<table><tbody><tr><td align=\"left\" bgcolor=\"#afb4db\"> <font size=\"3\">python中对csv文件有自带的库可以使用，当我们要对csv文件进行读写的时候直接导入即可。 </font></td></tr></tbody></table>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> csv\n</code></pre>\n<h2><a id=\"2CSV_34\"></a>2.对CSV文件进行读写</h2>\n<h3><a id=\"21_CSV_35\"></a>2.1 用列表形式写入CSV文件</h3>\n<blockquote>\n<p>语法：csv.writer(f)：<br/> writer支持writerow(列表)单行写入，和writerows(嵌套列表)批量写入多行，无须手动保存。</p>\n</blockquote>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> csv\n\nheader <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'QQ_num'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wechat'</span><span class=\"token punctuation\">]</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'suliang'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'21'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'787991021'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'lxzy787991021'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'information.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">,</span>newline<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> fp<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 写</span>\n    writer <span class=\"token operator\">=</span>csv<span class=\"token punctuation\">.</span>writer<span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 设置第一行标题头</span>\n    writer<span class=\"token punctuation\">.</span>writerow<span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 将数据写入</span>\n    writer<span class=\"token punctuation\">.</span>writerows<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>结果：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f9ba72c2f64c4bf6964f36b419e9b9dc.png\"/><br/> <font color=\"#b2d235\"> 注意，打开文件时应指定格式为w, 文本写入.<br/> 打开文件时，指定不自动添加新行newline=‘’,否则每写入一行就或多一个空行。</font></p>\n<h3><a id=\"22_CSV_57\"></a>2.2 用列表形式读取CSV文件</h3>\n<blockquote>\n<p>语法：csv.reader(f, delimiter=‘,’)<br/> reader为生成器，每次读取一行，每行数据为列表格式，可以通过delimiter参数指定分隔符</p>\n</blockquote>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> csv\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'information.csv'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> fp<span class=\"token punctuation\">:</span>\n    reader <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span>reader<span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 获取标题</span>\n    header <span class=\"token operator\">=</span> <span class=\"token builtin\">next</span><span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>header<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 遍历数据</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> reader<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>结果：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\64bf068fd12347b096296245d84f7eca.png\"/><br/> <font color=\"#b2d235\"> 读取文件时文件路径务必要写对，不确定时可写绝对路径。要获取csv的内容则需要遍历再输出。</font></p>\n<h3><a id=\"23_csv_78\"></a>2.3 用字典形式写入csv文件</h3>\n<blockquote>\n<p>语法：csv.DicWriter(f)：<br/> 写入时可使用writeheader()写入标题，然后使用writerow(字典格式数据行)或writerows(多行数据)</p>\n</blockquote>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> csv\n\nheader <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">]</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'suliang'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'21'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'xiaoming'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'22'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'xiaohu'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'25'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'information.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">,</span>newline<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> fp<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 写</span>\n    writer <span class=\"token operator\">=</span>csv<span class=\"token punctuation\">.</span>DictWriter<span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">,</span>header<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 写入标题</span>\n    writer<span class=\"token punctuation\">.</span>writeheader<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 将数据写入</span>\n    writer<span class=\"token punctuation\">.</span>writerows<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>结果：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f0ebd160d1e442b2a822c7335a32921f.png\"/></p>\n<h3><a id=\"24_csv_103\"></a>2.4 用字典形式读取csv文件</h3>\n<blockquote>\n<p>语法：csv.DicReader(f, delimiter=‘,’)<br/> 直接将标题和每一列数据组装成有序字典（OrderedDict）格式，无须再单独读取标题行</p>\n</blockquote>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> csv\n\n<span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'information.csv'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">as</span> fp<span class=\"token punctuation\">:</span>\n    reader <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span>DictReader<span class=\"token punctuation\">(</span>fp<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> reader\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>结果：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6c34e9c1808a4d9bb2d084fa04e58708.png\"/></p>\n<h2><a id=\"csv_117\"></a>附：csv读写的模式</h2>\n<blockquote>\n<p>r：以读方式打开文件，可读取文件信息</p>\n</blockquote>\n<blockquote>\n<p>w： 已写方式打开文件，可向文件写入信息。如文件存在，则清空，再写入</p>\n</blockquote>\n<blockquote>\n<p>a：以追加模式打开文件，打开文件可指针移至末尾，文件不存在则创建</p>\n</blockquote>\n<blockquote>\n<p>r+：以读写方式打开文件，可对文件进行读和写操作</p>\n</blockquote>\n<blockquote>\n<p>w+：消除文件内容，以读写方式打开文件</p>\n</blockquote>\n<blockquote>\n<p>a+：以读写方式打开文件，文件指针移至末尾</p>\n</blockquote>\n<blockquote>\n<p>b：以二进制打开文件</p>\n</blockquote>\n<h1><a id=\"_133\"></a>结语</h1>\n<blockquote>\n<p>csv的读写就介绍到这里啦，希望能对你有所帮助。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\11e2d5bc275345fa970b5453404d4df1.png\"/><br/> <strong>关注我咱们下期再见！！</strong></p>\n</blockquote>\n<blockquote>\n<p><font size=\"3\"><b>更多题库和知识点总结，面试技巧请看=&gt;<a href=\"https://www.nowcoder.com/link/pc_csdncpt_sl_python\">牛客网</a>，快来和我一起刷题吧！</b></font></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-06-29 11:44:53", "summary": "作者简介：苏凉专注于网络爬虫，数据分析博客主页：苏凉的博客系列专栏：基础语法专栏名言警句：海阔凭鱼跃，天高任鸟飞。要是觉得博主文章写的不错的话，还望大家三连支持一下呀！！！关注点赞收藏文章要点每日推荐"}