{"blogid": "125064444", "writerAge": "码龄8年", "writerBlogNum": "106", "writerCollect": "1210", "writerComment": "1892", "writerFan": "5925", "writerGrade": "7级", "writerIntegral": "22526", "writerName": "阿J~", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125064444.jpg", "writerRankTotal": "651", "writerRankWeekly": "5471", "writerThumb": "2398", "writerVisitNum": "433402", "blog_read_count": "1035", "blog_time": "于 2022-05-31 15:14:01 发布", "blog_title": "【2022-05-31】JS逆向之易企秀", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>提示：文章仅供参考，禁止用于非法途径</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_7\">前言</a></li><li><a href=\"#_17\">一、页面分析</a></li><li><a href=\"#u_27\">二、参数u获取</a></li><li><a href=\"#_84\">三、总结</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<h1><a id=\"_7\"></a>前言</h1>\n<p>我滴个姥姥，好像是好久没跟了呀，主要是实在不知道写啥了</p>\n<p>今天这个表单是最近碰到，就拿出来分享下吧</p>\n<hr/>\n<h1><a id=\"_17\"></a>一、页面分析</h1>\n<p>表单可以自己在小程序里生成一个，这里我的链接就不放出来了</p>\n<p>最后表单提交的接口有个u，是我们需要解决的</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\382d491f9d8e4309bafad758c928196f.png\"/></p>\n<h1><a id=\"u_27\"></a>二、参数u获取</h1>\n<p>这里直接搜参数u 比较多，搜接口上的costTime即可定位到加密位置</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9af1e5c7417146cbb5ebd84e3ee97dc2.png\"/></p>\n<p>然后重新触发断点，加密位置u的来源为window.serverParams.u</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a86b59e2c9e1449bb7f93b5aa3fcbd97.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\458f1a96af7942829c66cef7f508322b.png\"/><br/> 然后这 i 是在window.scene里的<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b4ae453c358944cebfdbb05eac41d141.png\"/></p>\n<p>最终u的加密就是</p>\n<blockquote>\n<p>u = window.md5( window.scene.id+ “9902813631f94b89aa41786d50a7586a” + window.scene.id + window.serverParams.u)</p>\n</blockquote>\n<p>再去找<code>window.serverParams 、window.scene</code>，全局搜一下，在主页面的源码里可以找到<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\54530a3bd2594ae581cb2c41fe998d28.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\74931932c0be467cb0880bdf183b44be.png\"/></p>\n<p>但是呢，发现这里的u跟加密位置的竟然不一样，那么肯定是又经过处理了的</p>\n<p>这边直接下一个JS断点继续调试下</p>\n<p>在这个链接的JS里</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token literal-property property\">https</span><span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>form<span class=\"token operator\">-</span>preview<span class=\"token operator\">-</span>api<span class=\"token punctuation\">.</span>eqxiu<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>lp<span class=\"token operator\">/</span>env<span class=\"token punctuation\">.</span>js<span class=\"token operator\">?</span>r<span class=\"token operator\">=</span>Q1VQRys2aEZDTDY4SEUzRjlkWjd0YkVxNkVQdCtjVksyRHM4dkFxN05XMkRqSWcxSzU3UGVpc1VLRHVHdHNOdENhMlAxb3hnUXVmTUpaQTljVkkvaXpXWExpalZqQS9xUHJHenVUU2JGR1U9\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b2f8c24786204275b56c18bc27f0cc9b.png\"/></p>\n<p>一个是加密后的u，一个是原来的u</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5f1a0901a2ba4327bb1a29b56f3d3d7a.png\"/></p>\n<p>混淆的看着有点不方便，但是no慌，不需要解混淆，因为这个JS是动态的，在页面的源码里</p>\n<p>我们直接掏他JS，在补点需要的环境和参数就OK</p>\n<p>先返回混淆下加密的这段JS，看看有用到哪些参数</p>\n<pre><code class=\"prism language-javascript\">_0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>_0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'createTime'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>_0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span> _0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'code'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span> _0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'userId'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span> _0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'serverParams'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'u'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>_0x35bfbe<span class=\"token punctuation\">[</span><span class=\"token string\">'scene'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token string\">'5nbw346jm'</span>\n\n</code></pre>\n<p>这里我们看出来就是需要<code>window.serverParams 、window.scene</code>这两玩意</p>\n<p>其实就搞定了，哈哈哈，拿到JS后，可以匹配这玩意，然后替换成加密所需要的参数即可<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\39a8ebfcb6124a7982aa4e38f81e6f99.png\"/></p>\n<hr/>\n<h1><a id=\"_84\"></a>三、总结</h1>\n<p>好的拿下！</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\35e1ac6357b84f7091f1f1bdfc87a9b7.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "JavaScript", "cpp": 0, "csharp": 0, "python": 0, "javascript": 1, "java": 0, "sql": 0, "php": 0, "time": "2022-05-31 15:14:01", "summary": "提示：文章仅供参考，禁止用于非法途径文章目录前言一、页面分析二、参数获取三、总结前言我滴个姥姥，好像是好久没跟了呀，主要是实在不知道写啥了今天这个表单是最近碰到，就拿出来分享下吧一、页面分析表单可以自"}