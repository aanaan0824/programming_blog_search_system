{"blogid": "122946333", "writerAge": "码龄6年", "writerBlogNum": "204", "writerCollect": "954", "writerComment": "84", "writerFan": "11508", "writerGrade": "6级", "writerIntegral": "6007", "writerName": "Fighting_hawk", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_122946333.jpg", "writerRankTotal": "3081", "writerRankWeekly": "546", "writerThumb": "349", "writerVisitNum": "727051", "blog_read_count": "3343", "blog_time": "已于 2022-07-01 03:52:41 修改", "blog_title": "【HTML+PHP+SQL】综合实验：一个简单丑陋的论坛网站（实现用户注册、登录、注销、修改信息、留言等功能）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>目录</h3>\n<ul><li><a href=\"#1__1\">1 实验环境</a></li><li><a href=\"#2__5\">2 实验目标</a></li><li><ul><li><a href=\"#21__6\">2.1 目标</a></li><li><a href=\"#22__8\">2.2 页面功能规划</a></li><li><a href=\"#23__33\">2.3 网站文件组织结构</a></li></ul>\n</li><li><a href=\"#3__49\">3 实验阶段一：实现个人中心注册登录注销更新信息等功能</a></li><li><ul><li><a href=\"#31__50\">3.1 数据库</a></li><li><a href=\"#32_indexphp__55\">3.2 ./index.php 首页</a></li><li><a href=\"#33_incdblinkincphp_81\">3.3 ./inc/dblink.inc.php</a></li><li><a href=\"#34__memberindexphp_96\">3.4 ./member/index.php</a></li><li><a href=\"#35_memberregisterphp_144\">3.5 ./member/register.php</a></li><li><a href=\"#36_memberaddUserphp_165\">3.6 ./member/addUser.php</a></li><li><a href=\"#37_memberloginphp_209\">3.7 ./member/login.php</a></li><li><a href=\"#38_memberlogoutphp_258\">3.8 ./member/logout.php</a></li><li><a href=\"#39_memberupdatePhotophp_271\">3.9 ./member/updatePhoto.php</a></li><li><a href=\"#310_memberupdateSignaturephp_312\">3.10 ./member/updateSignature.php</a></li><li><a href=\"#311__341\">3.11 测试</a></li></ul>\n</li><li><a href=\"#4__371\">4 实验阶段二：完善留言板功能</a></li><li><ul><li><a href=\"#41_indexphp__372\">4.1 ./index.php 首页功能完善</a></li><li><a href=\"#42_showMessagesphp_424\">4.2 ./showMessages.php</a></li><li><a href=\"#43_messagesaddMessagesphp_461\">4.3 ./messages/addMessages.php</a></li><li><a href=\"#44__502\">4.4 测试</a></li></ul>\n</li><li><a href=\"#5__513\">5 总结</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"1__1\"></a>1 实验环境</h1>\n<ol><li>服务端：本实验基于虚拟机win2008系统的WAMP环境进行，该环境相关配置过程参考文章《<a href=\"https://blog.csdn.net/Fighting_hawk/article/details/122832076\">win2008R2SP1+WAMP环境部署</a>》。</li><li>客户端：使用浏览器访问与控制。</li><li>服务端与客户端处于同一个局域网下，开启服务端的phpstudy并确保能从客户端浏览器访问。</li></ol>\n<h1><a id=\"2__5\"></a>2 实验目标</h1>\n<h2><a id=\"21__6\"></a>2.1 目标</h2>\n<p>写一个网站，在首页能看用户的留言，同时能实现包括用户注册、登录、注销、上传头像、修改个性签名等。</p>\n<h2><a id=\"22__8\"></a>2.2 页面功能规划</h2>\n<ol><li>论坛首页： \n  <ol><li>显示论坛标题；</li><li>根据用户是否登录分支显示：已登录则显示“欢迎来到论坛首页”字样，同时显示个人中心、注销、新增留言等按钮；未登录则显示注册和登录按钮，未登录仅能看留言。</li><li>网页主体用于显示留言（后续实验完善留言功能），</li></ol> </li><li>个人中心页面： \n  <ol><li>标题显示个人中心；</li><li>根据用户是否登录分支显示：已登录则显示欢迎“欢迎来到个人中心”字样、显示个人账号、头像及个性签名信息、同时显示信息修改和注销按钮；未登录则显示注册和登录按钮。</li></ol> </li><li>注册页面： \n  <ol><li>设置表单用于收集用户输入的账号及两次输入的密码，设置提交按钮用于提交表单数据。</li><li>后台完成账号密码的验证：（1）账号或密码为空，则返回注册页面“提示账号密码不能为空，请重新输入”；（2）若两次密码不一致，则返回注册页面并提示“两次密码输入不一致”；（3）若账号已在数据库中存在，则返回注册页面并提示“账号已存在，请重新注册”；（4）账号密码没问题则存入数据库中，并返回COOKIE。</li></ol> </li><li>登录页面： \n  <ol><li>设置表单用于收集用户输入账号及密码，设置提交按钮用于提交表单数据。</li><li>后台完成账号密码与数据库数据验证，账号密码正确则返回COOKIE、显示欢迎字样、并提供返回首页与个人中心按钮；账号密码错误则重定向到登录页面重新输入。</li><li>暂时不考虑设置验证码的功能。</li></ol> </li><li>注销页面： \n  <ol><li>删除COOKIE；</li><li>并根据是否注销成功分支显示：成功则提示成功并显示返回首页按钮，失败则显示注销失败。</li></ol> </li><li>个人信息修改页面： \n  <ol><li>提供头像修改、个性签名修改、返回个人中心等三个按钮。</li><li>头像修改页面，显示按钮让用户选择新头像，修改成功后页面显示修改成功，提供返回个人中心和返回首页等按钮。</li><li>个性签名修改页面，功能基本与头像修改页面一致。</li></ol> </li><li>数据库： \n  <ol><li>users表：保存用户注册与修改的数据。该表共有5个字段，分别是id、name、password、photo、signature。</li><li>messages表：保存首页用户留言数据。该表共有4个字段，分别是id、uname、title、content。</li></ol> </li></ol>\n<h2><a id=\"23__33\"></a>2.3 网站文件组织结构</h2>\n<ul><li>index.php ——论坛首页</li><li>messages ——留言文件夹 \n  <ul><li>showMessages.php ——显示留言内容</li><li>addMessages.php ——新增留言</li></ul> </li><li>member ——个人中心文件夹 \n  <ul><li>index.php ——个人中心主页</li><li>register.php ——实现注册功能</li><li>addUser.php ——接收来自注册页面的表单数据，逻辑判断并返回相应页面</li><li>login.php ——登录页面</li><li>logout.php ——注销页面</li><li>updatePhoto.php ——修改头像页面</li><li>updateSignature ——修改个性签名</li><li>images ——文件夹 用于存放图片</li></ul> </li><li>inc ——数据库文件夹 \n  <ul><li>dblink.inc.php ——用于与数据库交互，在其他页面中使用include引入。</li></ul> </li></ul>\n<h1><a id=\"3__49\"></a>3 实验阶段一：实现个人中心注册登录注销更新信息等功能</h1>\n<h2><a id=\"31__50\"></a>3.1 数据库</h2>\n<ol><li>先在数据库中创建一个my_test的数据库。<img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\137a4dd53b91472d9793906ed2b70052.png\"/></li><li>在该数据库下创建两个表，一个是users，一个是messages，所含字段分别如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\fd0c11db08134e83a6ca2b15f5f906cf.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a2b8eed2b8f34d35a403c62550a4a029.png\"/></li></ol>\n<h2><a id=\"32_indexphp__55\"></a>3.2 ./index.php 首页</h2>\n<ol><li>首页位于默认站点位置。</li><li>代码如下。</li></ol>\n<pre><code class=\"prism language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>留言论坛<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span>综合实验：留言论坛<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token prolog\">&lt;?php\nif (isset($_COOKIE['name'])){\n\techo \"欢迎来到论坛，\".$_COOKIE['name'].\"&lt;br&gt;\";\n\techo \"&lt;a href = './member/index.php'&gt;个人中心&lt;/a&gt;  \";\n\techo \"&lt;a href = './member/logout.php'&gt;注销&lt;/a&gt;\";\n}else{\n\techo \"&lt;a href = './member/register.php'&gt;注册&lt;/a&gt;  \";\n\techo \"&lt;a href = './member/login.php'&gt;登录&lt;/a&gt;\";\n}\t\n?&gt;</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">&gt;</span></span>！此处用作留言板！<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h2><a id=\"33_incdblinkincphp_81\"></a>3.3 ./inc/dblink.inc.php</h2>\n<ol><li>为其他需要连接数据库的网页提供连接，避免重复定义。</li><li>此处账户名和密码是否需要修改呢？</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$dbHost</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"127.0.0.1\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$dbUser</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"root\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$dbPass</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"root\"</span><span class=\"token punctuation\">;</span>\t\n<span class=\"token variable\">$dbName</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"my_test\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$link</span> <span class=\"token operator\">=</span> @<span class=\"token function\">mysqli_connect</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dbHost</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$dbUser</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$dbPass</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$dbName</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_connect_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">mysqli_set_charset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"34__memberindexphp_96\"></a>3.4 ./member/index.php</h2>\n<ol><li>如果已经登录，可以利用COOKIE信息中的name字段，来获取数据库中该会员信息。</li><li>代码如下</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span>留言论坛<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">&gt;</span>个人中心<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from users where name ='\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$username</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token comment\">//var_dump($result);</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;hr /&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"欢迎来到个人中心，\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\" &lt;a href = '../index.php'&gt;返回首页&lt;/a&gt;  &lt;a href = './logout.php'&gt;注销&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;hr /&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"个人信息：&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"账号名：\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token comment\">//echo $result['photo</span><span class=\"token string single-quoted-string\">'];\n\t\t\techo \"头像：&lt;img src ='</span><span class=\"token string double-quoted-string\">\".<span class=\"token interpolation\"><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'photo'</span><span class=\"token punctuation\">]</span></span>.\"</span><span class=\"token string single-quoted-string\">'&gt; &lt;a href = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>updatePhoto<span class=\"token operator\">.</span>php<span class=\"token string single-quoted-string\">'&gt;更新头像&lt;/a&gt;&lt;br&gt;\";\n\t\t\techo \"个性签名：\".$result['</span>signature<span class=\"token string single-quoted-string\">'].\" &lt;a href = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>updateSignature<span class=\"token operator\">.</span>php<span class=\"token string single-quoted-string\">'&gt;更新签名&lt;/a&gt;&lt;br&gt;\";\n\t\t}else{\n\t\t\techo \"用户不存在！请&lt;a hred = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>register<span class=\"token operator\">.</span>php<span class=\"token string single-quoted-string\">'&gt;注册&lt;/a&gt;\";\n\t\t}\n\t}else{\n\t\techo \"数据获取失败！请重新&lt;a hred = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>login<span class=\"token operator\">.</span>php<span class=\"token string single-quoted-string\">'&gt;登录&lt;/a&gt;&lt;br&gt;\";\n\t\tdie (mysqli_error());\n\t}\n}else{\n\techo \"&lt;a href = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>register<span class=\"token operator\">.</span>php<span class=\"token string single-quoted-string\">'&gt;注册&lt;/a&gt;  \";\n\techo \"&lt;a href = '</span><span class=\"token operator\">.</span><span class=\"token operator\">/</span>login<span class=\"token operator\">.</span>php'<span class=\"token operator\">&gt;</span>登录<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span>\"<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\t\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"35_memberregisterphp_144\"></a>3.5 ./member/register.php</h2>\n<ol><li>设置表单用于收集用户输入的账号及两次输入的密码，设置提交按钮用于提交表单数据。</li><li>代码如下：</li></ol>\n<pre><code class=\"prism language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>留言论坛<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">&gt;</span></span>综合实验：留言论坛<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">action</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>./addUser.php<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\t用户名：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>userName<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n\t密码：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>userPass1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n\t确认密码：<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>userPass2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>userSubmit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span> <span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span> <span class=\"token punctuation\">\"</span>注册<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">&gt;</span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token punctuation\">/&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h2><a id=\"36_memberaddUserphp_165\"></a>3.6 ./member/addUser.php</h2>\n<ol><li>后台完成账号密码的验证：（1）账号或密码为空，则返回注册页面“提示账号密码不能为空，请重新输入”；（2）若两次密码不一致，则返回注册页面并提示“两次密码输入不一致”；（3）若账号已在数据库中存在，则返回注册页面并提示“账号已存在，请重新注册”；（4）账号密码没问题则存入数据库中，并返回COOKIE。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token comment\">//var_dump($_POST);</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;hr /&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSubmit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_null</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userName'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token function\">is_null</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token function\">is_null</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"账号密码不能为空，请&lt;a href = './register.php'&gt;重新注册&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"两次密码不一致，请&lt;a href = './register.php'&gt;重新注册&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token comment\">// 查询数据库中是否有此用户，若无则新增，若有则要求重新输入</span>\n\t\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from users where name = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userName'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token comment\">//为空则新增</span>\n\t\t\t\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"insert into users (name,password) values ('\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userName'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"','\"</span><span class=\"token operator\">.</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"')\"</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token comment\">//echo $sql.\"&lt;hr /&gt;\";</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"注册成功，请&lt;a href = './login.php'&gt;登录&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"注册失败！请&lt;a href = './register.php'&gt;再次注册&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"该用户已存在，请&lt;a href = './register.php'&gt;重新注册&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"数据获取失败！\"</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">die</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token function\">header</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Location:./register.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"37_memberloginphp_209\"></a>3.7 ./member/login.php</h2>\n<ol><li>设置表单用于收集用户输入账号及密码，设置提交按钮用于提交表单数据。</li><li>setcookie设置路径：设置成 ‘/’ 时，Cookie 对整个域名 domain 有效。 如果设置成 ‘/foo/’， Cookie 仅仅对 domain 中 /foo/ 目录及其子目录有效（比如 /foo/bar/）。 默认值是设置 Cookie 时的当前目录。因此，为了让首页也能获取到cookie，需要设置路径为根据经。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSubmit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token comment\">//var_dump($_POST);</span>\n\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from users where name = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userName'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"' and password ='\"</span><span class=\"token operator\">.</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userPass'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//echo $sql;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token function\">setcookie</span> <span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userName'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">3600</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"登录成功，请返回&lt;a href = '../index.php'&gt;首页&lt;/a&gt;或&lt;a href = './index.php'&gt;个人中心&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"账号或密码错误，请&lt;a href = './login.php'&gt;重新输入&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"请输入账号密码\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">// $html=&lt;&lt;&lt;HTML</span>\n    <span class=\"token comment\">// &lt;form method = \"post\" target = \"_blank\"&gt;</span>\n    <span class=\"token comment\">// 用户名：&lt;input type = \"text\" name = \"userName\"&gt;&lt;br&gt;</span>\n    <span class=\"token comment\">// 密码：&lt;input type = \"password\" name = \"userPass\"&gt;&lt;br&gt;</span>\n    <span class=\"token comment\">// &lt;input type=\"submit\" name=\"userSubmit\" value=\"登录\"&gt;</span>\n    <span class=\"token comment\">// &lt;/form&gt;</span>\n\t<span class=\"token comment\">// HTML;</span>\n\t<span class=\"token comment\">// echo $html;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>form method <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"post\"</span> target <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"_blank\"</span><span class=\"token operator\">&gt;</span>\n用户名：<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"text\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userName\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n密码：<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"password\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userPass\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>input type<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"submit\"</span> name<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"userSubmit\"</span> value<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"登录\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<ol start=\"4\"><li>存在问题：不知道为什么将表单以定界符的形式写在PHP代码段里，执行就出现了以下错误提示，如有大神发现问题还麻烦告知。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\214b091f27554424990e6575a2a9b423.png\"/></li></ol>\n<h2><a id=\"38_memberlogoutphp_258\"></a>3.8 ./member/logout.php</h2>\n<ol><li>删除COOKIE；</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">setcookie</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">3600</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"logout!\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">header</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Location:../index.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">die</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"39_memberupdatePhotophp_271\"></a>3.9 ./member/updatePhoto.php</h2>\n<ol><li>用于更新头像。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSubmit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t@<span class=\"token variable\">$userName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//var_dump ($_FILES);</span>\n\t<span class=\"token variable\">$tmp_path</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'up'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"tmp_name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">//echo $tmp_path;</span>\n\t<span class=\"token variable\">$path</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"./images/\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'up'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"name\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">move_uploaded_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$tmp_path</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token variable\">$path</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"update users set photo = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$path</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"' where name = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$userName</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"头像上传成功，请&lt;a href = './index.php'&gt;返回个人中心&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">die</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"头像上传失败\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"请选择上传头像\"</span><span class=\"token punctuation\">;</span>\t\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>form method <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"POST\"</span> enctype <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"multipart/form-data\"</span><span class=\"token operator\">&gt;</span>\n\t<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"file\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"up\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n\t<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"submit\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userSubmit\"</span> value <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"提交\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"310_memberupdateSignaturephp_312\"></a>3.10 ./member/updateSignature.php</h2>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSubmit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t@<span class=\"token variable\">$userName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"update users set signature = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSignature'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"' where name = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$userName</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"签名更新成功，请&lt;a href = './index.php'&gt;返回个人中心&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">die</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"请更新签名\"</span><span class=\"token punctuation\">;</span>\t\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>form method <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"POST\"</span> <span class=\"token operator\">&gt;</span>\n\t输入个性签名：<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"text\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userSignature\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n\t<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"submit\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userSubmit\"</span> value <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"提交\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"311__341\"></a>3.11 测试</h2>\n<ol><li>访问首页，显示结果为：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7d2e9ce79536419c878a768e97d5ab8c.png\"/></li><li>点击注册，账号密码均输入a。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e2961f19310c40a89d4fe6430a961020.png\"/></li><li>点击注册时，页面显示如下，提示已经注册过了该账户。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c2e46d06e40a4b88b940a2c5034729cb.png\"/></li><li>重新注册，账号密码输入b，点击注册，弹出以下提示。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a27a3194ec324d37b8ed6c327309caf1.png\"/></li><li>点击登录，输入账号密码b，点击登录。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ff2f2382e8004c068e5c1f8ea32a64d4.png\"/></li><li>显示登录成功，网页获取到服务端发来的COOKIE，返回首页与个人中心均可用。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a7d40436f3d943179c9dd1d09501eec0.png\"/></li><li>返回首页的页面结果。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7fcae1e908294ed2ae9fc8583d26c8c3.png\"/></li><li>返回个人中心的页面结果。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\eb16b28159d5438db231503a8f6201b8.png\"/></li><li>点击更新头像，选择自己的图片文件，并点击提交。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\dfb9173e90cd47d7b3594f21ae73f6d9.png\"/></li><li>图像上传成功，点击返回个人中心。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\adadadfc11a646e2b45b2d49a16d6dad.png\"/></li><li>返回个人中心后可以看到自己上传的头像。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\25e7824217f64cbea38c1382466cc4a7.png\"/></li><li>点击更新签名，出现以下界面，输入自己的签名“hello world！并点击提交。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\eb5134acd7604951aa94a32b0320dc51.png\"/></li><li>提交后显示签名更新成功。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\31691c09323c4cbb9182148da2411051.png\"/></li><li>点击返回个人中心，可以看到个人中心信息已齐全。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b35a12cfd93b454e82c4507f6991e0f9.png\"/></li><li>点击注销即退出登录，系统将删除COOKIE，并返回首页。<img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0b80483936a34269ae0463e5412da11f.png\"/></li></ol>\n<h1><a id=\"4__371\"></a>4 实验阶段二：完善留言板功能</h1>\n<h2><a id=\"41_indexphp__372\"></a>4.1 ./index.php 首页功能完善</h2>\n<ol><li>让原本的首页增加留言相关功能，包括显示留言及新增留言。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"./inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span>留言论坛<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">&gt;</span>综合实验：留言论坛<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"欢迎来到论坛，\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;a href = './member/index.php'&gt;个人中心&lt;/a&gt;  \"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;a href = './member/logout.php'&gt;注销&lt;/a&gt;  \"</span>  <span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;a href = './messages/addMessages.php'&gt;我要留言&lt;/a&gt;\"</span>  <span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;a href = './member/register.php'&gt;注册&lt;/a&gt;  \"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;a href = './member/login.php'&gt;登录&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\t\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;hr /&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from messages\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_num_rows</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;table border = 2&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;tr&gt;&lt;td&gt;ID&lt;/td&gt;&lt;td&gt;TITLE&lt;/td&gt;&lt;td&gt;AUTHOR&lt;/td&gt;&lt;/tr&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;tr&gt;\n\t\t\t&lt;td&gt;\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/td&gt;\n\t\t\t&lt;td&gt;&lt;a href = './messages/showMessages.php?id=<span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span></span>' target='_blank'&gt;\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/a&gt;&lt;/td&gt;\n\t\t\t&lt;td&gt;\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uname'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;/td&gt;\n\t\t\t&lt;/tr&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/table&gt;\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"暂无留言\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"42_showMessagesphp_424\"></a>4.2 ./showMessages.php</h2>\n<ol><li>用读者点击首页留言标题时，跳转到此页面，用于展示该留言内容。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span>留言论坛<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">&gt;</span>留言内容<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>a href <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'../index.php'</span><span class=\"token operator\">&gt;</span>返回首页<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>hr <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token variable\">$id</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//echo $id;</span>\n\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from messages where id =\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">//echo $sql;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_assoc</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$results</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"作者：\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uname'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;br&gt;标题：\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"&lt;hr /&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$result</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'content'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"ID error!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"43_messagesaddMessagesphp_461\"></a>4.3 ./messages/addMessages.php</h2>\n<ol><li>作用：提供已登录的用户新增刘洋。</li><li>代码：</li></ol>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">include</span> <span class=\"token string double-quoted-string\">\"../inc/dblink.inc.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token comment\">//echo \"已登录\";</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userSubmit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userTitle'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token variable\">$userName</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$title</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userTitle'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$cont</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_real_escape_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'userCont'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"insert into messages (uname,title,content) values ('\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$userName</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"','\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$title</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"','\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$cont</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"')\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//echo $sql;</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span><span class=\"token string double-quoted-string\">\"留言成功,&lt;a href = '../'&gt;返回首页&lt;/a&gt;\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"留言失败\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"标题不能为空，请点击提交按钮进行提交。\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"您还未登录，请&lt;a href = '../member/login.php'&gt;登录&lt;/a&gt;后留言。\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>form method <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"POST\"</span><span class=\"token operator\">&gt;</span>\n标题：<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"text\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userTitle\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n内容：<span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>textarea name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userCont\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>textarea<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>input type <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"submit\"</span> name <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"userSubmit\"</span> value <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"提交\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token function\">mysqli_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$link</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<h2><a id=\"44__502\"></a>4.4 测试</h2>\n<ol><li>浏览器打开首页，未登录的没有新增留言功能。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ee2780eabb484501aecf1ac479dfa024.png\"/></li><li>登录后再次返回首页，可以看到“我要留言”的字样。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ed54111afd604dec876f44be2fd4d2ee.png\"/></li><li>点击“我要留言”，输入自己的留言并点击提交。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\66cef3263a0843d9ae64c853d363c7ff.png\"/></li><li>可以看到留言成功，点击返回首页。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7c59d09075234a67bdfa6143d0ff201e.png\"/></li><li>点击刚刚新增的这个留言标题，查看留言内容。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8f5d47b461004f8999dacf59df904742.png\"/></li></ol>\n<h1><a id=\"5__513\"></a>5 总结</h1>\n<ol><li>理解开发功能需求、合理规划网页布局；</li><li>了解各个网页之间的跳转和参数的提交；</li><li>加深对SQL、HTML、PHP的应用熟练度；</li><li>掌握最基本的网页开发技能。</li></ol>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-07-01 03:52:41", "summary": "目录实验环境实验目标目标页面功能规划网站文件组织结构实验阶段一：实现个人中心注册登录注销更新信息等功能数据库首页测试实验阶段二：完善留言板功能首页功能完善测试总结实验环境服务端：本实验基于虚拟机系统的"}