{"blogid": "126743612", "writerAge": "码龄1年", "writerBlogNum": "474", "writerCollect": "211", "writerComment": "26", "writerFan": "6268", "writerGrade": "6级", "writerIntegral": "4976", "writerName": "geejkse_seff", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126743612.jpg", "writerRankTotal": "3816", "writerRankWeekly": "1358", "writerThumb": "38", "writerVisitNum": "178633", "blog_read_count": "12", "blog_time": "于 2022-09-07 13:13:28 发布", "blog_title": "JVM之栈帧解析", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"_2\"></a>概述</h2>\n<p>学习JVM内存模型中，一定会涉及到虚拟机栈，而栈帧是虚拟机栈的主要组成部分，这里详细介绍下栈帧到底是什么以及是怎么运行的，内容主要包括：</p>\n<p>1.JVM栈及栈帧的介绍</p>\n<p>2.代码执行过程中栈帧的变化过程</p>\n<h2><a id=\"JVM_11\"></a>JVM栈及栈帧的介绍</h2>\n<p>我们都知道虚拟机栈，它是每个线程私有的运行时堆栈，每个方法会创建一个栈帧，栈帧主要包含：本地变量列表、操作数栈、指向常量池的指针、返回地址。</p>\n<p><img alt=\"\" src=\"..\\..\\static\\image\\b1c8aff29a6d477e8ad3b3dc1e997fad.png\"/></p>\n<h2><a id=\"_18\"></a>代码执行过程中栈帧的变化过程</h2>\n<p>在代码执行过程中，栈帧的变化过程及步骤是什么样的那，我们通过一个代码示例详细讲解下，代码如下：</p>\n<pre><code>public class TestDemo {\n    public static void main(String [] args){\n        int a=1;\n        int b=1;\n        int c=a+b;\n    }\n}\n</code></pre>\n<p>这是一个很简单的代码，就是局部变量a,b初始化为1，c是有a+b计算得到，那么编译后看到的字节码如下：</p>\n<pre><code>stack=2,locals=4,args_size=1\n0:iconst_1\n1:istore_1\n2:iconst_1\n3:istore_2\n4:iload_1\n5:iload-2\n6:iadd\n7:istore_3\n8:return\n</code></pre>\n<p>我们一步一步的讲解下，从0到8JVM的执行过程中栈帧的各部分变化：</p>\n<p>1）0:iconst_1 其实是代表的是我们的局部变量a=1,这时候是将1入栈（操作数栈）。</p>\n<p>2）1:istore_1这步那是将1这个值从操作数栈中取出，放到局部变量表中，这时候局部变量表中就有一个值1</p>\n<p>3）2:iconst_1 和3:istore_2 这两个指令那跟1）2）不是一样的，只不过是将b=1压栈，出栈放到局部量表中，执行完这两个后，局部变量表中就会存在两个变量啊a,b了。</p>\n<p>4）4:iload_1，5:iload-2分别是将a、b两个变量值从局部量表取出放入操作数栈中。</p>\n<p>5）6:iadd 其实执行的是c=a+b,就是将a和b从栈中取出相加,同时将结果2放入操作数栈，。</p>\n<p>6）7:istore_3是指将c=2放到局部变量表中，这时候局部变量表就有3个变量值了。</p>\n<p>7）8:return 就是直接返回了，这个具体不细讲了。</p>\n<p>具体如下图：</p>\n<p><img alt=\"\" src=\"..\\..\\static\\image\\c3a8ade08f854280a6cbfcea23d267f6.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-07 13:13:28", "summary": "概述学习内存模型中，一定会涉及到虚拟机栈，而栈帧是虚拟机栈的主要组成部分，这里详细介绍下栈帧到底是什么以及是怎么运行的，内容主要包括：栈及栈帧的介绍代码执行过程中栈帧的变化过程栈及栈帧的介绍我们都知道"}