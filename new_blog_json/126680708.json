{"blogid": "126680708", "writerAge": "ç é¾„7å¹´", "writerBlogNum": "230", "writerCollect": "14818", "writerComment": "509", "writerFan": "3757", "writerGrade": "7çº§", "writerIntegral": "11548", "writerName": "DanCheng-studio", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126680708.jpg", "writerRankTotal": "938", "writerRankWeekly": "684", "writerThumb": "1841", "writerVisitNum": "1213985", "blog_read_count": "619", "blog_time": "äºÂ 2022-09-03 18:12:24Â å‘å¸ƒ", "blog_title": "ã€æ¯•ä¸šè®¾è®¡ã€‘åŸºäºæœºå™¨å­¦ä¹ ä¸å¤§æ•°æ®çš„ç³–å°¿ç—…é¢„æµ‹", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"1__0\"></a>1 å‰è¨€</h1>\n<p>ğŸš© <strong>åŸºäºæœºå™¨å­¦ä¹ ä¸å¤§æ•°æ®çš„ç³–å°¿ç—…é¢„æµ‹</strong></p>\n<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p>\n<ul><li>éš¾åº¦ç³»æ•°ï¼š3åˆ†</li><li>å·¥ä½œé‡ï¼š3åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š4åˆ†</li></ul>\n<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š</strong></p>\n<p><a href=\"https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md\">https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md</a></p>\n<h1><a id=\"1__14\"></a>1 è¯¾é¢˜èƒŒæ™¯</h1>\n<p>æœ¬é¡¹ç›®çš„ç›®çš„ä¸»è¦æ˜¯å¯¹ç³–å°¿ç—…è¿›è¡Œé¢„æµ‹ã€‚ä¸»è¦ä¾æ‰˜æŸåŒ»é™¢ä½“æ£€æ•°æ®ï¼ˆå¤„ç†åï¼‰ï¼Œé¦–å…ˆè¿›è¡Œäº†æ•°æ®çš„æè¿°æ€§ç»Ÿè®¡ã€‚åç»­é’ˆå¯¹æ•°æ®çš„ç‰¹å¾è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼ˆä¸‰ç§æ–¹æ³•ï¼‰ï¼Œé€‰å‡ºä¸æ€§åˆ«ã€å¹´é¾„ç­‰é¢„æµ‹ç›¸å…³åº¦æœ€é«˜çš„å‡ ä¸ªå±æ€§å€¼ã€‚æ­¤åé€‰æ‹©Logisticå›å½’ã€æ”¯æŒå‘é‡æœºå’ŒXGBoostä¸‰ç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå°†é€‰æ‹©å¥½çš„å±æ€§å€¼è¾“å…¥å¯¹ç³–å°¿ç—…é£é™©é¢„è­¦æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå¹¶è¿ç”¨F1-Scoreã€AUCå€¼ç­‰æ–¹æ³•è¿›è¡Œé¢„è­¦æ¨¡å‹çš„åˆ†æè¯„ä»·ã€‚æœ€åè¿›è¡Œäº†æ¨¡å‹çš„è°ƒå‚ï¼ˆGridSearchï¼‰ï¼Œé€‰æ‹©äº†æœ€ä¼˜å‚æ•°è¾“å…¥æ¨¡å‹ï¼Œå¯¹æ¯”åå‘ç°æ¨¡å‹æ€§èƒ½å¾—åˆ°äº†ä¸€å®šæå‡ã€‚</p>\n<h1><a id=\"2__18\"></a>2 æ•°æ®å¯¼å…¥å¤„ç†</h1>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> scipy\n<span class=\"token keyword\">import</span> warnings\nwarnings<span class=\"token punctuation\">.</span>filterwarnings<span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># æ˜¾ç¤ºæ‰€æœ‰åˆ—</span>\npd<span class=\"token punctuation\">.</span>set_option<span class=\"token punctuation\">(</span><span class=\"token string\">'display.max_columns'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># æ˜¾ç¤ºæ‰€æœ‰è¡Œ</span>\npd<span class=\"token punctuation\">.</span>set_option<span class=\"token punctuation\">(</span><span class=\"token string\">'display.max_rows'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>rcParams<span class=\"token punctuation\">[</span><span class=\"token string\">'font.sans-serif'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'KaiTi'</span><span class=\"token punctuation\">]</span>\nplt<span class=\"token punctuation\">.</span>rcParams<span class=\"token punctuation\">[</span><span class=\"token string\">'axes.unicode_minus'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\nxls1<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>ExcelFile<span class=\"token punctuation\">(</span><span class=\"token string\">r'/home/mw/input/6661075/dia.xls'</span><span class=\"token punctuation\">)</span>\ndataConcat1<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>read_excel<span class=\"token punctuation\">(</span>xls1<span class=\"token punctuation\">)</span>\ndataConcat1<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\254836d50e514c4294e20259671d70f6.png\"/></p>\n<p>ä¸ºäº†åç»­æ›´å¥½åœ°å°†æ•°æ®è¾“å…¥æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæœ‰å¿…è¦å°†æŸäº›æ•°æ®åˆ—è¿›è¡Œåˆ†æ¡¶</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#%matplotlib notebook #äº¤äº’å¼å›¾è¡¨</span>\nage<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'å¹´é¾„'</span><span class=\"token punctuation\">]</span>\nage_binary<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>age<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>right<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'å¹´é¾„_cut'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>age_binary\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'å¹´é¾„_cut'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'å¹´é¾„_cut'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">)</span>\n\npulse<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">]</span>\npulse_binary<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>pulse<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>right<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#rightï¼šboolå‹å‚æ•°ï¼Œé»˜è®¤ä¸ºTrueï¼Œè¡¨ç¤ºæ˜¯å¦åŒ…å«åŒºé—´å³éƒ¨ã€‚æ¯”å¦‚å¦‚æœbins=[1,2,3]ï¼Œright=Trueï¼Œåˆ™åŒºé—´ä¸º(1,2]ï¼Œ(2,3]ï¼›right=Falseï¼Œåˆ™åŒºé—´ä¸º(1,2),(2,3)</span>\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>pulse_binary\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">)</span>\n\npressure<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">]</span>\npressure_binary<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>cut<span class=\"token punctuation\">(</span>pressure<span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">89</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>right<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>pressure_binary\ndataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span><span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token string\">\"float\"</span><span class=\"token punctuation\">)</span>\n\ndataConcat1<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c0a39c0836f348dfa55c0e7e0bf61e87.png\"/></p>\n<h1><a id=\"3__68\"></a>3 æ•°æ®å¯è§†åŒ–åˆ†æ</h1>\n<pre><code class=\"prism language-python\">fig<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplots_adjust<span class=\"token punctuation\">(</span>wspace <span class=\"token operator\">=</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span>hspace <span class=\"token operator\">=</span> <span class=\"token number\">0.4</span> <span class=\"token punctuation\">)</span>  <span class=\"token comment\">#è°ƒæ•´å­å›¾å†…éƒ¨é—´è·</span>\na2<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>colspan<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> \ndiabetes_0_1 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">.</span>ä½“é‡æ£€æŸ¥ç»“æœ<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndiabetes_1_1 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">.</span>ä½“é‡æ£€æŸ¥ç»“æœ<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndf1<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'ç³–å°¿ç—…æ‚£è€…'</span><span class=\"token punctuation\">:</span>diabetes_1_1<span class=\"token punctuation\">,</span><span class=\"token string\">'æ­£å¸¸äºº'</span><span class=\"token punctuation\">:</span>diabetes_0_1<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nweight_map<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token string\">'è¾ƒç˜¦'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token string\">'æ­£å¸¸'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token string\">'åé‡'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token string\">'è‚¥èƒ–'</span><span class=\"token punctuation\">}</span>\ndf1<span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> df1<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>weight_map<span class=\"token punctuation\">)</span>\na2<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'è¾ƒç˜¦'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'æ­£å¸¸'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'åé‡'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'è‚¥èƒ–'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>df1<span class=\"token punctuation\">[</span><span class=\"token string\">'ç³–å°¿ç—…æ‚£è€…'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\na2<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'è¾ƒç˜¦'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'æ­£å¸¸'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'åé‡'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'è‚¥èƒ–'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>df1<span class=\"token punctuation\">[</span><span class=\"token string\">'æ­£å¸¸äºº'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"BMIä¸åŒçš„äººæ‚£ç³–å°¿ç—…æƒ…å†µ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"ä½“é‡æ£€æŸ¥ç»“æœ\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"äººæ•°\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\na1<span class=\"token operator\">=</span>plt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndiabetes_0 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">.</span>æ€§åˆ«<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndiabetes_1 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">.</span>æ€§åˆ«<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value_counts<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'ç³–å°¿ç—…æ‚£è€…'</span><span class=\"token punctuation\">:</span>diabetes_1<span class=\"token punctuation\">,</span><span class=\"token string\">'æ­£å¸¸äºº'</span><span class=\"token punctuation\">:</span>diabetes_0<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nsex_map<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ç”·'</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token string\">'å¥³'</span><span class=\"token punctuation\">}</span>\ndf<span class=\"token punctuation\">.</span>index <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>sex_map<span class=\"token punctuation\">)</span>\na1<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ç”·'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å¥³'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'ç³–å°¿ç—…æ‚£è€…'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\na1<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ç”·'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å¥³'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'æ­£å¸¸äºº'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>bottom<span class=\"token operator\">=</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ç³–å°¿ç—…æ‚£è€…'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"ç”·å¥³æ‚£ç³–å°¿ç—…æƒ…å†µ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"æ€§åˆ«\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"äººæ•°\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>å¹´é¾„<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>   \ndataConcat1<span class=\"token punctuation\">.</span>å¹´é¾„<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¹´é¾„\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"ç³–å°¿ç—…å’Œæ­£å¸¸äººå¹´é¾„åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>ä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>ä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"ä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"ä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>æä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>æä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"æä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"æä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>å°¿ç´ æ°®<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>å°¿ç´ æ°®<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å°¿ç´ æ°®\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å°¿ç´ æ°®åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>å°¿é…¸<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>å°¿é…¸<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å°¿é…¸\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å°¿é…¸åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>subplot2grid<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>è‚Œé…<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span> \ndataConcat1<span class=\"token punctuation\">.</span>è‚Œé…<span class=\"token punctuation\">[</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—… <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>kind<span class=\"token operator\">=</span><span class=\"token string\">'kde'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"è‚Œé…\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># plots an axis lable</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">u\"å¯†åº¦\"</span><span class=\"token punctuation\">)</span> \nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">u\"è‚Œé…åˆ†å¸ƒ\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">u'ç³–å°¿ç—…'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'æ­£å¸¸äºº'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\02650403028141b9ad6b5d85563808b0.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\5ab1512b08f64d53802c22404a3ce58d.png\"/><br/> ä»åŸºæœ¬çš„æè¿°æ€§ç»Ÿè®¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ç³–å°¿ç—…äººä¸æ­£å¸¸äººä¹‹é—´çš„çš„ä¸€äº›å·®å¼‚ï¼Œæ¯”å¦‚ä½“é‡æŒ‡æ•°è¾ƒé«˜ï¼Œé«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡è¾ƒä½ï¼Œå°¿ç´ æ°®å’Œå°¿é…¸è¾ƒé«˜ç­‰ã€‚</p>\n<h1><a id=\"4__163\"></a>4 ç‰¹å¾é€‰æ‹©</h1>\n<h2><a id=\"41__165\"></a>4.1 é€šè¿‡ç›¸å…³æ€§è¿›è¡Œç­›é€‰</h2>\n<p>æ— è®ºç®—æ³•æ˜¯å›å½’ï¼ˆé¢„æµ‹æ•°å­—ï¼‰è¿˜æ˜¯åˆ†ç±»ï¼ˆé¢„æµ‹ç±»åˆ«ï¼‰ï¼Œç‰¹å¾éƒ½å¿…é¡»ä¸ç›®æ ‡ç›¸å…³ã€‚ å¦‚æœä¸€ä¸ªç‰¹å¾æ²¡æœ‰è¡¨ç°å‡ºç›¸å…³æ€§ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªä¸»è¦çš„æ¶ˆé™¤ç›®æ ‡ã€‚ å¯ä»¥åˆ†åˆ«æµ‹è¯•æ•°å€¼å’Œåˆ†ç±»ç‰¹å¾çš„ç›¸å…³æ€§ã€‚</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#å±æ€§çƒ­åŠ›å¦‚æœæ¨¡å‹ä»…ç”¨äºé¢„æµ‹ï¼Œåˆ™åªè¦æ‹Ÿåˆç¨‹åº¦å¥½ï¼Œå¯ä¸å¤„ç†å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œå­˜åœ¨å¤šé‡å…±çº¿æ€§çš„æ¨¡å‹ç”¨äºé¢„æµ‹æ—¶ï¼Œå¾€å¾€ä¸å½±å“é¢„æµ‹ç»“æœã€‚å›¾</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndf_cor<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\ndf_cor<span class=\"token punctuation\">.</span>corr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndata_cor<span class=\"token operator\">=</span>df_cor<span class=\"token punctuation\">.</span>corr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmask <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>triu<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>ones_like<span class=\"token punctuation\">(</span>data_cor<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">bool</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># adjust mask and df</span>\nmask <span class=\"token operator\">=</span> mask<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\ncorr <span class=\"token operator\">=</span> data_cor<span class=\"token punctuation\">.</span>iloc<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># color map</span>\ncmap <span class=\"token operator\">=</span> sns<span class=\"token punctuation\">.</span>diverging_palette<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">230</span><span class=\"token punctuation\">,</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> as_cmap<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nsns<span class=\"token punctuation\">.</span>heatmap<span class=\"token punctuation\">(</span>corr<span class=\"token punctuation\">,</span>mask<span class=\"token operator\">=</span>mask<span class=\"token punctuation\">,</span> annot<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> fmt<span class=\"token operator\">=</span><span class=\"token string\">\".2f\"</span><span class=\"token punctuation\">,</span> cmap<span class=\"token operator\">=</span>cmap<span class=\"token punctuation\">,</span>linewidth<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n               vmin<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> vmax<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> cbar_kws<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"shrink\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">.8</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>square<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'å±æ€§çƒ­åŠ›å›¾'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>tight_layout<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#è°ƒæ•´å¸ƒå±€é˜²æ­¢æ˜¾ç¤ºä¸å…¨</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\1cbbf44bd2fd4cea95d7a0978c044364.png\"/></p>\n<h2><a id=\"42__189\"></a>4.2 å¤šé‡å…±çº¿æ€§</h2>\n<p>å½“ä»»ä½•ä¸¤ä¸ªç‰¹å¾ä¹‹é—´å­˜åœ¨ç›¸å…³æ€§æ—¶ï¼Œå°±ä¼šå‡ºç°å¤šé‡å…±çº¿æ€§ã€‚ åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼ŒæœŸæœ›æ¯ä¸ªç‰¹å¾éƒ½åº”è¯¥ç‹¬ç«‹äºå…¶ä»–ç‰¹å¾ï¼Œå³å®ƒä»¬ä¹‹é—´æ²¡æœ‰å…±çº¿æ€§ã€‚</p>\n<p>4.1ä¸­çš„Heatmap æ˜¯æ£€æŸ¥å’Œå¯»æ‰¾ç›¸å…³ç‰¹å¾çš„æœ€ç®€å•æ–¹æ³•ã€‚</p>\n<p>æ­¤å¤–æ–¹å·®è†¨èƒ€å› å­ (VIF) æ˜¯è¡¡é‡å¤šé‡å…±çº¿æ€§çš„å¦ä¸€ç§æ–¹æ³•ã€‚ å®ƒè¢«æµ‹é‡ä¸ºæ•´ä½“æ¨¡å‹æ–¹å·®ä¸æ¯ä¸ªç‹¬ç«‹ç‰¹å¾çš„æ–¹å·®çš„æ¯”ç‡ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\1cff8028ddf2486098d1061b6185054a.png\"/></p>\n<p>å…¶ä¸­ï¼Œ<img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9ae82c93f1f04361877508d521d7ef3a.png\"/>ä¸ºè‡ªå˜é‡å¯¹å…¶ä½™è‡ªå˜é‡ä½œå›å½’åˆ†æçš„è´Ÿç›¸å…³ç³»æ•°ã€‚<br/> ä¸€ä¸ªç‰¹å¾çš„é«˜VIFè¡¨æ˜å®ƒä¸ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–ç‰¹å¾ç›¸å…³ã€‚ æ ¹æ®ç»éªŒï¼ŒVIFå¤§äº10ï¼Œåˆ™ä»£è¡¨å˜é‡æœ‰è¾ƒä¸¥é‡çš„å¤šé‡å…±çº¿æ€§ã€‚</p>\n<p>æ³¨æ„ï¼šå¦‚æœæ¨¡å‹ä»…ç”¨äºé¢„æµ‹ï¼Œåˆ™åªè¦æ‹Ÿåˆç¨‹åº¦å¥½ï¼Œå¯ä¸å¤„ç†å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œå­˜åœ¨å¤šé‡å…±çº¿æ€§çš„æ¨¡å‹ç”¨äºé¢„æµ‹æ—¶ï¼Œå¾€å¾€ä¸å½±å“é¢„æµ‹ç»“æœã€‚</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> statsmodels<span class=\"token punctuation\">.</span>stats<span class=\"token punctuation\">.</span>outliers_influence <span class=\"token keyword\">import</span> variance_inflation_factor \nfeature_names <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'æ€§åˆ«'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å¹´é¾„_cut'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡'</span><span class=\"token punctuation\">,</span>\n                 <span class=\"token string\">'æä½å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ç”˜æ²¹ä¸‰é…¯'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ€»èƒ†å›ºé†‡'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é«˜è¡€å‹å²'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å°¿ç´ æ°®'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å°¿é…¸'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'è‚Œé…'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ä½“é‡æ£€æŸ¥ç»“æœ'</span><span class=\"token punctuation\">]</span>\nX<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">[</span>feature_names<span class=\"token punctuation\">]</span>\ny<span class=\"token operator\">=</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—…\n<span class=\"token comment\"># è®¡ç®— VIF </span>\nvif <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>variance_inflation_factor<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span>X<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span> \n<span class=\"token comment\"># å±•ç¤ºVIFç»“æœ</span>\nindex <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">.</span>tolist<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \nvif_df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>vif<span class=\"token punctuation\">,</span> index <span class=\"token operator\">=</span> index<span class=\"token punctuation\">,</span> columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'vif'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span>by <span class=\"token operator\">=</span> <span class=\"token string\">'vif'</span><span class=\"token punctuation\">,</span> ascending<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span> \nvif_df\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\8ee8993d51d848c59294d348fca55da3.png\"/></p>\n<h2><a id=\"43_RFE_222\"></a>4.3 RFEï¼ˆé€’å½’ç‰¹å¾æ¶ˆé™¤æ³•ï¼‰</h2>\n<p>ä½¿ç”¨RFEè¿›è¡Œç‰¹å¾é€‰æ‹©ï¼šRFEæ˜¯å¸¸è§çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼Œä¹Ÿå«é€’å½’ç‰¹å¾æ¶ˆé™¤ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯é€’å½’åˆ é™¤ç‰¹å¾ï¼Œå¹¶åœ¨å‰©ä½™çš„ç‰¹å¾ä¸Šæ„å»ºæ¨¡å‹ã€‚å®ƒä½¿ç”¨æ¨¡å‹å‡†ç¡®ç‡æ¥åˆ¤æ–­å“ªäº›ç‰¹å¾ï¼ˆæˆ–ç‰¹å¾ç»„åˆï¼‰å¯¹é¢„æµ‹ç»“æœè´¡çŒ®è¾ƒå¤§ã€‚<br/><br/> 2000 å¹´ï¼ŒWeston G.ç­‰äººåœ¨å¯¹ç ”ç©¶å¯¹ç™Œç—‡è¿›è¡Œåˆ†ç±»æ—¶ï¼Œæå‡ºäº†SVM-RFEç‰¹å¾é€‰æ‹©ç®—æ³•å¹¶åº”ç”¨åˆ°ç™Œç—‡åˆ†ç±»ã€‚ä½œä¸ºä¸€ç§ç»å…¸çš„åŒ…è£¹å¼ç‰¹å¾é€‰æ‹©æ–¹æ³•ï¼ŒSVM-RFEç‰¹å¾é€‰æ‹©ç®—æ³•ä¹Ÿæ›¾è¢«å¹¿æ³›ç”¨äºåŒ»å­¦é¢„æµ‹é—®é¢˜çš„ç‰¹å¾é€‰æ‹©ï¼Œå¹¶å–å¾—è‰¯å¥½çš„é€‰æ‹©æ•ˆæœã€‚SVM-RFE ç®—æ³•ä½¿ç”¨SVMç®—æ³•ä½œä¸ºåŸºæ¨¡å‹ï¼Œå¯¹æ•°æ®é›†ä¸­çš„ç‰¹å¾è¿›è¡Œæ’åºï¼Œç„¶åä½¿ç”¨é€’å½’ç‰¹å¾æ¶ˆé™¤ç®—æ³•å°†æ’åºé åç‰¹å¾æ¶ˆé™¤ï¼Œä»¥æ­¤å®ç°ç‰¹å¾é€‰æ‹©ã€‚SVMçš„ä»‹ç»ä¸æ¨å¯¼åœ¨2.1.2èŠ‚æœ‰æ‰€æåŠï¼Œä¸‹é¢å¯¹è¯¥ç®—æ³•çš„å®ç°æ­¥éª¤è¿›è¡Œæ€»ç»“ã€‚å…¶ç®—æ³•çš„å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š<br/><br/> <strong>â‘ è¾“å…¥åŸå§‹ç‰¹å¾é›†Q =ï¼ˆQ1ï¼ŒQ2ï¼Œâ€¦ï¼ŒQmï¼‰;<br/><br/> â‘¡åˆå§‹åŒ–ç›®æ ‡ç‰¹å¾é›†= q;<br/><br/> â‘¢æ ¹æ®Qå¯¹æ”¯æŒå‘é‡æœºè¿›è¡Œè®­ç»ƒï¼Œå¾—åˆ°æ‰€æœ‰ç‰¹å¾çš„æƒé‡ï¼Œå°†å…¶è¿›è¡Œå¹³æ–¹å¤„ç†åå¹¶æŒ‰ç…§é™åºå¯¹ç‰¹å¾è¿›è¡Œæ’å;<br/><br/> â‘£ä¸æ–­å¯¹æ­¥éª¤è¿­ä»£ï¼Œç›´åˆ°ç•™ä¸‹æœ€åä¸€ä¸ªå±æ€§ç‰¹å¾ï¼Œæ›´æ–°ï¼›<br/><br/> â‘¤è‹¥å¾—åˆ°çš„ç›®æ ‡ç‰¹å¾é›†Q*æ¨¡å‹çš„æ‹Ÿåˆç¨‹åº¦ä¸å†ç»§ç»­å¢åŠ ï¼ŒMSEä¸å†ç»§ç»­é™ä½ï¼Œåˆ™ç®—æ³•ç»“æŸï¼Œæ‰€å¾—çš„nä¸ªç‰¹å¾å³ä¸ºæ‰€é€‰æ‹©çš„nä¸ªç‰¹å¾ï¼Œå¦åˆ™ï¼Œè½¬â‘¢ã€‚</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#é€’å½’ç‰¹å¾æ¶ˆé™¤æ³•ï¼Œè¿”å›ç‰¹å¾é€‰æ‹©åçš„æ•°æ®</span>\n<span class=\"token comment\">#å‚æ•°estimatorä¸ºåŸºæ¨¡å‹</span>\n<span class=\"token comment\">#å‚æ•°n_features_to_selectä¸ºé€‰æ‹©çš„ç‰¹å¾ä¸ªæ•°</span>\nmin_max_scaler1 <span class=\"token operator\">=</span> preprocessing<span class=\"token punctuation\">.</span>MinMaxScaler<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nX_train_minmax1 <span class=\"token operator\">=</span> min_max_scaler1<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>dataConcat1<span class=\"token punctuation\">[</span>feature_names<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#ç‰¹å¾å½’ä¸€åŒ–å¤„ç†</span>\nsvc <span class=\"token operator\">=</span> SVC<span class=\"token punctuation\">(</span>kernel<span class=\"token operator\">=</span><span class=\"token string\">\"linear\"</span><span class=\"token punctuation\">)</span>\nselector<span class=\"token operator\">=</span>RFE<span class=\"token punctuation\">(</span>estimator<span class=\"token operator\">=</span>svc<span class=\"token punctuation\">,</span> n_features_to_select<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\nXt<span class=\"token operator\">=</span>selector<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>X_train_minmax1<span class=\"token punctuation\">,</span>dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—…<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"N_features %s\"</span> <span class=\"token operator\">%</span> selector<span class=\"token punctuation\">.</span>n_features_<span class=\"token punctuation\">)</span> <span class=\"token comment\"># ä¿ç•™çš„ç‰¹å¾æ•°</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Support is %s\"</span> <span class=\"token operator\">%</span> selector<span class=\"token punctuation\">.</span>support_<span class=\"token punctuation\">)</span> <span class=\"token comment\"># æ˜¯å¦ä¿ç•™</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Ranking %s\"</span> <span class=\"token operator\">%</span> selector<span class=\"token punctuation\">.</span>ranking_<span class=\"token punctuation\">)</span> <span class=\"token comment\"># é‡è¦ç¨‹åº¦æ’å</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>selector<span class=\"token punctuation\">.</span>ranking_<span class=\"token punctuation\">,</span>feature_names<span class=\"token punctuation\">,</span>selector<span class=\"token punctuation\">.</span>support_<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ae6dc7f30db049b7bf3cba8e4aa945d2.png\"/></p>\n<h2><a id=\"44__251\"></a>4.4 æ­£åˆ™åŒ–</h2>\n<p>æ­£åˆ™åŒ–å‡å°‘äº†è¿‡æ‹Ÿåˆã€‚ å¦‚æœä½ æœ‰å¤ªå¤šçš„ç‰¹å¾ï¼Œæ­£åˆ™åŒ–æ§åˆ¶å®ƒä»¬çš„æ•ˆæœï¼Œæˆ–è€…é€šè¿‡ç¼©å°ç‰¹å¾ç³»æ•°ï¼ˆç§°ä¸º L2 æ­£åˆ™åŒ–ï¼‰æˆ–å°†ä¸€äº›ç‰¹å¾ç³»æ•°è®¾ç½®ä¸ºé›¶ï¼ˆç§°ä¸º L1 æ­£åˆ™åŒ–ï¼‰ã€‚ä¸€äº›æ¨¡å‹å…·æœ‰å†…ç½®çš„ L1/L2 æ­£åˆ™åŒ–ä½œä¸ºè¶…å‚æ•°æ¥æƒ©ç½šç‰¹å¾ã€‚ å¯ä»¥ä½¿ç”¨è½¬æ¢å™¨ SelectFromModel æ¶ˆé™¤è¿™äº›åŠŸèƒ½ã€‚è¿™é‡Œå®ç°ä¸€ä¸ªå¸¦æœ‰æƒ©ç½š = â€˜l1â€™ çš„ LinearSVC ç®—æ³•ã€‚ ç„¶åä½¿ç”¨ SelectFromModel åˆ é™¤ä¸€äº›åŠŸèƒ½ã€‚</p>\n<pre><code class=\"prism language-python\">model <span class=\"token operator\">=</span> LinearSVC<span class=\"token punctuation\">(</span>penalty<span class=\"token operator\">=</span> <span class=\"token string\">'l1'</span><span class=\"token punctuation\">,</span> C <span class=\"token operator\">=</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>dual<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span> \nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span> \n<span class=\"token comment\"># ç‰¹å¾é€‰æ‹©</span>\n<span class=\"token comment\"># L1æƒ©ç½šé¡¹çš„SVCä½œä¸ºåŸºæ¨¡å‹çš„ç‰¹å¾é€‰æ‹©,ä¹Ÿå¯ä»¥ä½¿ç”¨thresholdï¼ˆæƒå€¼ç³»æ•°ä¹‹å·®çš„é˜ˆå€¼ï¼‰æ§åˆ¶é€‰æ‹©ç‰¹å¾çš„ä¸ªæ•°</span>\nselector <span class=\"token operator\">=</span> SelectFromModel<span class=\"token punctuation\">(</span>estimator <span class=\"token operator\">=</span> model<span class=\"token punctuation\">,</span> prefit<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>max_features<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\nX_new <span class=\"token operator\">=</span> selector<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">)</span> \nfeature_names <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>X<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span> \nfeature_names<span class=\"token punctuation\">[</span>selector<span class=\"token punctuation\">.</span>get_support<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token comment\">#è·å–é€‰æ‹©çš„å˜é‡</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\f1fbe1ec077546339e6888aeff03b830.png\"/></p>\n<p><strong>ç»è¿‡ç‰¹å¾ç­›é€‰ï¼Œæœ€ç»ˆå†³å®šç­›é€‰å¹´é¾„_cut,é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡,èˆ’å¼ å‹,è„‰æ,å°¿ç´ æ°®,ä½“é‡æ£€æŸ¥ç»“æœ,æ€§åˆ«,ç”˜æ²¹ä¸‰é…¯ä½œä¸ºåç»­æœºå™¨å­¦ä¹ æ¨¡å‹è¾“å…¥ã€‚</strong></p>\n<h1><a id=\"5__271\"></a>5 æœºå™¨å­¦ä¹ æ¨¡å‹å»ºç«‹ä¸è¯„ä»·</h1>\n<h2><a id=\"51__273\"></a>5.1 è¯„ä»·æ–¹å¼çš„é€‰æ‹©</h2>\n<p>å¯¹äºä¸åŒçš„é¢„æµ‹é—®é¢˜ï¼Œé€‰æ‹©ä¸€ä¸ªå¥½çš„è¯„ä»·æ ‡å‡†å°†ä¼šå¤§å¤§æé«˜æ¨¡å‹å¯¹å®é™…é—®é¢˜çš„é€‚åº”æ€§ï¼Œä»è€Œé€‰å‡ºæœ€åˆé€‚çš„æ¨¡å‹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå„ç§æ¨¡å‹è¯„ä»·çš„æ–¹å¼éƒ½ä¸æ··æ·†çŸ©é˜µï¼ˆconfusion matrixï¼‰æœ‰å¾ˆå¤§çš„å…³ç³»ã€‚æ··æ·†çŸ©é˜µæ˜¯å¯¹ä¸€ä¸ªæ¨¡å‹è¿›è¡Œè¯„ä»·ä¸è¡¡é‡çš„ä¸€ä¸ªæ ‡å‡†åŒ–çš„è¡¨æ ¼ï¼Œå…·ä½“å½¢å¼å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ä»¥ç³–å°¿ç—…é¢„æµ‹ä¸ºä¾‹ï¼Œå…¶ä¸­ç¬¬ä¸€è¡Œçš„å’Œä¸ºå®é™…æ‚£ç³–å°¿ç—…çš„æ€»äººæ•°ï¼Œç¬¬äºŒè¡Œçš„å’Œä¸ºå®é™…æœªæ‚£ç³–å°¿ç—…çš„æ€»äººæ•°ï¼Œç¬¬ä¸€åˆ—çš„å’Œä¸ºç»è¿‡æ¨¡å‹é¢„æµ‹åé¢„æµ‹æ ‡ç­¾ä¸ºæ‚£ç³–å°¿ç—…çš„æ€»äººæ•°ï¼Œç¬¬äºŒåˆ—çš„å’Œä¸ºç»è¿‡æ¨¡å‹é¢„æµ‹åé¢„æµ‹æ ‡ç­¾ä¸ºæœªæ‚£ç³–å°¿ç—…çš„æ€»äººæ•°ã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c4f6749fab4a43fba684699f1d873e58.png\"/><br/> å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡å’Œå¬å›ç‡åœ¨å„ä¸ªé¢„æµ‹åœºæ™¯ä¸‹éƒ½æ˜¯æ˜¯è¯„ä»·ä¸€ä¸ªæ¨¡å‹é¢„æµ‹æ•ˆæœçš„é‡è¦å‚è€ƒæŒ‡æ ‡ã€‚ç²¾ç¡®ç‡æ˜¯é’ˆå¯¹æœºå™¨å­¦ä¹ é¢„æµ‹ç»“æœè€Œè¨€çš„ï¼Œå¬å›ç‡æ˜¯é’ˆå¯¹åŸæ¥çš„æ ·æœ¬çš„æ ‡ç­¾æ¥è¯´çš„ã€‚å¯¹äºç³–å°¿ç—…æ ‡æ³¨è¿™ä¸ªé¢„æµ‹é—®é¢˜æ¥è¯´ï¼Œç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰è¡¨ç¤ºçš„æ˜¯é¢„æµ‹ç³–å°¿ç—…ä¸ºé˜³æ€§çš„æ ·æœ¬ä¸­æœ‰å¤šå°‘æ˜¯çœŸæ­£çš„é˜³æ€§æ ·æœ¬ï¼Œè€Œå¬å›ç‡ï¼ˆRecallï¼‰åˆ™æ˜¯è¡¨ç¤ºæ ‡ç­¾ç³–å°¿ç—…ä¸ºé˜³æ€§çš„æ ·æœ¬ä¾‹æœ‰å¤šå°‘è¢«é¢„æµ‹ä¸ºé˜³æ€§ã€‚<br/>ç²¾ç¡®ç‡å’Œå¬å›ç‡åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå°¤å…¶æ˜¯åœ¨æŸäº›åŒ»å­¦åœºæ™¯ä¸‹å¹¶ä¸èƒ½å¯¹æœºå™¨å­¦ä¹ æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›å’Œé¢„æµ‹æ•ˆç‡è¿›è¡Œå…¨é¢çš„è¯„ä»·ï¼Œæœ‰äº›æƒ…å†µä¸‹ä¼šé€ æˆæ¨¡å‹è¯„ä»·çš„ä¸¥é‡åå€šï¼Œä¸èƒ½å¾ˆå¥½è¡¡é‡è¿™ä¸ªåˆ†ç±»å™¨çš„æ•ˆæœï¼Œä»è€Œé€ æˆå¯¹ä½¿ç”¨å’Œè¯„ä»·æ¨¡å‹äººå‘˜çš„è¯¯å¯¼ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ¯”è¾ƒå¸¸è§ä¸”è¾ƒä¸ºç®€å•çš„æ–¹æ³•å°±æ˜¯F-Measureï¼Œä¹Ÿå°±æ˜¯é€šè¿‡è®¡ç®—F1-Scoreï¼ˆF1å€¼ï¼‰æ¥è¯„ä»·ä¸€ä¸ªæ¨¡å‹çš„é¢„æµ‹æ•ˆæœã€‚<br/><br/> rocæ›²çº¿å¯ä»¥å¾ˆå®¹æ˜“åœ°æŸ¥å‡ºä¸€ä¸ªåˆ†ç±»å™¨åœ¨æŸä¸ªé˜ˆå€¼æ—¶å¯¹æ ·æœ¬çš„è¯†åˆ«èƒ½åŠ›ã€‚è¿›è¡ŒROCåˆ†ææ‰€éœ€è¦çš„å·¥å…·å’Œå‡†å¤‡å¹¶ä¸ç¹çï¼Œåˆ©ç”¨äºŒç»´å¹³é¢ä¸Šçš„å¸¦æœ‰ä¸¤ä¸ªåæ ‡è½´æ¥ç»˜åˆ¶æ›²çº¿ä¾¿å¯è¿›è¡ŒROCåˆ†æã€‚å…¶ä¸­æ›²çº¿åæ ‡è½´çš„æ¨ªè½´ï¼ˆxè½´ï¼‰ä¸ºFPRï¼ˆFalse Positive Rateï¼Œå‡æ­£ç‡ï¼‰ï¼Œä»£è¡¨è®­ç»ƒå‡ºçš„åˆ†ç±»å™¨é¢„æµ‹çš„é˜´æ€§æ ·æœ¬ä¸­å®é™…çš„é˜´æ€§æ ·æœ¬å æ‰€æœ‰å®é™…é˜´æ€§æ ·æœ¬çš„æ¯”é‡ï¼›ç«–è½´ï¼ˆyè½´ï¼‰ä¸ºTPRï¼ˆTrue Positive Rateï¼ŒçœŸæ­£ç‡ï¼‰ï¼Œå³å‰è¿°çš„å¬å›ç‡ï¼ˆRecallï¼‰ï¼Œä»£è¡¨è®­ç»ƒå‡ºçš„åˆ†ç±»å™¨é¢„æµ‹çš„é˜³æ€§æ ·æœ¬ä¸­å®é™…é˜³æ€§æ ·æœ¬å æ‰€æœ‰å®é™…é˜³æ€§æ ·æœ¬çš„æ¯”é‡ã€‚<br/>â€ƒâ€ƒ<br/> å¯¹äºæŸä¸ªæ¨¡å‹æ¥è¯´ï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†çš„è¡¨ç°ä¸åŒï¼Œä¾¿å¯ä»¥å¾—åˆ°å¤šå¯¹ä¸åŒçš„TPRå’ŒFPRå€¼ï¼Œè¿›ä¸€æ­¥åœ¨å›¾ä¸­æ˜ å°„æˆä¸€ä¸ªåœ¨ROCæ›²çº¿ä¸Šçš„ç‚¹ã€‚åœ¨å›¾ä¸­é¢„æµ‹æ¨¡å‹åˆ†ç±»æ—¶æ‰€ä½¿ç”¨çš„é˜ˆå€¼æ˜¯åœ¨ä¸æ–­å˜åŒ–å’Œè°ƒæ•´çš„ï¼Œæ ¹æ®é˜ˆå€¼çš„å˜åŒ–ï¼Œä¾¿å¯ä»¥ç»˜åˆ¶ä¸€ä¸ªç»è¿‡ç‚¹ï¼ˆ0, 0ï¼‰å’Œç‚¹ï¼ˆ1, 1ï¼‰çš„æ›²çº¿ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ¨¡å‹çš„ROCæ›²çº¿ã€‚AUCï¼ˆArea Under Curveï¼‰æ˜¯ä¸ROCæ›²çº¿æ¯æ¯ç›¸å…³çš„ä¸€ä¸ªå€¼ï¼Œä»£è¡¨ä½äºROCæ›²çº¿ä¸‹æ–¹é¢ç§¯çš„æ€»å’Œå æ•´ä¸ªå›¾ï¼ˆä¸€ä¸ªæ­£æ–¹å½¢ï¼‰æ€»é¢ç§¯çš„æ¯”ä¾‹ã€‚AUCå€¼çš„å¤§å°å­˜åœ¨ä¸€ä¸ªèŒƒå›´ï¼Œä¸€èˆ¬æ˜¯åœ¨0.5åˆ°1.0ä¹‹é—´ä¸Šä¸‹æµ®åŠ¨ã€‚å½“AUC=0.5æ—¶ï¼Œä»£è¡¨è¿™ä¸ªæ¨¡å‹çš„åˆ†ç±»æ•ˆæœçº¦ç­‰äºéšæœºåˆ†ç±»çš„æ•ˆæœï¼Œè€Œæ¨¡å‹çš„AUCå€¼è¶Šå¤§ï¼Œä»£è¡¨è¿™ä¸ªæ¨¡å‹çš„åˆ†ç±»è¡¨ç°è¶Šå¥½ã€‚éƒ¨åˆ†æŒ‡æ ‡è®¡ç®—å…¬å¼å¦‚ä¸‹æ‰€ç¤ºã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9bb68a007e0f478683750197d6506753.png\"/></p>\n<h2><a id=\"52__282\"></a>5.2 æ¨¡å‹çš„å»ºç«‹ä¸è¯„ä»·</h2>\n<pre><code class=\"prism language-python\">select_features<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span> <span class=\"token string\">'å¹´é¾„_cut'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é«˜å¯†åº¦è„‚è›‹ç™½èƒ†å›ºé†‡'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'èˆ’å¼ å‹'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'è„‰æ'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'å°¿ç´ æ°®'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'ä½“é‡æ£€æŸ¥ç»“æœ'</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"æ€§åˆ«\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"ç”˜æ²¹ä¸‰é…¯\"</span><span class=\"token punctuation\">]</span>\nX1 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">[</span>select_features<span class=\"token punctuation\">]</span><span class=\"token comment\">#å˜é‡ç­›é€‰åçš„ç‰¹å¾</span>\ny1 <span class=\"token operator\">=</span> dataConcat1<span class=\"token punctuation\">.</span>æ˜¯å¦ç³–å°¿ç—…\ntrain_X<span class=\"token punctuation\">,</span> val_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> val_y <span class=\"token operator\">=</span> train_test_split<span class=\"token punctuation\">(</span>X1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> random_state<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmodel_logistics <span class=\"token operator\">=</span> LogisticRegression<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel_logistics<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">)</span>\ny_pred <span class=\"token operator\">=</span> model_logistics<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span>\nscores_logistics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_logistics<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_logistics<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_logistics<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred<span class=\"token punctuation\">)</span>\nf1_score_logistics<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\nprecision_logistics <span class=\"token operator\">=</span> precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># ç²¾ç¡®ç‡æŒ‡æ¨¡å‹é¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­å®é™…ä¹Ÿä¸ºæ­£çš„æ ·æœ¬å è¢«é¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬çš„æ¯”ä¾‹ã€‚</span>\nimportance<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"columns\"</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"coef\"</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>model_logistics<span class=\"token punctuation\">.</span>coef_<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\npredictions_log<span class=\"token operator\">=</span>model_logistics<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_log<span class=\"token punctuation\">,</span> recall_log<span class=\"token punctuation\">,</span> thresholds <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> predictions_log<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_log<span class=\"token operator\">=</span>auc<span class=\"token punctuation\">(</span>FPR_log<span class=\"token punctuation\">,</span>recall_log<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'logisticsæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_logistics<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_logistics<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‡†ç¡®ç‡å’Œå¬å›ç‡ä¸ºï¼š\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_logistics<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'æ¨¡å‹ç³»æ•°ï¼š\\n'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>importance<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\c15e4dc11d0a408096fcea4a31ba46f6.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#SVMæ¨¡å‹å»ºç«‹</span>\nmin_max_scaler <span class=\"token operator\">=</span> preprocessing<span class=\"token punctuation\">.</span>MinMaxScaler<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ³¨æ„è¦å½’ä¸€åŒ–</span>\nX_train_minmax <span class=\"token operator\">=</span> min_max_scaler<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">)</span>\nX_test_minmax<span class=\"token operator\">=</span>min_max_scaler<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span>\nmodel_svm<span class=\"token operator\">=</span>SVC<span class=\"token punctuation\">(</span>probability<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nmodel_svm<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train_minmax<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">)</span>\ny_pred <span class=\"token operator\">=</span> model_svm<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test_minmax<span class=\"token punctuation\">)</span>\nscores_svm<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_svm<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_svm<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_svm<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred<span class=\"token punctuation\">)</span>\nf1_score_svm<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\npredictions_svm<span class=\"token operator\">=</span>model_svm<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>X_test_minmax<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_svm<span class=\"token punctuation\">,</span> recall_svm<span class=\"token punctuation\">,</span> thresholds <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>predictions_svm<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_svm <span class=\"token operator\">=</span> auc<span class=\"token punctuation\">(</span>FPR_svm<span class=\"token punctuation\">,</span>recall_svm<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svmæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_svm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_svm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‡†ç¡®ç‡å’Œå¬å›ç‡ä¸ºï¼š\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_svm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\d1b790d587f945ceb76fa4e24f414608.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#xgboostæ¨¡å‹å»ºç«‹</span>\nmodel_XGB <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\neval_set <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">,</span> val_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\nmodel_XGB<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> early_stopping_rounds<span class=\"token operator\">=</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> eval_metric<span class=\"token operator\">=</span><span class=\"token string\">\"logloss\"</span><span class=\"token punctuation\">,</span> eval_set<span class=\"token operator\">=</span>eval_set<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># verboseæ”¹ä¸ºTrueå°±èƒ½å¯è§†åŒ–loss</span>\ny_pred <span class=\"token operator\">=</span> model_XGB<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span>\n\nscores_XGB<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_XGB<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_XGB<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_XGB<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred<span class=\"token punctuation\">)</span>\nf1_score_XGB<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">\"binary\"</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n\npredictions_xgb<span class=\"token operator\">=</span>model_XGB<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_xgb<span class=\"token punctuation\">,</span> recall_xgb<span class=\"token punctuation\">,</span> thresholds <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>predictions_xgb<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_xgb <span class=\"token operator\">=</span> auc<span class=\"token punctuation\">(</span>FPR_xgb<span class=\"token punctuation\">,</span>recall_xgb<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'xgboostæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_XGB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_XGB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç²¾ç¡®åº¦å’Œå¬å›ç‡:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_XGB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\77caef7188a142179fa2ff25d2a1b1b7.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#ROCå›¾çš„ç»˜åˆ¶</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_xgb<span class=\"token punctuation\">,</span> recall_xgb<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">'XGBoost_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_xgb<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_svm<span class=\"token punctuation\">,</span> recall_svm<span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'SVM_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_svm<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_log<span class=\"token punctuation\">,</span> recall_log<span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'Logistic_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_log<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'lower right'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'r--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Recall'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">'FPR'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'ROC_before_GridSearchCV'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\7145af728300424fbfb6b961f1028cdd.png\"/></p>\n<h2><a id=\"53__382\"></a>5.3 æ¨¡å‹å‚æ•°è°ƒä¼˜</h2>\n<p><strong>Logisticæ¨¡å‹è°ƒä¼˜ï¼š</strong><br/><br/> Cï¼šCä¸ºæ­£åˆ™åŒ–ç³»æ•°Î»çš„å€’æ•°ï¼Œå¿…é¡»ä¸ºæ­£æ•°ï¼Œé»˜è®¤ä¸º1ã€‚å’ŒSVMä¸­çš„Cä¸€æ ·ï¼Œå€¼è¶Šå°ï¼Œä»£è¡¨æ­£åˆ™åŒ–è¶Šå¼ºã€‚</p>\n<p><strong>SVMæ¨¡å‹è°ƒä¼˜ï¼š</strong><br/><br/> Cï¼šæƒ©ç½šç³»æ•°ï¼Œå³å¯¹è¯¯å·®çš„å®½å®¹åº¦ã€‚cè¶Šé«˜ï¼Œè¯´æ˜è¶Šä¸èƒ½å®¹å¿å‡ºç°è¯¯å·®,å®¹æ˜“è¿‡æ‹Ÿåˆã€‚Cè¶Šå°ï¼Œå®¹æ˜“æ¬ æ‹Ÿåˆã€‚Cè¿‡å¤§æˆ–è¿‡å°ï¼Œæ³›åŒ–èƒ½åŠ›å˜å·®<br/><br/> <strong>gammaï¼š</strong> é€‰æ‹©RBFå‡½æ•°ä½œä¸ºkernelåï¼Œè¯¥å‡½æ•°è‡ªå¸¦çš„ä¸€ä¸ªå‚æ•°ã€‚éšå«åœ°å†³å®šäº†æ•°æ®æ˜ å°„åˆ°æ–°çš„ç‰¹å¾ç©ºé—´åçš„åˆ†å¸ƒï¼Œgammaè¶Šå¤§ï¼Œæ”¯æŒå‘é‡è¶Šå°‘ï¼Œgammaå€¼è¶Šå°ï¼Œæ”¯æŒå‘é‡è¶Šå¤šã€‚æ”¯æŒå‘é‡çš„ä¸ªæ•°å½±å“è®­ç»ƒä¸é¢„æµ‹çš„é€Ÿåº¦ã€‚</p>\n<p><strong>XGBoostå‚æ•°è°ƒä¼˜ï¼š</strong><br/><br/> XGBoostçš„å‚æ•°è¾ƒå¤šï¼Œè¿™é‡Œå¯¹ä¸‰ä¸ªå‚æ•°è¿›è¡Œäº†è°ƒæ•´ï¼Œå…±åˆ†ä¸ºä¸¤æ­¥è°ƒæ•´ã€‚æ•´ä½“æ€è·¯æ˜¯å…ˆè°ƒæ•´è¾ƒä¸ºé‡è¦çš„ä¸€ç»„å‚æ•°ï¼Œç„¶åå°†è°ƒåˆ°æœ€ä¼˜çš„å‚æ•°è¾“å…¥æ¨¡å‹åç»§ç»­è°ƒä¸‹ä¸€ç»„å‚æ•°ã€‚</p>\n<pre><code class=\"prism language-python\">parameters_Logr <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'C'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\nparameters_svm <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'C'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'gamma'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># ç½‘æ ¼æœç´¢</span>\ngrid_search_log <span class=\"token operator\">=</span> GridSearchCV<span class=\"token punctuation\">(</span>model_logistics<span class=\"token punctuation\">,</span>parameters_Logr<span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>scoring<span class=\"token operator\">=</span><span class=\"token string\">'roc_auc'</span><span class=\"token punctuation\">)</span>\ngrid_search_log<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span>\n\ngrid_search_svm <span class=\"token operator\">=</span> GridSearchCV<span class=\"token punctuation\">(</span>model_svm<span class=\"token punctuation\">,</span>parameters_svm<span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>scoring<span class=\"token operator\">=</span><span class=\"token string\">'roc_auc'</span><span class=\"token punctuation\">)</span>\ngrid_search_svm<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train_minmax<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># è·å¾—å‚æ•°çš„æœ€ä¼˜å€¼</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Log:\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>grid_search_log<span class=\"token punctuation\">.</span>best_params_<span class=\"token punctuation\">,</span>grid_search_log<span class=\"token punctuation\">.</span>best_score_<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\nSVM:\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>grid_search_svm<span class=\"token punctuation\">.</span>best_params_<span class=\"token punctuation\">,</span>grid_search_svm<span class=\"token punctuation\">.</span>best_score_<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\812d3af949d94f68aa2e194e36bf719b.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#XGBoostè°ƒå‚</span>\n<span class=\"token comment\">#ç¬¬ä¸€æ­¥ï¼šå…ˆè°ƒmax_depthã€min_child_weight</span>\nparam_test1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n <span class=\"token string\">'max_depth'</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n <span class=\"token string\">'min_child_weight'</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\ngsearch1 <span class=\"token operator\">=</span> GridSearchCV<span class=\"token punctuation\">(</span>estimator <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                        param_grid <span class=\"token operator\">=</span> param_test1<span class=\"token punctuation\">,</span>scoring<span class=\"token operator\">=</span><span class=\"token string\">'roc_auc'</span><span class=\"token punctuation\">)</span>\ngsearch1<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">,</span>early_stopping_rounds<span class=\"token operator\">=</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> eval_metric<span class=\"token operator\">=</span><span class=\"token string\">\"logloss\"</span><span class=\"token punctuation\">,</span> eval_set<span class=\"token operator\">=</span>eval_set<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\ngsearch1<span class=\"token punctuation\">.</span>best_params_<span class=\"token punctuation\">,</span>gsearch1<span class=\"token punctuation\">.</span>best_score_\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\3c70d439930640bc9f919c8e15acc59c.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#ç¬¬äºŒæ­¥ï¼šè°ƒgamma</span>\nparam_test2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n <span class=\"token string\">'gamma'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\ngsearch2 <span class=\"token operator\">=</span> GridSearchCV<span class=\"token punctuation\">(</span>estimator <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span>max_depth<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>min_child_weight<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n                        param_grid <span class=\"token operator\">=</span> param_test2<span class=\"token punctuation\">,</span> scoring<span class=\"token operator\">=</span><span class=\"token string\">'roc_auc'</span><span class=\"token punctuation\">,</span> cv<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\ngsearch2<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">,</span>early_stopping_rounds<span class=\"token operator\">=</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> eval_metric<span class=\"token operator\">=</span><span class=\"token string\">\"logloss\"</span><span class=\"token punctuation\">,</span> eval_set<span class=\"token operator\">=</span>eval_set<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\ngsearch2<span class=\"token punctuation\">.</span>best_params_<span class=\"token punctuation\">,</span> gsearch2<span class=\"token punctuation\">.</span>best_score_\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\06b0397fb3934df4a834c9e6ac87e743.png\"/></p>\n<h2><a id=\"54__442\"></a>5.4 å°†è°ƒå‚è¿‡åçš„æ¨¡å‹é‡æ–°è¿›è¡Œè®­ç»ƒå¹¶ä¸åŸæ¨¡å‹æ¯”è¾ƒ</h2>\n<pre><code class=\"prism language-python\">model_logistics_after <span class=\"token operator\">=</span> LogisticRegression<span class=\"token punctuation\">(</span>C<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\nmodel_logistics_after<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">)</span>\ny_pred_after <span class=\"token operator\">=</span> model_logistics_after<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span>\nscores_logistics_after<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_logistics_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_logistics_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_logistics_after<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred_after<span class=\"token punctuation\">)</span>\nf1_score_logistics_after<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\nprecision_logistics_after <span class=\"token operator\">=</span> precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">)</span><span class=\"token comment\"># ç²¾ç¡®ç‡æŒ‡æ¨¡å‹é¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­å®é™…ä¹Ÿä¸ºæ­£çš„æ ·æœ¬å è¢«é¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬çš„æ¯”ä¾‹ã€‚</span>\nimportance_after<span class=\"token operator\">=</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"columns\"</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"coef\"</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>model_logistics_after<span class=\"token punctuation\">.</span>coef_<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\npredictions_log_after<span class=\"token operator\">=</span>model_logistics_after<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_log_after<span class=\"token punctuation\">,</span> recall_log_after<span class=\"token punctuation\">,</span> thresholds_after <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> predictions_log_after<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_log_after<span class=\"token operator\">=</span>auc<span class=\"token punctuation\">(</span>FPR_log_after<span class=\"token punctuation\">,</span>recall_log_after<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'è°ƒå‚ålogisticsæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_logistics_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_logistics_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‡†ç¡®ç‡å’Œå¬å›ç‡ä¸ºï¼š\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_logistics_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'æ¨¡å‹ç³»æ•°ï¼š\\n'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>importance_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\a2983bc5084f41c1a26ec58ba7220563.png\"/></p>\n<pre><code class=\"prism language-python\">model_svm_after<span class=\"token operator\">=</span>SVC<span class=\"token punctuation\">(</span>C<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>gamma<span class=\"token operator\">=</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>probability<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nmodel_svm_after<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>X_train_minmax<span class=\"token punctuation\">,</span>train_y<span class=\"token punctuation\">)</span>\ny_pred_after <span class=\"token operator\">=</span> model_svm_after<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>X_test_minmax<span class=\"token punctuation\">)</span>\nscores_svm_after<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_svm_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_svm_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_svm_after<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred_after<span class=\"token punctuation\">)</span>\nf1_score_svm_after<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">'binary'</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\npredictions_svm_after<span class=\"token operator\">=</span>model_svm<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>X_test_minmax<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_svm_after<span class=\"token punctuation\">,</span> recall_svm_after<span class=\"token punctuation\">,</span> thresholds_after <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>predictions_svm_after<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_svm_after <span class=\"token operator\">=</span> auc<span class=\"token punctuation\">(</span>FPR_svm_after<span class=\"token punctuation\">,</span>recall_svm_after<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'è°ƒå‚åsvmæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_svm_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_svm_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"å‡†ç¡®ç‡å’Œå¬å›ç‡ä¸ºï¼š\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_svm_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e2b31c5b3acb42098087feaf5c856e4c.png\"/></p>\n<pre><code class=\"prism language-python\">model_XGB_after <span class=\"token operator\">=</span> XGBClassifier<span class=\"token punctuation\">(</span>max_depth<span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> min_child_weight<span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>gamma<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\neval_set <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">,</span> val_y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\nmodel_XGB_after<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_X<span class=\"token punctuation\">,</span> train_y<span class=\"token punctuation\">,</span> early_stopping_rounds<span class=\"token operator\">=</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span> eval_metric<span class=\"token operator\">=</span><span class=\"token string\">\"logloss\"</span><span class=\"token punctuation\">,</span> eval_set<span class=\"token operator\">=</span>eval_set<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># verboseæ”¹ä¸ºTrueå°±èƒ½å¯è§†åŒ–loss</span>\ny_pred_after <span class=\"token operator\">=</span> model_XGB_after<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span>\n\nscores_XGB_after<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nscores_XGB_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>precision_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nscores_XGB_after<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>recall_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nconfusion_matrix_XGB_after<span class=\"token operator\">=</span>confusion_matrix<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>y_pred_after<span class=\"token punctuation\">)</span>\nf1_score_XGB_after<span class=\"token operator\">=</span>f1_score<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span> y_pred_after<span class=\"token punctuation\">,</span>labels<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> average<span class=\"token operator\">=</span><span class=\"token string\">\"binary\"</span><span class=\"token punctuation\">,</span> sample_weight<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span>\n\npredictions_xgb_after<span class=\"token operator\">=</span>model_XGB_after<span class=\"token punctuation\">.</span>predict_proba<span class=\"token punctuation\">(</span>val_X<span class=\"token punctuation\">)</span><span class=\"token comment\">#æ¯ä¸€ç±»çš„æ¦‚ç‡</span>\nFPR_xgb_after<span class=\"token punctuation\">,</span> recall_xgb_after<span class=\"token punctuation\">,</span> thresholds_after <span class=\"token operator\">=</span> roc_curve<span class=\"token punctuation\">(</span>val_y<span class=\"token punctuation\">,</span>predictions_xgb_after<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> pos_label<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\narea_xgb_after <span class=\"token operator\">=</span> auc<span class=\"token punctuation\">(</span>FPR_xgb_after<span class=\"token punctuation\">,</span>recall_xgb_after<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'è°ƒå‚åxgboostæ¨¡å‹ç»“æœï¼š\\n'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'é¢„æµ‹å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'é¢„æµ‹å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>index<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'çœŸå®å€¼=1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'çœŸå®å€¼=0'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>data<span class=\"token operator\">=</span>confusion_matrix_XGB_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">#æ··æ·†çŸ©é˜µ</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"f1å€¼:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>f1_score_XGB_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ç²¾ç¡®åº¦å’Œå¬å›ç‡:\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>scores_XGB_after<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\0d97e3531cc4413ca61f9374d1dda0b5.png\"/></p>\n<pre><code class=\"prism language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_xgb_after<span class=\"token punctuation\">,</span> recall_xgb_after<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span><span class=\"token string\">'XGBoost_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_xgb_after<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_svm_after<span class=\"token punctuation\">,</span> recall_svm_after<span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'SVM_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_svm_after<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>FPR_log_after<span class=\"token punctuation\">,</span> recall_log_after<span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'Logistic_AUC = %0.3f'</span> <span class=\"token operator\">%</span> area_log_after<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'lower right'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'r--'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Recall'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">'FPR'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'ROC_after_GridSearchCV'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ac429de4d24241b68bd96ff85ac103f7.png\"/><br/> å¦‚ä¸‹è¡¨æ˜¯åŸæ¨¡å‹å’Œè°ƒå‚åçš„æ¨¡å‹çš„æ¯”è¾ƒï¼ˆä¸åŒéšæœºæ•°ç§å­å¯èƒ½ç»“æœæœ‰æ‰€å‡ºå…¥ï¼‰ï¼š<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\ebb16fc90d174a8899b88ca4978e33f7.png\"/><br/> ä»å¯¹æ¯”ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè°ƒå‚åçš„æ¨¡å‹æ€§èƒ½æ€»ä½“ç•¥ä¼˜äºè°ƒå‚å‰çš„æ¨¡å‹ã€‚</p>\n<h1><a id=\"6__536\"></a>6 æ€»ç»“</h1>\n<p>æœ¬é¡¹ç›®ä»¥ä½“æ£€æ•°æ®é›†ä¸ºæ ·æœ¬è¿›è¡Œäº†æœºå™¨å­¦ä¹ çš„é¢„æµ‹ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼š</p>\n<p>ä½“æ£€æ•°æ®é‡å¤ªå°‘ï¼Œä»…æœ‰1006æ¡å¯åˆ†ææ•°æ®ï¼Œè¿™å¯¹äºç³–å°¿ç—…é¢„æµ‹æ¥è¯´æ˜¯è¿œè¿œä¸è¶³çš„ï¼Œæ‰€åˆ†æçš„ç»“æœä»£è¡¨æ€§ä¸å¼ºã€‚<br/> è¿™é‡Œçš„æ•°æ®ç³–å°¿ç—…å’Œæ­£å¸¸äººåŸºæœ¬ç›¸å½“ï¼Œè€ŒçœŸå®çš„æ•°æ®å…·æœ‰å¾ˆå¼ºçš„ä¸å¹³è¡¡æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç³–å°¿ç—…æ‚£è€…è¦è¿œå°‘äºæ­£å¸¸äººï¼Œè¿™ç§ä¸å¹³è¡¡çš„æ•°æ®é›†ç»™çœŸå®æƒ…å†µä¸‹ç³–å°¿ç—…çš„é¢„æµ‹å¸¦æ¥äº†å¾ˆå¤§å›°éš¾ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ä¸Šé‡‡æ ·ã€ä¸‹é‡‡æ ·æˆ–è€…å…¶ä»–æ–¹æ³•è¿›è¡Œä¸å¹³è¡¡æ•°æ®é›†çš„é¢„æµ‹ã€‚<br/> ç¼ºå°‘æ—¶åºæ•°æ®ä½¿å¾—é¢„æµ‹å˜å¾—ä¸å‡†ç¡®ï¼Œæ—¶åºæ•°æ®æ›´èƒ½å¤Ÿä½“ç°ä¸€ä¸ªäººçš„èº«ä½“çŠ¶æ€ã€‚</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-03 18:12:24", "summary": "å‰è¨€åŸºäºæœºå™¨å­¦ä¹ ä¸å¤§æ•°æ®çš„ç³–å°¿ç—…é¢„æµ‹å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†æ¯é¡¹æ»¡åˆ†åˆ†éš¾åº¦ç³»æ•°ï¼šåˆ†å·¥ä½œé‡ï¼šåˆ†åˆ›æ–°ç‚¹ï¼šåˆ†é€‰é¢˜æŒ‡å¯¼é¡¹ç›®åˆ†äº«ï¼šè¯¾é¢˜èƒŒæ™¯æœ¬é¡¹ç›®çš„ç›®çš„ä¸»è¦æ˜¯å¯¹ç³–å°¿ç—…è¿›è¡Œé¢„æµ‹ã€‚ä¸»è¦ä¾æ‰˜æŸåŒ»é™¢ä½“æ£€æ•°æ®å¤„ç†åï¼Œé¦–å…ˆ"}