{"blogid": "126660362", "writerAge": "码龄12年", "writerBlogNum": "372", "writerCollect": "611", "writerComment": "70", "writerFan": "1487", "writerGrade": "5级", "writerIntegral": "4321", "writerName": "biyezuopin", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126660362.jpg", "writerRankTotal": "4589", "writerRankWeekly": "2785", "writerThumb": "396", "writerVisitNum": "98337", "blog_read_count": "303", "blog_time": "于 2022-09-02 12:41:36 发布", "blog_title": "基于Python爬虫的股票成交量数据抓取分析系统", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>目录</p>\n<ol><li> <p>数据获取 2<br/> 1.1. 实验环境搭建 2<br/> 1.2. 抓取数据 2<br/> 1.2.1. 新浪财经 3<br/> 1.2.2. 网易财经 6<br/> 1.2.3. 东方财富 12<br/> 1.2.4. TuShare (挖地兔) 19<br/> 1.2.5. 其他平台 21<br/> 1.3. 数据获取总结 22<br/> 1.3.1. 股票代码抓取的总结 22<br/> 1.3.2. 日线数据抓取总结 22<br/> 1.3.3. 反爬虫策略及解决的总结 23</p> </li><li> <p>数据清洗（数据预处理） 23<br/> 2.1. 无效数据处理 24<br/> 2.2. 缺失数据处理 25</p> </li><li> <p>数据分析 27<br/> 3.1. 《胡立阳股票投资100招》 由“价量关系”来为个股打分 （一） 28<br/> 3.1.1. 介绍 28<br/> 3.1.2. 思路分析 28<br/> 3.1.3. 实现 29<br/> 3.1.4. 运行结果 29<br/> 3.1.5. 结果分析 36<br/> 3.2. 《胡立阳股票投资100招》 由“价量关系”来为个股打分 （二） 38<br/> 3.2.1. 思路分析 38<br/> 3.2.2. 实现 38<br/> 3.2.3. 分析结果 38<br/> 3.3. 主力进出 (ZLJC) (一) 41<br/> 3.3.1. 概念 41<br/> 3.3.2. 思路分析 41<br/> 3.3.3. 实现 42<br/> 3.4. 主力进出 (ZLJC) (二) 45<br/> 3.4.1. 前提引入 45<br/> 3.4.2. 主要问题及分析思路 45<br/> 3.4.3. 代码编写 45<br/> 3.4.4. 结果分析 46<br/> 3.5. 综合应用 48<br/> 3.5.1. 数据准备 48<br/> 3.5.2. 实现 48<br/> 3.5.3. 统计结果分析 50</p> </li><li> <p>优化方案 53<br/> 4.1. 爬虫性能优化 53<br/> 4.2. 数据读取效率优化 53<br/> 4.3. 编程模式的优化 54</p> </li><li> <p>总结 54</p> </li><li> <p>数据获取<br/> 1.1. 实验环境搭建<br/> 系统及使用的语言：<br/> Windows 10 专业版 1903 操作系统版本： 18362.356<br/> Python 3.7.3 64-bit<br/> 需要额外安装的库：<br/> virtualenv-16.6.0： pip install virtualenv<br/> requests-2.22.0： pip install requests<br/> 所依赖的模块：URLlib3 在安装 requests 时会自动安装尝试切换页面， 查看地址栏 URL 的变化<br/> BeautifulSoup4-4.8., 未发生改变ip install BeautifulSoup4`<br/> pandas: pip install pandas<br/> 所依赖的模块：pytz ,numpy, python-dateutil, six, 在安装 requests 时会自动安装<br/> tqdm-4.36.1: pip install tqdm<br/> 1.2. 抓取数据<br/> 数据的抓取是构建数据仓库的第一步，首先需要确定数据来源，这个过程通常需要比较各个数据平台，考核数据平台的数据与研究需求的符合程度；具体表现在以下方面：<br/> 数据的可靠性<br/> 指数据来源是否可靠，有无数据敏感等潜在问题<br/> 数据的完整性<br/> 指与需求所需的数据相比是否有所缺失<br/> 数据是否齐全<br/> 获取的难易度<br/> 抓取过程的实现难度<br/> 在本选题中，对数据的需求主要是成交量, 而成交量又分为分时数据(单位时间为一交易日中的若干分钟)和分日数据(单位时间为一个交易日)，分时数据的数据量较为庞大，在这里，主要还是针对分日数据进行研究，由于股市的特殊性， 单一的成交量很难制定出可能有效的策略，所以在研究过程中，依旧需要其他的数据作为辅助，综上所述， 在数据抓取阶段，主要需要抓取的数据是：<br/> 股票代码列表<br/> 日线数据<br/> 本文转载自http://www.biyezuopin.vip/onews.asp?id=15692</p> </li></ol>\n<pre><code>import sys\nimport json\nimport pandas as pd\n\nclass Unity(object):\n\n    def __init__(self):\n        const_path = sys.path[0].replace(\"\\\\analyze_data\", \"\")\n        f = open(const_path + \"\\\\const.json\", \"r\", encoding=\"utf8\")\n        self.consts = json.loads(f.read())\n\n    def do(self):\n        f1 = open(sys.path[0] + \"\\\\hly_count_res_max_4_group_by_date.json\", \"r\", encoding=\"utf-8\")\n        hly = json.loads(f1.read())\n        \n        f2 = open(sys.path[0] + \"\\\\zljc\\\\zljc_day_a.json\", \"r\", encoding=\"utf-8\")\n        zljc = json.loads(f2.read())\n\n        res = {}\n        for code in zljc:\n            for a in zljc[code]:\n                for day in zljc[code][a]:\n                    for date in zljc[code][a][day][\"dates_yes\"]:\n                        # 筛选 hly 中该日期的股票有没有当前这只\n                        if date in hly.keys() and code in hly[date]:\n                            if date not in res.keys(): res[date] = []\n                            if code not in res[date]: res[date].append(code)\n\n        \n        f3 = open(sys.path[0] + \"\\\\hly_and_zljc_res.json\", \"w\", encoding=\"utf-8\")\n        f3.write(json.dumps(res, ensure_ascii=False))\n        f3.close()\n        f2.close()\n        f1.close()\n\n    def verify(self):\n        f = open(sys.path[0] + \"\\\\hly_and_zljc_res.json\", \"r\", encoding=\"utf-8\")\n        res = json.loads(f.read())\n        transform_dic = {}\n        for date in res:\n            for code in res[date]:\n                if code not in transform_dic:\n                    transform_dic[code] = []\n                transform_dic[code].append(date)\n        # f3 = open(sys.path[0] + \"\\\\hly_and_zljc_res_transform.json\", \"w\", encoding=\"utf-8\")\n        # f3.write(json.dumps(transform_dic, ensure_ascii=False))\n        # f3.close()\n\n        count = {\n            \"yes\": 0,\n            \"no\": 0\n        }\n        for code in transform_dic:\n            print(code)\n            try:\n                df = pd.read_csv(\"%s%s.csv\" %  (self.consts['path']['result']['hly'], code), encoding=\"gbk\")\n            except:\n                print(\"ERROR OPENING %s\" % code)\n                continue\n            for index, row in df.iterrows():\n                if row['日期'] in transform_dic[code]:\n                    if index - 5 &gt; 0:\n                        if df.loc[index-5, \"收盘价\"] &gt; row[\"收盘价\"]:\n                            count[\"yes\"] += 1\n                        else:\n                            count[\"no\"] += 1\n\n        print(count)\n\nif __name__ == \"__main__\":\n    u = Unity()\n    # u.do()\n    u.verify()\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cf39235200c8485192741172e968db71.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4e2052e724674f03a0ef014e4ba1ab2b.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\bdfc4ea415754607913043a607be9efe.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a54d3414a2434318a3909b9a3d71c71f.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\80cf78b36b9045b487b0dd8d4af648f1.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5c343093f85e489fa6f971a8f1ba4a64.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\453adcbe742c415288bf159928fc8a51.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\668455bca6564eed9be4b4b3ae397658.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\aa30928be2f949c7830e69a9be7c4ebd.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b71818b9f9964674b8195e2077809f99.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\05717384f2bd43239ea8b3537c97c1b4.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4285d58ecf6945b2bc0a281aedbe3531.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\389156f6b2144cf98cf036c47447e783.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\428a1007609c475e9afcd06bdcc0c1e3.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\29f579e9526b4448a287b7f936ee9bbc.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c41b492c477f4334b4141dc1f76f77e4.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\740c0610928445e5bff5a749f04d3195.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0d86150839fe47dd88bbb0f352afa374.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6aad074448a94aab8b8ad1542bdad14c.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\68f5ce27adac489e98fccc8be879bc5d.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5197bacd302243e1911999cc99292e11.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cc97f7a82bcb4c52a8dbfd10745dab89.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\bc18fb9f95034e46b5494bf4e1858d12.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8d617e17d2c344b08f12f1adf6d6c18b.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ce70c333a8be44c89733794e92198259.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\11f4773d3a8a46c8948c48066e3cf66a.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\795702a47b1c43a9bd2c3899afeee53b.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3aeb45fe32fb40949bc54efb3b9e7f2f.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6b7346c743aa4be6a0a997dc0c5c3a14.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\43a0fa6be0164c68a9cef71f6adb729a.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\619663ff5a724a0e875668f9597731c5.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\81faa43e04974398a058c18b0af3fbf2.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\eba6e65fc5a44f7fb7398199975a0172.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\809d9fecd9e2438bb4f81665dab0eec5.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7879c6d8165144c797c3cc0bca09bc3c.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0aca5868a0ed4a7e9efb68c97648bf43.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c633cd1a7ea24f77ab7880f80330c7b8.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4c07dba0146341d281c456246df97748.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4d818941e5544943a06a3b8c2961730d.jpeg\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7876faec000d4102be95ca57024f05e3.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b696babbda974b72a57ffdaa4c2a7f56.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2934d81e9aa94fb787b3e336407e2817.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-02 12:41:36", "summary": "目录数据获取实验环境搭建抓取数据新浪财经网易财经东方财富挖地兔其他平台数据获取总结股票代码抓取的总结日线数据抓取总结反爬虫策略及解决的总结数据清洗数据预处理无效数据处理缺失数据处理数据分析《胡立阳股票"}