{"blogid": "121499332", "writerAge": "码龄2年", "writerBlogNum": "90", "writerCollect": "104", "writerComment": "49", "writerFan": "143", "writerGrade": "4级", "writerIntegral": "1039", "writerName": "先生沉默先", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121499332.jpg", "writerRankTotal": "20223", "writerRankWeekly": "15609", "writerThumb": "53", "writerVisitNum": "101878", "blog_read_count": "9065", "blog_time": "于 2021-11-23 18:44:40 发布", "blog_title": "Unity切换场景保存上一个场景的数据，Unity切换场景的案例,Unity切换场景再返回数据丢失的解决方案", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"_0\"></a>问题:</h1>\n<p>Unity在切换场景之后在再次返回上不会保存上一个场景的数据的。<br/> 但是大多数时候我们是需要这些数据的，这应该如何解决呢？</p>\n<h1><a id=\"_4\"></a>解决方案：</h1>\n<ol><li>文件链接：<a href=\"https://download.csdn.net/download/GoodCooking/47537740\">我将解决方案打包了，点我下载，免费，或者私信我发你</a></li><li>首先将需要存储到一个class中，这里以学生为例子</li></ol>\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\nusing System;\n\nnamespace ScenceChange\n{\n    [Serializable]\n    public class StudentEnity\n    {\n        public string Name;\n        public string Description;\n        public float _Time;\n    }\n}\n\n\n</code></pre>\n<ol start=\"3\"><li>然后我们再创建一个脚本，并这个脚本挂到Unity场景中的游戏物体上.</li></ol>\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing System.Linq;\nusing UnityEngine;\n\nnamespace ScenceChange\n{\n    public class tudentGaemObject : MonoBehaviour\n    {\n        public StudentEnity StudentEnity;\n        public int No;\n\n        private void Start()\n        {\n            var stu = GameManger._Instance.students.FirstOrDefault(p =&gt; p.Name == StudentEnity.Name);\n            if (stu != null)\n            {\n                StudentEnity = stu;\n            }\n            else\n            {\n                GameManger._Instance.AddStudent(StudentEnity);\n            }\n            // UI 显示对应的student属性内容\n        }\n\n        private void Update()\n        {\n            StudentEnity._Time = StudentEnity._Time + Time.deltaTime;\n        }\n    }\n}\n\n</code></pre>\n<p>GameManager中的代码</p>\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\nnamespace ScenceChange\n{\n    public class GameManger : SingletonBase&lt;GameManger&gt;\n    {\n        public List&lt;StudentEnity&gt; students;\n        private void Awake()\n        {\n            DontDestroyOnLoad(this);\n            students = new List&lt;StudentEnity&gt;();\n        }\n\n        public void AddStudent(StudentEnity student)\n        {\n            if (!students.Contains(student))\n            {\n                students.Add(student);\n            }\n        }\n    }\n}\n\n</code></pre>\n<p>SingletonBase中的代码</p>\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\nnamespace ScenceChange\n{\n    public class GameManger : SingletonBase&lt;GameManger&gt;\n    {\n        public List&lt;StudentEnity&gt; students;\n        private void Awake()\n        {\n            DontDestroyOnLoad(this);\n            students = new List&lt;StudentEnity&gt;();\n        }\n\n        public void AddStudent(StudentEnity student)\n        {\n            if (!students.Contains(student))\n            {\n                students.Add(student);\n            }\n        }\n    }\n}\n</code></pre>\n<ol start=\"4\"><li>在上面我们完成了数据载体的创建（StudentEnity，tudentGaemObject ），以及场景切换的时候用于保存数据的载体（GameManger ，StudentEnity）。</li><li>接下来我们做一些场景切换的工作，创建两个场景，一个名字为\"ScenceA\"，另外一个为“ScenceB“，分别在场景中创建一个Button，场景A的按钮挂在这个脚本</li></ol>\n<pre><code> private void Awake()\n        {\n            Button but=gameObject.GetComponent&lt;Button&gt;();\n            but.onClick.AddListener(delegate\n            {\n                SceneManager.LoadScene(\"ScenceB\");\n            });\n        }\n\n</code></pre>\n<p>场景B挂载这个脚本</p>\n<pre><code>        private void Awake()\n        {\n            Button but = gameObject.GetComponent&lt;Button&gt;();\n            but.onClick.AddListener(delegate\n            {\n                SceneManager.LoadScene(\"ScenceA\");\n            });\n        }\n</code></pre>\n<p>然后点击按钮就会跳转场景。</p>\n<ol start=\"6\"><li>然后测试一下就会发现场景跳转 <code>StudentEnity</code>中的<code>_Time</code>还是会按照跳转之前的继续增加。</li></ol>\n<h2><a id=\"Enjoy__152\"></a>Enjoy ，不懂私信，我会看。</h2>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2021-11-23 18:44:40", "summary": "问题在切换场景之后在再次返回上不会保存上一个场景的数据的。但是大多数时候我们是需要这些数据的，这应该如何解决呢？解决方案：文件链接：我将解决方案打包了，点我下载，免费，或者私信我发你首先将需要存储到一"}