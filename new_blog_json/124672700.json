{"blogid": "124672700", "writerAge": "码龄10年", "writerBlogNum": "1204", "writerCollect": "1976", "writerComment": "450", "writerFan": "6638", "writerGrade": "8级", "writerIntegral": "35109", "writerName": "虚坏叔叔", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124672700.jpg", "writerRankTotal": "220", "writerRankWeekly": "1298", "writerThumb": "760", "writerVisitNum": "2685964", "blog_read_count": "1741", "blog_time": "于 2022-05-09 18:56:58 发布", "blog_title": "C++ ifstream open 读取txt/json文件出现中文乱码的解决问题", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"C_ifstream_open_txtjson_0\"></a>C++ ifstream open 读取txt/json文件出现中文乱码的解决方法</h1>\n<p>作者：虚坏叔叔<br/> 博客：<a href=\"https://xuhss.com/\">https://xuhss.com</a></p>\n<blockquote>\n<p>早餐店不会开到晚上，想吃的人早就来了！😄</p>\n</blockquote>\n<p>在编程中，我们经常需要对txt/json文件进行读写操作，有时候由于编<a href=\"https://so.csdn.net/so/search?q=%E8%A7%A3%E7%A0%81&amp;spm=1001.2101.3001.7020\">解码</a>问题，txt读写会出现乱码问题。下面介绍一种基于<code>ofstream</code>和<code>ifstream</code>的txt文件读写方法，并介绍<code>txt</code>文件读写的乱码解决方案。</p>\n<h2><a id=\"txt_9\"></a>一、txt文件写入</h2>\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{   \n    ofstream outfile(\"1.txt\",ios::ate);   //打开文件，设置写入方式为覆盖写入\n\n    if(!outfile)\n    {\n        cout&lt;&lt;\"txt文件打开失败!\"&lt;&lt;endl;\n        exit(0);\n    }\n\n    outfile&lt;&lt;\"写入txt文件示例.\\n\";\n    outfile&lt;&lt;\"成功写入.\\n\";\n\n    outfile.close();\n}\n</code></pre>\n<p><code>txt</code>里面的写入内容如下：</p>\n<p><img alt=\"这里写图片描述\" src=\"https://img-blog.csdn.net/20151119171448205\"/></p>\n<p>成功写入。</p>\n<h2><a id=\"txt_39\"></a>二、txt文件读出</h2>\n<p>对上面读入内容的<code>txt</code>进行读出操作，代码如下：</p>\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main()\n{   \n    char txt[100];\n    ifstream infile;\n    infile.open(\"1.txt\");\n\n    if(!infile.is_open())\n    {\n        cout&lt;&lt;\"txt文件打开失败\"&lt;&lt;endl;\n        exit(0);\n    }\n\n    while(!infile.eof())\n    {       \n        infile.getline(txt,100);\n        cout&lt;&lt;txt&lt;&lt;endl;\n    }\n\n    infile.close();\n    getchar();\n}\n</code></pre>\n<p>读出结果为：</p>\n<p><img alt=\"这里写图片描述\" src=\"https://img-blog.csdn.net/20151119171759127\"/></p>\n<p>读出结果正确。</p>\n<h2><a id=\"_txthttpssocsdnnetsosearchqspm1001210130017020_77\"></a>三、 txt读写<a href=\"https://so.csdn.net/so/search?q=%E4%B9%B1%E7%A0%81&amp;spm=1001.2101.3001.7020\">乱码</a>问题</h2>\n<p>有时候由于txt文件编码问题的不同，会导致读写的时候出现乱码，通常的<code>txt</code>编码方式有：</p>\n<p><img alt=\"这里写图片描述\" src=\"https://img-blog.csdn.net/20151119171958244\"/></p>\n<p>上面默认的编码方式为<code>ANSI</code>，如果我们现在将它另存为<code>1.txt</code>，但编码格式变为<code>UTF-8</code>，那么读出结果会变成：</p>\n<p><img alt=\"这里写图片描述\" src=\"https://img-blog.csdn.net/20151119172137959\"/></p>\n<p>发现结果完全错误，这时候我们需要编解码转换，具体代码如下：</p>\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include &lt;Windows.h&gt;\n#include &lt;string&gt;\nusing namespace std;\n\nstring UTF8ToGB(const char* str)\n{\n     string result;\n     WCHAR *strSrc;\n     LPSTR szRes;\n\n     //获得临时变量的大小\n     int i = MultiByteToWideChar(CP_UTF8, 0, str, -1, NULL, 0);\n     strSrc = new WCHAR[i+1];\n     MultiByteToWideChar(CP_UTF8, 0, str, -1, strSrc, i);\n\n     //获得临时变量的大小\n     i = WideCharToMultiByte(CP_ACP, 0, strSrc, -1, NULL, 0, NULL, NULL);\n     szRes = new CHAR[i+1];\n     WideCharToMultiByte(CP_ACP, 0, strSrc, -1, szRes, i, NULL, NULL);\n\n     result = szRes;\n     delete []strSrc;\n     delete []szRes;\n\n     return result;\n}\n\nstd::string readFile(std::string file)\n{\n\tstd::ifstream infile;\n\tinfile.open(file.data());   //将文件流对象与文件连接起来 \n\tassert(infile.is_open());   //若失败,则输出错误消息,并终止程序运行 \n\n\tstring s; string strAllLine;\n\twhile (getline(infile, s)){\n\t\tstring line = UTF8ToGB(s.c_str()).c_str();\n\t\tstrAllLine += line;\n\t}\n\n\n\tinfile.close();             //关闭文件输入流 \n\treturn strAllLine;\n\t\n}\n\nint main()\n{   \n    string msg =readFile(2.txt)\n    getchar();\n}\n</code></pre>\n<h2><a id=\"_144\"></a>四、总结</h2>\n<ul><li>本文主要介绍读取中文文件乱码的问题。</li><li>如果觉得文章对你有用处，记得 <code>点赞</code> <code>收藏</code> <code>转发</code> 一波哦~</li></ul>\n<h2><a id=\"__149\"></a>💬 往期优质文章分享</h2>\n<ul><li><a href=\"https://blog.csdn.net/biggbang/article/details/124215339\">C++ QT结合FFmpeg实战开发视频播放器-01环境的安装和项目部署</a></li><li><a href=\"https://blog.csdn.net/biggbang/article/details/124226156\">解决QT问题：运行qmake：Project ERROR: Cannot run compiler ‘cl‘. Output:</a></li><li><a href=\"https://blog.csdn.net/biggbang/article/details/124222839\">解决安装QT后MSVC2015 64bit配置无编译器和调试器问题</a></li><li><a href=\"https://blog.csdn.net/biggbang/article/details/124213810\">Qt中的套件提示no complier set in kit和no debugger，出现黄色感叹号问题解决（MSVC2017）</a></li><li><a href=\"https://blog.csdn.net/huangbangqing12/article/details/123939242\">Python+selenium 自动化 - 实现自动导入、上传外部文件（不弹出windows窗口）</a></li></ul>\n<h2><a id=\"___157\"></a>🚀 优质教程分享 🚀</h2>\n<ul><li>🎄如果感觉文章看完了不过瘾，可以来我的其他 专栏 看一下哦~</li><li>🎄比如以下几个专栏：Python实战微信订餐小程序、Python量化交易实战、C++ QT实战类项目 和 算法学习专栏</li><li>🎄可以学习更多的关于C++/Python的相关内容哦！直接点击下面颜色字体就可以跳转啦！</li></ul>\n<table><thead><tr><th>学习路线指引（点击解锁）</th><th>知识定位</th><th>人群定位</th></tr></thead><tbody><tr><td><a href=\"https://edu.csdn.net/course/detail/36074\">🧡 Python实战微信订餐小程序 🧡</a></td><td>进阶级</td><td>本课程是python flask+微信小程序的完美结合，从项目搭建到腾讯云部署上线，打造一个全栈订餐系统。</td></tr><tr><td>💛<a href=\"https://download.csdn.net/course/detail/35475\">Python量化交易实战</a> 💛</td><td>入门级</td><td>手把手带你打造一个易扩展、更安全、效率更高的<a href=\"https://so.csdn.net/so/search?q=%E9%87%8F%E5%8C%96%E4%BA%A4%E6%98%93&amp;spm=1001.2101.3001.7020\">量化交易</a>系统</td></tr><tr><td>❤️ <a href=\"https://blog.csdn.net/biggbang/category_11761704.html\">C++ QT结合FFmpeg实战开发视频播放器</a>❤️</td><td>难度偏高</td><td>分享学习QT成品的视频播放器源码，需要有扎实的C++知识！</td></tr><tr><td>💚 游戏爱好者九万人社区💚</td><td>互助/吹水</td><td>九万人游戏爱好者社区，聊天互助，白嫖奖品</td></tr><tr><td>💙 Python零基础到入门 💙</td><td>Python初学者</td><td>针对没有经过系统学习的小伙伴，核心目的就是让我们能够快速学习Python的知识以达到入门</td></tr></tbody></table>\n<h2><a id=\"___171\"></a>🚀 资料白嫖，<strong>温馨提示</strong> 🚀</h2>\n<p>关注下面卡片即刻获取更多编程知识，包括各种语言学习资料，上千套PPT模板和各种游戏源码素材等等资料。更多内容可自行查看哦！</p>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/2e3d1f57d8cc4b689c0ec284120b1acc.gif#pic_center\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 1, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-05-09 18:56:58", "summary": "读取文件出现中文乱码的解决方法作者：虚坏叔叔博客：早餐店不会开到晚上，想吃的人早就来了！在编程中，我们经常需要对文件进行读写操作，有时候由于编解码问题，读写会出现乱码问题。下面介绍一种基于和的文件读写"}