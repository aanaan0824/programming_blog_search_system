{"blogid": "125766771", "writerAge": "码龄3年", "writerBlogNum": "6", "writerCollect": "2", "writerComment": "1", "writerFan": "2", "writerGrade": "1级", "writerIntegral": "63", "writerName": "TidyDogg", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125766771.jpg", "writerRankTotal": "116239", "writerRankWeekly": "330365", "writerThumb": "1", "writerVisitNum": "2197", "blog_read_count": "1053", "blog_time": "已于 2022-08-17 22:12:05 修改", "blog_title": "使用C#对MySQL进行操作", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<h1>1.下载并安装MySQL</h1>\n<h1>2.配置环境变量</h1>\n<p>        1）右键我的电脑-&gt;属性-&gt;高级系统设置-&gt;环境变量。</p>\n<p>        2）新建系统变量，变量名建议与MySQL相关，如MYSQL_HOME or MYSQL_PATH，变量值为安装路径。如图所示：</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\6c77f32bf73d49eb9919d70f8cc7335c.png\"/></p>\n<p>         3）修改Path变量。点击Path-&gt;编辑-&gt;新建，%MYSQL_PATH%\\bin,其中，两个百分号中间的即为刚才设置的变量名，用于识别MySQL安装路径。</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\8a645ee29d6d479d8e877fdb83e324d2.png\"/></p>\n<blockquote>\n<p style=\"text-align:center;\">嘿嘿，我也不知道为什么要打码</p>\n</blockquote>\n<p>         4）上述步骤是为了能在cmd中快速访问到MySQL所在路径，也不是必需。如果你不介意的话，可以每次打开cmd然后cd到对应文件夹，也不影响。</p>\n<p>        5）打开MySQL安装目录，进去后应该能看到一个bin文件夹。在与bin文件夹同级处，新建一个my.ini配置文件，将下列信息输入。</p>\n<pre><code>[mysql]\n\n#设置mysql客户端默认字符集\n\ndefault-character-set=utf8\n\n[mysqld]\n\n#设置3306端口\n\nport = 3306\n\n#设置mysql的安装目录\n\nbasedir=E:\\WorkSpace\\3 MySql\\mysql-8.0.19-winx64\n\n#设置mysql数据库的数据的存放目录\n\ndatadir=E:\\WorkSpace\\3 MySql\\mysql-8.0.19-winx64\\data\n\n#允许最大连接数\n\nmax_connections=20\n\n#服务端使用的字符集默认为8比特编码的latin1字符集\n\ncharacter-set-server=utf8\n\n#创建新表时将使用的默认存储引擎\n\ndefault-storage-engine=INNODB\n\n# 调整mysql sql_mode以支持group by可以查出多个字段sql_mode=STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</code></pre>\n<p>        <strong>注意basedir与datadir应该修改为MySQL所在的安装目录</strong>，否则后续操作下可能导致报错。</p>\n<p>        6）管理员身份运行cmd，初始化MySQL。输入指令 <strong>mysqld --initialize </strong>，理论上啥都不会输出，如果报错，检查是否my.ini文件下的basedir和datadir路径出错。当然，也可以输入指令 <strong>mysqld --initialize --console</strong> ,这样输出会有好长一段，末尾会有账号密码，一般账号为root，密码需要记下来。</p>\n<p>        7）初始化后，输入指令 <strong>mysqld --install </strong>，输出 <strong>Service successfully installed</strong> 表明安装成功。</p>\n<p>        8）开启MySQL服务。输入指令 <strong>net start mysql</strong> ，输出 <strong>MySQL服务已经启动成功</strong> 后，说明数据库已成功开启。</p>\n<p>        9）关于MySQL具体指令，此处不表。至此，本机上的数据库已成功开启，可以进行下一步操作。</p>\n<h1>3.引用dll文件</h1>\n<p>        下载并引用MySql.Data.dll文件。下载该dll的方式有多种，可自行搜索，这里提供一种相当便捷的下载方法，适用于各类常用的dll文件的下载安装。</p>\n<p>        在VS2022工程中，任意脚本函数中，输入 <strong>MySqlConnection msc = new MySqlConnection(); </strong></p>\n<p>        由于类MySqlConnection是MySql.Data.dll中定义的，VS会报错。此时，启用VS的快捷操作和重构，可以找到安装MySql.Data，可以快速下载、并引用相应的dll文件。该方法对于市面上大部分dll文件适用。微软，yyds！！</p>\n<h1>4.具体API调用</h1>\n<pre><code class=\"language-cs\">        //data source 连接的主机ip，如果是本地主机，可以使用localhost\n        //port MySQL统一使用3306端口号\n        //database 选择连接的数据库，可以待连接之后进行更换\n        //user 用户名\n        //password 密码\n        //charset 编码方式，使用utf8，跟my.ini保持一致，避免乱码\n        //该语句中，所有参数位置可以任意调换，只要参数名保持一致即可\n        private const string connectionStr =\n            \"data source = localhost; port = 3306; database = test1; user = root; password = yourPassword; charset = utf8;\";\n\n        public void TestMySql()\n        {\n            MySqlConnection msc = new MySqlConnection(connectionStr);\n            msc.Open();\n\n            //具体的sql语句，啥内容都行\n            string sqlStr = \"drop table student;\";\n            MySqlCommand cmd = new MySqlCommand(sqlStr, msc);\n\n            //cmd.ExecuteNonQuery()方法执行了我们输入的sql语句\n            //对于部分的sql语句而言，执行完后，会得到 QueryOK. r rows affected 的输出\n            //这个r就是该方法的返回值\n            //当然，对于没有该输出的方法而言，其返回值为-1\n            int r = cmd.ExecuteNonQuery();\n\n            msc.Close();\n        }\n</code></pre>\n<p>调用前的数据库：</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\3b11db1f1d53445ebb1d9674c33e1d36.png\"/></p>\n<p>调用后的数据库：</p>\n<p style=\"text-align:center;\"> <img alt=\"\" src=\"..\\..\\static\\image\\cc5ee3ef98314e9f9afeee6677e19d60.png\"/></p>\n<p></p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-08-17 22:12:05", "summary": "下载并安装配置环境变量右键我的电脑属性高级系统设置环境变量。新建系统变量，变量名建议与相关，如，变量值为安装路径。如图所示：修改变量。点击编辑新建，其中，两个百分号中间的即为刚才设置的变量名，用于识别"}