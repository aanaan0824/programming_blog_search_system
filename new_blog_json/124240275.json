{"blogid": "124240275", "writerAge": "码龄6年", "writerBlogNum": "61", "writerCollect": "246", "writerComment": "11", "writerFan": "173", "writerGrade": "3级", "writerIntegral": "738", "writerName": "zzzxydq", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124240275.jpg", "writerRankTotal": "55944", "writerRankWeekly": "57349", "writerThumb": "68", "writerVisitNum": "67026", "blog_read_count": "5196", "blog_time": "已于 2022-04-21 09:10:28 修改", "blog_title": "python往word文档中写入表格、段落、标题、图片...（超级全）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"1pythondocx_0\"></a>1、安装python-docx</h1>\n<p>我们使用python-docx来操作word文档，首先是安装：</p>\n<pre><code class=\"prism language-shell\">pip <span class=\"token function\">install</span> python-docx -i https://pypi.tuna.tsinghua.edu.cn/simple\n</code></pre>\n<p>然后放两个参考文档：</p>\n<ul><li>官方手册：<a href=\"https://python-docx.readthedocs.io/en/latest/index.html\">https://python-docx.readthedocs.io/en/latest/index.html</a></li><li>pypi官方地址：<a href=\"https://pypi.org/project/python-docx/\">https://pypi.org/project/python-docx/</a></li></ul>\n<h3><a id=\"_9\"></a>使用步骤</h3>\n<ul><li><code>步骤1</code> 导入docx模块</li><li><code>步骤2</code> 创建或读取一个文档对象</li><li><code>步骤3</code> 向文档写入内容</li><li><code>步骤4</code> 生成docx文件</li></ul>\n<p>上代码：</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 步骤1</span>\n<span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n\n<span class=\"token comment\"># 步骤2</span>\ndocument <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 新建文档对象</span>\n<span class=\"token comment\"># document = Document(\"test.docx\")  # 读取现有word文档，建立文档对象</span>\n\n<span class=\"token comment\"># 步骤3</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token comment\"># 步骤4</span>\ndocument<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"test.docx\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 保存文档</span>\n</code></pre>\n<h1><a id=\"2_31\"></a>2、添加标题</h1>\n<p>要求：添加标题，能设置标题的字体、大小、颜色等</p>\n<p>上代码：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>shared <span class=\"token keyword\">import</span> Pt<span class=\"token punctuation\">,</span> RGBColor\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>oxml<span class=\"token punctuation\">.</span>ns <span class=\"token keyword\">import</span> qn\n\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 第一种设置标题的方式</span>\nd<span class=\"token punctuation\">.</span>add_heading<span class=\"token punctuation\">(</span><span class=\"token string\">\"一级标题 hello world\"</span><span class=\"token punctuation\">,</span> level<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 第二种设置标题的方式，此方式还可以设置文本的字体、颜色、大小等属性</span>\nrun <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_heading<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> level<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>add_run<span class=\"token punctuation\">(</span><span class=\"token string\">\"二级标题\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置西文字体</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'宋体'</span>\n<span class=\"token comment\"># 设置中文字体</span>\nrun<span class=\"token punctuation\">.</span>_element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'宋体'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置字体颜色</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">=</span> RGBColor<span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55</span><span class=\"token punctuation\">,</span> <span class=\"token number\">55</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 红色</span>\n<span class=\"token comment\"># 设置字体大小</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置下划线</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>underline <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token comment\"># 设置删除线</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>strike <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token comment\"># 设置加粗</span>\nrun<span class=\"token punctuation\">.</span>bold <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token comment\"># 设置斜体</span>\nrun<span class=\"token punctuation\">.</span>italic <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n<span class=\"token comment\"># 保存文档</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"test.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>代码解释：</p>\n<table><thead><tr><th>方法名</th><th align=\"left\">描述</th></tr></thead><tbody><tr><td><code>add_heading(text=\"\", level=1)</code></td><td align=\"left\">写入标题，默认标题样式为level1，level范围为0-9</td></tr><tr><td><code>add_run(text=None, style=None)</code></td><td align=\"left\">可以添加文本（包括标题、正文、表格文字等），并且能为其设置字体格式、颜色、大小等属性</td></tr></tbody></table>\n<ul><li>设置字体有两种方式，一种是全局配置，但是只对正文起作用：<pre><code class=\"prism language-python\">d <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'宋体'</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>_element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'宋体'</span><span class=\"token punctuation\">)</span>\n</code></pre> </li><li>但是上面这种方式无法对add_heading()起作用，需要对标题设置字体，需要使用下面这种方式：<pre><code class=\"prism language-python\">run <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_heading<span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> level<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>add_run<span class=\"token punctuation\">(</span><span class=\"token string\">\"三级标题\"</span><span class=\"token punctuation\">)</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'宋体'</span>\nrun<span class=\"token punctuation\">.</span>_element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'宋体'</span><span class=\"token punctuation\">)</span>\n</code></pre> </li><li>使用<code>run.font.size = Pt(30)</code>设置字体大小，Pt表示磅，与字号对应关系如下： \n  <table><thead><tr><th align=\"center\">号数</th><th align=\"center\">磅值 (Pt)</th></tr></thead><tbody><tr><td align=\"center\">初号</td><td align=\"center\">42</td></tr><tr><td align=\"center\">小初</td><td align=\"center\">36</td></tr><tr><td align=\"center\">一号</td><td align=\"center\">26</td></tr><tr><td align=\"center\">小一</td><td align=\"center\">24</td></tr><tr><td align=\"center\">二号</td><td align=\"center\">22</td></tr><tr><td align=\"center\">小二</td><td align=\"center\">18</td></tr><tr><td align=\"center\">三号</td><td align=\"center\">16</td></tr><tr><td align=\"center\">小三</td><td align=\"center\">15</td></tr><tr><td align=\"center\">四号</td><td align=\"center\">14</td></tr><tr><td align=\"center\">小四</td><td align=\"center\">12</td></tr><tr><td align=\"center\">五号</td><td align=\"center\">10.5</td></tr><tr><td align=\"center\">小五</td><td align=\"center\">9</td></tr><tr><td align=\"center\">六号</td><td align=\"center\">7.5</td></tr><tr><td align=\"center\">小六</td><td align=\"center\">6.5</td></tr><tr><td align=\"center\">七号</td><td align=\"center\">5.5</td></tr><tr><td align=\"center\">八号</td><td align=\"center\">5</td></tr></tbody></table> </li></ul>\n<h1><a id=\"3_102\"></a>3、添加段落</h1>\n<h3><a id=\"1_103\"></a>举例1：段落、分页、有序列表、无序列表、引用</h3>\n<p>上代码</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>shared <span class=\"token keyword\">import</span> Pt\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>oxml<span class=\"token punctuation\">.</span>ns <span class=\"token keyword\">import</span> qn\n\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置全局属性</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'Times New Roman'</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宋体'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新增一个段落</span>\np1 <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"这是第一个段落：\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 继续添加文字</span>\nrun <span class=\"token operator\">=</span> p1<span class=\"token punctuation\">.</span>add_run<span class=\"token punctuation\">(</span><span class=\"token string\">\"段落中的文字\"</span><span class=\"token punctuation\">)</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">10.5</span><span class=\"token punctuation\">)</span>\nrun<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'宋体'</span>\nrun<span class=\"token punctuation\">.</span>_element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u'宋体'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 有序列表</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"有序列表1111\"</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"List Number\"</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"有序列表2222\"</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"List Number\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 无序列表</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"无序列表3333\"</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"List Bullet\"</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"无序列表4444\"</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"List Bullet\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 引用</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"引用5555\"</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"Intense Quote\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 在段落p1前添加一个段落</span>\np1<span class=\"token punctuation\">.</span>insert_paragraph_before<span class=\"token punctuation\">(</span><span class=\"token string\">\"在段落p1前添加一个段落，我才是第一个段落\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 增加分页</span>\nd<span class=\"token punctuation\">.</span>add_page_break<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 添加一个段落</span>\np2 <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"我是新分页中的段落\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 新分页中文字首行缩进两个字</span>\np2<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>first_line_indent <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"1111.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>效果图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\c7ddabead6fd4ef896393dd4b42f93e7.png\"/></p>\n<p>代码解释：</p>\n<table><thead><tr><th>方法名</th><th align=\"left\">描述</th></tr></thead><tbody><tr><td><code>add_paragraph(text=\"\", style=None)</code></td><td align=\"left\">1、插入段落，通过style可以设置插入段落的类型<br/>2、<code>List Number</code> 表示有序段落<br/>3、<code>List Bullet</code> 表示无序段落<br/>4、<code>Intense Quote</code> 表示引用</td></tr><tr><td><code>insert_paragraph_before(text=None, style=)</code></td><td align=\"left\">插入段落到现有段落之前</td></tr><tr><td><code>add_page_break()</code></td><td align=\"left\">新增分页，后续的内容会出现在新的分页中</td></tr></tbody></table>\n<ul><li>字体效果：如果设置了全局的字体属性，那么所有正文都是那种字体，但是可以通过<code>add_run()</code>对象设置新的字体</li><li>首行缩进：通过设置<code>paragraph_format.first_line_indent</code>属性可以设置缩进大小为当前字体大小的2倍</li></ul>\n<h3><a id=\"2_151\"></a>举例2：对齐、间距、行距</h3>\n<p>上代码</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>shared <span class=\"token keyword\">import</span> Pt<span class=\"token punctuation\">,</span> Inches\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>oxml<span class=\"token punctuation\">.</span>ns <span class=\"token keyword\">import</span> qn\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>enum<span class=\"token punctuation\">.</span>text <span class=\"token keyword\">import</span> WD_PARAGRAPH_ALIGNMENT\n\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">u'Times New Roman'</span>\nd<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">[</span><span class=\"token string\">'Normal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>element<span class=\"token punctuation\">.</span>rPr<span class=\"token punctuation\">.</span>rFonts<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>qn<span class=\"token punctuation\">(</span><span class=\"token string\">'w:eastAsia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'宋体'</span><span class=\"token punctuation\">)</span>\np <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"《静夜思》\"</span>\n                 <span class=\"token string\">\"床前明月光，\"</span>\n                 <span class=\"token string\">\"疑似地上霜。\"</span>\n                 <span class=\"token string\">\"举头望明月，\"</span>\n                 <span class=\"token string\">\"低头思故乡。\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置对齐格式</span>\n<span class=\"token comment\"># 可选项有LEFT、CENTER、RIGHT、JUSTIFY、DISTRIBUTE等</span>\np<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> WD_PARAGRAPH_ALIGNMENT<span class=\"token punctuation\">.</span>LEFT\n<span class=\"token comment\"># 设置段落缩进</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"右缩进，0.5英寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸寸\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>right_indent <span class=\"token operator\">=</span> Inches<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"左缩进，20磅\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>left_indent <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"首行缩进2个字符\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>first_line_indent <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span>\n<span class=\"token comment\"># 设置段落间距 1.5倍行间距 1.5, 单倍行间距 1.0</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"line_spacing设置为浮点数，表示行间距为行高的倍数\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>line_spacing <span class=\"token operator\">=</span> <span class=\"token number\">1.5</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"line_spacing设置为具体的长度值，表示绝对距离\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>line_spacing <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"space_before表示段前间距\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>space_before <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"space_after表示段后间距\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>space_after <span class=\"token operator\">=</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置段落内部文字在遇到需分页情况时处理状态</span>\np2 <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_paragraph<span class=\"token punctuation\">(</span><span class=\"token string\">\"很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落很长的段落\"</span><span class=\"token punctuation\">)</span>\np2<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>keep_together <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>  <span class=\"token comment\"># 段中不分页</span>\np2<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>keep_with_next <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>  <span class=\"token comment\"># 与下段同页</span>\np2<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>page_break_before <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>  <span class=\"token comment\"># 段前分页</span>\np2<span class=\"token punctuation\">.</span>paragraph_format<span class=\"token punctuation\">.</span>widow_control <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>  <span class=\"token comment\"># 孤行控制</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"11111.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>效果图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\003681bed167471ebb05be3e362c4abc.png\"/><br/> 代码解释：</p>\n<ul><li>段落对齐格式<code>WD_PARAGRAPH_ALIGNMENT</code>有多个可选项 \n  <ul><li><code>LEFT</code> 表示左对齐</li><li><code>CENTER</code> 表示居中对齐</li><li><code>RIGHT</code> 表示右对齐</li><li><code>JUSTIFY</code> 表示两端对齐</li><li><code>DISTRIBUTE</code> 表示散列对齐</li></ul> </li><li><code>add_paragraph()</code>对象可以设置<code>paragraph_format</code>的多种属性，包括： \n  <ul><li>对齐方式 <code>alignment</code></li><li>段落缩进 <code>right_indent</code> <code>left_indent</code> <code>first_line_indent</code></li><li>段落间距 <code>space_before</code> <code>space_after</code></li><li>行间距 <code>line_spacing</code></li><li>分页设置 <code>keep_together</code> <code>keep_with_next</code> <code>page_break_before</code> <code>widow_control</code></li></ul> </li><li>分页设置的属性说明： \n  <ul><li><code>keep_together</code> 段中不分页</li><li><code>keep_with_next</code> 与下段同页</li><li><code>page_break_before</code> 在段落前增加分页符</li><li><code>widow_control</code> 孤行控制，控制页面的孤行和孤立行</li></ul> </li></ul>\n<h1><a id=\"3_208\"></a>3、添加表格</h1>\n<h3><a id=\"1_209\"></a>举例1：获取单元格、获取行、获取列、新增行、新增列</h3>\n<p>上代码：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nt <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_table<span class=\"token punctuation\">(</span>rows<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> cols<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"Table Grid\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 通过行、列来确定单元格，索引从0开始</span>\ncell <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">\"第1行第1列\"</span>\n<span class=\"token comment\"># 获取第2行</span>\nrows <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> rows<span class=\"token punctuation\">.</span>cells<span class=\"token punctuation\">:</span>\n    cell<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"第2行第..列\"</span></span>\n<span class=\"token comment\"># 获取第3列</span>\ncols <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> cols<span class=\"token punctuation\">.</span>cells<span class=\"token punctuation\">:</span>\n    cell<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f\"第3列第..行\"</span></span>\n<span class=\"token comment\"># 增加行、增加列</span>\n<span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> t<span class=\"token punctuation\">.</span>add_row<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>cells<span class=\"token punctuation\">:</span>\n    cell<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">\"新增行\"</span>\nt<span class=\"token punctuation\">.</span>add_column<span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"ttt.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>效果图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\00f1c24bed0a437b8a7ef934a7c66007.png\"/></p>\n<p>代码解释：</p>\n<table><thead><tr><th>方法名</th><th align=\"left\">描述</th></tr></thead><tbody><tr><td><code>add_row()</code></td><td align=\"left\">新增1行</td></tr><tr><td><code>add_column(width)</code></td><td align=\"left\">新增1列，width列宽必须指定</td></tr><tr><td><code>add_table(rows, cols, style=None)</code></td><td align=\"left\">添加表格的方法，rows、cols为必填，style表示表格的样式，常用<code>Table Grid</code>，未赋值情况下表格为虚线，其他style样式如下：</td></tr></tbody></table>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cc98ca091e094cd091fe8ac1c1a672a1.png\"/></p>\n<ul><li>style可以为：可以查看此博文<a href=\"https://blog.csdn.net/qq_45464895/article/details/123173742\">https://blog.csdn.net/qq_45464895/article/details/123173742</a></li><li>两种方式可以获取单元格 \n  <ul><li>方式一：通过<code>t.cell(row, col)</code>获取具体的单元格，索引从0开始</li><li>方式二：通过<code>rows = t.rows[0]</code>或<code>columns = t.colums[0]</code>获取行或列，然后通过获取到的行<code>rows.cells[0]</code>或列<code>columns.cells[0]</code>获取具体的单元格</li></ul> </li><li>注意：设置单元格内容时，如果如果是int类型，需要转换成str：<code>cell.text = str(i)</code> i表示数字</li></ul>\n<h3><a id=\"2_250\"></a>举例2：首行设置背景色，合并单元格、表格文字居中</h3>\n<p>上代码：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>oxml<span class=\"token punctuation\">.</span>ns <span class=\"token keyword\">import</span> nsdecls\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>oxml <span class=\"token keyword\">import</span> parse_xml\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>enum<span class=\"token punctuation\">.</span>table <span class=\"token keyword\">import</span> WD_CELL_VERTICAL_ALIGNMENT\n\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nt <span class=\"token operator\">=</span> d<span class=\"token punctuation\">.</span>add_table<span class=\"token punctuation\">(</span>rows<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> cols<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> style<span class=\"token operator\">=</span><span class=\"token string\">\"Table Grid\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 首行设置背景色</span>\nrows <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> cell <span class=\"token keyword\">in</span> rows<span class=\"token punctuation\">.</span>cells<span class=\"token punctuation\">:</span>\n    shading_elm <span class=\"token operator\">=</span> parse_xml<span class=\"token punctuation\">(</span><span class=\"token string\">r'&lt;w:shd {} w:fill=\"D9D9D9\"/&gt;'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>nsdecls<span class=\"token punctuation\">(</span><span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cell<span class=\"token punctuation\">.</span>_tc<span class=\"token punctuation\">.</span>get_or_add_tcPr<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>shading_elm<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 合并单元格</span>\na <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\na<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">'111'</span>\nb <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nb<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> <span class=\"token string\">'222'</span>\nb<span class=\"token punctuation\">.</span>merge<span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 往合并单元格中写入</span>\ne <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nf <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\ne<span class=\"token punctuation\">.</span>merge<span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span>\ncell <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>paragraphs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> WD_PARAGRAPH_ALIGNMENT<span class=\"token punctuation\">.</span>CENTER  <span class=\"token comment\"># 水平居中</span>\ncell<span class=\"token punctuation\">.</span>paragraphs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>add_run<span class=\"token punctuation\">(</span><span class=\"token string\">\"合并单元格写入\"</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>vertical_alignment <span class=\"token operator\">=</span> WD_CELL_VERTICAL_ALIGNMENT<span class=\"token punctuation\">.</span>CENTER  <span class=\"token comment\"># 垂直居中</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"tttt.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>效果图：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8d50734b6c464da597e777db22e21f03.png\"/></p>\n<p>代码解释：</p>\n<ul><li>首行设置背景色：固定写法。<code>fill=\"D9D9D9\"</code>可以在<a href=\"http://tool.chinaz.com/Tools/PageColor.aspx\">http://tool.chinaz.com/Tools/PageColor.aspx</a>中找你需要的颜色进行替换</li><li>合并后的单元格写入，可以使用它所包含的所有单元格来定位，比如：合并<code>(3, 3)</code>和<code>(4, 4)</code>之间的单元格，那么可以通过<code>(3, 3)(3, 4)(4, 3)(4, 4)</code>定位这个合并后的单元格</li><li>单元格中设置居中方式：<code>WD_CELL_VERTICAL_ALIGNMENT</code>可以设置为如下几种： \n  <ul><li><code>TOP</code> 文本与单元格的上边框对齐</li><li><code>CENTER</code> 文本与单元格的中心对齐</li><li><code>BOTTOM</code> 文本与单元格的底部边框对齐</li></ul> <pre><code class=\"prism language-python\">cell <span class=\"token operator\">=</span> t<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>paragraphs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> WD_PARAGRAPH_ALIGNMENT<span class=\"token punctuation\">.</span>CENTER  <span class=\"token comment\"># 水平居中</span>\ncell<span class=\"token punctuation\">.</span>paragraphs<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>add_run<span class=\"token punctuation\">(</span><span class=\"token string\">\"合并单元格写入\"</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>vertical_alignment <span class=\"token operator\">=</span> WD_CELL_VERTICAL_ALIGNMENT<span class=\"token punctuation\">.</span>CENTER  <span class=\"token comment\"># 垂直居中</span>\n</code></pre> </li></ul>\n<h1><a id=\"4_297\"></a>4、添加图片</h1>\n<p>上代码：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> docx <span class=\"token keyword\">import</span> Document\n<span class=\"token keyword\">from</span> docx<span class=\"token punctuation\">.</span>shared <span class=\"token keyword\">import</span> Pt<span class=\"token punctuation\">,</span> Inches\nd <span class=\"token operator\">=</span> Document<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_picture<span class=\"token punctuation\">(</span><span class=\"token string\">\"test.png\"</span><span class=\"token punctuation\">,</span> Inches<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>add_picture<span class=\"token punctuation\">(</span><span class=\"token string\">\"test.png\"</span><span class=\"token punctuation\">,</span> Pt<span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nd<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"ppp.docx\"</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>代码解释：</p>\n<table><thead><tr><th>方法名</th><th align=\"left\">描述</th></tr></thead><tbody><tr><td><code>add_picture(image_path_or_stream, width=None, height=None)</code></td><td align=\"left\">添加图片函数，如果没有指定width和height，会将原图添加到文档中。有指定则会按比例缩放。</td></tr></tbody></table>\n<h1><a id=\"5_311\"></a>5、添加页眉页脚</h1>\n<p>暂时没用到，需要可以参考下面的文章</p>\n<hr/>\n<p>参考文章：</p>\n<ul><li><a href=\"https://blog.csdn.net/qq_45464895/article/details/123173742\">这个很全：https://blog.csdn.net/qq_45464895/article/details/123173742</a></li><li>https://blog.csdn.net/hihell/article/details/121966945</li><li>https://www.cnblogs.com/1gaoyu/p/12656003.html</li><li>https://www.5axxw.com/wiki/content/kbhv5m</li><li>https://www.5axxw.com/wiki/topic/l8oj0b</li><li>https://www.5axxw.com/wiki/content/qa5cih</li><li>https://www.cnblogs.com/wangyueping/p/16018206.html</li><li>https://blog.csdn.net/weixin_47383889/article/details/119847787</li><li>https://blog.csdn.net/u012034742/article/details/106022019/</li><li>https://blog.csdn.net/qq_27017791/article/details/108897521</li><li>http://tool.chinaz.com/Tools/PageColor.aspx</li><li>https://www.zhihu.com/question/511536143/answer/2313422603</li></ul>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-04-21 09:10:28", "summary": "、安装我们使用来操作文档，首先是安装：然后放两个参考文档：官方手册：官方地址：使用步骤步骤导入模块步骤创建或读取一个文档对象步骤向文档写入内容步骤生成文件上代码：步骤步骤新建文档对象读取现有文档，建立"}