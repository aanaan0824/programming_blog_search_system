{"blogid": "123984601", "writerAge": "码龄4年", "writerBlogNum": "39", "writerCollect": "175", "writerComment": "46", "writerFan": "6446", "writerGrade": "3级", "writerIntegral": "535", "writerName": "lfwh", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123984601.jpg", "writerRankTotal": "30806", "writerRankWeekly": "1258", "writerThumb": "95", "writerVisitNum": "137322", "blog_read_count": "10753", "blog_time": "已于 2022-06-02 16:37:35 修改", "blog_title": "CentOS7安装MySQL8（超级详细-无坑）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_4\">前言</a></li><li><a href=\"#MariaDB_16\">一、卸载MariaDB</a></li><li><ul><li><a href=\"#11__22\">1.1 查看版本：</a></li><li><a href=\"#12__26\">1.2 卸载</a></li><li><a href=\"#13__30\">1.3 检查是否卸载干净：</a></li></ul>\n</li><li><a href=\"#MySQL_35\">二、安装MySQL</a></li><li><ul><li><a href=\"#21__36\">2.1 下载资源包</a></li><li><ul><li><a href=\"#211__37\">2.1.1 官网下载</a></li><li><a href=\"#212_wget_44\">2.1.2 wget下载</a></li></ul>\n</li><li><a href=\"#22__49\">2.2 解压</a></li><li><a href=\"#23__54\">2.3 重命名</a></li><li><a href=\"#24_PATH_62\">2.4 添加PATH变量</a></li></ul>\n</li><li><a href=\"#_71\">三、用户和用户组</a></li><li><ul><li><a href=\"#31__72\">3.1 创建用户组和用户</a></li><li><a href=\"#32__83\">3.2 数据目录</a></li></ul>\n</li><li><a href=\"#MySQL_95\">四、初始化MySQL</a></li><li><ul><li><a href=\"#41__96\">4.1 配置参数</a></li><li><a href=\"#42__174\">4.2 初始化</a></li></ul>\n</li><li><a href=\"#MySQL_184\">五、启动MySQL</a></li><li><ul><li><a href=\"#51__187\">5.1 启动服务</a></li><li><a href=\"#52__199\">5.2 登录</a></li><li><a href=\"#53__208\">5.3 修改密码</a></li><li><a href=\"#54__216\">5.4 设置允许远程登录</a></li><li><a href=\"#55_Navicat_224\">5.5 在Navicat上测试连接</a></li></ul>\n</li><li><a href=\"#_228\">总结</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<h1><a id=\"_4\"></a>前言</h1>\n<ul><li><strong><a href=\"https://blog.csdn.net/weixin_42326851/article/details/124213228\">MySQL查看表占用空间大小</a></strong></li><li><strong><a href=\"https://blog.csdn.net/weixin_42326851/article/details/124209898\">CentOS7 环境下MySQL常用命令</a></strong></li><li><strong><a href=\"https://blog.csdn.net/weixin_42326851/article/details/124993822?spm=1001.2014.3001.5501\">MySQL: 范围查询优化</a></strong></li></ul>\n<p><strong>环境介绍 :</strong><br/> <strong>服务器：</strong> 阿里云轻量应用服务器<br/> <strong>系统版本：</strong> CentOS 7<br/> <strong>MySQL版本：</strong> 8.0</p>\n<hr/>\n<h1><a id=\"MariaDB_16\"></a>一、卸载MariaDB</h1>\n<blockquote>\n<p><strong>在CentOS中默认安装有MariaDB，是MySQL的一个分支，主要由开源社区维护。<br/> CentOS 7及以上版本已经不再使用MySQL数据库，而是使用MariaDB数据库。<br/> 如果直接安装MySQL，会和MariaDB的文件冲突。<br/> 因此，需要<code>先卸载自带的MariaDB，再安装MySQL。</code></strong></p>\n</blockquote>\n<h2><a id=\"11__22\"></a>1.1 查看版本：</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb\n</code></pre>\n<h2><a id=\"12__26\"></a>1.2 卸载</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -e --nodeps 文件名\n</code></pre>\n<h2><a id=\"13__30\"></a>1.3 检查是否卸载干净：</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mariadb\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d86f3bf8ebbf4ed5826f49f00460290b.png\"/></p>\n<h1><a id=\"MySQL_35\"></a>二、安装MySQL</h1>\n<h2><a id=\"21__36\"></a>2.1 下载资源包</h2>\n<h3><a id=\"211__37\"></a>2.1.1 官网下载</h3>\n<p><strong>MySQL官网下载地址 :</strong></p>\n<pre><code class=\"prism language-html\">https://dev.mysql.com/downloads/mysql/\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\19b0ecbd2ffe4a33b8838a0c26ecd172.png\"/></p>\n<h3><a id=\"212_wget_44\"></a>2.1.2 wget下载</h3>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">wget</span> https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.20-linux-glibc2.12-x86_64.tar.xz\n</code></pre>\n<h2><a id=\"22__49\"></a>2.2 解压</h2>\n<pre><code class=\"prism language-shell\">.tar.gz后缀：tar -zxvf 文件名\n.tar.xz后缀：tar -Jxvf 文件名\n</code></pre>\n<h2><a id=\"23__54\"></a>2.3 重命名</h2>\n<p>将解压后的文件夹重命名（或者为文件夹创建软链接）</p>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 重命名</span>\n<span class=\"token function\">mv</span> 原文件夹名 mysql8\n<span class=\"token comment\"># 软链接</span>\n<span class=\"token function\">ln</span> -s 文件夹名 mysql8\n</code></pre>\n<h2><a id=\"24_PATH_62\"></a>2.4 添加PATH变量</h2>\n<p>添加PATH变量后，可在全局使用MySQL。</p>\n<ul><li><strong>有两种添加方式：export命令临时生效、修改配置文件用久生效；</strong></li></ul>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\">#临时环境变量，关闭shell后失效，通常用于测试环境</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span>:/data/software/mysql8/bin\n</code></pre>\n<h1><a id=\"_71\"></a>三、用户和用户组</h1>\n<h2><a id=\"31__72\"></a>3.1 创建用户组和用户</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 创建一个用户组：mysql</span>\n<span class=\"token function\">groupadd</span> mysql\n<span class=\"token comment\"># 创建一个系统用户：mysql，指定用户组为mysql</span>\n<span class=\"token function\">useradd</span> -r -g mysql mysql\n</code></pre>\n<ul><li><strong>创建用户组：</strong><code>groupadd</code></li><li><strong>创建用户：</strong><code>useradd</code><br/> <code>-r</code><strong>：创建系统用户</strong><br/> <code>-g</code><strong>：指定用户组</strong></li></ul>\n<h2><a id=\"32__83\"></a>3.2 数据目录</h2>\n<p><strong>1、创建目录</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">mkdir</span> -p /data/software/mysql8/datas\n</code></pre>\n<p><strong>2、赋予权限</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 更改属主和数组</span>\n<span class=\"token function\">chown</span> -R mysql:mysql /data/software/mysql8/datas\n<span class=\"token comment\"># 更改模式</span>\n<span class=\"token function\">chmod</span> -R <span class=\"token number\">750</span> /data/software/mysql8/datas\n</code></pre>\n<h1><a id=\"MySQL_95\"></a>四、初始化MySQL</h1>\n<h2><a id=\"41__96\"></a>4.1 配置参数</h2>\n<blockquote>\n<p>在<code>/data/software/mysql8/</code>下，创建<code>my.cnf</code>配置文件，用于<strong>初始化MySQL数据库</strong></p>\n</blockquote>\n<pre><code class=\"prism language-shell\"><span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 默认字符集</span>\ndefault-character-set<span class=\"token operator\">=</span>utf8mb4\n<span class=\"token punctuation\">[</span>client<span class=\"token punctuation\">]</span>\nport       <span class=\"token operator\">=</span> <span class=\"token number\">3306</span>\nsocket     <span class=\"token operator\">=</span> /tmp/mysql.sock\n\n<span class=\"token punctuation\">[</span>mysqld<span class=\"token punctuation\">]</span>\nport       <span class=\"token operator\">=</span> <span class=\"token number\">3306</span>\nserver-id  <span class=\"token operator\">=</span> <span class=\"token number\">3306</span>\nuser       <span class=\"token operator\">=</span> mysql\nsocket     <span class=\"token operator\">=</span> /tmp/mysql.sock\n<span class=\"token comment\"># 安装目录</span>\nbasedir    <span class=\"token operator\">=</span> /data/software/mysql8\n<span class=\"token comment\"># 数据存放目录</span>\ndatadir    <span class=\"token operator\">=</span> /data/software/mysql8/datas/mysql\nlog-bin    <span class=\"token operator\">=</span> /data/software/mysql8/datas/mysql/mysql-bin\ninnodb_data_home_dir      <span class=\"token operator\">=</span>/data/software/mysql8/datas/mysql\ninnodb_log_group_home_dir <span class=\"token operator\">=</span>/data/software/mysql8/datas/mysql\n<span class=\"token comment\">#日志及进程数据的存放目录</span>\nlog-error <span class=\"token operator\">=</span>/data/software/mysql8/datas/mysql/mysql.log\npid-file  <span class=\"token operator\">=</span>/data/software/mysql8/datas/mysql/mysql.pid\n<span class=\"token comment\"># 服务端使用的字符集默认为8比特编码</span>\ncharacter-set-server<span class=\"token operator\">=</span>utf8mb4\n<span class=\"token assign-left variable\">lower_case_table_names</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\nautocommit <span class=\"token operator\">=</span><span class=\"token number\">1</span>\n \n <span class=\"token comment\">##################以上要修改的########################</span>\nskip-external-locking\nkey_buffer_size <span class=\"token operator\">=</span> 256M\nmax_allowed_packet <span class=\"token operator\">=</span> 1M\ntable_open_cache <span class=\"token operator\">=</span> <span class=\"token number\">1024</span>\nsort_buffer_size <span class=\"token operator\">=</span> 4M\nnet_buffer_length <span class=\"token operator\">=</span> 8K\nread_buffer_size <span class=\"token operator\">=</span> 4M\nread_rnd_buffer_size <span class=\"token operator\">=</span> 512K\nmyisam_sort_buffer_size <span class=\"token operator\">=</span> 64M\nthread_cache_size <span class=\"token operator\">=</span> <span class=\"token number\">128</span>\n  \n<span class=\"token comment\">#query_cache_size = 128M</span>\ntmp_table_size <span class=\"token operator\">=</span> 128M\nexplicit_defaults_for_timestamp <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\nmax_connections <span class=\"token operator\">=</span> <span class=\"token number\">500</span>\nmax_connect_errors <span class=\"token operator\">=</span> <span class=\"token number\">100</span>\nopen_files_limit <span class=\"token operator\">=</span> <span class=\"token number\">65535</span>\n   \n<span class=\"token assign-left variable\">binlog_format</span><span class=\"token operator\">=</span>mixed\n    \nbinlog_expire_logs_seconds <span class=\"token operator\">=</span><span class=\"token number\">864000</span>\n    \n<span class=\"token comment\"># 创建新表时将使用的默认存储引擎</span>\ndefault_storage_engine <span class=\"token operator\">=</span> InnoDB\ninnodb_data_file_path <span class=\"token operator\">=</span> ibdata1:10M:autoextend\ninnodb_buffer_pool_size <span class=\"token operator\">=</span> 1024M\ninnodb_log_file_size <span class=\"token operator\">=</span> 256M\ninnodb_log_buffer_size <span class=\"token operator\">=</span> 8M\ninnodb_flush_log_at_trx_commit <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\ninnodb_lock_wait_timeout <span class=\"token operator\">=</span> <span class=\"token number\">50</span>\ntransaction-isolation<span class=\"token operator\">=</span>READ-COMMITTED\n      \n<span class=\"token punctuation\">[</span>mysqldump<span class=\"token punctuation\">]</span>\nquick\nmax_allowed_packet <span class=\"token operator\">=</span> 16M\n       \n<span class=\"token punctuation\">[</span>myisamchk<span class=\"token punctuation\">]</span>\nkey_buffer_size <span class=\"token operator\">=</span> 256M\nsort_buffer_size <span class=\"token operator\">=</span> 4M\nread_buffer <span class=\"token operator\">=</span> 2M\nwrite_buffer <span class=\"token operator\">=</span> 2M\n        \n<span class=\"token punctuation\">[</span>mysqlhotcopy<span class=\"token punctuation\">]</span>\ninteractive-timeout\n</code></pre>\n<h2><a id=\"42__174\"></a>4.2 初始化</h2>\n<pre><code class=\"prism language-shell\">mysqld --defaults-file<span class=\"token operator\">=</span>/data/software/mysql8/my.cnf --basedir<span class=\"token operator\">=</span>/data/software/mysql8/ --datadir<span class=\"token operator\">=</span>/data/software/mysql8/datas/mysql --user<span class=\"token operator\">=</span>mysql --initialize-insecure\n</code></pre>\n<p><strong>参数（重要）</strong></p>\n<ul><li><code>defaults-file</code>：指定配置文件（要放在–initialize 前面）</li><li><code>user</code>： 指定用户</li><li><code>basedir</code>：指定安装目录</li><li><code>datadir</code>：指定初始化数据目录</li><li><code>intialize-insecure</code>：初始化无密码</li></ul>\n<h1><a id=\"MySQL_184\"></a>五、启动MySQL</h1>\n<p>查看 MySQL的 bin路径下，是否包含<code>mysqld_safe</code>，用于后台安全启动MySQL。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\edd866433afb462087d105a10fad2811.png\"/></p>\n<h2><a id=\"51__187\"></a>5.1 启动服务</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 完整命令</span>\n/data/software/mysql8/bin/mysqld_safe --defaults-file<span class=\"token operator\">=</span>/data/software/mysql8/my.cnf <span class=\"token operator\">&amp;</span>\n<span class=\"token comment\"># 添加PATH变量后的命令（省略bin目录的路径）</span>\nmysqld_safe --defaults-file<span class=\"token operator\">=</span>/data/software/mysql/my.cnf <span class=\"token operator\">&amp;</span>\n</code></pre>\n<p><strong>查看是否启动</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">ps</span> -ef<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mysql\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b652504a24f1487abd0b82348988995a.png\"/></p>\n<h2><a id=\"52__199\"></a>5.2 登录</h2>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 无密码登录方式</span>\n/data/software/mysql8/bin/mysql -u root --skip-password\n<span class=\"token comment\"># 有密码登录方式（初始的随机密码在/data/mysql8_data/mysql/mysql.log下）</span>\nmysql -u root -p\npassword:随机密码\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0834429f9640415dbfc963036e51fd0e.png\"/></p>\n<h2><a id=\"53__208\"></a>5.3 修改密码</h2>\n<pre><code class=\"prism language-shll\"># 修改密码\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';\n# 刷新权限\nFLUSH PRIVILEGES;\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3a979a1e03e64111aa2722b3df4e297c.png\"/></p>\n<h2><a id=\"54__216\"></a>5.4 设置允许远程登录</h2>\n<p><strong>登录到mysql里执行</strong></p>\n<pre><code class=\"prism language-shell\">mysql<span class=\"token operator\">&gt;</span> use mysql\nmysql<span class=\"token operator\">&gt;</span> update user <span class=\"token builtin class-name\">set</span> user.Host<span class=\"token operator\">=</span><span class=\"token string\">'%'</span>where user.User<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">;</span>\nmysql<span class=\"token operator\">&gt;</span> flush privileges<span class=\"token punctuation\">;</span>\nmysql<span class=\"token operator\">&gt;</span> quit\n</code></pre>\n<h2><a id=\"55_Navicat_224\"></a>5.5 在Navicat上测试连接</h2>\n<p><img alt=\"连接成功\" src=\"..\\..\\static\\image\\893a021fa2b348a8a66d6c36f3042c25.png\"/></p>\n<hr/>\n<h1><a id=\"_228\"></a>总结</h1>\n<blockquote>\n<p>如果此篇文章有帮助到您, 希望打大佬们能<code>关注、点赞、收藏、评论</code>支持一波，非常感谢大家！<br/> 如果有不对的地方请指正!!!<br/> <a href=\"https://www.cnblogs.com/secretmrj/p/15600144.html\"></a></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-06-02 16:37:35", "summary": "文章目录前言一、卸载查看版本：卸载检查是否卸载干净：二、安装下载资源包官网下载下载解压重命名添加变量三、用户和用户组创建用户组和用户数据目录四、初始化配置参数初始化五、启动启动服务登录修改密码设置允许"}