{"blogid": "126074607", "writerAge": "码龄7年", "writerBlogNum": "68", "writerCollect": "194", "writerComment": "89", "writerFan": "2108", "writerGrade": "5级", "writerIntegral": "4182", "writerName": "hyh123a", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126074607.jpg", "writerRankTotal": "4608", "writerRankWeekly": "4542", "writerThumb": "77", "writerVisitNum": "1030397", "blog_read_count": "5244", "blog_time": "已于 2022-07-31 07:37:37 修改", "blog_title": "Python 微信自动化工具开发系列01_自动获取微信聊天信息（2022年7月可用）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-github-gist\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"_1\"></a>前言</h1>\n<pre><code>一个需求\n\n需要利用Python+第三方库wxauto 用于微信上自动获取聊天信息，从而根据自己需求对信息自动进行二次处理，\n比如自动回复，再比如自动发送文件或者其他。\n这边使用Python的第三方库`wxauto`来进行开发，而不是`itchat`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--- 记录于2022年07月\n</code></pre>\n<p>使用Python3的第三方库<code>wxauto</code>, 它适用于Windows的微信客户端</p>\n<blockquote>\n<p>官网: https://github.com/cluic/wxauto</p>\n</blockquote>\n<h1><a id=\"_20\"></a>原因</h1>\n<blockquote>\n<p>这边使用<code>wxauto</code>来进行开发，而不是<code>itchat</code>，原因如下</p>\n</blockquote>\n<p><code>itchat</code>都是之前的教程，<br/> 本质上是用的微信的网页端的接口来进行数据交互的。</p>\n<p>如果你想要使用<code>itchat</code>的代码的话，</p>\n<ul><li>1、先测试下你的账号是否还可以登录微信网页端</li></ul>\n<blockquote>\n<p>https://wx.qq.com/<br/> 腾讯官方虽然没有正式的发表声明，但是你搜一下可以看到相关信息<br/> 大概从去年开始（时间不太确定），大部分微信账号都不可以继续登录微信网页端，只有少部分账号还可以登录。<br/> 原因未知。</p>\n</blockquote>\n<ul><li>2、如果可以登录微信网页版 那么你可以关闭这个博客去网上找下<code>itchat</code>的代码来学习运行下，</li></ul>\n<p>如果登录失败，那么或许你可以尝试下<code>wxauto</code>也就是这里所说的方法来运行下。</p>\n<hr/>\n<h1><a id=\"_49\"></a>环境</h1>\n<pre><code>Windows 10\nPython 3.8.10\nWindows 10的微信客户端版本：3.7.5.23 (英文版本)\n</code></pre>\n<blockquote>\n<p>注：微信客户端中文版跟英文版都可以<br/> 没什么太大区别。</p>\n</blockquote>\n<h1><a id=\"_61\"></a>安装</h1>\n<blockquote>\n<p>安装Python3的第三方库<code>wxauto</code>，具体步骤如下</p>\n</blockquote>\n<blockquote>\n<p>官网: https://github.com/cluic/wxauto</p>\n</blockquote>\n<blockquote>\n<p>在cmd窗口执行下面命令进行安装</p>\n</blockquote>\n<ul><li>安装第三方库<code>wxauto</code></li></ul>\n<pre><code>python3 --version\npython3 -m pip install wxauto -i https://pypi.tuna.tsinghua.edu.cn/simple \n</code></pre>\n<ul><li>查看<code>wxauto</code>是否安装成功</li></ul>\n<pre><code>python3 -c \"import wxauto; print(wxauto.VERSION)\"\n</code></pre>\n<h1><a id=\"_84\"></a>使用步骤</h1>\n<h2><a id=\"1_mainpy_86\"></a>1. 新建main.py</h2>\n<blockquote>\n<p>这边第一篇只介绍获取默认窗口的聊天信息</p>\n</blockquote>\n<pre><code>from wxauto import *\n\n# 获取当前微信客户端\nwx = WeChat()\n\n# 获取会话列表\nwx.GetSessionList()\n\n\n###############################\n# 1、获取默认窗口聊天信息\n###############################\ndef get_default_window_messages():\n    # 默认是微信窗口当前选中的窗口\n    # 输出当前聊天窗口聊天消息\n    msgs = wx.GetAllMessage\n    for msg in msgs:\n        print('%s : %s' % (msg[0], msg[1]))\n\n    # 获取更多聊天记录\n    wx.LoadMoreMessage()\n    msgs = wx.GetAllMessage\n    for msg in msgs:\n        print('%s : %s' % (msg[0], msg[1]))\n\n\nif __name__ == '__main__':\n    get_default_window_messages()\n\n</code></pre>\n<h2><a id=\"2__124\"></a>2. 打开微信</h2>\n<ul><li>windows10下打开微信客户端</li><li>正常扫码登录</li><li>打开微信窗口到前面，不要最小化或者缩小到底部菜单</li></ul>\n<h2><a id=\"3__132\"></a>3. 执行代码</h2>\n<blockquote>\n<p>打开cmd窗口，在cmd窗口执行:</p>\n<p>如果没有安装第三方库，参考上面的<code>安装</code>步骤进行安装再执行下面命令</p>\n</blockquote>\n<pre><code>cd 你的main.py所在路径\npython3 main.py\n</code></pre>\n<h2><a id=\"4__145\"></a>4. 输出</h2>\n<pre><code>cmd窗口正常输出你默认微信窗口的聊天信息\n</code></pre>\n<hr/>\n<h1><a id=\"_155\"></a>后续</h1>\n<blockquote>\n<p>这边刚开始写一下系列文章，想发展下自己的博客和微信公众号账号</p>\n<p>如果对你有帮助，方便的话可以关注下 博客左侧的微信公众号（点击我的头像进入个人中心，位于左侧下方）</p>\n<p>如有问题的话，也可通过公众号直接留言，这边有微信提醒，可以几小时内及时回复</p>\n<p>也可直接在CSDN博客留言或者私信留言，这个没有微信提醒，所以这边可能一天或者几天内给回复</p>\n</blockquote>\n<blockquote>\n<p>微信公众号所在位置：打开<code>个人中心</code>也就是这个链接<br/> https://blog.csdn.net/xiaozi_001?type=blog<br/> 左侧下方</p>\n</blockquote>\n<blockquote>\n<p>如有需求，</p>\n<p>想要对微信进行一些自动化操作来提高效率：</p>\n<p>比如</p>\n<ul><li> <p>自动群发不同聊天信息到几个微信群里</p> </li><li> <p>自动群发不同的图片到几个微信群里</p> </li><li> <p>自动群发不同的文件到几个微信群里</p> </li></ul>\n</blockquote>\n<hr/>\n<ul><li>如果你本身懂代码的话</li></ul>\n<blockquote>\n<p>如果你本身懂代码的话, 直接看第三方库<code>wxauto</code>的使用，自己来写就可以了，</p>\n<p>博客后续也会基于这个系列继续更新。</p>\n<p>欢迎点赞留言提出问题，方便的话 点赞收藏 关注下微信公众号</p>\n</blockquote>\n<ul><li>如果你本身不懂代码</li></ul>\n<blockquote>\n<p>只是想要一个简单的微信处理工具来满足自己的需求的话</p>\n<p>可以微信公众号留言或者私信留言，</p>\n<p>发下你的具体需求，这边后续根据你的需求进行下二次开发</p>\n<hr/>\n<p>费用大概100RMB~500RMB不等，根据你的需求复杂度和开发耗时来确定</p>\n<p>简单的功能，比如上面提到的，一般100RMB就可以了</p>\n<p>复杂的需求，将根据你的需求复杂度和开发耗时来确定</p>\n<hr/>\n<p>一般这边满足需求，开发完毕并且给用户确认之后再付款</p>\n</blockquote>\n<blockquote>\n<p>微信公众号所在位置：打开<code>个人中心</code>也就是这个链接<br/> https://blog.csdn.net/xiaozi_001?type=blog<br/> 左侧下方</p>\n</blockquote>\n<blockquote>\n<p>如有需求，可关注下微信公众号留言或者直接私信留言</p>\n<p>前者可以几小时内及时回复</p>\n<p>后者可能看的不及时，大概一天或者几天内有回复</p>\n</blockquote>\n<hr/>\n<blockquote>\n<p>注：刚开始想业余时间做点订单，顺便想下自己接下来的职业规划</p>\n<p>可兼职部分开发需求的订单，微信自动化，QQ自动化，静态官网开发等都可以</p>\n<p>后续会发系列教程 如有需求欢迎沟通</p>\n</blockquote>\n<h1><a id=\"_242\"></a>其他</h1>\n<blockquote>\n<p>如有问题 欢迎提出</p>\n</blockquote>\n<blockquote>\n<p>如有疑问 欢迎留言</p>\n</blockquote>\n<blockquote>\n<p>如有作用 欢迎点赞</p>\n</blockquote>\n<blockquote>\n<p>如有失效 欢迎留言</p>\n</blockquote>\n<blockquote>\n<p>2022年07月 可用</p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-07-31 07:37:37", "summary": "前言一个需求需要利用第三方库用于微信上自动获取聊天信息，从而根据自己需求对信息自动进行二次处理，比如自动回复，再比如自动发送文件或者其他。这边使用的第三方库来进行开发，而不是记录于年月使用的第三方库它"}