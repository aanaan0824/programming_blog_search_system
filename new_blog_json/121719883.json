{"blogid": "121719883", "writerAge": "码龄3年", "writerBlogNum": "15", "writerCollect": "1307", "writerComment": "72", "writerFan": "632", "writerGrade": "3级", "writerIntegral": "507", "writerName": "出色的你csdw", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121719883.jpg", "writerRankTotal": "57592", "writerRankWeekly": "361735", "writerThumb": "289", "writerVisitNum": "159697", "blog_read_count": "77366", "blog_time": "已于 2022-04-23 22:14:07 修改", "blog_title": "头歌MySQL数据库实训答案 有目录", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>头歌MySQL数据库答案</h3>\n<ul><li><a href=\"#_2\">特别感谢黄副班、小青提供代码，有问题联系公众号【学思则安】留言更正</a></li><li><ul><li><a href=\"#_4\">其他作业链接</a></li></ul>\n</li><li><a href=\"#1MySQL_8\">数据库1-MySQL数据定义与操作实战</a></li><li><ul><li><a href=\"#MySQL__MySQL_9\">MySQL数据库 - 初识MySQL</a></li><li><ul><li><a href=\"#MySQL___125\">MySQL数据库 - 数据库和表的基本操作（一）</a></li><li><a href=\"#MySQL___219\">MySQL数据库 - 数据库和表的基本操作（二）</a></li><li><a href=\"#MySQL___285\">MySQL数据库 - 单表查询（一）</a></li><li><a href=\"#MySQL___333\">MySQL数据库 - 单表查询（二)</a></li><li><a href=\"#MySQL___379\">MySQL数据库 - 单表查询（三）</a></li><li><a href=\"#MySQL___420\">MySQL数据库 - 连接查询</a></li><li><a href=\"#MySQL___481\">MySQL数据库 - 子查询</a></li><li><a href=\"#MySQL___513\">MySQL数据库 - 复杂查询（一)</a></li><li><a href=\"#MySQL___582\">MySQL数据库 - 复杂查询（二）</a></li><li><a href=\"#MySQL___659\">MySQL数据库 - 使用聚合函数查询</a></li><li><a href=\"#MySQL___746\">MySQL数据库 - 其他函数的使用</a></li><li><a href=\"#MySQL___812\">MySQL数据库 - 分组选择数据</a></li></ul>\n</li><li><a href=\"#2MySQL_850\">数据库2-MySQL数据管理技术实战</a></li><li><ul><li><a href=\"#MySQL___851\">MySQL开发技巧 - 视图</a></li><li><a href=\"#MySQL___873\">MySQL开发技巧 - 索引</a></li><li><a href=\"#MySQL___899\">MySQL开发技巧 - 分页和索引</a></li><li><a href=\"#MySQL___950\">MySQL开发技巧 - 存储过程</a></li><li><a href=\"#MySQL___974\">MySQL开发技巧 - 事务</a></li><li><a href=\"#MySQL___1003\">MySQL开发技巧 - 并发控制</a></li><li><a href=\"#MySQL___1060\">MySQL开发技巧 - 行列转换</a></li><li><a href=\"#MySQL___1121\">MySQL开发技巧 - 删除重复数据</a></li><li><a href=\"#MySQL___1159\">MySQL开发技巧 - 批量数据入库及检索</a></li></ul>\n</li><li><a href=\"#3MySQL_1294\">数据库3-MySQL数据库系统设计实战</a></li><li><ul><li><a href=\"#MySQL___1295\">MySQL开发技巧 - 查询、索引和完整性</a></li><li><a href=\"#___1414\">数据库查询 - 选课系统</a></li><li><a href=\"#___1509\">数据库设计 - 博客系统</a></li><li><a href=\"#__JDBC__1667\">数据库开发基础案例 - JDBC 技术应用</a></li><li><a href=\"#__PythonWeb_2237\">数据库开发中级案例 - PythonWeb框架应用</a></li><li><a href=\"#_ORM_2423\">数据库开发中级案例 -ORM框架应用</a></li><li><a href=\"#___2531\">数据库开发综合案例 - 仓库管理系统设计</a></li><li><a href=\"#___2629\">数据库开发综合案例 - 图书管理系统设计</a></li></ul>\n</li><li><a href=\"#4_2697\">数据库4-层次、网状、关系模型实战</a></li><li><ul><li><a href=\"#_2698\">数据模型</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"_2\"></a>特别感谢黄副班、小青提供代码，有问题联系公众号【学思则安】留言更正</h1>\n<h2><a id=\"_4\"></a>其他作业链接</h2>\n<p><a href=\"https://blog.csdn.net/weixin_46263778/article/details/121746577?spm=1001.2014.3001.5501\">头歌java实训答案集</a></p>\n<h1><a id=\"1MySQL_8\"></a>数据库1-MySQL数据定义与操作实战</h1>\n<h2><a id=\"MySQL__MySQL_9\"></a>MySQL数据库 - 初识MySQL</h2>\n<p>数据库部分一条一条的写，可鼠标手动粘贴，除特定命令外未分大小写。<br/> 第1关：创建数据库</p>\n<pre><code class=\"prism language-c\">mysql <span class=\"token operator\">-</span>uroot <span class=\"token operator\">-</span>p123123 <span class=\"token operator\">-</span>h127<span class=\"token punctuation\">.</span><span class=\"token number\">0.0</span><span class=\"token number\">.1</span>\n</code></pre>\n<pre><code class=\"prism language-c\">create database MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第2关创建表</p>\n<pre><code class=\"prism language-bash\">mysql -uroot -p123123 -h127.0.0.1\n</code></pre>\n<pre><code class=\"prism language-c\">create database TestDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-c\">use TestDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-bash\">create table t_emp <span class=\"token punctuation\">(</span>id int,\nname varchar<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span>,\ndeptId int,\nsalary float<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第3关：使用主键约束</p>\n<pre><code class=\"prism language-bash\">mysql -uroot -p123123 -h127.0.0.1\n</code></pre>\n<pre><code class=\"prism language-bash\">create database MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-bash\">use MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-bash\">create table t_user1<span class=\"token punctuation\">(</span>\nuserId INT PRIMARY KEY,\nname VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span>,\npassword VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>,\nphone VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>,\nemail VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-bash\">create table t_user2<span class=\"token punctuation\">(</span>\nname VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span>,\nphone VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span>,\nemail VARCHAR<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span>,\nPRIMARY KEY<span class=\"token punctuation\">(</span>name,phone<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第4关：外键约束</p>\n<pre><code class=\"prism language-c\">mysql <span class=\"token operator\">-</span>uroot <span class=\"token operator\">-</span>p123123 <span class=\"token operator\">-</span>h127<span class=\"token punctuation\">.</span><span class=\"token number\">0.0</span><span class=\"token number\">.1</span>\n</code></pre>\n<pre><code class=\"prism language-c\">create database MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-c\">use MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-c\">\nCREATE TABLE <span class=\"token function\">t_class</span>\n<span class=\"token punctuation\">(</span>\n    id INT  PRIMARY KEY<span class=\"token punctuation\">,</span>\n    name <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<pre><code class=\"prism language-c\">CREATE TABLE <span class=\"token function\">t_student</span>\n<span class=\"token punctuation\">(</span>\n    id INT  PRIMARY KEY<span class=\"token punctuation\">,</span>\n    name <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>\n    classId <span class=\"token keyword\">int</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_stu_class1 FOREIGN <span class=\"token function\">KEY</span><span class=\"token punctuation\">(</span>classId<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_class</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第5关：添加常用约束</p>\n<pre><code class=\"prism language-c\">mysql <span class=\"token operator\">-</span>uroot <span class=\"token operator\">-</span>p123123 <span class=\"token operator\">-</span>h127<span class=\"token punctuation\">.</span><span class=\"token number\">0.0</span><span class=\"token number\">.1</span>\n</code></pre>\n<pre><code class=\"prism language-c\">CREATE DATABASE MyDb<span class=\"token punctuation\">;</span>\n\n</code></pre>\n<pre><code class=\"prism language-c\">USE MyDb<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-c\">CREATE TABLE <span class=\"token function\">t_user</span>\n<span class=\"token punctuation\">(</span>\n    id INT  PRIMARY KEY AUTO_INCREMENT<span class=\"token punctuation\">,</span>\n    username <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT <span class=\"token constant\">NULL</span> UNIQUE<span class=\"token punctuation\">,</span>\n    sex <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> DEFAULT <span class=\"token char\">'男'</span>\n<span class=\"token punctuation\">)</span>DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"MySQL___125\"></a>MySQL数据库 - 数据库和表的基本操作（一）</h3>\n<p>第1关：查看表结构与修改表名</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">modify</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">table</span> <span class=\"token hvariable\">name</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">RENAME</span> <span class=\"token hvariable\">jd_emp</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token builtin\">show</span> <span class=\"token hvariable\">tables</span> <span class=\"token keyword\">in</span> <span class=\"token hvariable\">this</span> <span class=\"token hvariable\">database</span> <span class=\"token operator\">##########</span>\n<span class=\"token builtin\">show</span> <span class=\"token hvariable\">tables</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">describe</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">table</span> <span class=\"token operator\">##########</span>\n<span class=\"token hvariable\">describe</span> <span class=\"token hvariable\">jd_emp</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n</code></pre>\n<p>第2关：修改字段名与字段数据类型</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">change</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">column</span> <span class=\"token hvariable\">name</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token hvariable\">change</span> <span class=\"token constant\">Id</span> <span class=\"token hvariable\">prod_id</span> <span class=\"token hvariable\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">change</span> <span class=\"token hvariable\">the</span> <span class=\"token keyword\">data</span> <span class=\"token keyword\">type</span> <span class=\"token keyword\">of</span> <span class=\"token hvariable\">column</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">MODIFY</span> <span class=\"token constant\">Name</span> <span class=\"token hvariable\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">DESCRIBE</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第3关：添加与删除字段</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">add</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">column</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">ADD</span> <span class=\"token constant\">Country</span> <span class=\"token hvariable\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">AFTER</span> <span class=\"token constant\">Name</span><span class=\"token punctuation\">;</span> \n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">delete</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">column</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">DROP</span> <span class=\"token constant\">Salary</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">DESCRIBE</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第4关：修改字段的排列位置</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">modify</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">column</span> <span class=\"token hvariable\">to</span> <span class=\"token hvariable\">top</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">MODIFY</span> <span class=\"token constant\">Name</span> <span class=\"token hvariable\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">FIRST</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">modify</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">column</span> <span class=\"token hvariable\">to</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">rear</span> <span class=\"token keyword\">of</span> <span class=\"token hvariable\">another</span> <span class=\"token hvariable\">column</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">MODIFY</span> <span class=\"token constant\">DeptId</span> <span class=\"token hvariable\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">AFTER</span> <span class=\"token constant\">Salary</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">DESCRIBE</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第5关：删除表的外键约束</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">delete</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">foreign</span> <span class=\"token hvariable\">key</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">ALTER</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">DROP</span> <span class=\"token constant\">FOREIGN</span> <span class=\"token constant\">KEY</span> <span class=\"token hvariable\">emp_dept</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">SHOW</span> <span class=\"token constant\">CREATE</span> <span class=\"token constant\">TABLE</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token operator\">\\</span><span class=\"token constant\">G</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"MySQL___219\"></a>MySQL数据库 - 数据库和表的基本操作（二）</h3>\n<p>第1关：插入数据</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">bundle</span> <span class=\"token hvariable\">insert</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">value</span> <span class=\"token operator\">#########</span>\n<span class=\"token constant\">INSERT</span> <span class=\"token constant\">INTO</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">(</span><span class=\"token constant\">Id</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Name</span><span class=\"token punctuation\">,</span><span class=\"token constant\">DeptId</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Salary</span><span class=\"token punctuation\">)</span> \n<span class=\"token constant\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Nancy\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">301</span><span class=\"token punctuation\">,</span><span class=\"token number\">2300.00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Tod\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">303</span><span class=\"token punctuation\">,</span><span class=\"token number\">5600.00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Carly\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">301</span><span class=\"token punctuation\">,</span><span class=\"token number\">3200.00</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n</code></pre>\n<p>第2关：更新数据</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">update</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">value</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">UPDATE</span> <span class=\"token hvariable\">tb_emp</span>\n<span class=\"token constant\">SET</span> <span class=\"token constant\">Name</span><span class=\"token operator\">=</span><span class=\"token string\">\"Tracy\"</span><span class=\"token punctuation\">,</span><span class=\"token constant\">DeptId</span><span class=\"token operator\">=</span><span class=\"token number\">302</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Salary</span><span class=\"token operator\">=</span><span class=\"token number\">4300.00</span>\n<span class=\"token constant\">WHERE</span> <span class=\"token builtin\">id</span><span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">DESCRIBE</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第3关：删除数据</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">delete</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">value</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">DELETE</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span>\n<span class=\"token constant\">WHERE</span> <span class=\"token constant\">Salary</span><span class=\"token operator\">&gt;</span><span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token constant\">DESCRIBE</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"MySQL___285\"></a>MySQL数据库 - 单表查询（一）</h3>\n<p>第1关：基本查询语句</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">retrieving</span> <span class=\"token hvariable\">the</span> <span class=\"token constant\">Name</span> <span class=\"token builtin\">and</span> <span class=\"token constant\">Salary</span> <span class=\"token operator\">##########</span>\n<span class=\"token hvariable\">select</span> <span class=\"token constant\">Name</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Salary</span> <span class=\"token hvariable\">from</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">retrieving</span> <span class=\"token builtin\">all</span> <span class=\"token hvariable\">the</span> <span class=\"token hvariable\">table</span> <span class=\"token operator\">##########</span>\n<span class=\"token hvariable\">select</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">from</span> <span class=\"token hvariable\">tb_emp</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n</code></pre>\n<p>第2关：带 IN 关键字的查询</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">retrieving</span> <span class=\"token hvariable\">the</span> <span class=\"token constant\">Name</span> <span class=\"token builtin\">and</span> <span class=\"token constant\">Salary</span> <span class=\"token hvariable\">with</span> <span class=\"token constant\">IN</span> <span class=\"token hvariable\">statement</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">SELECT</span> <span class=\"token constant\">Name</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Salary</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span> <span class=\"token constant\">WHERE</span> <span class=\"token constant\">Id</span> <span class=\"token constant\">NOT</span> <span class=\"token constant\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n</code></pre>\n<p>第3关：带 BETWEEN AND 的范围查询</p>\n<pre><code class=\"prism language-haskell\"><span class=\"token constant\">USE</span> <span class=\"token constant\">Company</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">##########</span> <span class=\"token constant\">Begin</span> <span class=\"token operator\">##########</span>\n\n<span class=\"token operator\">##########</span> <span class=\"token hvariable\">retrieving</span> <span class=\"token hvariable\">the</span> <span class=\"token constant\">Name</span> <span class=\"token builtin\">and</span> <span class=\"token constant\">Salary</span> <span class=\"token hvariable\">with</span> <span class=\"token constant\">BETWEEN</span> <span class=\"token constant\">AND</span> <span class=\"token hvariable\">statement</span> <span class=\"token operator\">##########</span>\n<span class=\"token constant\">SELECT</span> <span class=\"token constant\">Name</span><span class=\"token punctuation\">,</span><span class=\"token constant\">Salary</span> <span class=\"token constant\">FROM</span> <span class=\"token hvariable\">tb_emp</span> \n<span class=\"token constant\">WHERE</span> <span class=\"token constant\">Salary</span> <span class=\"token constant\">BETWEEN</span> <span class=\"token number\">3000</span> <span class=\"token constant\">AND</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">##########</span> <span class=\"token constant\">End</span> <span class=\"token operator\">##########</span>\n\n</code></pre>\n<h3><a id=\"MySQL___333\"></a>MySQL数据库 - 单表查询（二)</h3>\n<p>第1关：带 LIKE 的字符匹配查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> Company<span class=\"token punctuation\">;</span>\n\n######### Begin #########\n<span class=\"token constant\">SELECT</span> Name<span class=\"token punctuation\">,</span>Salary <span class=\"token constant\">FROM</span> tb_emp <span class=\"token constant\">WHERE</span> Name <span class=\"token constant\">LIKE</span> <span class=\"token string\">\"C%\"</span><span class=\"token punctuation\">;</span>\n\n######### End #########\n\n\n</code></pre>\n<p>第2关：查询空值与去除重复结果</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> Company<span class=\"token punctuation\">;</span>\n\n######### Begin #########\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> tb_emp <span class=\"token constant\">WHERE</span> DeptId <span class=\"token constant\">IS</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">;</span>\n\n######### End #########\n\n######### Begin #########\n<span class=\"token constant\">SELECT</span> <span class=\"token constant\">DISTINCT</span> Name <span class=\"token constant\">FROM</span> tb_emp<span class=\"token punctuation\">;</span>\n\n######### End #########\n\n\n</code></pre>\n<p>第3关：带 AND 与 OR 的多条件查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> Company<span class=\"token punctuation\">;</span>\n\n######### Begin #########\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> tb_emp <span class=\"token constant\">WHERE</span> DeptId<span class=\"token operator\">=</span><span class=\"token number\">301</span> <span class=\"token constant\">AND</span> Salary <span class=\"token operator\">&gt;</span> <span class=\"token number\">3000</span><span class=\"token punctuation\">;</span>\n\n######### End #########\n\n######### Begin #########\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> tb_emp <span class=\"token constant\">WHERE</span> DeptId<span class=\"token operator\">=</span><span class=\"token number\">301</span> <span class=\"token constant\">OR</span> DeptId<span class=\"token operator\">=</span><span class=\"token number\">303</span><span class=\"token punctuation\">;</span>\n\n######### End #########\n</code></pre>\n<h3><a id=\"MySQL___379\"></a>MySQL数据库 - 单表查询（三）</h3>\n<p>第1关：对查询结果进行排序</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n#请在此处添加实现代码\n########## Begin ##########\n\n########## 查询<span class=\"token number\">1</span>班同学的所有信息以成绩降序的方式显示结果 ##########\nselect <span class=\"token operator\">*</span> from tb_score where class_id <span class=\"token operator\">=</span> <span class=\"token number\">1</span> order by score desc<span class=\"token punctuation\">;</span>\n\n########## End ##########\n\n\n</code></pre>\n<p>第2关：分组查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n#请在此处添加实现代码\n########## Begin ##########\n\n########## 对班级名称进行分组查询 ##########\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> tb_class <span class=\"token constant\">GROUP</span> <span class=\"token constant\">BY</span> class_id<span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<p>第3关：使用 LIMIT 限制查询结果的数量</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n#请在此处添加实现代码\n########## Begin ##########\n\n########## 查询班级中第<span class=\"token number\">2</span>名到第<span class=\"token number\">5</span>名的学生信息 ##########\n<span class=\"token constant\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token constant\">FROM</span> tb_score order by score desc <span class=\"token constant\">LIMIT</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<h3><a id=\"MySQL___420\"></a>MySQL数据库 - 连接查询</h3>\n<p>第1关：内连接查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n########## 查询数据表中学生姓名和对应的班级 ##########\n#请在此处添加实现代码\n########## Begin ##########\nselect tb_student<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> studentName<span class=\"token punctuation\">,</span>tb_class<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> className from tb_student join tb_class on tb_class<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> tb_student<span class=\"token punctuation\">.</span>class_id<span class=\"token punctuation\">;</span> \n\n\n\n########## End ##########\n\n\n</code></pre>\n<p>第2关：外连接查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n########## 使用左外连接查询所有学生姓名和对应的班级 ##########\n\n#请在此处添加实现代码\n########## Begin ##########\nselect tb_student<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> studentName<span class=\"token punctuation\">,</span>tb_class<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> className\nfrom tb_class right join tb_student on \ntb_class<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>tb_student<span class=\"token punctuation\">.</span>class_id<span class=\"token punctuation\">;</span>\n\n\n\n########## End ##########\n\n########## 使用右外连接查询所有学生姓名和对应的班级 ##########\nselect tb_student<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> studentName<span class=\"token punctuation\">,</span>tb_class<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> className\nfrom tb_class left join tb_student \non tb_class<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span>tb_student<span class=\"token punctuation\">.</span>class_id<span class=\"token punctuation\">;</span>\n#请在此处添加实现代码\n########## Begin ##########\n\n\n\n\n########## End ##########\n</code></pre>\n<p>第3关：复合条件连接查询</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token constant\">USE</span> School<span class=\"token punctuation\">;</span>\n\n########## 查询所有班级里分数在<span class=\"token number\">90</span>分以上的学生的姓名和学生的成绩以及学生所在的班级 ##########\n#请在此处添加实现代码\n########## Begin ##########\nselect s1<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> studentName<span class=\"token punctuation\">,</span>score<span class=\"token punctuation\">,</span>\ns2<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> className from tb_student <span class=\"token keyword\">as</span> s1<span class=\"token punctuation\">,</span>\ntb_class <span class=\"token keyword\">as</span> s2 where s1<span class=\"token punctuation\">.</span>class_id<span class=\"token operator\">=</span>s2<span class=\"token punctuation\">.</span>id and\ns1<span class=\"token punctuation\">.</span>score<span class=\"token operator\">&gt;</span><span class=\"token number\">90</span> order by score desc<span class=\"token punctuation\">;</span>\n########## End ##########\n</code></pre>\n<h3><a id=\"MySQL___481\"></a>MySQL数据库 - 子查询</h3>\n<p>第1关：带比较运算符的子查询</p>\n<pre><code class=\"prism language-c\">USE Company<span class=\"token punctuation\">;</span>\n\n#请在此处添加实现代码\n########## Begin ##########\n#<span class=\"token number\">1.</span>查询大于所有平均年龄的员工姓名与年龄\nselect name<span class=\"token punctuation\">,</span>age from tb_emp where age<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span>select <span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>age<span class=\"token punctuation\">)</span> from tb_emp<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n########## End ##########\n</code></pre>\n<p>第2关：关键字子查询</p>\n<pre><code class=\"prism language-c\">USE Company<span class=\"token punctuation\">;</span>\n#请在此处添加实现代码\n########## Begin ##########\n\n#<span class=\"token number\">1.</span>使用 ALL 关键字进行查询\nSELECT position<span class=\"token punctuation\">,</span>salary FROM tb_salary WHERE salary <span class=\"token operator\">&gt;</span> \n<span class=\"token function\">ANY</span><span class=\"token punctuation\">(</span>SELECT <span class=\"token function\">max</span><span class=\"token punctuation\">(</span>salary<span class=\"token punctuation\">)</span> FROM tb_salary where position<span class=\"token operator\">=</span><span class=\"token string\">\"java\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n#<span class=\"token number\">2.</span>使用 ANY 关键字进行查询\nSELECT position<span class=\"token punctuation\">,</span>salary FROM tb_salary WHERE salary <span class=\"token operator\">&gt;</span> \n<span class=\"token function\">ANY</span><span class=\"token punctuation\">(</span>SELECT <span class=\"token function\">min</span><span class=\"token punctuation\">(</span>salary<span class=\"token punctuation\">)</span> from tb_salary where position<span class=\"token operator\">=</span><span class=\"token string\">\"java\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n#<span class=\"token number\">3.</span>使用 IN 关键字进行查询\nselect position<span class=\"token punctuation\">,</span>salary from tb_salary where position <span class=\"token function\">in</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"java\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n########## End ##########\n</code></pre>\n<h3><a id=\"MySQL___513\"></a>MySQL数据库 - 复杂查询（一)</h3>\n<p>第1关：交换工资</p>\n<pre><code class=\"prism language-c\">\n#请在此添加实现代码\n########## Begin ##########\nUPDATE tb_Salary\nSET\nsex <span class=\"token operator\">=</span> CASE sex WHEN <span class=\"token string\">\"m\"</span>  THEN <span class=\"token string\">\"f\"</span>\nELSE <span class=\"token string\">\"m\"</span>\nEND<span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<p>第2关：换座位</p>\n<pre><code class=\"prism language-c\">#请在此添加实现代码\n########## Begin ##########\nSELECT <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Id<span class=\"token operator\">%</span><span class=\"token number\">2</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>Id<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Id<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>Id<span class=\"token punctuation\">,</span>Id<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> AS id<span class=\"token punctuation\">,</span>name\nFROM tb_Seat ORDER BY Id<span class=\"token punctuation\">;</span>\n########## End ##########\n\n</code></pre>\n<p>第3关：分数排名</p>\n<pre><code class=\"prism language-c\">\n#请在此添加实现代码\n########## Begin ##########\nselect Score<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>select <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>distinct score<span class=\"token punctuation\">)</span> from score where score <span class=\"token operator\">&gt;=</span>s<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">)</span> as Rank\nfrom score as s order by Score desc<span class=\"token punctuation\">;</span>\nselect Score<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>select <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from score as s2 where s2<span class=\"token punctuation\">.</span>score <span class=\"token operator\">&gt;</span>s1<span class=\"token punctuation\">.</span>score<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> as Rank\nfrom score as s1 order by Rank<span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<p>第4关：体育馆的人流量</p>\n<pre><code class=\"prism language-c\">#请在此添加实现代码\n########## Begin ##########\nselect distinct a<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> from gymnasium a<span class=\"token punctuation\">,</span>gymnasium b<span class=\"token punctuation\">,</span>gymnasium c\nwhere a<span class=\"token punctuation\">.</span>visitors_flow<span class=\"token operator\">&gt;=</span><span class=\"token number\">100</span> and b<span class=\"token punctuation\">.</span>visitors_flow<span class=\"token operator\">&gt;=</span><span class=\"token number\">100</span>\nand c<span class=\"token punctuation\">.</span>visitors_flow<span class=\"token operator\">&gt;=</span><span class=\"token number\">100</span>\n<span class=\"token function\">and</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>id<span class=\"token operator\">-</span><span class=\"token number\">1</span> and b<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>id <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token function\">or</span>\n    <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>id<span class=\"token operator\">-</span><span class=\"token number\">1</span> and a<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>id <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token function\">or</span>\n    <span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>id<span class=\"token operator\">+</span><span class=\"token number\">1</span> and b<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>id <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\norder by a<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<p>第5关：统计总成绩</p>\n<pre><code class=\"prism language-c\">#请在此添加实现代码\n########## Begin ##########\nselect t1<span class=\"token punctuation\">.</span>classname<span class=\"token punctuation\">,</span>t1<span class=\"token punctuation\">.</span>chinese<span class=\"token punctuation\">,</span>t2<span class=\"token punctuation\">.</span>maths\n<span class=\"token function\">from</span><span class=\"token punctuation\">(</span>select c<span class=\"token punctuation\">.</span>classname classname<span class=\"token punctuation\">,</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>chinese<span class=\"token punctuation\">)</span>\nchinese from tb_class c<span class=\"token punctuation\">,</span>tb_score s where c<span class=\"token punctuation\">.</span>stuname<span class=\"token operator\">=</span>\ns<span class=\"token punctuation\">.</span>name and s<span class=\"token punctuation\">.</span>chinese<span class=\"token operator\">&gt;=</span><span class=\"token number\">60</span> group by c<span class=\"token punctuation\">.</span>classname<span class=\"token punctuation\">)</span>t1<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">(</span>select c<span class=\"token punctuation\">.</span>classname classname<span class=\"token punctuation\">,</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span>maths<span class=\"token punctuation\">)</span>maths from tb_class c<span class=\"token punctuation\">,</span>tb_score s\nwhere c<span class=\"token punctuation\">.</span>stuname<span class=\"token operator\">=</span>s<span class=\"token punctuation\">.</span>name and s<span class=\"token punctuation\">.</span>maths<span class=\"token operator\">&gt;=</span><span class=\"token number\">60</span> group by c<span class=\"token punctuation\">.</span>classname<span class=\"token punctuation\">)</span>t2\nwhere t1<span class=\"token punctuation\">.</span>classname<span class=\"token operator\">=</span>t2<span class=\"token punctuation\">.</span>classname<span class=\"token punctuation\">;</span>\n\n########## End ##########\n\n</code></pre>\n<h3><a id=\"MySQL___582\"></a>MySQL数据库 - 复杂查询（二）</h3>\n<p>第1关：查询学生平均分</p>\n<pre><code class=\"prism language-c\">\n#请在此添加实现代码\n########## Begin ##########\nselect b<span class=\"token punctuation\">.</span>s_id<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">.</span>s_name<span class=\"token punctuation\">,</span><span class=\"token function\">ROUND</span><span class=\"token punctuation\">(</span><span class=\"token function\">AVG</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>s_score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>as avg_score from student b \ninner join score a on b<span class=\"token punctuation\">.</span>s_id <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>s_id\nGROUP BY b<span class=\"token punctuation\">.</span>s_id<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">.</span>s_name HAVING avg_score <span class=\"token operator\">&lt;</span><span class=\"token number\">60</span>\n<span class=\"token keyword\">union</span> \nselect a<span class=\"token punctuation\">.</span>s_id<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span>s_name<span class=\"token punctuation\">,</span><span class=\"token number\">0</span> as avg_score from student a \nwhere a<span class=\"token punctuation\">.</span>s_id not <span class=\"token function\">in</span> <span class=\"token punctuation\">(</span>select distinct s_id from score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n########## End ##########\n\n\n\n\n</code></pre>\n<p>第2关：查询修课相同学生信息</p>\n<pre><code class=\"prism language-c\">\n#请在此添加实现代码\n########## Begin ##########\ncreate view temp <span class=\"token function\">as</span><span class=\"token punctuation\">(</span>select s_id<span class=\"token punctuation\">,</span><span class=\"token function\">group_concat</span><span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span>as c from score group by s_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nselect <span class=\"token operator\">*</span> from student where s_id <span class=\"token function\">in</span><span class=\"token punctuation\">(</span>select s_id from temp where c<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>select c from temp where s_id<span class=\"token operator\">=</span><span class=\"token string\">\"01\"</span><span class=\"token punctuation\">)</span>and s_id<span class=\"token operator\">&lt;</span><span class=\"token operator\">&gt;</span><span class=\"token string\">\"01\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n########## End ##########\n\n\n\n\n</code></pre>\n<p>第3关：查询各科成绩并排序</p>\n<pre><code class=\"prism language-c\">#请在此添加实现代码\n########## Begin ##########\nselect a<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>s_score<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> rank from score a left join score b \non a<span class=\"token punctuation\">.</span>c_id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>c_id and a<span class=\"token punctuation\">.</span>s_score <span class=\"token operator\">&lt;</span>b<span class=\"token punctuation\">.</span>s_score\ngroup by a<span class=\"token punctuation\">.</span>c_id<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span>s_id\norder by a<span class=\"token punctuation\">.</span>c_id<span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>s_score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n########## End ##########\n</code></pre>\n<p>第4关：查询张老师课程成绩最高的学生信息</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect a<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">.</span>s_score<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">.</span>c_id<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">.</span>c_name from student a \nINNER JOIN score b ON a<span class=\"token punctuation\">.</span>s_id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>s_id\nINNER JOIN course c ON b<span class=\"token punctuation\">.</span>c_id <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>c_id\nwhere b<span class=\"token punctuation\">.</span>c_id <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>select c_id from course c<span class=\"token punctuation\">,</span>teacher d where c<span class=\"token punctuation\">.</span>t_id<span class=\"token operator\">=</span>d<span class=\"token punctuation\">.</span>t_id <span class=\"token keyword\">and</span> d<span class=\"token punctuation\">.</span>t_name<span class=\"token operator\">=</span><span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">and</span> b<span class=\"token punctuation\">.</span>s_score <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>select <span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span>from score where c_id<span class=\"token operator\">=</span><span class=\"token string\">\"02\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第5关：查询两门课程不及格同学信息</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect a<span class=\"token punctuation\">.</span>s_id<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span>s_name<span class=\"token punctuation\">,</span><span class=\"token function\">ROUND</span><span class=\"token punctuation\">(</span><span class=\"token function\">AVG</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>s_score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\navg_score from student a \ninner join score b on a<span class=\"token punctuation\">.</span>s_id <span class=\"token operator\">=</span> b<span class=\"token punctuation\">.</span>s_id\nwhere a<span class=\"token punctuation\">.</span>s_id <span class=\"token keyword\">in</span><span class=\"token punctuation\">(</span>\n    select s_id from score where s_score<span class=\"token operator\">&lt;</span><span class=\"token number\">60</span> GROUP BY s_id having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;=</span><span class=\"token number\">2</span>\n<span class=\"token punctuation\">)</span>\nGROUP BY a<span class=\"token punctuation\">.</span>s_id<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">.</span>s_name<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___659\"></a>MySQL数据库 - 使用聚合函数查询</h3>\n<p>第1关：COUNT( )函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询该表中一共有多少条数据 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from tb_class<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询此表中<span class=\"token number\">367</span>班有多少位学生 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect classid<span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from tb_class where classid<span class=\"token operator\">=</span><span class=\"token number\">367</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：SUM( )函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询所有学生总分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询学生语文科目的总分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：AVG( )函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询学生语文科目的平均分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span>from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询学生英语科目的平均分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"英语\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第4关：MAX( )函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询语文课程中的最高分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询英语课程中的最高分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"英语\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第5关：MIN( )函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询语文课程中的最低分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询英语课程中的最低分数 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect course<span class=\"token punctuation\">,</span><span class=\"token function\">min</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_class where course<span class=\"token operator\">=</span><span class=\"token string\">\"英语\"</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<h3><a id=\"MySQL___746\"></a>MySQL数据库 - 其他函数的使用</h3>\n<p>第1关：字符函数</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect <span class=\"token function\">CONCAT</span><span class=\"token punctuation\">(</span><span class=\"token function\">UPPER</span><span class=\"token punctuation\">(</span><span class=\"token function\">SUBSTR</span><span class=\"token punctuation\">(</span>Name<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">LOWER</span><span class=\"token punctuation\">(</span><span class=\"token function\">SUBSTR</span><span class=\"token punctuation\">(</span>Name<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token function\">LENGTH</span><span class=\"token punctuation\">(</span>Name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> as Name from employee<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：数学函数</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nupdate Score set s_score<span class=\"token operator\">=</span><span class=\"token function\">TRUNCATE</span><span class=\"token punctuation\">(</span>s_score<span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">power</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">power</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">power</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：日期时间函数和流程控制类函数</p>\n<pre><code class=\"prism language-lua\">\n\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>  查询学生出生年份及年龄 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect <span class=\"token function\">year</span><span class=\"token punctuation\">(</span>s_birth<span class=\"token punctuation\">)</span> year<span class=\"token punctuation\">,</span><span class=\"token string\">'2019-01-01'</span><span class=\"token operator\">-</span>s_birth <span class=\"token string\">'年龄'</span>\nfrom Student<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>  查询课程的最高分、最低分、平均分和及格率 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect c<span class=\"token punctuation\">.</span>c_id <span class=\"token string\">'课程id'</span><span class=\"token punctuation\">,</span>\nc_name <span class=\"token string\">'课程名'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">max</span><span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> <span class=\"token string\">'最高分'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">min</span><span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span> <span class=\"token string\">'最低分'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token string\">'平均分'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>s_score <span class=\"token operator\">&gt;=</span> <span class=\"token number\">60</span> <span class=\"token keyword\">or</span> null<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>s_score<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token string\">'及格率'</span>\nfrom Score s<span class=\"token punctuation\">,</span>Course c\nwhere s<span class=\"token punctuation\">.</span>c_id<span class=\"token operator\">=</span>c<span class=\"token punctuation\">.</span>c_id\ngroup by s<span class=\"token punctuation\">.</span>c_id<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第4关：自定义函数</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ndelimiter <span class=\"token operator\">//</span>\ncreate <span class=\"token keyword\">function</span> <span class=\"token function\">fn_three_max</span><span class=\"token punctuation\">(</span>param_1 int<span class=\"token punctuation\">,</span>param_2 int<span class=\"token punctuation\">,</span>param_3 int<span class=\"token punctuation\">)</span> RETURNS int\nBEGIN\n        DECLARE max_val int DEFAULT <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> param_1 <span class=\"token operator\">&gt;</span> param_2 <span class=\"token keyword\">then</span>\n            set max_val<span class=\"token operator\">=</span>param_1<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">else</span> \n            set max_val<span class=\"token operator\">=</span>param_2<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> param_3 <span class=\"token operator\">&gt;</span> max_val <span class=\"token keyword\">then</span>\n            set max_val<span class=\"token operator\">=</span>param_3<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> max_val<span class=\"token punctuation\">;</span>\nEND\n<span class=\"token operator\">//</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<h3><a id=\"MySQL___812\"></a>MySQL数据库 - 分组选择数据</h3>\n<p>第1关：GROUP BY 与 聚合函数</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>查询表中<span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span>年级中分别男女的总人数\nselect gradeId<span class=\"token punctuation\">,</span>sex<span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>\nfrom student where gradeId <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\ngroup by gradeId<span class=\"token punctuation\">,</span>sex<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第2关：使用 HAVING 与 ORDER BY</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>查询表中至少有两门课程在<span class=\"token number\">90</span>分以上的学生信息\nselect sno<span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>from tb_grade\nwhere score <span class=\"token operator\">&gt;=</span><span class=\"token number\">90</span>\ngroup by sno having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>pno<span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>查询表中平均成绩大于<span class=\"token number\">90</span>分且语文课在<span class=\"token number\">95</span>分以上的学生信息\nselect sno<span class=\"token punctuation\">,</span><span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> from tb_grade where sno \n<span class=\"token keyword\">in</span><span class=\"token punctuation\">(</span>select sno from tb_grade where score <span class=\"token operator\">&gt;=</span><span class=\"token number\">95</span> <span class=\"token keyword\">and</span> pno <span class=\"token operator\">=</span> <span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">)</span>\ngroup by sno having <span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>score<span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;=</span><span class=\"token number\">90</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<h2><a id=\"2MySQL_850\"></a>数据库2-MySQL数据管理技术实战</h2>\n<h3><a id=\"MySQL___851\"></a>MySQL开发技巧 - 视图</h3>\n<p>第1关：视图</p>\n<pre><code class=\"prism language-lua\">use School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>创建单表视图\nCREATE VIEW stu_view\nAS \nselect math<span class=\"token punctuation\">,</span>chinese<span class=\"token punctuation\">,</span>math<span class=\"token operator\">+</span>chinese\nFROM student<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>创建多表视图\nCREATE VIEW stu_classes\n    AS \n    select student<span class=\"token punctuation\">.</span>stu_id<span class=\"token punctuation\">,</span>student<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>stu_info<span class=\"token punctuation\">.</span>classes \n   FROM student<span class=\"token punctuation\">,</span>stu_info\n   WHERE student<span class=\"token punctuation\">.</span>stu_id<span class=\"token operator\">=</span>stu_info<span class=\"token punctuation\">.</span>stu_id<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___873\"></a>MySQL开发技巧 - 索引</h3>\n<p>第1关：索引</p>\n<pre><code class=\"prism language-lua\">use School<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>创建名为pk_student的主键索引\ncreate table <span class=\"token function\">student</span><span class=\"token punctuation\">(</span>\n    stu_id int <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    name <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    age int <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    sex <span class=\"token function\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    classes int <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    grade int <span class=\"token keyword\">not</span> null<span class=\"token punctuation\">,</span>\n    primary <span class=\"token function\">key</span><span class=\"token punctuation\">(</span>stu_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>创建名为idx_age的普通索引\ncreate index idx_age on <span class=\"token function\">student</span><span class=\"token punctuation\">(</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">3.</span>创建名为uniq_classes的唯一索引\ncreate unique index uniq_classes on <span class=\"token function\">student</span><span class=\"token punctuation\">(</span>classes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">4.</span>创建名为idx_group的组合索引\nalter table student add index <span class=\"token function\">idx_group</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span>sex<span class=\"token punctuation\">,</span>grade<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___899\"></a>MySQL开发技巧 - 分页和索引</h3>\n<p>第1关：MySQL 分页查询</p>\n<pre><code class=\"prism language-lua\">USE Products<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>分页查询\n\nselect prod_id from products where prod_id <span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span>select prod_id from products limit <span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> limit <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>用子查询优化分页查询语句\nselect prod_id from products where prod_id <span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span>select prod_id from products limit <span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> limit <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：索引（单列索引）</p>\n<pre><code class=\"prism language-lua\">USE Students<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>创建student表结构并且设置id为主键索引\n\nCREATE TABLE <span class=\"token function\">student</span> <span class=\"token punctuation\">(</span>\nid <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL AUTO_INCREMENT<span class=\"token punctuation\">,</span>\nname <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\nscore <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\nPRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>对name建立唯一索引\nCREATE UNIQUE  INDEX name_index ON `student`<span class=\"token punctuation\">(</span>`name`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">3.</span>对score建立普通索引\nCREATE INDEX score_index ON `student`<span class=\"token punctuation\">(</span>`score`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nSHOW INDEX FROM student<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第3关：索引（组合索引）</p>\n<pre><code class=\"prism language-lua\">USE Person<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>增加组合索引\nALTER TABLE person ADD INDEX <span class=\"token function\">name_city_score</span> <span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span>age<span class=\"token punctuation\">,</span>address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nSHOW INDEX FROM person<span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"MySQL___950\"></a>MySQL开发技巧 - 存储过程</h3>\n<p>第1关：存储过程</p>\n<pre><code class=\"prism language-lua\">USE mydb<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ndrop procedure <span class=\"token keyword\">if</span> exists mydb<span class=\"token punctuation\">.</span>GetCustomerLevel<span class=\"token punctuation\">;</span>\ndelimiter $$\ncreate PROCEDURE <span class=\"token function\">GetCustomerLevel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">in</span> p_customNumber <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>out p_customerLevel <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nBegin\ndeclare levels int<span class=\"token punctuation\">;</span>\nselect creditlimit into levels from customers where customerNumber<span class=\"token operator\">=</span>p_customNumber<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> levels <span class=\"token operator\">&lt;</span><span class=\"token number\">5000</span> <span class=\"token keyword\">then</span>\n    set p_customerLevel <span class=\"token operator\">=</span> <span class=\"token string\">'SILVER'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">elseif</span> levels <span class=\"token operator\">&lt;</span><span class=\"token number\">10000</span> <span class=\"token keyword\">then</span>\n    set p_customerLevel <span class=\"token operator\">=</span> <span class=\"token string\">'GOLD'</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">else</span>\n    set p_customerLevel <span class=\"token operator\">=</span> <span class=\"token string\">'PLATINUM'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span>\nselect p_customNumber as customerNumber<span class=\"token punctuation\">,</span>p_customerLevel<span class=\"token punctuation\">;</span>\nEnd $$\ndelimiter <span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___974\"></a>MySQL开发技巧 - 事务</h3>\n<p>第1关：事务</p>\n<pre><code class=\"prism language-lua\">USE mydb<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span> 修改存储过程 ———— 向 t_emp 表中插入数据（注意请勿修改提供的代码框架） \ndrop procedure <span class=\"token keyword\">if</span> exists mydb<span class=\"token punctuation\">.</span>proc_insert<span class=\"token punctuation\">;</span>\ndelimiter $$\ncreate procedure <span class=\"token function\">proc_insert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nBegin \n\t\n\n\t<span class=\"token operator\">#</span>开启事务\n\tstart transaction <span class=\"token punctuation\">;</span>\n    insert into t_emp <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Nancy'</span><span class=\"token punctuation\">,</span><span class=\"token number\">301</span><span class=\"token punctuation\">,</span><span class=\"token number\">2300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    insert into t_emp <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Tod'</span><span class=\"token punctuation\">,</span><span class=\"token number\">303</span><span class=\"token punctuation\">,</span><span class=\"token number\">5600</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tinsert into t_emp <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Carly'</span><span class=\"token punctuation\">,</span><span class=\"token number\">301</span><span class=\"token punctuation\">,</span><span class=\"token number\">3200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token operator\">#</span>事务提交\n\tcommit<span class=\"token punctuation\">;</span>\nEND $$\ndelimiter <span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n\n\n</code></pre>\n<h3><a id=\"MySQL___1003\"></a>MySQL开发技巧 - 并发控制</h3>\n<p>第1关：表锁</p>\n<pre><code class=\"prism language-lua\">use School<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ninsert into student <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Tom'</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into student <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Lucy'</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlock table student read<span class=\"token punctuation\">;</span>\nupdate  student set math<span class=\"token operator\">=</span><span class=\"token number\">100</span> where stu_id <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：事务隔离级别</p>\n<pre><code class=\"prism language-lua\">use mydb<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此处添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span><span class=\"token number\">1.</span>修改隔离级别\nset session transaction isolation level Read uncommitted<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token number\">2.</span>查询隔离级别\nselect @@tx_isolation<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第3关：行锁</p>\n<pre><code class=\"prism language-lua\">mysql <span class=\"token operator\">-</span>uroot <span class=\"token operator\">-</span>p123123 <span class=\"token operator\">-</span>h127<span class=\"token punctuation\">.</span><span class=\"token number\">0.0</span><span class=\"token number\">.1</span>\n</code></pre>\n<pre><code class=\"prism language-lua\">source <span class=\"token operator\">/</span>data<span class=\"token operator\">/</span>workspace<span class=\"token operator\">/</span>myshixun<span class=\"token operator\">/</span>src<span class=\"token operator\">/</span>step3<span class=\"token operator\">/</span>table<span class=\"token punctuation\">.</span>sql；\n</code></pre>\n<pre><code class=\"prism language-lua\">begin<span class=\"token punctuation\">;</span>\n\n</code></pre>\n<pre><code class=\"prism language-lua\">select <span class=\"token operator\">*</span> from account <span class=\"token keyword\">for</span> update<span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-lua\">update account set money<span class=\"token operator\">=</span><span class=\"token number\">0</span> where name<span class=\"token operator\">=</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-lua\">update account set money<span class=\"token operator\">=</span><span class=\"token number\">0</span> where name<span class=\"token operator\">=</span><span class=\"token string\">'B'</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<pre><code class=\"prism language-lua\">commit<span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"MySQL___1060\"></a>MySQL开发技巧 - 行列转换</h3>\n<p>第1关：使用 CASE 语句实现行转列</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect s_name<span class=\"token punctuation\">,</span>\n<span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>case c_name when <span class=\"token string\">'语文'</span> <span class=\"token keyword\">then</span> s_score <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token string\">'语文'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>case c_name when <span class=\"token string\">'数学'</span> <span class=\"token keyword\">then</span> s_score <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token string\">'数学'</span><span class=\"token punctuation\">,</span>\n<span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>case c_name when <span class=\"token string\">'英语'</span> <span class=\"token keyword\">then</span> s_score <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token string\">'英语'</span>\nfrom score\ngroup by s_name<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n\n\n</code></pre>\n<p>第2关：序列化表的方法实现列转行（一）</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect b<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n<span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>scores<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>s<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">char_length</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>scores<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">':'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> course<span class=\"token punctuation\">,</span>\n<span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>scores<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>s<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">char_length</span><span class=\"token punctuation\">(</span><span class=\"token function\">substring_index</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>scores<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">':'</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> score\nfrom tb_sequence s inner <span class=\"token function\">join</span> \n<span class=\"token punctuation\">(</span>select name<span class=\"token punctuation\">,</span>scores as course<span class=\"token punctuation\">,</span>scores<span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span>scores<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>scores<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span> size\nfrom tb_score<span class=\"token punctuation\">)</span> b \non s<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&lt;=</span> b<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n\n\n</code></pre>\n<p>第3关：序列化表的方法实现列转行（二）</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nselect s_name<span class=\"token punctuation\">,</span>\ncase when s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token string\">'语文'</span>\nwhen s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span> <span class=\"token string\">'数学'</span>\nwhen s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">3</span> <span class=\"token keyword\">then</span> <span class=\"token string\">'英语'</span>\n<span class=\"token keyword\">end</span> s_cource<span class=\"token punctuation\">,</span>\n<span class=\"token function\">coalesce</span><span class=\"token punctuation\">(</span>\ncase when s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token keyword\">then</span> chinese <span class=\"token keyword\">end</span><span class=\"token punctuation\">,</span>\ncase when s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span> math <span class=\"token keyword\">end</span><span class=\"token punctuation\">,</span>\ncase when s<span class=\"token punctuation\">.</span>id<span class=\"token operator\">=</span><span class=\"token number\">3</span> <span class=\"token keyword\">then</span> english <span class=\"token keyword\">end</span>\n<span class=\"token punctuation\">)</span> \ns_score\nfrom tb_score t\ninner join tb_sequence s\nwhere  s<span class=\"token punctuation\">.</span>id <span class=\"token operator\">&lt;=</span> <span class=\"token number\">3</span>\norder by s_name<span class=\"token punctuation\">,</span><span class=\"token function\">field</span><span class=\"token punctuation\">(</span>s_cource<span class=\"token punctuation\">,</span><span class=\"token string\">'数学'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'英语'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'语文'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___1121\"></a>MySQL开发技巧 - 删除重复数据</h3>\n<p>第1关：利用主键删除</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ndelete from users where id <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>\n    select <span class=\"token operator\">*</span> <span class=\"token function\">from</span> <span class=\"token punctuation\">(</span>\n        select id from users where user_name \n        <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>\n            select user_name from users group by user_name having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">)</span> \n        <span class=\"token keyword\">and</span> id <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span>\n            select <span class=\"token function\">min</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> from users group by user_name having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">1</span>\n            <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span> as stu_repeat_copy\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n\n\n</code></pre>\n<p>第2关：复杂重复数据删除</p>\n<pre><code class=\"prism language-lua\">\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nupdate users b <span class=\"token function\">join</span> <span class=\"token punctuation\">(</span>\n  select user_name<span class=\"token punctuation\">,</span><span class=\"token function\">group_concat</span><span class=\"token punctuation\">(</span>\n    distinct <span class=\"token function\">SUBSTRING_INDEX</span><span class=\"token punctuation\">(</span><span class=\"token function\">SUBSTRING_INDEX</span><span class=\"token punctuation\">(</span>mobile<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span> mobile <span class=\"token function\">from</span> <span class=\"token punctuation\">(</span>\n    select user_name<span class=\"token punctuation\">,</span>mobile<span class=\"token punctuation\">,</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>mobile<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>mobile<span class=\"token punctuation\">,</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> size from users\n  <span class=\"token punctuation\">)</span> a inner join tb_sequence t on a<span class=\"token punctuation\">.</span>size<span class=\"token operator\">&gt;=</span>t<span class=\"token punctuation\">.</span>id group by a<span class=\"token punctuation\">.</span>user_name\n<span class=\"token punctuation\">)</span> c on b<span class=\"token punctuation\">.</span>user_name <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>user_name set b<span class=\"token punctuation\">.</span>mobile <span class=\"token operator\">=</span> c<span class=\"token punctuation\">.</span>mobile<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"MySQL___1159\"></a>MySQL开发技巧 - 批量数据入库及检索</h3>\n<p>第1关：MySQL数据库连接</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span> coding<span class=\"token operator\">=</span>utf<span class=\"token operator\">-</span><span class=\"token number\">8</span>\nimport pymysql\ndef <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token operator\">#</span> 请在下面添加连接数据库的代码，完成相应功能\n<span class=\"token operator\">#</span> <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    conn <span class=\"token operator\">=</span> pymysql<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> user<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span>passwd<span class=\"token operator\">=</span><span class=\"token string\">'123123'</span><span class=\"token punctuation\">,</span>charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 请不要修改以下代码 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    <span class=\"token keyword\">return</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">get_host_info</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n\n</code></pre>\n<p>第2关：数据库与数据表创建</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span> coding <span class=\"token operator\">=</span> utf<span class=\"token operator\">-</span><span class=\"token number\">8</span>\n\n<span class=\"token operator\">#</span> 连接数据库，建立游标cursor\nimport pymysql\n\ndef <span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    conn <span class=\"token operator\">=</span> pymysql<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> user<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span> passwd<span class=\"token operator\">=</span><span class=\"token string\">'123123'</span><span class=\"token punctuation\">,</span> charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n    cursor <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">cursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 创建enroll数据库\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'create database enroll'</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">select_db</span><span class=\"token punctuation\">(</span><span class=\"token string\">'enroll'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 创建nudt数据表\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'create table nudt(year int, province varchar(100), firstBatch int )'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n</code></pre>\n<p>第3关：批量数据入库与检索</p>\n<pre><code class=\"prism language-lua\">import pymysql\n\ndef <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span>province<span class=\"token punctuation\">,</span>firstBatch<span class=\"token punctuation\">,</span>gcMax<span class=\"token punctuation\">,</span>gcMin<span class=\"token punctuation\">,</span>gcMean<span class=\"token punctuation\">,</span>xlMax<span class=\"token punctuation\">,</span>xlMin<span class=\"token punctuation\">,</span>xlMean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    conn <span class=\"token operator\">=</span> pymysql<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> user<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span> passwd<span class=\"token operator\">=</span><span class=\"token string\">'123123'</span><span class=\"token punctuation\">,</span> charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n    cursor <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">cursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">select_db</span><span class=\"token punctuation\">(</span><span class=\"token string\">'enroll'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入插入数据的语句，完成相应功能\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'insert into nudt(year,province,firstBatch,gcMax,gcMin,gcMean,xlMax,xlMin,xlMean) values (%s,\"%s\",%s,%s,%s,%s,%s,%s,%s)'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span>province<span class=\"token punctuation\">,</span>firstBatch<span class=\"token punctuation\">,</span>gcMax<span class=\"token punctuation\">,</span>gcMin<span class=\"token punctuation\">,</span>gcMean<span class=\"token punctuation\">,</span>xlMax<span class=\"token punctuation\">,</span>xlMin<span class=\"token punctuation\">,</span>xlMean<span class=\"token punctuation\">)</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n    \n    <span class=\"token operator\">#</span> 提交数据到数据库\n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 关闭数据库连接\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    conn <span class=\"token operator\">=</span> pymysql<span class=\"token punctuation\">.</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">,</span> user<span class=\"token operator\">=</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">,</span> passwd<span class=\"token operator\">=</span><span class=\"token string\">'123123'</span><span class=\"token punctuation\">,</span> charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n    cursor <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">cursor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">select_db</span><span class=\"token punctuation\">(</span><span class=\"token string\">'enroll'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入查询数据的语句，完成相应功能\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'select * from nudt'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 请在下面输入获取数据的语句，完成相应功能\n    records <span class=\"token operator\">=</span> cursor<span class=\"token punctuation\">.</span><span class=\"token function\">fetchall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n    <span class=\"token keyword\">for</span> record <span class=\"token keyword\">in</span> records<span class=\"token punctuation\">:</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span>\n\n    <span class=\"token operator\">#</span> 关闭数据库连接\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n    conn<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n</code></pre>\n<p>第4关：多表创建与连接查询</p>\n<pre><code class=\"prism language-lua\">import pymysql\n\ndef <span class=\"token function\">create</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 创建provincialEntryScore表\n    sql <span class=\"token operator\">=</span>  <span class=\"token string\">'create table provincialEntryScore(year int, province varchar(100), entryScore int)'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 创建nudtTechScore表\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'create table nudtTechScore(year int, province varchar(100), techMax int, techMin int, techMean int)'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 创建nudtMilScore表\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'create table nudtMilScore(year int, province varchar(100), milMax int, milMin int, milMean int)'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n\ndef <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">,</span>year<span class=\"token punctuation\">,</span>province<span class=\"token punctuation\">,</span>entryScore<span class=\"token punctuation\">,</span>techMax<span class=\"token punctuation\">,</span>techMin<span class=\"token punctuation\">,</span>techMean<span class=\"token punctuation\">,</span>milMax<span class=\"token punctuation\">,</span>milMin<span class=\"token punctuation\">,</span>milMean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入将数据插入provincialEntryScore表中的语句\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'insert into provincialEntryScore(year, province, entryScore) values (%s, \"%s\", %s)'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> province<span class=\"token punctuation\">,</span> entryScore<span class=\"token punctuation\">)</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 请在下面输入将数据插入nudtTechScore表中的语句\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'insert into nudtTechScore(year, province, techMax, techMin, techMean) values (%s, \"%s\", %s, %s, %s)'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> province<span class=\"token punctuation\">,</span> techMax<span class=\"token punctuation\">,</span> techMin<span class=\"token punctuation\">,</span> techMean<span class=\"token punctuation\">)</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> 请在下面输入将数据插入nudtMilScore表中的语句\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'insert into nudtMilScore(year, province, milMax, milMin, milMean) values (%s, \"%s\", %s, %s, %s)'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> province<span class=\"token punctuation\">,</span> milMax<span class=\"token punctuation\">,</span> milMin<span class=\"token punctuation\">,</span> milMean<span class=\"token punctuation\">)</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n\ndef <span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入多表直接汇总的语句\n    sql <span class=\"token operator\">=</span>  <span class=\"token string\">'select * from provincialEntryScore, nudtTechScore, nudtMilScore'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    records <span class=\"token operator\">=</span> cursor<span class=\"token punctuation\">.</span><span class=\"token function\">fetchall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> records\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n\ndef <span class=\"token function\">selectEqual</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入等值连接的语句\n    sql <span class=\"token operator\">=</span> <span class=\"token string\">'select * from provincialEntryScore A,nudtTechScore B,nudtMilScore C where A.year = B.year and A.year = C.year and A.province = B.province and A.province = C.province'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    records <span class=\"token operator\">=</span> cursor<span class=\"token punctuation\">.</span><span class=\"token function\">fetchall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> records\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n\ndef <span class=\"token function\">selectNatural</span><span class=\"token punctuation\">(</span>cursor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token comment\">-----------Begin----------</span>\n    <span class=\"token operator\">#</span> 请在下面输入自然连接的语句\n    sql <span class=\"token operator\">=</span><span class=\"token string\">'select A.year, A.province, A.entryScore, B.techMax, B.techMin, B.techMean, C.milMax, C.milMin, C.milMean from provincialEntryScore A, nudtTechScore B, nudtMilScore C where A.year = B.year and A.year = C.year and A.province = B.province and A.province = C.province'</span>\n    cursor<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    records <span class=\"token operator\">=</span> cursor<span class=\"token punctuation\">.</span><span class=\"token function\">fetchall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> records\n    <span class=\"token operator\">#</span> <span class=\"token comment\">------------End-----------</span>\n\n</code></pre>\n<h2><a id=\"3MySQL_1294\"></a>数据库3-MySQL数据库系统设计实战</h2>\n<h3><a id=\"MySQL___1295\"></a>MySQL开发技巧 - 查询、索引和完整性</h3>\n<p>第1关：基本查询的学习</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">//</span>请在下面补齐查询一的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\nselect ename<span class=\"token punctuation\">,</span>eid<span class=\"token punctuation\">,</span>sex from emp\n    where did <span class=\"token keyword\">in</span>\n    <span class=\"token punctuation\">(</span>select did from dept\n        where dname<span class=\"token operator\">=</span><span class=\"token string\">'cwb'</span>\n    <span class=\"token punctuation\">)</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n    <span class=\"token keyword\">and</span>\n    birth<span class=\"token operator\">&lt;=</span><span class=\"token function\">all</span>\n        <span class=\"token punctuation\">(</span>select birth from emp\n            where did <span class=\"token keyword\">in</span>\n                <span class=\"token punctuation\">(</span>select did from dept\n                    where dname<span class=\"token operator\">=</span><span class=\"token string\">'yfb'</span>\n                <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">//</span>请在下面输入查询二的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\nselect ename<span class=\"token punctuation\">,</span>income<span class=\"token punctuation\">,</span>outcome\n    from emp<span class=\"token punctuation\">,</span>sal<span class=\"token punctuation\">,</span>dept\n    where emp<span class=\"token punctuation\">.</span>eid<span class=\"token operator\">=</span>sal<span class=\"token punctuation\">.</span>eid <span class=\"token keyword\">and</span>\n        emp<span class=\"token punctuation\">.</span>did<span class=\"token operator\">=</span>dept<span class=\"token punctuation\">.</span>did <span class=\"token keyword\">and</span>\n        dname<span class=\"token operator\">=</span><span class=\"token string\">'cwb'</span> <span class=\"token keyword\">and</span> income<span class=\"token operator\">&gt;</span><span class=\"token number\">5200</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n</code></pre>\n<p>第2关：深入学习查询语句</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">//</span>请在下面输入查询一的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n\nselect <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>eid<span class=\"token punctuation\">)</span>\n    from emp\n    where did<span class=\"token operator\">=</span>\n        <span class=\"token punctuation\">(</span>select did\n            from dept\n                where dname<span class=\"token operator\">=</span><span class=\"token string\">'cwb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入查询二的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\nselect <span class=\"token function\">count</span><span class=\"token punctuation\">(</span>eid<span class=\"token punctuation\">)</span>\n    from emp\n    group by did<span class=\"token punctuation\">;</span>\n   \n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入查询三的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\nselect emp<span class=\"token punctuation\">.</span>ename\n    from emp<span class=\"token punctuation\">,</span>sal\n    where emp<span class=\"token punctuation\">.</span>eid<span class=\"token operator\">=</span>sal<span class=\"token punctuation\">.</span>eid\n    order by income<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n</code></pre>\n<p>第3关：视图的创建和使用</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">//</span>请在下面输入创建cx_sal的视图的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\ncreate <span class=\"token keyword\">or</span> replace view cx_sal\nas\n    select ename<span class=\"token punctuation\">,</span>income<span class=\"token punctuation\">,</span>outcome\n        from emp<span class=\"token punctuation\">,</span>sal<span class=\"token punctuation\">,</span>dept\n        where emp<span class=\"token punctuation\">.</span>eid<span class=\"token operator\">=</span>sal<span class=\"token punctuation\">.</span>eid <span class=\"token keyword\">and</span>\n            emp<span class=\"token punctuation\">.</span>did<span class=\"token operator\">=</span>dept<span class=\"token punctuation\">.</span>did <span class=\"token keyword\">and</span>\n            dname<span class=\"token operator\">=</span><span class=\"token string\">'cwb'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入查询财务部雇员薪水情况视图的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\nselect <span class=\"token operator\">*</span> from cx_sal<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n</code></pre>\n<p>第4关：索引与完整性</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">//</span>请在下面输入创建索引的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\ncreate index pk_xs_bak\non <span class=\"token function\">emp</span><span class=\"token punctuation\">(</span>eid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入实现域完整性的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\nalter table emp\n    <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>constraint ch_tel <span class=\"token function\">check</span><span class=\"token punctuation\">(</span>tel between <span class=\"token number\">0</span> <span class=\"token keyword\">and</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入实现实体完整性的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\nalter table dept\nadd constraint un_dept <span class=\"token function\">unique</span><span class=\"token punctuation\">(</span>dname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\n<span class=\"token operator\">//</span>请在下面输入实现参照完整性的MySQL语句\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>begin<span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n\nalter table emp\n    add constraint sal_id foreign <span class=\"token function\">key</span><span class=\"token punctuation\">(</span>eid<span class=\"token punctuation\">)</span>\n        references <span class=\"token function\">sal</span><span class=\"token punctuation\">(</span>eid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token keyword\">end</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n</code></pre>\n<h3><a id=\"___1414\"></a>数据库查询 - 选课系统</h3>\n<p>第1关：数据库数据的插入</p>\n<pre><code class=\"prism language-lua\">USE School<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 插入学生表（Student）相应数据 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ninsert into <span class=\"token function\">student</span><span class=\"token punctuation\">(</span>Sno<span class=\"token punctuation\">,</span>Sname<span class=\"token punctuation\">,</span>Ssex<span class=\"token punctuation\">,</span>Sage<span class=\"token punctuation\">,</span>Sdept<span class=\"token punctuation\">)</span> <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">9512101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'李勇'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'男'</span><span class=\"token punctuation\">,</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9512102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'刘晨'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'男'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9512103</span><span class=\"token punctuation\">,</span><span class=\"token string\">'王敏'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'女'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9521101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'张立'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'男'</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token string\">'信息系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9521102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'吴宾'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'女'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'信息系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9521103</span><span class=\"token punctuation\">,</span><span class=\"token string\">'张海'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'男'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'信息系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9531101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'钱小平'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'女'</span><span class=\"token punctuation\">,</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token string\">'数学系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">9531102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'王大力'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'男'</span><span class=\"token punctuation\">,</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token string\">'数学系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 插入课程表（Course）相应数据 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ninsert into <span class=\"token function\">course</span><span class=\"token punctuation\">(</span>Cno<span class=\"token punctuation\">,</span>Cname<span class=\"token punctuation\">,</span>Ccredit<span class=\"token punctuation\">,</span>Semster<span class=\"token punctuation\">,</span>Period<span class=\"token punctuation\">)</span> <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token string\">'C01'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'计算机文化学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">41</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'C02'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'VB'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">61</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'C03'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'计算机网络'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'C04'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'数据库基础'</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'C05'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'高等数学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">19</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token string\">'C06'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'数据结构'</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 插入学生选课表（DBSC）相应数据 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\ninsert into <span class=\"token function\">dbsc</span><span class=\"token punctuation\">(</span>ScID<span class=\"token punctuation\">,</span>Sno<span class=\"token punctuation\">,</span>Cno<span class=\"token punctuation\">,</span>Grade<span class=\"token punctuation\">,</span>isTec<span class=\"token punctuation\">)</span> <span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">9512101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c01'</span><span class=\"token punctuation\">,</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">9512101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c02'</span><span class=\"token punctuation\">,</span><span class=\"token number\">86</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">9512101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c06'</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">9512102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c02'</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">9512102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c04'</span><span class=\"token punctuation\">,</span><span class=\"token number\">66</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c01'</span><span class=\"token punctuation\">,</span><span class=\"token number\">82</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c02'</span><span class=\"token punctuation\">,</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c04'</span><span class=\"token punctuation\">,</span><span class=\"token number\">92</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c05'</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521103</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c02'</span><span class=\"token punctuation\">,</span><span class=\"token number\">68</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">9521103</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c06'</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">9531101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c01'</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token string\">'选修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">9531101</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c05'</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">9531102</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c05'</span><span class=\"token punctuation\">,</span><span class=\"token number\">85</span><span class=\"token punctuation\">,</span><span class=\"token string\">'必修'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> 查询表数据 <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nSELECT <span class=\"token operator\">*</span> FROM student<span class=\"token punctuation\">;</span>\nSELECT <span class=\"token operator\">*</span> FROM course<span class=\"token punctuation\">;</span>\nSELECT <span class=\"token operator\">*</span> FROM dbsc<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>第2关：简单查询</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\necho \"\nselect Sname<span class=\"token punctuation\">,</span> Sdept from student where Sdept <span class=\"token operator\">=</span> <span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">;</span>\n\nselect Sno from dbsc where Grade <span class=\"token operator\">&lt;</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n\nselect Sname<span class=\"token punctuation\">,</span> Sdept<span class=\"token punctuation\">,</span> Sage from student where Sage <span class=\"token operator\">&gt;=</span><span class=\"token number\">20</span> <span class=\"token keyword\">and</span> Sage <span class=\"token operator\">&lt;=</span><span class=\"token number\">23</span> <span class=\"token keyword\">and</span> Sdept <span class=\"token operator\">=</span> <span class=\"token string\">'信息系'</span><span class=\"token punctuation\">;</span>\n\nselect Sno<span class=\"token punctuation\">,</span> Grade from dbsc where Cno <span class=\"token operator\">=</span> <span class=\"token string\">'c02'</span> order by Grade desc<span class=\"token punctuation\">;</span>\n\nselect <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from student<span class=\"token punctuation\">;</span>\n\n\"\n<span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第3关：进阶查询</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\necho \"\nselect student<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> from student where Sname like <span class=\"token string\">'张%'</span><span class=\"token punctuation\">;</span>\n\nselect Sname<span class=\"token punctuation\">,</span> Ssex<span class=\"token punctuation\">,</span> Sdept from student where Sdept <span class=\"token keyword\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'信息系'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'数学系'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nselect Cno<span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from dbsc where isTec<span class=\"token operator\">=</span> <span class=\"token string\">'选修'</span> group by Cno<span class=\"token punctuation\">;</span>\n\nselect Sno from dbsc group by Sno having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n\nselect Sname<span class=\"token punctuation\">,</span>Cno<span class=\"token punctuation\">,</span>Grade from dbsc left join student on student<span class=\"token punctuation\">.</span>Sno<span class=\"token operator\">=</span>dbsc<span class=\"token punctuation\">.</span>Sno where student<span class=\"token punctuation\">.</span>Sdept<span class=\"token operator\">=</span><span class=\"token string\">'计算机系'</span><span class=\"token punctuation\">;</span>\n\n\"\n<span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第4关：复杂查询</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\necho \"\nselect distinct dbsc<span class=\"token punctuation\">.</span>Sno<span class=\"token punctuation\">,</span> student<span class=\"token punctuation\">.</span>Sname from dbsc join student on student<span class=\"token punctuation\">.</span>Sno<span class=\"token operator\">=</span>dbsc<span class=\"token punctuation\">.</span>Sno where dbsc<span class=\"token punctuation\">.</span>isTec <span class=\"token operator\">=</span> <span class=\"token string\">'选修'</span><span class=\"token punctuation\">;</span>\n\nselect Sname<span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>Grade<span class=\"token punctuation\">)</span> from dbsc join student on student<span class=\"token punctuation\">.</span>Sno<span class=\"token operator\">=</span>dbsc<span class=\"token punctuation\">.</span>Sno  group by dbsc<span class=\"token punctuation\">.</span>Sno<span class=\"token punctuation\">;</span>\n\nselect <span class=\"token function\">avg</span><span class=\"token punctuation\">(</span>Grade<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> from dbsc join student on student<span class=\"token punctuation\">.</span>Sno<span class=\"token operator\">=</span>dbsc<span class=\"token punctuation\">.</span>Sno group by dbsc<span class=\"token punctuation\">.</span>Sno having <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n\nselect student<span class=\"token punctuation\">.</span>Sname<span class=\"token punctuation\">,</span> dbsc<span class=\"token punctuation\">.</span>Cno<span class=\"token punctuation\">,</span> dbsc<span class=\"token punctuation\">.</span>Grade from student left join dbsc on student<span class=\"token punctuation\">.</span>Sno<span class=\"token operator\">=</span>dbsc<span class=\"token punctuation\">.</span>Sno\nwhere student<span class=\"token punctuation\">.</span>Sdept<span class=\"token operator\">=</span><span class=\"token string\">'信息系'</span> <span class=\"token keyword\">and</span> dbsc<span class=\"token punctuation\">.</span>isTec<span class=\"token operator\">=</span><span class=\"token string\">'选修'</span> <span class=\"token keyword\">and</span> Cno<span class=\"token operator\">=</span><span class=\"token string\">'C02'</span><span class=\"token punctuation\">;</span>\n\nupdate dbsc set Grade<span class=\"token operator\">=</span>Grade<span class=\"token operator\">+</span><span class=\"token number\">5</span> where Grade <span class=\"token operator\">&lt;</span> <span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n\n\"\n<span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<h3><a id=\"___1509\"></a>数据库设计 - 博客系统</h3>\n<p>第1关：数据库表设计 - 用户信息表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在blog_db库中创建t_user表\n\ncreate table blog_db<span class=\"token punctuation\">.</span><span class=\"token function\">t_user</span><span class=\"token punctuation\">(</span>\n    userId bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'用户ID'</span><span class=\"token punctuation\">,</span>\n    primary <span class=\"token function\">key</span> <span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    username <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'用户名'</span><span class=\"token punctuation\">,</span>\n    password <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'密码'</span><span class=\"token punctuation\">,</span>\n    user_sex <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'性别 0代表男 1代表女'</span><span class=\"token punctuation\">,</span>\n    email <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'邮箱'</span><span class=\"token punctuation\">,</span>\n    phone <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'手机号码'</span><span class=\"token punctuation\">,</span>\n    firstname <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'姓'</span><span class=\"token punctuation\">,</span>\n    lastname <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'名'</span><span class=\"token punctuation\">,</span>\n    avatar <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'头像地址'</span><span class=\"token punctuation\">,</span> \n    is_superuser int NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'是否是管理员 0代表不是 1代表是'</span><span class=\"token punctuation\">,</span>\n    last_login datetime DEFAULT NULL COMMENT <span class=\"token string\">'上一次登陆时间'</span><span class=\"token punctuation\">,</span>\n    user_register_time datetime DEFAULT NULL COMMENT <span class=\"token string\">'用户注册时间'</span>\n\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第2关：数据库表设计 - 核心表</p>\n<pre><code class=\"prism language-lua\">use blog_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `t_user` <span class=\"token punctuation\">(</span>\n  `userId` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'用户ID'</span><span class=\"token punctuation\">,</span>\n  `username` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'用户名'</span><span class=\"token punctuation\">,</span>\n  `password` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'用户密码'</span><span class=\"token punctuation\">,</span>\n  `user_sex` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'用户性别'</span><span class=\"token punctuation\">,</span>\n  `email` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'用户邮箱'</span><span class=\"token punctuation\">,</span>\n  `phone` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'手机号码'</span><span class=\"token punctuation\">,</span>\n  `firstname` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'姓'</span><span class=\"token punctuation\">,</span>\n  `lastname` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'名'</span><span class=\"token punctuation\">,</span>\n  `avatar` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'头像地址'</span><span class=\"token punctuation\">,</span>\n  `is_superuser` int NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'是否是管理员 1代表 是 0代表不是'</span><span class=\"token punctuation\">,</span>\n  `last_login` datetime DEFAULT NULL COMMENT <span class=\"token string\">'上一次登录时间'</span><span class=\"token punctuation\">,</span>\n  `user_register_time` datetime DEFAULT NULL COMMENT <span class=\"token string\">'用户注册时间'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>创建blog_type、t_blog、t_comment表，并建立表之间的关系\nCREATE TABLE `blog_type` <span class=\"token punctuation\">(</span>\n  `type_id` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'类型ID'</span><span class=\"token punctuation\">,</span>\n  `type_name` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'类型名称'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"token operator\">=</span><span class=\"token number\">4</span> DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\nCREATE TABLE `t_blog` <span class=\"token punctuation\">(</span>\n  `blog_id` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'博客ID'</span><span class=\"token punctuation\">,</span>\n  `blog_title` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'博客标题'</span><span class=\"token punctuation\">,</span>\n  `blog_content` longtext NOT NULL COMMENT <span class=\"token string\">'博客内容'</span><span class=\"token punctuation\">,</span>\n  `userid` bigint DEFAULT NULL COMMENT <span class=\"token string\">'创建人ID'</span><span class=\"token punctuation\">,</span>\n  `type_id` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'类型ID'</span><span class=\"token punctuation\">,</span>\n  `blog_status` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'博客状态 1为发布 0为草稿'</span><span class=\"token punctuation\">,</span>\n  `create_time` datetime NOT NULL COMMENT <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span>\n  `update_time` datetime NOT NULL COMMENT <span class=\"token string\">'更新时间'</span><span class=\"token punctuation\">,</span>\n  `cover_image` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'封面图片'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_type_id` <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_user_id` <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_type_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span> REFERENCES `blog_type` <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_user_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span> REFERENCES `t_user` <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"token operator\">=</span><span class=\"token number\">27</span> DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\nCREATE TABLE `t_comment` <span class=\"token punctuation\">(</span>\n  `comment_id` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'评论id'</span><span class=\"token punctuation\">,</span>\n  `comment_content` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'评论内容'</span><span class=\"token punctuation\">,</span>\n  `blog_id` bigint NOT NULL COMMENT <span class=\"token string\">'博客ID'</span><span class=\"token punctuation\">,</span>\n  `createtime` datetime NOT NULL COMMENT <span class=\"token string\">'评论时间'</span><span class=\"token punctuation\">,</span>\n  `userid` bigint NOT NULL COMMENT <span class=\"token string\">'评论人ID'</span><span class=\"token punctuation\">,</span>\n  `replyid` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`comment_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_comment_blog_id` <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_comment_user_id` <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_comment_blog_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span> REFERENCES `t_blog` <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_comment_user_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span> REFERENCES `t_user` <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：数据库表设计 - 博客标签表</p>\n<pre><code class=\"prism language-lua\">use blog_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `t_user` <span class=\"token punctuation\">(</span>\n  `userId` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'用户ID'</span><span class=\"token punctuation\">,</span>\n  `username` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'用户名'</span><span class=\"token punctuation\">,</span>\n  `password` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'用户密码'</span><span class=\"token punctuation\">,</span>\n  `user_sex` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'用户性别'</span><span class=\"token punctuation\">,</span>\n  `email` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'用户邮箱'</span><span class=\"token punctuation\">,</span>\n  `phone` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'手机号码'</span><span class=\"token punctuation\">,</span>\n  `firstname` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'姓'</span><span class=\"token punctuation\">,</span>\n  `lastname` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'名'</span><span class=\"token punctuation\">,</span>\n  `avatar` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'头像地址'</span><span class=\"token punctuation\">,</span>\n  `is_superuser` int NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'是否是管理员 1代表 是 0代表不是'</span><span class=\"token punctuation\">,</span>\n  `last_login` datetime DEFAULT NULL COMMENT <span class=\"token string\">'上一次登录时间'</span><span class=\"token punctuation\">,</span>\n  `user_register_time` datetime DEFAULT NULL COMMENT <span class=\"token string\">'用户注册时间'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nCREATE TABLE `blog_type` <span class=\"token punctuation\">(</span>\n  `type_id` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'类型ID'</span><span class=\"token punctuation\">,</span>\n  `type_name` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'类型名称'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"token operator\">=</span><span class=\"token number\">4</span> DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\n\nCREATE TABLE `t_blog` <span class=\"token punctuation\">(</span>\n  `blog_id` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'博客ID'</span><span class=\"token punctuation\">,</span>\n  `blog_title` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'博客标题'</span><span class=\"token punctuation\">,</span>\n  `blog_content` longtext NOT NULL COMMENT <span class=\"token string\">'博客内容'</span><span class=\"token punctuation\">,</span>\n  `userid` bigint DEFAULT NULL COMMENT <span class=\"token string\">'创建人ID'</span><span class=\"token punctuation\">,</span>\n  `type_id` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'类型ID'</span><span class=\"token punctuation\">,</span>\n  `blog_status` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL DEFAULT <span class=\"token string\">'0'</span> COMMENT <span class=\"token string\">'博客状态 1为发布 0为草稿'</span><span class=\"token punctuation\">,</span>\n  `create_time` datetime NOT NULL COMMENT <span class=\"token string\">'创建时间'</span><span class=\"token punctuation\">,</span>\n  `update_time` datetime NOT NULL COMMENT <span class=\"token string\">'更新时间'</span><span class=\"token punctuation\">,</span>\n  `cover_image` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> DEFAULT NULL COMMENT <span class=\"token string\">'封面图片'</span><span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_type_id` <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_user_id` <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_type_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span> REFERENCES `blog_type` <span class=\"token punctuation\">(</span>`type_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_user_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span> REFERENCES `t_user` <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"token operator\">=</span><span class=\"token number\">27</span> DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\n\nCREATE TABLE `t_comment` <span class=\"token punctuation\">(</span>\n  `comment_id` bigint NOT NULL AUTO_INCREMENT COMMENT <span class=\"token string\">'评论id'</span><span class=\"token punctuation\">,</span>\n  `comment_content` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span> NOT NULL COMMENT <span class=\"token string\">'评论内容'</span><span class=\"token punctuation\">,</span>\n  `blog_id` bigint NOT NULL COMMENT <span class=\"token string\">'博客ID'</span><span class=\"token punctuation\">,</span>\n  `createtime` datetime NOT NULL COMMENT <span class=\"token string\">'评论时间'</span><span class=\"token punctuation\">,</span>\n  `userid` bigint NOT NULL COMMENT <span class=\"token string\">'评论人ID'</span><span class=\"token punctuation\">,</span>\n  `replyid` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n  PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`comment_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_comment_blog_id` <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  KEY `FK_comment_user_id` <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_comment_blog_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span> REFERENCES `t_blog` <span class=\"token punctuation\">(</span>`blog_id`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  CONSTRAINT `FK_comment_user_id` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`userid`<span class=\"token punctuation\">)</span> REFERENCES `t_user` <span class=\"token punctuation\">(</span>`userId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> ENGINE<span class=\"token operator\">=</span>InnoDB DEFAULT CHARSET<span class=\"token operator\">=</span>utf8<span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>创建博客标签表（t_tag），并建立表之间的关系\ncreate table <span class=\"token function\">t_tag</span><span class=\"token punctuation\">(</span>\n    tag_id int primary key AUTO_INCREMENT<span class=\"token punctuation\">,</span>\n    tag_name <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">not</span> null\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncreate table <span class=\"token function\">t_tag_blog</span><span class=\"token punctuation\">(</span>\n    tag_id int<span class=\"token punctuation\">,</span>\n    blog_id bigint<span class=\"token punctuation\">,</span>\n    constraint FK_blog_id foreign <span class=\"token function\">key</span> <span class=\"token punctuation\">(</span>tag_id<span class=\"token punctuation\">)</span> references <span class=\"token function\">t_tag</span><span class=\"token punctuation\">(</span>tag_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    constraint FK_tag_id foreign <span class=\"token function\">key</span> <span class=\"token punctuation\">(</span>blog_id<span class=\"token punctuation\">)</span> references <span class=\"token function\">t_blog</span><span class=\"token punctuation\">(</span>blog_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"__JDBC__1667\"></a>数据库开发基础案例 - JDBC 技术应用</h3>\n<p>第1关：数据库连接与数据库实例创建</p>\n<pre><code class=\"prism language-lua\">    package step1<span class=\"token punctuation\">;</span>\n    import java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\n    import java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\n    import java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\n    import java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\n    import java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\n    public class <span class=\"token function\">MySQLWithJDBC</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token operator\">//</span>指定数据库驱动\n        static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span>设定本地数据库的URL，并指定编码方式为UTF<span class=\"token operator\">-</span><span class=\"token number\">8</span>且关闭SSL连接\n        static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n        static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span> 创建数据库实例\n        public void <span class=\"token function\">createDatabaseInstance</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String databaseName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span> \n        Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span> 请补全下面创建数据库实例的SQL语句sqlScript\n        String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"create database \"</span> <span class=\"token operator\">+</span> databaseName<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n            stmt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Statement<span class=\"token punctuation\">)</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n        public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">//</span> 注册JDBC驱动\n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token operator\">//</span> 创建于指定数据库的连接\n                connection <span class=\"token operator\">=</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span>删除数据库\n        public void <span class=\"token function\">dropDatabase</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String databaseName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>           \n            String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"drop database if exists \"</span> <span class=\"token operator\">+</span> databaseName<span class=\"token punctuation\">;</span> \n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                stmt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Statement<span class=\"token punctuation\">)</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span> 获取数据库中已经存在的数据库实例\n        public  ResultSet <span class=\"token function\">getExistDB</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String databaseName<span class=\"token punctuation\">)</span> throws <span class=\"token function\">SQLException</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            ResultSet resultSet <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n            String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM information_schema.SCHEMATA where SCHEMA_NAME=\\\"\"</span>  <span class=\"token operator\">+</span> databaseName <span class=\"token operator\">+</span> <span class=\"token string\">\"\\\"\"</span><span class=\"token punctuation\">;</span> \n            <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>        \n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                stmt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Statement<span class=\"token punctuation\">)</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                resultSet <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> resultSet<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第2关：数据表的创建`</p>\n<pre><code class=\"prism language-lua\">package step2<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>FileInputStream<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>InputStream<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>ArrayList<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>List<span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">CreateTable</span> <span class=\"token punctuation\">{<!-- --></span>\n       <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n       static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n       static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n       static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n       static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>\n        <span class=\"token operator\">*</span> 在指定数据库中创建以tableName命名的表\n        <span class=\"token operator\">*</span> @param connection  mysql连接对象\n        <span class=\"token operator\">*</span> @param tableName   数据表名\n        <span class=\"token operator\">*</span> @param tableInfo   存放表的字段及其属性的二维数组，如tableInfo<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>代表第k个字段名，tableInfo<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>代表第k个字段的属性\n        <span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n       public  void <span class=\"token function\">createTable</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String tableName<span class=\"token punctuation\">,</span>String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> tableInfo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n          Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n          <span class=\"token operator\">//</span>请在此处补全创建表的SQL语句，不要改动其他代码\n          <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n          String sqlScript <span class=\"token operator\">=</span>  <span class=\"token string\">\"create table \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\"(\\n\"</span><span class=\"token punctuation\">;</span>\n              <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>int k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k<span class=\"token operator\">&lt;</span>tableInfo<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> k<span class=\"token operator\">+</span><span class=\"token operator\">+</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tableInfo<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        sqlScript <span class=\"token operator\">=</span> sqlScript <span class=\"token operator\">+</span> tableInfo<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> tableInfo<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\",\\n\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        sqlScript <span class=\"token operator\">=</span> sqlScript<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> sqlScript<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        sqlScript <span class=\"token operator\">=</span> sqlScript <span class=\"token operator\">+</span> <span class=\"token string\">\")\"</span><span class=\"token punctuation\">;</span>    \n          <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n          <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n               <span class=\"token operator\">//</span>创建查询语句对象\n               stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n               <span class=\"token operator\">//</span>执行查询\n               stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n               e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n       public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n           Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n           <span class=\"token operator\">//</span>注册JDBC驱动\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                 Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                 e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token operator\">//</span>创建于指定数据库的连接\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                 connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">//</span>获取databaseNames数据库中的tablenName表\n      public ResultSet <span class=\"token function\">getExistTable</span><span class=\"token punctuation\">(</span>Connection conn<span class=\"token punctuation\">,</span>String databaseName<span class=\"token punctuation\">,</span>String tableName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n           ResultSet resultSet <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n           Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n           String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from INFORMATION_SCHEMA.TABLES where TABLE_SCHEMA=\\'\"</span> <span class=\"token operator\">+</span>databaseName  <span class=\"token operator\">+</span> \n           <span class=\"token string\">\"\\' and TABLE_NAME=\\'\"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">;</span> \n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                stmt <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Statement<span class=\"token punctuation\">)</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                resultSet <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token keyword\">return</span> resultSet<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">//</span>加载sql脚本\n      List<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span> <span class=\"token function\">loadSql</span><span class=\"token punctuation\">(</span>String sqlFile<span class=\"token punctuation\">)</span> throws <span class=\"token function\">Exception</span> <span class=\"token punctuation\">{<!-- --></span>\n          List<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span> sqlList <span class=\"token operator\">=</span> new ArrayList<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n               InputStream sqlFileIn <span class=\"token operator\">=</span> new <span class=\"token function\">FileInputStream</span><span class=\"token punctuation\">(</span>sqlFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n               StringBuffer sqlSb <span class=\"token operator\">=</span> new <span class=\"token function\">StringBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n               byte<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> new byte<span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n               int byteRead <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n               <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>byteRead <span class=\"token operator\">=</span> sqlFileIn<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> !<span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                  sqlSb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>new <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> byteRead<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             <span class=\"token punctuation\">}</span> <span class=\"token operator\">//</span> Windows 下换行是 \\r\\n<span class=\"token punctuation\">,</span> Linux 下是 \\n \n             String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> sqlArr <span class=\"token operator\">=</span> sqlSb<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"(;\\\\s*\\\\r\\\\n)(;\\\\s*\\\\n)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>int i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> sqlArr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">+</span><span class=\"token operator\">+</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                String sql <span class=\"token operator\">=</span> sqlArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">replaceAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--.*\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>!sql<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                    sqlList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n             <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> sqlList<span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>Exception ex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            throw new <span class=\"token function\">Exception</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第3关：数据查询操作</p>\n<pre><code class=\"prism language-lua\">package step3<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">QueryRecord</span> <span class=\"token punctuation\">{<!-- --></span>    \n    <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n    static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n    static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n     <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n    static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n    static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>\n     <span class=\"token operator\">*</span>在tableName中查询出书名为bookName的出版社\n     <span class=\"token operator\">*</span> @param Connection  数据库连接\n     <span class=\"token operator\">*</span> @param tableName   数据表名\n     <span class=\"token operator\">*</span> @param bookName    书名\n    <span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n    public ResultSet <span class=\"token function\">queryPublisherByBookName</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String tableName<span class=\"token punctuation\">,</span>String bookName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">//</span> 请补全下面的查询表的SQL查询命令\n    String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select distinct(publisher) from \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" where title = \\'\"</span> <span class=\"token operator\">+</span> bookName <span class=\"token operator\">+</span> <span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n        stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n    public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n       Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span>注册JDBC驱动\n       <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n             e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">//</span>创建于指定数据库的连接\n       <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n            connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第4关：数据库的插入操作</p>\n<pre><code class=\"prism language-lua\">package step4<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>FileInputStream<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>InputStream<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>ArrayList<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>Arrays<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>List<span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">InsertTable</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n    static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n    static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql://localhost/bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n    static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n    static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>\n     <span class=\"token operator\">*</span> 向指定表中插入数据\n     <span class=\"token operator\">*</span> @param connection 数据库连接对象\n     <span class=\"token operator\">*</span> @param id         记录的id\n     <span class=\"token operator\">*</span> @param title      书名\n     <span class=\"token operator\">*</span> @param author     作者\n     <span class=\"token operator\">*</span> @param publisher  出版社\n     <span class=\"token operator\">*</span> @param year       出版年份\n    <span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n    public void <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> int id<span class=\"token punctuation\">,</span> String title<span class=\"token punctuation\">,</span> String author<span class=\"token punctuation\">,</span> String publisher<span class=\"token punctuation\">,</span> int year<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n         <span class=\"token operator\">//</span>在此添加插入数据的操作\n         Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n         String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"Insert into book(id,title,author,publisher,publishYear)\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\" values\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"(\"</span> <span class=\"token operator\">+</span> id <span class=\"token operator\">+</span><span class=\"token string\">\",\"</span> <span class=\"token operator\">+</span><span class=\"token string\">\"\\'\"</span> <span class=\"token operator\">+</span> title<span class=\"token operator\">+</span> <span class=\"token string\">\"\\',\\'\"</span> <span class=\"token operator\">+</span> author <span class=\"token operator\">+</span> <span class=\"token string\">\"\\',\\'\"</span> <span class=\"token operator\">+</span> publisher <span class=\"token operator\">+</span> <span class=\"token string\">\"\\',\\'\"</span> <span class=\"token operator\">+</span> year <span class=\"token operator\">+</span> <span class=\"token string\">\"\\')\"</span><span class=\"token punctuation\">;</span>\n         <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n    public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n       Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n       <span class=\"token operator\">//</span>注册JDBC驱动\n       <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">//</span>创建于指定数据库的连接\n       <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n            connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n    public ResultSet <span class=\"token function\">queryDB</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span>String tableName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" order by id desc\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n             e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    List<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span> <span class=\"token function\">loadSql</span><span class=\"token punctuation\">(</span>String sqlFile<span class=\"token punctuation\">)</span> throws <span class=\"token function\">Exception</span> <span class=\"token punctuation\">{<!-- --></span>\n        List<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span> sqlList <span class=\"token operator\">=</span> new ArrayList<span class=\"token operator\">&lt;</span>String<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n            InputStream sqlFileIn <span class=\"token operator\">=</span> new <span class=\"token function\">FileInputStream</span><span class=\"token punctuation\">(</span>sqlFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            StringBuffer sqlSb <span class=\"token operator\">=</span> new <span class=\"token function\">StringBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            byte<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> buff <span class=\"token operator\">=</span> new byte<span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            int byteRead <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>byteRead <span class=\"token operator\">=</span> sqlFileIn<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> !<span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                sqlSb<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>new <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>buff<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> byteRead<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token operator\">//</span> Windows 下换行是 \\r\\n<span class=\"token punctuation\">,</span> Linux 下是 \\n \n            String<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> sqlArr <span class=\"token operator\">=</span> sqlSb<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"(;\\\\s*\\\\r\\\\n)(;\\\\s*\\\\n)\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>int i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> sqlArr<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">+</span><span class=\"token operator\">+</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                String sql <span class=\"token operator\">=</span> sqlArr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">replaceAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"--.*\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>!sql<span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                    sqlList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> sqlList<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>Exception ex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            throw new <span class=\"token function\">Exception</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第5关：数据表的删除操作</p>\n<pre><code class=\"prism language-lua\">package step5<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span>File<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">DeleteRecord</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n        static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n        static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n        static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>\n         <span class=\"token operator\">*</span> 根据作者名删除某条记录\n         <span class=\"token operator\">*</span> @param connection 数据库连接\n         <span class=\"token operator\">*</span> @param tableName  数据表名\n         <span class=\"token operator\">*</span> @param author     作者名\n         <span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n        public int <span class=\"token function\">deleteRecordByAuthor</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String tableName<span class=\"token punctuation\">,</span>String author<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span> \n    <span class=\"token operator\">//</span> 请在此处添加数据库删除记录的实现代码\n    Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    int updatedNum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">//</span> 删除数据表中数据的SQL语句\n    String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"delete from \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" where author = \\'\"</span> <span class=\"token operator\">+</span> author <span class=\"token operator\">+</span><span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n        stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        updatedNum <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> updatedNum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n        public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n           Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n           <span class=\"token operator\">//</span>注册JDBC驱动\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token operator\">//</span>创建于指定数据库的连接\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span>查询数据库                    \n        public ResultSet <span class=\"token function\">queryDB</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span>String tableName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" order by id desc\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                 stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                 e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第6关：数据表的更新操作</p>\n<pre><code class=\"prism language-lua\">package step6<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>     \nimport org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>tools<span class=\"token punctuation\">.</span>ant<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>     \nimport org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>tools<span class=\"token punctuation\">.</span>ant<span class=\"token punctuation\">.</span>taskdefs<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>     \nimport org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>tools<span class=\"token punctuation\">.</span>ant<span class=\"token punctuation\">.</span>types<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">UpdateRecord</span> <span class=\"token punctuation\">{<!-- --></span>\n       <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n       static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n       static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n       static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n       static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n           <span class=\"token operator\">/</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span>\n            <span class=\"token operator\">*</span> 更新数据库表中的数据\n         <span class=\"token operator\">*</span> @param connection 数据库连接\n         <span class=\"token operator\">*</span> @param tableName  数据库表名\n         <span class=\"token operator\">*</span> @param title      书名\n         <span class=\"token operator\">*</span> @param publisher  出版社\n         <span class=\"token operator\">*</span><span class=\"token operator\">/</span>    \n       public int <span class=\"token function\">updatePublisherByTitle</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span>String tableName<span class=\"token punctuation\">,</span> String title<span class=\"token punctuation\">,</span> String publisher<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token operator\">//</span>请在此处实现数据更新功能\n    Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n    int updatedNum<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"update \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" set publisher=\\'\"</span> <span class=\"token operator\">+</span> publisher <span class=\"token operator\">+</span> <span class=\"token string\">\"\\'where title=\\'\"</span> <span class=\"token operator\">+</span> title <span class=\"token operator\">+</span> <span class=\"token string\">\"\\'\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n        stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        updatedNum <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> updatedNum<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n       public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n           Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n           <span class=\"token operator\">//</span>注册JDBC驱动\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                 Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                 e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token operator\">//</span>创建于指定数据库的连接\n           <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n           <span class=\"token punctuation\">}</span>\n           <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n       <span class=\"token operator\">//</span>查询数据库\n       public ResultSet <span class=\"token function\">queryDB</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span>String tableName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n            String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from \"</span> <span class=\"token operator\">+</span> tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" order by id desc\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n                 stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                 result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                 e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>第7关：数据库的应用`</p>\n<pre><code class=\"prism language-lua\">package step7<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Connection<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>DriverManager<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>ResultSet<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>SQLException<span class=\"token punctuation\">;</span>\nimport java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span>Statement<span class=\"token punctuation\">;</span>\nimport javax<span class=\"token punctuation\">.</span>naming<span class=\"token punctuation\">.</span>spi<span class=\"token punctuation\">.</span>DirStateFactory<span class=\"token punctuation\">.</span>Result<span class=\"token punctuation\">;</span>\npublic class <span class=\"token function\">TransferTable</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token operator\">//</span> 设定JDBC驱动以及本地数据库的URL\n    static final String JDBC_DRIVER <span class=\"token operator\">=</span> <span class=\"token string\">\"com.mysql.jdbc.Driver\"</span><span class=\"token punctuation\">;</span>  \n    static final String DB_URL <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql:///bookstore?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">//</span> 指定数据库的用户名和密码\n    static final String USER <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n    static final String PASS <span class=\"token operator\">=</span> <span class=\"token string\">\"123123\"</span><span class=\"token punctuation\">;</span>\n    public void <span class=\"token function\">transferTable</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String tableName<span class=\"token punctuation\">)</span> throws <span class=\"token function\">SQLException</span><span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token operator\">//</span>请在此将转换表结构的函数补充完整。\n  ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n  Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n  String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from \"</span> <span class=\"token operator\">+</span>    tableName <span class=\"token operator\">+</span> <span class=\"token string\">\" order by id desc\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n      stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n     e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n String sqlInsert <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into transformedBook (id,column_name,value) values (\"</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n         String sql <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n         String id <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         String title<span class=\"token operator\">=</span>result<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>title !<span class=\"token operator\">=</span> null<span class=\"token punctuation\">)</span>\n       <span class=\"token punctuation\">{<!-- --></span>\n         sql <span class=\"token operator\">=</span> sqlInsert <span class=\"token operator\">+</span> id <span class=\"token operator\">+</span> <span class=\"token string\">\",'\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"title\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span>  title <span class=\"token operator\">+</span> <span class=\"token string\">\"');\"</span><span class=\"token punctuation\">;</span>\n         <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>connection<span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token punctuation\">}</span>\n      String author <span class=\"token operator\">=</span>     result<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"author\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>author !<span class=\"token operator\">=</span> null<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{<!-- --></span>\n        sql <span class=\"token operator\">=</span> sqlInsert <span class=\"token operator\">+</span> id <span class=\"token operator\">+</span> <span class=\"token string\">\",'\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"author\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span>  author <span class=\"token operator\">+</span> <span class=\"token string\">\"');\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>connection<span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n     String publisher <span class=\"token operator\">=</span>  result<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"publisher\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>publisher !<span class=\"token operator\">=</span> null<span class=\"token punctuation\">)</span>\n     <span class=\"token punctuation\">{<!-- --></span>\n       sql <span class=\"token operator\">=</span> sqlInsert <span class=\"token operator\">+</span> id <span class=\"token operator\">+</span> <span class=\"token string\">\",'\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"publisher\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span>  publisher <span class=\"token operator\">+</span> <span class=\"token string\">\"');\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>connection<span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n     String publishYear <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"publishYear\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>publishYear !<span class=\"token operator\">=</span> null<span class=\"token punctuation\">)</span>\n     <span class=\"token punctuation\">{<!-- --></span>\n       sql <span class=\"token operator\">=</span> sqlInsert <span class=\"token operator\">+</span> id <span class=\"token operator\">+</span> <span class=\"token string\">\",'\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"publishYear\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span>  publishYear <span class=\"token operator\">+</span> <span class=\"token string\">\"');\"</span><span class=\"token punctuation\">;</span>\n       <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>connection<span class=\"token punctuation\">,</span> sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n     <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>    \n    <span class=\"token operator\">//</span>插入数据\n    public void <span class=\"token function\">InsertRecord</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span>String sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n             e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">//</span>查询数据库\n    public ResultSet <span class=\"token function\">queryDB</span><span class=\"token punctuation\">(</span>Connection connection<span class=\"token punctuation\">,</span> String tableName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        Statement stmt <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        ResultSet result <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        String sqlScript <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from \"</span> <span class=\"token operator\">+</span> tableName<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             stmt <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createStatement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             result <span class=\"token operator\">=</span> stmt<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span>sqlScript<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">//</span> 建立与指定数据库的连接，并返回该连接\n    public Connection <span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>String jdbc_driver<span class=\"token punctuation\">,</span> String db_url<span class=\"token punctuation\">,</span> String db_user<span class=\"token punctuation\">,</span> String db_passwd<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        Connection connection <span class=\"token operator\">=</span> null<span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">//</span>注册JDBC驱动\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             Class<span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span>jdbc_driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>ClassNotFoundException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n             e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">//</span>创建于指定数据库的连接\n        <span class=\"token function\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n             connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>Connection<span class=\"token punctuation\">)</span> DriverManager<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>db_url<span class=\"token punctuation\">,</span> db_user<span class=\"token punctuation\">,</span> db_passwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token function\">catch</span> <span class=\"token punctuation\">(</span>SQLException e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n             e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> connection<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"__PythonWeb_2237\"></a>数据库开发中级案例 - PythonWeb框架应用</h3>\n<p><strong>本关有部分试题有出现多个代码界面，主义需要切换界面</strong><br/> 第1关：查询操作<br/> step 1/config.py</p>\n<pre><code class=\"prism language-lua\">class <span class=\"token function\">Config</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>连接数据库\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    SQLALCHEMY_DATABASE_URI <span class=\"token operator\">=</span> <span class=\"token string\">\"mysql+pymysql://root:123123@localhost:3306/web\"</span> \n    SQLALCHEMY_TRACK_MODIFICATIONS <span class=\"token operator\">=</span> True\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>step 1/models.py</p>\n<pre><code class=\"prism language-lua\">from app import db\nclass <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>表模型\n    <span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    id <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">,</span>primary_key<span class=\"token operator\">=</span>True<span class=\"token punctuation\">)</span>\n    ct <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">)</span>\n    provincename <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cityname <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>step1/test.py</p>\n<pre><code class=\"prism language-lua\">from app import db<span class=\"token punctuation\">,</span>app\nfrom models import Message\nfrom flask import render_template\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/select\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    pro <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">order_by</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">.</span>ct<span class=\"token punctuation\">.</span><span class=\"token function\">desc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    city <span class=\"token operator\">=</span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>lambda x<span class=\"token punctuation\">:</span> x<span class=\"token punctuation\">.</span>cityname<span class=\"token punctuation\">,</span> pro<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    count <span class=\"token operator\">=</span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>lambda x<span class=\"token punctuation\">:</span> x<span class=\"token punctuation\">.</span>ct<span class=\"token punctuation\">,</span> pro<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    province <span class=\"token operator\">=</span> <span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>lambda x<span class=\"token punctuation\">:</span> x<span class=\"token punctuation\">.</span>provincename<span class=\"token punctuation\">,</span> pro<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"index.html\"</span><span class=\"token punctuation\">,</span>city<span class=\"token operator\">=</span>city<span class=\"token punctuation\">,</span>count<span class=\"token operator\">=</span>count<span class=\"token punctuation\">,</span> province<span class=\"token operator\">=</span>province<span class=\"token punctuation\">)</span>\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"home.html\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>debug <span class=\"token operator\">=</span> True<span class=\"token punctuation\">,</span>host<span class=\"token operator\">=</span><span class=\"token string\">'0.0.0.0'</span><span class=\"token punctuation\">,</span>port<span class=\"token operator\">=</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>第2关：增加操作<br/> step2/config.py</p>\n<pre><code class=\"prism language-lua\">class <span class=\"token function\">Config</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>连接数据库\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    SQLALCHEMY_DATABASE_URI <span class=\"token operator\">=</span> <span class=\"token string\">\"mysql+pymysql://root:123123@localhost:3306/web?charset=utf8\"</span> \n    SQLALCHEMY_TRACK_MODIFICATIONS <span class=\"token operator\">=</span> True\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>step 2/models.py</p>\n<pre><code class=\"prism language-lua\">from app import db\nclass <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>表模型\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    id <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">,</span> primary_key<span class=\"token operator\">=</span>True<span class=\"token punctuation\">)</span>\n    ct <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">)</span>\n    provincename <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cityname <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>step2/test.py</p>\n<pre><code class=\"prism language-lua\">from app import app<span class=\"token punctuation\">,</span>db\nfrom models import Message\nfrom flask import Flask<span class=\"token punctuation\">,</span>render_template<span class=\"token punctuation\">,</span>request<span class=\"token punctuation\">,</span>redirect\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/insert'</span><span class=\"token punctuation\">,</span>methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>进行添加操作\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> <span class=\"token operator\">#</span>\n    province <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'province'</span><span class=\"token punctuation\">]</span>\n    city <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'city'</span><span class=\"token punctuation\">]</span>\n    number <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'number'</span><span class=\"token punctuation\">]</span>\n    u <span class=\"token operator\">=</span> <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span>provincename<span class=\"token operator\">=</span>province<span class=\"token punctuation\">,</span>cityname<span class=\"token operator\">=</span>city<span class=\"token punctuation\">,</span>ct<span class=\"token operator\">=</span>number<span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> <span class=\"token operator\">#</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/insert_page\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">insert_page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>跳转至添加页面\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"insert.html\"</span><span class=\"token punctuation\">)</span>\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    listCity <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">order_by</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span><span class=\"token function\">desc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"home.html\"</span><span class=\"token punctuation\">,</span>city_list <span class=\"token operator\">=</span> listCity<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>debug<span class=\"token operator\">=</span>True<span class=\"token punctuation\">,</span>host<span class=\"token operator\">=</span><span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>第3关：删除操作<br/> step3/test.py</p>\n<pre><code class=\"prism language-lua\">from app import db<span class=\"token punctuation\">,</span>app\nfrom models import Message\nfrom flask import render_template<span class=\"token punctuation\">,</span>redirect<span class=\"token punctuation\">,</span>request\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/delete\"</span><span class=\"token punctuation\">,</span>methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>操作数据库得到目标数据，before_number表示删除之前的数量，after_name表示删除之后的数量\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span>\n    message <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">filter_by</span><span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span>\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    listCity <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">order_by</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span><span class=\"token function\">desc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"home.html\"</span><span class=\"token punctuation\">,</span>city_list <span class=\"token operator\">=</span> listCity<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>debug <span class=\"token operator\">=</span> True<span class=\"token punctuation\">,</span>host<span class=\"token operator\">=</span><span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span>port<span class=\"token operator\">=</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>step3/config.py</p>\n<pre><code class=\"prism language-lua\">class <span class=\"token function\">Config</span><span class=\"token punctuation\">(</span>object<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>连接数据库\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n    SQLALCHEMY_DATABASE_URI <span class=\"token operator\">=</span> <span class=\"token string\">\"mysql+pymysql://root:123123@localhost:3306/web?charset=utf8\"</span> \n    SQLALCHEMY_TRACK_MODIFICATIONS <span class=\"token operator\">=</span> True\n    <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>step3/models.py</p>\n<pre><code class=\"prism language-lua\">from app import db\nclass <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>表模型\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    id <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">,</span> primary_key<span class=\"token operator\">=</span>True<span class=\"token punctuation\">)</span>\n    ct <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">)</span>\n    provincename <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    cityname <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第4关：修改操作</p>\n<pre><code class=\"prism language-lua\">from app import app<span class=\"token punctuation\">,</span>db\nfrom models import Message\nfrom flask import render_template\nfrom flask import redirect<span class=\"token punctuation\">,</span>request\nimport pymysql\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/alter\"</span><span class=\"token punctuation\">,</span>methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">alter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span>接收参数，修改数据\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">]</span>\n    province <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'province'</span><span class=\"token punctuation\">]</span>\n    city <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'city'</span><span class=\"token punctuation\">]</span>\n    number <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>form<span class=\"token punctuation\">[</span><span class=\"token string\">'number'</span><span class=\"token punctuation\">]</span>\n    message <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">filter_by</span><span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    message<span class=\"token punctuation\">.</span>provincename <span class=\"token operator\">=</span> province\n    message<span class=\"token punctuation\">.</span>cityname <span class=\"token operator\">=</span> city\n    message<span class=\"token punctuation\">.</span>ct <span class=\"token operator\">=</span> number\n    db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">#</span>修改页面\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/alter_page\"</span><span class=\"token punctuation\">,</span>methods<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'GET'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">alter_page</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    id <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span>\n    province <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"provincename\"</span><span class=\"token punctuation\">)</span>\n    cityname <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cityname\"</span><span class=\"token punctuation\">)</span>\n    ct <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ct\"</span><span class=\"token punctuation\">)</span>\n    message <span class=\"token operator\">=</span> <span class=\"token function\">Message</span><span class=\"token punctuation\">(</span>id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">,</span>provincename<span class=\"token operator\">=</span>province<span class=\"token punctuation\">,</span>cityname<span class=\"token operator\">=</span>cityname<span class=\"token punctuation\">,</span>ct<span class=\"token operator\">=</span>ct<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"alter.html\"</span><span class=\"token punctuation\">,</span>message <span class=\"token operator\">=</span> message<span class=\"token punctuation\">)</span>\n@app<span class=\"token punctuation\">.</span><span class=\"token function\">route</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\ndef <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    listCity <span class=\"token operator\">=</span> Message<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">order_by</span><span class=\"token punctuation\">(</span>Message<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">.</span><span class=\"token function\">desc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">render_template</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"home.html\"</span><span class=\"token punctuation\">,</span>city_list <span class=\"token operator\">=</span> listCity<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span>debug<span class=\"token operator\">=</span>True<span class=\"token punctuation\">,</span> host<span class=\"token operator\">=</span><span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span> port<span class=\"token operator\">=</span><span class=\"token number\">8080</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_ORM_2423\"></a>数据库开发中级案例 -ORM框架应用</h3>\n<p>第1关：使用Flask进行数据库开发</p>\n<pre><code class=\"prism language-lua\">from flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nimport datetime\nimport warnings\nwarnings<span class=\"token punctuation\">.</span><span class=\"token function\">filterwarnings</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ignore\"</span><span class=\"token punctuation\">)</span>\napp <span class=\"token operator\">=</span> <span class=\"token function\">Flask</span><span class=\"token punctuation\">(</span>__name__<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">#</span> 请在此处添加代码，设置数据库连接\n<span class=\"token operator\">#</span> 用户：root\n<span class=\"token operator\">#</span> 密码<span class=\"token punctuation\">:</span><span class=\"token number\">123123</span>\n<span class=\"token operator\">#</span> 连接地址<span class=\"token punctuation\">:</span><span class=\"token number\">127.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span>\n<span class=\"token operator\">#</span> 数据库<span class=\"token punctuation\">:</span>flask_table\n<span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\napp<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">[</span><span class=\"token string\">'SQLALCHEMY_DATABASE_URI'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'mysql://root:123123@127.0.0.1:3306/flask_table'</span>\ndb <span class=\"token operator\">=</span> <span class=\"token function\">SQLAlchemy</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span> 定义模型\nclass <span class=\"token function\">entry_Form</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> 请根据左侧表格字段格式完成模型的编写\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    __tablename__<span class=\"token operator\">=</span><span class=\"token string\">'entry_form'</span>\n    ID <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">,</span>primary_key<span class=\"token operator\">=</span>True<span class=\"token punctuation\">,</span>autoincrement<span class=\"token operator\">=</span>True<span class=\"token punctuation\">)</span>\n    company_name <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>nullable<span class=\"token operator\">=</span>False<span class=\"token punctuation\">)</span>\n    eduLevel_name <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    Entry_time <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Date<span class=\"token punctuation\">,</span>default<span class=\"token operator\">=</span>datetime<span class=\"token punctuation\">.</span><span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token number\">2019</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    jobName <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    salary <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">Column</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">.</span>Integer<span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n    <span class=\"token operator\">#</span> 根据题目要求，请在此处此函数中添加代码，完成函数的编写\n    def <span class=\"token function\">createTable</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n        <span class=\"token operator\">#</span> 删除原有数据库表\n        db<span class=\"token punctuation\">.</span><span class=\"token function\">drop_all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span>根据模型类型创建表\n        db<span class=\"token punctuation\">.</span><span class=\"token function\">create_all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第2关：查询操作</p>\n<pre><code class=\"prism language-lua\">from task import entry_Form\nclass <span class=\"token function\">Test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    def <span class=\"token function\">select_Table</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token operator\">#</span> 请在此处填写代码，并根据左侧编程要求完成本关考核\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n        ap <span class=\"token operator\">=</span> <span class=\"token function\">entry_Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        pro <span class=\"token operator\">=</span> ap<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>entry_Form<span class=\"token punctuation\">.</span>company_name <span class=\"token operator\">==</span> <span class=\"token string\">\"阿里\"</span><span class=\"token punctuation\">,</span> entry_Form<span class=\"token punctuation\">.</span>eduLevel_name <span class=\"token operator\">==</span> <span class=\"token string\">\"硕士\"</span><span class=\"token punctuation\">,</span>\n                      entry_Form<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">&gt;=</span> <span class=\"token number\">20000</span><span class=\"token punctuation\">,</span> entry_Form<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">&lt;=</span> <span class=\"token number\">25000</span><span class=\"token punctuation\">,</span>\n                      entry_Form<span class=\"token punctuation\">.</span>Entry_time <span class=\"token operator\">&gt;=</span> <span class=\"token string\">\"2019-06\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> pro\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：添加操作</p>\n<pre><code class=\"prism language-lua\">import pandas as pd\nfrom  task import  db<span class=\"token punctuation\">,</span>entry_Form\nclass Message<span class=\"token punctuation\">:</span>\n    def <span class=\"token function\">update_table</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token operator\">#</span> 请根据左侧编程要求完成相应的代码填写\n        <span class=\"token operator\">#</span> 文件路径为<span class=\"token string\">\"data.csv\"</span>  模型类 <span class=\"token punctuation\">(</span>已实现<span class=\"token punctuation\">)</span>：entry_Form\n        <span class=\"token operator\">#</span> 数据库表已创建 只需要完成添加操作即可\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n        data <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span><span class=\"token function\">read_csv</span><span class=\"token punctuation\">(</span>r<span class=\"token string\">\"data.csv\"</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">\"utf8\"</span><span class=\"token punctuation\">,</span> sep<span class=\"token operator\">=</span><span class=\"token string\">\"\\t\"</span><span class=\"token punctuation\">)</span>\n        list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> index<span class=\"token punctuation\">,</span> row <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">iterrows</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            user_info <span class=\"token operator\">=</span> <span class=\"token function\">entry_Form</span><span class=\"token punctuation\">(</span>ID <span class=\"token operator\">=</span> row<span class=\"token punctuation\">[</span><span class=\"token string\">'ID'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>company_name<span class=\"token operator\">=</span>row<span class=\"token punctuation\">[</span><span class=\"token string\">'company_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> eduLevel_name<span class=\"token operator\">=</span>row<span class=\"token punctuation\">[</span><span class=\"token string\">'eduLevel_name'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                   Entry_time<span class=\"token operator\">=</span>row<span class=\"token punctuation\">[</span><span class=\"token string\">'Entry_time'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> jobName<span class=\"token operator\">=</span>row<span class=\"token punctuation\">[</span><span class=\"token string\">'jobName'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                   salary<span class=\"token operator\">=</span>row<span class=\"token punctuation\">[</span><span class=\"token string\">'salary'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            list<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>user_info<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span> 添加多条数据\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">add_all</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span> <span class=\"token operator\">#</span> db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>data2<span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第4关：删除操作</p>\n<pre><code class=\"prism language-lua\">from operator import or_\nfrom task import db<span class=\"token punctuation\">,</span>entry_Form\nclass Demo<span class=\"token punctuation\">:</span>\n    def <span class=\"token function\">del_col</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token operator\">#</span> 请在此处填写代码，根据左侧编程要求完成数据的批量删除\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n        user_info <span class=\"token operator\">=</span> <span class=\"token function\">entry_Form</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        user_info<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>entry_Form<span class=\"token punctuation\">.</span>company_name <span class=\"token operator\">==</span><span class=\"token string\">\"华为\"</span><span class=\"token punctuation\">,</span><span class=\"token function\">or_</span><span class=\"token punctuation\">(</span>entry_Form<span class=\"token punctuation\">.</span>jobName <span class=\"token operator\">==</span><span class=\"token string\">\"Java工程师\"</span><span class=\"token punctuation\">,</span>entry_Form<span class=\"token punctuation\">.</span>jobName<span class=\"token operator\">==</span><span class=\"token string\">\"Python工程师\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第5关：修改操作</p>\n<pre><code class=\"prism language-lua\">from task import db<span class=\"token punctuation\">,</span>entry_Form\nclass Demo<span class=\"token punctuation\">:</span>\n    <span class=\"token operator\">#</span> 更新数据函数\n    def <span class=\"token function\">update_Date</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token operator\">#</span> 根据左侧相关知识，完成相关代码实现\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> Begin <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n        user <span class=\"token operator\">=</span> entry_Form<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span><span class=\"token function\">filter_by</span><span class=\"token punctuation\">(</span>ID<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">first</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        user<span class=\"token punctuation\">.</span>salary <span class=\"token operator\">=</span> <span class=\"token number\">30000</span>\n        db<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">#</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span> End <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"___2531\"></a>数据库开发综合案例 - 仓库管理系统设计</h3>\n<p>第1关：数据库表设计 - 核心表创建</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建warehouse表\nuse warehouse_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `warehouse`  <span class=\"token punctuation\">(</span>\n    `warehouseId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `area` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `phone` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建component表\nCREATE TABLE `component`  <span class=\"token punctuation\">(</span>\n    `componentId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `componentName` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `standard` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `price` <span class=\"token function\">double</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `describe` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建supplier表\nCREATE TABLE `supplier`  <span class=\"token punctuation\">(</span>\n    `supplyId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `name` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `address` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `phone` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `account` <span class=\"token function\">bigint</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`supplyId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：数据库表设计 - 项目职员表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建project表\nuse warehouse_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `project`  <span class=\"token punctuation\">(</span>\n    `projectId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `projectBudget` <span class=\"token function\">double</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `commenceDate` datetime NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`projectId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n \n<span class=\"token operator\">#</span>在warehouse_db库中创建employee表\nCREATE TABLE `employee`  <span class=\"token punctuation\">(</span>\n    `employeeId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `name` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `age` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `designation` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `warehouseId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `leaders` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`employeeId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    INDEX `FK_employee_warehouseId`<span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_employee_warehouseId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span> REFERENCES `warehouse` <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：数据库表设计 - 关联表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建supply表\nuse warehouse_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `supply` <span class=\"token punctuation\">(</span>\n    `supplyId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `projectId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `componentId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `supplyCount` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`supplyId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    INDEX `FK_supply_supplyId`<span class=\"token punctuation\">(</span>`supplyId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_supply_supplyId` \n    FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`supplyId`<span class=\"token punctuation\">)</span> REFERENCES `supplier` <span class=\"token punctuation\">(</span>`supplyId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    INDEX `FK_supply_projectId`<span class=\"token punctuation\">(</span>`projectId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_supply_projectId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`projectId`<span class=\"token punctuation\">)</span> REFERENCES `project` <span class=\"token punctuation\">(</span>`projectId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    INDEX `FK_supply_componentId`<span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_supply_componentId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span> REFERENCES `component` <span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>在warehouse_db库中创建repertory表\nCREATE TABLE `repertory`<span class=\"token punctuation\">(</span>\n    `warehouseId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `componentId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `repertoryCount` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n \n    INDEX `FK_repertory_warehouseId`<span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_repertory_warehouseId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span> REFERENCES `warehouse` <span class=\"token punctuation\">(</span>`warehouseId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    INDEX `FK_repertory_component_componentId`<span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_repertory_component_componentId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span> REFERENCES `component` <span class=\"token punctuation\">(</span>`componentId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h3><a id=\"___2629\"></a>数据库开发综合案例 - 图书管理系统设计</h3>\n<p>第1关：数据库表设计 - 图书表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在library_db库中创建books表\nuse library_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `books` <span class=\"token punctuation\">(</span>\n    `bookId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `bookName` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `publicationDate` datetime NOT NULL<span class=\"token punctuation\">,</span>\n    `publisher` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `bookrackId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `roomId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`bookId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第2关：数据库表设计 - 读者表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在library_db库中创建reader表\nuse library_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `reader` <span class=\"token punctuation\">(</span>\n    `borrowBookId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `name` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `age` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `sex` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `address` <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`borrowBookId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：数据库表设计 - 关联表</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在library_db库中创建bookrack表\nuse library_db<span class=\"token punctuation\">;</span>\nCREATE TABLE `bookrack`  <span class=\"token punctuation\">(</span>\n    `bookrackId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `roomId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`bookrackId`<span class=\"token punctuation\">)</span> USING BTREE<span class=\"token punctuation\">,</span>\n    INDEX `FK_bookrack_roomId`<span class=\"token punctuation\">(</span>`roomId`<span class=\"token punctuation\">)</span> USING BTREE<span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_bookrack_bookrackId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`bookrackId`<span class=\"token punctuation\">)</span> REFERENCES `books` <span class=\"token punctuation\">(</span>`bookrackId`<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_bookrack_roomId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`roomId`<span class=\"token punctuation\">)</span> REFERENCES `books` <span class=\"token punctuation\">(</span>`roomId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span>在library_db库中创建borrow表\nCREATE TABLE `borrow` <span class=\"token punctuation\">(</span>\n    `borrowBookId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `bookId` <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    `borrowDate` datetime NOT NULL<span class=\"token punctuation\">,</span>\n    `returnDate` datetime NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`borrowBookId`<span class=\"token punctuation\">)</span> USING BTREE<span class=\"token punctuation\">,</span>\n    KEY `FK_borrow_borrowBookId` <span class=\"token punctuation\">(</span>`borrowBookId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    KEY `FK_borrow_bookId` <span class=\"token punctuation\">(</span>`bookId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_borrow_borrowBookId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`borrowBookId`<span class=\"token punctuation\">)</span> REFERENCES `reader` <span class=\"token punctuation\">(</span>`borrowBookId`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT `FK_borrow_bookId` FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>`bookId`<span class=\"token punctuation\">)</span> REFERENCES `books` <span class=\"token punctuation\">(</span>`bookId`<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<h2><a id=\"4_2697\"></a>数据库4-层次、网状、关系模型实战</h2>\n<h3><a id=\"_2698\"></a>数据模型</h3>\n<p>第1关：关系模型</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在mydb库中创建表\ncreate table <span class=\"token function\">t_player</span><span class=\"token punctuation\">(</span>\n    p_id <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    p_name <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    p_sex <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n   p_num <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n   p_email <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n   PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>p_id<span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncreate table <span class=\"token function\">t_school</span><span class=\"token punctuation\">(</span>\n    s_name <span class=\"token function\">varchar</span> <span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    s_address <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    s_telephone <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    s_email <span class=\"token function\">varchar</span> <span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>s_name<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncreate table <span class=\"token function\">t_product</span><span class=\"token punctuation\">(</span>\n    pr_id <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_name <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_kind <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_link <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_size <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>pr_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncreate table <span class=\"token function\">t_player_product</span><span class=\"token punctuation\">(</span>\n    p_id <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_id <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    pr_grade <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    grade_rates <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_player_product1 FOREIGN KEY <span class=\"token function\">t_player_product</span><span class=\"token punctuation\">(</span>p_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_player</span><span class=\"token punctuation\">(</span>p_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_player_product2 FOREIGN KEY <span class=\"token function\">t_player_product</span><span class=\"token punctuation\">(</span>pr_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_product</span><span class=\"token punctuation\">(</span>pr_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ncreate table <span class=\"token function\">t_school_player</span><span class=\"token punctuation\">(</span>\n    s_name <span class=\"token function\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    p_id <span class=\"token function\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n   CONSTRAINT fk_school_stu1 FOREIGN KEY <span class=\"token function\">t_school_player</span><span class=\"token punctuation\">(</span>s_name<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_school</span><span class=\"token punctuation\">(</span>s_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_school_stu2 FOREIGN KEY <span class=\"token function\">t_school_player</span><span class=\"token punctuation\">(</span>p_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_player</span><span class=\"token punctuation\">(</span>p_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n\n</code></pre>\n<p>第2关：层次模型`</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n<span class=\"token operator\">#</span>在mydb库中创建表并插入数据\nCREATE TABLE <span class=\"token function\">dept</span> <span class=\"token punctuation\">(</span>\n    dept_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> PRIMARY KEY<span class=\"token punctuation\">,</span>\n    dept_name <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    addr <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCREATE TABLE <span class=\"token function\">edu</span> <span class=\"token punctuation\">(</span>\n    edu_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> PRIMARY KEY<span class=\"token punctuation\">,</span>\n    edu_name <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    dept_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">dept</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCREATE TABLE <span class=\"token function\">student</span> <span class=\"token punctuation\">(</span>\n    student_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> PRIMARY KEY<span class=\"token punctuation\">,</span>\n    student_name <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    level_class <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    dept_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">dept</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCREATE TABLE <span class=\"token function\">emp</span> <span class=\"token punctuation\">(</span>\n    emp_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span> PRIMARY KEY<span class=\"token punctuation\">,</span>\n    emp_name <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    title <span class=\"token function\">VARCHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    edu_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    dept_id <span class=\"token function\">CHAR</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>edu_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">edu</span> <span class=\"token punctuation\">(</span>edu_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    FOREIGN <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">dept</span> <span class=\"token punctuation\">(</span>dept_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO dept <span class=\"token function\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'D02'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'计算机'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'R1101'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO edu <span class=\"token function\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'R01'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'数据库'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span><span class=\"token string\">'R02'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'网络'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span><span class=\"token string\">'R03'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'人工智能'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO student <span class=\"token function\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'S0012'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'王明'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'G1'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token punctuation\">(</span><span class=\"token string\">'S0020'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'郑直'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'G2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                   <span class=\"token punctuation\">(</span><span class=\"token string\">'S0199'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'周密'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'G3'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO emp <span class=\"token function\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'E1101'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'何璧'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'教授'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'R01'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span><span class=\"token string\">'E3721'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'刘新'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'讲师'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'R01'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span><span class=\"token string\">'E1234'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'王思'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'教授'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'R03'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">(</span><span class=\"token string\">'E3722'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'付弈'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'助教'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'R03'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'D02'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n<p>第3关：网状模型</p>\n<pre><code class=\"prism language-lua\"><span class=\"token operator\">#</span>请在此添加实现代码\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> Begin <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\nCREATE TABLE <span class=\"token function\">t_student</span> <span class=\"token punctuation\">(</span>\n    s_id <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    s_name <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    s_class <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>s_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCREATE TABLE <span class=\"token function\">t_course</span> <span class=\"token punctuation\">(</span>\n    c_id <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    c_name <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    c_creadit <span class=\"token function\">INT</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    PRIMARY <span class=\"token function\">KEY</span> <span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCREATE TABLE <span class=\"token function\">t_relation</span> <span class=\"token punctuation\">(</span>\n    s_id <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    c_id <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    grade <span class=\"token function\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> NOT NULL<span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_1 FOREIGN KEY <span class=\"token function\">t_relation</span><span class=\"token punctuation\">(</span>s_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_student</span><span class=\"token punctuation\">(</span>s_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    CONSTRAINT fk_2 FOREIGN KEY <span class=\"token function\">t_relation</span><span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span> REFERENCES <span class=\"token function\">t_course</span><span class=\"token punctuation\">(</span>c_id<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO t_student <span class=\"token function\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"S1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"张乐\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"大一\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"S2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"王冲\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"大二\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"S3\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"翠花\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"大一\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO t_course <span class=\"token function\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"数据库\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"C2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"python\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO t_relation <span class=\"token function\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"S1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                             <span class=\"token punctuation\">(</span><span class=\"token string\">\"S1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                             <span class=\"token punctuation\">(</span><span class=\"token string\">\"S2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"B\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                             <span class=\"token punctuation\">(</span><span class=\"token string\">\"S2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C2\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"A-\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                             <span class=\"token punctuation\">(</span><span class=\"token string\">\"S3\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C1\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"C\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span> End <span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span><span class=\"token operator\">#</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 1, "javascript": 1, "java": 0, "sql": 1, "php": 0, "time": "2022-04-23 22:14:07", "summary": "头歌数据库答案特别感谢黄副班、小青提供代码，有问题联系公众号学思则安留言更正其他作业链接数据库数据定义与操作实战数据库初识数据库数据库和表的基本操作一数据库数据库和表的基本操作二数据库单表查询一数据库"}