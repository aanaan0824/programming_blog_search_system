{"blogid": "126046379", "writerAge": "码龄11年", "writerBlogNum": "303", "writerCollect": "5408", "writerComment": "5693", "writerFan": "51950", "writerGrade": "7级", "writerIntegral": "24299", "writerName": "小虚竹", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126046379.jpg", "writerRankTotal": "291", "writerRankWeekly": "34", "writerThumb": "5527", "writerVisitNum": "7835482", "blog_read_count": "10382", "blog_time": "已于 2022-09-01 17:06:27 修改", "blog_title": "猿创征文｜【第4天】SQL快速入门-多表查询（SQL 小虚竹)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>回城传送–》<a href=\"https://blog.csdn.net/shi_hong_fei_hei/category_11929488.html\">《32天SQL筑基》</a><br/> </p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_2\">零、前言</a></li><li><a href=\"#_12\">一、练习题目</a></li><li><a href=\"#SQL_21\">二、SQL思路</a></li><li><ul><li><a href=\"#SQL21_inner_join_22\">子查询：SQL21 浙江大学用户题目回答情况（inner join）</a></li><li><ul><li><a href=\"#_25\">初始化数据</a></li><li><a href=\"#_66\">解法</a></li></ul>\n</li><li><a href=\"#SQL22__98\">链接查询：SQL22 统计每个学校的答过题的用户的平均答题数</a></li><li><ul><li><a href=\"#_102\">初始化数据</a></li><li><a href=\"#_140\">解法</a></li></ul>\n</li><li><a href=\"#SQL23__193\">链接查询：SQL23 统计每个学校各难度的用户平均刷题数</a></li><li><ul><li><a href=\"#_198\">初始化数据</a></li><li><a href=\"#_264\">解法</a></li></ul>\n</li><li><a href=\"#SQL24_inner_join_312\">链接查询：SQL24 统计每个用户的平均刷题数(inner join)</a></li><li><ul><li><a href=\"#_316\">初始化数据</a></li><li><a href=\"#_381\">解法</a></li></ul>\n</li><li><a href=\"#SQL25_union_all_425\">组合查询：SQL25 查找山东大学或者性别为男生的信息(union all)</a></li><li><ul><li><a href=\"#_428\">初始化数据</a></li><li><a href=\"#_493\">解法</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"_2\"></a>零、前言</h1>\n<p>今天是学习 <strong>SQL</strong> 打卡的第 <strong>4</strong> 天，每天我会提供一篇文章供群成员阅读（ <strong>不需要订阅付钱</strong> ）。</p>\n<p>希望大家先自己思考，如果实在没有想法，再看下面的解题思路，自己再实现一遍。在<a href=\"https://bbs.csdn.net/forums/xiaoxuzhu\">小虚竹JAVA社区</a> 中对应的 【打卡贴】打卡，今天的任务就算完成了，养成每天学习打卡的好习惯。</p>\n<p>​ 虚竹哥会组织大家一起学习同一篇文章，所以有什么问题都可以在群里问，群里的小伙伴可以迅速地帮到你，一个人可以走得很快，一群人可以走得很远，有一起学习交流的战友，是多么幸运的事情。</p>\n<p>​ 我的学习策略很简单，题海策略+ 费曼学习法。如果能把这些题都认认真真自己实现一遍，那意味着 <strong>SQL</strong> 已经筑基成功了。后面的进阶学习，可以继续跟着我，一起走向架构师之路。</p>\n<p>今天的学习内容是：<strong>多表查询</strong></p>\n<h1><a id=\"_12\"></a>一、练习题目</h1>\n<table><thead><tr><th>题目链接</th><th>难度</th></tr></thead><tbody><tr><td><a href=\"https://www.nowcoder.com/practice/55f3d94c3f4d47b69833b335867c06c1?tpId=199&amp;tqId=1975673&amp;ru=/exam/oj&amp;qru=/ta/sql-quick-study/question-ranking&amp;sourceUrl=%2Fexam%2Foj%3Ftab%3DSQL%25E7%25AF%2587%26topicId%3D199&amp;fromPut=pc_csdncpt_xxz_sql\">子查询：SQL21 浙江大学用户题目回答情况</a></td><td>★★★☆☆</td></tr><tr><td><a href=\"https://www.nowcoder.com/practice/88aa923a9a674253b861a8fa56bac8e5?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3Ftab%3DSQL%25E7%25AF%2587%26topicId%3D199&amp;fromPut=pc_csdncpt_xxz_sql\">链接查询：SQL22 统计每个学校的答过题的用户的平均答题数</a></td><td>★★★☆☆</td></tr><tr><td><a href=\"https://www.nowcoder.com/practice/5400df085a034f88b2e17941ab338ee8?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3Ftab%3DSQL%25E7%25AF%2587%26topicId%3D199&amp;fromPut=pc_csdncpt_xxz_sql\">链接查询：SQL23 统计每个学校各难度的用户平均刷题数</a></td><td>★★★☆☆</td></tr><tr><td><a href=\"https://www.nowcoder.com/practice/f4714f7529404679b7f8909c96299ac4?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3Ftab%3DSQL%25E7%25AF%2587%26topicId%3D199&amp;fromPut=pc_csdncpt_xxz_sql\">链接查询：SQL24 统计每个用户的平均刷题数</a></td><td>★★★☆☆</td></tr><tr><td><a href=\"https://www.nowcoder.com/practice/979b1a5a16d44afaba5191b22152f64a?tpId=199&amp;tags=&amp;title=&amp;difficulty=0&amp;judgeStatus=0&amp;rp=0&amp;sourceUrl=%2Fexam%2Foj%3Ftab%3DSQL%25E7%25AF%2587%26topicId%3D199&amp;fromPut=pc_csdncpt_xxz_sql\">组合查询：SQL25 查找山东大学或者性别为男生的信息</a></td><td>★★★☆☆</td></tr></tbody></table>\n<h1><a id=\"SQL_21\"></a>二、SQL思路</h1>\n<h2><a id=\"SQL21_inner_join_22\"></a>子查询：SQL21 浙江大学用户题目回答情况（inner join）</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7c4991fb7f274807aea91a3dcdfb9035.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\bc4a8c6a1bf840c2ac20126bffae99d5.png\"/></p>\n<h3><a id=\"_25\"></a>初始化数据</h3>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gender<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>age<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>university<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gpa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>active_days_within_30<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>answer_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>result<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token string\">'浙江大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">4321</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">118</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"_66\"></a>解法</h3>\n<p>要求统计：</p>\n<ul><li>查看所有来自浙江大学的用户</li><li>指定用户题目回答明细情况</li></ul>\n<p>分析：</p>\n<ul><li>user_profile表取university 字段值是浙江大学的数据</li></ul>\n<blockquote>\n<p>SELECT<br/> up.device_id<br/> from user_profile up<br/> where<br/> up.university = ‘浙江大学’</p>\n</blockquote>\n<ul><li>用户表和用户题目回答明细表要关联，可用关键词：<strong>inner join</strong></li></ul>\n<blockquote>\n<p>inner join(等值连接) 只返回两个表中联结字段相等的行<br/> 本题就是user_profile表中的device_id 字段跟question_practice_detail 表中的device_id进行关联</p>\n</blockquote>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span>\n  up<span class=\"token punctuation\">.</span>device_id<span class=\"token punctuation\">,</span>\n  qpd<span class=\"token punctuation\">.</span>question_id<span class=\"token punctuation\">,</span>\n  qpd<span class=\"token punctuation\">.</span>result\n<span class=\"token keyword\">from</span>\n  user_profile up\n  <span class=\"token keyword\">inner</span> <span class=\"token keyword\">join</span> question_practice_detail qpd\n<span class=\"token keyword\">where</span>\n  up<span class=\"token punctuation\">.</span>university <span class=\"token operator\">=</span> <span class=\"token string\">'浙江大学'</span>\n  <span class=\"token operator\">and</span> qpd<span class=\"token punctuation\">.</span>device_id <span class=\"token operator\">=</span> up<span class=\"token punctuation\">.</span>device_id\n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span>\n  qpd<span class=\"token punctuation\">.</span>question_id <span class=\"token keyword\">asc</span>\n</code></pre>\n<h2><a id=\"SQL22__98\"></a>链接查询：SQL22 统计每个学校的答过题的用户的平均答题数</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\8d419521ab9040cba88d4b3b45bd99bf.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b8dcb7b7e51143848de4067f1f2d7e6e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2d0242ba74fc4cc1878a753c3c9c6ccd.png\"/></p>\n<h3><a id=\"_102\"></a>初始化数据</h3>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gender<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>age<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>university<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gpa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>active_days_within_30<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>result<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token string\">'浙江大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4321</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">118</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"_140\"></a>解法</h3>\n<p>要求统计：</p>\n<ul><li>查找每个学校用户的平均答题数目</li><li>某学校用户平均答题数量计算方式为该学校用户答题总次数除以答过题的不同用户个数</li><li>结果保留4位小数</li><li>结果按照university升序排序</li></ul>\n<p>分析：</p>\n<ul><li>查找每个学校用户，这里就是要对user_profile 表中的university字段进行分组排序,使用关键词： <strong>group by</strong></li></ul>\n<blockquote>\n<p>select<br/> u.university<br/> from<br/> user_profile u<br/> group by<br/> u.university</p>\n</blockquote>\n<ul><li>求某学校用户平均答题数量：计算方式为该学校用户答题总次数除以答过题的不同用户个数<br/> 这里要对user_profile 表和question_practice_detail 进行链接，关键词：<strong>inner join on</strong><br/> 链接字段为：device_id</li></ul>\n<blockquote>\n<p>select<br/> u.university,<br/> count(q.question_id) / count(DISTINCT u.device_id) as avg_answer_cnt<br/> from<br/> user_profile u inner join question_practice_detail q on u.device_id = q.device_id<br/> group by<br/> u.university</p>\n</blockquote>\n<ul><li>结果保留4位小数:要对avg_answer_cnt值进行四舍五入，使用关键词：<strong>round(字段/表达式,4)</strong></li></ul>\n<blockquote>\n<p>select<br/> u.university,<br/> round(count(q.question_id) / count(DISTINCT u.device_id),4) as avg_answer_cnt<br/> from<br/> user_profile u inner join question_practice_detail q on u.device_id = q.device_id<br/> group by<br/> u.university</p>\n</blockquote>\n<ul><li>结果按照university升序排序,使用关键词：<strong>order by</strong></li></ul>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">select</span>\n  u<span class=\"token punctuation\">.</span>university<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">.</span>question_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">DISTINCT</span> u<span class=\"token punctuation\">.</span>device_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> avg_answer_cnt\n<span class=\"token keyword\">from</span>\n  user_profile  u\n  <span class=\"token keyword\">inner</span> <span class=\"token keyword\">join</span> question_practice_detail  q <span class=\"token keyword\">on</span> u<span class=\"token punctuation\">.</span>device_id <span class=\"token operator\">=</span> q<span class=\"token punctuation\">.</span>device_id\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span>\n  u<span class=\"token punctuation\">.</span>university\n<span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span>\n  u<span class=\"token punctuation\">.</span>university\n</code></pre>\n<h2><a id=\"SQL23__193\"></a>链接查询：SQL23 统计每个学校各难度的用户平均刷题数</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\15e27615d34f4032a8924aacb37eaabf.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6627a365a31445a0981339dc42c0b40b.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\01002e11dee14218be3906a97d022c0e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b9e1858b456e46e182db7d2d06fb494a.png\"/></p>\n<h3><a id=\"_198\"></a>初始化数据</h3>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gender<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>age<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>university<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gpa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>active_days_within_30<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>answer_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>result<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>difficult_level<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token string\">'浙江大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">4321</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'hard'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"_264\"></a>解法</h3>\n<p>要求统计：</p>\n<ul><li>计算不同学校、不同难度的用户平均答题量</li><li>结果在小数点位数保留4位，4位之后四舍五入</li></ul>\n<p>分析：</p>\n<ul><li>计算不同学校、不同难度的用户平均答题量:结果列有三列：学校，难度，用户平均答题量</li><li>核心是求平均答题量，所以主表是question_practice_detail 。学校，难度可通过链接去关联其它表。</li></ul>\n<blockquote>\n<p>SELECT<br/> u.university,<br/> qd.difficult_level,<br/> avg_answer_cnt<br/> FROM<br/> question_practice_detail qp<br/> left join user_profile u on qp.device_id = u.device_id<br/> left join question_detail qd on qp.question_id = qd.question_id</p>\n</blockquote>\n<ul><li>且要对学校，难度，进行分组</li></ul>\n<blockquote>\n<p>SELECT<br/> u.university,<br/> qd.difficult_level,<br/> avg_answer_cnt<br/> FROM<br/> question_practice_detail qp<br/> left join user_profile u on qp.device_id = u.device_id<br/> left join question_detail qd on qp.question_id = qd.question_id<br/> group by<br/> u.university,<br/> qd.difficult_level</p>\n</blockquote>\n<ul><li>用户平均答题量计算规则：总的题目数/用户数，取均值</li></ul>\n<blockquote>\n<p>count(qp.question_id) / count(distinct qp.device_id) as avg_answer_cnt</p>\n</blockquote>\n<ul><li>均值结果在小数点位数保留4位，4位之后四舍五入，使用关键词：<strong>round(字段/表达式,4)</strong></li></ul>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span>\n  u<span class=\"token punctuation\">.</span>university<span class=\"token punctuation\">,</span>\n  qd<span class=\"token punctuation\">.</span>difficult_level<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>qp<span class=\"token punctuation\">.</span>question_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">distinct</span> qp<span class=\"token punctuation\">.</span>device_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> avg_answer_cnt\n<span class=\"token keyword\">FROM</span>\n  question_practice_detail qp\n  <span class=\"token keyword\">left</span> <span class=\"token keyword\">join</span> user_profile u <span class=\"token keyword\">on</span> qp<span class=\"token punctuation\">.</span>device_id <span class=\"token operator\">=</span> u<span class=\"token punctuation\">.</span>device_id\n  <span class=\"token keyword\">left</span> <span class=\"token keyword\">join</span> question_detail qd <span class=\"token keyword\">on</span> qp<span class=\"token punctuation\">.</span>question_id <span class=\"token operator\">=</span> qd<span class=\"token punctuation\">.</span>question_id\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span>\n  u<span class=\"token punctuation\">.</span>university<span class=\"token punctuation\">,</span>\n  qd<span class=\"token punctuation\">.</span>difficult_level\n</code></pre>\n<h2><a id=\"SQL24_inner_join_312\"></a>链接查询：SQL24 统计每个用户的平均刷题数(inner join)</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\eeff25e229384930a03a1cebae972d92.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\015d89d4747a468cbc0eaf327eceb3e3.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\dfa7062d26c645a2a1fe9e5c24a207ea.png\"/></p>\n<h3><a id=\"_316\"></a>初始化数据</h3>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gender<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>age<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>university<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gpa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>active_days_within_30<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>answer_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>result<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>difficult_level<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token string\">'浙江大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">4321</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'hard'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"_381\"></a>解法</h3>\n<p>要求统计：</p>\n<ul><li>山东大学、不同难度的用户平均答题量</li><li>结果在小数点位数保留4位，4位之后四舍五入</li></ul>\n<p>分析：</p>\n<ul><li>先找山东大学的用户</li></ul>\n<blockquote>\n<p>select<br/> university<br/> from user_profile<br/> where university = ‘山东大学’</p>\n</blockquote>\n<ul><li>不同难度的用户平均答题量</li><li>先对难度进行分组</li></ul>\n<blockquote>\n<p>select<br/> university,<br/> difficult_level,<br/> from user_profile u<br/> inner join question_practice_detail qpd on u.device_id = qpd.device_id<br/> inner join question_detail qd on qpd.question_id = qd.question_id<br/> where university = ‘山东大学’<br/> group by<br/> difficult_level</p>\n</blockquote>\n<ul><li>求用户平均答题量：用户答题题目数/设备Id</li></ul>\n<blockquote>\n<p>count(qpd.question_id) / count(DISTINCT qpd.device_id)</p>\n</blockquote>\n<ul><li>结果在小数点位数保留4位，4位之后四舍五入：用关键词：<strong>round(字段/表达式,4)</strong></li></ul>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">select</span>\n  university<span class=\"token punctuation\">,</span>\n  difficult_level<span class=\"token punctuation\">,</span>\n  <span class=\"token function\">round</span><span class=\"token punctuation\">(</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span>qpd<span class=\"token punctuation\">.</span>question_id<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">DISTINCT</span> qpd<span class=\"token punctuation\">.</span>device_id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> avg_answer_cnt\n<span class=\"token keyword\">from</span>\n  user_profile  u\n  <span class=\"token keyword\">inner</span> <span class=\"token keyword\">join</span> question_practice_detail  qpd <span class=\"token keyword\">on</span> u<span class=\"token punctuation\">.</span>device_id <span class=\"token operator\">=</span> qpd<span class=\"token punctuation\">.</span>device_id\n  <span class=\"token keyword\">inner</span> <span class=\"token keyword\">join</span> question_detail  qd <span class=\"token keyword\">on</span> qpd<span class=\"token punctuation\">.</span>question_id <span class=\"token operator\">=</span> qd<span class=\"token punctuation\">.</span>question_id\n<span class=\"token keyword\">where</span>\n  university <span class=\"token operator\">=</span> <span class=\"token string\">'山东大学'</span>\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span>\n  difficult_level\n</code></pre>\n<h2><a id=\"SQL25_union_all_425\"></a>组合查询：SQL25 查找山东大学或者性别为男生的信息(union all)</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\60563df3dca64b439134841c185ce4e8.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\72a7c7ebd7484a1d8a839f696287f747.png\"/></p>\n<h3><a id=\"_428\"></a>初始化数据</h3>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span>  <span class=\"token keyword\">exists</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>user_profile<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gender<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>age<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>university<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>gpa<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>active_days_within_30<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>answer_cnt<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> \n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_practice_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>device_id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>result<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_detail<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>id<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>question_id<span class=\"token punctuation\">`</span></span><span class=\"token keyword\">int</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span>\n<span class=\"token identifier\"><span class=\"token punctuation\">`</span>difficult_level<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">4.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token string\">'北京大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token string\">'female'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token string\">'浙江大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'山东大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> user_profile <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">4321</span><span class=\"token punctuation\">,</span><span class=\"token string\">'male'</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token string\">'复旦大学'</span><span class=\"token punctuation\">,</span><span class=\"token number\">3.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2138</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3214</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">6543</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token number\">2315</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">2131</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_practice_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span><span class=\"token number\">5432</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'wrong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token string\">'hard'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token string\">'medium'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> question_detail <span class=\"token keyword\">VALUES</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token string\">'easy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"_493\"></a>解法</h3>\n<p>要求统计：</p>\n<ul><li>查看学校为山东大学或者性别为男性的用户的device_id、gender、age和gpa数据</li></ul>\n<p>分析：</p>\n<ul><li>查看学校为山东大学的device_id、gender、age和gpa数据</li></ul>\n<blockquote>\n<p>SELECT device_id,gender,age,gpa<br/> from user_profile<br/> where university=‘山东大学’</p>\n</blockquote>\n<ul><li>性别为男性的用户的device_id、gender、age和gpa数据</li></ul>\n<blockquote>\n<p>SELECT device_id,gender,age,gpa<br/> from user_profile<br/> where gender=‘male’</p>\n</blockquote>\n<p>符合这两个查询的数据都输出，用关键词：<strong>union all</strong></p>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">SELECT</span> device_id<span class=\"token punctuation\">,</span>gender<span class=\"token punctuation\">,</span>age<span class=\"token punctuation\">,</span>gpa\n<span class=\"token keyword\">from</span> user_profile\n<span class=\"token keyword\">where</span> university<span class=\"token operator\">=</span><span class=\"token string\">'山东大学'</span>\n<span class=\"token keyword\">union</span> <span class=\"token keyword\">all</span>\n<span class=\"token keyword\">SELECT</span> device_id<span class=\"token punctuation\">,</span>gender<span class=\"token punctuation\">,</span>age<span class=\"token punctuation\">,</span>gpa\n<span class=\"token keyword\">from</span> user_profile\n<span class=\"token keyword\">where</span> gender<span class=\"token operator\">=</span><span class=\"token string\">'male'</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 0, "time": "2022-09-01 17:06:27", "summary": "回城传送》《天筑基》文章目录零、前言一、练习题目二、思路子查询：浙江大学用户题目回答情况初始化数据解法链接查询：统计每个学校的答过题的用户的平均答题数初始化数据解法链接查询：统计每个学校各难度的用户平"}