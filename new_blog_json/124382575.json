{"blogid": "124382575", "writerAge": "码龄2年", "writerBlogNum": "19", "writerCollect": "108", "writerComment": "9", "writerFan": "12", "writerGrade": "2级", "writerIntegral": "237", "writerName": "SYW#", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124382575.jpg", "writerRankTotal": "56404", "writerRankWeekly": "123541", "writerThumb": "18", "writerVisitNum": "20064", "blog_read_count": "6152", "blog_time": "已于 2022-08-18 16:25:50 修改", "blog_title": "C#学习笔记五——选择文件、文件夹操作", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><strong>工具</strong>：VS2019</p>\n<p><strong>项目类型</strong>：C# Windows 窗体应用(.NET Framework)</p>\n<p><strong>框架</strong>：.NET Framework 4</p>\n<p><strong>控件</strong>：窗体、按钮(Button)、openFileDialog</p>\n<p><strong>功能简述</strong>：点击按钮，弹出选择文件的窗体</p>\n<p><strong>界面</strong>：仅用一个按钮测试功能</p>\n<p><img alt=\"\" height=\"196\" src=\"..\\..\\static\\image\\825627d6ea9a48a0ad03177587db3dd3.png\" width=\"267\"/></p>\n<h1>一、选择文件（利用OpenFileDialog控件）</h1>\n<h2>（一）编辑按钮动作</h2>\n<p>双击按钮，添加以下代码：</p>\n<pre><code class=\"language-cs\">        private void button1_Click(object sender, EventArgs e)\n        {\n            string file = \"\";\n            OpenFileDialog dialog = new OpenFileDialog();\n            dialog.Multiselect = true;      //该值确定是否可以选择多个文件\n            dialog.Title = \"请选择文件\";     //弹窗的标题\n            dialog.InitialDirectory = \"D:\\\\\";       //默认打开的文件夹的位置\n            dialog.Filter = \"MicroSoft Excel文件(*.xlsx)|*.xlsx|所有文件(*.*)|*.*\";       //筛选文件\n            dialog.ShowHelp = true;     //是否显示“帮助”按钮\n            \n            if (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)\n            {\n                file = dialog.FileName;\n            }\n        }</code></pre>\n<p></p>\n<h2></h2>\n<h2><strong> （二）运行效果</strong>：</h2>\n<p>PS：下图是“<strong>dialog.ShowHelp</strong> = false;”情况下的界面</p>\n<p><img alt=\"\" height=\"533\" src=\"..\\..\\static\\image\\ac00fad5ad7443558d9c34820ac252da.png\" width=\"941\"/></p>\n<p></p>\n<h2>（三）部分说明：</h2>\n<h3>（1）dialog.Filter</h3>\n<p><strong>说明</strong>：获取或设置当前文件名过滤字符串，它决定了出现在对话框的“另存为文件类型”或“文件类型”框中的选项。简而言之，就是筛选出你需要的类型的文件。</p>\n<p><img alt=\"\" height=\"237\" src=\"..\\..\\static\\image\\77a6f7b4e6984868b72aeb5b21685ec4.png\" width=\"656\"/></p>\n<p><strong>格式</strong>：（以下举例为引号内的字符格式）</p>\n<p>当筛选的格式类型只有一种时：<strong><span style=\"color:#1c7331;\">所有文件(*.*)|*.*</span> </strong>  或者  <strong><span style=\"color:#1c7331;\">MicroSoft Excel文件(*.xlsx)|*.xlsx</span> </strong></p>\n<p>当筛选的格式&gt;=两种时（中间用“|”隔开）：<span style=\"color:#1c7331;\"><strong>MicroSoft Excel文件(*.xlsx)|*.xlsx|所有文件(*.*)|*.*</strong></span></p>\n<p><img alt=\"\" height=\"95\" src=\"..\\..\\static\\image\\f3e780278267469a88a97af37c7ef8c3.png\" width=\"429\"/></p>\n<p>其中每一种格式内部还有一个“|”，“|”前面是格式的说明（我们能看见的），“|”后面是文件的后缀（是筛选时要用到的后缀名，看不见），效果见下图。</p>\n<p>（注意：“|”后面的后缀千万<strong>不要加多余的空格</strong>）</p>\n<p>（PS：下图运行效果是\"<strong>dialog.ShowHelp</strong> = true;”时的界面）</p>\n<p> <img alt=\"\" height=\"564\" src=\"..\\..\\static\\image\\2d16fd4cfec74fbd810ef4ed207c6728.png\" width=\"673\"/> </p>\n<h1>二、选择文件夹</h1>\n<h2>（一）编辑按钮动作</h2>\n<pre><code class=\"language-cs\">        private void button2_Click(object sender, EventArgs e)\n        {\n            string Path = \"\";\n            FolderBrowserDialog folder = new FolderBrowserDialog();\n            folder.Description = \"选择文件所在文件夹目录\";  //提示的文字\n            if (folder.ShowDialog() == DialogResult.OK)\n            {\n                Path = folder.SelectedPath;\n            }\n        }</code></pre>\n<h2>（二）运行效果</h2>\n<p><img alt=\"\" height=\"517\" src=\"..\\..\\static\\image\\7363d33c9d004648afb9fc073c35435f.png\" width=\"480\"/></p>\n<h1> 三、参考链接</h1>\n<p><a class=\"link-info\" href=\"https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.openfiledialog?view=windowsdesktop-6.0\" title=\"OpenDialog说明\">OpenDialog说明</a></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n</div>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-08-18 16:25:50", "summary": "工具：项目类型：窗体应用框架：控件：窗体、按钮、功能简述：点击按钮，弹出选择文件的窗体界面：仅用一个按钮测试功能一、选择文件利用控件一编辑按钮动作双击按钮，添加以下代码：该值确定是否可以选择多个文件请"}