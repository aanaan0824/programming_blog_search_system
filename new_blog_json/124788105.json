{"blogid": "124788105", "writerAge": "码龄2年", "writerBlogNum": "51", "writerCollect": "53", "writerComment": "5", "writerFan": "15", "writerGrade": "3级", "writerIntegral": "554", "writerName": "ysn学习日记", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124788105.jpg", "writerRankTotal": "38361", "writerRankWeekly": "90473", "writerThumb": "19", "writerVisitNum": "22707", "blog_read_count": "987", "blog_time": "于 2022-05-15 22:18:55 发布", "blog_title": "渗透测试之指纹识别（CMS、CDN、WAF）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"-toc\" style=\"margin-left:80px;\"></p>\n<p id=\"%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">什么是指纹识别：</a></p>\n<p id=\"1%E3%80%81cms%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB-toc\" style=\"margin-left:80px;\"><a href=\"#1%E3%80%81cms%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB\">1、cms指纹识别</a></p>\n<p id=\"2%E3%80%81cdn%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#2%E3%80%81cdn%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">2、cdn指纹识别：</a></p>\n<p id=\"3%E3%80%81waf%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#3%E3%80%81waf%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">3、WAF指纹识别：</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h3 id=\"%E4%BB%80%E4%B9%88%E6%98%AF%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">什么是指纹识别：</h3>\n<p>通过关键特征，识别出目标的CMS系统、服务器、开发语言、操作系统、CDN、WAF的类别 版本等等。</p>\n<p>其中主要识别以下的信息：<br/> 1、CMS信息：比如Discuz、织梦、帝国CMS、PHPCMS、ECshop等；<br/> 2、前端技术：比如HTML5、jquery、bootstrap、Vue、ace等；<br/> 3、开发语言：比如PHP、Java、Ruby、Python、C#等；<br/> 4、Web服务器：比如Apache、 Nginx、IIS、lighttpd等；<br/> 5、应用服务器：比如Tomcat、Jboss、Weblogic、Websphere等；<br/> 6、操作系统信息：比如Linux、win2k8、win7、Kali、Centos等；<br/> 7、CDN信息：是否使用CDN，如cloudflare、帝联、蓝讯、网宿、七 牛云、阿里云等；<br/> 8、WAF信息：是否使用WAF，如D盾、云锁、宝塔、安全狗、360等</p>\n<p>其中cms、cdn、waf的指纹识别比较重要。</p>\n<h3 id=\"1%E3%80%81cms%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB\">1、cms指纹识别</h3>\n<p>什么是cms</p>\n<p>cms是一个内容管理系统，大多数网站的内容都是通过cms来进行内容管理的。<br/> cma包括博客、微博、商城等等。</p>\n<p>这些网站都是基于一系列开源的建站系统建立起来的。比如discuz来建立论坛、worfpress来建立博客网站。</p>\n<p>不同类型的网站都会使用不同的开源cms系统：<br/> 1、 企业建站系统：MetInfo(米拓)、蝉知、SiteServer CMS等;<br/> 2、 B2C商城系统：商派Shopex、ECshop、HiShop、XpShop等;<br/> 3、 门户建站系统：DedeCMS(织梦)、帝国CMS、PHPCMS、动易、 CmsTop等;<br/> 4、 博客系统：WordPress、Z-Blog等;<br/> 5、 论坛社区：Discuz、PHPwind、WeCenter等;<br/> 6、 问答系统：Tipask、whatsns等;<br/> 7、 知识百科系统：HDwiki;<br/> 8、 B2B门户系统：Destoon、B2Bbuilder、友邻B2B等;<br/> 9、 人才招聘网站系统：骑士CMS、PHP云人才管理系统;<br/> l0、 房产网站系统：FangCms等;<br/> l1、 在线教育建站系统：Kesion、EduSoho;<br/> l2、 电影网站系统：苹果CMS、ctcms、movcms等;<br/> l3、 小说文学建站系统：杰奇CMS;</p>\n<p>识别cms</p>\n<p>如果我们打开了一个网站，并且识别出了这个网站用的程序（什么系统什么版本）那么我们就能利用他的漏洞。<br/> 我们需要通过一些特定的文件和代码来识别cms。</p>\n<p>版权信息</p>\n<p>1、根据一个网站的版权信息可以进行了解。<br/><img alt=\"\" height=\"192\" src=\"..\\..\\static\\image\\17c2e341a6fa474e97936a31443cbb7d.png\" width=\"592\"/><br/> 在网站的底部可能会直接有版权信息。</p>\n<p> </p>\n<p>2、点击网页标签查询</p>\n<p><img alt=\"\" height=\"134\" src=\"..\\..\\static\\image\\f9b28660a29648439e5ded9dd8ce83e2.png\" width=\"428\"/></p>\n<p>网站的开发者如果忘记修改title，那么直接点击网站标签就可以看见用了什么cms系统</p>\n<p></p>\n<p>特定文件MD5值</p>\n<p>可以寻找一些特定的md5值来确定网站的cms系统。<br/> 每个文件对应的md5值是固定的，文件内容发生变化时，md5值也会发生变化。文件内容相同时，md5值相同。所以，md5值可以作为文件的唯一标识符。<br/> 所以可以去查询一些不太容易被改变的静态文件来判断是什么系统。</p>\n<p>查看网页源代码</p>\n<p>可以通过右键查询源代码<br/> 通过特定文件特征来分析用了什么系统<br/> 比如wedpress的网站去源代码中查询有很多wp开头的那基本可以确认是使用的是wedpress系统</p>\n<p>通过特定文件分析</p>\n<p>我们也可以去分析一些特定文件的内容<br/> 比如我们的网站下面一定有相应的robot.txt<br/> 这个是不允许爬取该网站内容的对象和规则。</p>\n<p>cms识别工具</p>\n<p>人肉搜索比较繁琐，也会有相应的现成的扫描工具：<br/> 1、kali中自带whatweb：</p>\n<pre><code>whatweb -v www.discuz.net</code></pre>\n<p> </p>\n<p><img alt=\"\" height=\"268\" src=\"..\\..\\static\\image\\378a6129187f4a8fa6a77ebccf3c87a7.png\" width=\"1200\"/></p>\n<p>2、使用浏览器的一些插件：</p>\n<p>whatruns </p>\n<p><img alt=\"\" height=\"233\" src=\"..\\..\\static\\image\\c23d2bdfc3b343c79a11dfa3e32b9efb.png\" width=\"228\"/></p>\n<p> </p>\n<p>wappalyzer</p>\n<p><img alt=\"\" height=\"299\" src=\"..\\..\\static\\image\\d5b7884ae5bf416f8ef4d085c72e03c3.png\" width=\"269\"/></p>\n<p> 3、在线cms指纹识别<br/> 也有一些在线网站可以进行在线识别。</p>\n<p>4、离线文件扫描<br/> 比如test404啥的</p>\n<p>在github上我们也能找到很多开源的扫描软件</p>\n<h3 id=\"2%E3%80%81cdn%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">2、cdn指纹识别：</h3>\n<p>ip收集的笔记中已经详细整理：</p>\n<p><a href=\"https://blog.csdn.net/hmysn/article/details/124762866?spm=1001.2014.3001.5501\" title=\"渗透测试之ip信息收集_ysn学习日记的博客-CSDN博客\">渗透测试之ip信息收集_ysn学习日记的博客-CSDN博客</a><br/> 1、超级ping<br/> 2、历史DNS<br/> 3、通过子域名查询IP<br/> 4、国外主机解析<br/> 5、其他</p>\n<p></p>\n<h3 id=\"3%E3%80%81waf%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%EF%BC%9A\">3、WAF指纹识别：</h3>\n<p>什么是WAF：</p>\n<p>Web Application Firewall<br/> 是一个Web 应用防火墙 过滤HTTP/HTTPS的请求<br/> 用来识别恶意参数和恶意请求<br/> WAF有很多作用：<br/> l、 SQL Injection (SQLi)：阻止SQL注入<br/> 2、 Cross Site Scripting (XSS)：阻止跨站脚本攻击<br/> 3、 Local File Inclusion (LFI)：阻止利用本地文件包含漏洞进行攻击<br/> 4、 Remote File Inclusione(RFI)：阻止利用远程文件包含漏洞进行攻击<br/> 5、 Remote Code Execution (RCE)：阻止利用远程命令执行漏洞进行攻击<br/> 6、 PHP Code Injectiod：阻止PHP代码注入<br/> 7、 HTTP Protocol Violations：阻止违反HTTP协议的恶意访问<br/> 8、 HTTPoxy：阻止利用远程代理感染漏洞进行攻击<br/> 9、 Sshllshock：阻止利用Shellshock漏洞进行攻击<br/> 10、 Session Fixation：阻止利用Session会话ID不变的漏洞进行攻击<br/> 11、 Scanner Detection：阻止黑客扫描网站<br/> l2、 Metadata/Error Leakages：阻止源代码/错误信息泄露<br/> l3、 Project Honey Pot Blacklist：蜜罐项目黑名单<br/> l4、 GeoIP Country Blocking：根据判断IP地址归属地来进行IP阻断</p>\n<p>识别WAF厂商</p>\n<p>首先我们可以根据不同的拦截页面来确定不同的厂商</p>\n<p>也可以通过如下思路来进行识别：<br/> 额外的cookie；<br/> 任何响应或请求的附加标头；<br/> 响应内容（如果被阻止请求）；<br/> 响应代码（如果被阻止请求）；<br/> IP地址（云WAF）；<br/> JS客户端模块（客户端WAF）</p>\n<p>首先第一步是触发防火墙：</p>\n<p>我们可以输入一些非法参数：</p>\n<pre><code>xsstring = '&lt;script&gt;alert(\"XSS\");&lt;/script&gt;' \nsqlistring = \"UNION SELECT ALL FROM information_schema AND ' or SLEEP(5) or '\" \nlfistring = '../../../../etc/passwd' \nrcestring ='/bin/cat /etc/passwd; ping 127.0.0.1; \ncurl google.com' \nxxestring = '&lt;!ENTITY xxe SYSTEM \"file:///etc/shadow\"&gt;]&gt;&lt;pwn&gt;&amp;hack;&lt;/pwn&gt;'\n</code></pre>\n<p>接下来是通过工具识别：</p>\n<p>1、kali自带：wafw00f</p>\n<p><img alt=\"\" height=\"818\" src=\"..\\..\\static\\image\\aff7029abfe0416cb5d3fda345e0f013.png\" width=\"1200\"/></p>\n<p> 2、功能强大的namp：</p>\n<pre><code>nmap www.12306.cn --script=http-waf-detect.nse</code></pre>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 1, "python": 1, "javascript": 0, "java": 1, "sql": 1, "php": 1, "time": "2022-05-15 22:18:55", "summary": "目录什么是指纹识别：、指纹识别、指纹识别：、指纹识别：什么是指纹识别：通过关键特征，识别出目标的系统、服务器、开发语言、操作系统、、的类别版本等等。其中主要识别以下的信息：、信息：比如、织梦、帝国、、"}