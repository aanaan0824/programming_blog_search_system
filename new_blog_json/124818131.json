{"blogid": "124818131", "writerAge": "码龄3年", "writerBlogNum": "1", "writerCollect": "11", "writerComment": "0", "writerFan": "1", "writerGrade": "1级", "writerIntegral": "12", "writerName": "dskycloud", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124818131.jpg", "writerRankTotal": "234794", "writerRankWeekly": "1350106", "writerThumb": "1", "writerVisitNum": "1661", "blog_read_count": "1659", "blog_time": "于 2022-05-17 13:00:23 发布", "blog_title": "C# Winform Chart控件展示sql数据的 柱状图、折线图、饼图和散点图（1）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>啊哈，第一次写，因为刚做好一个系统，本人水平不高，遇到问题很急躁，但是好在压着性子做出来了。只想记录一下我做的过程，给和我一样不懂的朋友借鉴，希望大家都能更好。不至于遇到问题找不到很快能实施的办法，焦躁焦躁。</p>\n<p>我的系统是基于C# Winform开发的一个校园卡管理系统，加了一个数据可视化功能，所以需要把数据库的数据实时展示出来，听起来“实时”很吓人，但是其实每个操作执行后都会更新到数据库里，每次重新读数据库的信息就是“实时”了。毕竟咱只是个模拟系统。</p>\n<p>如何从Visual Studio2019的工具栏找出chart控件并拖拽到默认界面应该不用多说吧，找不到工具栏的话开发界面最上面有个搜索框，搜一下就出来了。如果再没有可以百度，这是开发软件的基础配置问题。</p>\n<p>鼠标点击你的chart控件（默认是个柱状图），在属性框里有很多属性栏目。其中关于chart控件最主要的图表属性里有5个属性：</p>\n<p><img alt=\"\" height=\"138\" src=\"..\\..\\static\\image\\de30aea38fd14526ab3cdb8b196dcfe2.png\" width=\"343\"/></p>\n<p>上面这几个。刚开始我也不懂，很焦躁地点来点去，因为找到的教程大多是代码画图，要么就是版本不一样的vs对不上号，看不懂。但是如果你用探索的心态去玩，会发现，喔~</p>\n<p>这里贴一个对我帮助很大的链接，是简书上的一个小伙伴，BigbyLong，感谢，侵删。<a href=\"https://www.jianshu.com/p/945513e736cc\" title=\"C#中Chart的简单使用（柱状图和折线图） - 简书 (jianshu.com)\">C#中Chart的简单使用（柱状图和折线图） - 简书 (jianshu.com)</a></p>\n<p>哦，给你们看一下我的实验对象：</p>\n<p><img alt=\"\" height=\"690\" src=\"..\\..\\static\\image\\b52dd7cfc04e457d9d35630bf5aa64a0.png\" width=\"1200\"/></p>\n<p>自己在项目之外开个“实验品”，放心大胆地跟着教程尝试。</p>\n<p>那就先，散点图吧。所有的教程都告诉我，series属性贼重要，实践后我非常赞同。</p>\n<p><img alt=\"\" height=\"944\" src=\"..\\..\\static\\image\\f98e08fea97a479fa6057d9fe5a04aa0.png\" width=\"1153\"/></p>\n<p> 点击charttype后，有好多选择，那我们选第一个point图。</p>\n<p><img alt=\"\" height=\"329\" src=\"..\\..\\static\\image\\5b1637a0c47d478a8f7efb16fe32062f.png\" width=\"326\"/></p>\n<p>然后你就看见默认的柱形图变成了散点图。啊，接下来我可不是要带你设置散点图的标题、背景、颜色之类的，我要把数据放进去了。最简单的逻辑：<strong>用数组存储好你要的数据，然后用函数DataBindXY(数组A, 数组B)</strong>; 把数据和chart绑定，就实现了。</p>\n<p>我是这么做的。先想一想，你要用散点图干嘛。x轴，横轴，代表什么。y轴代表什么。</p>\n<p>我的横轴是日期，纵轴是一个学生在这个日期用餐的次数。那就简单了，我用sql语句从数据库读取一下，这个人在这个日期中所有的用餐记录条数就可以了，然后把今天以前的6天数据也读取，存到对应于y轴数值的数组里，（毕竟这个图还是能看到好几天的数据），然后绑定下就好啦。上代码：</p>\n<p> //根据选择的时间+学号，查询当日在ABC的总消费次数。<br/>  int[] num = new int[] {0,0,0,0,0,0 };//y轴数值数组，存储次数<br/> string[] riqi = new string[] {\"\",\"\",\"\",\"\",\"\",\"\" };//x轴数值数组，存储对应的日期</p>\n<p> DataLink dl = new DataLink();//数据库链接<br/> string sql = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{dateTimePicker1.Value.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             IDataReader dc = dl.read(sql);//读取数据<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[0] = int.Parse(dc[0].ToString());//把次数存储起来<br/>             }<br/>             riqi[0] = dateTimePicker1.Value.ToString(\"yyyy-MM-dd\");</p>\n<p>            DateTime date = dateTimePicker1.Value.AddDays(-1);<br/>             string sql2 = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{date.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             dc = dl.read(sql2);<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[1] = int.Parse(dc[0].ToString());<br/>             }<br/>             riqi[1] = date.ToString(\"yyyy-MM-dd\");</p>\n<p>            date = dateTimePicker1.Value.AddDays(-2);<br/>             string sql3 = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{date.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             dc = dl.read(sql3);<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[2] = int.Parse(dc[0].ToString());<br/>             }<br/>             riqi[2] = date.ToString(\"yyyy-MM-dd\");</p>\n<p>            date = dateTimePicker1.Value.AddDays(-3);<br/>             string sql4 = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{date.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             dc = dl.read(sql4);<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[3] = int.Parse(dc[0].ToString());<br/>             }<br/>             riqi[3] = date.ToString(\"yyyy-MM-dd\");</p>\n<p>            date = dateTimePicker1.Value.AddDays(-4);<br/>             string sql5 = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{date.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             dc = dl.read(sql5);<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[4] = int.Parse(dc[0].ToString());<br/>             }<br/>             riqi[4] = date.ToString(\"yyyy-MM-dd\");</p>\n<p>            date = dateTimePicker1.Value.AddDays(-5);<br/>             string sql6 = $\"select count(*) from CardADB.dbo.Bill where cardNum='{textBox1.Text}' and sellDate='{date.ToString(\"yyyy-MM-dd\")}' and (place ='A食堂' or place = 'B食堂' or place = 'C食堂')\";<br/>             dc = dl.read(sql6);<br/>             while (dc.Read())<br/>             {<!-- --><br/>                 num[5] = int.Parse(dc[0].ToString());<br/>             }<br/>             riqi[5] = date.ToString(\"yyyy-MM-dd\");</p>\n<p>            chart3.Series[0].Points.DataBindXY(riqi, num);<br/>             dc.Close();<br/>             dl.DaoClose();</p>\n<p> 哎呀。我不会像别人那样搞个专门粘贴代码的背景，看起来不太舒服。可恶。先这样，下次我试试看怎么弄。</p>\n<p>对了，上面的代码我放在一个按钮的点击事件里面了，还有个datetimepicker控件用来选查看的日期、一个textbox输入学生学号的。那就看下运行结果。</p>\n<p>这是啥也没有的状态，因为我没有设置默认下的样子。要设置的话，也是在series里点击point添加数值。</p>\n<p><img alt=\"\" height=\"438\" src=\"..\\..\\static\\image\\6faad7a0c46f4145830527eab0b3c8eb.png\" width=\"446\"/></p>\n<p> 这是没输入学号的结果。啥也没有。</p>\n<p> <img alt=\"\" height=\"420\" src=\"..\\..\\static\\image\\330191ddb8ce41b59ed47b58b7cd2584.png\" width=\"444\"/></p>\n<p> 最后输入学号、选择日期，就是结果图了。</p>\n<p><img alt=\"\" height=\"547\" src=\"..\\..\\static\\image\\add438579f8e4fe9bf5dd190cdffad81.png\" width=\"791\"/></p>\n<p> 好啦，不想写太多很罗嗦，其他的放在下一章。拜拜。</p>\n<p></p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-05-17 13:00:23", "summary": "啊哈，第一次写，因为刚做好一个系统，本人水平不高，遇到问题很急躁，但是好在压着性子做出来了。只想记录一下我做的过程，给和我一样不懂的朋友借鉴，希望大家都能更好。不至于遇到问题找不到很快能实施的办法，焦"}