{"blogid": "123587481", "writerAge": "码龄14年", "writerBlogNum": "16", "writerCollect": "43", "writerComment": "2", "writerFan": "12", "writerGrade": "2级", "writerIntegral": "391", "writerName": "Yamol915", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123587481.jpg", "writerRankTotal": "107255", "writerRankWeekly": "134690", "writerThumb": "18", "writerVisitNum": "60050", "blog_read_count": "8145", "blog_time": "已于 2022-06-21 06:47:55 修改", "blog_title": "Mac安装PHP开发环境", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><a href=\"https://www.jianshu.com/p/4e54be14691d\">MacOS下安装homebrew包管理器</a></p>\n<h2><a id=\"PHP_1\"></a>一、安装PHP</h2>\n<pre><code>#搜索PHP，会搜索出PHP相关的资源，然后根据自己需求选择安装\n$ brew search php\n#安装PHP，不指定PHP版本时，默认安装最新版本\n$ brew install php\n</code></pre>\n<p>程序会自动安装，安装完成后，将PHP加入 $PATH 中</p>\n<pre><code>#shell使用bash添加方式\n$ vim ~/.bash_profile\nexport PATH=\"/usr/local/sbin:$PATH\"\nsource ~/.bash_profile\n\n# shell使用zsh添加方式\n$ vim ~/.zshrc\nexport PATH=\"/usr/local/sbin:$PATH\"\nsource ~/.zshrc\n</code></pre>\n<p>配置php-fpm.conf</p>\n<pre><code>vim /usr/local/etc/php/8.1/php-fpm.conf\n\n#去掉第17行和第24行前面的分号\n17 ;pid = run/php-fpm.pid\n24 ;error_log = log/php-fpm.log\n</code></pre>\n<p>PHP相关操作</p>\n<pre><code>#启动｜停止｜重启\n$ brew services start|stop|restart php\n</code></pre>\n<p>查看php-fpm是否启动成功</p>\n<pre><code>$ lsof -Pni4 | grep LISTEN | grep php\n#启动成功输出\nphp-fpm   80788 yamol    8u  IPv4 0x38dc2fee9c1e7791      0t0  TCP 127.0.0.1:9000 (LISTEN)\nphp-fpm   80794 yamol    9u  IPv4 0x38dc2fee9c1e7791      0t0  TCP 127.0.0.1:9000 (LISTEN)\nphp-fpm   80795 yamol    9u  IPv4 0x38dc2fee9c1e7791      0t0  TCP 127.0.0.1:9000 (LISTEN)\n</code></pre>\n<h2><a id=\"nginx_42\"></a>二、安装nginx</h2>\n<pre><code>#安装nginx\n$ brew install nginx\n#使用80端口的话，需要将nginx加入root组当中\n$ sudo cp -v /usr/local/opt/nginx/*.plist /Library/LaunchDaemons/\n$ sudo chown root:wheel /Library/LaunchDaemons/homebrew.mxcl.nginx.plist\n#启动nginx服务\n$ brew services start nginx\n#测试nginx是否安装成功\n$ curl -IL http://127.0.0.1:8080\n</code></pre>\n<p>安装成功结果</p>\n<blockquote>\n<p>HTTP/1.1 200 OK<br/> Server: nginx/1.21.4<br/> Date: Thu, 16 Dec 2021 02:08:07 GMT<br/> Content-Type: text/html<br/> Content-Length: 615<br/> Last-Modified: Tue, 02 Nov 2021 14:49:28 GMT<br/> Connection: keep-alive<br/> ETag: “61814ff8-267”<br/> Accept-Ranges: bytes</p>\n</blockquote>\n<p>Nginx 其它相关操作</p>\n<pre><code>#启动nginx\n$ sudo nginx \n#重新加载|重启|退出\n$ sudo nginx -s reload|reopen|quit \n#brew操作，启动｜停止｜重启\n$ brew services start|stop|restart nginx\n</code></pre>\n<h2><a id=\"MySQL_75\"></a>三、安装MySQL</h2>\n<pre><code>#搜索mysql，查看包含哪些版本\n$ brew search mysql\n#安装mysql，不指定版本号，默认安装最新\n$ brew install mysql\n</code></pre>\n<p>MySQL安全设置<code>mysql_secure_installation</code></p>\n<pre><code>#执行mysql_secure_installation\n$ mysql_secure_installation\n\nSecuring the MySQL server deployment.\n\nConnecting to MySQL using a blank password.\n\nVALIDATE PASSWORD COMPONENT can be used to test passwords\nand improve security. It checks the strength of password\nand allows the users to set only those passwords which are\nsecure enough. Would you like to setup VALIDATE PASSWORD component?\n#是否验证密码强度，输入y|Y验证，输入其他不验证\nPress y|Y for Yes, any other key for No:\n#设置root登录密码\nPlease set the password for root here.\n\nNew password:\n#确认密码\nRe-enter new password:\nBy default, a MySQL installation has an anonymous user,\nallowing anyone to log into MySQL without having to have\na user account created for them. This is intended only for\ntesting, and to make the installation go a bit smoother.\nYou should remove them before moving into a production\nenvironment.\n\n#是否删除匿名用户，输入y|Y删除，输入其他键不删除，本人选择删除\nRemove anonymous users? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\n\nNormally, root should only be allowed to connect from\n'localhost'. This ensures that someone cannot guess at\nthe root password from the network.\n#是否禁止远程登录，输入y|Y禁止，输入其他键不禁止，本人选择禁止\nDisallow root login remotely? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\nBy default, MySQL comes with a database named 'test' that\nanyone can access. This is also intended only for testing,\nand should be removed before moving into a production\nenvironment.\n\n#是否删除test数据库，输入y|Y删除，输入其他键不删除，本人选择删除\nRemove test database and access to it? (Press y|Y for Yes, any other key for No) : y\n - Dropping test database...\nSuccess.\n\n - Removing privileges on test database...\nSuccess.\n\nReloading the privilege tables will ensure that all changes\nmade so far will take effect immediately.\n\n#是否重载权限表，输入y|Y重载，输入其他键不重载，本人选择重载\nReload privilege tables now? (Press y|Y for Yes, any other key for No) : y\nSuccess.\n\nAll done!\n</code></pre>\n<p>测试数据库是否安装成功，如下显示即为安装成功</p>\n<pre><code>mysql -uroot -p\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 15\nServer version: 8.0.27 Homebrew\n\nCopyright (c) 2000, 2021, Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql&gt;\n</code></pre>\n<p>MySQL相关操作</p>\n<pre><code>#启动｜停止｜重启 mysql服务\n$ brew services start|stop|restart mysql\n#本地登录MySQL\n$ mysql -u用户名 -p密码\n#远程登录\n$ mysql -h IP地址 -u用户名 -p密码 -P端口号（默认3306）\n</code></pre>\n<h2><a id=\"NginxPHPMySQL_174\"></a>四、整合Nginx+PHP+MySQL</h2>\n<p>1.创建配置文件的文件夹</p>\n<pre><code>$ mkdir -p /usr/local/etc/nginx/logs\n$ mkdir -p /usr/local/etc/nginx/conf.d\n$ mkdir -p /usr/local/etc/nginx/ssl\n\n$ sudo chown :staff /usr/local/var/www\n$ sudo chmod 775 /usr/local/var/www\n</code></pre>\n<p>2.修改nginx配置文件</p>\n<pre><code>$ vim /usr/local/etc/nginx/nginx.conf\n</code></pre>\n<p>nginx.conf 内容如下：</p>\n<pre><code>worker_processes 1;\n\nerror_log       /usr/local/etc/nginx/logs/error.log debug;\npid             /usr/local/var/run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    include    mime.types;\n    default_type  application/octet-stream;\n\n    log_format main '$remote_addr - $remote_user [$time_local] \"$request\" '\n                    '$status $body_bytes_sent \"$http_referer\" '\n                    '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log /usr/local/etc/nginx/logs/access.log main;\n\n     sendfile   on;\n\n     keepalive_timeout 65;\n\n     index index.html index.php;\n\n     include /usr/local/etc/nginx/servers/*;\n}\n</code></pre>\n<p>3.创建php-fpm配置文件</p>\n<pre><code>$ vim /usr/local/etc/nginx/conf.d/php-fpm\n</code></pre>\n<p>输入以下内容</p>\n<pre><code>location ~ \\.php$ {\n        try_files  $uri = 404;\n        fastcgi_pass 127.0.0.1:9000;\n        fastcgi_index index.php;\n        fastcgi_intercept_errors on;\n        include /usr/local/etc/nginx/fastcgi.conf;\n}\n</code></pre>\n<p>4.创建站点配置文件</p>\n<pre><code>$ vim /usr/local/etc/nginx/servers/default.conf\n</code></pre>\n<p>输入以下内容</p>\n<pre><code>server {\n        listen          8080;\n        server_name     localhost;\n        root            /usr/local/var/www/;\n        charset utf-8;\n\n        access_log      /usr/local/etc/nginx/logs/default.access.log main;\n        error_log       /usr/local/var/log/nginx/default.error.log;\n\n        location / {\n                include /usr/local/etc/nginx/conf.d/php-fpm;\n        }\n\n        location = /info {\n                allow 127.0.0.1;\n                deny all;\n                rewrite (.*) /.info.php;\n        }\n\n        error_page 404  /404.html;\n        error_page 403  /403.html;\n}\n</code></pre>\n<p>重启所有服务</p>\n<pre><code>$ brew services restart nginx\n$ brew services restart php\n$ brew services restart mysql\n</code></pre>\n<p>至此整合完毕！</p>\n<p>测试</p>\n<pre><code>#创建info.php\n$ vim /usr/local/var/www/info.php\n#输入以下内容\n&lt;?php\n phpinfo();\n?&gt;\n#保存\n</code></pre>\n<p>浏览器访问<code>http://localhost:8080/info.php</code><br/> 正常展示如下面表示配置成功<br/> <img alt=\"image.png\" src=\"..\\..\\static\\image\\a10b860e9b83e2d702cedac9f8ac0504.png\"/></p>\n<h2><a id=\"_285\"></a>五、遇见的报错整理</h2>\n<p>1.在mac上启动nginx时会报一个警告</p>\n<pre><code>nginx: [warn] 1024 worker_connections exceed open file resource limit: 256\n</code></pre>\n<p>解决方案：</p>\n<pre><code>$ ulimit -n 1024\n</code></pre>\n<p>2.nginx: [error] invalid PID number “” in “/var/run/nginx/nginx.pid”</p>\n<pre><code>➜  run sudo nginx -s reload\nPassword:\nnginx: [error] invalid PID number \"\" in \"/usr/local/var/run/nginx.pid\"\n#解决方案：重新指向配置文件即可\n➜  run sudo nginx -c /usr/local/etc/nginx/nginx.conf\nnginx: [warn] 1024 worker_connections exceed open file resource limit: 256\n➜  run sudo nginx -s reload\n</code></pre>\n<p>3.error 2002 (hy000): can’t connect to local mysql server through socket ‘/tmp/mysql.sock’ (xxx)</p>\n<pre><code>#第一步，先关闭 mysql 服务，使用brew 启动的mysql服务，使用下面命令关闭\n$ brew services stop mysql\n#如果是使用 mysql.server start 命令启动的mysql，则使用如下命令关闭\n$ mysql.server stop\n\n#第二步，依次输入下面命令\n$ pkill mysql\n$ rm -rf /usr/local/var/mysql/ \t#注意：此操作会删除数据库的所有数据，请提前备份。\n$ brew postinstall mysql\n$ brew services restart mysql\n$ mysql -uroot\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-06-21 06:47:55", "summary": "下安装包管理器一、安装搜索，会搜索出相关的资源，然后根据自己需求选择安装安装，不指定版本时，默认安装最新版本程序会自动安装，安装完成后，将加入中使用添加方式使用添加方式配置去掉第行和第行前面的分号相关"}