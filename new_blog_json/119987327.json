{"blogid": "119987327", "writerAge": "码龄6年", "writerBlogNum": "119", "writerCollect": "307", "writerComment": "22", "writerFan": "64", "writerGrade": "4级", "writerIntegral": "1532", "writerName": "行走的算法", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_119987327.jpg", "writerRankTotal": "72489", "writerRankWeekly": "60115", "writerThumb": "45", "writerVisitNum": "141216", "blog_read_count": "4672", "blog_time": "于 2021-08-29 22:57:36 发布", "blog_title": "C#使用OpenCV", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>C#使用OpenCV</h3>\n<ul><li><a href=\"#OpenCV_1\">一、OpenCV的安装</a></li><li><ul><li><a href=\"#1OpenCvSharp4OpenCvSharp4runtimewin_2\">1、需要安装两个拓展包：OpenCvSharp4和OpenCvSharp4.runtime.win</a></li><li><a href=\"#2_7\">2、出错</a></li></ul>\n</li><li><a href=\"#COpenCV_16\">二、C#使用OpenCV的一些代码</a></li><li><ul><li><a href=\"#1_17\">1、需要加头文件</a></li><li><a href=\"#2_23\">2、读取图片</a></li><li><a href=\"#3_30\">3、定义一个没有初始化的图片作为复制</a></li><li><a href=\"#4_37\">4、灰度化</a></li><li><a href=\"#5size_51\">5、高斯模糊和size数据格式的定义</a></li><li><a href=\"#6_62\">6、二值化</a></li><li><a href=\"#7_68\">7、开闭运算</a></li><li><a href=\"#8FindContourscontours_76\">8、FindContours查找轮廓和contours参数的定义和操作</a></li><li><a href=\"#9RectSize_96\">9、Rect和Size格式的定义</a></li><li><a href=\"#10_resize_103\">10、 resize函数</a></li><li><a href=\"#_114\">在图片上画矩形框</a></li><li><a href=\"#_124\">在图片上画直线</a></li></ul>\n</li><li><a href=\"#_137\">不错的链接</a></li><li><a href=\"#_141\">一些完成的代码</a></li><li><ul><li><a href=\"#1_142\">1、帧差法判断当前帧有没有物体</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"OpenCV_1\"></a>一、OpenCV的安装</h1>\n<h2><a id=\"1OpenCvSharp4OpenCvSharp4runtimewin_2\"></a>1、需要安装两个拓展包：OpenCvSharp4和OpenCvSharp4.runtime.win</h2>\n<p>在VS中，通过其工具中自带的扩展包就安装了，不需要像C++中用opencv那样，还要配置属性。</p>\n<p>安装步骤：工具——》Nuget包管理器——》管理解决方案的Nuget包。直接搜索opencvsharp。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\78f1c2765ee34adea7c1f1a4fc577afb.png\"/></p>\n<h2><a id=\"2_7\"></a>2、出错</h2>\n<pre><code class=\"prism language-c\">c# OpenCvSharp4 无法加载 DLLOpenCvSharpExtern<span class=\"token operator\">:</span>找不到指定的模块\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7ef4a0c1e2964f73b39a03233f151074.png\"/><br/> 这句话的意思是，这个包只包含内部算法的核心部分，因此，使用时还需添加OPENCV4.runtime<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e6037f5393214ebf93b43f7e3b2aeedd.png\"/><br/> 安装这个拓展包就可以使用了。</p>\n<h1><a id=\"COpenCV_16\"></a>二、C#使用OpenCV的一些代码</h1>\n<h2><a id=\"1_17\"></a>1、需要加头文件</h2>\n<pre><code class=\"prism language-c\">using OpenCvSharp<span class=\"token punctuation\">;</span>   <span class=\"token comment\">//为了使用opencv</span>\nusing Point <span class=\"token operator\">=</span> OpenCvSharp<span class=\"token punctuation\">.</span>Point<span class=\"token punctuation\">;</span>   <span class=\"token comment\">//为了确定我们使用的point是opencv的而不是draw的</span>\n</code></pre>\n<h2><a id=\"2_23\"></a>2、读取图片</h2>\n<pre><code class=\"prism language-c\">Mat img1 <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"F:\\\\all_truck\\\\truck_3.jpg\"</span><span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"win1\"</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">WaitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"3_30\"></a>3、定义一个没有初始化的图片作为复制</h2>\n<pre><code class=\"prism language-c\"><span class=\"token comment\">//pBkImage是已经赋值了的图片，将这个图片复制到pBkImage_copy中</span>\nMat pBkImage_copy <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\npBkImage<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>pBkImage_copy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"4_37\"></a>4、灰度化</h2>\n<p>CvtColor(InputArray src, OutputArray dst, ColorConversionCodes code, int dstCn = 0)<br/> 第一个参数 src 是原图像。<br/> 第二个参数 dst 是转换后的图像。<br/> 第三个参数 code 转换成什么格式的图片。<br/> 第四个参数 dstcn 为通道数。</p>\n<p>这里第三个参数的编码格式，更快捷的方式是首先输入ColorConversionCodes.，然后按照c#或者python的代码中的BGR2GRAY直接输入就可以了，这里会自动跳出合适的选项。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\27adeae426b94aed89c9cdad7ecde694.png\"/></p>\n<pre><code class=\"prism language-c\"> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">CvtColor</span><span class=\"token punctuation\">(</span>pBkImage_copy<span class=\"token punctuation\">,</span> pBkImage_gray<span class=\"token punctuation\">,</span> ColorConversionCodes<span class=\"token punctuation\">.</span>BGR2GRAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"5size_51\"></a>5、高斯模糊和size数据格式的定义</h2>\n<p>下面是size数据格式的定义</p>\n<pre><code class=\"prism language-c\">OpenCvSharp<span class=\"token punctuation\">.</span>Size up <span class=\"token operator\">=</span> new <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>高斯模糊：难点是size格式的定义，这里使用了：new OpenCvSharp.Size(11,11)</p>\n<pre><code class=\"prism language-c\">Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">GaussianBlur</span><span class=\"token punctuation\">(</span>pBkImage_gray<span class=\"token punctuation\">,</span> pBkImage_gauss<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"6_62\"></a>6、二值化</h2>\n<p>难点：ThresholdTypes.Binary</p>\n<pre><code class=\"prism language-c\">Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">Threshold</span><span class=\"token punctuation\">(</span>Image_diff<span class=\"token punctuation\">,</span> Image_threshold<span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> ThresholdTypes<span class=\"token punctuation\">.</span>Binary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"7_68\"></a>7、开闭运算</h2>\n<pre><code class=\"prism language-c\"><span class=\"token comment\">//自定义核,进行开、闭运算</span>\nMat element <span class=\"token operator\">=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">GetStructuringElement</span><span class=\"token punctuation\">(</span>MorphShapes<span class=\"token punctuation\">.</span>Rect<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">MorphologyEx</span><span class=\"token punctuation\">(</span>Image_threshold<span class=\"token punctuation\">,</span> Image_morp<span class=\"token punctuation\">,</span> MorphTypes<span class=\"token punctuation\">.</span>Open<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">MorphologyEx</span><span class=\"token punctuation\">(</span>Image_morp<span class=\"token punctuation\">,</span> Image_morp<span class=\"token punctuation\">,</span> MorphTypes<span class=\"token punctuation\">.</span>Close<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"8FindContourscontours_76\"></a>8、FindContours查找轮廓和contours参数的定义和操作</h2>\n<p><a href=\"https://www.jb51.net/article/199887.htm\">C#中OpenCVSharp实现轮廓检测</a><br/> 这个链接的示例非常好<br/> 难点：contours，hierarchy格式的定义。contours.Length和Cv2.ContourArea(contours[i]);函数的使用</p>\n<pre><code class=\"prism language-c\">Point<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> contours<span class=\"token punctuation\">;</span>\nHierarchyIndex<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hierarchy<span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">FindContours</span><span class=\"token punctuation\">(</span>Image_morp<span class=\"token punctuation\">,</span> out contours<span class=\"token punctuation\">,</span> out hierarchy<span class=\"token punctuation\">,</span> RetrievalModes<span class=\"token punctuation\">.</span>External<span class=\"token punctuation\">,</span> ContourApproximationModes<span class=\"token punctuation\">.</span>ApproxSimple<span class=\"token punctuation\">,</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>contours<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"没有任何前景\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">double</span> image_area <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> contours<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    image_area <span class=\"token operator\">+=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ContourArea</span><span class=\"token punctuation\">(</span>contours<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"9RectSize_96\"></a>9、Rect和Size格式的定义</h2>\n<pre><code class=\"prism language-c\">OpenCvSharp<span class=\"token punctuation\">.</span>Size up <span class=\"token operator\">=</span> new <span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nRect rect <span class=\"token operator\">=</span>new <span class=\"token function\">Rect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nRect rect <span class=\"token operator\">=</span>new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Rect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"10_resize_103\"></a>10、 resize函数</h2>\n<pre><code class=\"prism language-c\"><span class=\"token comment\">//这个代码可以成功运行</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">Resize</span><span class=\"token punctuation\">(</span>pFrImage_mid<span class=\"token punctuation\">,</span> pFrImage_resize<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span>image_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> image_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       \n\n\n<span class=\"token comment\">//这个代码没法成功运行，因为后面的InterpolationFlags.Linear显示无法转换为double，到最后都没有解决</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">Resize</span><span class=\"token punctuation\">(</span>pFrImage_mid<span class=\"token punctuation\">,</span> pFrImage_resize<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span>image_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> image_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> InterpolationFlags<span class=\"token punctuation\">.</span>Linear<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           \n</code></pre>\n<h2><a id=\"_114\"></a>在图片上画矩形框</h2>\n<pre><code class=\"prism language-c\">Mat img1 <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"F:\\\\all_truck\\\\truck_3.jpg\"</span><span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"win1\"</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nOpenCvSharp<span class=\"token punctuation\">.</span>Point truck_a <span class=\"token operator\">=</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nOpenCvSharp<span class=\"token punctuation\">.</span>Point truck_b <span class=\"token operator\">=</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">Rectangle</span><span class=\"token punctuation\">(</span>img1<span class=\"token punctuation\">,</span> truck_a<span class=\"token punctuation\">,</span> truck_b<span class=\"token punctuation\">,</span> Scalar<span class=\"token punctuation\">.</span>Red<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">WaitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"_124\"></a>在图片上画直线</h2>\n<pre><code class=\"prism language-c\">Mat img1 <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"F:\\\\all_truck\\\\truck_3.jpg\"</span><span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"win1\"</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nOpenCvSharp<span class=\"token punctuation\">.</span>Point truck_a <span class=\"token operator\">=</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nOpenCvSharp<span class=\"token punctuation\">.</span>Point truck_b <span class=\"token operator\">=</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">300</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">Line</span><span class=\"token punctuation\">(</span>img1<span class=\"token punctuation\">,</span>up<span class=\"token punctuation\">,</span>down<span class=\"token punctuation\">,</span>Scalar<span class=\"token punctuation\">.</span>Red<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"win_line\"</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nCv2<span class=\"token punctuation\">.</span><span class=\"token function\">WaitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h1><a id=\"_137\"></a>不错的链接</h1>\n<p><a href=\"https://blog.csdn.net/wcx1293296315/article/details/112761898?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-4.essearch_pc_relevant&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-4.essearch_pc_relevant\">OpencvSharp的踩坑之路</a></p>\n<h1><a id=\"_141\"></a>一些完成的代码</h1>\n<h2><a id=\"1_142\"></a>1、帧差法判断当前帧有没有物体</h2>\n<p>一共定义了三个函数<br/> public void redefineWH(int weight, int hight, int maxSize, int[] size)<br/> public int target_judgment(Mat pBkImage, Mat pFrImage)<br/> public int object_judgment(string pBkImage_file, string pFrImage_file)</p>\n<p>调用的话使用的是最后一个object_judgment函数，传送进入的是背景帧和当前帧的路径（必须是绝对路径，c#的相对路径读取不到）。</p>\n<p>返回值有三个：<br/> -1：没有读取到图片（背景帧和当前帧都有可能，如果想具体判断那个帧我可以再修改）<br/> 0：当前帧中没有物体<br/> 1：当前帧中有物体</p>\n<pre><code class=\"prism language-c\">private <span class=\"token keyword\">void</span> <span class=\"token function\">button6_Click</span><span class=\"token punctuation\">(</span>object sender<span class=\"token punctuation\">,</span> EventArgs e<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    string source_wrl <span class=\"token operator\">=</span> <span class=\"token string\">\"C:/Users/liu/source/repos/car_segment_1/car_segment\"</span><span class=\"token punctuation\">;</span>\n\n    string fileUrl_Bk <span class=\"token operator\">=</span> source_wrl <span class=\"token operator\">+</span> <span class=\"token string\">\"/photo/background_absdiff/Wide_angle_78_1/0.jpg\"</span><span class=\"token punctuation\">;</span>\n    string fileUrl_Fr <span class=\"token operator\">=</span> source_wrl <span class=\"token operator\">+</span> <span class=\"token string\">\"/photo/background_absdiff/Wide_angle_78_1/15.jpg\"</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span>fileUrl_Fr<span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pBkImage <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span>fileUrl_Bk<span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"213\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> s <span class=\"token operator\">=</span> <span class=\"token number\">9</span><span class=\"token punctuation\">;</span>\n    s <span class=\"token operator\">=</span> <span class=\"token function\">object_judgment</span><span class=\"token punctuation\">(</span>fileUrl_Bk<span class=\"token punctuation\">,</span>fileUrl_Fr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\n\npublic <span class=\"token keyword\">void</span> <span class=\"token function\">redefineWH</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> weight<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> hight<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> maxSize<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> size<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">int</span> maxValue <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">Max</span><span class=\"token punctuation\">(</span>weight<span class=\"token punctuation\">,</span> hight<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">float</span> rate <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>maxSize <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span>maxValue<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> w <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">Round</span><span class=\"token punctuation\">(</span>weight <span class=\"token operator\">*</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">Round</span><span class=\"token punctuation\">(</span>hight <span class=\"token operator\">*</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> w<span class=\"token punctuation\">;</span>\n    size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> h<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//如果返回0说明没有物体，如果返回1说明有物体</span>\npublic <span class=\"token keyword\">int</span> <span class=\"token function\">target_judgment</span><span class=\"token punctuation\">(</span>Mat pBkImage<span class=\"token punctuation\">,</span> Mat pFrImage<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">//这里需要加上一个图片是否存在的判断</span>\n\n\n    <span class=\"token comment\">/*cout &lt;&lt; \"进入循环函数\" &lt;&lt; endl;*/</span>\n    Mat pBkImage_copy <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage_copy <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pBkImage_gray <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage_gray <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pBkImage_gauss <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage_gauss <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat Image_diff <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat Image_threshold <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat Image_morp <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pBkImage<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>pBkImage_copy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pFrImage<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>pFrImage_copy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//灰度化</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">CvtColor</span><span class=\"token punctuation\">(</span>pBkImage_copy<span class=\"token punctuation\">,</span> pBkImage_gray<span class=\"token punctuation\">,</span> ColorConversionCodes<span class=\"token punctuation\">.</span>BGR2GRAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">CvtColor</span><span class=\"token punctuation\">(</span>pFrImage_copy<span class=\"token punctuation\">,</span> pFrImage_gray<span class=\"token punctuation\">,</span> ColorConversionCodes<span class=\"token punctuation\">.</span>BGR2GRAY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/*cout &lt;&lt; \"灰度化\" &lt;&lt; endl;*/</span>\n\n    <span class=\"token comment\">//高斯模糊</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">GaussianBlur</span><span class=\"token punctuation\">(</span>pBkImage_gray<span class=\"token punctuation\">,</span> pBkImage_gauss<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">GaussianBlur</span><span class=\"token punctuation\">(</span>pFrImage_gray<span class=\"token punctuation\">,</span> pFrImage_gauss<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//blur(src_gray, src_gray, Size(3, 3));</span>\n    <span class=\"token comment\">/*cout &lt;&lt; \"高斯模糊\" &lt;&lt; endl;*/</span>\n\n    <span class=\"token comment\">//帧差</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">Absdiff</span><span class=\"token punctuation\">(</span>pBkImage_gauss<span class=\"token punctuation\">,</span> pFrImage_gauss<span class=\"token punctuation\">,</span> Image_diff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/*cout &lt;&lt; \"帧差\" &lt;&lt; endl;*/</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Image_diff\"</span><span class=\"token punctuation\">,</span> Image_diff<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//二值化CV_THRESH_BINARY</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">Threshold</span><span class=\"token punctuation\">(</span>Image_diff<span class=\"token punctuation\">,</span> Image_threshold<span class=\"token punctuation\">,</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> ThresholdTypes<span class=\"token punctuation\">.</span>Binary<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Image_threshold\"</span><span class=\"token punctuation\">,</span> Image_threshold<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/*cout &lt;&lt; \"二值化\" &lt;&lt; endl;*/</span>\n\n\n    <span class=\"token comment\">//自定义核,进行开、闭运算</span>\n    Mat element <span class=\"token operator\">=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">GetStructuringElement</span><span class=\"token punctuation\">(</span>MorphShapes<span class=\"token punctuation\">.</span>Rect<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">MorphologyEx</span><span class=\"token punctuation\">(</span>Image_threshold<span class=\"token punctuation\">,</span> Image_morp<span class=\"token punctuation\">,</span> MorphTypes<span class=\"token punctuation\">.</span>Open<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">MorphologyEx</span><span class=\"token punctuation\">(</span>Image_morp<span class=\"token punctuation\">,</span> Image_morp<span class=\"token punctuation\">,</span> MorphTypes<span class=\"token punctuation\">.</span>Close<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/*cout &lt;&lt; \"进行开\" &lt;&lt; endl;*/</span>\n\n    <span class=\"token comment\">//查找前景的区域</span>\n    <span class=\"token comment\">//vector&lt;vector&lt;Point&gt;&gt; contours;</span>\n    <span class=\"token comment\">//vector&lt;Vec4i&gt; hierarchy;</span>\n    Point<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> contours<span class=\"token punctuation\">;</span>\n    HierarchyIndex<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> hierarchy<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//Cv2.FindContours(Image_morp, contours, hierarchy, RETR_EXTERNAL, CHAIN_APPROX_SIMPLE, Point(0, 0));</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">FindContours</span><span class=\"token punctuation\">(</span>Image_morp<span class=\"token punctuation\">,</span> out contours<span class=\"token punctuation\">,</span> out hierarchy<span class=\"token punctuation\">,</span> RetrievalModes<span class=\"token punctuation\">.</span>External<span class=\"token punctuation\">,</span> ContourApproximationModes<span class=\"token punctuation\">.</span>ApproxSimple<span class=\"token punctuation\">,</span> new <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//cout &lt;&lt; \"查找前景的区域\" &lt;&lt; endl;</span>\n\n    <span class=\"token comment\">//vector&lt;vector&lt;Point&gt; &gt; contours_poly(contours.size());</span>\n    <span class=\"token comment\">//vector&lt;Rect&gt; boundRect(contours.size());</span>\n    <span class=\"token comment\">//vector&lt;Point2f&gt;center(contours.size());</span>\n    <span class=\"token comment\">//vector&lt;float&gt;radius(contours.size());</span>\n\n    <span class=\"token comment\">//cout &lt;&lt; \"查找前景的区域-定义存储器\" &lt;&lt; endl;</span>\n    <span class=\"token comment\">//vector&lt;int&gt; xs, xy;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"contours.size(): \" &lt;&lt; contours.size() &lt;&lt; endl;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>contours<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"没有任何前景\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">double</span> image_area <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> contours<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//approxPolyDP(Mat(contours[i]), contours_poly[i], 3, true);</span>\n\n        <span class=\"token comment\">//cout &lt;&lt; \"进入函数\" &lt;&lt; endl;</span>\n\n        <span class=\"token comment\">//boundRect[i] = boundingRect(Mat(contours[i]));</span>\n        image_area <span class=\"token operator\">+=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ContourArea</span><span class=\"token punctuation\">(</span>contours<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//image_area += contourArea(contours[i]);</span>\n        <span class=\"token comment\">//cout &lt;&lt; \"是空的\" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//cout &lt;&lt; boundRect[i].x &lt;&lt; \"     ii \" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//cout &lt;&lt; boundRect[i].y &lt;&lt; \"     ii \" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//cout &lt;&lt; boundRect[i].width &lt;&lt; \"     ii \" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//cout &lt;&lt; boundRect[i].height &lt;&lt; \"     ii \" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//cout &lt;&lt; boundRect[i] &lt;&lt; \"     ii \" &lt;&lt; endl;</span>\n        <span class=\"token comment\">//xs.push_back(boundRect[i].x);</span>\n        <span class=\"token comment\">//xs.push_back(boundRect[i].x + boundRect[i].width);</span>\n        <span class=\"token comment\">//xy.push_back(boundRect[i].y);</span>\n        <span class=\"token comment\">//xy.push_back(boundRect[i].y + boundRect[i].height);</span>\n\n        <span class=\"token comment\">//minEnclosingCircle(contours[i], center[i], radius[i]);</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">//int x_max, x_min, y_max, y_min;</span>\n    <span class=\"token comment\">//x_max = *max_element(xs.begin(), xs.end());</span>\n    <span class=\"token comment\">//x_min = *min_element(xs.begin(), xs.end());</span>\n    <span class=\"token comment\">//y_max = *max_element(xy.begin(), xy.end());</span>\n    <span class=\"token comment\">//y_min = *min_element(xy.begin(), xy.end());</span>\n\n    <span class=\"token comment\">//cout &lt;&lt; \"x_max: v \" &lt;&lt; x_max &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"x_min: v \" &lt;&lt; x_min &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"y_max: v \" &lt;&lt; y_max &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"y_min: v \" &lt;&lt; y_min &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"src.col: v \" &lt;&lt; pBkImage.cols &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" src.rows: v \" &lt;&lt; pBkImage.rows &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" 总面积为:  \" &lt;&lt; image_area &lt;&lt; endl;</span>\n    System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"面积为： \"</span> <span class=\"token operator\">+</span> image_area<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//如果前景物体的面积大于1200，则返回1,否则判断为没有物体，返回0</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>image_area <span class=\"token operator\">&gt;</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">double</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">1200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">//画出矩阵和圆形</span>\n    <span class=\"token comment\">//Mat drawing = Mat::zeros(Image_threshold.size(), CV_8UC3);</span>\n    <span class=\"token comment\">//for (int i = 0; i &lt; contours.size(); i++)</span>\n    <span class=\"token comment\">//{<!-- --></span>\n    <span class=\"token comment\">//\tScalar color = Scalar(rng.uniform(0, 255), rng.uniform(0, 255), rng.uniform(0, 255));</span>\n    <span class=\"token comment\">//\tdrawContours(drawing, contours_poly, i, color, 1, 8, vector&lt;Vec4i&gt;(), 0, Point());</span>\n    <span class=\"token comment\">//\trectangle(drawing, boundRect[i].tl(), boundRect[i].br(), color, 2, 8, 0);</span>\n    <span class=\"token comment\">//\tcircle(drawing, center[i], (int)radius[i], color, 2, 8, 0);</span>\n    <span class=\"token comment\">//}</span>\n\n    <span class=\"token comment\">/// 显示在一个窗口</span>\n    <span class=\"token comment\">//namedWindow(\"Contours\", CV_WINDOW_AUTOSIZE);</span>\n    <span class=\"token comment\">//imshow(\"Contours\", drawing);</span>\n\n    <span class=\"token comment\">//waitKey(0);</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">}</span>\npublic <span class=\"token keyword\">int</span> <span class=\"token function\">object_judgment</span><span class=\"token punctuation\">(</span>string pBkImage_file<span class=\"token punctuation\">,</span> string pFrImage_file<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">//Mat pBkImage_mid, pFrImage_mid, pBkImage_resize, pFrImage_resize;      //定义了前景和背景帧</span>\n     <span class=\"token comment\">//定义了前景和背景帧</span>\n    Mat pBkImage <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pBkImage_mid <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage_mid <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pBkImage_resize <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Mat pFrImage_resize <span class=\"token operator\">=</span> new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//pBkImage = imread(\"./photo/background_absdiff/Wide_angle_78_1/0.jpg\");</span>\n    <span class=\"token comment\">//pFrImage = imread(\"./photo/background_absdiff/Wide_angle_78_1/14.jpg\");</span>\n    pBkImage <span class=\"token operator\">=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImRead</span><span class=\"token punctuation\">(</span>pBkImage_file<span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pFrImage <span class=\"token operator\">=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImRead</span><span class=\"token punctuation\">(</span>pFrImage_file<span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    Mat a <span class=\"token operator\">=</span> Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImRead</span><span class=\"token punctuation\">(</span>pBkImage_file<span class=\"token punctuation\">,</span> ImreadModes<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">,</span> a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">ImShow</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pFrImage\"</span><span class=\"token punctuation\">,</span> pFrImage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pBkImage<span class=\"token punctuation\">.</span><span class=\"token function\">Empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"没有背景图片\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pFrImage<span class=\"token punctuation\">.</span><span class=\"token function\">Empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"没有前景图片\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    pBkImage<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>pBkImage_mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pFrImage<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>pFrImage_mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">;</span>\n\n    x <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pBkImage<span class=\"token punctuation\">.</span>Rows <span class=\"token operator\">/</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    width <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pBkImage<span class=\"token punctuation\">.</span>Cols<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    height <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>pBkImage<span class=\"token punctuation\">.</span>Rows <span class=\"token operator\">/</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//cout &lt;&lt; \"x:  \" &lt;&lt; x &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" y:  \" &lt;&lt; y &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"width:  \" &lt;&lt; width &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" height:  \" &lt;&lt; height &lt;&lt; endl;</span>\n\n    Rect rect <span class=\"token operator\">=</span>new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Rect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pBkImage_mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span>pBkImage<span class=\"token punctuation\">,</span> rect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    pFrImage_mid <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>new <span class=\"token function\">Mat</span><span class=\"token punctuation\">(</span>pFrImage<span class=\"token punctuation\">,</span> rect<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n    <span class=\"token comment\">//namedWindow(\"pBkImage_mid\", CV_WINDOW_AUTOSIZE);</span>\n    <span class=\"token comment\">//imshow(\"pBkImage_mid\", pBkImage_mid);</span>\n    <span class=\"token comment\">//namedWindow(\"pFrImage_mid\", CV_WINDOW_AUTOSIZE);</span>\n    <span class=\"token comment\">//imshow(\"pFrImage_mid\", pFrImage_mid);</span>\n\n    <span class=\"token keyword\">int</span> scale <span class=\"token operator\">=</span> <span class=\"token number\">640</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>image_size <span class=\"token operator\">=</span> new <span class=\"token keyword\">int</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">redefineWH</span><span class=\"token punctuation\">(</span>pBkImage_mid<span class=\"token punctuation\">.</span>Cols<span class=\"token punctuation\">,</span> pBkImage_mid<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span>scale<span class=\"token punctuation\">,</span> image_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//Cv2.Resize(pBkImage_mid, pBkImage_resize, new OpenCvSharp.Size(image_size[0], image_size[1]), InterpolationFlags.Linear);           //按照计算的x和y进行resize</span>\n    <span class=\"token comment\">//Cv2.Resize(pFrImage_mid, pFrImage_resize, new OpenCvSharp.Size(image_size[0], image_size[1]), InterpolationFlags.Linear);           //按照计算的x和y进行resize</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">Resize</span><span class=\"token punctuation\">(</span>pBkImage_mid<span class=\"token punctuation\">,</span> pBkImage_resize<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span>image_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> image_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">//按照计算的x和y进行resize</span>\n    Cv2<span class=\"token punctuation\">.</span><span class=\"token function\">Resize</span><span class=\"token punctuation\">(</span>pFrImage_mid<span class=\"token punctuation\">,</span> pFrImage_resize<span class=\"token punctuation\">,</span> new OpenCvSharp<span class=\"token punctuation\">.</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span>image_size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> image_size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">//按照计算的x和y进行resize</span>\n\n\n    <span class=\"token comment\">//cout &lt;&lt; \"pBkImage_resize.col: v \" &lt;&lt; pBkImage_resize.cols &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" pBkImage_resize.rows: v \" &lt;&lt; pBkImage_resize.rows &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"pFrImage_resize.col: v \" &lt;&lt; pFrImage_resize.cols &lt;&lt; endl;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \" pFrImage_resize.rows: v \" &lt;&lt; pFrImage_resize.rows &lt;&lt; endl;</span>\n\n    <span class=\"token comment\">//namedWindow(\"pBkImage_resize\", CV_WINDOW_AUTOSIZE);</span>\n    <span class=\"token comment\">//imshow(\"pBkImage_resize\", pBkImage_resize);</span>\n    <span class=\"token comment\">//namedWindow(\"pFrImage_resize\", CV_WINDOW_AUTOSIZE);</span>\n    <span class=\"token comment\">//imshow(\"pFrImage_resize\", pFrImage_resize);</span>\n\n    <span class=\"token keyword\">int</span> flag <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    flag <span class=\"token operator\">=</span> <span class=\"token function\">target_judgment</span><span class=\"token punctuation\">(</span>pBkImage_resize<span class=\"token punctuation\">,</span> pFrImage_resize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">//cout &lt;&lt; \"flag 的值为： \" &lt;&lt; flag &lt;&lt; endl;</span>\n    <span class=\"token comment\">//waitKey(0);</span>\n    System<span class=\"token punctuation\">.</span>Diagnostics<span class=\"token punctuation\">.</span>Debug<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> flag<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 1, "csharp": 1, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2021-08-29 22:57:36", "summary": "使用一、的安装、需要安装两个拓展包：和、出错二、使用的一些代码、需要加头文件、读取图片、定义一个没有初始化的图片作为复制、灰度化、高斯模糊和数据格式的定义、二值化、开闭运算、查找轮廓和参数的定义和操作"}