{"blogid": "123472064", "writerAge": "码龄8年", "writerBlogNum": "423", "writerCollect": "5040", "writerComment": "415", "writerFan": "1297", "writerGrade": "7级", "writerIntegral": "13664", "writerName": "牛奶咖啡13", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123472064.jpg", "writerRankTotal": "861", "writerRankWeekly": "7439", "writerThumb": "764", "writerVisitNum": "1615941", "blog_read_count": "1928", "blog_time": "于 2022-03-14 10:47:16 发布", "blog_title": "C#打开指定目录、打开指定目录且选中指定文件、打开指定文件", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<h1>一、实现内容</h1>\n<h2>1.1、实现的功能</h2>\n<p>想要实现：</p>\n<p>①打开指定的目录；</p>\n<p>②打开指定的目录且选中指定文件；</p>\n<p>③打开指定文件</p>\n<h2>1.2、实现的效果</h2>\n<p><img alt=\"\" height=\"972\" src=\"https://img-blog.csdnimg.cn/07993e7fe8a140e8a6d2b3fadaf2f6c8.gif\" width=\"1200\"/></p>\n<h1>二、实现操作</h1>\n<pre><code class=\"language-cs\">        /// &lt;summary&gt;\n        /// 打开目录\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"folderPath\"&gt;目录路径（比如：C:\\Users\\Administrator\\）&lt;/param&gt;\n        private static void OpenFolder(string folderPath)\n        {\n            if (string.IsNullOrEmpty(folderPath)) return;\n\n            Process process = new Process();\n            ProcessStartInfo psi = new ProcessStartInfo(\"Explorer.exe\");\n            psi.Arguments = folderPath;\n            process.StartInfo = psi;\n\n            try\n            {\n                process.Start();\n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n            finally\n            {\n                process?.Close();\n\n            }\n\n        }\n\n        /// &lt;summary&gt;\n        /// 打开目录且选中文件\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"filePathAndName\"&gt;文件的路径和名称（比如：C:\\Users\\Administrator\\test.txt）&lt;/param&gt;\n        private static void OpenFolderAndSelectedFile(string filePathAndName)\n        {\n            if (string.IsNullOrEmpty(filePathAndName)) return;\n\n            Process process = new Process();\n            ProcessStartInfo psi = new ProcessStartInfo(\"Explorer.exe\");\n            psi.Arguments = \"/e,/select,\"+filePathAndName;\n            process.StartInfo = psi;\n\n            //process.StartInfo.UseShellExecute = true;\n            try\n            {\n                process.Start();\n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n            finally\n            {\n                process?.Close();\n\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// 打开文件\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"filePathAndName\"&gt;文件的路径和名称（比如：C:\\Users\\Administrator\\test.txt）&lt;/param&gt;\n        /// &lt;param name=\"isWaitFileClose\"&gt;是否等待文件关闭（true：表示等待）&lt;/param&gt;\n        private static void OpenFile(string filePathAndName,bool isWaitFileClose=true)\n        {\n            Process process = new Process();\n            ProcessStartInfo psi = new ProcessStartInfo(filePathAndName);\n            process.StartInfo = psi;\n\n            process.StartInfo.UseShellExecute = true;\n\n            try\n            {\n                process.Start();\n\n                //等待打开的程序关闭\n                if (isWaitFileClose)\n                {\n                    process.WaitForExit();\n                }\n                \n            }\n            catch (Exception ex)\n            {\n                throw ex;\n            }\n            finally\n            {\n                process?.Close();\n               \n            }\n        }</code></pre>\n<h1>三、Windows 资源管理器参数说明</h1>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:660px;\"><caption>\n  Windows资源管理器参数的说明\n </caption><tbody><tr><td style=\"width:53px;\">序号</td><td style=\"width:106px;\">参数命令</td><td style=\"width:499px;\">说明</td></tr><tr><td style=\"width:53px;\">1</td><td style=\"width:106px;\">Explorer /n</td><td style=\"width:499px;\">此命令使用默认设置打开一个资源管理器窗口。显示的内容通常是安装 Windows 的驱动器的根目录</td></tr><tr><td style=\"width:53px;\">2</td><td style=\"width:106px;\">Explorer /e</td><td style=\"width:499px;\">此命令使用默认视图启动 Windows 资源管理器</td></tr><tr><td style=\"width:53px;\">3</td><td style=\"width:106px;\">Explorer /e,C:\\Windows</td><td style=\"width:499px;\">此命令使用默认视图启动 Windows 资源管理器，并把焦点定位在 C:\\Windows路径上</td></tr><tr><td style=\"width:53px;\">4</td><td style=\"width:106px;\">Explorer /root, C:\\Windows\\Cursors</td><td style=\"width:499px;\">此命令启动 Windows 资源管理器后焦点定位在 C:\\Windows\\Cursors folder路径上。此示例使用 C:\\Windows\\Cursors 作为 Windows 资源管理器的“根”目录</td></tr><tr><td style=\"width:53px;\">5</td><td style=\"width:106px;\">Explorer /select, C:\\Windows\\Cursors\\banana.ani</td><td style=\"width:499px;\">此命令启动 Windows 资源管理器后选定“C:\\Windows\\Cursors\\banana.ani”文件。</td></tr><tr><td style=\"width:53px;\">6</td><td style=\"width:106px;\">Explorer /root, \\\\server\\share, select, Program.exe</td><td style=\"width:499px;\">此命令启动 Windows 资源管理器时以远程共享作为“根”文件夹，而且 Program.exe 文件将被选中</td></tr></tbody></table>\n<p></p>\n<p><a class=\"has-card\" href=\"https://devblogs.microsoft.com/scripting/how-can-i-start-windows-explorer-opened-to-a-specific-folder/\" title=\"How Can I Start Windows Explorer Opened to a Specific Folder? - Scripting Blog (microsoft.com)\"><span class=\"link-card-box\"><span class=\"link-title\">How Can I Start Windows Explorer Opened to a Specific Folder? - Scripting Blog (microsoft.com)</span><span class=\"link-link\"><img alt=\"icon-default.png?t=M276\" class=\"link-link-icon\" src=\"..\\..\\static\\image\\icon-default.png\"/>https://devblogs.microsoft.com/scripting/how-can-i-start-windows-explorer-opened-to-a-specific-folder/</span></span></a> </p>\n</div>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-03-14 10:47:16", "summary": "一、实现内容、实现的功能想要实现：打开指定的目录；打开指定的目录且选中指定文件；打开指定文件、实现的效果二、实现操作打开目录目录路径比如：打开目录且选中文件文件的路径和名称比如：打开文件文件的路径和名"}