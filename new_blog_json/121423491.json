{"blogid": "121423491", "writerAge": "码龄3年", "writerBlogNum": "176", "writerCollect": "1149", "writerComment": "129", "writerFan": "1063", "writerGrade": "5级", "writerIntegral": "2317", "writerName": "二琳爱吃肉", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121423491.jpg", "writerRankTotal": "8969", "writerRankWeekly": "14504", "writerThumb": "304", "writerVisitNum": "163766", "blog_read_count": "3025", "blog_time": "已于 2022-04-18 14:14:23 修改", "blog_title": "手把手教你用SQLServer连接Visual Studio2019并编写一个学生信息管理页面", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"-toc\" style=\"margin-left:0px;\"></p>\n<p id=\"%E5%AE%89%E8%A3%85SQLServer-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%AE%89%E8%A3%85SQLServer\">安装SQLServer</a></p>\n<p id=\"%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE\">创建新项目</a></p>\n<p id=\"%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E8%A1%A8-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E8%A1%A8\">建数据库建表</a></p>\n<p id=\"%E7%AA%97%E4%BD%93%E8%AE%BE%E8%AE%A1-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%AA%97%E4%BD%93%E8%AE%BE%E8%AE%A1\">窗体设计</a></p>\n<p id=\"%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-toc\" style=\"margin-left:0px;\"><a href=\"#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\">代码实现</a></p>\n<p id=\"%C2%A0%E6%95%B4%E4%BD%93%E6%95%88%E6%9E%9C-toc\" style=\"margin-left:0px;\"><a href=\"#%C2%A0%E6%95%B4%E4%BD%93%E6%95%88%E6%9E%9C\"> 整体效果</a></p>\n<p id=\"%E2%80%8B-toc\" style=\"margin-left:0px;\"><a href=\"#%E2%80%8B\">​</a></p>\n<hr id=\"hr-toc\"/>\n<h1 id=\"%E5%AE%89%E8%A3%85SQLServer\">安装SQLServer</h1>\n<p>用SQLServer连接Visual Studio,首先需要下载SQLServer app。</p>\n<p>下载教程，我之前写过，可以点击如下链接先下载安装SQLServer：</p>\n<p><img alt=\"\" height=\"26\" src=\"..\\..\\static\\image\\58cb5f9eeda443f78a904bbe59627eff.png\" width=\"25\"/></p>\n<p><a class=\"link-info\" href=\"https://blog.csdn.net/weixin_45906196/article/details/121206306?spm=1001.2014.3001.5501\" title=\"SQL Server(express)安装教程\">SQL Server(express)安装教程</a></p>\n<p></p>\n<h1 id=\"%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE\">创建新项目</h1>\n<p></p>\n<p>安装好SQL之后，打开VisualStudio2019，新建一个window项目</p>\n<p>，步骤如下：选择<strong>创建新项目 </strong></p>\n<p><img alt=\"\" height=\"850\" src=\"..\\..\\static\\image\\1b097ad913824d519bd47691a807c61f.png\" width=\"1200\"/></p>\n<p>选择<strong>Windows窗体应用(.NET Framework)  </strong>点击下一步。</p>\n<p><img alt=\"\" height=\"850\" src=\"..\\..\\static\\image\\06545e72fa654123a558794b672bcf01.png\" width=\"1200\"/></p>\n<p>给文件命名为：<strong>WinFormsApplicationStudentManagement </strong>,点击下一步</p>\n<p> <img alt=\"\" height=\"850\" src=\"..\\..\\static\\image\\d561746864d54206b94f9b478d221c65.png\" width=\"1200\"/></p>\n<p> 点击创建，就建好了</p>\n<p><img alt=\"\" height=\"850\" src=\"..\\..\\static\\image\\dc4c8450e27c4cba80fd2a84cfece6ea.png\" width=\"1200\"/></p>\n<h1 id=\"%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E8%A1%A8\">建数据库建表</h1>\n<p>项目建好之后我们先连接数据库。</p>\n<p>1.找到服务器资源管理器</p>\n<p>2.找到数据连接，右键，添加连接</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\6ed4872150b64e1f95621de8ee244a1d.png\" width=\"1200\"/></p>\n<p>数据源选择<strong>Microsoft SQL Server数据库文件（SqlClient）</strong></p>\n<p>数据库文件名输入<strong>StudentManagement </strong>这是我们创建的数据库的名称</p>\n<p>登录方式身份验证，选<strong>Windows身份验证</strong></p>\n<p>点击<strong>确定</strong></p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\d0a5e91948da44589e7fb2a3a3c75c25.png\" width=\"1200\"/></p>\n<p>点击<strong>是 </strong>这样就建好了数据库</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\a526b01a02064488804cf48e9b2bbf2a.png\" width=\"1200\"/></p>\n<p> 下面我们新建两个表。</p>\n<p>一个student表，存储学号(主键）、姓名、年龄、分数。</p>\n<p>一个college表，存储专业号（主键），和专业名。</p>\n<p>按照步骤：</p>\n<p>选择刚建好的数据库，双击打开。</p>\n<p>打开后找到表，右键，选择<strong>添加新表</strong>。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\573edea0cf9743259ffc2de800a5485b.png\" width=\"1200\"/></p>\n<p> 添加新表后，会出现如下界面：</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\bd9d3b649c3f457587a2684ee9b477dd.png\" width=\"1200\"/></p>\n<p>按照我这样设计表，设计完成后，点击<strong>更新  </strong>注意要更改表名。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\197399ba5c314d80a0ae6b22dc58b0fc.png\" width=\"1200\"/> 点击更新后，会出现如下界面：点击<strong>更新数据库</strong>即可。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\a4bee10aab6c43f3850ba614d4387cfe.png\" width=\"1200\"/></p>\n<p></p>\n<p>点击更新数据库按钮。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\dcd8c4a3277343e1b43498c6f52dba19.png\" width=\"1200\"/></p>\n<p> 这是刷新之后的样子，能看到刚才建立的student表。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\3a222c16cecc4a31abbb4739d5cb9cda.png\" width=\"1200\"/></p>\n<p> 同样方法，我们新建一个college表。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\4439cbf9dbb148be8bc42ead7b3ccdc9.png\" width=\"1200\"/></p>\n<p> 这是college表建好之后的样子。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\8815edbf40934f9ba29942db4db5fa95.png\" width=\"1200\"/></p>\n<h1 id=\"%E7%AA%97%E4%BD%93%E8%AE%BE%E8%AE%A1\">窗体设计</h1>\n<p>表建好了，我们开始设计窗体。</p>\n<p>打开<strong>Form1.cs[Design]</strong></p>\n<p>设计如下页面</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\071af39050c14c95a375576a50757293.png\" width=\"1200\"/></p>\n<p> 布局如下：</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\ef86f99d5f61418780bb7537bfa693c2.png\" width=\"1200\"/></p>\n<p>组件在<strong>工具箱</strong>中添加；</p>\n<p>组件name text 事件在<strong>属性</strong>中编辑</p>\n<p>左部：name=groupbox1 text=学生列表</p>\n<p>中间：name=groupbox2 text=学生详情</p>\n<p>右边：name=groupbox3 text=操作</p>\n<p>下边：richtextbox name=rtxtStudentList</p>\n<p>写完是这样的。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\be930dff5161424dae16e72c9f5b6c2c.png\" width=\"1200\"/></p>\n<p> 再来设计里面的界面：</p>\n<p></p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\b4667dd82eaa47229cd2e6a86249e68b.png\" width=\"1200\"/></p>\n<p>设计好之后</p>\n<p>给<strong>label</strong>改text 分别改成 学号 姓名 年龄 分数</p>\n<p>给<strong>textbox</strong>改name 分别是txtId txtName txtAge txtScore</p>\n<p>给<strong>button</strong>改name和text</p>\n<p>name分别改成 btnnew btnInsert btnUpdate btnDelete btnSave</p>\n<p>text分别改成 新建 插入 更新 删除 保存</p>\n<p>给<strong>ComboBox</strong>改name改成cboColleges</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\a896ee4fe79643efbe42057da4bf655d.png\" width=\"1200\"/></p>\n<p> 忘了，学生列表里还要建一个listbox 名字是listStudent</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\5495322118dd41afa82fd31e6d56de96.png\" width=\"1200\"/></p>\n<p> 布局部分完成了。</p>\n<p>开始写代码了。</p>\n<h1 id=\"%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\">代码实现</h1>\n<p>我们使用的是Sqlconnection连接数据库，所以要新增引用</p>\n<p>using System.Data.SqlClient;</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\d53a56df3c254372812dfc9f293c418f.png\" width=\"1200\"/></p>\n<p>找到数据库，右键属性，找到连接字符串，全选复制到代码中。</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\be8f5f0d89064fa6ab10ce3003ddcb49.png\" width=\"1200\"/></p>\n<p> 我这是连好的：</p>\n<p><img alt=\"\" height=\"1039\" src=\"..\\..\\static\\image\\e506ee9186c243a7bdc678164063b1e8.png\" width=\"1200\"/></p>\n<p>之后的代码如下：</p>\n<pre><code class=\"language-cs\">using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.Data.SqlClient;\n\nnamespace WindowsFormsApplicationNonetSql\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n            LoadDatabase();\n            BindStudentList();\n            BindCollegeList();\n        }\n        string connectionString = @\"Data Source=pc\\sqlexpress;Initial Catalog=ailintext;Integrated Security=True\";\n\n        DataSet dataSet = new DataSet();\n\n        DataTable students;\n        DataTable colleges;\n        private void BindStudentList()\n        {\n\n            listStudent.SelectedIndexChanged -= listStudent_SelectedIndexChanged;\n            listStudent.DataSource = students;\n            listStudent.DisplayMember = \"student_name\";\n            listStudent.ValueMember = \"student_id\";\n            listStudent.SelectedIndexChanged += listStudent_SelectedIndexChanged;\n\n        }\n        private void BindCollegeList()\n        {\n\n            listStudent.SelectedIndexChanged -= cboColleges_SelectedIndexChanged;\n            cboColleges.DataSource = colleges;\n            cboColleges.DisplayMember = \"college_name\";\n            cboColleges.ValueMember = \"college_id\";\n            listStudent.SelectedIndexChanged += cboColleges_SelectedIndexChanged;\n\n        }\n\n        private void LoadDatabase()\n        {\n            SqlConnection connection =new SqlConnection(connectionString);\n\n            string selectCommand = \"select * from student\";\n\n            SqlCommand command = new SqlCommand();\n            command.CommandText = selectCommand;\n            command.Connection = connection;\n            //适配器\n            SqlDataAdapter studentAdapter = new SqlDataAdapter();\n            studentAdapter.SelectCommand = command;\n            //读入数据 适配器填充数据\n            studentAdapter.Fill(dataSet, \"student\");\n\n            students = dataSet.Tables[\"student\"];\n            /*command.CommandText = \"select * from college\";*/\n\n            /* SqlDataAdapter collegeAdapter = new SqlDataAdapter(command);\n             collegeAdapter.Fill(dataSet, \"college\");\n\n             colleges = dataSet.Tables[\"college\"];*/\n            students.PrimaryKey = new DataColumn[]\n            {\n               students.Columns[\"student_id\"]\n            };\n\n\n            selectCommand = \"select * from college\";\n            command.CommandText = selectCommand;\n\n            SqlDataAdapter collegeAdapter = new SqlDataAdapter();\n            collegeAdapter.SelectCommand = command;\n\n            collegeAdapter.Fill(dataSet, \"college\");\n            colleges = dataSet.Tables[\"college\"];\n\n            colleges.PrimaryKey = new DataColumn[]\n            {\n                colleges.Columns[\"college_id\"]\n            };\n            DataRelation dr = new DataRelation(\n                \"FK_student_college\",\n                colleges.Columns[\"college_id\"],\n                students.Columns[\"college_id\"]);\n\n            dataSet.Relations.Add(dr);\n        }\n\n        private void listStudent_SelectedIndexChanged(object sender, EventArgs e)\n        {\n            //点击学生姓名，返回学生信息\n            if (listStudent.SelectedIndex &lt; 0)\n            {\n                return ;\n            }\n            //拿到信息\n            DataRow student = students.Rows.Find(listStudent.SelectedValue);\n            //显示信息\n            txtId.Text = student[\"student_id\"].ToString();\n            txtName.Text = student[\"student_name\"].ToString();\n            txtAge.Text = student[\"student_age\"].ToString();\n            txtScore.Text = student[\"student_score\"].ToString();\n\n            cboColleges.SelectedValue = student[\"college_id\"];\n\n        }\n\n        private void btnnew_Click(object sender, EventArgs e)\n        {\n            txtId.Text = string.Empty;\n            txtName.Text = string.Empty;\n            txtAge.Text = string.Empty;\n            txtScore.Text = string.Empty;\n        }\n\n        private void btnInsert_Click(object sender, EventArgs e)\n        {\n            DataRow newStudent = students.NewRow();\n\n            newStudent[\"student_id\"] = txtId.Text;\n            newStudent[\"student_name\"] = txtName.Text;\n            newStudent[\"student_age\"] = txtAge.Text;\n            newStudent[\"student_score\"] = txtScore.Text;\n\n            students.Rows.Add(newStudent);\n        }\n\n        private void btnUpdate_Click(object sender, EventArgs e)\n        {\n            if (string.IsNullOrEmpty(txtId.Text))\n            {\n                return;\n            }\n\n            listStudent.SelectedIndexChanged -= listStudent_SelectedIndexChanged;\n\n            DataRow oldStudent = students.Rows.Find(txtId.Text);\n\n            oldStudent[\"student_id\"] = txtId.Text;\n            oldStudent[\"student_name\"] = txtName.Text;\n            oldStudent[\"student_age\"] = txtAge.Text;\n            oldStudent[\"student_score\"] = txtScore.Text;\n\n            if (cboColleges.SelectedIndex &gt;= 0)\n            {\n                oldStudent[\"college_id\"] = cboColleges.SelectedValue;\n            }\n            listStudent.SelectedIndexChanged += listStudent_SelectedIndexChanged;\n        }\n\n        private void btnSave_Click(object sender, EventArgs e)\n        {\n            SqlConnection connection = new SqlConnection(connectionString);\n\n            string selectCommand = \"select * from student\";\n\n            SqlCommand command = new SqlCommand();\n            //command.CommandText = \"select * from student\";\n            command.CommandText = selectCommand;\n            command.Connection = connection;\n            //适配器\n            SqlDataAdapter studentAdapter = new SqlDataAdapter();\n            studentAdapter.SelectCommand = command;\n            //\n            SqlCommandBuilder studentCommandBuilder = new SqlCommandBuilder();\n            studentCommandBuilder.DataAdapter = studentAdapter;\n\n            studentAdapter.Update(students);\n        }\n\n        private void btnDelete_Click(object sender, EventArgs e)\n        {\n            if (string.IsNullOrEmpty(txtId.Text))\n            {\n                return;\n            }\n            DataRow oldStudent = students.Rows.Find(txtId.Text);\n            oldStudent.Delete();\n        }\n\n        private void cboColleges_SelectedIndexChanged(object sender, EventArgs e)\n        {\n            if (cboColleges.SelectedIndex &lt; 0)\n            {\n                return;\n            }\n\n            DataRow college = colleges.Rows.Find(cboColleges.SelectedValue);\n\n            string s = string.Empty;\n\n            foreach(var item in college.GetChildRows(dataSet.Relations[\"FK_student_college\"]))\n            {\n                s += item[\"student_id\"] + \"\\t\" + item[\"student_name\"];\n            }\n            rtxtStudentList.Text = s;\n        }\n    }\n}\n//单表改</code></pre>\n<h1 id=\"%C2%A0%E6%95%B4%E4%BD%93%E6%95%88%E6%9E%9C\"> 整体效果</h1>\n<h1 id=\"%E2%80%8B\" style=\"text-align:center;\"><img alt=\"\" src=\"https://img-blog.csdnimg.cn/0bf2bcde301a48abb8fe7f1ffd9d47c0.gif\"/></h1>\n<p>源码下载：</p>\n<blockquote>\n<p>链接：https://pan.baidu.com/s/1AksyhybGOjPy_3sgX_YqYw<br/> 提取码：5ae1</p>\n</blockquote>\n<p>用我的代码 改一下数据库连接字符串即可。仍有问题可以私信我，看到就回~</p>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-04-18 14:14:23", "summary": "目录安装创建新项目建数据库建表窗体设计代码实现整体效果安装用连接首先需要下载。下载教程，我之前写过，可以点击如下链接先下载安装：安装教程安装教程创建新项目安装好之后，打开，新建一个项目，步骤如下：选择"}