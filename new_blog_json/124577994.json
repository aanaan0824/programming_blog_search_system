{"blogid": "124577994", "writerAge": "码龄5年", "writerBlogNum": "18", "writerCollect": "368", "writerComment": "18", "writerFan": "19", "writerGrade": "2级", "writerIntegral": "273", "writerName": "一位代码", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_124577994.jpg", "writerRankTotal": "51571", "writerRankWeekly": "119846", "writerThumb": "72", "writerVisitNum": "116899", "blog_read_count": "16501", "blog_time": "于 2022-05-04 21:38:00 发布", "blog_title": "pandas—添加新列的常见方法", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>pandas为DataFrame格式数据添加新列的方法非常简单，只需要新建一个列索引，再为其赋值即可。<br/> 以下总结了5种常见添加新列的方法。</p>\n<p>首先，创建一个DataFrame结构数据，作为数据举例。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token comment\"># 创建一个DataFrame结构数据</span>\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'a'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'a0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'b'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'b0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'举例数据情况：\\n'</span><span class=\"token punctuation\">,</span> df<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3d3a330627cf490d8c558558bf61568e.png\"/><br/> 添加新列的方法，如下：<br/> <strong>一、insert()函数</strong><br/> 语法：<br/> DataFrame.insert(loc, column, value,allow_duplicates = False)</p>\n<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>loc</td><td>必要字段，int类型数据，表示插入新列的列位置，原来在该位置的列将向右移。</td></tr><tr><td>column</td><td>必要字段，插入新列的列名。</td></tr><tr><td>value</td><td>必要字段，新列插入的值。如果仅提供一个值，将为所有行设置相同的值。可以是int，string，float等，甚至可以是series /值列表。</td></tr><tr><td>allow_duplicates</td><td>布尔值，用于检查是否存在具有相同名称的列。默认为False，不允许与已有的列名重复。</td></tr></tbody></table>\n<p>实例：插入c列</p>\n<pre><code class=\"prism language-python\">df<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">=</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 在最后一列后，插入值全为3的c列</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入c列：\\n'</span><span class=\"token punctuation\">,</span> df<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\377080384dd84f6182c64f4b9218f2e5.png\"/><br/> <strong>二、直接赋值法</strong><br/> 语法：df[‘新列名’]=新列的值<br/> 实例：插入d列</p>\n<pre><code class=\"prism language-python\">df<span class=\"token punctuation\">[</span><span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 插入值为[1,2,3]的d列</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入d列：\\n'</span><span class=\"token punctuation\">,</span> df<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\faea98f780c048a09ea67e389b82f038.png\"/><br/> 注：该方法不可以选择插入新列的位置，默认为最后一列。如果新增的一列值相同，直接为其赋值一个常量即可；如果插入值不同，为列表格式，需与已有列的行数长度一致，如举例中原来列为3行，新增列也必须有3个值。</p>\n<p><strong>三、reindex()函数</strong><br/> 语法：df.reindex(columns=[原来所有的列名,新增列名],fill_value=值)<br/> reindex()函数用法较多，此处只是针对添加新列的用法<br/> 实例：插入e列</p>\n<pre><code class=\"prism language-python\">df1 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>reindex<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'e'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 不加fill_value参数，默认值为Nan</span>\ndf2 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>reindex<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'e'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> fill_value<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 加入fill_value参数，填充值为1</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入e列(不加fill_value参数)：\\n'</span><span class=\"token punctuation\">,</span> df1<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入e列(加fill_value参数)：\\n'</span><span class=\"token punctuation\">,</span> df2<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f44e6a9490174978b7b6f8c1935b67c9.png\"/><br/> 注：该方法需要把原有的列名和新列名都加上，如果列名过多，就比较麻烦。</p>\n<p><strong>四、concat()函数</strong><br/> 原理：利用拼接的方式，添加新的一列。好处是可以同时新增多个列名。<br/> concat()函数用法较多，此处只是针对添加新列的用法<br/> 实例：插入f列</p>\n<pre><code class=\"prism language-python\">df1 <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>df1<span class=\"token punctuation\">,</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'f'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入f列：\\n'</span><span class=\"token punctuation\">,</span> df1<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1ed674627af548c58e995c66ac1f3738.png\"/><br/> <strong>五、loc()函数</strong><br/> 原理：利用loc的行列索引标签来实现。<br/> 语法：df.loc[:,新列名]=值<br/> 实例：插入g列</p>\n<pre><code class=\"prism language-python\">df1<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'g'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'插入g列：\\n'</span><span class=\"token punctuation\">,</span> df1<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\249c86e7fe4f4e36aad52b9b4fbac7cd.png\"/><br/> 以上就是pandas添加新列的5种常见用法。</p>\n<p>【微信搜索【一位代码】即可关注我】<br/> -end-</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-05-04 21:38:00", "summary": "为格式数据添加新列的方法非常简单，只需要新建一个列索引，再为其赋值即可。以下总结了种常见添加新列的方法。首先，创建一个结构数据，作为数据举例。创建一个结构数据举例数据情况：在这里插入图片描述添加新列的"}