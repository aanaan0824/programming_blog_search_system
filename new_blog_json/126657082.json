{"blogid": "126657082", "writerAge": "ç é¾„99å¤©", "writerBlogNum": "176", "writerCollect": "2299", "writerComment": "180", "writerFan": "774", "writerGrade": "5çº§", "writerIntegral": "3008", "writerName": "Mdc_stdio", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126657082.jpg", "writerRankTotal": "5961", "writerRankWeekly": "245", "writerThumb": "1072", "writerVisitNum": "144618", "blog_read_count": "1037", "blog_time": "äºÂ 2022-09-02 10:15:43Â å‘å¸ƒ", "blog_title": "ã€æ¯•ä¸šè®¾è®¡ã€‘å•ç‰‡æœºå®¶ç”¨ç‡ƒæ°”çš„å¯è§†åŒ–å®æ—¶ç›‘æ§æŠ¥è­¦ä»ª - ç‰©è”ç½‘ åµŒå…¥å¼ stm32", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>æ–‡ç« ç›®å½•</h3>\n<ul><li><a href=\"#0__5\">0 å‰è¨€</a></li><li><a href=\"#1__28\">1 ç®€ä»‹</a></li><li><a href=\"#2__34\">2 ä¸»è¦å™¨ä»¶</a></li><li><a href=\"#3__42\">3 å®ç°æ•ˆæœ</a></li><li><a href=\"#4__50\">4 è®¾è®¡åŸç†</a></li><li><ul><li><a href=\"#41__52\">4.1 ç¡¬ä»¶éƒ¨åˆ†</a></li><li><a href=\"#42__72\">4.2 è½¯ä»¶éƒ¨åˆ†</a></li></ul>\n</li><li><a href=\"#5__79\">5 éƒ¨åˆ†æ ¸å¿ƒä»£ç </a></li><li><a href=\"#6__379\">6 æœ€å</a></li></ul>\n</div>\n<p></p>\n<hr color=\"#000000\" size='1\"'/>\n<h1><a id=\"0__5\"></a>0 å‰è¨€</h1>\n<p>ğŸ”¥ è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦å¦¹å‘Šè¯‰å­¦é•¿è‡ªå·±åšçš„é¡¹ç›®ç³»ç»Ÿè¾¾ä¸åˆ°è€å¸ˆçš„è¦æ±‚ã€‚</p>\n<p>ä¸ºäº†å¤§å®¶èƒ½å¤Ÿé¡ºåˆ©ä»¥åŠæœ€å°‘çš„ç²¾åŠ›é€šè¿‡æ¯•è®¾ï¼Œå­¦é•¿åˆ†äº«ä¼˜è´¨æ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯</p>\n<p>ğŸš© <strong>åŸºäºå•ç‰‡æœºçš„å®¶ç”¨ç‡ƒæ°”çš„å¯è§†åŒ–å®æ—¶ç›‘æ§æŠ¥è­¦ä»ª</strong></p>\n<p>ğŸ¥‡å­¦é•¿è¿™é‡Œç»™ä¸€ä¸ªé¢˜ç›®ç»¼åˆè¯„åˆ†(æ¯é¡¹æ»¡åˆ†5åˆ†)</p>\n<ul><li>éš¾åº¦ç³»æ•°ï¼š4åˆ†</li><li>å·¥ä½œé‡ï¼š4åˆ†</li><li>åˆ›æ–°ç‚¹ï¼š3åˆ†</li></ul>\n<p>ğŸ§¿ <strong>é€‰é¢˜æŒ‡å¯¼, é¡¹ç›®åˆ†äº«ï¼š</strong></p>\n<p><a href=\"https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md\">https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md</a></p>\n<br/>\n<h1><a id=\"1__28\"></a>1 ç®€ä»‹</h1>\n<p>æœ¬é¡¹ç›®è®¾è®¡ä¸»è¦åŠŸèƒ½æ˜¯å¯ä»¥ç”¨äºå®¶ç”¨ç‡ƒæ°”çš„å¯è§†åŒ–å®æ—¶ç›‘æ§çš„è¿·ä½ æŠ¥è­¦å™¨ï¼Œä¼ æ„Ÿå™¨éƒ¨åˆ†å’Œç±³å®¶ç­‰ç»å¤§å¤šæ•°ç½‘ç»œä¸Šçš„å®¶ç”¨ç‡ƒæ°”æŠ¥è­¦ä½¿ç”¨çš„ä¸€è‡´ï¼Œè¿˜æ”¯æŒä¾¿æ·æ›´æ¢ä¼ æ„Ÿå™¨ã€‚å…·å¤‡WIFIæ¨¡å—ï¼Œæ”¯æŒATå‘½ä»¤çš„è®¾ç½®ã€‚</p>\n<h1><a id=\"2__34\"></a>2 ä¸»è¦å™¨ä»¶</h1>\n<ul><li>HK32F031K6U6ä¸»æ§èŠ¯ç‰‡</li><li>SP485EèŠ¯ç‰‡</li><li>ch340eèŠ¯ç‰‡</li><li>MIC5219-3.3ç¨³å‹èŠ¯ç‰‡</li><li>WiFiæ¨¡å—</li></ul>\n<h1><a id=\"3__42\"></a>3 å®ç°æ•ˆæœ</h1>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\9400f0b487e042c4ae54651e946b6509.png\"/></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\2ecc837c88ec41fbbad6b8fe2934d7f9.png\"/><br/> <img alt=\" \" src=\"..\\..\\static\\image\\42c6a7dd78624441a866f847a6367634.png\"/></p>\n<h1><a id=\"4__50\"></a>4 è®¾è®¡åŸç†</h1>\n<h2><a id=\"41__52\"></a>4.1 ç¡¬ä»¶éƒ¨åˆ†</h2>\n<p>æœ¬é¡¹ç›®æ¶‰åŠåˆ°çš„åŠŸèƒ½æ¨¡å—æœ‰ï¼š</p>\n<ul><li>USBè½¬TTLé€šä¿¡</li><li>USBä¸å•ç‰‡æœºé€šä¿¡</li><li>USBä¸WIFIæ¨¡å—é€šä¿¡</li><li>å•ç‰‡æœºé©±åŠ¨OLEDæ¶²æ™¶å±</li><li>å•ç‰‡æœºé©±åŠ¨AHT20/21æ¸©æ¹¿åº¦èŠ¯ç‰‡</li><li>å•ç‰‡æœºPWMé©±åŠ¨èœ‚é¸£å™¨</li><li>å•ç‰‡æœºADé‡‡é›†å¯ç‡ƒä¼ æ„Ÿå™¨çš„ç”µå‹å€¼ç­‰åŠŸèƒ½ã€‚</li></ul>\n<p>å‰é¢å’ŒUSBç›¸å…³çš„æµ‹è¯•æ–¹æ³•å°±æ˜¯æ’ç”µè„‘å’Œæ­£å¸¸ä½¿ç”¨çš„485è½¬æ¥çº¿è¿›è¡Œè¿çº¿ä¼ è¾“ï¼Œå°è¯•ä¸åŒçš„æ³¢ç‰¹ç‡å’Œä¼ è¾“é€Ÿç‡è¿›è¡Œæ”¶å‘é€šä¿¡ï¼Œä¸ä¸¢åŒ…ï¼Œç¨³å®šä¼ è¾“å°±æ˜¯é€šè¿‡æµ‹è¯•ï¼Œå¦åˆ™è¦æ£€æŸ¥ç¡¬ä»¶ç”µè·¯ä¸Šçš„é—®é¢˜ï¼Œæ˜¯å¦æœ‰è™šç„Šå’Œå™¨ä»¶ä¸Šçš„æŸåã€‚<br/> OLEDå’Œæ¸©æ¹¿åº¦èŠ¯ç‰‡é‡‡ç”¨IICç›¸å…³çš„é©±åŠ¨ï¼Œå•è¾“å‡ºIICå¯ä»¥ä¸åŠ ä¸Šæ‹‰ç”µé˜»èƒ½å®ç°åŠŸèƒ½ï¼Œä½†æ˜¯äº¤äº’å¼çš„ï¼Œè¦è·å–æ•°æ®çš„å°±å¿…é¡»åŠ ä¸Šä¸Šæ‹‰ç”µé˜»æ‰èƒ½æ”¶æ•°æ­£å¸¸ã€‚è€Œä¸”ç‡ƒæ°”ä¼ æ„Ÿå™¨æ˜¯å‚¬åŒ–ç‡ƒçƒ§æ–¹å¼çš„ï¼Œæœ¬èº«ä¼šå‘çƒ­ï¼Œä¸”å‘çƒ­é‡è¿˜ä¸å°ï¼Œæ•…åº”è¯¥å°½å¯èƒ½çš„æŠŠæ¸©æ¹¿åº¦èŠ¯ç‰‡å’Œå¯ç‡ƒä¼ æ„Ÿå™¨åˆ†çš„è¿œç‚¹ï¼Œä¸ç„¶æ¸©åº¦å’Œæ¹¿åº¦æµ‹è¯•çš„éƒ½ä¸å‡†ç¡®ã€‚æ¯ä¸ªåŠŸèƒ½æ¨¡å—é€šè¿‡è½¯ä»¶ç¼–ç¨‹å®ç°åŠŸèƒ½åéƒ½è¦è¿›è¡Œå¯¹æ¯”ã€‚å±å¹•é©±åŠ¨æ¯”è¾ƒç›´è§‚ï¼Œçœ‹åˆ°ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆäº†ï¼Œæ¸©æ¹¿åº¦éœ€è¦è¿›è¡Œä¸€å®šçš„è¡¥å¿ã€‚<br/> æœ€åèœ‚é¸£å™¨å’ŒæŒ‰é”®åŠŸèƒ½çš„å¢åŠ ï¼Œèœ‚é¸£å™¨æ˜¯5020çš„å°è£…ï¼Œæƒ³è¦å®ç°æ¯”è¾ƒäº®çš„å£°éŸ³å°±è¦åˆ†æå’Œæµ‹è¯•ï¼Œä¸æ–­è°ƒæ•™ï¼Œæ‰¾åˆ°æ¯”è¾ƒå“äº®çš„èœ‚é¸£å£°ã€‚æŒ‰é”®åŠŸèƒ½å¯ä»¥åšå¾ˆå¤šçš„è”åŠ¨ï¼Œè¿™é‡ŒæŠŠå®ƒåšæˆäº†æ§åˆ¶å±å¹•æ˜¾ç¤ºåè½¬çš„åŠŸèƒ½ã€‚</p>\n<p><strong>ä¸»è¦åŸç†å›¾</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\950b1561e3f141d7b235341e8888b991.png\"/></p>\n<h2><a id=\"42__72\"></a>4.2 è½¯ä»¶éƒ¨åˆ†</h2>\n<p>æ•´ä½“é€»è¾‘æµç¨‹å¦‚ä¸‹ï¼š<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"..\\..\\static\\image\\e821873305704bcfa5e6a6356a44091e.png\"/></p>\n<h1><a id=\"5__79\"></a>5 éƒ¨åˆ†æ ¸å¿ƒä»£ç </h1>\n<pre><code class=\"prism language-c\"><span class=\"token keyword\">void</span> <span class=\"token function\">HAL_Delay_us_init</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> SYSCLK<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n\tfac_us<span class=\"token operator\">=</span>SYSCLK<span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span>\n \n<span class=\"token keyword\">void</span> <span class=\"token function\">HAL_Delay_us</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span> nus<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token class-name\">uint32_t</span> ticks<span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">uint32_t</span> told<span class=\"token punctuation\">,</span>tnow<span class=\"token punctuation\">,</span>tcnt<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">uint32_t</span> reload<span class=\"token operator\">=</span>SysTick<span class=\"token operator\">-&gt;</span>LOAD<span class=\"token punctuation\">;</span>\n\tticks<span class=\"token operator\">=</span>nus<span class=\"token operator\">*</span>fac_us<span class=\"token punctuation\">;</span> \n\ttold<span class=\"token operator\">=</span>SysTick<span class=\"token operator\">-&gt;</span>VAL<span class=\"token punctuation\">;</span> \n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\ttnow<span class=\"token operator\">=</span>SysTick<span class=\"token operator\">-&gt;</span>VAL<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tnow<span class=\"token operator\">!=</span>told<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">{<!-- --></span>\n\t\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tnow<span class=\"token operator\">&lt;</span>told<span class=\"token punctuation\">)</span>tcnt<span class=\"token operator\">+=</span>told<span class=\"token operator\">-</span>tnow<span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">else</span> tcnt<span class=\"token operator\">+=</span>reload<span class=\"token operator\">-</span>tnow<span class=\"token operator\">+</span>told<span class=\"token punctuation\">;</span>\n\t\t\t\ttold<span class=\"token operator\">=</span>tnow<span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tcnt<span class=\"token operator\">&gt;=</span>ticks<span class=\"token punctuation\">)</span><span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span> \n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">/* USER CODE END PFP */</span>\n\n<span class=\"token comment\">/* Private user code ---------------------------------------------------------*/</span>\n<span class=\"token comment\">/* USER CODE BEGIN 0 */</span>\n<span class=\"token comment\">/*\n****************************************************************************************************\n** å‡½æ•°åç§°ï¼š Get_analog_voltage(u8 ch)\n** å®Œæˆæ—¶é—´:  2017.5.24\n** ç¼– å†™ äºº:  DIX\n** å…¥å£å‚æ•°ï¼š u8 ch\n** è¿” å› å€¼ï¼š ç”µå‹å€¼\n** åŠŸèƒ½è¯´æ˜ï¼š ADCä¿¡å·è½¬æ¢ä¸ºç”µå‹å€¼mV\n** å¤‡æ³¨è¯´æ˜ï¼š è·å¾—ADCæ¨¡æ‹Ÿå‡ºçš„ç”µå‹ 12ä½ç²¾åº¦ (0~3.3Vä¹‹é—´çš„mVå€¼)\n****************************************************************************************************\n*/</span>\n<span class=\"token class-name\">uint16_t</span> <span class=\"token function\">Get_analog_voltage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span> AD<span class=\"token punctuation\">)</span>                  \n<span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token class-name\">uint32_t</span> sum<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                                 <span class=\"token comment\">//é‡‡æ ·20æ¬¡çš„ç´¯è®¡å’Œ</span>\n\t<span class=\"token class-name\">uint8_t</span>  count<span class=\"token punctuation\">;</span>\t  \n\t<span class=\"token class-name\">uint16_t</span> A_AD_Value<span class=\"token punctuation\">;</span>                            <span class=\"token comment\">//å•é€šé“ADçš„å˜é‡å€¼</span>\n\tADC_ChannelConfTypeDef sConfig<span class=\"token punctuation\">;</span>\n\thadc<span class=\"token punctuation\">.</span>Instance<span class=\"token operator\">-&gt;</span>CHSELR <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\t\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>AD<span class=\"token operator\">==</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\tsConfig<span class=\"token punctuation\">.</span>Channel <span class=\"token operator\">=</span> ADC_CHANNEL_8<span class=\"token punctuation\">;</span>\t\n\t<span class=\"token punctuation\">}</span>\t\n\t<span class=\"token keyword\">else</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\tsConfig<span class=\"token punctuation\">.</span>Channel <span class=\"token operator\">=</span> ADC_CHANNEL_TEMPSENSOR<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\t\n\tsConfig<span class=\"token punctuation\">.</span>Rank <span class=\"token operator\">=</span> ADC_RANK_CHANNEL_NUMBER<span class=\"token punctuation\">;</span>\n\tsConfig<span class=\"token punctuation\">.</span>SamplingTime <span class=\"token operator\">=</span> ADC_SAMPLETIME_239CYCLES_5<span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">HAL_ADC_ConfigChannel</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>hadc<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>sConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\n\tA_AD_Value<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                                   <span class=\"token comment\">//ADå€¼æ¸…0</span>\n\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>count<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>count<span class=\"token operator\">&lt;</span><span class=\"token number\">50</span><span class=\"token punctuation\">;</span>count<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>                   <span class=\"token comment\">//é‡å¤é‡‡æ ·50æ¬¡</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token function\">HAL_ADCEx_Calibration_Start</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>hadc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">//æ ¡å‡†ADC</span>\n\t\t<span class=\"token function\">HAL_ADC_Start</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>hadc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                         <span class=\"token comment\">//å¼€å¯ADC</span>\n\t\t<span class=\"token function\">HAL_ADC_PollForConversion</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>hadc<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t      <span class=\"token comment\">//ç­‰å¾…è½¬æ¢è¿‡ç¨‹</span>\n\t\tsum <span class=\"token operator\">+=</span> <span class=\"token function\">HAL_ADC_GetValue</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>hadc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//è·å¾—50é‡‡æ ·çš„ç´¯è®¡å’Œ</span>\n\t<span class=\"token punctuation\">}</span>\n\tA_AD_Value<span class=\"token operator\">=</span>sum<span class=\"token operator\">/</span><span class=\"token number\">50</span><span class=\"token punctuation\">;</span>                              <span class=\"token comment\">//ADé‡‡æ ·50æ¬¡åå–å¹³å‡å€¼</span>\n\tA_AD_Value<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint16_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>A_AD_Value<span class=\"token operator\">*</span><span class=\"token number\">3300</span><span class=\"token operator\">/</span><span class=\"token number\">4096</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//æ‰©å¤§äº†1000å€æ•´æ•°ä¸º1mVå€¼</span>\n\t\n\tsum<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>                                          <span class=\"token comment\">//æ¸…0æ€»å€¼</span>\n\t<span class=\"token keyword\">return</span> A_AD_Value<span class=\"token punctuation\">;</span>                              <span class=\"token comment\">//è¿”å›å€¼</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token class-name\">int8_t</span> <span class=\"token function\">Temper_Judgment</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n\t<span class=\"token class-name\">int8_t</span>  temper<span class=\"token punctuation\">;</span>\n\t<span class=\"token class-name\">uint16_t</span> adc_value<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\tadc_value <span class=\"token operator\">=</span> <span class=\"token function\">Get_analog_voltage</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  temper <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">int8_t</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>adc_value<span class=\"token operator\">-</span><span class=\"token number\">449</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">1.61</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">return</span> temper<span class=\"token punctuation\">;</span>                                   <span class=\"token comment\">//è¿”å›å€¼</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//u16è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">u16tostr</span><span class=\"token punctuation\">(</span>u16 dat<span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">{<!-- --></span>\n\tu8 temp<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\tu8 i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>j<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>k<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>dat<span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\ttemp<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>dat<span class=\"token operator\">%</span><span class=\"token number\">10</span><span class=\"token operator\">+</span><span class=\"token number\">0x30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\ti<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n\t\tdat<span class=\"token operator\">/=</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tj<span class=\"token operator\">=</span>i<span class=\"token punctuation\">;</span>\n\tk<span class=\"token operator\">=</span>j<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//\tfor(i=0;i&lt;j;i++)</span>\n<span class=\"token comment\">//\t{<!-- --></span>\n<span class=\"token comment\">//\t\tstr1[i] = temp[j-i-1];</span>\n<span class=\"token comment\">//\t}</span>\n\t<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">&lt;</span><span class=\"token number\">4</span><span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">{<!-- --></span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token operator\">-</span>k<span class=\"token operator\">&gt;</span>i<span class=\"token punctuation\">)</span>\n\t\t\tstr1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span><span class=\"token char\">' '</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">else</span> \n\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t  <span class=\"token comment\">//j=j-1;</span>\n\t\t  str1<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temp<span class=\"token punctuation\">[</span><span class=\"token operator\">--</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\t\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>i<span class=\"token punctuation\">)</span> \n\t<span class=\"token punctuation\">{<!-- --></span>str1<span class=\"token punctuation\">[</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token char\">'0'</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\">//return str1;</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n<span class=\"token comment\">/* USER CODE END 0 */</span>\n\n<span class=\"token comment\">/**\n  * @brief  The application entry point.\n  * @retval int\n  */</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token comment\">/* USER CODE BEGIN 1 */</span>\n\tu8 x<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//\tu32 CT_data[2]={0};</span>\n<span class=\"token comment\">//  volatile float  hum=0,tem=0;   </span>\n  <span class=\"token comment\">/* USER CODE END 1 */</span>\n  \n\n  <span class=\"token comment\">/* MCU Configuration--------------------------------------------------------*/</span>\n\n  <span class=\"token comment\">/* Reset of all peripherals, Initializes the Flash interface and the Systick. */</span>\n  <span class=\"token function\">HAL_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/* USER CODE BEGIN Init */</span>\n\t<span class=\"token function\">HAL_Delay_us_init</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//ç³»ç»Ÿ24MHzæ—¶é’Ÿ</span>\n  <span class=\"token comment\">/* USER CODE END Init */</span>\n\n  <span class=\"token comment\">/* Configure the system clock */</span>\n  <span class=\"token function\">SystemClock_Config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/* USER CODE BEGIN SysInit */</span>\n\n  <span class=\"token comment\">/* USER CODE END SysInit */</span>\n\n  <span class=\"token comment\">/* Initialize all configured peripherals */</span>\n  <span class=\"token function\">MX_GPIO_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_DMA_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_ADC_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_USART2_UART_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_TIM3_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_TIM1_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_TIM2_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_TIM6_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">MX_USART1_UART_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">/* USER CODE BEGIN 2 */</span>\n\t<span class=\"token function\">HAL_TIM_Base_Start_IT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>htim2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                           <span class=\"token comment\">//å¼€å¯å®šæ—¶å™¨2</span>\n\t<span class=\"token function\">HAL_TIM_Base_Start_IT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>htim3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                           <span class=\"token comment\">//å¼€å¯å®šæ—¶å™¨3</span>\n\t<span class=\"token function\">HAL_TIM_Base_Start_IT</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>htim1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                           <span class=\"token comment\">//å¼€å¯å®šæ—¶å™¨6</span>\n  <span class=\"token function\">OLED_Init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\t<span class=\"token function\">OLED_DisplayTurn</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\">//AHT20.alive=!AHT20_Init();\t                             //AHT20æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨åˆå§‹åŒ–</span>\n\t<span class=\"token function\">temphum_init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                          <span class=\"token comment\">//ATH20åˆå§‹åŒ–</span>\n\t<span class=\"token comment\">/*æ‰“å¼€ä¸²å£1ç©ºé—²ä¸­æ–­*/</span>\n  <span class=\"token comment\">//__HAL_UART_ENABLE_IT(&amp;huart2, UART_IT_IDLE);           //ä½¿èƒ½ä¸²å£2ä¸­æ–­</span>\n\t<span class=\"token comment\">/*æ‰“å¼€ä¸²å£1æ¥æ”¶DMAä¸­æ–­*/</span>\n  <span class=\"token comment\">//HAL_UART_Receive_DMA(&amp;huart2,rx_buffer,BUFFER_SIZE);   //ä¸²å£æ¥æ”¶DMAé€šé“\t</span>\n  <span class=\"token comment\">/* USER CODE END 2 */</span>\n\n  <span class=\"token comment\">/* Infinite loop */</span>\n  <span class=\"token comment\">/* USER CODE BEGIN WHILE */</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">/* USER CODE END WHILE */</span>\n\n    <span class=\"token comment\">/* USER CODE BEGIN 3 */</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>btimer<span class=\"token punctuation\">)</span>                                  <span class=\"token comment\">//1sä¸­æ–­</span>\n\t\t<span class=\"token punctuation\">{<!-- --></span>\n\t\t\tbtimer <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>bcont<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//\t\t\tNow_U = Get_analog_voltage(8);            //é‡‡ç”¨å†…éƒ¨ADCé‡‡æ ·</span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\t\t\n\t\t\t\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                             <span class=\"token comment\">//æ¸…å±</span>\n\t\t\t\t<span class=\"token comment\">//HAL_Delay(1000);                          //å»¶æ—¶1ç§’</span>\n\t\t\t\t<span class=\"token function\">OLED_DrawBMP</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>BMP5<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              <span class=\"token comment\">//å›¾ç‰‡æ˜¾ç¤ºLOGO</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">==</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\t\t\n\t\t\t\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                             <span class=\"token comment\">//æ¸…å±</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">//ç¬¬</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//å…­</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//å±Š</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">//ç«‹</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//åˆ›</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//æ¯\t</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                  <span class=\"token comment\">//ç‡ƒ</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">17</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//æ°”</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">19</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//ç›‘\t</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//æµ‹</span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowString(8,4,\"Ex\",16);  </span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowString(0,4,\" O L E D\",16);  </span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowString(0,4,\" 29.1\",16);           //æ•°æ®</span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowCHinese(44,4,21);                 //â„ƒ</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">==</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                             <span class=\"token comment\">//æ¸…å±</span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowString(0,0,\"12.6\",16);           //æ•°æ®</span>\n\t\t\t\t<span class=\"token comment\">//OLED_ShowString(32,0,\"%LEL\",16);          //å¯ç‡ƒå•ä½</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">//æ¸©</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//æ¹¿</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//åº¦\t</span>\n\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\" 26.2\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\">//æ•°æ®</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                <span class=\"token comment\">//â„ƒ</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"50.7\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">//æ•°æ®</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"%RH\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">//æ¹¿åº¦å•ä½</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">&gt;=</span><span class=\"token number\">19</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\tNow_U <span class=\"token operator\">=</span> <span class=\"token function\">Get_analog_voltage</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">//é‡‡ç”¨å†…éƒ¨ADCé‡‡æ ·</span>\n\t\t\t\tTemper<span class=\"token operator\">=</span><span class=\"token function\">Temper_Judgment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">//æ¸©åº¦æ¢ç®—å‡½æ•°</span>\n<span class=\"token comment\">//\t\t\t\t/*--------AHT20è¯»å–æ•°æ®---------*/</span>\n<span class=\"token comment\">//\t\t\t\tif(AHT20.alive)// å¦‚æœAHT20ä¼ æ„Ÿå™¨å­˜åœ¨ï¼Œåˆ™è¯»å–æ¸©æ¹¿åº¦æ•°æ®</span>\n<span class=\"token comment\">//\t\t\t\t{<!-- --></span>\n<span class=\"token comment\">//\t\t\t\t\t//è¯»å–AHT20çš„ 20BitåŸå§‹æ•°æ®</span>\n<span class=\"token comment\">//\t\t\t\t\tAHT20.flag = AHT20_ReadHT(AHT20.HT);</span>\n<span class=\"token comment\">//\t\t\t\t\t//å®é™…æ ‡å‡†å•ä½è½¬æ¢</span>\n<span class=\"token comment\">// \t\t\t\t\tStandardUnitCon(&amp;AHT20);</span>\n<span class=\"token comment\">//\t\t\t\t}</span>\n\t\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">==</span><span class=\"token number\">19</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\t\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                           <span class=\"token comment\">//æ¸…å±</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Now_U<span class=\"token operator\">&gt;=</span><span class=\"token number\">900</span> <span class=\"token operator\">&amp;&amp;</span> Now_U<span class=\"token operator\">&lt;</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//è­¦\t</span>\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//æˆ’</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>Now_U<span class=\"token operator\">&gt;=</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span>\t\n\t\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//å±</span>\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>              <span class=\"token comment\">//é™©</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\t\t\n\t\t\t\t<span class=\"token keyword\">else</span>\n\t\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//å®‰</span>\n\t\t\t\t\t<span class=\"token function\">OLED_ShowCHinese</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>               <span class=\"token comment\">//å…¨</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\t\t\t\n\t\t\t\t<span class=\"token function\">u16tostr</span><span class=\"token punctuation\">(</span>Now_U<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"U:\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>             <span class=\"token comment\">//ç”µå‹</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>str1<span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">//æ•°æ®</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"mV\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            <span class=\"token comment\">//ç”µå‹å•ä½</span>\n\t\t\t  <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowNum</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token function\">Calculate_Concentration</span><span class=\"token punctuation\">(</span>Now_U<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//æ˜¾ç¤ºæµ“åº¦</span>\n\t\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token function\">Calculate_Concentration</span><span class=\"token punctuation\">(</span>Now_U<span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\t\t\t\t\t<span class=\"token function\">HAL_TIM_PWM_Start</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>htim3<span class=\"token punctuation\">,</span>TIM_CHANNEL_4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">else</span>\n\t\t\t\t\t<span class=\"token function\">HAL_TIM_PWM_Stop</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>htim3<span class=\"token punctuation\">,</span>TIM_CHANNEL_4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t  <span class=\"token function\">memset</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"%LEL\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\">//å¯ç‡ƒå•ä½</span>\n\t\t\t\t<span class=\"token function\">OLED_ShowString</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Ex\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>             <span class=\"token comment\">//å¯ç‡ƒæ ‡è‡´</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>bcont<span class=\"token operator\">&gt;=</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">{<!-- --></span>\t\n<span class=\"token comment\">//\t\t\t\tAHT20_Read_CTdata(CT_data);            //ä¸ç»è¿‡CRCæ ¡éªŒï¼Œç›´æ¥è¯»å–AHT20çš„æ¸©åº¦å’Œæ¹¿åº¦æ•°æ® </span>\n<span class=\"token comment\">//        hum = CT_data[0]*100*10/1024/1024;     //è®¡ç®—å¾—åˆ°æ¹¿åº¦å€¼ï¼ˆæ”¾å¤§äº†10å€ï¼‰</span>\n<span class=\"token comment\">//        tem = CT_data[1]*200*10/1024/1024-500; //è®¡ç®—å¾—åˆ°æ¸©åº¦å€¼ï¼ˆæ”¾å¤§äº†10å€ï¼‰</span>\n<span class=\"token comment\">//\t\t\t\tHAL_Delay(2000);                       //å»¶æ—¶1ç§’</span>\n\t\t\t\tbcont<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token punctuation\">}</span>\t\t\t\t\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY_GPIO_Port<span class=\"token punctuation\">,</span> KEY_Pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">{<!-- --></span>\t\t<span class=\"token comment\">//è¯»å–KEYæŒ‰é”®å¼•è„šï¼Œä½ç”µå¹³è¡¨ç¤ºæŒ‰ä¸‹</span>\n\t\t\t<span class=\"token comment\">//HAL_GPIO_TogglePin(LED_GPIO_Port, LED_Pin);\t\t//LEDå¼•è„šç”µå¹³å–å</span>\n\t\t\t<span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t                  <span class=\"token comment\">//å»¶æ—¶</span>\n\t\t\t<span class=\"token function\">OLED_Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n\t\t\tx<span class=\"token operator\">=</span><span class=\"token operator\">!</span>x<span class=\"token punctuation\">;</span>                                           <span class=\"token comment\">//å˜é‡å–å</span>\n\t\t\t<span class=\"token function\">OLED_DisplayTurn</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY_GPIO_Port<span class=\"token punctuation\">,</span> KEY_Pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//ç­‰å¾…æ¾æ‰‹ï¼Œé˜²æ¾æ‰‹æŠ–åŠ¨</span>\n\t\t\t<span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\t\t\t\t\t\t\t                  <span class=\"token comment\">//å»¶æ—¶</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t\n\t<span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">/* USER CODE END 3 */</span>\n<span class=\"token punctuation\">}</span>\n\n\n\n</code></pre>\n<br/>\n<h1><a id=\"6__379\"></a>6 æœ€å</h1>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-02 10:15:43", "summary": "æ–‡ç« ç›®å½•å‰è¨€ç®€ä»‹ä¸»è¦å™¨ä»¶å®ç°æ•ˆæœè®¾è®¡åŸç†ç¡¬ä»¶éƒ¨åˆ†è½¯ä»¶éƒ¨åˆ†éƒ¨åˆ†æ ¸å¿ƒä»£ç æœ€åå‰è¨€è¿™ä¸¤å¹´å¼€å§‹æ¯•ä¸šè®¾è®¡å’Œæ¯•ä¸šç­”è¾©çš„è¦æ±‚å’Œéš¾åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿçš„æ¯•è®¾é¢˜ç›®ç¼ºå°‘åˆ›æ–°å’Œäº®ç‚¹ï¼Œå¾€å¾€è¾¾ä¸åˆ°æ¯•ä¸šç­”è¾©çš„è¦æ±‚ï¼Œè¿™ä¸¤å¹´ä¸æ–­æœ‰å­¦å¼Ÿå­¦"}