{"blogid": "121551959", "writerAge": "码龄7年", "writerBlogNum": "283", "writerCollect": "954", "writerComment": "36", "writerFan": "379", "writerGrade": "5级", "writerIntegral": "3813", "writerName": "上位机软件", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121551959.jpg", "writerRankTotal": "20878", "writerRankWeekly": "25226", "writerThumb": "162", "writerVisitNum": "260336", "blog_read_count": "4237", "blog_time": "于 2021-11-26 10:54:29 发布", "blog_title": "Winform控件开发（7）——ComboBox（史上最全）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>一、属性<br/> 1、DropDownWidth<br/> 设置组合框下拉部分的宽度<br/> 1）没设置前，默认和size属性的width属性一样大，DropDownWidth 为94，当size的width属性为94时，combox如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\54a6333d62e84eb096f171b396d43f77.png\"/><br/> 2）把DropDownWidth 设置为200后，如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0facbae20218474d956d061118161d60.png\"/><br/> 可以看出下拉框的宽度增加了<br/> 2、MaxDropDownItems<br/> 指示下拉部分中显示的最大项数，比如设置该值为5，设置该值时必须将IntegralHeight的属性设置为false，而且DropDownHeight 一定要是默认值106。<br/> 1）MaxDropDownItems为12时，此时combox中的项数是9个<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\90ee0b58fcb341a09e8f1201c1548037.png\"/><br/> 2）MaxDropDownItems为5时，此时combox中的项数是9个</p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\50f86c0a16db4f6996e6b79b9eaae8a9.png\"/><br/> 可以看出被隐藏了4个项，其余的项被隐藏在滚动条中，无论滚动条怎么滚动，下拉框始终只显示5个项。<br/> 3、IntegralHeight<br/> 指示控件是否调整大小以避免只显示项的局部，如果该属性设置为true，那么MaxDropDownItems的属性将失效，控件将不再限制显示的最大项数。<br/> 4、MaxLength<br/> 指定在组合框中输入的字符数<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9600ba02773c4a0b9f7e7f2be7ab7905.png\"/><br/> 当设置该属性为1时，手动是无法输入超过一个字符的，但是通过代码可以为combox的添加多余一个字符的项，只是不能通过鼠标输入超过这个属性的字符数。<br/> 5、Sorted<br/> 指示是否对组合框中的项进行了排序</p>\n<pre><code class=\"prism language-csharp\"> comboBox3<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">.</span><span class=\"token function\">AddRange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"3\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"4\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"5\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"6\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"7\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"8\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"9\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>为combox添加项的方式是使用addrange方法，添加一个数组<br/> 1）sorted为false时如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e58fcc0cb36446fa86ad1a45b1c35a6c.png\"/><br/> 2）如果设置sorted为true时，如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\55884a0cefc3445bbbb1b4f2ad7cf97e.png\"/><br/> 其实就是从小到大按照字母排序<br/> 注意：<br/> comboBox3.DataSource=new string[] { “2”, “1”, “3”, “4”, “5”, “6”, “7”, “8”, “9” };<br/> 如果使用绑定datasource这种方式的话，就不能将combox的sorted属性设置为true了，否则要么报错，要么就是combox根本就不显示绑定的项了。</p>\n<p>6、ItemHeight<br/> 如果DrawMode 为Normal时，ItemHeight是不能更改的，只有其他两种DrawMode 模式时才可以更改ItemHeight属性</p>\n<p>7、DropDownHeight<br/> 该属性默认值是106，如果随意更改会对MaxDropDownItems等属性产生影响，在DrawMode 为normal时，如果更改了DropDownHeight 属性，一档绑定数据以后，该属性就失效了。</p>\n<p>8、Items<br/> 获取一个bjectCollectio类型的集合对象，然后可以对该集合进行各种操作，这些操作也会反映到combox的显示上</p>\n<pre><code class=\"prism language-csharp\"> <span class=\"token class-name\">ComboBox<span class=\"token punctuation\">.</span>ObjectCollection</span> objectCollection <span class=\"token operator\">=</span> comboBox3<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">;</span>\n\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//添加单个项</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">AddRange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//添加多个项，必须是Object类型的数组</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//清除对象中所有成员</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> index <span class=\"token operator\">=</span> objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">IndexOf</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//根据某项来获取该项的索引</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Insert</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"100\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//在指定索引处插入一项，索引从0开始</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">RemoveAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//根据索引删掉指定项</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> isContains <span class=\"token operator\">=</span> objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Contains</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//判断某个项是不是在集合中</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> array <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">object</span></span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">CopyTo</span><span class=\"token punctuation\">(</span>array<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//将集合复制到指定数组，并指定目标数组开始有数据的索引</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> count <span class=\"token operator\">=</span> objectCollection<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span>\n            objectCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Remove</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//根据项的内容删除指定项，如果没有该项啥事不发生，</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">object</span></span> obj <span class=\"token operator\">=</span> objectCollection<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//根据索引来获取项的值</span>\n</code></pre>\n<p>9、DropDownStyle<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\178adc700d134165901735218c3c8d9c.png\"/><br/> 1)DropDown<br/> 有下拉箭头，，并且text属性可以编辑，这个编辑的用处是可以吧combox做成具有模糊查询的功能化，比如改变text时，在textchange事件中判断，如果哪个项具有和输入的text比较相似，则直接将selectindex变成该项，这个好处是在这个项的数量非常多时，如果通过下拉列表来选择某一项的话比较困难，通过模糊查找功能可以帮助用户快速定位要选择的项；</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">comboBox3_TextChanged</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> str <span class=\"token operator\">=</span> comboBox3<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> obj <span class=\"token operator\">=</span> comboBox3<span class=\"token punctuation\">.</span>Items<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> item <span class=\"token keyword\">in</span> obj<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Contains</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> index <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">.</span><span class=\"token function\">IndexOf</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                comboBox3<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">=</span> index<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>当输入1时，直接将选中项调整到111<br/> 2）DropDownList<br/> 用户不能编辑text属性，所以只能通过下拉列表来选择某一项<br/> 3）Simple<br/> 没有下拉列表，只能实现模糊查询的功能，当不需要下拉列表但是又需要实现根据输入的text查询到应该选中某一项时可以使用。<br/> 10、FlatStyle<br/> 改变combox的外观<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7ac27f39f087470f979064d06bcd939c.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f4f8bf40161e47ddbc946a541530441f.png\"/><br/> 只有以上两种形式<br/> 11、Font、forecolor、righttoleft、Text<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\36b75e15a8e34b848a19f1bfbb0c9a0e.png\"/><br/> 12、DrawMode<br/> 1)DrawMode.Normal<br/> 只能控制项的宽度，不能控制项的高度<br/> 2）DrawMode.OwnerDrawFixed<br/> 即能控制项的高度，也能控制项的宽度，而且可以在项里面随便自定义画东西，但是每项的项的高度不能改变，MeasureItem事件不会触发，MeasureItem事件用于控制每一项的高度，代码如下：</p>\n<pre><code class=\"prism language-csharp\">  <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">InitializeComboBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ComboBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DrawMode <span class=\"token operator\">=</span>\n                System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>DrawMode<span class=\"token punctuation\">.</span>OwnerDrawFixed<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Location <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Name <span class=\"token operator\">=</span> <span class=\"token string\">\"ComboBox1\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Size <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>ItemHeight <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DropDownWidth <span class=\"token operator\">=</span> <span class=\"token number\">250</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>TabIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DropDownStyle <span class=\"token operator\">=</span> ComboBoxStyle<span class=\"token punctuation\">.</span>DropDown<span class=\"token punctuation\">;</span>\n            animals <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"Elephant\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c r o c o d i l e\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lion\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n            ComboBox1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> animals<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>Controls<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// Hook up the MeasureItem and DrawItem events</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DrawItem <span class=\"token operator\">+=</span>\n                <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DrawItemEventHandler</span><span class=\"token punctuation\">(</span>ComboBox1_DrawItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n         \n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\">  <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ComboBox1_DrawItem</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span>\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>DrawItemEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">float</span></span> size <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Font</span> myFont<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">FontFamily</span> family <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color</span> animalColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>Gray<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericSansSerif<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>LawnGreen<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericMonospace<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>Tan<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericSansSerif<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token comment\">// Draw the background of the item.</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">DrawBackground</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n           \n\n            <span class=\"token comment\">// Create a square filled with the animals color. Vary the size</span>\n            <span class=\"token comment\">// of the rectangle based on the length of the animals name.</span>\n            <span class=\"token class-name\">Rectangle</span> rectangle <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Top <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                    e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height <span class=\"token operator\">-</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">.</span><span class=\"token function\">FillRectangle</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SolidBrush</span><span class=\"token punctuation\">(</span>animalColor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rectangle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//绘制一个带有颜色的矩形</span>\n\n            <span class=\"token comment\">// Draw each string in the array, using a different size, color,</span>\n            <span class=\"token comment\">// and font for each item.</span>\n            myFont <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Font</span><span class=\"token punctuation\">(</span>family<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> FontStyle<span class=\"token punctuation\">.</span>Bold<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">.</span><span class=\"token function\">DrawString</span><span class=\"token punctuation\">(</span>animals<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> myFont<span class=\"token punctuation\">,</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Brushes<span class=\"token punctuation\">.</span>Black<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">RectangleF</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>X <span class=\"token operator\">+</span> rectangle<span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// Draw the focus rectangle if the mouse hovers over an item.</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">DrawFocusRectangle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>输出结果如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9c4c835d98e24b2dbf534a9e4861dd2d.png\"/><br/> 每一项的高度都是事先定义好的30</p>\n<p>3）DrawMode</p>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">InitializeComboBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ComboBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DrawMode <span class=\"token operator\">=</span>\n                System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>DrawMode<span class=\"token punctuation\">.</span>OwnerDrawVariable<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Location <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Name <span class=\"token operator\">=</span> <span class=\"token string\">\"ComboBox1\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>Size <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Size</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>ItemHeight <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DropDownWidth <span class=\"token operator\">=</span> <span class=\"token number\">250</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>TabIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DropDownStyle <span class=\"token operator\">=</span> ComboBoxStyle<span class=\"token punctuation\">.</span>DropDown<span class=\"token punctuation\">;</span>\n            animals <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"Elephant\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"c r o c o d i l e\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"lion\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n            ComboBox1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> animals<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>Controls<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// Hook up the MeasureItem and DrawItem events</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>DrawItem <span class=\"token operator\">+=</span>\n                <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DrawItemEventHandler</span><span class=\"token punctuation\">(</span>ComboBox1_DrawItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>ComboBox1<span class=\"token punctuation\">.</span>MeasureItem <span class=\"token operator\">+=</span>\n                <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MeasureItemEventHandler</span><span class=\"token punctuation\">(</span>ComboBox1_MeasureItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ComboBox1_MeasureItem</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span>\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>MeasureItemEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n                    e<span class=\"token punctuation\">.</span>ItemHeight <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n                    e<span class=\"token punctuation\">.</span>ItemHeight <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n                    e<span class=\"token punctuation\">.</span>ItemHeight <span class=\"token operator\">=</span> <span class=\"token number\">35</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            e<span class=\"token punctuation\">.</span>ItemWidth <span class=\"token operator\">=</span> <span class=\"token number\">260</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ComboBox1_DrawItem</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span>\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">.</span>DrawItemEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n\n            <span class=\"token class-name\"><span class=\"token keyword\">float</span></span> size <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Font</span> myFont<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">FontFamily</span> family <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color</span> animalColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>Gray<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericSansSerif<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>LawnGreen<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericMonospace<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">case</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n                    size <span class=\"token operator\">=</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>\n                    animalColor <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Color<span class=\"token punctuation\">.</span>Tan<span class=\"token punctuation\">;</span>\n                    family <span class=\"token operator\">=</span> FontFamily<span class=\"token punctuation\">.</span>GenericSansSerif<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token comment\">// Draw the background of the item.</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">DrawBackground</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n           \n\n            <span class=\"token comment\">// Create a square filled with the animals color. Vary the size</span>\n            <span class=\"token comment\">// of the rectangle based on the length of the animals name.</span>\n            <span class=\"token class-name\">Rectangle</span> rectangle <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Rectangle</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Top <span class=\"token operator\">+</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                    e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height <span class=\"token operator\">-</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">.</span><span class=\"token function\">FillRectangle</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SolidBrush</span><span class=\"token punctuation\">(</span>animalColor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> rectangle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//绘制一个带有颜色的矩形</span>\n\n            <span class=\"token comment\">// Draw each string in the array, using a different size, color,</span>\n            <span class=\"token comment\">// and font for each item.</span>\n            myFont <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Font</span><span class=\"token punctuation\">(</span>family<span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">,</span> FontStyle<span class=\"token punctuation\">.</span>Bold<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">.</span><span class=\"token function\">DrawString</span><span class=\"token punctuation\">(</span>animals<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>Index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> myFont<span class=\"token punctuation\">,</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Brushes<span class=\"token punctuation\">.</span>Black<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">RectangleF</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>X <span class=\"token operator\">+</span> rectangle<span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>Bounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// Draw the focus rectangle if the mouse hovers over an item.</span>\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">DrawFocusRectangle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>输出结果如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3320f79d929843988d79af73a9a8b71a.png\"/><br/> 每一项的高度都不一样。<br/> 13、SelectedItem<br/> 设置该属性时，必须是已经存在的项目，不然无效</p>\n<p>14、 comboBox2.SelectedIndex<br/> 指示此时组合框选中哪一项，设置选中项时，索引不能超过范围，不然报异常</p>\n<p>二、事件<br/> 1、DrawItem<br/> 当选择下拉框的每一个成员项时会触发，并且只有在drawmode不是Normal时才会触发<br/> 2、DropDown<br/> 显示下拉框时触发<br/> 3、DropDownClosed<br/> 关闭下拉框时触发，当点击下拉框中的某一项后，就会触发该关闭事件，所以它在SelectionChangeCommitted事件后触发<br/> 4、SelectionChangeCommitted<br/> 点击下拉框中的某一项时触发<br/> 5、TextUpdate<br/> 该项是当选中了某一项后，然后直接用鼠标更改combox上的内容时发生<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\41518e9fa320494c9cd632832ebb4b96.png\"/><br/> 6、SelectedIndexChanged<br/> 当我们改变了选择的下拉框的项时触发，这个事件是最常用的，在此事件中，我们可以通过selectindex以及selectitem这些属性来做一些事情。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2021-11-26 10:54:29", "summary": "一、属性、设置组合框下拉部分的宽度没设置前，默认和属性的属性一样大，为，当的属性为时，如下：在这里插入图片描述把设置为后，如下：在这里插入图片描述可以看出下拉框的宽度增加了、指示下拉部分中显示的最大项"}