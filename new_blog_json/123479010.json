{"blogid": "123479010", "writerAge": "码龄5年", "writerBlogNum": "1", "writerCollect": "4", "writerComment": "0", "writerFan": "0", "writerGrade": "1级", "writerIntegral": "34", "writerName": "银狐fox", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_123479010.jpg", "writerRankTotal": "211286", "writerRankWeekly": "1148151", "writerThumb": "0", "writerVisitNum": "5813", "blog_read_count": "4369", "blog_time": "于 2022-03-14 15:10:50 发布", "blog_title": "PHP抖音无水印解析视频代码+思路", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>抖音无水印视频解析接口 抖音无水印视频思路 抖音解析PHP代码 php解析抖音无水印视频</p>\n<p>这几天疫情严重，放假在家无所事事，闲着无聊写点代码，今天来说说PHP无水印解析抖音视频<br/> <img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/4b1527521eda42f38b97088d50fa929c.webp?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6ZO254uQZm94,size_18,color_FFFFFF,t_70,g_se,x_16\"/></p>\n<p>网上的代码银狐自己试了试都是没用的，文末附上本人的代码，可以直接用，文章和代码都是今天(2022/3/13)写的</p>\n<p>流程：打开分享链接，获取头，得到真实地址，得到真实地址里面的videoID，通过抖音官方API获取json数据得到查询真实无水印视频地址的网页，Curl无水印网页，返回头部信息，取得抖音无水印视频地址</p>\n<p>先来段抖音撩妹祖师爷的视频：https://v.douyin.com/NrRah9w/</p>\n<p>这是app里面的分享链接，但是我们在网页中打开，发现是不一样的网址。</p>\n<p>先说手机端的，在网页中打开出现的网址是：</p>\n<p>https://www.iesdouyin.com/share/video/7074203714344471816/</p>\n<p>其中，7074203714344471816，是这部视频的videoid</p>\n<p>那么我们怎么获取跳转的地址，PHP代码：</p>\n<pre><code class=\"prism language-php\"><span class=\"token variable\">$header</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_headers</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'https://v.douyin.com/NrRah9w/'</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$realurl</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$header</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'Location'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//获取真实链接</span>\n</code></pre>\n<p>第一行代码先获取头，第二行获取真实链接，懂得都懂，自己用<code>var_dump</code>看</p>\n<p>然后抖音有这么一个接口会返回视频数据，通过videoid来查询：</p>\n<p>https://www.iesdouyin.com/web/api/v2/aweme/iteminfo/?item_ids=videoid</p>\n<p>如：https://www.iesdouyin.com/web/api/v2/aweme/iteminfo/?item_ids=7074203714344471816</p>\n<p>返回一大段json数据过来<br/> <img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/e7c919b6459c44c1b7988b252ca80ea1.webp?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6ZO254uQZm94,size_18,color_FFFFFF,t_70,g_se,x_16\"/></p>\n<p>重要的数据是：</p>\n<pre><code class=\"prism language-php\"><span class=\"token double-quoted-string string\">\"url_list\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token double-quoted-string string\">\"https://aweme.snssdk.com/aweme/v1/playwm/?video_id=v0200fg10000c8m9t3jc77u6h9celcbg&amp;ratio=720p&amp;line=0\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token double-quoted-string string\">\"vid\"</span><span class=\"token punctuation\">:</span><span class=\"token double-quoted-string string\">\"v0200fg10000c8m9t3jc77u6h9celcbg\"</span>\n</code></pre>\n<p>我们取json就是把他转换成数组，然后取vid，我们可以看到，访问url_list就是出现的是真实无水印的视频链接，那么我们通过vid就可以查询到真实无水印的视频地址</p>\n<p>vid位置：</p>\n<pre><code class=\"prism language-php\"><span class=\"token variable\">$getvid</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">'https://www.iesdouyin.com/web/api/v2/aweme/iteminfo/?item_ids=7074203714344471816'</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token variable\">$dy_vid</span><span class=\"token operator\">=</span> <span class=\"token variable\">$getvid</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'item_list'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'video'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'vid'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//得到vid</span>\n</code></pre>\n<p>我们用curl去请求：https://aweme.snssdk.com/aweme/v1/playwm/?video_id=v0200fg10000c8m9t3jc77u6h9celcbg&amp;ratio=720p&amp;line=0</p>\n<p>请求这个网页会302跳转到真实视频地址。</p>\n<p>代码：《<a href=\"https://www.ityinhu.com/643.html\">PHP CURL 返回请求网页头信息</a>》</p>\n<p>真实链接：<code>$headers['url']</code></p>\n<p>PC网页版的抖音和APP抖音的链接不一样，PC端更为简洁，银狐的代码里面有这两端的实现方法，各位自己学习和优化代码。</p>\n<p>例子：</p>\n<p><a href=\"https://www.ityinhu.com/api/douyin/api.php?url=https://v.douyin.com/NrRah9w/\">https://www.ityinhu.com/api/douyin/api.php?url=https://v.douyin.com/NrRah9w/</a></p>\n<p>如果打开上面的网址发现没有内容了，那么方法失效了。</p>\n<p>源码打包下载地址：<a href=\"https://www.ityinhu.com/646.html\">https://www.ityinhu.com/646.html</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 1, "time": "2022-03-14 15:10:50", "summary": "抖音无水印视频解析接口抖音无水印视频思路抖音解析代码解析抖音无水印视频这几天疫情严重，放假在家无所事事，闲着无聊写点代码，今天来说说无水印解析抖音视频请添加图片描述网上的代码银狐自己试了试都是没用的，"}