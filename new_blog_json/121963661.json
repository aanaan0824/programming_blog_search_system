{"blogid": "121963661", "writerAge": "码龄4年", "writerBlogNum": "149", "writerCollect": "2775", "writerComment": "134", "writerFan": "407", "writerGrade": "5级", "writerIntegral": "3393", "writerName": "胖哥真不错", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_121963661.jpg", "writerRankTotal": "5969", "writerRankWeekly": "20608", "writerThumb": "272", "writerVisitNum": "365192", "blog_read_count": "11081", "blog_time": "已于 2022-02-14 22:05:50 修改", "blog_title": "【项目实战】Python实现支持向量机SVM回归模型(SVR算法)项目实战", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<p>说明：这是一个机器学习实战项目（附带<strong>数据+代码+文档+代码讲解</strong>），如需<strong>数据+代码+文档+代码讲解</strong>可以直接到文章最后获取。</p>\n<p><img alt=\"\" height=\"95\" src=\"..\\..\\static\\image\\3fe56a1a1b094ca898672df730edbf63.png\" width=\"500\"/></p>\n<p><img alt=\"\" height=\"838\" src=\"..\\..\\static\\image\\7d105a7ae2e84721a01f4da3ba79ca88.png\" width=\"664\"/></p>\n<h3 style=\"margin-left:0px;text-align:justify;\">1.项目背景</h3>\n<p style=\"margin-left:0;text-align:justify;\">      支持向量机可以用于回归问题，即支持向量机回归，简称支持向量回归（Support vector regression, SVR）。支持向量机（SVM）建立在 VC 维理论和结构风险最小化原理基础之上，最初用于解决二分类问题（支持向量机分类），后被推广到用于解决函数逼近问题，即支持向量回归（SVR）。通常而言，可以使用核技巧将作为输入的非线性样本集变换到高维空间而改善样本分离状况。本项目使用svr算法进行建模预测。</p>\n<h3 style=\"margin-left:0px;text-align:justify;\">2.数据获取</h3>\n<p style=\"margin-left:0;text-align:justify;\">本次建模数据来源于网络(本项目撰写人整理而成)，数据项统计如下：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"309\" src=\"..\\..\\static\\image\\a91adf9a523f4f7e84a9462def7d2ce2.png\" width=\"576\"/></p>\n<p>数据详情如下(部分展示)：</p>\n<p><img alt=\"\" height=\"179\" src=\"..\\..\\static\\image\\906e875267dc43c9ba32fabd3d41603c.png\" width=\"865\"/></p>\n<h3 style=\"margin-left:0px;text-align:justify;\">3.数据预处理</h3>\n<p style=\"margin-left:0;text-align:justify;\">       真实数据中可能包含了大量的缺失值和噪音数据或人工录入错误导致有异常点存在，非常不利于算法模型的训练。数据清洗的结果是对各种脏数据进行对应方式的处理，得到标准的、干净的、连续的数据，提供给数据统计、数据挖掘等使用。数据预处理通常包含数据清洗、归约、聚合、转换、抽样等方式，数据预处理质量决定了后续数据分析挖掘及建模工作的精度和泛化价值。以下简要介绍数据预处理工作中主要的预处理方法：</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.1 用Pandas工具查看数据</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">使用Pandas工具的head()方法查看前五行数据：</p>\n<p><img alt=\"\" height=\"258\" src=\"..\\..\\static\\image\\a63da102a4ab44cb883fb5d086d5feef.png\" width=\"865\"/></p>\n<p> 从上图可以看到，总共有14个字段：变量13个，其中第一列是一个索引，建模时我们要去掉它。</p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"69\" src=\"..\\..\\static\\image\\7de302c46309415a88d228bbe3b81eae.png\" width=\"248\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.2查看数据的形状</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">使用Pandas工具的shape属性查看数据集的数量和字段数量：</p>\n<p> <img alt=\"\" height=\"41\" src=\"..\\..\\static\\image\\ab9049aefb9647f3bf16f20799d221a3.png\" width=\"188\"/></p>\n<p style=\"margin-left:0;text-align:justify;\">从上图可以看到，总共有14个变量、数据量为18249条数据。</p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"56\" src=\"..\\..\\static\\image\\06dd8ee329344ce19fe7cc50a7d24ce5.png\" width=\"214\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.3变量的空值情况判断</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">通过Pandas工具的isnull().sum()方法来统计变量的空值情况，结果如下图：</p>\n<p> <img alt=\"\" height=\"548\" src=\"..\\..\\static\\image\\ac4795c173ac4d329e984786670d4766.png\" width=\"622\"/></p>\n<p style=\"margin-left:0;text-align:justify;\">通过上图可以看到，数据字段中无空值情况。</p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码如下：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"67\" src=\"..\\..\\static\\image\\5ea7722179044a2fb4bb1384dcc9011a.png\" width=\"367\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.4数据描述性统计分析</strong></p>\n<p style=\"margin-left:0;text-align:justify;\"> 通过Pandas工具的describe()方法来进行数据描述性统计分析，结果如下图：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"328\" src=\"..\\..\\static\\image\\128a90fa99e14d8f8ea8aed1b56c3dd2.png\" width=\"770\"/></p>\n<p style=\"margin-left:0;text-align:justify;\">通过上图可以看到，数据项的平均值、标准差、最小值、最大值以及分位数。</p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码如下：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"63\" src=\"..\\..\\static\\image\\26e45de6d3434b879a896f9b38bf8b15.png\" width=\"411\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.5数据摘要信息查看</strong></p>\n<p style=\"margin-left:0;text-align:justify;\"> 通过Pandas工具的info()方法来进行查看数据摘要信息，结果如下图：</p>\n<p><img alt=\"\" height=\"794\" src=\"..\\..\\static\\image\\14e91381718c48408100fe97b57d1002.png\" width=\"750\"/></p>\n<p> 关键代码如下：</p>\n<p><img alt=\"\" height=\"44\" src=\"..\\..\\static\\image\\2944d62107ee4191a934da95afdfcdd7.png\" width=\"267\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.6删除数据项</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">删除掉Unnamed: 0数据项，关键代码如下：</p>\n<p> <img alt=\"\" height=\"53\" src=\"..\\..\\static\\image\\e0d3573831a540f4a15276345608c617.png\" width=\"511\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>3.7转换日期格式并排序</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码如下：</p>\n<p><img alt=\"\" height=\"148\" src=\"..\\..\\static\\image\\eb51913da2af42dab8fbfd7197c57c70.png\" width=\"734\"/></p>\n<p> 针对排序后的数据进行查看：</p>\n<p><img alt=\"\" height=\"289\" src=\"..\\..\\static\\image\\e9ddc9229baf44e88e47f2b00007feb8.png\" width=\"827\"/></p>\n<h3 style=\"margin-left:0px;text-align:justify;\">4.探索性数据分析</h3>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.1 随时间推移的Conventional Avocados的平均价格</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">用Matplotlib工具的scatter()方法进行统计绘图，图形化展示如下：</p>\n<p><img alt=\"\" height=\"499\" src=\"..\\..\\static\\image\\20b3222b6654456097c0bf9c13dac62e.png\" width=\"865\"/></p>\n<p> 从上图中可以看到，类型为conventional的Avocados的平均价格在2016年11月左右和2017年10月左右价格比较高。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.2 随时间推移的Organic Avocados的平均价格</strong></p>\n<p><img alt=\"\" height=\"501\" src=\"..\\..\\static\\image\\dc3a47e7a10e4c46a447c3f1ad381e8c.png\" width=\"865\"/></p>\n<p> 从上图中可以看到，类型为Organic的Avocados的平均价格在2016年11月左右和2017年5月左右价格比较高。另外，通过4.1和4.2的图可以看到不同类型Avocados的平均价格，Organic类型的平均价格略高于conventional类型的平均价格。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.3 按月画出每周的平均价格</strong></p>\n<p><img alt=\"\" height=\"450\" src=\"..\\..\\static\\image\\91d848c7f9d1427a9aef353e73ce1617.png\" width=\"865\"/></p>\n<p> 从上图中可以看到，分2017年9月、10月中每周的平均价格最高。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.4 查看样本集是否均衡</strong></p>\n<p> <img alt=\"\" height=\"1134\" src=\"..\\..\\static\\image\\dc2e4e3b91d44fc982f1cc102cc4b571.png\" width=\"364\"/><img alt=\"\" height=\"717\" src=\"..\\..\\static\\image\\c5250848cf5b48f4b88177d349a66de3.png\" width=\"355\"/></p>\n<p> 从上图中可以看到，数据均为338，数据较为均衡。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.5 按地区进行价格展示</strong></p>\n<p><img alt=\"\" height=\"427\" src=\"..\\..\\static\\image\\3ab56fe5648c42a3b2bb600a1113fda7.png\" width=\"865\"/></p>\n<p> 从上图中可以看到，HartfordSpringfield地区平均价格最高，Houston地区平均价格最低。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.6 按类型进行价格展示</strong></p>\n<p><img alt=\"\" height=\"972\" src=\"..\\..\\static\\image\\4e9fbf88289548bd9142321c2581b74d.png\" width=\"723\"/></p>\n<p style=\"margin-left:0;text-align:left;\">从上图可以看到organic类型的平均价格达到1.65，高于conventional类型的平均价格。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.7 相关性分析</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">通过Pandas工具的corr()方法进行查看如下：</p>\n<p><img alt=\"\" height=\"460\" src=\"..\\..\\static\\image\\b73d87a0231a4d888ebee8823c812bde.png\" width=\"865\"/></p>\n<p> 通过上图可以看到，数据项之间正直是正相关，负值为负相关；值越大相关性越强。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.8绘制饼图</strong></p>\n<p><img alt=\"\" height=\"700\" src=\"..\\..\\static\\image\\b6c33bed79b04dbea3698197ed983f61.png\" width=\"865\"/></p>\n<p> 通过上图可以看到，2015年 SmallHass占比40.2% 占比最多；XLarge Bags占比0.1% 占比最少。</p>\n<p><img alt=\"\" height=\"661\" src=\"..\\..\\static\\image\\eef5a5979c7d478ba65c1d5e270fa000.png\" width=\"865\"/></p>\n<p>通过上图可以看到，2016年 SmallHass占比30.9% 占比最多；XLarge Bags占比0.4% 占比最少。</p>\n<p><img alt=\"\" height=\"675\" src=\"..\\..\\static\\image\\d05a4a23883d45609b3def3f4f9f0e9a.png\" width=\"865\"/> 通过上图可以看到，2017年 SmallHass占比33.0% 占比最多；XLarge Bags占比0.5% 占比最少。</p>\n<p><img alt=\"\" height=\"676\" src=\"..\\..\\static\\image\\c645a4aba708446fbf5eee93399ab962.png\" width=\"865\"/></p>\n<p> 通过上图可以看到，2018年 SmallHass占比33.1% 占比最多；XLarge Bags占比0.5% 占比最少。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>4.9查看数据预处理后的数据相关性</strong></p>\n<p><img alt=\"\" height=\"363\" src=\"..\\..\\static\\image\\7cbd08769943420fa5423ee4025e2498.png\" width=\"828\"/></p>\n<p> 通过上图可以看到，数据预处理后的数据项相关性数值，正值为正相关，负值为负相关，数值越大相关性越强。</p>\n<h3 style=\"margin-left:0px;text-align:justify;\">5.特征工程</h3>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>5.1 数据标准化</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">对Small Hass:XLarge Bags的数据项进行数据的标准化处理，关键代码如下：</p>\n<p><img alt=\"\" height=\"51\" src=\"..\\..\\static\\image\\2d1f569ac80548f885b7fb972ad13d35.png\" width=\"865\"/></p>\n<p> 标准化的数据，如下图所示：</p>\n<p><img alt=\"\" height=\"247\" src=\"..\\..\\static\\image\\219364da63b241558456704260e9f668.png\" width=\"802\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>5.2 建立特征数据和标签数据</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">AveragePrice为标签数据，除 AveragePrice之外的为特征数据。关键代码如下：</p>\n<p> <img alt=\"\" height=\"142\" src=\"..\\..\\static\\image\\fb19e9e9a6c2434e97b66ac58a9d9133.png\" width=\"473\"/></p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>5.3 哑特征处理</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">由于type, region数据项为分类型变量，且为本文类型，不符合机器学习建模要求；针对type, region进行哑特征处理，转变为数值型，关键代码如下：</p>\n<p><img alt=\"\" height=\"56\" src=\"..\\..\\static\\image\\d49db3317d4e4a4fa4f425aee7be2f29.png\" width=\"809\"/></p>\n<p> 转变后的结果，如下图所示：</p>\n<p><img alt=\"\" height=\"211\" src=\"..\\..\\static\\image\\4a9e1f0acd4f4f0c972695ef2abd32e6.png\" width=\"820\"/></p>\n<p><strong>5.4 可视化与平均价格变量高度相关的变量</strong></p>\n<p><img alt=\"\" height=\"453\" src=\"..\\..\\static\\image\\d16ac93472274891acca17da7a163aaf.png\" width=\"865\"/></p>\n<p> 通过上图可以看出，随着Small Hass的增大，平均价格整体成下降趋势。</p>\n<p><img alt=\"\" height=\"453\" src=\"..\\..\\static\\image\\504591c9dea14e369299ced1d967aa7f.png\" width=\"865\"/></p>\n<p>通过上图可以看出，随着Small Bags的增大，平均价格整体较为平稳。</p>\n<p><img alt=\"\" height=\"457\" src=\"..\\..\\static\\image\\d3d1d04b955947cea788d65be2948ddb.png\" width=\"865\"/> 通过上图可以看出，随着Large Bags的增大，平均价格整体较为平稳。</p>\n<p><img alt=\"\" height=\"417\" src=\"..\\..\\static\\image\\72f7595058884d6e89edcbda5e4b13d2.png\" width=\"865\"/></p>\n<p style=\"margin-left:0;text-align:justify;\">通过上图可以看出，organic类型相较于Conventional类型对平均价格影响较小。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>5.5 数据集拆分</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">训练集拆分，分为训练集和验证集，70%训练集和30%验证集。关键代码如下：</p>\n<p> <img alt=\"\" height=\"169\" src=\"..\\..\\static\\image\\49b28919b534408c87afc6e2a96f3230.png\" width=\"288\"/></p>\n<h3 style=\"margin-left:0px;text-align:justify;\">6.构建SVR回归模型</h3>\n<p style=\"margin-left:0;text-align:justify;\">主要使用svr算法，用于目标回归。</p>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>6.1模型参数</strong></p>\n<p> <img alt=\"\" height=\"108\" src=\"..\\..\\static\\image\\01881a7529f74bd8a9532e0bb61b7e13.png\" width=\"576\"/></p>\n<p>关键代码如下：</p>\n<p><img alt=\"\" height=\"459\" src=\"..\\..\\static\\image\\bf81796a9ea64bc7978cfc3a3a52992d.png\" width=\"736\"/></p>\n<h3 style=\"margin-left:0px;text-align:justify;\">7.模型评估</h3>\n<p style=\"margin-left:0px;text-align:justify;\"><strong>7.1评估指标及结果</strong></p>\n<p style=\"margin-left:0;text-align:justify;\">评估指标主要包括分值、可解释方差值、均方误差、R方值等等。</p>\n<p> <img alt=\"\" height=\"159\" src=\"..\\..\\static\\image\\9e6dc0bd5f404d7796570e4501439f7e.png\" width=\"569\"/></p>\n<p style=\"margin-left:0;text-align:justify;\">从上表可以看出，分值0.82，svr回归模型良好。</p>\n<p style=\"margin-left:0;text-align:justify;\">关键代码如下：</p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"302\" src=\"..\\..\\static\\image\\264712fd2fe741379cca8094936a37ee.png\" width=\"865\"/></p>\n<p><strong>7.2 真实值与预测值对比图 </strong></p>\n<p><img alt=\"\" height=\"449\" src=\"..\\..\\static\\image\\d57d8e070ce449eab491cdc0531a5f8c.png\" width=\"865\"/></p>\n<p> 从上图可以看出真实值和预测值波动基本一致，模型拟合效果良好。</p>\n<h3 style=\"margin-left:0px;text-align:justify;\">8.结论与展望</h3>\n<p style=\"margin-left:0;text-align:justify;\">综上所述，本文采用了svr回归模型，最终证明了我们提出的模型效果良好。可用于实际业务中建模预测。</p>\n</blockquote>\n<blockquote>\n<p>本次机器学习项目实战所需的资料，项目资源如下：</p>\n<p>项目说明：<br/> 链接：https://pan.baidu.com/s/1dW3S1a6KGdUHK90W-lmA4w <br/> 提取码：bcbp</p>\n<p></p>\n<p><em>网盘如果失效，可以添加博主微信：zy10178083</em></p>\n</blockquote>\n</div>\n</div>", "first_tag": "Python", "cpp": 0, "csharp": 0, "python": 1, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-02-14 22:05:50", "summary": "说明：这是一个机器学习实战项目附带数据代码文档代码讲解，如需数据代码文档代码讲解可以直接到文章最后获取。项目背景支持向量机可以用于回归问题，即支持向量机回归，简称支持向量回归。支持向量机建立在维理论和"}