{"blogid": "126662168", "writerAge": "码龄2年", "writerBlogNum": "61", "writerCollect": "105", "writerComment": "23", "writerFan": "26", "writerGrade": "3级", "writerIntegral": "709", "writerName": "今夜鸣风", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126662168.jpg", "writerRankTotal": "25207", "writerRankWeekly": "20574", "writerThumb": "53", "writerVisitNum": "19463", "blog_read_count": "284", "blog_time": "于 2022-09-02 16:39:30 发布", "blog_title": "【Javaweb项目实战】黑马旅游网", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>本次项目主要有以下几个重点导入项目、优化servlet、前后台勾连等。</p>\n<p><img alt=\"\" height=\"862\" src=\"..\\..\\static\\image\\52fdca9a877149b29786bd89b4998fa4.png\" width=\"1200\"/></p>\n<p>如图片所示，这是一个常见的网站首页，包括登录、注册、查看相关信息的功能。</p>\n<p>但要怎么实现呢？</p>\n<p>除了准备好相应的图片文字信息，我们要怎么做才能让它拥有以上功能并展示在页面上呢？</p>\n<p>抱着这样的疑惑，我们慢慢来一探究竟吧？</p>\n<h1>首先是基本准备（也可以使用maven直接导入半成品项目）：</h1>\n<p>后端：</p>\n<p><img alt=\"\" height=\"250\" src=\"..\\..\\static\\image\\785d3e2e7bef4dc8a04eeac00959eab8.png\" width=\"444\"/></p>\n<p> 还有要提前建立存放图片和文字资源的数据库。</p>\n<p><img alt=\"\" height=\"159\" src=\"..\\..\\static\\image\\35959c4ebb7c4009830ddb2a399b6670.png\" width=\"288\"/></p>\n<p>这里我使用的是Navicat软件。</p>\n<p><img alt=\"\" height=\"108\" src=\"..\\..\\static\\image\\352c9111ff004e7d93bf322f5d6459bc.png\" width=\"110\"/></p>\n<p>这是一款可视化建库软件，使用起来非常方便。</p>\n<p></p>\n<p>前端及资源文件：</p>\n<p><img alt=\"\" height=\"175\" src=\"..\\..\\static\\image\\e71d58a3ccc547d99303826a6ece8697.png\" width=\"525\"/></p>\n<p></p>\n<p>看到pom.xml文件了吗？这表示 我是从maven导入的半成品项目，接下来我们来了解一下如何使用maven导入项目。</p>\n<h1>maven导入项目：</h1>\n<p><span style=\"color:#fe2c24;\"><strong>maven：Maven是一个跨平台的项目管理工具，是Apache组织中的一个颇为成功的开源项目。Maven主要服务基于java的项目构建，项目信息管理和依赖管理。</strong></span></p>\n<p>作用：<br/> 1.Maven可以创建项目。<br/> 2.Maven可以引入依赖的jar包。<br/> 在Maven中有一个核心的概念--仓库，分为本地仓库和远程仓库。远程仓库又分为中央仓库，私服和其他仓库。</p>\n<p>首先是确保自己下载了maven的资源文件，并且IDE安装并启动了maven插件：</p>\n<p>打开设置：</p>\n<p><img alt=\"\" height=\"643\" src=\"..\\..\\static\\image\\fa2f4c759823465281e0cfcbf45fd40b.png\" width=\"1024\"/></p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"..\\..\\static\\image\\0ede23be10854343977491c1d58e2b1f.png\"/></p>\n<p> 以上准备操作没有问题就会在右侧导航栏出现以下内容：</p>\n<p><img alt=\"\" height=\"225\" src=\"..\\..\\static\\image\\9735ed8c07834774af12138797ff283a.png\" width=\"512\"/></p>\n<p> 点击maven，出现以下内容：</p>\n<p><img alt=\"\" height=\"367\" src=\"..\\..\\static\\image\\7e69f1532dc44780afe136dcb1e39348.png\" width=\"693\"/></p>\n<p> 点击“+”号，导入项目。</p>\n<p><img alt=\"\" height=\"548\" src=\"..\\..\\static\\image\\c0c12d03b63f4a568de5a5c8499fc477.png\" width=\"1173\"/></p>\n<p> 选择pom.xml文件，点击OK完成项目导入，初始化微微等待一会即可。</p>\n<p>以下是pom.xml文件的内容，我们可以看到里面包含了诸多插件的信息，这是依赖管理：对jar包统一管理的过程</p>\n<pre><code class=\"language-XML\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n  &lt;groupId&gt;cn.itcast&lt;/groupId&gt;\n  &lt;artifactId&gt;travel&lt;/artifactId&gt;\n  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n  &lt;packaging&gt;war&lt;/packaging&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;3.8.1&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!--servlet--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n\n        &lt;!--mysql驱动--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;5.1.26&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!--druid连接池--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;\n            &lt;artifactId&gt;druid&lt;/artifactId&gt;\n            &lt;version&gt;1.0.9&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!--jdbcTemplate--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-core&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2.RELEASE&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2.RELEASE&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2.RELEASE&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-beans&lt;/artifactId&gt;\n            &lt;version&gt;4.1.2.RELEASE&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-logging&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;\n            &lt;version&gt;1.1.1&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!--beanUtils--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;\n            &lt;version&gt;1.9.2&lt;/version&gt;\n            &lt;scope&gt;compile&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;!--jackson--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n            &lt;version&gt;2.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n            &lt;version&gt;2.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-annotations&lt;/artifactId&gt;\n            &lt;version&gt;2.3.3&lt;/version&gt;\n        &lt;/dependency&gt;\n\n\n        &lt;!--javaMail--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;javax.mail&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.mail-api&lt;/artifactId&gt;\n            &lt;version&gt;1.5.6&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.sun.mail&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.mail&lt;/artifactId&gt;\n            &lt;version&gt;1.5.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;!--jedis--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;redis.clients&lt;/groupId&gt;\n            &lt;artifactId&gt;jedis&lt;/artifactId&gt;\n            &lt;version&gt;2.7.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n\n    &lt;build&gt;\n        &lt;!--maven插件--&gt;\n        &lt;plugins&gt;\n            &lt;!--jdk编译插件--&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.8&lt;/source&gt;\n                    &lt;target&gt;1.8&lt;/target&gt;\n                    &lt;encoding&gt;utf-8&lt;/encoding&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;!--tomcat插件--&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n                &lt;!-- tomcat7的插件， 不同tomcat版本这个也不一样 --&gt;\n                &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.1&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;!-- 通过maven tomcat7:run运行项目时，访问项目的端口号 --&gt;\n                    &lt;port&gt;80&lt;/port&gt;\n                    &lt;!-- 项目访问路径  本例：localhost:9090,  如果配置的aa， 则访问路径为localhost:9090/aa--&gt;\n                    &lt;path&gt;/&lt;/path&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;</code></pre>\n<p>项目导入成功之后我们便要启动项目：</p>\n<h1>项目启动:</h1>\n<p>方式一：</p>\n<p><img alt=\"\" height=\"425\" src=\"..\\..\\static\\image\\434af939b8ee4df3a7db5abbb6a401b6.png\" width=\"441\"/></p>\n<p> 启动Tomcat7：run；的命令</p>\n<p></p>\n<p>方式二：配置maven快捷启动</p>\n<p><img alt=\"\" height=\"132\" src=\"..\\..\\static\\image\\3dcf9a1f6956452ea2518634a561d325.png\" width=\"554\"/></p>\n<p> <img alt=\"\" height=\"72\" src=\"..\\..\\static\\image\\7167113548c34ab68460325592c61b60.png\" width=\"516\"/></p>\n<p> 启动项目之后来分析一下每一层我们要做的事情：</p>\n<h1>技术选型：</h1>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Web层</li></ol></li></ol>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Servlet：前端控制器</li><li style=\"text-align:justify;\">html：视图</li><li style=\"text-align:justify;\">Filter：过滤器</li><li style=\"text-align:justify;\">BeanUtils：数据封装</li><li style=\"text-align:justify;\">Jackson：json序列化工具</li></ol></li></ol>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Service层</li></ol></li></ol>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Javamail：java发送邮件工具</li><li style=\"text-align:justify;\">Redis：nosql内存数据库</li><li style=\"text-align:justify;\">Jedis：java的redis客户端</li></ol></li></ol>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Dao层</li></ol></li></ol>\n<ol><li>\n<ol><li style=\"text-align:justify;\">Mysql：数据库</li><li style=\"text-align:justify;\">Druid：数据库连接池</li><li style=\"text-align:justify;\">JdbcTemplate：jdbc的工具</li></ol></li></ol>\n<p style=\"margin-left:0;text-align:justify;\">现在我们手里已经有了一个前端页面后端实体类已经写好的网页，接下来要让它具备登录注册的功能。</p>\n<h1 style=\"margin-left:0px;text-align:justify;\"><strong>注册功能:</strong></h1>\n<p><strong>页面效果：</strong></p>\n<p><img alt=\"\" height=\"483\" src=\"..\\..\\static\\image\\03bb994c021c43afbeb18692d8fed2e5.png\" width=\"402\"/></p>\n<p> </p>\n<p style=\"margin-left:0;text-align:justify;\">前台代码设计：</p>\n<pre><code class=\"language-html\">&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;注册&lt;/title&gt;\n        &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/common.css\"&gt;\n        &lt;link rel=\"stylesheet\" href=\"css/register.css\"&gt;\n\t\t&lt;!--导入jquery--&gt;\n\t\t&lt;script src=\"js/jquery-3.3.1.js\"&gt;&lt;/script&gt;\n\n\t\t&lt;script&gt;\n\t\t\t/*\n\t\t\t\t表单校验：\n\t\t\t\t\t1.用户名：单词字符，长度8到20位\n\t\t\t\t\t2.密码：单词字符，长度8到20位\n\t\t\t\t\t3.email：邮件格式\n\t\t\t\t\t4.姓名：非空\n\t\t\t\t\t5.手机号：手机号格式\n\t\t\t\t\t6.出生日期：非空\n\t\t\t\t\t7.验证码：非空\n\t\t\t */\n\n\t\t\t//校验用户名\n\t\t\t//单词字符，长度4到20位\n\t\t\tfunction checkUsername() {\n                //1.获取用户名值\n\t\t\t\tvar username = $(\"#username\").val();\n\t\t\t\t//2.定义正则\n\t\t\t\tvar reg_username = /^\\w{4,20}$/;\n\t\t\t\t\n\t\t\t\t//3.判断，给出提示信息\n\t\t\t    var flag = reg_username.test(username);\n\t\t\t    if(flag){\n\t\t\t        //用户名合法\n                    $(\"#username\").css(\"border\",\"\");\n\t\t\t\t}else{\n\t\t\t        //用户名非法,加一个红色边框\n\t\t\t\t\t$(\"#username\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\t\t\t    \n                return flag;\n            }\n\n            //校验密码\n            function checkPassword() {\n                //1.获取密码值\n                var password = $(\"#password\").val();\n                //2.定义正则\n                var reg_password = /^\\w{6,20}$/;\n\n                //3.判断，给出提示信息\n                var flag = reg_password.test(password);\n                if(flag){\n                    //密码合法\n                    $(\"#password\").css(\"border\",\"\");\n                }else{\n                    //密码非法,加一个红色边框\n                    $(\"#password\").css(\"border\",\"1px solid red\");\n                }\n\n                return flag;\n            }\n\n            //校验邮箱\n\t\t\tfunction checkEmail(){\n\t\t\t    //1.获取邮箱\n\t\t\t\tvar email = $(\"#email\").val();\n\t\t\t\t//2.定义正则\t\titcast@163.com\n\t\t\t\tvar reg_email = /^\\w+@\\w+\\.\\w+$/;\n\n\t\t\t\t//3.判断\n\t\t\t\tvar flag = reg_email.test(email);\n\t\t\t\tif(flag){\n                    $(\"#email\").css(\"border\",\"\");\n\t\t\t\t}else{\n                    $(\"#email\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\n\t\t\t\treturn flag;\n\t\t\t}\n\t\t\t//校验姓名\n\t\t\t//非空单词字符，长度1到10位\n\t\t\tfunction checkName() {\n\t\t\t\t//1.获取姓名\n\t\t\t\tvar name = $(\"#name\").val();\n\t\t\t\t//2.定义姓名正则\n\t\t\t\tvar reg_name = /^\\w{1,10}$/;\n\n\t\t\t\t//3.判断，给出提示信息\n\t\t\t\tvar flag = reg_name.test(name);\n\t\t\t\tif (name!=null){\n\t\t\t\t\tif(flag){\n\t\t\t\t\t\t//姓名合法\n\t\t\t\t\t\t$(\"#name\").css(\"border\",\"\");\n\t\t\t\t\t}\n\n\t\t\t\t}else{\n\t\t\t\t\t//姓名非法,加一个红色边框\n\t\t\t\t\t$(\"#name\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\n\t\t\t\treturn flag;\n\t\t\t}\n\t\t\t//校验手机号\n\t\t\t//非空单词字符，长度11位\n\t\t\tfunction checkPhoneNumber() {\n\t\t\t\t//1.获取用号码\n\t\t\t\tvar number = $(\"#number\").val();\n\t\t\t\t//2.定义11位手机号码正则\n\t\t\t\tvar reg_number = /^[1][3,4,5,7,8][0-9]{9}$/;\n\n\t\t\t\t//3.判断，给出提示信息\n\t\t\t\tvar flag = reg_number.test(number);\n\n\t\t\t\tif(flag){\n\t\t\t\t\t\t//号码合法\n\t\t\t\t\t\t$(\"#number\").css(\"border\",\"\");\n\n\n\t\t\t\t}else{\n\t\t\t\t\t//号码非法,加一个红色边框\n\t\t\t\t\t$(\"#number\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\n\t\t\t\treturn flag;\n\t\t\t}\n\t\t\t//校验生日\n\t\t\tfunction checkBirthday() {\n\t\t\t\t//1.获取生日\n\t\t\t\tvar birthday = $(\"#birthday\").val();\n\t\t\t\t//2.定义日期正则\n\t\t\t\tvar reg_birthday =/^((?:19[2-9]\\d{1})|(?:20(?:(?:0[0-9])|(?:1[0-8]))))\\-((?:0?[1-9])|(?:1[0-2]))\\-((?:0?[1-9])|(?:[1-2][0-9])|30|31)$/;\n\n\t\t\t\t//3.判断，给出提示信息\n\t\t\t\tvar flag = reg_birthday.test(birthday);\n\n\t\t\t\tif(flag){\n\t\t\t\t\t//生日合法\n\t\t\t\t\t$(\"#birthday\").css(\"border\",\"\");\n\n\n\t\t\t\t}else{\n\t\t\t\t\t//生日非法,加一个红色边框\n\t\t\t\t\t$(\"#birthday\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\n\t\t\t\treturn flag;\n\t\t\t}\n\t\t\t//校验4位验证码authCode\n\t\t\tfunction checkAuthCode() {\n\t\t\t\t//1.获取密码值\n\t\t\t\tvar authCode = $(\"#authCode\").val();\n\t\t\t\t//2.定义正则\n\t\t\t\tvar reg_authCode = /^\\w{4}$/;\n\n\t\t\t\t//3.判断，给出提示信息\n\t\t\t\tvar flag = reg_authCode.test(authCode);\n\t\t\t\tif(flag){\n\t\t\t\t\t//密码合法\n\t\t\t\t\t$(\"#authCode\").css(\"border\",\"\");\n\t\t\t\t}else{\n\t\t\t\t\t//密码非法,加一个红色边框\n\t\t\t\t\t$(\"#authCode\").css(\"border\",\"1px solid red\");\n\t\t\t\t}\n\n\t\t\t\treturn flag;\n\t\t\t}\n\n\n\t\t\t$(function () {\n                //当表单提交时，调用所有的校验方法\n\t\t\t\t$(\"#registerForm\").submit(function(){\n\t\t\t\t\t//1.发送数据到服务器\n\t\t\t\t\tif(checkUsername() &amp;&amp; checkPassword() &amp;&amp; checkEmail()){\n\t\t\t\t\t    //校验通过,发送ajax请求，提交表单的数据   username=zhangsan&amp;password=123\n\n\t\t\t\t\t\t$.post(\"user/regist\",$(this).serialize(),function(data){\n\t\t\t\t\t\t\t//处理服务器响应的数据  data  {flag:true,errorMsg:\"注册失败\"}\n\n\t\t\t\t\t\t\tif(data.flag){\n\t\t\t\t\t\t\t    //注册成功，跳转成功页面\n\t\t\t\t\t\t\t\tlocation.href=\"register_ok.html\";\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t    //注册失败,给errorMsg添加提示信息\n\t\t\t\t\t\t\t\t$(\"#errorMsg\").html(data.errorMsg);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\t\t\t\t\t//2.不让页面跳转\n                    return false;\n                    //如果这个方法没有返回值，或者返回为true，则表单提交，如果返回为false，则表单不提交\n\t\t\t\t});\n\n                //当某一个组件失去焦点是，调用对应的校验方法\n\t\t\t\t$(\"#username\").blur(checkUsername);\n                $(\"#password\").blur(checkPassword);\n                $(\"#email\").blur(checkEmail);\n                $(\"#name\").blur(checkName);\n                $(\"#number\").blur(checkPhoneNumber);\n                $(\"#birthday\").blur(checkBirthday);\n                $(\"#authCode\").blur(changeCheckCode);\n\n\n            });\n\n\n\t\t&lt;/script&gt;\n\n\n    &lt;/head&gt;\n\t&lt;body&gt;\n\t&lt;!--引入头部--&gt;\n\t&lt;div id=\"header\"&gt;&lt;/div&gt;\n        &lt;!-- 头部 end --&gt;\n    \t&lt;div class=\"rg_layout\"&gt;\n    \t\t&lt;div class=\"rg_form clearfix\"&gt;\n    \t\t\t&lt;div class=\"rg_form_left\"&gt;\n    \t\t\t\t&lt;p&gt;新用户注册&lt;/p&gt;\n    \t\t\t\t&lt;p&gt;USER REGISTER&lt;/p&gt;\n    \t\t\t&lt;/div&gt;\n    \t\t\t&lt;div class=\"rg_form_center\"&gt;\n\t\t\t\t\t&lt;div id=\"errorMsg\" style=\"color:red;text-align: center\"&gt;&lt;/div&gt;\n\t\t\t\t\t&lt;!--注册表单--&gt;\n    \t\t\t\t&lt;form id=\"registerForm\" action=\"user\"&gt;\n\t\t\t\t\t\t&lt;!--提交处理请求的标识符--&gt;\n\t\t\t\t\t\t&lt;input type=\"hidden\" name=\"action\" value=\"register\"&gt;\n    \t\t\t\t\t&lt;table style=\"margin-top: 25px;\"&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"username\"&gt;用户名&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"username\" name=\"username\" placeholder=\"请输入4-20位账号\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"password\"&gt;密码&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"password\" name=\"password\" placeholder=\"请输入6-10位密码\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"email\"&gt;Email&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"email\" name=\"email\" placeholder=\"请输入Email\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"name\"&gt;姓名&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"name\" name=\"name\" placeholder=\"请输入真实姓名\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"telephone\"&gt;手机号&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"telephone\" name=\"telephone\" placeholder=\"请输入您的11位手机号\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"sex\"&gt;性别&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right gender\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"radio\" id=\"sex\" name=\"sex\" value=\"男\" checked&gt; 男\n    \t\t\t\t\t\t\t\t&lt;input type=\"radio\" name=\"sex\" value=\"女\"&gt; 女\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"birthday\"&gt;出生日期&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"date\" id=\"birthday\" name=\"birthday\" placeholder=\"年/月/日\"&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt;\n    \t\t\t\t\t\t\t\t&lt;label for=\"check\"&gt;验证码&lt;/label&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right check\"&gt;\n    \t\t\t\t\t\t\t\t&lt;input type=\"text\" id=\"check\" name=\"check\" class=\"check\"&gt;\n    \t\t\t\t\t\t\t\t&lt;img src=\"checkCode\" height=\"32px\" alt=\"\" onclick=\"changeCheckCode(this)\"&gt;\n\t\t\t\t\t\t\t\t\t&lt;script type=\"text/javascript\"&gt;\n\t\t\t\t\t\t\t\t\t\t//图片点击事件\n\t\t\t\t\t\t\t\t\t\tfunction changeCheckCode(img) {\n\t\t\t\t\t\t\t\t\t\t\timg.src=\"checkCode?\"+new Date().getTime();\n                                        }\n\t\t\t\t\t\t\t\t\t&lt;/script&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t\t&lt;tr&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_left\"&gt; \n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t\t&lt;td class=\"td_right check\"&gt; \n    \t\t\t\t\t\t\t\t&lt;input type=\"submit\" class=\"submit\" value=\"注册\"&gt;\n\t\t\t\t\t\t\t\t\t&lt;span id=\"msg\" style=\"color: red;\"&gt;&lt;/span&gt;\n    \t\t\t\t\t\t\t&lt;/td&gt;\n    \t\t\t\t\t\t&lt;/tr&gt;\n    \t\t\t\t\t&lt;/table&gt;\n    \t\t\t\t&lt;/form&gt;\n    \t\t\t&lt;/div&gt;\n    \t\t\t&lt;div class=\"rg_form_right\"&gt;\n    \t\t\t\t&lt;p&gt;\n    \t\t\t\t\t已有账号？\n    \t\t\t\t\t&lt;a href=\"#\"&gt;立即登录&lt;/a&gt;\n    \t\t\t\t&lt;/p&gt;\n    \t\t\t&lt;/div&gt;\n    \t\t&lt;/div&gt;\n    \t&lt;/div&gt;\n        &lt;!--引入尾部--&gt;\n    \t&lt;div id=\"footer\"&gt;&lt;/div&gt;\n\t\t&lt;!--导入布局js，共享header和footer--&gt;\n\t\t&lt;script type=\"text/javascript\" src=\"js/include.js\"&gt;&lt;/script&gt;\n    \t\n    &lt;/body&gt;\n&lt;/html&gt;</code></pre>\n<p> </p>\n<h2>异步(ajax)提交表单：</h2>\n<p><img alt=\"\" height=\"562\" src=\"..\\..\\static\\image\\83632fe5391443ae9a54ad196b90e5c3.png\" width=\"1029\"/></p>\n<h1> 后台代码实现：</h1>\n<h2><strong>RegistUserServlet</strong></h2>\n<pre><code class=\"language-java\">package cn.itcast.travel.web.servlet;\n\nimport cn.itcast.travel.domain.ResultInfo;\nimport cn.itcast.travel.domain.User;\nimport cn.itcast.travel.service.UserService;\nimport cn.itcast.travel.service.impl.UserServiceImpl;\nimport cn.itcast.travel.service.impl.routeServiceImpl;\nimport cn.itcast.travel.service.routeService;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport org.apache.commons.beanutils.BeanUtils;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.servlet.http.HttpSession;\nimport java.io.IOException;\nimport java.lang.reflect.InvocationTargetException;\nimport java.util.Map;\n\n@WebServlet(\"/registUserServlet\")\npublic class RegistUserServlet extends HttpServlet {\n\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n\n        //验证校验\n        String check = request.getParameter(\"check\");\n        //从sesion中获取验证码\n        HttpSession session = request.getSession();\n        String checkcode_server = (String) session.getAttribute(\"CHECKCODE_SERVER\");\n        session.removeAttribute(\"CHECKCODE_SERVER\");//为了保证验证码只能使用一次\n        //比较\n        if(checkcode_server == null || !checkcode_server.equalsIgnoreCase(check)){\n            //验证码错误\n            ResultInfo info = new ResultInfo();\n            //注册失败\n            info.setFlag(false);\n            info.setErrorMsg(\"验证码错误\");\n            //将info对象序列化为json\n            ObjectMapper mapper = new ObjectMapper();\n            String json = mapper.writeValueAsString(info);\n            response.setContentType(\"application/json;charset=utf-8\");\n            response.getWriter().write(json);\n            return;\n        }\n\n        //1.获取数据\n        Map&lt;String, String[]&gt; map = request.getParameterMap();\n\n        //2.封装对象\n        User user = new User();\n        try {\n            BeanUtils.populate(user,map);\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        } catch (InvocationTargetException e) {\n            e.printStackTrace();\n        }\n        System.out.println(user);\n\n        //3.调用service完成注册\n        UserService service = new UserServiceImpl();\n        boolean flag = service.regist(user);\n        ResultInfo info = new ResultInfo();\n        //4.响应结果\n        if(flag){\n            //注册成功\n            info.setFlag(true);\n        }else{\n            //注册失败\n            info.setFlag(false);\n            info.setErrorMsg(\"注册失败!\");\n        }\n\n        //将info对象序列化为json\n        ObjectMapper mapper = new ObjectMapper();\n        String json = mapper.writeValueAsString(info);\n\n        //将json数据写回客户端\n        //设置content-type\n        response.setContentType(\"application/json;charset=utf-8\");\n        response.getWriter().write(json);\n\n\n    }\n\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        this.doPost(request, response);\n    }\n}\n</code></pre>\n<p> 有了请求信息，我们现在要做的就是做可注册用户的校验和存入注册信息到数据库。</p>\n<h2>编写UserService以及UserServiceImpl：</h2>\n<p><img alt=\"\" height=\"240\" src=\"..\\..\\static\\image\\48afe0305c4c4e15ab0004ce4188e9dc.png\" width=\"417\"/></p>\n<p> </p>\n<pre><code class=\"language-java\">public class UserServiceImpl implements UserService {\n\n    private UserDao userDao = new UserDaoImpl();\n    /**\n     * 注册用户\n     * @param user\n     * @return\n     */\n    @Override\n    public boolean regist(User user) {\n        //1.根据用户名查询用户对象\n        User u = userDao.findByUsername(user.getUsername());\n        //判断u是否为null\n        if(u != null){\n            //用户名存在，注册失败\n            return false;\n        }\n        //2.保存用户信息\n        userDao.save(user);\n        return true;\n}</code></pre>\n<h1>Dao部分：</h1>\n<p>userDao：</p>\n<p><img alt=\"\" height=\"443\" src=\"..\\..\\static\\image\\6739f44e080f4408aef1cb0c36869645.png\" width=\"620\"/></p>\n<h2> UserDaoImpl：</h2>\n<pre><code class=\"language-java\">public class UserDaoImpl implements UserDao {\n\n    private JdbcTemplate template = new JdbcTemplate(JDBCUtils.getDataSource());\n\n    @Override\n    public User findByUsername(String username) {\n        User user = null;\n        try {\n            //1.定义sql\n            String sql = \"select * from tab_user where username = ?\";\n            //2.执行sql\n            user = template.queryForObject(sql, new BeanPropertyRowMapper&lt;User&gt;(User.class), username);\n        } catch (Exception e) {\n\n        }\n\n        return user;\n    }\n\n    @Override\n    public void save(User user) {\n        //1.定义sql\n        String sql = \"insert into tab_user(username,password,name,birthday,sex,telephone,email,status,code) values(?,?,?,?,?,?,?,?,?)\";\n        //2.执行sql\n\n        template.update(sql,user.getUsername(),\n                    user.getPassword(),\n                user.getName(),\n                user.getBirthday(),\n                user.getSex(),\n                user.getTelephone(),\n                user.getEmail(),\n                user.getStatus(),\n                user.getCode()\n                );\n    }\n}</code></pre>\n<p>完成这个功能之后我们需要激活账户。</p>\n<p>现在常用的方法是通过邮件验证激活。</p>\n<p>具体操作如下：</p>\n<h1>邮件激活功能：</h1>\n<p></p>\n<ol><li style=\"text-align:justify;\">申请邮箱</li><li style=\"text-align:justify;\">开启授权码</li><li style=\"text-align:justify;\">在MailUtils中设置自己的邮箱账号和密码(授权码)</li></ol>\n<p><img alt=\"\" height=\"327\" src=\"..\\..\\static\\image\\37ce8fa145e94dae87e8a803c8f8e00c.png\" width=\"554\"/></p>\n<p> </p>\n<h2 style=\"margin-left:.0001pt;\"><strong><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">邮件工具类：</span><span style=\"color:#000000;\">MailUtils</span><span style=\"color:#000000;\">，调用其中</span><span style=\"color:#000000;\">sendMail</span><span style=\"color:#000000;\">方法可以完成邮件发送：</span></span></strong></h2>\n<p><strong><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">MailUtils：</span></span></strong></p>\n<pre><code class=\"language-java\">package cn.itcast.travel.util;\n\nimport javax.mail.*;\nimport javax.mail.internet.InternetAddress;\nimport javax.mail.internet.MimeMessage;\nimport java.util.Properties;\n\n/**\n * 发邮件工具类\n */\npublic final class MailUtils {\n    private static final String USER = \"********@qq.com\"; // 发件人称号，同邮箱地址\n    private static final String PASSWORD = \"**********\"; // 如果是qq邮箱可填写户端授权码，或者登录密码\n\n    /**\n     *\n     * @param to 收件人邮箱\n     * @param text 邮件正文\n     * @param title 标题\n     */\n    /* 发送验证信息的邮件 */\n    public static boolean sendMail(String to, String text, String title){\n        try {\n            final Properties props = new Properties();\n            props.put(\"mail.smtp.auth\", \"true\");\n            props.put(\"mail.smtp.host\", \"smtp.qq.com\");\n\n            // 发件人的账号\n            props.put(\"mail.user\", USER);\n            //发件人的密码\n            props.put(\"mail.password\", PASSWORD);\n\n            // 构建授权信息，用于进行SMTP进行身份验证\n            Authenticator authenticator = new Authenticator() {\n                @Override\n                protected PasswordAuthentication getPasswordAuthentication() {\n                    // 用户名、密码\n                    String userName = props.getProperty(\"mail.user\");\n                    String password = props.getProperty(\"mail.password\");\n                    return new PasswordAuthentication(userName, password);\n                }\n            };\n            // 使用环境属性和授权信息，创建邮件会话\n            Session mailSession = Session.getInstance(props, authenticator);\n            // 创建邮件消息\n            MimeMessage message = new MimeMessage(mailSession);\n            // 设置发件人\n            String username = props.getProperty(\"mail.user\");\n            InternetAddress form = new InternetAddress(username);\n            message.setFrom(form);\n\n            // 设置收件人\n            InternetAddress toAddress = new InternetAddress(to);\n            message.setRecipient(Message.RecipientType.TO, toAddress);\n\n            // 设置邮件标题\n            message.setSubject(title);\n\n            // 设置邮件的内容体\n            message.setContent(text, \"text/html;charset=UTF-8\");\n            // 发送邮件\n            Transport.send(message);\n            return true;\n        }catch (Exception e){\n            e.printStackTrace();\n        }\n        return false;\n    }\n\n    public static void main(String[] args) { // 做测试用\n        MailUtils.sendMail(\"2621247177@qq.com\",\"你好，这是一封测试邮件，无需回复。\",\"测试邮件\");\n        System.out.println(\"发送成功\");\n    }\n\n\n\n}\n</code></pre>\n<p></p>\n<h2><strong>用户点击邮件激活：</strong>用户激活其实就是修改用户表中的status为‘Y’</h2>\n<p><img alt=\"\" height=\"302\" src=\"..\\..\\static\\image\\565af8c73f9448ea86d5e59091c154f4.png\" width=\"554\"/></p>\n<p> 修改保存Dao代码，加上存储status和code 的代码逻辑：</p>\n<p><img alt=\"\" height=\"152\" src=\"..\\..\\static\\image\\a507858f7f21435ba7e9fc957aab056f.png\" width=\"554\"/></p>\n<p> </p>\n<p style=\"margin-left:0;text-align:justify;\">激活代码实现：</p>\n<p style=\"margin-left:0;text-align:justify;\">ActiveUserServlet：</p>\n<pre><code class=\"language-java\">package cn.itcast.travel.web.servlet;\n\nimport cn.itcast.travel.service.UserService;\nimport cn.itcast.travel.service.impl.UserServiceImpl;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\n\n@WebServlet(\"/activeUserServlet\")\npublic class ActiveUserServlet extends HttpServlet {\n    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //1.获取激活码\n        String code = request.getParameter(\"code\");\n        if(code != null){\n            //2.调用service完成激活\n            UserService service = new UserServiceImpl();\n            boolean flag = service.active(code);\n\n            //3.判断标记\n            String msg = null;\n            if(flag){\n                //激活成功\n                msg = \"激活成功，请&lt;a href='login.html'&gt;登录&lt;/a&gt;\";\n            }else{\n                //激活失败\n                msg = \"激活失败，请联系管理员!\";\n            }\n            response.setContentType(\"text/html;charset=utf-8\");\n            response.getWriter().write(msg);\n        }\n\n    }\n\n    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        this.doPost(request, response);\n    }\n}\n</code></pre>\n<p></p>\n<h2 style=\"margin-left:0px;text-align:justify;\"><strong>UserService：active：</strong></h2>\n<p><img alt=\"\" height=\"195\" src=\"..\\..\\static\\image\\49f0add1a3c748598196bc09b4fb59f7.png\" width=\"477\"/></p>\n<pre><code class=\"language-java\">  /**\n     * 激活用户\n     * @param code\n     * @return\n     */\n    @Override\n    public boolean active(String code) {\n        //1.根据激活码查询用户对象\n        User user = userDao.findByCode(code);\n        if(user != null){\n            //2.调用dao的修改激活状态的方法\n            userDao.updateStatus(user);\n            return true;\n        }else{\n            return false;\n        }\n\n\n\n    }</code></pre>\n<p> userDao：之后会有相同的流程，为了便捷，接口部分将省略不写，对三层架构有了解的小伙伴应该对这个流程轻车熟路了。</p>\n<p> <img alt=\"\" height=\"105\" src=\"..\\..\\static\\image\\0ae47d7cb2b945afa43d6aefbd1cb6e1.png\" width=\"413\"/></p>\n<p>  userDaoImpl：</p>\n<pre><code class=\"language-java\">  /**\n     * 根据激活码查询用户对象\n     * @param code\n     * @return\n     */\n    @Override\n    public User findByCode(String code) {\n        User user = null;\n        try {\n            String sql = \"select * from tab_user where code = ?\";\n\n            user = template.queryForObject(sql,new BeanPropertyRowMapper&lt;User&gt;(User.class),code);\n        } catch (DataAccessException e) {\n            e.printStackTrace();\n        }\n\n        return user;\n    }\n\n    /**\n     * 修改指定用户激活状态\n     * @param user\n     */\n    @Override\n    public void updateStatus(User user) {\n        String sql = \" update tab_user set status = 'Y' where uid=?\";\n        template.update(sql,user.getUid());\n    }</code></pre>\n<p>登录功能的实现：</p>\n<p>前台代码：</p>\n<p>login.html</p>\n<p><img alt=\"\" height=\"220\" src=\"..\\..\\static\\image\\20dc471ec8ca49c9947f9e4b8738c53f.png\" width=\"554\"/></p>\n<p> </p>\n<pre><code class=\"language-java\">&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;title&gt;黑马旅游网-登录&lt;/title&gt;  \n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/common.css\"&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/login.css\"&gt;\n    &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;\n    &lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;\n    &lt;!--[if lt IE 9]&gt;\n      &lt;script src=\"https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js\"&gt;&lt;/script&gt;\n      &lt;script src=\"https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js\"&gt;&lt;/script&gt;\n    &lt;![endif]--&gt;\n      &lt;!--导入angularJS文件--&gt;\n    &lt;!--&lt;script src=\"js/angular.min.js\"&gt;&lt;/script&gt;--&gt;\n\t&lt;!--导入jquery--&gt;\n\t&lt;script src=\"js/jquery-3.3.1.js\"&gt;&lt;/script&gt;\n\n\t&lt;script&gt;\n\n\t\t$(function () {\n            //1.给登录按钮绑定单击事件\n\t\t\t$(\"#btn_sub\").click(function () {\n                //2.发送ajax请求，提交表单数据\n\t\t\t\t$.post(\"user/login\",$(\"#loginForm\").serialize(),function (data) {\n\t\t\t\t\t//data : {flag:false,errorMsg:''}\n\t\t\t\t\tif(data.flag){\n\t\t\t\t\t    //登录成功\n\t\t\t\t\t\tlocation.href=\"index.html\";\n\t\t\t\t\t}else{\n\t\t\t\t\t    //登录失败\n\t\t\t\t\t\t$(\"#errorMsg\").html(data.errorMsg);\n\t\t\t\t\t}\n                });\n            });\n        });\n\n\n\t\t//3.处理响应结果\n\n\n\n\n\t&lt;/script&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;!--引入头部--&gt;\n&lt;div id=\"header\"&gt;&lt;/div&gt;\n    &lt;!-- 头部 end --&gt;\n    &lt;section id=\"login_wrap\"&gt;\n        &lt;div class=\"fullscreen-bg\" style=\"background: url(images/login_bg.png);height: 532px;\"&gt;\n        \t\n        &lt;/div&gt;\n        &lt;div class=\"login-box\"&gt;\n        \t&lt;div class=\"title\"&gt;\n        \t\t&lt;img src=\"images/login_logo.png\" alt=\"\"&gt;\n        \t\t&lt;span&gt;欢迎登录黑马旅游账户&lt;/span&gt;\n        \t&lt;/div&gt;\n        \t&lt;div class=\"login_inner\"&gt;\n\t\t\t\t\n\t\t\t\t&lt;!--登录错误提示消息--&gt;\n        \t\t&lt;div id=\"errorMsg\" class=\"alert alert-danger\" &gt;&lt;/div&gt;\n\t\t\t\t&lt;form id=\"loginForm\" action=\"\" method=\"post\" accept-charset=\"utf-8\"&gt;\n        \t\t\t&lt;input type=\"hidden\" name=\"action\" value=\"login\"/&gt;\n\t\t\t\t\t&lt;input name=\"username\" type=\"text\" placeholder=\"请输入账号\" autocomplete=\"off\"&gt;\n        \t\t\t&lt;input name=\"password\" type=\"text\" placeholder=\"请输入密码\" autocomplete=\"off\"&gt;\n        \t\t\t&lt;div class=\"verify\"&gt;\n\t\t\t\t\t&lt;input name=\"check\" type=\"text\" placeholder=\"请输入验证码\" autocomplete=\"off\"&gt;\n\t\t\t\t\t&lt;span&gt;&lt;img src=\"checkCode\" alt=\"\" onclick=\"changeCheckCode(this)\"&gt;&lt;/span&gt;\n\t\t\t\t\t&lt;script type=\"text/javascript\"&gt;\n\t\t\t\t\t\t//图片点击事件\n\t\t\t\t\t\tfunction changeCheckCode(img) {\n\t\t\t\t\t\t\timg.src=\"checkCode?\"+new Date().getTime();\n\t\t\t\t\t\t}\n\t\t\t\t\t&lt;/script&gt;\n\t\t\t&lt;/div&gt;\n\t\t\t&lt;div class=\"submit_btn\"&gt;\n        \t\t\t\t&lt;button type=\"button\"  id=\"btn_sub\"&gt;登录&lt;/button&gt;\n        \t\t\t\t&lt;div class=\"auto_login\"&gt;\n        \t\t\t\t\t&lt;input type=\"checkbox\" name=\"\" class=\"checkbox\"&gt;\n        \t\t\t\t\t&lt;span&gt;自动登录&lt;/span&gt;\n        \t\t\t\t&lt;/div&gt;        \t\t\t\t\n        \t\t\t&lt;/div&gt;        \t\t\t       \t\t\n        \t\t&lt;/form&gt;\n        \t\t&lt;div class=\"reg\"&gt;没有账户？&lt;a href=\"javascript:;\"&gt;立即注册&lt;/a&gt;&lt;/div&gt;\n        \t&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/section&gt;\n    &lt;!--引入尾部--&gt;\n    &lt;div id=\"footer\"&gt;&lt;/div&gt;\n    &lt;!-- jQuery (necessary for Bootstrap's JavaScript plugins) --&gt;\n    &lt;script src=\"js/jquery-1.11.0.min.js\"&gt;&lt;/script&gt;\n    &lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;\n    &lt;script src=\"js/bootstrap.min.js\"&gt;&lt;/script&gt;\n    &lt;!--导入布局js，共享header和footer--&gt;\n    &lt;script type=\"text/javascript\" src=\"js/include.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;</code></pre>\n<p>后台代码：</p>\n<p style=\"margin-left:0;text-align:justify;\">LoginServlet</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#008054;\">//1.</span><span style=\"color:#008054;\">获取用户名和密码数据\n\n</span><span style=\"color:#000000;\">Map&lt;String, String[]&gt; map = request.getParameterMap();\n\n</span><span style=\"color:#008054;\">//2.</span><span style=\"color:#008054;\">封装</span><span style=\"color:#008054;\">User</span><span style=\"color:#008054;\">对象\n\n</span><span style=\"color:#000000;\">User user = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">User();\n\n</span><strong><span style=\"color:#000080;\">try </span></strong><span style=\"color:#000000;\">{\n\n    BeanUtils.<em>populate</em>(user,map);\n\n} </span><strong><span style=\"color:#000080;\">catch </span></strong><span style=\"color:#000000;\">(IllegalAccessException e) {\n\n    e.printStackTrace();\n\n} </span><strong><span style=\"color:#000080;\">catch </span></strong><span style=\"color:#000000;\">(InvocationTargetException e) {\n\n    e.printStackTrace();\n\n}\n\n\n\n</span><span style=\"color:#008054;\">//3.</span><span style=\"color:#008054;\">调用</span><span style=\"color:#008054;\">Service</span><span style=\"color:#008054;\">查询\n\n</span><span style=\"color:#000000;\">UserService service = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">UserServiceImpl();\n\nUser u  = service.login(user);\n\n\n\nResultInfo info = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">ResultInfo();\n\n\n\n</span><span style=\"color:#008054;\">//4.</span><span style=\"color:#008054;\">判断用户对象是否为</span><span style=\"color:#008054;\">null\n\n</span><strong><span style=\"color:#000080;\">if</span></strong><span style=\"color:#000000;\">(u == </span><strong><span style=\"color:#000080;\">null</span></strong><span style=\"color:#000000;\">){\n\n    </span><span style=\"color:#008054;\">//</span><span style=\"color:#008054;\">用户名密码或错误\n\n    </span><span style=\"color:#000000;\">info.setFlag(</span><strong><span style=\"color:#000080;\">false</span></strong><span style=\"color:#000000;\">);\n\n    info.setErrorMsg(</span><strong><span style=\"color:#0000FF;\">\"</span></strong><strong><span style=\"color:#0000FF;\">用户名密码或错误</span></strong><strong><span style=\"color:#0000FF;\">\"</span></strong><span style=\"color:#000000;\">);\n\n}\n\n</span><span style=\"color:#008054;\">//5.</span><span style=\"color:#008054;\">判断用户是否激活\n\n</span><strong><span style=\"color:#000080;\">if</span></strong><span style=\"color:#000000;\">(u != </span><strong><span style=\"color:#000080;\">null </span></strong><span style=\"color:#000000;\">&amp;&amp; !</span><strong><span style=\"color:#0000FF;\">\"Y\"</span></strong><span style=\"color:#000000;\">.equals(u.getStatus())){\n\n    </span><span style=\"color:#008054;\">//</span><span style=\"color:#008054;\">用户尚未激活\n\n    </span><span style=\"color:#000000;\">info.setFlag(</span><strong><span style=\"color:#000080;\">false</span></strong><span style=\"color:#000000;\">);\n\n    info.setErrorMsg(</span><strong><span style=\"color:#0000FF;\">\"</span></strong><strong><span style=\"color:#0000FF;\">您尚未激活，请激活</span></strong><strong><span style=\"color:#0000FF;\">\"</span></strong><span style=\"color:#000000;\">);\n\n}\n\n</span><span style=\"color:#008054;\">//6.</span><span style=\"color:#008054;\">判断登录成功\n\n</span><strong><span style=\"color:#000080;\">if</span></strong><span style=\"color:#000000;\">(u != </span><strong><span style=\"color:#000080;\">null </span></strong><span style=\"color:#000000;\">&amp;&amp; </span><strong><span style=\"color:#0000FF;\">\"Y\"</span></strong><span style=\"color:#000000;\">.equals(u.getStatus())){\n\n    </span><span style=\"color:#008054;\">//</span><span style=\"color:#008054;\">登录成功\n\n    </span><span style=\"color:#000000;\">info.setFlag(</span><strong><span style=\"color:#000080;\">true</span></strong><span style=\"color:#000000;\">);\n\n}\n\n\n\n</span><span style=\"color:#008054;\">//</span><span style=\"color:#008054;\">响应数据\n\n</span><span style=\"color:#000000;\">ObjectMapper mapper = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">ObjectMapper();\n\n\n\nresponse.setContentType(</span><strong><span style=\"color:#0000FF;\">\"application/json;charset=utf-8\"</span></strong><span style=\"color:#000000;\">);\n\nmapper.writeValue(response.getOutputStream(),info);</span></span></span></pre>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">UserService</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><strong><span style=\"color:#000080;\">public </span></strong><span style=\"color:#000000;\">User login(User user) {\n\n    </span><strong><span style=\"color:#000080;\">return </span></strong><strong><span style=\"color:#660e7a;\">userDao</span></strong><span style=\"color:#000000;\">.findByUsernameAndPassword(user.getUsername(),user.getPassword());\n\n}</span></span></span></pre>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">UserDao</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><strong><span style=\"color:#000080;\">public </span></strong><span style=\"color:#000000;\">User findByUsernameAndPassword(String username, String password) {\n\n    User user = </span><strong><span style=\"color:#000080;\">null</span></strong><span style=\"color:#000000;\">;\n\n    </span><strong><span style=\"color:#000080;\">try </span></strong><span style=\"color:#000000;\">{\n\n        </span><span style=\"color:#008054;\">//1.</span><span style=\"color:#008054;\">定义</span><span style=\"color:#008054;\">sql\n\n        </span><span style=\"color:#000000;\">String sql = </span><strong><span style=\"color:#0000FF;\">\"select </span></strong><em><span style=\"color:#0000FF;\">*</span></em><strong><span style=\"color:#0000FF;\"> from tab_user where username = ? and password = ?\"</span></strong><span style=\"color:#000000;\">;\n\n        </span><span style=\"color:#008054;\">//2.</span><span style=\"color:#008054;\">执行</span><span style=\"color:#008054;\">sql\n\n        </span><span style=\"color:#000000;\">user = </span><strong><span style=\"color:#660e7a;\">template</span></strong><span style=\"color:#000000;\">.queryForObject(sql, </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">BeanPropertyRowMapper&lt;User&gt;(User.</span><strong><span style=\"color:#000080;\">class</span></strong><span style=\"color:#000000;\">), username,password);\n\n    } </span><strong><span style=\"color:#000080;\">catch </span></strong><span style=\"color:#000000;\">(Exception e) {\n\n\n\n    }\n\n\n\n    </span><strong><span style=\"color:#000080;\">return </span></strong><span style=\"color:#000000;\">user;\n\n}</span></span></span></pre>\n<p></p>\n<p><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">细节优化提示交给小伙伴自己完成。</span></span></span></p>\n<h1><span style=\"color:#fe2c24;\"><strong><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\">接下来是一个重点（但非常简单）<u>优化servlet</u>——</span></span></strong></span></h1>\n<p>减少Servlet的数量，现在是一个功能一个Servlet，将其优化为一个模块一个Servlet，相当于在数据库中一张表对应一个Servlet，在Servlet中提供不同的方法，完成用户的请求。</p>\n<p><img alt=\"\" height=\"358\" src=\"..\\..\\static\\image\\a2b1ca656c0343769429cdf3efe31970.png\" width=\"554\"/></p>\n<p> 通过继承实现：</p>\n<p>BaseServlet编写：</p>\n<pre><code class=\"language-java\">//9.2\tBaseServlet编写：\n\n\tpublic class BaseServlet extends HttpServlet {\n\n\n    @Override\n    protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        //System.out.println(\"baseServlet的service方法被执行了...\");\n\n        //完成方法分发\n        //1.获取请求路径\n        String uri = req.getRequestURI(); //   /travel/user/add\n        System.out.println(\"请求uri:\"+uri);//  /travel/user/add\n        //2.获取方法名称\n        String methodName = uri.substring(uri.lastIndexOf('/') + 1);\n        System.out.println(\"方法名称：\"+methodName);\n        //3.获取方法对象Method\n        //谁调用我？我代表谁\n        System.out.println(this);//UserServlet的对象cn.itcast.travel.web.servlet.UserServlet@4903d97e\n        try {\n            //获取方法\n            Method method = this.getClass().getMethod(methodName, HttpServletRequest.class, HttpServletResponse.class);\n            //4.执行方法\n            //暴力反射\n            //method.setAccessible(true);\n            method.invoke(this,req,resp);\n        } catch (NoSuchMethodException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        } catch (InvocationTargetException e) {\n            e.printStackTrace();\n        }\n\n\n    }\n}\n\n</code></pre>\n<h2>UserServlet改写:</h2>\n<p>将之前的Servlet实现的功能，抽取到UserServlet中的不同方法中实现，并且将UserService创建抽取到成员变量位置</p>\n<pre><code class=\"language-java\">\n@WebServlet(\"/user/*\") // /user/add /user/find\npublic class UserServlet extends BaseServlet {\n\n    //声明UserService业务对象\n    private UserService service = new UserServiceImpl();\n\n    /**\n     * 注册功能\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void regist(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n        //验证校验\n        String check = request.getParameter(\"check\");\n        //从sesion中获取验证码\n        HttpSession session = request.getSession();\n        String checkcode_server = (String) session.getAttribute(\"CHECKCODE_SERVER\");\n        session.removeAttribute(\"CHECKCODE_SERVER\");//为了保证验证码只能使用一次\n        //比较\n        if(checkcode_server == null || !checkcode_server.equalsIgnoreCase(check)){\n            //验证码错误\n            ResultInfo info = new ResultInfo();\n            //注册失败\n            info.setFlag(false);\n            info.setErrorMsg(\"验证码错误\");\n            //将info对象序列化为json\n            ObjectMapper mapper = new ObjectMapper();\n            String json = mapper.writeValueAsString(info);\n            response.setContentType(\"application/json;charset=utf-8\");\n            response.getWriter().write(json);\n            return;\n        }\n\n        //1.获取数据\n        Map&lt;String, String[]&gt; map = request.getParameterMap();\n\n        //2.封装对象\n        User user = new User();\n        try {\n            BeanUtils.populate(user,map);\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        } catch (InvocationTargetException e) {\n            e.printStackTrace();\n        }\n\n        //3.调用service完成注册\n        //UserService service = new UserServiceImpl();\n        boolean flag = service.regist(user);\n        ResultInfo info = new ResultInfo();\n        //4.响应结果\n        if(flag){\n            //注册成功\n            info.setFlag(true);\n        }else{\n            //注册失败\n            info.setFlag(false);\n            info.setErrorMsg(\"注册失败!\");\n        }\n\n        //将info对象序列化为json\n        ObjectMapper mapper = new ObjectMapper();\n        String json = mapper.writeValueAsString(info);\n\n        //将json数据写回客户端\n        //设置content-type\n        response.setContentType(\"application/json;charset=utf-8\");\n        response.getWriter().write(json);\n\n    }\n\n    /**\n     * 登录功能\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void login(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //1.获取用户名和密码数据\n        Map&lt;String, String[]&gt; map = request.getParameterMap();\n        //2.封装User对象\n        User user = new User();\n        try {\n            BeanUtils.populate(user,map);\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        } catch (InvocationTargetException e) {\n            e.printStackTrace();\n        }\n\n        //3.调用Service查询\n       // UserService service = new UserServiceImpl();\n        User u  = service.login(user);\n\n        ResultInfo info = new ResultInfo();\n\n        //4.判断用户对象是否为null\n        if(u == null){\n            //用户名密码或错误\n            info.setFlag(false);\n            info.setErrorMsg(\"用户名密码或错误\");\n        }\n        //5.判断用户是否激活\n        if(u != null &amp;&amp; !\"Y\".equals(u.getStatus())){\n            //用户尚未激活\n            info.setFlag(false);\n            info.setErrorMsg(\"您尚未激活，请激活\");\n        }\n        //6.判断登录成功\n        if(u != null &amp;&amp; \"Y\".equals(u.getStatus())){\n            request.getSession().setAttribute(\"user\",u);//登录成功标记\n\n            //登录成功\n            info.setFlag(true);\n        }\n\n        //响应数据\n        ObjectMapper mapper = new ObjectMapper();\n\n        response.setContentType(\"application/json;charset=utf-8\");\n        mapper.writeValue(response.getOutputStream(),info);\n    }\n\n    /**\n     * 查询单个对象\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void findOne(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //从session中获取登录用户\n        Object user = request.getSession().getAttribute(\"user\");\n        //将user写回客户端\n\n        ObjectMapper mapper = new ObjectMapper();\n        response.setContentType(\"application/json;charset=utf-8\");\n        mapper.writeValue(response.getOutputStream(),user);\n    }\n\n    /**\n     * 退出功能\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void exit(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //1.销毁session\n        request.getSession().invalidate();\n\n        //2.跳转登录页面\n        response.sendRedirect(request.getContextPath()+\"/login.html\");\n    }\n\n    /**\n     * 激活功能\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void active(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //1.获取激活码\n        String code = request.getParameter(\"code\");\n        if(code != null){\n            //2.调用service完成激活\n            //UserService service = new UserServiceImpl();\n            boolean flag = service.active(code);\n\n            //3.判断标记\n            String msg = null;\n            if(flag){\n                //激活成功\n                msg = \"激活成功，请&lt;a href='login.html'&gt;登录&lt;/a&gt;\";\n            }else{\n                //激活失败\n                msg = \"激活失败，请联系管理员!\";\n            }\n            response.setContentType(\"text/html;charset=utf-8\");\n            response.getWriter().write(msg);\n        }\n    }\n}\n</code></pre>\n<h2>分类数据展示（难点）：</h2>\n<p>后端代码完成这个功能十分简单，麻烦的是前端代码的分页显示设置。</p>\n<p>以下代码是优化缓存之后的版本，启动redis服务，第一次从数据库中获取数据，并保存在缓存中，之后每次访问都从缓存中查询，提高效率节约资源。</p>\n<p></p>\n<h1><strong>CategoryServiceImpl：</strong></h1>\n<pre><code class=\"language-java\">public class CategoryServiceImpl implements CategoryService {\n    private categoryDao categoryDao=new categoryDaoImpl();\n    @Override\n    public List&lt;Category&gt; findAll() {\n        //1.从redis中查询\n        Jedis jedis = JedisUtil.getJedis();\n        //1.1使查询的结果有顺序使用sortedset\n        List&lt;Category&gt;cs=null;\n//        Set&lt;String&gt; categorys = jedis.zrange(\"category\", 0, -1);\n        Set&lt;Tuple&gt; categorys = jedis.zrangeWithScores(\"category\", 0, -1);\n        //2.获取jedis客户端\n        //3.如果为空从数据库查询，不为空在redis中查询\n        if (categorys==null||categorys.size()==0){\n            System.out.println(\"从数据库中查询。。。\");\n            cs=categoryDao.findAll();\n            //将集合数据存储到redis；\n            for (int i = 0; i &lt;cs.size() ; i++) {\n                jedis.zadd(\"category\",cs.get(i).getCid(),cs.get(i).getCname());\n\n            }\n\n        }else {\n            System.out.println(\"从缓存中查询。。。\");\n            //如果不为空，将set集合数据存入list\n            cs=new ArrayList&lt;Category&gt;();\n            for (Tuple tuple : categorys) {\n                Category category=new Category();\n                category.setCname(tuple.getElement());\n                category.setCid((int)tuple.getScore());\n                cs.add(category);\n\n            }\n        }\n\n\n        return cs;\n    }\n}\n</code></pre>\n<p></p>\n<p></p>\n<h2>CategoryServlet：</h2>\n<p></p>\n<pre><code class=\"language-java\">package cn.itcast.travel.web.servlet;\n\nimport cn.itcast.travel.domain.Category;\nimport cn.itcast.travel.service.CategoryService;\nimport cn.itcast.travel.service.impl.CategoryServiceImpl;\nimport com.fasterxml.jackson.databind.ObjectMapper;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport java.io.IOException;\nimport java.util.List;\n\n@WebServlet(\"/category/*\")\npublic class CategoryServlet extends BaseServlet {\n    private CategoryService service=new CategoryServiceImpl();\n    /**\n     * 查询所有\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void findAll(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n          //1.查询所有\n        List&lt;Category&gt;cs=service.findAll();\n//        //2.序列化返回\n//        ObjectMapper mapper=new ObjectMapper();\n//        response.setContentType(\"application/json;charset=utf-8\");\n//        mapper.writeValue(response.getOutputStream(),cs);\n        writeValue(cs,response);\n\n\n\n    }\n\n   public void find(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n    }\n}\n</code></pre>\n<h2></h2>\n<h2>CategoryDao：</h2>\n<pre><code class=\"language-java\">\npublic class CategoryDaoImpl implements CategoryDao {\n\n    private JdbcTemplate template = new JdbcTemplate(JDBCUtils.getDataSource());\n\n    @Override\n    public List&lt;Category&gt; findAll() {\n        String sql = \"select * from tab_category \";\n        return template.query(sql,new BeanPropertyRowMapper&lt;Category&gt;(Category.class));\n    }\n}\n</code></pre>\n<p style=\"margin-left:0;text-align:justify;\">在BaseServlet中封装了序列化json的方法</p>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p><span style=\"color:#808080;\">/**<br/>  * </span><span style=\"color:#808080;\">直接将传入的对象序列化为</span><span style=\"color:#808080;\">json</span><span style=\"color:#808080;\">，并且写回客户端</span><br/>  <span style=\"color:#808080;\">* <strong>@param </strong></span><strong><em><span style=\"color:#3d3d3d;\">obj<br/>  </span></em></strong><span style=\"color:#808080;\">*/</span><br/><strong><span style=\"color:#000080;\">public void </span></strong><span style=\"color:#000000;\">writeValue(Object obj,HttpServletResponse response) </span><strong><span style=\"color:#000080;\">throws </span></strong><span style=\"color:#000000;\">IOException {<!-- --><br/>     ObjectMapper mapper = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">ObjectMapper();<br/>     response.setContentType(</span><strong><span style=\"color:#0000FF;\">\"application/json;charset=utf-8\"</span></strong><span style=\"color:#000000;\">);<br/>     mapper.writeValue(response.getOutputStream(),obj);<br/> }</span><br/><br/><span style=\"color:#808080;\">/**<br/>  * </span><span style=\"color:#808080;\">将传入的对象序列化为</span><span style=\"color:#808080;\">json</span><span style=\"color:#808080;\">，返回</span></p>\n<span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"> <span style=\"color:#808080;\">* <strong>@param </strong></span><strong><em><span style=\"color:#3d3d3d;\">obj </span></em></strong></span></span>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#808080;\">* <strong>@return\n </strong>*/\n\n</span><strong><span style=\"color:#000080;\">public </span></strong><span style=\"color:#000000;\">String writeValueAsString(Object obj) </span><strong><span style=\"color:#000080;\">throws </span></strong><span style=\"color:#000000;\">JsonProcessingException {\n\n    ObjectMapper mapper = </span><strong><span style=\"color:#000080;\">new </span></strong><span style=\"color:#000000;\">ObjectMapper();\n\n    </span><strong><span style=\"color:#000080;\">return </span></strong><span style=\"color:#000000;\">mapper.writeValueAsString(obj);\n\n}</span></span></span></pre>\n<p><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">之后根据需要调用即可。</span></span></span></p>\n<p><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">之后是最麻烦的前台代码：麻烦的点在于分页处理，需要设置分页信息展示：</span></span></span></p>\n<p><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#000000;\">后端别忘记了创建分页展示使用到的实体类：</span></span></span></p>\n<p><img alt=\"\" height=\"207\" src=\"..\\..\\static\\image\\ed6820f1727b43b4a58182b64fe7478a.png\" width=\"251\"/></p>\n<p>pageBean内容：</p>\n<pre><code class=\"language-java\">package cn.itcast.travel.domain;\n\nimport java.util.List;\n\npublic class PageBean&lt;T&gt; {\n    private int totalCount;//总记录数\n    private int totalPage;//总页数\n    private int currentPage;//当前页码\n    private int pageSize;//每页显示的条数\n    private List&lt;T&gt;list;//每页显示的数据集合\n\n    public int getTotalCount() {\n        return totalCount;\n    }\n\n    public void setTotalCount(int totalCount) {\n        this.totalCount = totalCount;\n    }\n\n    public int getTotalPage() {\n        return totalPage;\n    }\n\n    public void setTotalPage(int totalPage) {\n        this.totalPage = totalPage;\n    }\n\n    public int getCurrentPage() {\n        return currentPage;\n    }\n\n    public void setCurrentPage(int currentPage) {\n        this.currentPage = currentPage;\n    }\n\n    public int getPageSize() {\n        return pageSize;\n    }\n\n    public void setPageSize(int pageSize) {\n        this.pageSize = pageSize;\n    }\n\n    public List&lt;T&gt; getList() {\n        return list;\n    }\n\n    public void setList(List&lt;T&gt; list) {\n        this.list = list;\n    }\n}\n</code></pre>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<pre><code class=\"language-html\">&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n    &lt;title&gt;黑马旅游-搜索&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/common.css\"&gt;\n    &lt;link rel=\"stylesheet\" href=\"css/search.css\"&gt;\n    &lt;script src=\"js/jquery-3.3.1.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"js/getParameter.js\"&gt;\n    &lt;/script&gt;\n    &lt;script&gt;\n        $(function () {\n            var search = location.search;\n            // alert(search);\n            //获取切割字符串，拿到第二个值\n            // var cid = search.split(\"=\")[1];\n            var cid = getParameter(\"cid\");\n            var rname = getParameter(\"rname\");\n            if (rname){\n                rname=window.decodeURIComponent(rname);\n            }\n\n            //当页面加载完成后，调用load1方法发送ajax请求加载数据\n            load1(cid,null,rname);\n\n\n        });\n        function load1(cid,currentPage,rname) {\n            //发送ajax请求，请求route/pageQuery,传递cid\n            $.get(\"/route/pageQuery\",{cid:cid,currentPage:currentPage,rname:rname},function (pb) {\n                $(\"#totalPage\").html(pb.totalPage);\n                $(\"#totalCount\").html(pb.totalCount);\n                /**\n                 *  &lt;li&gt;&lt;a href=\"\"&gt;首页&lt;/a&gt;&lt;/li&gt;\n                 &lt;li class=\"threeword\"&gt;&lt;a href=\"#\"&gt;上一页&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;1&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;2&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;3&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;4&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;5&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;6&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;7&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;8&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;9&lt;/a&gt;&lt;/li&gt;\n                 &lt;li&gt;&lt;a href=\"#\"&gt;10&lt;/a&gt;&lt;/li&gt;\n                 &lt;li class=\"threeword\"&gt;&lt;a href=\"JavaScript:;\"&gt;下一页&lt;/a&gt;&lt;/li&gt;\n                 &lt;li class=\"threeword\"&gt;&lt;a href=\"JavaScript:;\"&gt;末页&lt;/a&gt;&lt;/li&gt;\n                 */\n\n                var beforePage=pb.currentPage-1;\n                if (beforePage&lt;=0){\n                    beforePage=1;\n                }\n\n\n                var fistPage='&lt;li onclick=\"JavaScript:load1('+cid+',1,'+rname+')\"&gt;&lt;a href=\"JavaScript:void(0)\"&gt;首页&lt;/a&gt;&lt;/li&gt;';\n                var prePage='&lt;li onclick=\"JavaScript:load1('+cid+','+beforePage+','+rname+')\" class=\"threeword\"&gt;&lt;a href=\"#\"&gt;上一页&lt;/a&gt;&lt;/li&gt;';\n                var lis=\"\";\n                lis+=fistPage;\n                lis+=prePage;\n\n\n                //展示分页页码\n                var begin;\n                var end;\n                if (pb.totalPage&lt;10){\n                    begin=1;\n                    end=pb.totalPage;\n                }else {\n                    begin=pb.currentPage-5;\n                    end=pb.currentPage+4;\n                    if (begin&lt;1){\n                        begin=1;\n                        end=10;\n                    }\n                    if (end&gt;pb.totalPage){\n                        end=pb.totalPage;\n                        begin=end-9;\n\n                    }\n                }\n\n                for (var i = begin; i &lt;=end ; i++) {\n                    var li;\n                    if (pb.currentPage==i){\n                        var li='&lt;li class=\"curPage\" onclick=\"JavaScript:load1('+cid+','+i+','+rname+')\"&gt;&lt;a href=\"JavaScript:void(0)\"&gt;'+i+'&lt;/a&gt;&lt;/li&gt;';\n\n                    }else {\n                        var li='&lt;li onclick=\"JavaScript:load1('+cid+','+i+','+rname+')\"&gt;&lt;a href=\"JavaScript:void(0)\"&gt;'+i+'&lt;/a&gt;&lt;/li&gt;';\n                    }\n                    //创建页码的li\n\n                    //拼接字符串\n                    lis+=li;\n\n\n                }\n                var  nextPage=pb.currentPage+1;\n                if (nextPage&gt;=pb.totalPage){\n                    nextPage=pb.totalPage;\n                }\n\n                nextPage='&lt;li li onclick=\"JavaScript:load1('+cid+','+nextPage+','+rname+')\" class=\"threeword\"&gt;&lt;a href=\"#\"&gt;下一页&lt;/a&gt;&lt;/li&gt;';\n                var finalPage=' &lt;li onclick=\"JavaScript:load1('+cid+','+pb.totalPage+','+rname+')\" class=\"threeword\"&gt;&lt;a href=\"#\"&gt;末页&lt;/a&gt;&lt;/li&gt;';\n                lis+=nextPage;\n                lis+=finalPage;\n\n                //将lis内容设置到url\n                var route_lis=\"\";\n                $(\"#pageNum\").html(lis);\n                for (var i = 0; i &lt;pb.list.length; i++) {\n                    var route=pb.list[i];\n                    var li=' &lt;li&gt;\\n' +\n                        '&lt;div class=\"img\"&gt;&lt;img src=\"'+route.rimage+'\" style=\"width: 299px\"&gt;&lt;/div&gt;\\n' +\n                        '&lt;div class=\"text1\"&gt;\\n' +\n                        ' &lt;p&gt;'+route.rname+'&lt;/p&gt;\\n' +\n                        '&lt;br/&gt;\\n' +\n                        '&lt;p&gt;'+route.routeIntroduce+'&lt;/p&gt;\\n' +\n                        '&lt;/div&gt;\\n' +\n                        '&lt;div class=\"price\"&gt;\\n' +\n                        '&lt;p class=\"price_num\"&gt;\\n' +\n                        '&lt;span&gt;&amp;yen;&lt;/span&gt;\\n' +\n                        '&lt;span&gt;'+route.price+'&lt;/span&gt;\\n' +\n                        '&lt;span&gt;起&lt;/span&gt;\\n' +\n                        '&lt;/p&gt;\\n' +\n                        '&lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;' +\n                        '&lt;/div&gt;\\n' +\n                        '&lt;/li&gt;';\n\n                    route_lis+=li;\n\n                }\n                $(\"#route\").html(route_lis);\n                //跳转到页面顶部\n                window.scrollTo(0,0);\n\n\n            });\n            //分页工具条展示\n            //解析数据，展示到页面上\n\n        }\n    &lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;!--引入头部--&gt;\n&lt;div id=\"header\"&gt;&lt;/div&gt;\n    &lt;div class=\"page_one\"&gt;\n        &lt;div class=\"contant\"&gt;\n            &lt;div class=\"crumbs\"&gt;\n                &lt;img src=\"images/search.png\" alt=\"\"&gt;\n                &lt;p&gt;黑马旅行&gt;&lt;span&gt;搜索结果&lt;/span&gt;&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"xinxi clearfix\"&gt;\n                &lt;div class=\"left\"&gt;\n                    &lt;div class=\"header\"&gt;\n                        &lt;span&gt;商品信息&lt;/span&gt;\n                        &lt;span class=\"jg\"&gt;价格&lt;/span&gt;\n                    &lt;/div&gt;\n                    &lt;ul id=\"route\"&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;【减100元 含除夕/春节出发】广州增城三英温泉度假酒店/自由行套票&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;299&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;浪花朵朵旅行普吉岛丛林飞跃空中飞人探险游中文服务泰国旅游&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;899&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;黑妞皇家旅行普吉岛攀牙湾大船星光之旅皮划艇日落休闲特色体验&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;999&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;浪花朵朵旅行普吉岛皇帝岛珊瑚岛香蕉船拖拽伞水上项目&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;99&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;环游记 泰国清迈Lila massage女子监狱spa 丽菈泰式按摩马杀鸡&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;199&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;【减100元 含除夕/春节出发】广州增城三英温泉度假酒店/自由行套票&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;899&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;【减100元 含除夕/春节出发】广州增城三英温泉度假酒店/自由行套票&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;1199&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"img\"&gt;&lt;img src=\"images/04-search_03.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"text1\"&gt;\n                                &lt;p&gt;泰国芭提雅三合一日游芭提雅蒂芬妮人妖秀成人门票bigeye含接送&lt;/p&gt;\n                                &lt;br/&gt;\n                                &lt;p&gt;1-2月出发，网付立享￥1099/2人起！爆款位置有限，抢完即止！&lt;/p&gt;\n                            &lt;/div&gt;\n                            &lt;div class=\"price\"&gt;\n                                &lt;p class=\"price_num\"&gt;\n                                    &lt;span&gt;&amp;yen;&lt;/span&gt;\n                                    &lt;span&gt;1589&lt;/span&gt;\n                                    &lt;span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                                &lt;p&gt;&lt;a href=\"route_detail.html\"&gt;查看详情&lt;/a&gt;&lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                    &lt;/ul&gt;\n                    &lt;div class=\"page_num_inf\"&gt;\n                        &lt;i&gt;&lt;/i&gt; 共\n                        &lt;span id=\"totalPage\"&gt;12&lt;/span&gt;页&lt;span id=\"totalCount\"&gt;132&lt;/span&gt;条\n                    &lt;/div&gt;\n                    &lt;div class=\"pageNum\"&gt;\n                        &lt;ul id=\"pageNum\"&gt;\n                            &lt;li&gt;&lt;a href=\"\"&gt;首页&lt;/a&gt;&lt;/li&gt;\n                            &lt;li class=\"threeword\"&gt;&lt;a href=\"#\"&gt;上一页&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;1&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;2&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;3&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;4&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;5&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;6&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;7&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;8&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;9&lt;/a&gt;&lt;/li&gt;\n                            &lt;li&gt;&lt;a href=\"#\"&gt;10&lt;/a&gt;&lt;/li&gt;\n                            &lt;li class=\"threeword\"&gt;&lt;a href=\"JavaScript:;\"&gt;下一页&lt;/a&gt;&lt;/li&gt;\n                            &lt;li class=\"threeword\"&gt;&lt;a href=\"JavaScript:;\"&gt;末页&lt;/a&gt;&lt;/li&gt;\n                        &lt;/ul&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n                &lt;div class=\"right\"&gt;\n                    &lt;div class=\"top\"&gt;\n                        &lt;div class=\"hot\"&gt;HOT&lt;/div&gt;\n                        &lt;span&gt;热门推荐&lt;/span&gt;\n                    &lt;/div&gt;\n                    &lt;ul&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"left\"&gt;&lt;img src=\"images/04-search_09.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"right\"&gt;\n                                &lt;p&gt;清远新银盏温泉度假村酒店/自由行套...&lt;/p&gt;\n                                &lt;p&gt;网付价&lt;span&gt;&amp;yen;&lt;span&gt;899&lt;/span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"left\"&gt;&lt;img src=\"images/04-search_09.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"right\"&gt;\n                                &lt;p&gt;清远新银盏温泉度假村酒店/自由行套...&lt;/p&gt;\n                                &lt;p&gt;网付价&lt;span&gt;&amp;yen;&lt;span&gt;899&lt;/span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"left\"&gt;&lt;img src=\"images/04-search_09.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"right\"&gt;\n                                &lt;p&gt;清远新银盏温泉度假村酒店/自由行套...&lt;/p&gt;\n                                &lt;p&gt;网付价&lt;span&gt;&amp;yen;&lt;span&gt;899&lt;/span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"left\"&gt;&lt;img src=\"images/04-search_09.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"right\"&gt;\n                                &lt;p&gt;清远新银盏温泉度假村酒店/自由行套...&lt;/p&gt;\n                                &lt;p&gt;网付价&lt;span&gt;&amp;yen;&lt;span&gt;899&lt;/span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                        &lt;li&gt;\n                            &lt;div class=\"left\"&gt;&lt;img src=\"images/04-search_09.jpg\" alt=\"\"&gt;&lt;/div&gt;\n                            &lt;div class=\"right\"&gt;\n                                &lt;p&gt;清远新银盏温泉度假村酒店/自由行套...&lt;/p&gt;\n                                &lt;p&gt;网付价&lt;span&gt;&amp;yen;&lt;span&gt;899&lt;/span&gt;起&lt;/span&gt;\n                                &lt;/p&gt;\n                            &lt;/div&gt;\n                        &lt;/li&gt;\n                    &lt;/ul&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;!--引入头部--&gt;\n    &lt;div id=\"footer\"&gt;&lt;/div&gt;\n    &lt;!--导入布局js，共享header和footer--&gt;\n    &lt;script type=\"text/JavaScript\" src=\"js/include.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;</code></pre>\n<p>实现我的收藏查看功能实质上也是同一个道理，只不过加一个用户登录验证的判断，但麻烦的依旧是标签设置和拼接问题。前台代码不如后台代码逻辑清晰。</p>\n<p>后台代码：</p>\n<pre><code class=\"language-java\">//RouteServlet\n@WebServlet(\"/route/*\")\npublic class RouteServlet extends BaseServlet {\n\n    private RouteService routeService = new RouteServiceImpl();\n\n    /**\n     * 分页查询\n     * @param request\n     * @param response\n     * @throws ServletException\n     * @throws IOException\n     */\n    public void pageQuery(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n        //1.接受参数\n        String currentPageStr = request.getParameter(\"currentPage\");\n        String pageSizeStr = request.getParameter(\"pageSize\");\n        String cidStr = request.getParameter(\"cid\");\n\n        int cid = 0;//类别id\n        //2.处理参数\n        if(cidStr != null &amp;&amp; cidStr.length() &gt; 0){\n            cid = Integer.parseInt(cidStr);\n        }\n        int currentPage = 0;//当前页码，如果不传递，则默认为第一页\n        if(currentPageStr != null &amp;&amp; currentPageStr.length() &gt; 0){\n            currentPage = Integer.parseInt(currentPageStr);\n        }else{\n            currentPage = 1;\n        }\n\n        int pageSize = 0;//每页显示条数，如果不传递，默认每页显示5条记录\n        if(pageSizeStr != null &amp;&amp; pageSizeStr.length() &gt; 0){\n            pageSize = Integer.parseInt(pageSizeStr);\n        }else{\n            pageSize = 5;\n        }\n\n        //3. 调用service查询PageBean对象\n        PageBean&lt;Route&gt; pb = routeService.pageQuery(cid, currentPage, pageSize);\n\n        //4. 将pageBean对象序列化为json，返回\n        writeValue(pb,response);\n\n    }\n\n}\n\n//\tRouteService\npublic class RouteServiceImpl implements RouteService {\n    private RouteDao routeDao = new RouteDaoImpl();\n    @Override\n    public PageBean&lt;Route&gt; pageQuery(int cid, int currentPage, int pageSize) {\n        //封装PageBean\n        PageBean&lt;Route&gt; pb = new PageBean&lt;Route&gt;();\n        //设置当前页码\n        pb.setCurrentPage(currentPage);\n        //设置每页显示条数\n        pb.setPageSize(pageSize);\n        \n        //设置总记录数\n        int totalCount = routeDao.findTotalCount(cid);\n        pb.setTotalCount(totalCount);\n        //设置当前页显示的数据集合\n        int start = (currentPage - 1) * pageSize;//开始的记录数\n        List&lt;Route&gt; list = routeDao.findByPage(cid,start,pageSize);\n        pb.setList(list);\n\n        //设置总页数 = 总记录数/每页显示条数\n        int totalPage = totalCount % pageSize == 0 ? totalCount / pageSize :(totalCount / pageSize) + 1 ;\n        pb.setTotalPage(totalPage);\n\n\n        return pb;\n    }\n}\n\n//RouteDao\npublic class RouteDaoImpl implements RouteDao {\n    private JdbcTemplate template = new JdbcTemplate(JDBCUtils.getDataSource());\n\n    @Override\n    public int findTotalCount(int cid) {\n        String sql = \"select count(*) from tab_route where cid = ?\";\n        return template.queryForObject(sql,Integer.class,cid);\n    }\n\n    @Override\n    public List&lt;Route&gt; findByPage(int cid, int start, int pageSize) {\n        String sql = \"select * from tab_route where cid = ? limit ? , ?\";\n\n        return template.query(sql,new BeanPropertyRowMapper&lt;Route&gt;(Route.class),cid,start,pageSize);\n    }\n}\n\n\n</code></pre>\n<h1><strong>完成收藏功能：</strong></h1>\n<p></p>\n<ol><li style=\"text-align:justify;\">旅游线路收藏功能 \n    <ol><li style=\"text-align:justify;\">分析 \n      <ol><li style=\"text-align:justify;\"> 判断当前登录用户是否收藏过该线路</li></ol></li></ol></li></ol>\n<p style=\"margin-left:0;text-align:justify;\">当页面加载完成后，发送ajax请求，获取用户是否收藏的标记</p>\n<p style=\"margin-left:0;text-align:justify;\">根据标记，展示不同的按钮样式</p>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"387\" src=\"..\\..\\static\\image\\8ff9704046524289aeb5f26af181e306.png\" width=\"550\"/></p>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\"><img alt=\"\" height=\"432\" src=\"..\\..\\static\\image\\0f99039ce60945bfbb4b5afb87cafd19.png\" width=\"1200\"/></p>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">后台代码：</p>\n<pre><code class=\"language-java\">//后台代码\n//RouteServlet：\n\npublic void isFavorite(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    //1. 获取线路id\n    String rid = request.getParameter(\"rid\");\n\n    //2. 获取当前登录的用户 user\n    User user = (User) request.getSession().getAttribute(\"user\");\n    int uid;//用户id\n    if(user == null){\n        //用户尚未登录\n        uid = 0;\n    }else{\n        //用户已经登录\n        uid = user.getUid();\n    }\n\n    //3. 调用FavoriteService查询是否收藏\n    boolean flag = favoriteService.isFavorite(rid, uid);\n\n    //4. 写回客户端\n    writeValue(flag,response);\n}\n\nFavoriteService\n\n@Override\npublic boolean isFavorite(String rid, int uid) {\n\n    Favorite favorite = favoriteDao.findByRidAndUid(Integer.parseInt(rid), uid);\n\n    return favorite != null;//如果对象有值，则为true，反之，则为false\n}\n\n\n\n//FavoriteDao\n\n@Override\npublic Favorite findByRidAndUid(int rid, int uid) {\n    Favorite favorite = null;\n    try {\n        String sql = \" select * from tab_favorite where rid = ? and uid = ?\";\n        favorite = template.queryForObject(sql, new BeanPropertyRowMapper&lt;Favorite&gt;(Favorite.class), rid, uid);\n    } catch (DataAccessException e) {\n        e.printStackTrace();\n    }\n    return favorite;\n}\n</code></pre>\n</div>\n</div>\n<p> 前台代码：</p>\n<pre><code class=\"language-html\">//前台代码\n//route_detail.html\n\n$(function () {\n   // 发送请求，判断用户是否收藏过该线路\n    var rid = getParameter(\"rid\");\n    $.get(\"route/isFavorite\",{rid:rid},function (flag) {\n        if(flag){\n            // 用户已经收藏过\n            //&lt;a  class=\"btn already\" disabled=\"disabled\"&gt;\n            //设置收藏按钮的样式\n            $(\"#favorite\").addClass(\"already\");\n            $(\"#favorite\").prop(\"disabled\",disabled);\n\n\n\n        }else{\n            // 用户没有收藏\n        }\n    });\n</code></pre>\n<h2> 收藏次数的动态展示:</h2>\n<p style=\"margin-left:0;text-align:justify;\">前台：</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#808080;\">//</span><span style=\"color:#808080;\">设置收藏次数\n\n</span><strong><span style=\"color:#660e7a;\">$</span></strong><span style=\"color:#000000;\">(</span><strong><span style=\"color:#008000;\">\"#favoriteCount\"</span></strong><span style=\"color:#000000;\">).</span><span style=\"color:#7a7a43;\">html</span><span style=\"color:#000000;\">(</span><strong><span style=\"color:#008000;\">\"</span></strong><strong><span style=\"color:#008000;\">已收藏</span></strong><strong><span style=\"color:#008000;\">\"</span></strong><span style=\"color:#000000;\">+route.</span><span style=\"color:#7a7a43;\">count</span><span style=\"color:#000000;\">+</span><strong><span style=\"color:#008000;\">\"</span></strong><strong><span style=\"color:#008000;\">次</span></strong><strong><span style=\"color:#008000;\">\"</span></strong><span style=\"color:#000000;\">);</span></span></span></pre>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">后台：</p>\n<p style=\"margin-left:0;text-align:justify;\">         //RouteService</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#008054;\">//4. </span><span style=\"color:#008054;\">查询收藏次数\n\n</span><strong><span style=\"color:#000080;\">int </span></strong><span style=\"color:#000000;\">count = </span><strong><span style=\"color:#660e7a;\">favoriteDao</span></strong><span style=\"color:#000000;\">.findCountByRid(route.getRid());\n\nroute.setCount(count);</span></span></span></pre>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n</div>\n<p style=\"margin-left:0;text-align:justify;\">//FavoriteDao</p>\n<div>\n<pre style=\"margin-left:.0001pt;\"><span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"><span style=\"color:#808000;\">@Override\n\n</span><strong><span style=\"color:#000080;\">public int </span></strong><span style=\"color:#000000;\">findCountByRid(</span><strong><span style=\"color:#000080;\">int </span></strong><span style=\"color:#000000;\">rid) {\n\n    String sql = </span><strong><span style=\"color:#0000FF;\">\"SELECT </span></strong><em><span style=\"color:#0000FF;\">COUNT</span></em><strong><span style=\"color:#0000FF;\">(</span></strong><em><span style=\"color:#0000FF;\">*</span></em><strong><span style=\"color:#0000FF;\">) FROM tab_favorite WHERE rid = ?\"</span></strong><span style=\"color:#000000;\">;\n\n\n\n    </span><strong><span style=\"color:#000080;\">return </span></strong><strong><span style=\"color:#660e7a;\">template</span></strong><span style=\"color:#000000;\">.queryForObject(sql,Integer.</span><strong><span style=\"color:#000080;\">class</span></strong><span style=\"color:#000000;\">,rid);\n\n}</span></span></span></pre>\n<hr/>\n<hr/>\n<ol><li> <h1>点击按钮收藏线路</h1> </li><li> 分析：</li></ol>\n<p style=\"margin-left:0;text-align:justify;\">         <img alt=\"\" height=\"465\" src=\"..\\..\\static\\image\\7f19ddff82994713a7a2ab15aea4bdc6.png\" width=\"1180\"/> </p>\n<ol><li> 编码</li></ol>\n<p style=\"margin-left:0;text-align:justify;\">前台代码<span style=\"background-color:#FFFFFF;\"><span style=\"background-color:#FFFFFF;\"> </span></span></p>\n<div>\n<pre><code class=\"language-html\">   $(function () {\n\n   // 发送请求，判断用户是否收藏过该线路\n\n    var rid = getParameter(\"rid\");\n\n    $.get(\"route/isFavorite\",{rid:rid},function (flag) {\n\n        if(flag){\n\n            // 用户已经收藏过\n\n            //&lt;a  class=\"btn already\" disabled=\"disabled\"&gt;\n\n            //设置收藏按钮的样式\n\n            $(\"#favorite\").addClass(\"already\");\n\n            $(\"#favorite\").attr(\"disabled\",\"disabled\");\n\n\n\n            //删除按钮的点击事件\n\n            $(\"#favorite\").removeAttr(\"onclick\");\n\n        }else{\n\n            // 用户没有收藏\n\n        }\n\n    });\n\n\n\n\n\n\n\n});\n\n\n\n//点击收藏按钮触发的方法\n\nfunction addFavorite(){\n\n    var rid = getParameter(\"rid\");\n\n    //1. 判断用户是否登录\n\n    $.get(\"user/findOne\",{},function (user) {\n\n       if(user){\n\n           //用户登录了\n\n            //添加功能\n\n            $.get(\"route/addFavorite\",{rid:rid},function () {\n\n\n\n                //代码刷新页面\n\n                location.reload();\n\n            });\n\n\n\n       }else{\n\n           //用户没有登录\n\n           alert(\"您尚未登录，请登录\");\n\n           location.href=\"http://localhost/travel/login.html\";\n\n       }\n\n    })\n\n}</code></pre>\n<p>记得在标签内绑定单击事件：</p>\n<pre>&lt;!--收藏按钮1--&gt;\n&lt;<strong><span style=\"color:#fe2c24;\">a οnclick=\"addFavorite();</span>\"</strong> class=\"btn\" id=\"favorite\"&gt;&lt;i class=\"glyphicon glyphicon-heart-empty\"&gt;&lt;/i&gt;点击收藏&lt;/a&gt;\n\n&lt;!--收藏按钮2--&gt;\n&lt;<strong><span style=\"color:#be191c;\">a οnclick=\"removeFavorite();\"</span></strong> class=\"btn already\" disabled=\"disabled\" id=\"cancel_favorite\"&gt;&lt;i class=\"glyphicon glyphicon-heart-empty\"&gt;&lt;/i&gt;取消收藏&lt;/a&gt;\n\n</pre>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">后台代码:</p>\n<p style=\"margin-left:0;text-align:justify;\">RouteServlet</p>\n<div>\n<pre><code class=\"language-java\">public void addFavorite(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n\n    //1. 获取线路rid\n\n    String rid = request.getParameter(\"rid\");\n\n    //2. 获取当前登录的用户\n\n    User user = (User) request.getSession().getAttribute(\"user\");\n\n    int uid;//用户id\n\n    if(user == null){\n\n        //用户尚未登录\n\n        return ;\n\n    }else{\n\n        //用户已经登录\n\n        uid = user.getUid();\n\n    }\n\n\n\n\n\n    //3. 调用service添加\n\n    favoriteService.add(rid,uid);\n\n\n\n}</code></pre>\n<p></p>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">FavoriteService</p>\n<div>\n<pre><code class=\"language-java\">@Override\n\npublic void add(String rid, int uid) {\n\n    favoriteDao.add(Integer.parseInt(rid),uid);\n\n}</code></pre>\n<p></p>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p style=\"margin-left:0;text-align:justify;\">FavoriteDao</p>\n<div>\n<pre><code class=\"language-java\">@Override\n\npublic void add(int rid, int uid) {\n\n    String sql = \"insert into tab_favorite values(?,?,?)\";\n\n\n\n    template.update(sql,rid,new Date(),uid);\n\n}</code></pre>\n<p></p>\n</div>\n<p style=\"margin-left:0;text-align:justify;\"></p>\n<p> </p>\n</div>\n</div>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 1, "java": 0, "sql": 1, "php": 0, "time": "2022-09-02 16:39:30", "summary": "本次项目主要有以下几个重点导入项目、优化、前后台勾连等。如图片所示，这是一个常见的网站首页，包括登录、注册、查看相关信息的功能。但要怎么实现呢？除了准备好相应的图片文字信息，我们要怎么做才能让它拥有以"}