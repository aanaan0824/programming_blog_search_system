{"blogid": "126712017", "writerAge": "码龄7年", "writerBlogNum": "84", "writerCollect": "91", "writerComment": "11", "writerFan": "11", "writerGrade": "4级", "writerIntegral": "1487", "writerName": "Ym影子", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126712017.jpg", "writerRankTotal": "14788", "writerRankWeekly": "5171", "writerThumb": "24", "writerVisitNum": "62692", "blog_read_count": "91", "blog_time": "于 2022-09-05 19:37:27 发布", "blog_title": "Redis 配置文件说明", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"rvZUs-toc\" style=\"margin-left:0px;\"></p>\n<p id=\"mdvMx-toc\" style=\"margin-left:40px;\"><a href=\"#mdvMx\">最小化配置</a></p>\n<p id=\"FscSE-toc\" style=\"margin-left:80px;\"><a href=\"#FscSE\">单点模式</a></p>\n<p id=\"c5f4a-toc\" style=\"margin-left:80px;\"><a href=\"#c5f4a\">主从模式</a></p>\n<p id=\"ndK6h-toc\" style=\"margin-left:80px;\"><a href=\"#ndK6h\">集群模式</a></p>\n<p id=\"PV0wh-toc\" style=\"margin-left:40px;\"><a href=\"#PV0wh\">通用配置</a></p>\n<p id=\"ni09D-toc\" style=\"margin-left:40px;\"><a href=\"#ni09D\">快照配置</a></p>\n<p id=\"asWEU-toc\" style=\"margin-left:40px;\"><a href=\"#asWEU\">同步配置</a></p>\n<p id=\"MBg97-toc\" style=\"margin-left:40px;\"><a href=\"#MBg97\">内存配置</a></p>\n<p id=\"zW1un-toc\" style=\"margin-left:40px;\"><a href=\"#zW1un\">线程配置</a></p>\n<p id=\"R4f32-toc\" style=\"margin-left:40px;\"><a href=\"#R4f32\">AOF配置</a></p>\n<p id=\"SNvKZ-toc\" style=\"margin-left:40px;\"><a href=\"#SNvKZ\">Cluster 配置</a></p>\n<p id=\"LukPy-toc\" style=\"margin-left:40px;\"><a href=\"#LukPy\">慢监控配置</a></p>\n<p id=\"qGkEz-toc\" style=\"margin-left:80px;\"><a href=\"#qGkEz\">慢监控配置</a></p>\n<p id=\"WQEKo-toc\" style=\"margin-left:80px;\"><a href=\"#WQEKo\">慢日志监控</a></p>\n<p id=\"YUVSr-toc\" style=\"margin-left:80px;\"><a href=\"#YUVSr\">实时延迟监控</a></p>\n<p id=\"Ax5SD-toc\" style=\"margin-left:80px;\"><a href=\"#Ax5SD\">查看延迟统计</a></p>\n<p id=\"xCpxY-toc\" style=\"margin-left:40px;\"><a href=\"#xCpxY\">事件通信</a></p>\n<p id=\"RfVGt-toc\" style=\"margin-left:80px;\"><a href=\"#RfVGt\">事件类型说明</a></p>\n<p id=\"i3QZY-toc\" style=\"margin-left:40px;\"><a href=\"#i3QZY\">数据结构配置</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h2 id=\"mdvMx\">最小化配置</h2>\n<h3 id=\"FscSE\">单点模式</h3>\n<p id=\"u944582bd\">bind 0.0.0.0 #主机 IP</p>\n<p id=\"u83ec00ee\">protected-mode no #保护模式设成 no</p>\n<p id=\"u45b0eedf\">port 6379 #Redis 端口</p>\n<p id=\"u44035f56\">pidfile \"/home/xiangsl/redis/run/redis_6379.pid\" #进程文件</p>\n<p id=\"u631d56f2\">logfile \"/home/xiangsl/redis/log/redis_6379.log\" #日志文件</p>\n<p id=\"udb24d548\">daemonize yes #守护模式</p>\n<p id=\"ua3f7b716\">save 3600 1 #rdb 配置</p>\n<p id=\"u3613a701\">save 300 100</p>\n<p id=\"ub56a27cb\">save 60 10000</p>\n<p id=\"u4d0a1d98\">dbfilename \"dump_6379.rdb\" #rdb 文件</p>\n<p id=\"u9dacc56c\">appendonly no #aof 配置</p>\n<p id=\"u9633637e\">appendfilename \"appendonly_6379.aof\" #aof 文件</p>\n<p id=\"u5f8a8e48\">appenddirname \"appendonlydir_6379\" #aof 文件夹</p>\n<p id=\"u79ee48c6\">dir \"/home/xiangsl/redis/data\" #数据文件目录</p>\n<p id=\"u61d93c49\">cluster-enabled no #非集群模式</p>\n<p id=\"u1dabec90\">cluster-config-file nodes-6379.conf #集群配置文件</p>\n<h3 id=\"c5f4a\">主从模式</h3>\n<p id=\"u4467e14d\">bind 0.0.0.0</p>\n<p id=\"ua437cb31\">#主机 IP</p>\n<p id=\"uf2eeaf1c\">protected-mode no</p>\n<p id=\"u8cc0800b\">#保护模式设成 no</p>\n<p id=\"u8b2ab6e3\">port 6379</p>\n<p id=\"u95ba036e\">#Redis 端口</p>\n<p id=\"u7fda78ac\">pidfile \"/home/xiangsl/redis/run/redis_6379.pid\"</p>\n<p id=\"u2ec9fa65\">#进程文件</p>\n<p id=\"u925cbf34\">logfile \"/home/xiangsl/redis/log/redis_6379.log\"</p>\n<p id=\"ub82a537b\">#日志文件</p>\n<p id=\"ua32d5860\">daemonize yes</p>\n<p id=\"ude72c635\">#守护模式</p>\n<p id=\"ua17ae4fe\">save 3600 1</p>\n<p id=\"ud8dbaf7b\">#rdb 配置</p>\n<p id=\"u103263b0\">save 300 100</p>\n<p id=\"u50557026\">save 60 10000</p>\n<p id=\"u78d46b99\">dbfilename \"dump_6379.rdb\"</p>\n<p id=\"ube7fb969\">#rdb 文件</p>\n<p id=\"uaba03a9b\">appendonly no</p>\n<p id=\"uabc1bc58\">#aof 配置</p>\n<p id=\"uf5d6711d\">appendfilename \"appendonly_6379.aof\"</p>\n<p id=\"u43960965\">#aof 文件</p>\n<p id=\"u9c38abb2\">appenddirname \"appendonlydir_6379\"</p>\n<p id=\"u98dbd670\">#aof 文件夹</p>\n<p id=\"u48b0d97c\">dir \"/home/xiangsl/redis/data\"</p>\n<p id=\"u33bee97a\">#数据文件目录</p>\n<p id=\"u831cc0ea\">cluster-enabled no</p>\n<p id=\"u0bfc3594\">#非集群模式</p>\n<p id=\"u840d686e\">cluster-config-file nodes-6379.conf</p>\n<p id=\"u1ca523e0\">#集群配置文件</p>\n<p id=\"u51e6b58e\">replicaof 192.168.128.167 6378</p>\n<p id=\"u6ee6b1bb\">#从节点需要配置，主节点不需要配置</p>\n<h3 id=\"ndK6h\">集群模式</h3>\n<p id=\"ub1740fc8\">bind 0.0.0.0</p>\n<p id=\"u0227974b\">#主机 IP</p>\n<p id=\"u6f66aea2\">protected-mode no</p>\n<p id=\"u2c4b4229\">#保护模式设成 no</p>\n<p id=\"ua97f5cd0\">port 6379</p>\n<p id=\"u6187ead3\">#Redis 端口</p>\n<p id=\"u2503831f\">pidfile \"/home/xiangsl/redis/run/redis_6379.pid\"</p>\n<p id=\"u3794ca1b\">#进程文件</p>\n<p id=\"u1e120975\">logfile \"/home/xiangsl/redis/log/redis_6379.log\"</p>\n<p id=\"u06c4bfcd\">#日志文件</p>\n<p id=\"u5016ad0d\">daemonize yes</p>\n<p id=\"ue0bb3f81\">#守护模式</p>\n<p id=\"ua78961a2\">save 3600 1</p>\n<p id=\"u83b95944\">#rdb 配置</p>\n<p id=\"uc7f93ea0\">save 300 100</p>\n<p id=\"u631df7df\">save 60 10000</p>\n<p id=\"u561d3bfc\">dbfilename \"dump_6379.rdb\"</p>\n<p id=\"udfaeefaf\">#rdb 文件</p>\n<p id=\"ue95d6a4e\">appendonly no</p>\n<p id=\"u3270f596\">#aof 配置</p>\n<p id=\"u2044bc48\">appendfilename \"appendonly_6379.aof\"</p>\n<p id=\"u916f16f2\">#aof 文件</p>\n<p id=\"u303d9af2\">appenddirname \"appendonlydir_6379\"</p>\n<p id=\"u58ef5996\">#aof 文件夹</p>\n<p id=\"uc6970320\">dir \"/home/xiangsl/redis/data\"</p>\n<p id=\"u0b7b01e5\">#数据文件目录</p>\n<p id=\"u12c8eb4f\">cluster-enabled yes</p>\n<p id=\"ucff5e4fe\">#非集群模式</p>\n<p id=\"udb12593a\">cluster-config-file nodes-6379.conf</p>\n<p id=\"u5403d463\">#集群配置文件</p>\n<p id=\"ua57a4857\">#replicaof</p>\n<p id=\"u1790e4dd\">#集群模式下不需要配置</p>\n<h2 id=\"PV0wh\">通用配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\9329d3e7da1739b368fc80eacf2c8c7e.png\"/></p>\n<h2 id=\"ni09D\">快照配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\c224b904416fcf7c574e19f38248d927.png\"/></p>\n<p id=\"u5f20be10\"></p>\n<h2 id=\"asWEU\">同步配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\957f8c44e2758d42157e8e8faf320625.png\"/></p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\e76dd3675614b01a24e5651d2aa99328.png\"/></p>\n<h2 id=\"MBg97\">内存配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\a4fa3bd1cf445b84734953765410ec0c.png\"/></p>\n<p id=\"u612d2cf0\"></p>\n<h2 id=\"zW1un\">线程配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\76fd23a544eca8e5ca823bac325bf0fe.png\"/></p>\n<p id=\"uf1e03a96\"></p>\n<h2 id=\"R4f32\">AOF配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\238c2910fa1b43ce9e3362fbd88e1246.png\"/></p>\n<h2 id=\"SNvKZ\">Cluster 配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\a0aa84459974b578592aefad5f1c8432.png\"/></p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\e1a8c5bb941212a55c4644656a28a793.png\"/></p>\n<h2 id=\"LukPy\">慢监控配置</h2>\n<h3 id=\"qGkEz\">慢监控配置</h3>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\d8bc69f6b694395ed7c3d9facac66873.png\"/></p>\n<h3 id=\"WQEKo\">慢日志监控</h3>\n<p id=\"u28dc5bd6\">1. 启用慢日志</p>\n<p id=\"ub897ea5b\">CONFIG SET slowlog-log-slower-than 100</p>\n<p id=\"u5a9b489d\">单位：微秒（注意不是毫秒），100 表示一百微秒，表示执行时长超过 100 微秒的命令才会被记录下来。如果值为负数则表示关闭记录慢日志，如</p>\n<p id=\"u7ca9252d\">果值为 0 表示记录所有命令的慢日志</p>\n<p id=\"uf7d24fc5\">2. 设置记录的慢日志数量，下面表示记录最近 10 条慢日志</p>\n<p id=\"u18bbfa41\">CONFIG SET slowlog-max-len 10</p>\n<p id=\"u70c321ef\">3. 查询慢日志</p>\n<p id=\"u36d889d6\">SLOWLOG GET</p>\n<p id=\"u3214d362\">127.0.0.1:6379&gt; SLOWLOG get 3</p>\n<p id=\"u77c8c71d\">1) 1) (integer) 26</p>\n<p id=\"uaa0c118d\">#第慢日志序号</p>\n<p id=\"u0b8ed410\">2) (integer) 1655574585</p>\n<p id=\"uc828ee3e\">#慢日志时间戳</p>\n<p id=\"ud53ad5c1\">3) (integer) 20</p>\n<p id=\"u13d64632\">#慢日志耗时(微秒)</p>\n<p id=\"udf502790\">4) 1) \"set\"</p>\n<p id=\"ud730b36f\">2) \"a\"</p>\n<p id=\"u073b9225\">3) \"11111111111111111111111111111111111111111111111111111111124124124\"</p>\n<p id=\"ucd6afa7c\">5) \"127.0.0.1:42352\"</p>\n<p id=\"u8afa0311\">6) \"\"</p>\n<p id=\"u16485aa1\">4. 不带参数返回所有的（配置 slowlog-max-len 决定）慢日志，可指定参数只返回最新的 N 条慢日志，如最新的 10 条：</p>\n<p id=\"u6d3d8c09\">SLOWLOG GET 10</p>\n<p id=\"u5ddcba6a\">5. 查询当前慢日志条数</p>\n<p id=\"u029fd5c5\">SLOWLOG LEN</p>\n<h3 id=\"YUVSr\">实时延迟监控</h3>\n<p id=\"ufc8df623\">Redis 中提供了一个特殊模式来监控命令延迟，即“latency-monitor-threshold”指令，该指令设置了以毫秒为单位的限制，超过该限制的所有或部分命令及 Redis 示例的活动均会被记录下来。该指令默认为 0，不自动监控</p>\n<p id=\"u10e6d9fb\">通过 latency latest 命令我们可以查看到事件名、最近延迟的 Unix 时间戳、最近的延迟、最大延迟等，我们可以通过 debug 来人为制造一些慢命 令来进行测试</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\c68f0f1a3a8b5231a2d42d436aa9f327.png\"/></p>\n<h3 id=\"Ax5SD\">查看延迟统计</h3>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\bf4c2151e6bbb3c4d261738cbe594529.png\"/></p>\n<p id=\"u011adc07\"></p>\n<h2 id=\"xCpxY\">事件通信</h2>\n<h3 id=\"RfVGt\">事件类型说明</h3>\n<p id=\"uf9f22493\">Redis 的数据库在发生变化时，能够将这些变化通过配置方式产生通知，进而辅助我们的业务程序处理</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\d4c6e365f1375d2054e37c7af255ef27.png\"/></p>\n<h2 id=\"i3QZY\">数据结构配置</h2>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\336af674a308817e25738d0a4a5084b9.png\"/></p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\c30308480d4766f95626f3ccfdec808b.png\"/></p>\n</div>\n</div>", "first_tag": "Others", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2022-09-05 19:37:27", "summary": "目录最小化配置单点模式主从模式集群模式通用配置快照配置同步配置内存配置线程配置配置配置慢监控配置慢监控配置慢日志监控实时延迟监控查看延迟统计事件通信事件类型说明数据结构配置最小化配置单点模式主机保护模"}