{"blogid": "125701980", "writerAge": "码龄3年", "writerBlogNum": "51", "writerCollect": "71", "writerComment": "29", "writerFan": "782", "writerGrade": "3级", "writerIntegral": "623", "writerName": "姜小孩.", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_125701980.jpg", "writerRankTotal": "37630", "writerRankWeekly": "47218", "writerThumb": "84", "writerVisitNum": "56032", "blog_read_count": "1114", "blog_time": "已于 2022-07-10 08:49:48 修改", "blog_title": "2022蓝帽杯wp", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_1-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_1\">手机取证_1</a></p>\n<p id=\"%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_2-toc\" style=\"margin-left:0px;\"><a href=\"#%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_2\">手机取证_2</a></p>\n<p id=\"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_1-toc\" style=\"margin-left:0px;\"><a href=\"#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_1\">计算机取证_1</a></p>\n<p id=\"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_2-toc\" style=\"margin-left:0px;\"><a href=\"#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_2\">计算机取证_2</a></p>\n<p id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_1-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_1\">程序分析_1</a></p>\n<p id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_2-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_2\">程序分析_2</a></p>\n<p id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_3-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_3\">程序分析_3</a></p>\n<p id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_4-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_4\">程序分析_4</a></p>\n<p id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_1-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_1\">网站取证_1</a></p>\n<p id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_2-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_2\">网站取证_2</a></p>\n<p id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_3-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_3\">网站取证_3</a></p>\n<p id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_4-toc\" style=\"margin-left:0px;\"><a href=\"#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_4\">网站取证_4</a></p>\n<p id=\"domainhacker-toc\" style=\"margin-left:0px;\"><a href=\"#domainhacker\">domainhacker</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<p>这是这次比赛拿下的题，队名拆东墙砸西墙</p>\n<h1 id=\"%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_1\"><strong>手机取证_1</strong></h1>\n<p>通过模糊搜索，搜索图片前面的字符：627604C2</p>\n<p>找到图片，下载，查看其分辨率为360x360</p>\n<p></p>\n<h1 id=\"%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81_2\"><strong>手机取证_2</strong></h1>\n<p>通过模糊查询字符 '姜总'， 找到在qq中的聊天记录</p>\n<p>其中提到明天有个快递抵达，讲述了单号</p>\n<h1 id=\"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_1\">计算机取证_1</h1>\n<p>获取内存文件的系统版本</p>\n<pre><code>H:\\volatility\\VolatilityWorkbench2&gt;volatility.exe -f\nH:\\计算机取证\\1.dmp imageinfo</code></pre>\n<p>获取用户的hash值</p>\n<pre><code>\"H:\\volatility\\VolatilityWorkbench2\\volatility.exe\" -plugins=\"H:\\volatility\\VolatilityWorkbench2\\profiles \" hashdump --filename=\"H:\\取证\\1.dmp\" -- profile=Win7SP0x64 --kdbg=0xf80003ffa0a0</code></pre>\n<p>然后md5解密一下</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\21c4d9535e0e359a8857ac758daaf336.png\"/></p>\n<h1 id=\"%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%96%E8%AF%81_2\">计算机取证_2</h1>\n<p>先列出所有进程</p>\n<pre><code>\"H:\\volatility\\VolatilityWorkbench2\\volatility.exe\" --plugins=\"H:\\volatility\\VolatilityWorkbench2\\profiles \" pslist --filename=\"H:\\取证\\1.dmp\" -- profile=Win7SP0x64 --kdbg=0xf80003ffa0a0</code></pre>\n<p>发现是MagnetRAMCaptu进程，进程号为2192</p>\n<h1 id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_1\"><strong>程序分析_1</strong></h1>\n<p>通过adb命令行查询第三方应用</p>\n<pre><code>adb shell pm list packages -3</code></pre>\n<p>发现exec程序的包名</p>\n<p></p>\n<h1 id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_2\"><strong>程序分析_2</strong></h1>\n<p>打开androidkiller，通过反汇编apk程序，其上写有包名和入口</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\0b411a389d08203fab4a721ba412dd3c.png\"/></p>\n<p></p>\n<h1 id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_3\"><strong>程序分析_3</strong></h1>\n<p>打开jadx，阅读，找到解密方法，其中存在密文</p>\n<pre><code>aHR0cHM6Ly9hbnNqay5lY3hlaW8ueHl6</code></pre>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\a00c37572b714076f7f9e8bea43c810a.png\"/></p>\n<h1 id=\"%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90_4\">程序分析_4</h1>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\0ce17285bfab1e28a56479037645143a.png\"/></p>\n<p>因为要安全检测，所以尝试在文件中搜索安全两个字</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\27dfd330634b11b3c9e9509497efccb8.png\"/></p>\n<p>审了一下发现有两个疑似安全检测的字符串，跟进字符串发现它们所在H类</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\ddf5dcaaf3e26cf742f2c070d21f6daa.png\"/></p>\n<p>继续分析发现H类拥有A类接口</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\0b648692387f5145cd98d862a0d85731.png\"/></p>\n<p>根据A类参数名猜测A类是安全检测的类，尝试提交，发现正确哈哈哈</p>\n<h1 id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_1\">网站取证_1</h1>\n<p>D盾扫一下</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\fd619eb2c65f6f9e6f71ed1ce8dd2061.png\"/></p>\n<h1 id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_2\">网站取证_2</h1>\n<p>tp框架数据库连接在database.php</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\9d3732807f9df57b978884aa32e57829.png\"/></p>\n<p>进入函数echo一下</p>\n<h1 id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_3\">网站取证_3</h1>\n<p>抱着侥幸的心态搜索了一下encrypt，没想到搜到了关于money的！</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\81a8805da69e9f518ef15ed2cab162cb.png\"/></p>\n<p>仔细看一下发现是对插入数据库的金额进行加密的！跟进！</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\a81496121db33a853bb181ad9c862fa9.png\"/></p>\n<p>跟进salt的定义发现这个值就是salt！</p>\n<h1 id=\"%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81_4\">网站取证_4</h1>\n<p>一开始缺少对数据库分析，所以导致在数据库导入处有很大问题，后来才发现这是个postgresql。。。</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\110f9f2631ec9280715c9a0e11bf0b13.png\"/></p>\n<p>观察一下，</p>\n<blockquote>\n<p>info_bargain是每日的RMB汇率</p>\n<p>tab_channel_order_list是所有的订单</p>\n</blockquote>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\daadcf4443ef16ece422e4114b0c02d8.png\"/></p>\n<p>tab_user中我们可以看到张宝的用户ID为3，王子豪的用户ID为5</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\f9c743641e863a61e402f8445ffc4a19.png\"/></p>\n<p>导出Excel数据表，然后货币依次解密，源码中有解密函数，写个脚本吧</p>\n<pre><code class=\"language-php\">&lt;?php\n​\nfunction decrypt($data, $key = 'jyzg123456')\n{\n    $key = md5($key);\n    $y = 0;\n    $data = base64_decode($data);\n    $length = mb_strlen($data);\n    $len = mb_strlen($key);\n    $char = '';\n    $str = '';\n    for ($i = 0; $i &lt; $length; $i++) {\n        if ($y == $len) {\n            $y = 0;\n        }\n        $char .= mb_substr($key, $y, 1);\n        $y++;\n    }\n    for ($i = 0; $i &lt; $length; $i++) {\n        if (ord(mb_substr($data, $i, 1)) &lt; ord(mb_substr($char, $i, 1))) {\n            $str .= chr((ord(mb_substr($data, $i, 1)) + 256) - ord(mb_substr($char, $i, 1)));\n        } else {\n            $str .= chr(ord(mb_substr($data, $i, 1)) - ord(mb_substr($char, $i, 1)));\n        }\n    }\n    return $str;\n}\n// echo decrypt(\"mZVymm9t\");\nob_start();\n​\n​\n$file = fopen(\"money.txt\",\"r\");\n$new_file = fopen(\"newmoney.txt\",\"a\");\nwhile(!feof($file))\n{\n    $encoded = fgets($file);\n    $decoded = decrypt($encoded);\n    echo $decoded.\"\\n\";\n    $string = ob_get_contents();\n    file_put_contents('newmoney.txt', $string);\n​\n}\nob_flush();\nflush();\nfclose($file);</code></pre>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\2fbfd0f3662204ddb6841359552f06e9.png\"/></p>\n<p>跑出结果放入excel</p>\n<p>然后再去navicat拿到税率</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\be36a35c5d93e9b8289310e1d1b2289b.png\"/></p>\n<p>导出然后填入excel表格</p>\n<p>求和得到15758353.76</p>\n<h1 id=\"domainhacker\"><strong>domainhacker</strong></h1>\n<p>大致分析了一下看到机器hash值被压缩进了1.rar里面</p>\n<p>文件导出后看到</p>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\92e7cfd014d5afa1f237b8b7b332c937.png\"/></p>\n<p>大致浏览发现就1.rar比较特殊，还有密码，丢入密码爆破就去继续看流量了</p>\n<p>找到密码</p>\n<p><img alt=\"\" height=\"884\" src=\"..\\..\\static\\image\\c78188b534f44ecc8e7bde2ccf47a18f.png\" width=\"1200\"/></p>\n<p></p>\n<p>base64解码</p>\n<pre><code>Y2QgL2QgImM6XFxXaW5kb3dzXFxUZW1wIiZyYXIuZXhlIGEgLVBTZWNyZXRzUGFzc3cwcmRzIDEucmFyIDEudHh0JmVjaG8gZWZhOTIzYmE1MDQmY2QmZWNobyAxYTRiZTg4MTVlZjg=</code></pre>\n<p class=\"img-center\"><img alt=\"\" src=\"..\\..\\static\\image\\158380300c945c947e78dd9b089f982e.png\"/></p>\n<p>拿下</p>\n<p></p>\n</div>\n</div>", "first_tag": "PHP", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 1, "time": "2022-07-10 08:49:48", "summary": "目录手机取证手机取证计算机取证计算机取证程序分析程序分析程序分析程序分析网站取证网站取证网站取证网站取证这是这次比赛拿下的题，队名拆东墙砸西墙手机取证通过模糊搜索，搜索图片前面的字符：找到图片，下载，"}