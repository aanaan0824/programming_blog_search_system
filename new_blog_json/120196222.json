{"blogid": "120196222", "writerAge": "码龄4年", "writerBlogNum": "64", "writerCollect": "298", "writerComment": "41", "writerFan": "26", "writerGrade": "4级", "writerIntegral": "1370", "writerName": "音尘啊", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_120196222.jpg", "writerRankTotal": "77814", "writerRankWeekly": "65430", "writerThumb": "89", "writerVisitNum": "146066", "blog_read_count": "6300", "blog_time": "于 2021-09-09 13:31:07 发布", "blog_title": "C# 超详细的WebService创建、发布与调用（VS2019）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"1_0\"></a>1.编写接口</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0c0e3b2d45de4e0b9478cf6dee5c9ec4.png\"/><br/> 这里我选择的是 “<strong>ASP.NET Web应用程序(.NET Framework</strong>)”。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\993f41c277aa44f58c7ce05bd5b0281a.png\"/><br/> 填写好项目名称、选择项目位置以及所使用的框架，这里我用的是“<strong>.NET Framework 4</strong>”框架，然后点击创建。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\fc91145a35564389b0021750ea469d3b.png\"/><br/> 继续点击创建。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4b19d1e616844b508ff24602b00bc43b.png\"/><br/> 打开解决方案资源管理器-右键创建的Web项目-添加-新建项<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b0cba511f75b473585a3e0e0b3554507.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\51bf9d389b554267b54cd88ff3e06ac3.png\"/><br/> 添加 <strong>web 服务(AMSX)</strong>。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6b4b92deffdc456a97c125e0addd2617.png\"/><br/> 在这里除了默认的一个方法，自己又写了两个方法。</p>\n<pre><code class=\"prism language-csharp\">        <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">WebMethod</span></span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> <span class=\"token function\">GetInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> a <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> b <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">WebMethod</span></span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">GetNameByStr</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> name<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">return</span> <span class=\"token string\">\"你好：\"</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f142ca002efa4186b035d738087b5545.png\"/><br/> 然后我们启动项目。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\986e0b7dbc5e44ce829f42979f5f20b1.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\36d14b715930439fba3f0e500d59c932.png\"/><br/> 在上面我们可以看到我们所写的三个方法，我选择其中一个点进去。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\43c8f69c7bc7418da32915fa3d7b4849.png\"/></p>\n<p>点击调用后我们可以看到输出了“你好：张三”。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\182dcb5f730a46d3bd5dcbf117a97960.png\"/><br/> 其他两个方法也是一样的，点击调用都能看到我们所写的返回结果，至此说明我们所写的没有问题，接下来我们把所写的发布到IIS上面去。</p>\n<h2><a id=\"2_44\"></a>2.发布接口</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\0f433cf652b948b38b230f607115ca80.png\"/><br/> 选择<strong>文件夹</strong>，点击下一步。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\b66c607dd9bf48f58179f7be5067f2bf.png\"/><br/> 选择发布的文件夹位置，这里可以自己选择，但是一定要记住你选择的位置，这里我就采用默认的发布位置，即在当前项目的 bin\\app.publish 文件夹下。点击完成<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a7d99c2ef0ea4fec93f919a7b9bcb577.png\"/><br/> 然后我们点击发布即可。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ca09c1f253454b3f8f9d6749fa25af9c.png\"/><br/> 注：这里有个小细节，当我们更新Web服务里面的内容的时候，再次发布的时候我们需要注意。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\ec99fa9eddd24287b0e39a25430faa51.png\"/><br/> 打开项目所在的位置，这里面的内容即为我们所发布的内容。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4bcea7aa254342dea48fc906a8ca70cf.png\"/><br/> 然后我们打开IIS管理器（不会打开IIS的请自行百度，这里就不做教学了）。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a59b5ff302be41eebfc39508411b5e92.png\"/><br/> 右键网站选择添加网站。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\16a139089cac440da9a0ddd3cc644720.png\"/><br/> 对添加的网站进行相关设置后点击确定。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\cf6d14d41f644093acbedee52f130f93.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2b699bf5d22648439e5301154e03228b.png\"/><br/> 这个时候我们发现打开的网站出现了403.14错误。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\aadea831f3284bf39cfe799906e0b04e.png\"/><br/> 我们只需要：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e68373603dca41d2b8a8cd4897f1dccb.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1b457220855f4ec5b3ebc5f0b578ec6f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\a95d4043dd294420bc323d1ae7fe40a1.png\"/><br/> 再次浏览即可正常访问。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\7a9bcb24b2a444b88e9ac517dc469bd4.png\"/><br/> 点击<strong>WebService1.asmx</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\6e1e264fb93c4ffab7722ee177c7e0d1.png\"/><br/> 能正常打开，并且能正常调用方法说明发布成功。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\16d3547e5776434f83d258f609414b75.png\"/><br/> 至此，我们发布网站的步骤进行完毕，接来了我们将在程序中调用我们说发布的方法并获取到相应的值。</p>\n<h2><a id=\"3_78\"></a>3.调用接口</h2>\n<p>右键项目-添加-服务引用<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4a410b80b1d54933a5678482fe1ec31c.png\"/><br/> 打开刚刚启动的网站，复制这个地址粘贴到服务引用中。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\3dc22979cf3941b4a4545e6d7d344be7.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9411e2893a6345b4a88a4ffe3e0d6fac.png\"/><br/> 接下来点击<strong>高级</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\1db0cfd17b624c5599746d721059a716.png\"/><br/> 添加Web 引用(W)-在打开的界面中的URL中输入刚刚复制的网址-点击蓝色箭头-添加引用®<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\d43f982c248c4ac9a2bc1fd4e00581d0.png\"/><br/> 即可在解决方案资源管理器中看到我们所添加的服务引用<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\f2eb7a0e798d49eabfddef82171e9d38.png\"/><br/> 接下来我们简单的添加一个控制应用台项目来实现方法的调用。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\34a06dc05d574bcfac889728a84a63e0.png\"/><br/> 点击下一步<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\23df008652e5407e947e5deba54522a9.png\"/></p>\n<p>选择好位置，点击创建。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\df2128a7b686415eaacddfc93cebf310.png\"/></p>\n<p>控制台应用程序创建完毕。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5f9bbe3bc42648fab0249f7a5c5358e9.png\"/><br/> 右键控制图应用程序中的引用<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\455f80670b6543398f0c3db455e2b86e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\eacbf48494bb47f28100d680c212ffa4.png\"/><br/> 在再程序中使用引用<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9afd8722d67c47c1a9f12d6bfa8652cb.png\"/><br/> 附上代码</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">WebTest<span class=\"token punctuation\">.</span>WebReference</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">ConsoleWebCall</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">Program</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> args<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">WebService1</span> webService1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">WebService1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> str <span class=\"token operator\">=</span> webService1<span class=\"token punctuation\">.</span><span class=\"token function\">HelloWorld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> str1 <span class=\"token operator\">=</span> webService1<span class=\"token punctuation\">.</span><span class=\"token function\">GetNameByStr</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> webService1<span class=\"token punctuation\">.</span><span class=\"token function\">GetInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            Console<span class=\"token punctuation\">.</span><span class=\"token function\">ReadKey</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<p>最后结果如图所示：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\4228a64f5c7047caa8a6d27aeabb50f7.png\"/><br/> 这样我们就完成了一个web服务的创建、发布、使用。<br/> 如果对你有帮助，请帮忙点个赞。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "C#", "cpp": 0, "csharp": 1, "python": 0, "javascript": 0, "java": 0, "sql": 0, "php": 0, "time": "2021-09-09 13:31:07", "summary": "编写接口在这里插入图片描述这里我选择的是应用程序。在这里插入图片描述填写好项目名称、选择项目位置以及所使用的框架，这里我用的是框架，然后点击创建。在这里插入图片描述继续点击创建。在这里插入图片描述打开"}