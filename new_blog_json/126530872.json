{"blogid": "126530872", "writerAge": "码龄1年", "writerBlogNum": "91", "writerCollect": "6695", "writerComment": "12537", "writerFan": "13068", "writerGrade": "7级", "writerIntegral": "19604", "writerName": "微凉秋意", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126530872.jpg", "writerRankTotal": "415", "writerRankWeekly": "1", "writerThumb": "7500", "writerVisitNum": "121894", "blog_read_count": "758", "blog_time": "于 2022-08-27 12:30:00 发布", "blog_title": "高效掌握JDBC技术（一）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-github-gist\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>✅作者简介：CSDN内容合伙人，喜欢学习后端语言的大学生，同时也是一位新晋万粉博主<br/> ✨个人社区：<a href=\"http://t.csdn.cn/4h8pd\">微凉秋意社区</a><br/> 🔥系列专栏：<a href=\"https://blog.csdn.net/m0_58618795/category_11982885.html?spm=1001.2014.3001.5482\">JDBC技术</a><br/> 📃推荐一款模拟面试、刷题神器👉<a href=\"https://www.nowcoder.com/link/pc_csdncpt_ylqb_c\">注册免费刷题</a></p>\n</blockquote>\n<p>🔥前言</p>\n<blockquote>\n<p>以前学习的数据库连接技术：<code>JDBC</code>，好久不使用都有些遗忘了，所以开了一个专栏来分享有关的知识。我会从基础概念到实战一步一步来，循序渐进的高效的记录复习jdbc知识，打下夯实的基础。如有感兴趣的朋友也可以订阅专栏一同学习进步哦。</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#JDBC_9\">一、JDBC概述</a></li><li><ul><li><a href=\"#1JDBC_15\">1、为什么要学习JDBC？</a></li><li><a href=\"#2JDBCAPI_21\">2、JDBC涉及到的API</a></li><li><a href=\"#3JDBC_29\">3、JDBC的特点</a></li></ul>\n</li><li><a href=\"#JDBC_34\">二、JDBC的编码步骤</a></li><li><ul><li><a href=\"#1navicat_36\">1、navicat操作数据库的步骤</a></li><li><a href=\"#2JDBC_45\">2、JDBC操作数据库的六大步</a></li><li><a href=\"#3JDBC_54\">3、JDBC的步骤实现</a></li></ul>\n</li><li><a href=\"#__98\">三、 结果集的处理</a></li><li><a href=\"#_140\">四、数据绑定</a></li><li><ul><li><a href=\"#1_144\">1、字符串拼接</a></li><li><a href=\"#2__193\">2、 ?占位符</a></li><li><ul><li><a href=\"#_263\">两种数据绑定的区别</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_272\">五、面对异常</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"JDBC_9\"></a>一、JDBC概述</h1>\n<p><strong>JDBC：Java数据库连接技术</strong></p>\n<ul><li>通过Java后台代码连接数据库对数据库内容进行增删改查</li></ul>\n<h2><a id=\"1JDBC_15\"></a>1、为什么要学习JDBC？</h2>\n<p>navicat也可以连接数据库对数据进行增删改查，但是并不能定制化用户数据，所以并不完全使用实战开发</p>\n<p>但是<strong>JDBC可以通过后台的其他代码完整用户数据的定制化</strong></p>\n<h2><a id=\"2JDBCAPI_21\"></a>2、JDBC涉及到的API</h2>\n<ol><li><code>Driver</code>：驱动接口 定义了Java如何与数据库建立连接</li><li><code>DriverManager</code> 驱动管理工具类 管理驱动，可以用来获取数据库连接</li><li><code>Connection</code> 连接接口 代表了Java和数据库的联系</li><li><code>PreparedStatement</code> 发送SQL的工具接口 用来像数据库发送一条执行SQL</li><li><code>Resultset</code> 结果集接口 用来接受查询SQL的执行结果</li></ol>\n<h2><a id=\"3JDBC_29\"></a>3、JDBC的特点</h2>\n<ul><li>它是一个规范，不是一个实现 \n  <ul><li>JDBC中只有接口，并没有提供实现</li></ul> </li></ul>\n<h1><a id=\"JDBC_34\"></a>二、JDBC的编码步骤</h1>\n<h2><a id=\"1navicat_36\"></a>1、navicat操作数据库的步骤</h2>\n<ol><li>加载和启动软件</li><li>建立连接</li><li>打开新建查询，准备书写sql</li><li>书写SQL并执行</li><li>查看执行结果</li><li>关闭软件窗口</li></ol>\n<h2><a id=\"2JDBC_45\"></a>2、JDBC操作数据库的六大步</h2>\n<ol><li><strong>加载驱动</strong></li><li><strong>获取连接</strong></li><li><strong>书写SQL并准备发送SQL的工具</strong></li><li><strong>发送SQL</strong></li><li><strong>处理结果集（只限查询）</strong></li><li><strong>释放相关资源</strong></li></ol>\n<h2><a id=\"3JDBC_54\"></a>3、JDBC的步骤实现</h2>\n<ol><li> <p>搭建开发环境</p>\n<ul><li>导入指定jar包 \n    <ol><li>右键项目，新建一个名为lib的文件夹</li><li>将<code>mysql-connector-java-8.0.23.jar</code>复制到文件夹中</li><li>右键jar包，点击<code>add as library</code></li></ol> </li></ul> </li><li> <p>通过代码实现JDBC六大步</p> <pre><code class=\"prism language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JDBCTest</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//这里的抛出的异常应该包含驱动、连接、sql异常等</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span>  <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//1. 加载驱动，必须正确的在lib文件夹下导入jar包</span>\n        <span class=\"token class-name\">Class</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.mysql.cj.jdbc.Driver\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//2. 获取连接</span>\n        <span class=\"token comment\">//用户名</span>\n        <span class=\"token class-name\">String</span> username <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//密码，是自己数据库的密码，不一定都是root</span>\n        <span class=\"token class-name\">String</span> pwd <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//连接的url，只要修改问号前的数据库名为自己的即可（当前为2109）</span>\n        <span class=\"token class-name\">String</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql://localhost:3306/2109?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token class-name\">DriverManager</span><span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> pwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//3. 准备发送SQL的工具</span>\n        <span class=\"token comment\">//往学生表中添加一条学生信息</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into t_student(stu_name,stu_age,stu_sex,stu_class,stu_place) VALUES('lisi',18,'男','二年级','新乡')\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> ps <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//4. 发送执行SQL</span>\n        <span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> ps<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//执行SQL，增删改返回受影响条数</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>                   <span class=\"token comment\">//实际上n就是navicat里插入时显示的受影响的行数</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//5. 结果集 略，查询操作才会用到</span>\n        <span class=\"token comment\">//6. 释放资源</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\">//先关小的资源</span>\n        conn<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//后关大的资源</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre> </li></ol>\n<h1><a id=\"__98\"></a>三、 结果集的处理</h1>\n<ul><li> <p><strong>ResultSet：结果集</strong></p> </li><li> <p>底层原理：指针操作，类似<code>Iterator</code>迭代器</p> </li><li> <p><code>next()</code>：判断是否存有下一元素</p> </li><li> <p><code>getXxx</code>(int类型的列的顺序，从1开始)：获取某个字段的值</p> </li><li> <p>getXxx(“字段名”)：获取某个字段的值</p>\n<ul><li><code>Xxx</code>：表示字段的数据类型，首字母大写</li><li>指定字段名更常用，更清晰</li></ul> </li></ul>\n<pre><code class=\"prism language-java\">        <span class=\"token comment\">//前面两步的数据库的加载驱动以及连接省略</span>\n        <span class=\"token comment\">//3. 准备发送sql</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from t_student\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">PreparedStatement</span> ps <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//4. 发送sql并执行</span>\n        <span class=\"token class-name\">ResultSet</span> rs<span class=\"token operator\">=</span>ps<span class=\"token punctuation\">.</span><span class=\"token function\">executeQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//5. 处理结果集</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>rs<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token comment\">//当拥有下一元素时，才进入循环</span>\n            <span class=\"token comment\">//获取字段的值</span>\n            <span class=\"token keyword\">int</span> stuId <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">String</span> stuName <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> stuAge <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">String</span> stuSex <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stu_sex\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">String</span> stuClass <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stu_class\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">String</span> stuplace <span class=\"token operator\">=</span> rs<span class=\"token punctuation\">.</span><span class=\"token function\">getString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stu_place\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//输出查看</span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>stuId<span class=\"token operator\">+</span><span class=\"token string\">\" \"</span><span class=\"token operator\">+</span>stuName<span class=\"token operator\">+</span><span class=\"token string\">\" \"</span><span class=\"token operator\">+</span>stuAge<span class=\"token operator\">+</span><span class=\"token string\">\" \"</span><span class=\"token operator\">+</span>stuSex<span class=\"token operator\">+</span><span class=\"token string\">\" \"</span><span class=\"token operator\">+</span>stuClass<span class=\"token operator\">+</span><span class=\"token string\">\" \"</span><span class=\"token operator\">+</span>stuplace<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//6. 释放资源   由于rs是在ps的基础上存在的，因此先关rs的资源</span>\n        rs<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      \n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        conn<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n</code></pre>\n<h1><a id=\"_140\"></a>四、数据绑定</h1>\n<ul><li>将用户输入的数据，绑定到SQL中</li></ul>\n<h2><a id=\"1_144\"></a>1、字符串拼接</h2>\n<ol><li>在需要使用用户数据的位置，通过对应变量替换</li><li>如果为非字符串类型：<code>\"+变量名+\"</code></li><li>如果为字符串类型(包含日期及枚举)：<code>' \"+变量名+\" '</code></li></ol>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>bz<span class=\"token punctuation\">.</span>test</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JDBCTest</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span>  <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//1. 加载驱动</span>\n        <span class=\"token comment\">//2. 获取连接</span>\n        <span class=\"token comment\">//3. 准备发送SQL的工具，前三步省略</span>\n        <span class=\"token comment\">//往学生表中添加一条学生信息</span>\n        \n        <span class=\"token comment\">//接收用户信息</span>\n        <span class=\"token class-name\">Scanner</span> sc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的姓名：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> name<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的年龄：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> age<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的性别(男/女)：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> sex<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的年级：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> clazz<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的地区：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> place<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//根据用户填写的信息，书写SQL</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into t_student(stu_name,stu_age,stu_sex,stu_class,stu_place) VALUES('\"</span><span class=\"token operator\">+</span>name<span class=\"token operator\">+</span><span class=\"token string\">\"',\"</span><span class=\"token operator\">+</span>age<span class=\"token operator\">+</span><span class=\"token string\">\",'\"</span><span class=\"token operator\">+</span>sex<span class=\"token operator\">+</span><span class=\"token string\">\"','\"</span><span class=\"token operator\">+</span>clazz<span class=\"token operator\">+</span><span class=\"token string\">\"','\"</span><span class=\"token operator\">+</span>place<span class=\"token operator\">+</span><span class=\"token string\">\"')\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//输出sql</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">PreparedStatement</span> ps <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//4. 发送执行SQL</span>\n        <span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> ps<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//执行SQL，增删改返回受影响条数</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//5. 结果集  略</span>\n        <span class=\"token comment\">//6. 释放资源  略</span>\n        \n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"2__193\"></a>2、 ?占位符</h2>\n<ul><li>是JDBC中的一种特殊语法，作用为进行数据绑定</li><li>使用方法： \n  <ol><li>在需要使用用户数据的位置，通过<code>?</code>代替（占位）</li><li>在发送SQL之前，给占位符依次赋值</li><li><strong>setXxx(占位符的序号(从1开始)，占位符对应的值)</strong></li></ol> </li></ul>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>bz<span class=\"token punctuation\">.</span>test</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Connection</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DriverManager</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PreparedStatement</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JDBCTest</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span>  <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//1. 加载驱动</span>\n        <span class=\"token class-name\">Class</span><span class=\"token punctuation\">.</span><span class=\"token function\">forName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.mysql.cj.jdbc.Driver\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//2. 获取连接</span>\n        <span class=\"token comment\">//用户名</span>\n        <span class=\"token class-name\">String</span> username <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//密码</span>\n        <span class=\"token class-name\">String</span> pwd <span class=\"token operator\">=</span> <span class=\"token string\">\"root\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//连接的url</span>\n        <span class=\"token class-name\">String</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"jdbc:mysql://localhost:3306/2109?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Connection</span> conn <span class=\"token operator\">=</span> <span class=\"token class-name\">DriverManager</span><span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> pwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//3. 准备发送SQL的工具</span>\n        <span class=\"token comment\">//往学生表中添加一条学生信息</span>\n        <span class=\"token comment\">//接收用户信息</span>\n        <span class=\"token class-name\">Scanner</span> sc <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的姓名：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> name<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的年龄：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> age<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的性别(男/女)：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> sex<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的年级：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> clazz<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入你的地区：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> place<span class=\"token operator\">=</span>sc<span class=\"token punctuation\">.</span><span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//根据用户填写的信息，书写SQL</span>\n        <span class=\"token class-name\">String</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"insert into t_student(stu_name,stu_age,stu_sex,stu_class,stu_place) VALUES(?,?,?,?,?)\"</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token class-name\">PreparedStatement</span> ps <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">prepareStatement</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//给占位符赋值</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">setInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>sex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span>clazz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">setString</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span>place<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">//4. 发送执行SQL</span>\n        <span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> ps<span class=\"token punctuation\">.</span><span class=\"token function\">executeUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//执行SQL，增删改返回受影响条数</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>n<span class=\"token operator\">&gt;</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token keyword\">else</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"添加失败\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//5. 结果集  略</span>\n        <span class=\"token comment\">//6. 释放资源</span>\n        ps<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        conn<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h3><a id=\"_263\"></a>两种数据绑定的区别</h3>\n<ul><li>SQL注入攻击：利用填写数据巧妙使SQL语句中的某些判断条件失效</li></ul>\n<table><thead><tr><th>方式</th><th>特点</th><th>使用场景</th><th>实战建议</th></tr></thead><tbody><tr><td>字符串拼接</td><td>可能被SQL注入攻击攻击</td><td>可以拼接表名、字段名、关键字</td><td>需要拼接关键字时使用，如：排序</td></tr><tr><td>？占位符</td><td>可以防止SQL注入攻击</td><td>不能对表名、字段名、关键字占位</td><td>通常使用都是占位符</td></tr></tbody></table>\n<h1><a id=\"_272\"></a>五、面对异常</h1>\n<p><em>可能出现的异常：</em></p>\n<ol><li>类加载问题：Driver的路径不对</li><li>数据库、用户名、密码不对</li><li>sql语法错误：在sql下方打印该语句，查看语法问题</li><li>数据绑定不对：字符串拼接错误、？占位符赋值有误</li><li>获取结果集字段值时有误：检查字段顺序、字段名、数据类型</li></ol>\n<p><strong>解决方案1：</strong></p>\n<ol start=\"6\"><li>先查看控制台的异常日志，锁定实际抛出异常的代码位置</li><li>结合报错的详细信息，分析出错原因</li><li>复杂问题，尝试百度</li></ol>\n<p><strong>解决方案2：</strong></p>\n<ol><li>通过输出语句的位置，锁定实际抛出异常的代码位置</li><li>分析出错原因</li></ol>\n<p><strong>实战建议：</strong></p>\n<p><em>方案1+方案2</em></p>\n<ol><li>观察异常日志，锁定出错位置</li><li>结合报错的详细信息+输出语句，确定出错的原因</li><li>复杂问题，尝试百度</li></ol>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 1, "sql": 1, "php": 0, "time": "2022-08-27 12:30:00", "summary": "作者简介：内容合伙人，喜欢学习后端语言的大学生，同时也是一位新晋万粉博主个人社区：微凉秋意社区系列专栏：技术推荐一款模拟面试、刷题神器注册免费刷题前言以前学习的数据库连接技术：，好久不使用都有些遗忘了"}