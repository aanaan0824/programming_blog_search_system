{"blogid": "126714908", "writerAge": "码龄7年", "writerBlogNum": "60", "writerCollect": "600", "writerComment": "677", "writerFan": "1270", "writerGrade": "5级", "writerIntegral": "2401", "writerName": "Pushkin.", "writerProfileAdress": "..\\..\\static\\writer_image\\profile_126714908.jpg", "writerRankTotal": "9234", "writerRankWeekly": "148", "writerThumb": "567", "writerVisitNum": "72541", "blog_read_count": "160", "blog_time": "已于 2022-09-05 23:38:12 修改", "blog_title": "【SQL屠夫系列】- 高频面试之SQL计算用户留存率", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"../../static/bootstrap/css/csdnstyle.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/eef9e820f4e049e784f5dee7db5dc494.gif#pic_center\"/><br/> </p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_10\">指标背景</a></li><li><a href=\"#_23\">指标计算</a></li><li><a href=\"#_38\">真题</a></li><li><a href=\"#_47\">思路</a></li><li><a href=\"#_59\">开撸</a></li><li><a href=\"#_65\">拓展</a></li></ul>\n</div>\n<p></p>\n<blockquote>\n<p>在如今的程序员面试过程中,考察SQL部分能力,虽不是难点,但几乎是必考.<br/> 为检查思路盲点,避免翻船,各位看官也可以复盘下,如对你有一丝的帮助,欢迎给个赞叭~<br/> ps: 数据开发者，建议可以自己加难度进行考察</p>\n</blockquote>\n<p>难度：中等<br/> 面试频率：超高 （遇到过类似题型3次+）</p>\n<h1><a id=\"_10\"></a>指标背景</h1>\n<p><strong>留存率</strong>是用于反映网站、互联网应用或网络游戏的运营情况的<strong>核心统计指标</strong>，其具体含义为在统计周期（周/月）内，每日活跃用户数在第N日仍启动该App的用户数占比的平均值。其中N通常取2、4、8、15、31，分别对应次日留存率、三日留存率、周留存率、半月留存率和月留存率。</p>\n<p>总之留存指标对于toC的企业是非常重要的指标，很多时间我们验证一些策略，比如推荐系统AB测试时，比的就是不同渠道不同算法策略的留存率，以此验证提升的效果。</p>\n<p>对于toC的企业，数据亦或是大数据相关的面试我认为，熟练手写常用的用户留存率指标SQL还是非常必要的。</p>\n<p>一般企业是以这种留存日历形式进行展示：效果一目了然<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\2bffb2ddb96d46b784929008721db325.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9ed3d1f0af874019aea8245f5cc0a2f0.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\e218faf7be9f4e54a00965fa01febc7a.png\"/></p>\n<h1><a id=\"_23\"></a>指标计算</h1>\n<p>留存率=每日活跃用户数在第N日仍启动该App的用户数占比的平均值 （一般统计周期为周/月）</p>\n<p>比如 1号有100个用户登陆（也可以是注册）了（这100个用户就是1号的活跃用户），到2号的时候又有100个用户登陆了，但这100个用户之中只有20位是昨天登陆的用户，当么2日的留存率就是20/100=20%。</p>\n<p><strong>PS: 其实用新增的注册人数更准确点~~</strong><br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\5cc82294e92645a794c7e0258a765bf5.png\"/></p>\n<p><strong>某企业真实留存报表</strong>（注渠道与具体用户数已隐藏/脱敏）：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\756e5a1836f24ee1aa114860e7e67e73.png\"/></p>\n<h1><a id=\"_38\"></a>真题</h1>\n<p>一般可能就直接给你一个登陆login流水表；就两字段</p>\n<ul><li>用户字段</li><li>登陆时间字段<br/> 让你求N天的留存率，比如计算7天留存。</li></ul>\n<p>简单mock点数据如下：<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\9279ed9bd414412283e6a242331455ab.png\"/></p>\n<h1><a id=\"_47\"></a>思路</h1>\n<p>这种题目首先是要有思路，思路有了代码就出来了</p>\n<ol><li>关联登陆时间比自己user_id A大的自己user_id B，取出对应的登陆时间</li><li>计算A，B登陆时间的差值，得出后续自己登陆时的天数差值</li><li>按1-N日的差值进行count统计</li></ol>\n<p>细节：去重与空值<br/> 见下方代码</p>\n<h1><a id=\"_59\"></a>开撸</h1>\n<p>代码根据思路随意写个，读者可以自行根据需求发挥。<br/> <img alt=\"在这里插入图片描述\" src=\"..\\..\\static\\image\\bedc9679f20344ed804c6abbff78c1db.png\"/></p>\n<h1><a id=\"_65\"></a>拓展</h1>\n<p>你还有更好的解法或者思路吗？</p>\n<hr/>\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/445acf358c1644f989b27f72b82ebca9.gif#pic_center\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>", "first_tag": "SQL", "cpp": 0, "csharp": 0, "python": 0, "javascript": 0, "java": 0, "sql": 1, "php": 0, "time": "2022-09-05 23:38:12", "summary": "在这里插入图片描述文章目录指标背景指标计算真题思路开撸拓展在如今的程序员面试过程中考察部分能力虽不是难点但几乎是必考为检查思路盲点避免翻船各位看官也可以复盘下如对你有一丝的帮助欢迎给个赞叭数据开发者，"}