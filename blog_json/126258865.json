{"blogid": "126258865", "writerAge": "码龄12年", "writerBlogNum": "478", "writerCollect": "5228", "writerComment": "1452", "writerFan": "3089", "writerGrade": "7级", "writerIntegral": "21492", "writerName": "IT技术分享社区", "writerProfileAdress": "writer_image\\profile_126258865.jpg", "writerRankTotal": "384", "writerRankWeekly": "83", "writerThumb": "2226", "writerVisitNum": "3000582", "blog_read_count": "366", "blog_time": "已于 2022-08-12 15:21:18 修改", "blog_title": "C#实战：基于ItextSharp技术标签生成小工具", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<div>\n<div>\n<div>\n<p class=\"img-center\"><img alt=\"\" src=\"image\\2ecae5c0837115a0486d2e0418fc2d22.jpeg\"/></p>\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"1%E3%80%81%E8%BF%90%E8%A1%8C%E4%B8%BB%E7%95%8C%E9%9D%A2-toc\" style=\"margin-left:40px;\"><a href=\"#1%E3%80%81%E8%BF%90%E8%A1%8C%E4%B8%BB%E7%95%8C%E9%9D%A2\">1、运行主界面</a></p>\n<p id=\"2%E3%80%81%E6%A0%87%E7%AD%BE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2-toc\" style=\"margin-left:40px;\"><a href=\"#2%E3%80%81%E6%A0%87%E7%AD%BE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2\">2、标签生成界面</a></p>\n<p id=\"3%E3%80%81%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E7%9A%84%E4%BE%9D%E8%B5%96%E5%8C%85-toc\" style=\"margin-left:40px;\"><a href=\"#3%E3%80%81%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E7%9A%84%E4%BE%9D%E8%B5%96%E5%8C%85\">3、需要引入的依赖包</a></p>\n<p id=\"4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E7%9B%AE%E5%BD%95-toc\" style=\"margin-left:40px;\"><a href=\"#4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E7%9B%AE%E5%BD%95\">4、解决方案目录</a></p>\n<p id=\"5%E3%80%81%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81-toc\" style=\"margin-left:40px;\"><a href=\"#5%E3%80%81%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81\">5、主要代码</a></p>\n<p id=\"1%E3%80%81%E6%96%B0%E5%BB%BAPdfUtils%E5%B7%A5%E5%85%B7%E7%B1%BB-toc\" style=\"margin-left:80px;\"><a href=\"#1%E3%80%81%E6%96%B0%E5%BB%BAPdfUtils%E5%B7%A5%E5%85%B7%E7%B1%BB\">1、新建PdfUtils工具类</a></p>\n<p id=\"2%E3%80%81Form1.cs%20%E7%AA%97%E4%BD%93%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81-toc\" style=\"margin-left:80px;\"><a href=\"#2%E3%80%81Form1.cs%20%E7%AA%97%E4%BD%93%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81\">2、Form1.cs 窗体主要代码</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<p style=\"text-align:left;\"><span style=\"color:#333333;\">今天给大家分享小编基于</span><span style=\"color:#333333;\">ItextSharp制作的一款标签生成小工具，可供大家学习或者二次开发满足实际的需求使用。</span></p>\n<p style=\"text-align:left;\"><span style=\"color:#333333;\">使用技术：C#+ItextSharp+Winfrom+Net4.0</span></p>\n<h2 id=\"1%E3%80%81%E8%BF%90%E8%A1%8C%E4%B8%BB%E7%95%8C%E9%9D%A2\" style=\"text-align:left;\"><span style=\"color:#333333;\">1、运行主界面</span></h2>\n<p><span style=\"color:#333333;\">运行主界面根据窗体输入相应的内容，点击生成pdf按钮会生成对应的pdf文件。</span></p>\n<p class=\"img-center\"><img alt=\"\" src=\"image\\ff7ce19cce30f7597f0259b6bfb637af.png\"/></p>\n<h2 id=\"2%E3%80%81%E6%A0%87%E7%AD%BE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2\" style=\"text-align:left;\"><span style=\"color:#333333;\">2、标签生成界面</span></h2>\n<p><span style=\"color:#333333;\">生成的标签pdf文件效果，直接运行</span></p>\n<h2 id=\"3%E3%80%81%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E7%9A%84%E4%BE%9D%E8%B5%96%E5%8C%85\" style=\"text-align:left;\"><span style=\"color:#333333;\">3、需要引入的依赖包</span></h2>\n<p style=\"text-align:left;\">开发的时候需要导入以下两个包</p>\n<p style=\"text-align:left;\"><span style=\"color:#333333;\">iTextSharp 版本为5.5.13.13</span></p>\n<p style=\"text-align:left;\"><span style=\"color:#333333;\">QRCoder 版本为1.4.3 </span></p>\n<p class=\"img-center\"><img alt=\"\" src=\"image\\f6447961fb9efb39ae330c37de8b6a8d.png\"/></p>\n<h2 id=\"4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E7%9B%AE%E5%BD%95\" style=\"text-align:left;\"><span style=\"color:#333333;\">4、解决方案目录</span></h2>\n<p class=\"img-center\"><img alt=\"\" src=\"image\\c8612d8841f866712541806764bd6afa.png\"/></p>\n<h2 id=\"5%E3%80%81%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81\" style=\"text-align:left;\"><span style=\"color:#333333;\">5、主要代码 </span></h2>\n<h3 id=\"1%E3%80%81%E6%96%B0%E5%BB%BAPdfUtils%E5%B7%A5%E5%85%B7%E7%B1%BB\" style=\"text-align:left;\"><span style=\"color:#000000;\">1、新建PdfUtils工具类</span></h3>\n<p style=\"text-align:left;\"></p>\n<pre><span style=\"background-color:#fafafa;\"><code><span style=\"color:#0077aa;\">class</span> <span style=\"color:#dd4a68;\">PdfUtils</span>\n    <span style=\"color:#999999;\">{<!-- --></span>\n        <span style=\"color:#0077aa;\">const</span> <span style=\"color:#dd4a68;\">string</span><span style=\"color:#000000;\"> ITextExamplesFolder </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#669900;\">\"iTextExamples\"</span><span style=\"color:#999999;\">;</span>\n        <span style=\"color:#0077aa;\">const</span> <span style=\"color:#dd4a68;\">string</span><span style=\"color:#000000;\"> ResourcesFolder </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#669900;\">\"resources\"</span><span style=\"color:#999999;\">;</span>\n\n\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">string</span><span style=\"color:#000000;\"> Author </span><span style=\"color:#9a6e3a;\">=&gt;</span> <span style=\"color:#669900;\">\"haogm\"</span><span style=\"color:#999999;\">;</span>\n\n\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">string</span> <span style=\"color:#dd4a68;\">GetBaseDir</span><span style=\"color:#999999;\">()</span>        <span style=\"color:#999999;\">{<!-- --></span>\n          \n            <span style=\"color:#0077aa;\">return</span><span style=\"color:#000000;\"> Environment</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">CurrentDirectory</span><span style=\"color:#999999;\">;</span> \n        <span style=\"color:#999999;\">}</span>    \n        <span style=\"color:#708090;\">/// &lt;summary&gt;</span>\n        <span style=\"color:#708090;\">/// 创建列 插入文本内容</span>\n        <span style=\"color:#708090;\">/// &lt;/summary&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"table\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"content\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"font\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"minimumHeight\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"colspan\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"rowspan\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">void</span> <span style=\"color:#dd4a68;\">CreateCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">PdfPTable</span><span style=\"color:#000000;\"> table</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">string</span><span style=\"color:#000000;\"> content</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">Font</span><span style=\"color:#000000;\"> font</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> minimumHeight </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">20</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> colspan </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> rowspan </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#dd4a68;\">var</span><span style=\"color:#000000;\"> cell </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#0077aa;\">new</span> <span style=\"color:#000000;\">PdfPCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#0077aa;\">new</span> <span style=\"color:#000000;\">Phrase</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">content</span><span style=\"color:#999999;\">,</span><span style=\"color:#000000;\"> font</span><span style=\"color:#999999;\">));</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">UseAscender </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">true</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置可以居中</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">MinimumHeight </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> minimumHeight</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置单元格高度</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">HorizontalAlignment </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> PdfPCell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">ALIGN_CENTER</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置水平居中</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">VerticalAlignment </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> PdfPCell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">ALIGN_MIDDLE</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置垂直居中</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">rowspan </span><span style=\"color:#9a6e3a;\">!=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Rowspan </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> rowspan</span><span style=\"color:#999999;\">;</span> <span style=\"color:#708090;\">//行合并</span>\n            <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">colspan </span><span style=\"color:#9a6e3a;\">!=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Colspan </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> colspan</span><span style=\"color:#999999;\">;</span> <span style=\"color:#708090;\">//列合并</span>\n            <span style=\"color:#999999;\">}</span>\n<span style=\"color:#000000;\">            table</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">AddCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">cell</span><span style=\"color:#999999;\">);</span>\n        <span style=\"color:#999999;\">}</span>\n        <span style=\"color:#708090;\">/// &lt;summary&gt;</span>\n        <span style=\"color:#708090;\">/// 创建列 插入图片</span>\n        <span style=\"color:#708090;\">/// &lt;/summary&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"table\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"image\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"minimumHeight\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"colspan\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"rowspan\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">void</span> <span style=\"color:#dd4a68;\">CreateCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">PdfPTable</span><span style=\"color:#000000;\"> table</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">Image</span><span style=\"color:#000000;\"> image</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> minimumHeight </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">3</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> colspan </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">,</span> <span style=\"color:#dd4a68;\">int</span><span style=\"color:#000000;\"> rowspan </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n        <span style=\"color:#999999;\">{<!-- --></span>           \n            <span style=\"color:#dd4a68;\">var</span><span style=\"color:#000000;\"> cell </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#0077aa;\">new</span> <span style=\"color:#000000;\">PdfPCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">image</span><span style=\"color:#999999;\">,</span><span style=\"color:#990055;\">true</span><span style=\"color:#999999;\">);</span><span style=\"color:#708090;\">// 是否填充</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Padding </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">5.5f</span><span style=\"color:#999999;\">;</span> <span style=\"color:#708090;\">// 设置二维码在单元格中的边距</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">UseAscender </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#990055;\">true</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置可以居中</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">MinimumHeight </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> minimumHeight</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置单元格高度</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">HorizontalAlignment </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> Element</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">ALIGN_CENTER</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置水平居中</span>\n<span style=\"color:#000000;\">            cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">VerticalAlignment </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> Element</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">ALIGN_MIDDLE</span><span style=\"color:#999999;\">;</span><span style=\"color:#708090;\">// 设置垂直居中</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">rowspan </span><span style=\"color:#9a6e3a;\">!=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Rowspan </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> rowspan</span><span style=\"color:#999999;\">;</span> <span style=\"color:#708090;\">//行合并</span>\n            <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">colspan </span><span style=\"color:#9a6e3a;\">!=</span> <span style=\"color:#990055;\">0</span><span style=\"color:#999999;\">)</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                cell</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Colspan </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> colspan</span><span style=\"color:#999999;\">;</span> <span style=\"color:#708090;\">//列合并</span>\n            <span style=\"color:#999999;\">}</span>\n<span style=\"color:#000000;\">            table</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">AddCell</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">cell</span><span style=\"color:#999999;\">);</span>\n        <span style=\"color:#999999;\">}</span>    \n\n\n        <span style=\"color:#708090;\">//生成二维码的路径</span>\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">string</span> <span style=\"color:#dd4a68;\">GetQRFileName</span><span style=\"color:#999999;\">()</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#0077aa;\">return</span><span style=\"color:#000000;\"> Path</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Combine</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">GetOutputFolder</span><span style=\"color:#999999;\">(),</span> <span style=\"color:#000000;\">$\"Qr.jpg\"</span><span style=\"color:#999999;\">);</span>\n        <span style=\"color:#999999;\">}</span>   \n\n\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">string</span> <span style=\"color:#dd4a68;\">GetOutputFolder</span><span style=\"color:#999999;\">()</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#dd4a68;\">var</span><span style=\"color:#000000;\"> dir </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> Path</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Combine</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">GetBaseDir</span><span style=\"color:#999999;\">(),</span> <span style=\"color:#669900;\">\"bin\"</span><span style=\"color:#999999;\">,</span> <span style=\"color:#669900;\">\"out\"</span><span style=\"color:#999999;\">);</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#9a6e3a;\">!</span><span style=\"color:#000000;\">Directory</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Exists</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">dir</span><span style=\"color:#999999;\">))</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                Directory</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">CreateDirectory</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">dir</span><span style=\"color:#999999;\">);</span>\n            <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#0077aa;\">return</span><span style=\"color:#000000;\"> dir</span><span style=\"color:#999999;\">;</span>\n        <span style=\"color:#999999;\">}</span>\n\n\n    \n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">string</span> <span style=\"color:#dd4a68;\">GetOutputFolderPdf</span><span style=\"color:#999999;\">()</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#dd4a68;\">var</span><span style=\"color:#000000;\"> dir </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> Path</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Combine</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">GetBaseDir</span><span style=\"color:#999999;\">(),</span> <span style=\"color:#669900;\">\"bin\"</span><span style=\"color:#999999;\">,</span> <span style=\"color:#669900;\">\"outpdf\\\\\"</span><span style=\"color:#999999;\">);</span>\n            <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#9a6e3a;\">!</span><span style=\"color:#000000;\">Directory</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Exists</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">dir</span><span style=\"color:#999999;\">))</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                Directory</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">CreateDirectory</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">dir</span><span style=\"color:#999999;\">);</span>\n            <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#0077aa;\">return</span><span style=\"color:#000000;\"> dir</span><span style=\"color:#999999;\">;</span>\n        <span style=\"color:#999999;\">}</span>\n\n\n        <span style=\"color:#708090;\">/// &lt;summary&gt;</span>\n        <span style=\"color:#708090;\">/// 验证pdf文件</span>\n        <span style=\"color:#708090;\">/// &lt;/summary&gt;</span>\n        <span style=\"color:#708090;\">/// &lt;param name=\"file\"&gt;&lt;/param&gt;</span>\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">void</span> <span style=\"color:#dd4a68;\">VerifyPdfFileIsReadable</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">byte[]</span><span style=\"color:#000000;\"> file</span><span style=\"color:#999999;\">)</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#dd4a68;\">PdfReader</span><span style=\"color:#000000;\"> reader </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#0077aa;\">null</span><span style=\"color:#999999;\">;</span>\n            <span style=\"color:#0077aa;\">try</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                reader </span><span style=\"color:#9a6e3a;\">=</span> <span style=\"color:#0077aa;\">new</span> <span style=\"color:#000000;\">PdfReader</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">file</span><span style=\"color:#999999;\">);</span>\n                <span style=\"color:#dd4a68;\">var</span><span style=\"color:#000000;\"> author </span><span style=\"color:#9a6e3a;\">=</span><span style=\"color:#000000;\"> reader</span><span style=\"color:#999999;\">.</span><span style=\"color:#000000;\">Info</span><span style=\"color:#999999;\">[</span><span style=\"color:#669900;\">\"Author\"</span><span style=\"color:#999999;\">]</span> <span style=\"color:#0077aa;\">as</span> <span style=\"color:#dd4a68;\">string</span><span style=\"color:#999999;\">;</span>\n                <span style=\"color:#0077aa;\">if</span> <span style=\"color:#999999;\">(</span><span style=\"color:#0077aa;\">string</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">IsNullOrWhiteSpace</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">author</span><span style=\"color:#999999;\">)</span> <span style=\"color:#9a6e3a;\">||</span> <span style=\"color:#9a6e3a;\">!</span><span style=\"color:#000000;\">author</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">Equals</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">Author</span><span style=\"color:#999999;\">))</span>\n                <span style=\"color:#999999;\">{<!-- --></span>\n                    <span style=\"color:#0077aa;\">throw</span> <span style=\"color:#0077aa;\">new</span> <span style=\"color:#000000;\">InvalidPdfException</span><span style=\"color:#999999;\">(</span><span style=\"color:#669900;\">\"This is not a valid PDF file.\"</span><span style=\"color:#999999;\">);</span>\n                <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#999999;\">}</span>\n            <span style=\"color:#0077aa;\">finally</span>\n            <span style=\"color:#999999;\">{<!-- --></span>\n<span style=\"color:#000000;\">                reader</span><span style=\"color:#999999;\">?.</span><span style=\"color:#dd4a68;\">Close</span><span style=\"color:#999999;\">();</span>\n            <span style=\"color:#999999;\">}</span>\n        <span style=\"color:#999999;\">}</span>\n\n\n        <span style=\"color:#0077aa;\">public</span> <span style=\"color:#0077aa;\">static</span> <span style=\"color:#000000;\">void</span> <span style=\"color:#dd4a68;\">VerifyPdfFileIsReadable</span><span style=\"color:#999999;\">(</span><span style=\"color:#dd4a68;\">string</span><span style=\"color:#000000;\"> filePath</span><span style=\"color:#999999;\">)</span>\n        <span style=\"color:#999999;\">{<!-- --></span>\n            <span style=\"color:#dd4a68;\">VerifyPdfFileIsReadable</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">File</span><span style=\"color:#999999;\">.</span><span style=\"color:#dd4a68;\">ReadAllBytes</span><span style=\"color:#999999;\">(</span><span style=\"color:#000000;\">filePath</span><span style=\"color:#999999;\">));</span>\n        <span style=\"color:#999999;\">}</span>\n\n\n    <span style=\"color:#999999;\">}</span>\n</code></span></pre>\n<p></p>\n<h3 id=\"2%E3%80%81Form1.cs%20%E7%AA%97%E4%BD%93%E4%B8%BB%E8%A6%81%E4%BB%A3%E7%A0%81\" style=\"text-align:left;\"><span style=\"color:#333333;\">2、Form1.cs 窗体主要代码</span></h3>\n<p style=\"text-align:left;\"></p>\n<pre><span style=\"background-color:#fafafa;\"><code><span style=\"color:#000000;\">/// &lt;summary&gt;</span>\n<span style=\"color:#000000;\">        /// 导出生成标签</span>\n<span style=\"color:#000000;\">        /// &lt;/summary&gt;</span>\n<span style=\"color:#000000;\">        /// &lt;returns&gt;&lt;/returns&gt;</span>\n<span style=\"color:#000000;\">        public bool ExportReceipt()</span>\n<span style=\"color:#000000;\">        {<!-- --></span>\n<span style=\"color:#000000;\">            try</span>\n<span style=\"color:#000000;\">            {<!-- --></span>\n\n\n<span style=\"color:#000000;\">                // 生成二维码的内容</span>\n<span style=\"color:#000000;\">                string strCode = \"\";</span>\n<span style=\"color:#000000;\">                StringBuilder sb = new StringBuilder();</span>\n<span style=\"color:#000000;\">                sb.Append(txtName.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$\");</span>\n<span style=\"color:#000000;\">                sb.Append(txtName.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$\");</span>\n<span style=\"color:#000000;\">                sb.Append(txtAge.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$\");</span>\n<span style=\"color:#000000;\">                sb.Append(txtAddress.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$\");</span>\n<span style=\"color:#000000;\">                sb.Append(txtNation.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$$\");</span>\n<span style=\"color:#000000;\">                sb.Append(txtQQ.Text);</span>\n<span style=\"color:#000000;\">                sb.Append(\"$\");</span>\n<span style=\"color:#000000;\">                strCode = sb.ToString();</span>\n<span style=\"color:#000000;\">                QRCodeGenerator qrGenerator = new QRCoder.QRCodeGenerator();</span>\n<span style=\"color:#000000;\">                QRCodeData qrCodeData = qrGenerator.CreateQrCode(strCode, QRCodeGenerator.ECCLevel.Q);</span>\n<span style=\"color:#000000;\">                QRCode qrcode = new QRCode(qrCodeData);</span>\n\n\n<span style=\"color:#000000;\">                // GetGraphic 第一个参数设置图形的大小</span>\n<span style=\"color:#000000;\">                Bitmap qrCodeImage = qrcode.GetGraphic(3, Color.Black, Color.White, null, 15, 1, false);</span>\n\n\n<span style=\"color:#000000;\">                MemoryStream ms = new MemoryStream();</span>\n<span style=\"color:#000000;\">                qrCodeImage.Save(ms, ImageFormat.Jpeg);</span>\n\n\n<span style=\"color:#000000;\">                // 保存图片 </span>\n<span style=\"color:#000000;\">                var ImgPath = PdfUtils.GetQRFileName();</span>\n<span style=\"color:#000000;\">                qrCodeImage.Save(ImgPath);</span>\n\n\n<span style=\"color:#000000;\">                // 保存pdf文件</span>\n<span style=\"color:#000000;\">                var pdfFilePath = PdfUtils.GetOutputFolderPdf() + DateTime.Now.ToString(\"yyyyMMddHHmmss\") + \".pdf\";</span>\n<span style=\"color:#000000;\">                if (File.Exists(Path.GetFullPath(pdfFilePath)))</span>\n<span style=\"color:#000000;\">                {<!-- --></span>\n<span style=\"color:#000000;\">                    File.Delete(Path.GetFullPath(pdfFilePath));</span>\n<span style=\"color:#000000;\">                }</span>\n<span style=\"color:#000000;\">                var fileStream = new FileStream(pdfFilePath, FileMode.Create);</span>\n<span style=\"color:#000000;\">                //var pdfDoc = new Document(PageSize.A4);</span>\n<span style=\"color:#000000;\">                var pdfDoc = new Document(new iTextSharp.text.Rectangle(226.4f, 169.8f)); // 80*60 mm</span>\n<span style=\"color:#000000;\">                var pdfWriter = PdfWriter.GetInstance(pdfDoc, fileStream);</span>\n<span style=\"color:#000000;\">                pdfDoc.SetMargins(0.2f, 0.2f, 3.2f, 0.2f);</span>\n<span style=\"color:#000000;\">                pdfDoc.AddAuthor(PdfUtils.Author);</span>\n<span style=\"color:#000000;\">                pdfDoc.Open();</span>\n\n\n<span style=\"color:#000000;\">                // 中文字体,解决中文不能显示问题</span>\n<span style=\"color:#000000;\">                BaseFont bfChinese = BaseFont.CreateFont(\"C:\\\\WINDOWS\\\\FONTS\\\\SIMSUN.TTC,0\", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED);</span>\n<span style=\"color:#000000;\">                // 五号</span>\n<span style=\"color:#000000;\">                iTextSharp.text.Font fiveFont = new iTextSharp.text.Font(bfChinese, 8f);   // 五号 10.5f 小三号 15     </span>\n<span style=\"color:#000000;\">                iTextSharp.text.Image image = iTextSharp.text.Image.GetInstance(ImgPath);</span>\n<span style=\"color:#000000;\">                // 新建表格 3列.</span>\n<span style=\"color:#000000;\">                PdfPTable table0 = new PdfPTable(3)</span>\n<span style=\"color:#000000;\">                {<!-- --></span>\n<span style=\"color:#000000;\">                    WidthPercentage = 98,// 宽度100%填充,</span>\n<span style=\"color:#000000;\">                };</span>\n<span style=\"color:#000000;\">                table0.DefaultCell.VerticalAlignment = Element.ALIGN_CENTER;</span>\n\n\n<span style=\"color:#000000;\">                // 设置列宽</span>\n<span style=\"color:#000000;\">                float[] columnWidths0 = { 0.4f, 0.8f, 0.8f };</span>\n<span style=\"color:#000000;\">                table0.SetWidths(columnWidths0);</span>\n<span style=\"color:#000000;\">                //正文第1行</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"姓名\", fiveFont);                </span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtName.Text, fiveFont);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, image, 30, 0, 5);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"学历\", fiveFont);               </span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtEducation.Text, fiveFont);         </span>\n\n\n                \n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"年龄\", fiveFont);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtAge.Text, fiveFont);</span>\n\n\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"地址\", fiveFont);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtAddress.Text, fiveFont);</span>\n\n\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"民族\", fiveFont);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtNation.Text, fiveFont);</span>\n\n\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, \"QQ号\", fiveFont);</span>\n<span style=\"color:#000000;\">                PdfUtils.CreateCell(table0, txtQQ.Text, fiveFont,0,2);</span>\n<span style=\"color:#000000;\">                pdfDoc.Add(table0);</span>\n<span style=\"color:#000000;\">                pdfDoc.Close();</span>\n<span style=\"color:#000000;\">                fileStream.Dispose();</span>\n\n\n<span style=\"color:#000000;\">                PdfUtils.VerifyPdfFileIsReadable(pdfFilePath);</span>\n<span style=\"color:#000000;\">                //直接打开pdf文件</span>\n\n\n<span style=\"color:#000000;\">                System.Diagnostics.Process.Start(pdfFilePath); </span>\n<span style=\"color:#000000;\">                return true;</span>\n<span style=\"color:#000000;\">            }</span>\n<span style=\"color:#000000;\">            catch (Exception ex)</span>\n<span style=\"color:#000000;\">            {<!-- --></span>\n<span style=\"color:#000000;\">                return false;</span>\n<span style=\"color:#000000;\">            }</span>\n<span style=\"color:#000000;\">        }</span></code></span></pre>\n<p style=\"text-align:left;\"><span style=\"color:#333333;\">代码地址：https://gitee.com/hgm1989/itext-sharp-demo</span></p>\n</div>\n</div>\n</div>\n</div>\n</div>"}