{"blogid": "126743203", "writerAge": "码龄24天", "writerBlogNum": "53", "writerCollect": "0", "writerComment": "1", "writerFan": "71", "writerGrade": "3级", "writerIntegral": "530", "writerName": "web13216052708", "writerProfileAdress": "writer_image\\profile_126743203.jpg", "writerRankTotal": "38159", "writerRankWeekly": "10548", "writerThumb": "0", "writerVisitNum": "2693", "blog_read_count": "11", "blog_time": "于 2022-09-07 12:31:22 发布", "blog_title": "jvm crash 的原因及解决办法", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>最近部署服务器时，总是会出现jvm fatal error 导致tomcat崩溃无法正常启动，以下是错误信息</p>\n<p>Java代码 [这里是图片001]</p>\n<ol><li> <p>#AfatalerrorhasbeendetectedbytheJavaRuntimeEnvironment:</p> </li><li> <h1><a id=\"_7\"></a></h1> </li><li> <p>#InternalError(c1_Optimizer.cpp:271),pid=1196,tid=4412</p> </li><li> <p>#guarantee(x_compare_res!=Constant::not_comparable)failed:incomparableconstantsinIfOp</p> </li><li> <h1><a id=\"_10\"></a></h1> </li><li> <p>#JREversion:6.0_25-b06</p> </li><li> <p>#JavaVM:JavaHotSpot™ClientVM(20.0-b11mixedmodewindows-x86)</p> </li><li> <p>#Ifyouwouldliketosubmitabugreport,pleasevisit:</p> </li><li> <p>#http://java.sun.com/webapps/bugreport/crash.jsp</p> </li><li> <h1><a id=\"_15\"></a></h1> </li><li> <p>---------------THREAD---------------</p> </li><li> <p>Currentthread(0x01213800):JavaThread\"C1CompilerThread0\"daemon[_thread_in_native,id=4412,stack(0x179f0000,0x17a40000)]</p> </li><li> <p>Stack:[0x179f0000,0x17a40000],sp=0x17a3f554,freespace=317k</p> </li><li> <p>Nativeframes:(J=compiledJavacode,j=interpreted,Vv=VMcode,C=nativecode)</p> </li></ol>\n<p>这个问题在google上搜了很多文章，终于找到一片来自iteye网友的文章，和我遇到的问题基本类似，非常感谢。传送门：http://seanhe.iteye.com/blog/905997</p>\n<p>问题的原因就在于 显示JIT在做编译优化的时候处理 某个方法时出错。<br/> 本利的错误是这个方法</p>\n<p>Java代码 [这里是图片002]</p>\n<ol><li>org.hibernate.cfg.annotations.SimpleValueBinder.setType</li></ol>\n<p>解决办法：让jvm跳过该方法的编译优化</p>\n<p>在jvm启动参数中添加启动参数</p>\n<p>Java代码 [这里是图片003]</p>\n<ol><li>-XX:CompileCommand=exclude,org/hibernate/cfg/annotations/SimpleValueBinder，setType</li></ol>\n<p>如果是 eclipse下启动服务 ，则在eclipse-preference-java-installed jres 里面设置，<br/> 在 defalt vm arguments 填入上面的代码就可以了。</p>\n<p>如果是 直接通过startup 启动tomcat ，则需要修改以下文件<br/> Windows下，在文件/bin/catalina.bat，Unix下，在文件/bin/catalina.sh<br/> 找到</p>\n<p>Java代码 [这里是图片004]</p>\n<ol><li>setJAVA_OPTS=%JAVA_OPTS%%LOGGING_CONFIG%</li></ol>\n<p>修改为</p>\n<p>Java代码 [这里是图片005]</p>\n<ol><li>setJAVA_OPTS=%JAVA_OPTS%-XX:CompileCommand=exclude,org/hibernate/cfg/annotations/SimpleValueBinder,setType%LOGGING_CONFIG%</li></ol>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}