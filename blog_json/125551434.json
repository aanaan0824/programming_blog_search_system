{"blogid": "125551434", "writerAge": "码龄2年", "writerBlogNum": "48", "writerCollect": "665", "writerComment": "1134", "writerFan": "1920", "writerGrade": "5级", "writerIntegral": "2350", "writerName": "广龙宇", "writerProfileAdress": "writer_image\\profile_125551434.jpg", "writerRankTotal": "8128", "writerRankWeekly": "115", "writerThumb": "617", "writerVisitNum": "1787463", "blog_read_count": "43749", "blog_time": "于 2022-07-01 09:52:39 发布", "blog_title": "【Python爬虫 • selenium】selenium4新版本使用指南", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a72b9a954ea049a6b1e5d80dcf945593.png\"/></p>\n<blockquote>\n<p>提示：本文默认你已经学会使用selenium的旧版本，因此对一些可以直接搜索到很多的内容，你应该是已经学会的</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_8\">前言</a></li><li><a href=\"#_17\">一、设置驱动</a></li><li><ul><li><a href=\"#1_selenium4_21\">1. selenium4推荐方法</a></li><li><a href=\"#2__54\">2. 传统方法</a></li></ul>\n</li><li><a href=\"#_84\">二、查找元素</a></li><li><ul><li><a href=\"#_122\">等待元素出现</a></li></ul>\n</li><li><a href=\"#API_135\">三、动作API</a></li><li><ul><li><a href=\"#pause_140\">暂停（pause）</a></li><li><a href=\"#_153\">释放所有动作</a></li><li><a href=\"#_159\">键盘</a></li><li><ul><li><a href=\"#_160\">键盘代码表</a></li></ul>\n</li><li><a href=\"#_211\">鼠标</a></li><li><ul><li><a href=\"#5_228\">鼠标定义的5种按键</a></li><li><a href=\"#_235\">鼠标右击</a></li><li><a href=\"#3_243\">按下鼠标3键</a></li><li><a href=\"#4_251\">按下鼠标4键</a></li><li><a href=\"#_259\">鼠标双击</a></li><li><a href=\"#_268\">鼠标移动到元素上</a></li><li><a href=\"#_276\">鼠标位移</a></li><li><ul><li><a href=\"#_278\">从元素左顶边进行位移</a></li><li><a href=\"#_286\">从元素中心进行位移（请期待）</a></li><li><a href=\"#_287\">从当前窗口左上角位移</a></li><li><a href=\"#_293\">从当前鼠标位置位移</a></li></ul>\n</li><li><a href=\"#_300\">拖拽元素</a></li><li><a href=\"#_309\">通过位移拖拽</a></li></ul>\n</li><li><a href=\"#_319\">笔（部分浏览器生效）</a></li><li><a href=\"#_321\">滚轮（只有谷歌内核浏览器生效）</a></li><li><ul><li><a href=\"#_322\">滚动到某元素位置</a></li><li><a href=\"#_330\">定量滚动</a></li><li><a href=\"#_339\">从一个元素滚动指定量</a></li><li><a href=\"#_348\">从一个元素滚动，并指定位移</a></li><li><a href=\"#_357\">从一个元素的原点位移</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_367\">总结</a></li><li><a href=\"#_370\">附录</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<h1><a id=\"_8\"></a>前言</h1>\n<p><code>Selenium</code>是一个用于Web应用程序测试的工具。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。支持的浏览器包括<code>IE（7, 8, 9, 10, 11）</code>，<code>Mozilla Firefox</code>，<code>Safari</code>，<code>Google Chrome</code>，<code>Opera</code>，<code>Edge</code>等。这个工具的主要功能包括：测试与浏览器的兼容性——测试应用程序看是否能够很好得工作在不同浏览器和操作系统之上。</p>\n<p>随着时代的发展，在使用python做自动化时，与之前差生了很大的变化，这些变化都是一个老程序员所必须要踩坑的地方，也是由于已经会了老版本，在使用新版本的时候，需要多次探索，本文从当前最新版的Selenium出发，以Chrome驱动为例，总结了新版的使用方法，免得到处去搜索、踩坑。</p>\n<hr/>\n<h1><a id=\"_17\"></a>一、设置驱动</h1>\n<p>当前Selenium版本：<code>4.3.0</code>，请核对你的版本是否是4.0以上的版本。<br/> <a href=\"https://chromedriver.storage.googleapis.com/index.html\">Chrome驱动点击此处下载</a></p>\n<blockquote>\n<p><code>注意： 请查看你的浏览器版本，然后再去下载对应的驱动，通常来说版本号时一致的，如果没有你的版本号，那就选择和你浏览器版本号最相近的版本。</code></p>\n</blockquote>\n<h2><a id=\"1_selenium4_21\"></a>1. selenium4推荐方法</h2>\n<p>由于传统的设置驱动方式过于繁琐，因此GitHub大佬<a href=\"https://github.com/SergeyPirogov\">SergeyPirogov</a>写了浏览器驱动管理器，可以使设置驱动变得更加方便。</p>\n<p>首先，需要安装该管理器，使用以下命令，</p>\n<pre><code class=\"prism language-bash\">pip <span class=\"token function\">install</span> webdriver-manager\n</code></pre>\n<p>然后导入该包，</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> webdriver_manager<span class=\"token punctuation\">.</span>chrome <span class=\"token keyword\">import</span> ChromeDriverManager\n</code></pre>\n<p>设置service，通过<code>ChromeDriverManager().install()</code>来获取驱动，从而<code>省去了下载驱动和设置驱动</code>的步骤，</p>\n<pre><code class=\"prism language-python\">service <span class=\"token operator\">=</span> ChromeService<span class=\"token punctuation\">(</span>executable_path<span class=\"token operator\">=</span>ChromeDriverManager<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>install<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>然后驱动加载该service，</p>\n<pre><code class=\"prism language-python\">driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>service<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>此处贴出完整代码，以供参考，</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>chrome<span class=\"token punctuation\">.</span>service <span class=\"token keyword\">import</span> Service <span class=\"token keyword\">as</span> ChromeService\n<span class=\"token keyword\">from</span> webdriver_manager<span class=\"token punctuation\">.</span>chrome <span class=\"token keyword\">import</span> ChromeDriverManager\nservice <span class=\"token operator\">=</span> ChromeService<span class=\"token punctuation\">(</span>executable_path<span class=\"token operator\">=</span>ChromeDriverManager<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>install<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>service<span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"2__54\"></a>2. 传统方法</h2>\n<p>这里使用传统方法来设置Selenium的驱动，也就是导入webdriver，然后设置可执行程序的路径。</p>\n<p>首先，在Selenium4中，设置驱动位置，不再是直接在<code>webdriver.Chrome</code>中直接设置，而是引入了Service。因此先导入Service的包，</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>chrome<span class=\"token punctuation\">.</span>service <span class=\"token keyword\">import</span> Service <span class=\"token keyword\">as</span> ChromeService\n</code></pre>\n<p>然后通过Service设置驱动，<code>CHROMEDRIVER_PATH</code>替换为你的驱动位置，</p>\n<pre><code class=\"prism language-python\">service <span class=\"token operator\">=</span> ChromeService<span class=\"token punctuation\">(</span>executable_path<span class=\"token operator\">=</span>CHROMEDRIVER_PATH<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>最后在<code>webdriver.Chrome</code>中调用这个service，</p>\n<pre><code class=\"prism language-python\">driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>service<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>给出完整代码予以参考，</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>chrome<span class=\"token punctuation\">.</span>service <span class=\"token keyword\">import</span> Service <span class=\"token keyword\">as</span> ChromeService\noptions <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>ChromeOptions<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\noptions<span class=\"token punctuation\">.</span>add_experimental_option<span class=\"token punctuation\">(</span><span class=\"token string\">\"excludeSwitches\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"enable-automation\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\noptions<span class=\"token punctuation\">.</span>add_experimental_option<span class=\"token punctuation\">(</span><span class=\"token string\">\"useAutomationExtension\"</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nservice <span class=\"token operator\">=</span> ChromeService<span class=\"token punctuation\">(</span>executable_path<span class=\"token operator\">=</span>CHROMEDRIVER_PATH<span class=\"token punctuation\">)</span>\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>service<span class=\"token punctuation\">,</span> options<span class=\"token operator\">=</span>options<span class=\"token punctuation\">)</span>\n\n</code></pre>\n<h1><a id=\"_84\"></a>二、查找元素</h1>\n<p>在selenium4中，一系列的<code>findElement</code>方法如<code>findElementByClassName</code>、<code>findElementById</code>等都被整合成为了一个方法——<code>findElement</code>。并且通过<code>By.method</code>来选择你的查找元素方法，例如下。</p>\n<p>如果你想根据类名查找元素，你可以使用以下方法，</p>\n<pre><code class=\"prism language-python\">driver<span class=\"token punctuation\">.</span>findElement<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>className<span class=\"token punctuation\">(</span><span class=\"token string\">\"className\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>如果你想通过css选择器来查找元素，你可以使用以下方法，</p>\n<pre><code class=\"prism language-python\">driver<span class=\"token punctuation\">.</span>findElement<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>cssSelector<span class=\"token punctuation\">(</span><span class=\"token string\">\".className\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>这里贴出与以往对应的所有查找元素方法，更新前，</p>\n<pre><code class=\"prism language-python\">driver<span class=\"token punctuation\">.</span>findElementByClassName<span class=\"token punctuation\">(</span><span class=\"token string\">\"className\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByCssSelector<span class=\"token punctuation\">(</span><span class=\"token string\">\".className\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementById<span class=\"token punctuation\">(</span><span class=\"token string\">\"elementId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByLinkText<span class=\"token punctuation\">(</span><span class=\"token string\">\"linkText\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByName<span class=\"token punctuation\">(</span><span class=\"token string\">\"elementName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByPartialLinkText<span class=\"token punctuation\">(</span><span class=\"token string\">\"partialText\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByTagName<span class=\"token punctuation\">(</span><span class=\"token string\">\"elementTagName\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndriver<span class=\"token punctuation\">.</span>findElementByXPath<span class=\"token punctuation\">(</span><span class=\"token string\">\"xPath\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>更新后，</p>\n<pre><code class=\"prism language-python\">driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>XPATH<span class=\"token punctuation\">,</span><span class=\"token string\">'XPATH'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CLASS_NAME<span class=\"token punctuation\">,</span><span class=\"token string\">'CLASS_NAME'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>CSS_SELECTOR<span class=\"token punctuation\">,</span><span class=\"token string\">'CSS_SELECTOR'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span><span class=\"token string\">'ID'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>LINK_TEXT<span class=\"token punctuation\">,</span><span class=\"token string\">'LINK_TEXT'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>PARTIAL_LINK_TEXT<span class=\"token punctuation\">,</span><span class=\"token string\">'PARTIAL_LINK_TEXT'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span><span class=\"token string\">'TAG_NAME'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>如果你查找的是<code>多个元素</code>，只需要将其中的<code>find_element</code>替换成<code>find_elements</code>即可。</p>\n<h2><a id=\"_122\"></a>等待元素出现</h2>\n<p>有时候某个元素不是直接出现的，如果不做判断则会导致程序崩溃，因此一般可以做异常处理，这里还有等待元素出现的方法。</p>\n<p>首先，需要导入等待的包，</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>ui <span class=\"token keyword\">import</span> WebDriverWait\n</code></pre>\n<p>然后使用以下方法等待元素出现，<code>driver</code>就是浏览器驱动，<code>timeout</code>就是等待的时长，<code>until</code>后是判断元素是否出现的，</p>\n<pre><code class=\"prism language-python\">el <span class=\"token operator\">=</span> WebDriverWait<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">,</span> timeout<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>until<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> d<span class=\"token punctuation\">:</span> d<span class=\"token punctuation\">.</span>find_element_by_tag_name<span class=\"token punctuation\">(</span><span class=\"token string\">\"p\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"API_135\"></a>三、动作API</h1>\n<p>动作API是网上资料比较少的，因为之前的查找元素，调用click等已经可以解决很多的问题了，在翻看官方文档时，发现selenium还支持动作API来模拟动作。</p>\n<p>动作API分为四个部分，分别是<code>键盘</code>、<code>鼠标</code>、<code>笔</code>、<code>滚轮</code>。这里先说明以下公共部分的。</p>\n<h2><a id=\"pause_140\"></a>暂停（pause）</h2>\n<p>光标移动，滚轮滚动期间，会有一些时间空隙，这里可以使用暂停来实现，这里是支持链式调用的，这里贴出官方给出的例子，</p>\n<pre><code class=\"prism language-python\">clickable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"clickable\"</span><span class=\"token punctuation\">)</span>\nActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>move_to_element<span class=\"token punctuation\">(</span>clickable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>pause<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>click_and_hold<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>pause<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_153\"></a>释放所有动作</h2>\n<p>当前有动作执行时，可以使用以下方法停止这些动作，</p>\n<pre><code class=\"prism language-python\">ActionBuilder<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>clear_actions<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_159\"></a>键盘</h2>\n<h3><a id=\"_160\"></a>键盘代码表</h3>\n<p>如果你有兴趣，可以看一下，地址在<a href=\"https://github.com/SeleniumHQ/selenium/blob/selenium-4.2.0/py/selenium/webdriver/common/keys.py#L23\">这里</a>，可以看到完整的列表。</p>\n<p>按下某键，以输入<code>shift+abc</code>为例，</p>\n<pre><code class=\"prism language-python\">    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_down<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>SHIFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>弹起某键，以输入<code>shift+a</code>和<code>shift+b</code>为例，</p>\n<pre><code class=\"prism language-python\">    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_down<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>SHIFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"a\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_up<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>SHIFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"b\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>浏览器输入某串字符（不指定元素），</p>\n<pre><code class=\"prism language-python\">    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>指定元素输入字符串，</p>\n<pre><code class=\"prism language-python\">    text_input <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"textInput\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys_to_element<span class=\"token punctuation\">(</span>text_input<span class=\"token punctuation\">,</span> <span class=\"token string\">\"abc\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>复制和粘贴，</p>\n<pre><code class=\"prism language-python\">cmd_ctrl <span class=\"token operator\">=</span> Keys<span class=\"token punctuation\">.</span>COMMAND <span class=\"token keyword\">if</span> sys<span class=\"token punctuation\">.</span>platform <span class=\"token operator\">==</span> <span class=\"token string\">'darwin'</span> <span class=\"token keyword\">else</span> Keys<span class=\"token punctuation\">.</span>CONTROL\nActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"Selenium!\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>ARROW_LEFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_down<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>SHIFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>ARROW_UP<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_up<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>SHIFT<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_down<span class=\"token punctuation\">(</span>cmd_ctrl<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">\"xvv\"</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>key_up<span class=\"token punctuation\">(</span>cmd_ctrl<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_211\"></a>鼠标</h2>\n<p>鼠标点击保持，该方法将鼠标移动到元素中心与按下鼠标左键相结合。这有助于聚焦特定元素：</p>\n<pre><code class=\"prism language-python\">    clickable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"clickable\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>click_and_hold<span class=\"token punctuation\">(</span>clickable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>鼠标点击释放，</p>\n<pre><code class=\"prism language-python\">    clickable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"click\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span>clickable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"5_228\"></a>鼠标定义的5种按键</h3>\n<ul><li>0——鼠标左键</li><li>1——鼠标中键</li><li>2——鼠标右键</li><li>3——X1（后退键）</li><li>4——X2（前进键）</li></ul>\n<h3><a id=\"_235\"></a>鼠标右击</h3>\n<pre><code class=\"prism language-python\">    clickable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"clickable\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>context_click<span class=\"token punctuation\">(</span>clickable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"3_243\"></a>按下鼠标3键</h3>\n<pre><code class=\"prism language-python\">    action <span class=\"token operator\">=</span> ActionBuilder<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>pointer_action<span class=\"token punctuation\">.</span>pointer_down<span class=\"token punctuation\">(</span>MouseButton<span class=\"token punctuation\">.</span>BACK<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>pointer_action<span class=\"token punctuation\">.</span>pointer_up<span class=\"token punctuation\">(</span>MouseButton<span class=\"token punctuation\">.</span>BACK<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"4_251\"></a>按下鼠标4键</h3>\n<pre><code class=\"prism language-python\">    action <span class=\"token operator\">=</span> ActionBuilder<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>pointer_action<span class=\"token punctuation\">.</span>pointer_down<span class=\"token punctuation\">(</span>MouseButton<span class=\"token punctuation\">.</span>FORWARD<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>pointer_action<span class=\"token punctuation\">.</span>pointer_up<span class=\"token punctuation\">(</span>MouseButton<span class=\"token punctuation\">.</span>FORWARD<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_259\"></a>鼠标双击</h3>\n<pre><code class=\"prism language-python\">    clickable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"clickable\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>double_click<span class=\"token punctuation\">(</span>clickable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_268\"></a>鼠标移动到元素上</h3>\n<pre><code class=\"prism language-python\">    hoverable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"hover\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>move_to_element<span class=\"token punctuation\">(</span>hoverable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_276\"></a>鼠标位移</h3>\n<p>就是通过像素点来进行位移操作。</p>\n<h4><a id=\"_278\"></a>从元素左顶边进行位移</h4>\n<pre><code class=\"prism language-python\">    mouse_tracker <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mouse-tracker\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>move_to_element_with_offset<span class=\"token punctuation\">(</span>mouse_tracker<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h4><a id=\"_286\"></a>从元素中心进行位移（请期待）</h4>\n<h4><a id=\"_287\"></a>从当前窗口左上角位移</h4>\n<pre><code class=\"prism language-python\">    action <span class=\"token operator\">=</span> ActionBuilder<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>pointer_action<span class=\"token punctuation\">.</span>move_to_location<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\n    action<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h4><a id=\"_293\"></a>从当前鼠标位置位移</h4>\n<pre><code class=\"prism language-python\">    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>move_by_offset<span class=\"token punctuation\">(</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_300\"></a>拖拽元素</h3>\n<p>该方法首先单击并按住源元素，移动到目标元素的位置，然后释放鼠标。</p>\n<pre><code class=\"prism language-python\">    draggable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"draggable\"</span><span class=\"token punctuation\">)</span>\n    droppable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"droppable\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>drag_and_drop<span class=\"token punctuation\">(</span>draggable<span class=\"token punctuation\">,</span> droppable<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_309\"></a>通过位移拖拽</h3>\n<pre><code class=\"prism language-python\">    draggable <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"draggable\"</span><span class=\"token punctuation\">)</span>\n    start <span class=\"token operator\">=</span> draggable<span class=\"token punctuation\">.</span>location\n    finish <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> <span class=\"token string\">\"droppable\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>location\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>drag_and_drop_by_offset<span class=\"token punctuation\">(</span>draggable<span class=\"token punctuation\">,</span> finish<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> finish<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_319\"></a>笔（部分浏览器生效）</h2>\n<p>由于<code>笔</code>只在部分浏览器生效，这里就不写了，如果你感兴趣，或者有需求可以去官方文档查看，这里贴出<a href=\"https://www.selenium.dev/documentation/webdriver/actions_api/pen/\">官方文档地址</a>。</p>\n<h2><a id=\"_321\"></a>滚轮（只有谷歌内核浏览器生效）</h2>\n<h3><a id=\"_322\"></a>滚动到某元素位置</h3>\n<pre><code class=\"prism language-python\">    iframe <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"iframe\"</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>scroll_to_element<span class=\"token punctuation\">(</span>iframe<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_330\"></a>定量滚动</h3>\n<pre><code class=\"prism language-python\">    footer <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"footer\"</span><span class=\"token punctuation\">)</span>\n    delta_y <span class=\"token operator\">=</span> footer<span class=\"token punctuation\">.</span>rect<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>scroll_by_amount<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> delta_y<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_339\"></a>从一个元素滚动指定量</h3>\n<pre><code class=\"prism language-python\">    iframe <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"iframe\"</span><span class=\"token punctuation\">)</span>\n    scroll_origin <span class=\"token operator\">=</span> ScrollOrigin<span class=\"token punctuation\">.</span>from_element<span class=\"token punctuation\">(</span>iframe<span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>scroll_from_origin<span class=\"token punctuation\">(</span>scroll_origin<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_348\"></a>从一个元素滚动，并指定位移</h3>\n<pre><code class=\"prism language-python\">    footer <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>By<span class=\"token punctuation\">.</span>TAG_NAME<span class=\"token punctuation\">,</span> <span class=\"token string\">\"footer\"</span><span class=\"token punctuation\">)</span>\n    scroll_origin <span class=\"token operator\">=</span> ScrollOrigin<span class=\"token punctuation\">.</span>from_element<span class=\"token punctuation\">(</span>footer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>scroll_from_origin<span class=\"token punctuation\">(</span>scroll_origin<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_357\"></a>从一个元素的原点位移</h3>\n<pre><code class=\"prism language-python\">    ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>scroll_from_origin<span class=\"token punctuation\">(</span>scroll_origin<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\\\n        <span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<hr/>\n<h1><a id=\"_367\"></a>总结</h1>\n<p>以上就是本文的所有内容，总结了selenium4在使用过程中常见的一些坑，以及官方所推荐使用的方式，此外，通过翻阅文档，将selenium4的动作API挖了出来，算是比较完整的selenium入门了，如果你对selenium4感兴趣，可以与我联系哦。</p>\n<h1><a id=\"_370\"></a>附录</h1>\n<p>以下内容不分先后，</p>\n<ul><li><a href=\"https://www.selenium.dev/documentation/webdriver/\">selenium官方文档</a></li><li><a href=\"https://github.com/SergeyPirogov\">GitHub大佬SergeyPirogov</a></li><li><a href=\"https://chromedriver.storage.googleapis.com/index.html\">Chrome驱动下载</a></li></ul>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}