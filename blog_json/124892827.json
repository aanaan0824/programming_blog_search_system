{"blogid": "124892827", "writerAge": "码龄6年", "writerBlogNum": "29", "writerCollect": "134", "writerComment": "12", "writerFan": "65", "writerGrade": "4级", "writerIntegral": "1183", "writerName": "宇宙的尽头是编制", "writerProfileAdress": "writer_image\\profile_124892827.jpg", "writerRankTotal": "17178", "writerRankWeekly": "63595", "writerThumb": "34", "writerVisitNum": "76808", "blog_read_count": "1004", "blog_time": "已于 2022-05-30 03:29:51 修改", "blog_title": "Qt之QDockWidget窗口详解—含演示Demo", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E5%89%8D%E8%A8%80-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%89%8D%E8%A8%80\">前言</a></p>\n<p id=\"1%E3%80%81QDockWidget%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95-toc\" style=\"margin-left:0px;\"><a href=\"#1%E3%80%81QDockWidget%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95\">1、QDockWidget常用方法</a></p>\n<p id=\"1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%C2%A0-toc\" style=\"margin-left:0px;\"><a href=\"#1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%C2%A0\">2、标题栏 </a></p>\n<p id=\"1.1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E6%9C%80%E5%B0%8F%E5%8C%96%EF%BC%8C%E5%85%B3%E9%97%AD%E6%8C%89%E9%92%AE%E7%9A%84%E6%94%B9%E9%80%A0-toc\" style=\"margin-left:40px;\"><a href=\"#1.1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E6%9C%80%E5%B0%8F%E5%8C%96%EF%BC%8C%E5%85%B3%E9%97%AD%E6%8C%89%E9%92%AE%E7%9A%84%E6%94%B9%E9%80%A0\">2.1、标题栏之最小化，关闭按钮的改造</a></p>\n<p id=\"%C2%A01.2%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E8%8F%9C%E5%8D%95%E6%A0%8F-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A01.2%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E8%8F%9C%E5%8D%95%E6%A0%8F\">2.2、标题栏之菜单栏</a></p>\n<p id=\"2%E3%80%81QDockWidgets%E9%94%81%E5%AE%9A-toc\" style=\"margin-left:0px;\"><a href=\"#2%E3%80%81QDockWidgets%E9%94%81%E5%AE%9A\">3、QDockWidgets锁定</a></p>\n<p id=\"%C2%A02.1%E3%80%81%E5%B7%A5%E5%85%B7%E6%A0%8F-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A02.1%E3%80%81%E5%B7%A5%E5%85%B7%E6%A0%8F\">3.1、工具栏</a></p>\n<p id=\"%C2%A02.2%E9%A1%B9%E7%9B%AE%E5%8C%BA-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A02.2%E9%A1%B9%E7%9B%AE%E5%8C%BA\">3.2、项目区</a></p>\n<p id=\"2.3%E3%80%81%E5%B1%9E%E6%80%A7%E5%8C%BA-toc\" style=\"margin-left:40px;\"><a href=\"#2.3%E3%80%81%E5%B1%9E%E6%80%A7%E5%8C%BA\">3.3、属性区</a></p>\n<p id=\"%C2%A02.4%E3%80%81%E6%97%A5%E5%BF%97%E5%8C%BA-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A02.4%E3%80%81%E6%97%A5%E5%BF%97%E5%8C%BA\">3.4、日志区</a></p>\n<p id=\"3%E3%80%81Demo%E6%95%88%E6%9E%9C-toc\" style=\"margin-left:0px;\"><a href=\"#3%E3%80%81Demo%E6%95%88%E6%9E%9C\">4、Demo效果</a></p>\n<p id=\"%C2%A04%E3%80%81Demo%E4%B8%8B%E8%BD%BD-toc\" style=\"margin-left:0px;\"><a href=\"#%C2%A04%E3%80%81Demo%E4%B8%8B%E8%BD%BD\">5、Demo下载</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h1 id=\"%E5%89%8D%E8%A8%80\">前言</h1>\n<p>        QDockWidget类提供了一个特殊的窗口部件，它可以是被锁在QMainWindow窗口内部或者是作为顶级窗口悬浮在桌面上。<br/>         QDockWidget类提供了dock widget的概念，dock widget也就是我们熟悉的工具面板或者是工具窗口。Dock window是放置在<br/>         QMindow窗口周围的dock widget区域中的</p>\n<p class=\"img-center\"><img alt=\"\" src=\"https://img-blog.csdn.net/20130607225418890\"/></p>\n<p><a class=\"has-card\" href=\"https://blog.csdn.net/chenlong12580/article/details/9051847\" title=\"参考博客：QDockWidget详解\"><span class=\"link-card-box\"><span class=\"link-title\">参考博客：QDockWidget详解</span><span class=\"link-link\"><img alt=\"\" class=\"link-link-icon\" src=\"image\\icon-default.png\"/>https://blog.csdn.net/chenlong12580/article/details/9051847</span></span></a>       参考代码：Qt\\Examples\\Qt-5.15.2\\widgets\\mainwindows</p>\n<p>注意：QDockWidget目前只有锁定在QMainWindow窗口内部，才能展现出QDockWidget应有的属性，如果将QDockWidget放到布局管理器当中，那么就只能当作QWidget使用了。</p>\n<p>Qt 参考实例当中提供了QMainWindows窗口，看起来也很漂亮，但其实存在这诸多问题。如何要在项目中使用，那么就要进行大量改造。</p>\n<p><img alt=\"\" height=\"1200\" src=\"image\\7db2a53ef68b4ba888b1e59e87d3dfc0.png\" width=\"1200\"/></p>\n<h1 id=\"1%E3%80%81QDockWidget%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95\">1、QDockWidget常用方法</h1>\n<p>  常用函数：<br/>   1、addDockWidget：添加停靠控件，用于指定或更改停靠控件的位置以及方向。</p>\n<pre><code>void QMainWindow::addDockWidget(Qt::DockWidgetArea area, QDockWidget * dockwidget)\nvoid QMainWindow::addDockWidget(Qt::DockWidgetArea area, QDockWidget * dockwidget, Qt::Orientation orientation)</code></pre>\n<p>  2、splitDockWidget：分割窗口，用于对两个QDockWidget进行水平或垂直布局。</p>\n<pre><code>void QMainWindow::splitDockWidget(QDockWidget * first, QDockWidget * second, Qt::Orientation orientation)</code></pre>\n<p>  3、tabifyDockWidget：合并窗口，用于将多个QDockWidget叠加到同一区域。</p>\n<pre><code>void QMainWindow::tabifyDockWidget(QDockWidget * first, QDockWidget * second)</code></pre>\n<p>  4、setDockNestingEnabled：是否允许嵌套布局</p>\n<pre><code>void QMainWindow::setDockNestingEnabled(bool enabled)</code></pre>\n<h1 id=\"1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%C2%A0\">2、标题栏 </h1>\n<p>先上效果图：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"82\" src=\"image\\a6806014f06f4b27a3ea912c84a1c09e.png\" width=\"1200\"/></p>\n<h2 id=\"1.1%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E6%9C%80%E5%B0%8F%E5%8C%96%EF%BC%8C%E5%85%B3%E9%97%AD%E6%8C%89%E9%92%AE%E7%9A%84%E6%94%B9%E9%80%A0\">2.1、标题栏之最小化，关闭按钮的改造</h2>\n<p>        Qt默认的最小化，关闭按钮等功能键样式太过复古，已经完全不适应现在用户的审美要求。那么我选择使用Qt无边框属性。将Qt自带的功能键取掉，自动来实现，这样式样可控。</p>\n<p>        首先，给QMainWindow添加无边框属性：</p>\n<pre><code>this-&gt;setWindowFlags(Qt::Window | Qt::FramelessWindowHint);</code></pre>\n<p>      其次，添加QMenuBar角落小窗口。更多细节代码请下载源码查看。</p>\n<pre><code>this-&gt;menuBar()-&gt;setCornerWidget(m_maxminWin, Qt::TopRightCorner);\n</code></pre>\n<p><span style=\"color:#fe2c24;\"><strong>注意：</strong></span>QMenuBar角落小窗口在使用上有个小Bug，至今也没有解决，但是可以规避。就是：在窗口的构造函数中添加全屏显示方法，则就看不到角落小窗口。</p>\n<p>        那么解决办法是：窗口绘制完成之后，不要显示最大化。这样QMenuBar角落小部件就正常显示出来了。再利用QTimer::Singleshot()， 设置一个很短时间，比如10ms，触发事件，再去this-&gt;showMaximized()；全屏显示就ok。那么其实还依然存在，只是适当的规避了。</p>\n<p>       详情请看Qt社区博客：<a class=\"has-card\" href=\"https://bbs.csdn.net/topics/606763502\" title=\"Qt MainWindow标题栏QMenuBar设置角落小部件失效-CSDN社区\"><span class=\"link-card-box\"><span class=\"link-title\">Qt MainWindow标题栏QMenuBar设置角落小部件失效-CSDN社区</span><span class=\"link-link\"><img alt=\"\" class=\"link-link-icon\" src=\"image\\icon-default.png\"/>https://bbs.csdn.net/topics/606763502</span></span></a></p>\n<p>这样就是一个标准的标题栏：包括菜单栏和功能键，样式可控。 </p>\n<h2 id=\"%C2%A01.2%E3%80%81%E6%A0%87%E9%A2%98%E6%A0%8F%E4%B9%8B%E8%8F%9C%E5%8D%95%E6%A0%8F\">2.2、标题栏之菜单栏</h2>\n<pre><code>void QDockWidgetDemo::initTitleBar()\n{\n\tQMenuBar* m_MenuBar = this-&gt;menuBar();\n\tm_MenuBar-&gt;setStyleSheet(MenuBarStyle);\n\n\tQMenu* m_viewMenu = this-&gt;menuBar()-&gt;addMenu(tr(\"视图\"));\n\tm_viewMenu-&gt;setStyleSheet(MenuStyle);\n\n\tm_toolBarAc = new QAction(\"工具栏\");\n\tconnect(m_toolBarAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_showToolBar);\n\tm_toolBarAc-&gt;setCheckable(true);\n\tm_toolBarAc-&gt;setChecked(true);\n\n\tm_projectAc = new QAction(\"项目\");\n\tconnect(m_projectAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_showPorjectWin);\n\tm_projectAc-&gt;setCheckable(true);\n\tm_projectAc-&gt;setChecked(true);\n\n\tm_propertyAc = new QAction(\"属性\");\n\tconnect(m_propertyAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_showPropertyWin);\n\tm_propertyAc-&gt;setCheckable(true);\n\tm_propertyAc-&gt;setChecked(true);\n\n\tm_logAc = new QAction(\"输出\");\n\tconnect(m_logAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_showLogWin);\n\tm_logAc-&gt;setCheckable(true);\n\tm_logAc-&gt;setChecked(true);\n\n\tm_viewMenu-&gt;addAction(m_toolBarAc);\n\tm_viewMenu-&gt;addAction(m_projectAc);\n\tm_viewMenu-&gt;addAction(m_propertyAc);\n\tm_viewMenu-&gt;addAction(m_logAc);\n\n\tQMenu* m_setView = this-&gt;menuBar()-&gt;addMenu(tr(\"设置\"));\n\tQMenu* m_toolMenu = this-&gt; menuBar()-&gt;addMenu(tr(\"工具\"));\n\tQMenu* m_helpMenu = this-&gt;menuBar()-&gt;addMenu(tr(\"帮助\"));\n\n\tinitMaxMinWin();\n }</code></pre>\n<h1 id=\"2%E3%80%81QDockWidgets%E9%94%81%E5%AE%9A\">3、QDockWidgets锁定</h1>\n<p> 在Demo中，QDockWidge窗口实现了工具栏、项目管理区、属性区、日志区等。如图：</p>\n<p><img alt=\"\" height=\"1200\" src=\"image\\fc3ceab1852e4d16bd2012c50ed997e5.png\" width=\"1200\"/></p>\n<h2 id=\"%C2%A02.1%E3%80%81%E5%B7%A5%E5%85%B7%E6%A0%8F\">3.1、工具栏</h2>\n<pre><code>\nvoid QDockWidgetDemo::initToolBar() {\n\tQSize toolIconSize(50, 30);\n\tui.mainToolBar-&gt;setIconSize(toolIconSize);   //设置工具栏图标大小\n\n\tQIcon newFileIcon(\":/images/新建文件.png\");\n\tQIcon openFileIcon(\":/images/打开文件.png\");\n\tQIcon saveFileIcon(\":/images/保存.png\");\n\tQIcon runIcon(\":/images/运行.png\");\n\tQIcon stopIcon(\":/images/停止.png\");\n\tQIcon debugIcon(\":/images/调试.png\");\n\tQIcon anaysisIcon(\":/images/分析.png\");\n\tQIcon recordIcon(\":/images/录制.png\");\n\tQIcon grabIcon(\":/images/抓取.png\");\n\tQIcon capacityIcon(\":/images/应用中心.png\");\n\tQIcon paramterIcon(\":/images/参数.png\");\n\tQIcon publishIcon(\":/images/发布.png\");\n\tQIcon exportIcon(\":/images/导出.png\");\n\n\tm_newAc = new QAction(newFileIcon, \"新建项目\", this);\n\tm_saveAc = new QAction(saveFileIcon, \"保存\", this);\n\tm_runAc = new QAction(runIcon, \"运行\", this);\n\tm_stopAc = new QAction(stopIcon, \"停止\", this);\n\tm_debugAc = new QAction(debugIcon, \"调试\", this);\n\tm_anaysisAc = new QAction(anaysisIcon, \"分析\", this);\n\tm_recordAc = new QAction(recordIcon, \"录制\", this);\n\tm_grabAc = new QAction(grabIcon, \"抓取\", this);\n\tm_capacityAc = new QAction(capacityIcon, \"能力中心\", this);\n\tm_paramterAc = new QAction(paramterIcon, \"参数\", this);\n\tm_publishAc = new QAction(publishIcon, \"发布\", this);\n\tm_exportAc = new QAction(exportIcon, \"导出\", this);\n\n\t//add QAction to Widget.\n\tui.mainToolBar-&gt;addAction(m_newAc);\n\tui.mainToolBar-&gt;addAction(m_saveAc);\n\tui.mainToolBar-&gt;addAction(m_saveAc);\n\tui.mainToolBar-&gt;addSeparator();\n\tui.mainToolBar-&gt;addAction(m_runAc);\n\tui.mainToolBar-&gt;addAction(m_stopAc);\n\tui.mainToolBar-&gt;addAction(m_debugAc);\n\tui.mainToolBar-&gt;addAction(m_anaysisAc);\n\tui.mainToolBar-&gt;addSeparator();\n\tui.mainToolBar-&gt;addAction(m_recordAc);\n\tui.mainToolBar-&gt;addAction(m_grabAc);\n\tui.mainToolBar-&gt;addSeparator();\n\tui.mainToolBar-&gt;addAction(m_capacityAc);\n\tui.mainToolBar-&gt;addSeparator();\n\tui.mainToolBar-&gt;addAction(m_paramterAc);\n\tui.mainToolBar-&gt;addAction(m_publishAc);\n\tui.mainToolBar-&gt;addAction(m_exportAc);\n\tui.mainToolBar-&gt;addSeparator();\n\n\tconnect(m_newAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_newProject);\n\tconnect(m_saveAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_saveFile);\n\tconnect(m_runAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_runAc);\n\tconnect(m_stopAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_stopAc);\n\tconnect(m_debugAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_debugAc);\n\tconnect(m_anaysisAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_anaysisAc);\n\tconnect(m_recordAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_recordAc);\n\tconnect(m_grabAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_grabAc);\n\tconnect(m_capacityAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_capacityAc);\n\tconnect(m_paramterAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_paramterAc);\n\tconnect(m_publishAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_publishAc);\n\tconnect(m_exportAc, &amp;QAction::triggered, this, &amp;QDockWidgetDemo::s_exportAc);\n}</code></pre>\n<h2 id=\"%C2%A02.2%E9%A1%B9%E7%9B%AE%E5%8C%BA\">3.2、项目区</h2>\n<pre><code>void QDockWidgetDemo::initProjectView() {\n\tif (NULL == m_projManagerView) {\n\t\tm_projManagerView = new QDockWidget(this);\n\t\tm_projManagerView-&gt;setFeatures(QDockWidget::DockWidgetClosable);    //显示关闭窗口按钮\n\t\tm_projManagerView-&gt;setWindowTitle(\"项目\");\n        this-&gt;addDockWidget(Qt::LeftDockWidgetArea, m_projManagerView, Qt::Orientation::Vertical);\t\t //设置锁定区域\n\n\t\tdelete title bar\n\t\t//QWidget* lTitleBar = m_projManagerView-&gt;titleBarWidget();\n\t\t//QWidget* lEmptyWidget = new QWidget();\n\t\t//m_projManagerView-&gt;setTitleBarWidget(lEmptyWidget);\n\t\t//delete lTitleBar;\n\n\t\tm_projectWin = new projectWin(this);\n\t\tm_projManagerView-&gt;setWidget(m_projectWin);      //添加内容窗口\n\n\t\tqDebug() &lt;&lt; \"项目区 id:\" &lt;&lt; m_projManagerView-&gt;winId() &lt;&lt; \", name:\" &lt;&lt; m_projManagerView-&gt;windowTitle();\n\t}\n}</code></pre>\n<h2 id=\"2.3%E3%80%81%E5%B1%9E%E6%80%A7%E5%8C%BA\">3.3、属性区</h2>\n<pre><code>void QDockWidgetDemo::initPropertyView() {\n\tif (NULL == m_propertyView) {\n\t\tm_propertyView = new QDockWidget(this);\n\t\tm_propertyView-&gt;setFeatures(QDockWidget::DockWidgetClosable);\n\t\tm_propertyView-&gt;setWindowTitle(\"属性区\");\n        this-&gt;addDockWidget(Qt::RightDockWidgetArea, m_propertyView, Qt::Orientation::Vertical);\n\n\t\tm_propertyWin = new propertyWin(this);\n\t\tm_propertyView-&gt;setWidget(m_propertyWin);\n\t\tqDebug() &lt;&lt; \"属性区 id:\" &lt;&lt; m_propertyView-&gt;winId() &lt;&lt; \", name:\" &lt;&lt; m_propertyView-&gt;windowTitle();\n\t}\n}</code></pre>\n<h2 id=\"%C2%A02.4%E3%80%81%E6%97%A5%E5%BF%97%E5%8C%BA\">3.4、日志区</h2>\n<pre><code>void QDockWidgetDemo::initLogView() {\n\tif (NULL == m_logView) {\n\t\tm_logView = new QDockWidget(this);\n\t\t//set dock widget feature: not move, enable close.\n\t\tm_logView-&gt;setFeatures(QDockWidget::DockWidgetClosable);\n\t\tm_logView-&gt;setWindowTitle(\"输出\");\n        this-&gt;addDockWidget(Qt::BottomDockWidgetArea, m_logView, Qt::Orientation::Vertical);\n\n\t\tm_logBody = new QTextEdit(this);\n\t\tm_logView-&gt;setWidget(m_logBody);\n\t}\n\n\tQPalette pl = m_logBody-&gt;palette();\n\tpl.setBrush(QPalette::Base, QBrush(QColor(255, 0, 0, 0)));\n\tm_logBody-&gt;setPalette(pl);\n}</code></pre>\n<h1 id=\"3%E3%80%81Demo%E6%95%88%E6%9E%9C\">4、Demo效果</h1>\n<p class=\"img-center\"><img alt=\"\" height=\"360\" src=\"https://img-blog.csdnimg.cn/c44d1ee361474fcd8d5747724be82a4b.gif\" width=\"640\"/></p>\n<h1 id=\"%C2%A04%E3%80%81Demo%E4%B8%8B%E8%BD%BD\">5、Demo下载</h1>\n<p>        csdn <span style=\"color:#fe2c24;\"><strong>0积分 </strong></span>下载：<a class=\"has-card\" href=\"https://download.csdn.net/download/ManagerUser/85496887\" title=\"Qt之QDockWidget实例Demo\"><span class=\"link-card-box\"><span class=\"link-title\">Qt之QDockWidget实例Demo</span><span class=\"link-link\"><img alt=\"icon-default.png?t=M4AD\" class=\"link-link-icon\" src=\"image\\icon-default.png\"/>https://download.csdn.net/download/ManagerUser/85496887</span></span></a></p>\n</div>\n</div>"}