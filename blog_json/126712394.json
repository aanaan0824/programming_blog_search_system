{"blogid": "126712394", "writerAge": "码龄7年", "writerBlogNum": "39", "writerCollect": "76", "writerComment": "14", "writerFan": "2126", "writerGrade": "3级", "writerIntegral": "433", "writerName": "sum墨", "writerProfileAdress": "writer_image\\profile_126712394.jpg", "writerRankTotal": "36128", "writerRankWeekly": "2935", "writerThumb": "25", "writerVisitNum": "28492", "blog_read_count": "74", "blog_time": "于 2022-09-05 20:51:50 发布", "blog_title": "SpringBoot整合Groovy脚本，实现动态编程", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night-eighties\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"Groovy_0\"></a>Groovy简介</h1>\n<p>Groovy 是增强 Java 平台的唯一的脚本语言。它提供了类似于 Java 的语法，内置映射（Map）、列表（List）、方法、类、闭包（closure）以及生成器。脚本语言不会替代系统编程语言，两者是相互补充的。</p>\n<p>大名鼎鼎的 Gradle，背后是 Groovy。Spring 的未来越来越多的使用 Groovy，甚至在用 Jira 跟踪项目时，背后也有 Groovy。实际上，就应用场景而言，Java 开发已经有越来越多的 Groovy 出现在后台了。而对于一般的应用开发，只要能用 Java 就都能用到 Groovy，唯一的难点只在于能不能招到足够的人员。</p>\n<h1><a id=\"_4\"></a>应用场景</h1>\n<ul><li>连接已有的组件</li><li>处理经常变化的多种类型的实体</li><li>具有图形化用户界面</li><li>拥有快速变化的功能</li></ul>\n<p><code>Groovy脚本的基础概念请移步</code></p>\n<p><a href=\"http://mvnbook.com/groovy-introduction.html\">Groovy 简介</a></p>\n<h1><a id=\"_15\"></a>集成与使用</h1>\n<p><strong>那么接下来介绍SpringBoot如何集成Groovy脚本，并应用到实际开发中。</strong></p>\n<h2><a id=\"SpringBoot_17\"></a>第一步、与SpringBoot集成</h2>\n<h3><a id=\"1pomxml_18\"></a>1、pom.xml文件如下：</h3>\n<pre><code class=\"prism language-xml\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>org.codehaus.groovy<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>groovy-all<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">&gt;</span></span>2.4.7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>org.springframework.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>spring-boot-starter-web<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<h2><a id=\"GroovyHello_World_30\"></a>第二步、写出Groovy版本的“Hello World”</h2>\n<h3><a id=\"1HelloWorldgroovy_31\"></a>1、HelloWorld.groovy脚本代码</h3>\n<pre><code class=\"prism language-groovy\"><span class=\"token keyword\">package</span> groovy\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">HelloWorld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n    println <span class=\"token string\">\"hello world\"</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"2GroovyTestjava_39\"></a>2、创建测试类GroovyTest.java</h3>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>service</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Script</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * 这个是Groovy的第一个小程序，脚本为：\n * \n package groovy\n \n def helloworld(){\n  println \"hello world\"\n }\n *\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GroovyTest</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//创建GroovyShell</span>\n        <span class=\"token class-name\">GroovyShell</span> groovyShell <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//装载解析脚本代码</span>\n        <span class=\"token class-name\">Script</span> script <span class=\"token operator\">=</span> groovyShell<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"package groovy\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"def HelloWorld(){\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    println \\\"hello world\\\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//执行</span>\n        script<span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HelloWorld\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h3><a id=\"3_73\"></a>3、运行结果</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\d485994b5ee64b46b34f5d1c9f06fad7.png\"/></p>\n<h2><a id=\"_75\"></a>第三步、传入变量与获取返回值</h2>\n<h3><a id=\"1Groovy_76\"></a>1、变量与返回值Groovy脚本代码</h3>\n<pre><code class=\"prism language-groovy\"><span class=\"token keyword\">package</span> groovy\n\n<span class=\"token comment\">/**\n * 简易加法\n * @param a 数字a\n * @param b 数字b\n * @return 和\n */</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> a<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> b<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * map转化为String\n * @param paramMap 参数map\n * @return 字符串\n */</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">mapToString</span><span class=\"token punctuation\">(</span>Map<span class=\"token operator\">&lt;</span>String<span class=\"token punctuation\">,</span> String<span class=\"token operator\">&gt;</span> paramMap<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    StringBuilder stringBuilder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StringBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    paramMap<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span> key<span class=\"token punctuation\">,</span> value <span class=\"token operator\">-&gt;</span>\n        stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"key:\"</span> <span class=\"token operator\">+</span> key <span class=\"token operator\">+</span> <span class=\"token string\">\";value:\"</span> <span class=\"token operator\">+</span> value<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"2GroovyTest2java_103\"></a>2、创建测试类GroovyTest2.java</h3>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>service</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Script</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HashMap</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * 向Groovy脚本中传入变量，以及获取返回值\n */</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GroovyTest2</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//创建GroovyShell</span>\n        <span class=\"token class-name\">GroovyShell</span> groovyShell <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//装载解析脚本代码</span>\n        <span class=\"token class-name\">Script</span> script <span class=\"token operator\">=</span> groovyShell<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"package groovy\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"/**\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * 简易加法\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * @param a 数字a\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * @param b 数字b\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * @return 和\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" */\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"def add(int a, int b) {\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    return a + b\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"}\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"/**\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * map转化为String\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * @param paramMap 参数map\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * @return 字符串\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" */\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"def mapToString(Map&lt;String, String&gt; paramMap) {\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    StringBuilder stringBuilder = new StringBuilder();\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    paramMap.forEach({ key, value -&gt;\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"        stringBuilder.append(\\\"key:\\\" + key + \\\";value:\\\" + value)\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    })\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    return stringBuilder.toString()\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//执行加法脚本</span>\n        <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> params1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> sum <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> script<span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"add\"</span><span class=\"token punctuation\">,</span> params1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a加b的和为:\"</span> <span class=\"token operator\">+</span> sum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//执行解析脚本</span>\n        <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">&gt;</span></span> paramMap <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">&gt;</span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        paramMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"科目1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        paramMap<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"科目2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"数学\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> params2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">{<!-- --></span>paramMap<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">String</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">)</span> script<span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mapToString\"</span><span class=\"token punctuation\">,</span> params2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"mapToString:\"</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"3_159\"></a>3、运行结果</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a1d963d049d441bbb320d0013a2ad740.png\"/></p>\n<h2><a id=\"SpringBootGroovySpringContextUtilSpringBootBean_161\"></a>第四步、启动SpringBoot，在Groovy脚本中通过SpringContextUtil获取SpringBoot容器中的Bean</h2>\n<h3><a id=\"1SpringContextUtiljava_162\"></a>1、创建SpringContextUtil.java</h3>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>util</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>beans<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">BeansException</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ApplicationContext</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ApplicationContextAware</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Component</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Spring上下文获取\n */</span>\n<span class=\"token annotation punctuation\">@Component</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringContextUtil</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ApplicationContextAware</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">ApplicationContext</span> applicationContext<span class=\"token punctuation\">;</span>\n\n    <span class=\"token annotation punctuation\">@Override</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ApplicationContext</span> applicationContext<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">BeansException</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">SpringContextUtil</span><span class=\"token punctuation\">.</span>applicationContext <span class=\"token operator\">=</span> applicationContext<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">ApplicationContext</span> <span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> applicationContext<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * 通过name获取 Bean.\n     *\n     * @param name\n     * @return\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * 通过class获取Bean.\n     *\n     * @param clazz\n     * @param &lt;T&gt;\n     * @return\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token class-name\">T</span> <span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">&gt;</span></span> clazz<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span>clazz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n     * 通过name,以及Clazz返回指定的Bean\n     *\n     * @param name\n     * @param clazz\n     * @param &lt;T&gt;\n     * @return\n     */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">&gt;</span></span> <span class=\"token class-name\">T</span> <span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Class</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">&gt;</span></span> clazz<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">getApplicationContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> clazz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"2GroovyTestServicejavaServiceSpringBoot_222\"></a>2、创建GroovyTestService.java，并加上@Service注解加入到SpringBoot容器中</h3>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>service</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Service</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GroovyTestService</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"我是SpringBoot框架的成员类，但该方法由Groovy脚本调用\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"3Groovy_237\"></a>3、Groovy脚本如下</h3>\n<pre><code class=\"prism language-groovy\"><span class=\"token keyword\">package</span> groovy\n\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">.</span>GroovyTestService\n<span class=\"token keyword\">import</span> com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span>SpringContextUtil\n\n<span class=\"token comment\">/**\n * 静态变量\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Globals</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">static</span> String PARAM1 <span class=\"token operator\">=</span> <span class=\"token string\">\"静态变量\"</span>\n    <span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> arrayList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    GroovyTestService groovyTestService <span class=\"token operator\">=</span> SpringContextUtil<span class=\"token punctuation\">.</span><span class=\"token function\">getBean</span><span class=\"token punctuation\">(</span>GroovyTestService<span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    groovyTestService<span class=\"token punctuation\">.</span><span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"4_257\"></a>4、启动类代码如下</h3>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example<span class=\"token punctuation\">.</span>springbootgroovy</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">groovy<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Script</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>autoconfigure<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringBootApplication</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Controller</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RequestMapping</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RestController</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token annotation punctuation\">@RestController</span>\n<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/groovy\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@SpringBootApplication</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SpringBootGroovyApplication</span> <span class=\"token punctuation\">{<!-- --></span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">SpringBootGroovyApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/test\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">test</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//创建GroovyShell</span>\n        <span class=\"token class-name\">GroovyShell</span> groovyShell <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GroovyShell</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//装载解析脚本代码</span>\n        <span class=\"token class-name\">Script</span> script <span class=\"token operator\">=</span> groovyShell<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"package groovy\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"import com.example.springbootgroovy.service.GroovyTestService\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"import com.example.springbootgroovy.util.SpringContextUtil\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"/**\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" * 静态变量\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\" */\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"class Globals {\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    static String PARAM1 = \\\"静态变量\\\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    static int[] arrayList = [1, 2]\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"}\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"def getBean() {\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    GroovyTestService groovyTestService = SpringContextUtil.getBean(GroovyTestService.class);\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"    groovyTestService.test()\\n\"</span> <span class=\"token operator\">+</span>\n                <span class=\"token string\">\"}\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token comment\">//执行</span>\n        script<span class=\"token punctuation\">.</span><span class=\"token function\">invokeMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"getBean\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"ok\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h3><a id=\"5httplocalhost8080groovytest_307\"></a>5、启动后调用接口：http://localhost:8080/groovy/test，运行结果如下</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\44d41b9201b24ad4b2c639d9cb974675.png\"/></p>\n<h1><a id=\"_309\"></a>注意！！！</h1>\n<p><code>通过第四步中我们可以看到，在Groovy中是可以获取到SpringBoot容器对象的。虽然很方便，但是很危险。如果没有做好权限控制，Groovy脚本将会成为攻击你系统最有力的武器！！！</code></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}