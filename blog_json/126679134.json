{"blogid": "126679134", "writerAge": "码龄7年", "writerBlogNum": "60", "writerCollect": "601", "writerComment": "677", "writerFan": "1274", "writerGrade": "5级", "writerIntegral": "2401", "writerName": "Pushkin.", "writerProfileAdress": "writer_image\\profile_126679134.jpg", "writerRankTotal": "9234", "writerRankWeekly": "148", "writerThumb": "567", "writerVisitNum": "72578", "blog_read_count": "7609", "blog_time": "于 2022-09-03 17:01:05 发布", "blog_title": "Python版中秋佳节月饼抢购脚本", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\27105e9c4bb640a8b24cb92a08f80b1d.jpeg\"/></p>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_5\">申明</a></li><li><a href=\"#_12\">前言</a></li><li><a href=\"#_17\">原理</a></li><li><a href=\"#_Selenium_24\">安装 Selenium</a></li><li><ul><li><a href=\"#1_25\">方式1</a></li><li><a href=\"#2_30\">方式2</a></li></ul>\n</li><li><a href=\"#_40\">安装浏览器驱动</a></li><li><ul><li><a href=\"#_41\">下载</a></li><li><a href=\"#_47\">配置环境变量</a></li></ul>\n</li><li><a href=\"#_53\">代码开发</a></li><li><a href=\"#_131\">测试</a></li><li><a href=\"#_159\">注意</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_5\"></a>申明</h1>\n<p><strong>本博客不提供任何服务器端程序，也不提供任何收费抢购软件。<br/> 该博客仅用于学习selenium自动化工具。<br/> 如有侵犯到任何公司的合法权益，请私信我，会第一时间删除相关代码。</strong></p>\n<h1><a id=\"_12\"></a>前言</h1>\n<p>每逢节假日是不是有小伙伴总是感叹自己手速不如人呢？明明喜欢的东西下一秒就售罄了，不要怀疑自己的手速，有时候你不知道和你一起下单的是人还是脚本哦。<br/> 今天就给大家分享一个python版抢购月饼的脚本，我们要用魔法打败魔法！话不多说，说干就干。</p>\n<h1><a id=\"_17\"></a>原理</h1>\n<p>今天要用的是一个测试工具的库：Selenium<br/> Selenium是一个用于测试网站的自动化测试工具，支持各种浏览器包括Chrome、Firefox、Safari等主流界面浏览器，同时也支持phantomJS无界面浏览器。<br/> 它支持多种操作系统如Windows、Linux、IOS、Android等。<br/> 今天我们就是用它去实现自动化抢购月饼，其实就是用这个工具\"模拟\"人为操作浏览器相应的操作，比如登陆，勾选购物车商品，下单购买等等操作。</p>\n<h1><a id=\"_Selenium_24\"></a>安装 Selenium</h1>\n<h2><a id=\"1_25\"></a>方式1</h2>\n<pre><code>pip install Selenium\n</code></pre>\n<h2><a id=\"2_30\"></a>方式2</h2>\n<p>pip 安装不成功的话，可以使用pycharm工具进行下载</p>\n<p>国内可以采用以下这些数据源：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b70ec655636c4ebf83103a4269234f01.png\"/><br/> 选择一个可用的数据源的Selenium进行</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\d39def65cd48465099e4217c91fae99a.png\"/></p>\n<h1><a id=\"_40\"></a>安装浏览器驱动</h1>\n<h2><a id=\"_41\"></a>下载</h2>\n<p>Selenium3.x调用浏览器必须有一个webdriver驱动文件, 选择以下 对应系统的chrome进行下载即可<br/> <a href=\"https://chromedriver.storage.googleapis.com/index.html?path=2.35/\">Chrome驱动文件下载</a></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\979ed9ebb9ce47298925b21c0173f63f.png\"/></p>\n<h2><a id=\"_47\"></a>配置环境变量</h2>\n<p>我的电脑–&gt;属性–&gt;系统设置–&gt;高级–&gt;环境变量–&gt;系统变量–&gt;Path，<br/> 将你下载chromexxx.zip文件的目录添加到Path的值中。比如：Path字段 F:\\download</p>\n<h1><a id=\"_53\"></a>代码开发</h1>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># !/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># 2022/09/03</span>\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">import</span> datetime\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Seckill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>startTime<span class=\"token punctuation\">,</span> choose<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>startTime <span class=\"token operator\">=</span> startTime\n        self<span class=\"token punctuation\">.</span>choose <span class=\"token operator\">=</span> choose\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>browser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        browser<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://www.taobao.com\"</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">\"亲，请登录\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">\"亲，请登录\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请在15秒内完成扫码\"</span><span class=\"token punctuation\">)</span>\n            time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span>\n            browser<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://cart.taobao.com/cart.htm\"</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n        now <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'登陆成功:'</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%d %H:%M:%S'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">buy</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>browser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>choose <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请手动在浏览器中勾选需要秒杀的商品\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n            now <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%d %H:%M:%S.%f'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># 对比时间，时间到的话就点击结算</span>\n            <span class=\"token keyword\">if</span> now <span class=\"token operator\">&gt;</span> self<span class=\"token punctuation\">.</span>startTime<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>choose <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token keyword\">if</span> browser<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"J_SelectAll2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                                browser<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">\"J_SelectAll2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                                <span class=\"token keyword\">break</span>\n                        <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n                            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error : cant find buy button\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token comment\"># 点击结算按钮</span>\n                <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">if</span> browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">\"结 算\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                            browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">\"结 算\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"结算成功\"</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token keyword\">break</span>\n                    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">pass</span>\n                <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">if</span> browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">'提交订单'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                            browser<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">'提交订单'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                            now1 <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%d %H:%M:%S.%f'</span><span class=\"token punctuation\">)</span>\n                            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"抢购成功时间：%s\"</span> <span class=\"token operator\">%</span> now1<span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n                        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"再次尝试提交订单\"</span><span class=\"token punctuation\">)</span>\n                time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    pkTime <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入秒杀时间，格式如(2022-09-03 15:40:00.000000):\"</span><span class=\"token punctuation\">)</span>\n    choose <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"到时间自动勾选购物车请输入“1”，否则输入“2”：\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    browser <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    browser<span class=\"token punctuation\">.</span>maximize_window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sk <span class=\"token operator\">=</span> Seckill<span class=\"token punctuation\">(</span>pkTime<span class=\"token punctuation\">,</span> choose<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># step1: 登陆</span>\n    sk<span class=\"token punctuation\">.</span>login<span class=\"token punctuation\">(</span>browser<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># step2: 购买</span>\n    sk<span class=\"token punctuation\">.</span>buy<span class=\"token punctuation\">(</span>browser<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"_131\"></a>测试</h1>\n<pre><code>请输入抢购时间，格式如(2022-09-03 15:40:00.000000):2022-09-03 16:17:00.000000\n到时间自动勾选购物车请输入“1”，否则输入“2”：1\n请在15秒内完成扫码\n登陆成功: 2022-09-03 16:14:45\n结算成功\n再次尝试提交订单\n再次尝试提交订单\n再次尝试提交订单\n再次尝试提交订单\n再次尝试提交订单\n再次尝试提交订单\n再次尝试提交订单\n抢购成功时间：2022-09-03 16:17:15.498106\n</code></pre>\n<p>输入抢购时间后,会自动弹出测试的浏览器界面,自动调整到登录界面,此时需要你自己操作进行登录:<br/> <img alt=\"在这里插入图片描述\" src=\"image\\bbb50f38ec294b76a5fd94c465bca46b.png\"/><br/> 登录后,跳转到购物车:<br/> 如果你选择的是自动化勾选购物车就不需要手动勾选,等程序自己勾选 (不建议选择自动勾选),<br/> 建议选择手动勾选<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ffd162f886124e4e94d8ca47c4bdfb31.png\"/><br/> 等到你指定抢购时间的时候,该脚本会在1毫秒内进行抢购,下单并跳转到支付页面,等待你的付款</p>\n<h1><a id=\"_159\"></a>注意</h1>\n<p>注意:</p>\n<ul><li>测试时,到时间自动勾选购物车请输入“1”，否则输入“2”,这个选项最好选择为2 (如果选择为1,且你的购物车商品比较多,会自动全部勾选进行抢购了)</li><li>抢购时间选择大于当前时间</li></ul>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}