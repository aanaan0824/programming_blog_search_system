{"blogid": "126337429", "writerAge": "ç é¾„1å¹´", "writerBlogNum": "72", "writerCollect": "2610", "writerComment": "4589", "writerFan": "8349", "writerGrade": "6çº§", "writerIntegral": "8328", "writerName": "codeMak1r.å°æ–°", "writerProfileAdress": "writer_image\\profile_126337429.jpg", "writerRankTotal": "1737", "writerRankWeekly": "13", "writerThumb": "2774", "writerVisitNum": "208529", "blog_read_count": "1312", "blog_time": "äºÂ 2022-08-30 08:30:00Â å‘å¸ƒ", "blog_title": "Vue/Reactå®ç°è·¯ç”±é‰´æƒ/å¯¼èˆªå®ˆå«/è·¯ç”±æ‹¦æˆª(react-router v6)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"https://img-blog.csdnimg.cn/97e771e243f54675b3128989d52f551f.gif#pic_center\"/></p>\n<blockquote>\n<p><strong><font color=\"#FF7F50\"> æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢</font></strong><br/> <strong>ğŸ“”åšä¸»æ˜¯ä¸€åå¤§å­¦åœ¨è¯»æœ¬ç§‘ç”Ÿï¼Œä¸»è¦å­¦ä¹ æ–¹å‘æ˜¯å‰ç«¯ã€‚<br/> ğŸ­ç›®å‰å·²ç»æ›´æ–°äº†<font color=\"#FF7F50\">ã€Vueã€‘ã€ã€Reactâ€“ä»åŸºç¡€åˆ°å®æˆ˜ã€‘ã€ã€TypeScriptã€‘ç­‰ç­‰ç³»åˆ—ä¸“æ </font><br/> ğŸ› ç›®å‰æ­£åœ¨å­¦ä¹ çš„æ˜¯ğŸ”¥<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          R\n         \n         \n          e\n         \n         \n          a\n         \n         \n          c\n         \n         \n          t\n         \n         \n          æ¡†æ¶\n         \n        \n        \n         Reactæ¡†æ¶\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0077em;\">R</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mord cjk_fallback\">æ¡†æ¶</span></span></span></span></span>ğŸ”¥ï¼Œä¸­é—´ç©¿æ’äº†ä¸€äº›åŸºç¡€çŸ¥è¯†çš„å›é¡¾<br/> ğŸŒˆåšå®¢ä¸»é¡µğŸ‘‰<a href=\"https://blog.csdn.net/Svik_zy?type=blog\">codeMak1r.å°æ–°çš„åšå®¢</a></strong></p>\n<p></p>\n<div class=\"toc\">\n<h3>ğŸ˜‡æœ¬æ–‡ç›®å½•ğŸ˜‡</h3>\n<ul><li><a href=\"#_15\">è·¯ç”±å¯¼èˆªå®ˆå«</a></li><li><a href=\"#1_React_19\">1. Reacté¡¹ç›®ä¸­</a></li><li><a href=\"#2_Vue_107\">2. Vueé¡¹ç›®ä¸­</a></li></ul>\n</div>\n<p></p>\n<p><strong><font color=\"#FF7F50\">æœ¬æ–‡è¢«ä¸“æ <a href=\"https://blog.csdn.net/svik_zy/category_11671445.html?spm=1001.2014.3001.5482\">ã€Reactâ€“ä»åŸºç¡€åˆ°å®æˆ˜ã€‘</a>æ”¶å½•</font></strong></p>\n</blockquote>\n<blockquote>\n<p><strong><font color=\"#FF7F50\">ğŸ•¹åšæŒåˆ›ä½œâœï¸ï¼Œä¸€èµ·å­¦ä¹ ğŸ“–ï¼Œç å‡ºæœªæ¥ğŸ‘¨ğŸ»â€ğŸ’»ï¼</font></strong></p>\n</blockquote>\n<h1><a id=\"_15\"></a>è·¯ç”±å¯¼èˆªå®ˆå«</h1>\n<p><code>æœ¬èŠ‚ç›®æ ‡:</code> èƒ½å¤Ÿå®ç°æœªç™»å½•æ—¶è®¿é—®æ‹¦æˆªå¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼ˆè·¯ç”±é‰´æƒå®ç°ï¼‰</p>\n<h1><a id=\"1_React_19\"></a>1. Reacté¡¹ç›®ä¸­</h1>\n<p><strong>å®ç°æ€è·¯</strong></p>\n<p>è‡ªå·±å°è£… <code>AuthRoute</code> è·¯ç”±é‰´æƒé«˜é˜¶ç»„ä»¶ï¼Œå®ç°æœªç™»å½•æ‹¦æˆªï¼Œå¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢</p>\n<p>æ€è·¯ä¸ºï¼šåˆ¤æ–­æœ¬åœ°æ˜¯å¦æœ‰tokenï¼Œå¦‚æœæœ‰ï¼Œå°±è¿”å›å­ç»„ä»¶ï¼Œå¦åˆ™å°±é‡å®šå‘åˆ°ç™»å½•Login</p>\n<p><strong>å®ç°æ­¥éª¤</strong></p>\n<ol><li>åœ¨ components ç›®å½•ä¸­ï¼Œåˆ›å»º AuthRoute/index.js æ–‡ä»¶</li><li>åˆ¤æ–­æ˜¯å¦ç™»å½•</li><li>ç™»å½•æ—¶ï¼Œç›´æ¥æ¸²æŸ“ç›¸åº”é¡µé¢ç»„ä»¶</li><li>æœªç™»å½•æ—¶ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢</li><li>å°†éœ€è¦é‰´æƒçš„é¡µé¢è·¯ç”±é…ç½®ï¼Œæ›¿æ¢ä¸º AuthRoute ç»„ä»¶æ¸²æŸ“</li></ol>\n<p><strong>ä»£ç å®ç°</strong></p>\n<p>components/AuthRoute/index.js</p>\n<pre><code class=\"prism language-js\"><span class=\"token comment\">// è·¯ç”±é‰´æƒ</span>\n<span class=\"token comment\">// 1. åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨</span>\n<span class=\"token comment\">// 2. å¦‚æœå­˜åœ¨ ç›´æ¥æ­£å¸¸æ¸²æŸ“</span>\n<span class=\"token comment\">// 3. å¦‚æœä¸å­˜åœ¨ é‡å®šå‘åˆ°ç™»å½•è·¯ç”±</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{<!-- --></span> Navigate <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-router-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{<!-- --></span> getToken <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/utils\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// é«˜é˜¶ç»„ä»¶:æŠŠä¸€ä¸ªç»„ä»¶å½“æˆå¦å¤–ä¸€ä¸ªç»„ä»¶çš„å‚æ•°ä¼ å…¥ ç„¶åé€šè¿‡ä¸€å®šçš„åˆ¤æ–­ è¿”å›æ–°çš„ç»„ä»¶</span>\n<span class=\"token comment\">// è¿™é‡Œçš„AuthRouteå°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">AuthRoute</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{<!-- --></span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token comment\">// è·å–token</span>\n  <span class=\"token keyword\">const</span> tokenStr <span class=\"token operator\">=</span> <span class=\"token function\">getToken</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// å¦‚æœtokenå­˜åœ¨ ç›´æ¥æ­£å¸¸æ¸²æŸ“</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tokenStr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">{<!-- --></span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// å¦‚æœtokenä¸å­˜åœ¨ï¼Œé‡å®šå‘åˆ°ç™»å½•è·¯ç”±</span>\n  <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Navigate to<span class=\"token operator\">=</span><span class=\"token string\">'/login'</span> replace <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{<!-- --></span><span class=\"token comment\">/*\n &lt;AuthRoute&gt; &lt;Layout /&gt; &lt;/AuthRoute&gt; \n ç™»å½•ï¼š&lt;&gt; &lt;Layout /&gt; &lt;/&gt;\n éç™»å½•ï¼š&lt;Navigate to=\"/login\" replace /&gt;\n*/</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token punctuation\">{<!-- --></span> AuthRoute <span class=\"token punctuation\">}</span>\n</code></pre>\n<blockquote>\n<p>æ³¨ï¼šutilså·¥å…·å‡½æ•°<code>getToken</code>å¦‚ä¸‹</p>\n<pre><code class=\"prism language-js\"><span class=\"token comment\">// ä»localstorageä¸­å–token</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getToken</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n<span class=\"token keyword\">return</span> window<span class=\"token punctuation\">.</span>localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n</blockquote>\n<p>src/routes/index.jsè·¯ç”±è¡¨æ–‡ä»¶</p>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/pages/Layout\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Login <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/pages/Login\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{<!-- --></span> AuthRoute <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@/components/AuthRoute\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// eslint-disable-next-line</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token comment\">// ä¸éœ€è¦é‰´æƒçš„ç»„ä»¶Login</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">element</span><span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span>Login <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// éœ€è¦é‰´æƒçš„ç»„ä»¶Layout</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">element</span><span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span>AuthRoute<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>Layout <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>AuthRoute<span class=\"token operator\">&gt;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n</code></pre>\n<h1><a id=\"2_Vue_107\"></a>2. Vueé¡¹ç›®ä¸­</h1>\n<p><strong>å®ç°æ€è·¯</strong></p>\n<p>åœ¨Vueçš„routerè·¯ç”±è¡¨æ–‡ä»¶ä¸­ï¼Œå­˜åœ¨å®˜æ–¹å°è£…å¥½çš„APIï¼š<code>beforeEach</code>ã€‚</p>\n<p><strong>ä»£ç å®ç°</strong></p>\n<p>/src/router/index.js</p>\n<pre><code class=\"prism language-javascript\"><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span>\n<span class=\"token keyword\">import</span> VueRouter <span class=\"token keyword\">from</span> <span class=\"token string\">'vue-router'</span>\n<span class=\"token comment\">// è·¯ç”±æ‡’åŠ è½½</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Login</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"login_home_welcome\" */</span> <span class=\"token string\">'../components/Login.vue'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Home</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"login_home_welcome\" */</span> <span class=\"token string\">'../components/Home.vue'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Welcome</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"login_home_welcome\" */</span> <span class=\"token string\">'../components/Welcome.vue'</span><span class=\"token punctuation\">)</span>\nVue<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>VueRouter<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> routes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/login'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> Login\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">redirect</span><span class=\"token operator\">:</span> <span class=\"token string\">'/login'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/home'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> Home<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">redirect</span><span class=\"token operator\">:</span> <span class=\"token string\">'/welcome'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/welcome\"</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> Welcome <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">VueRouter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span>\n  routes\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// æŒ‚è½½è·¯ç”±å¯¼èˆªå®ˆå«</span>\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">beforeEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">to<span class=\"token punctuation\">,</span> from<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token comment\">// toä»£è¡¨å°†è¦è®¿é—®çš„è·¯å¾„</span>\n  <span class=\"token comment\">// fromä»£è¡¨ä»å“ªä¸ªè·¯å¾„è·³è½¬è€Œæ¥</span>\n  <span class=\"token comment\">// nextæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºæ”¾è¡Œ</span>\n  <span class=\"token comment\">//    next() æ”¾è¡Œ   next('/login') å¼ºåˆ¶è·³è½¬åˆ°loginé¡µé¢</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">.</span>path <span class=\"token operator\">===</span> <span class=\"token string\">'/login'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// è·å–token</span>\n  <span class=\"token keyword\">const</span> tokenStr <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>sessionStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'token'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>tokenStr<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/login'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> router\n</code></pre>\n<blockquote>\n<p>ä»£ç è§£é‡Šï¼š<br/> <code>router.beforeEach</code>ç”¨æ¥è®¾ç½®Vueçš„è·¯ç”±å¯¼èˆªå®ˆå«ï¼ˆè·¯ç”±æ‹¦æˆªï¼‰ï¼Œå…¶æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚<br/> åœ¨å›è°ƒå‡½æ•°å†…éƒ¨ï¼Œæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œé¡ºåºåˆ†åˆ«æ˜¯ï¼š<code>to , from , next</code>ã€‚<br/> <strong>toä»£è¡¨å°†è¦è®¿é—®çš„è·¯å¾„</strong><br/> <strong>fromä»£è¡¨ä»å“ªä¸ªè·¯å¾„è·³è½¬è€Œæ¥</strong><br/> <strong>nextæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¡¨ç¤ºæ”¾è¡Œ</strong><br/> <code>next() =&gt; æ”¾è¡Œ</code> ï¼Œ <code>next('/login') =&gt; å¼ºåˆ¶è·³è½¬åˆ°loginé¡µé¢</code></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}