{"blogid": "124404238", "writerAge": "码龄1年", "writerBlogNum": "7", "writerCollect": "73", "writerComment": "7", "writerFan": "227", "writerGrade": "2级", "writerIntegral": "134", "writerName": "努力做好AC吧", "writerProfileAdress": "writer_image\\profile_124404238.jpg", "writerRankTotal": "70647", "writerRankWeekly": "488791", "writerThumb": "39", "writerVisitNum": "24689", "blog_read_count": "979", "blog_time": "已于 2022-04-25 21:12:20 修改", "blog_title": "winform登陆功能案例", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_4\">前言</a></li><li><a href=\"#_10\">一、问题描述</a></li><li><a href=\"#_17\">二、解题思路</a></li><li><ul><li><a href=\"#1_18\">1.登录界面设计</a></li><li><a href=\"#2_20\">2.数据库</a></li><li><a href=\"#3_23\">3.登录</a></li></ul>\n</li><li><a href=\"#_30\">三、功能实现</a></li><li><ul><li><a href=\"#1_31\">1.链接数据库</a></li><li><a href=\"#2_73\">2.验证登录信息功能的函数</a></li><li><a href=\"#3_106\">3.实现验证码功能</a></li><li><ul><li><a href=\"#_107\">写一个类用于创建验证码</a></li><li><a href=\"#_209\">更新验证码的方法</a></li><li><a href=\"#_221\">写一个方法调用验证码类和验证验证码</a></li></ul>\n</li><li><a href=\"#4_258\">4.保存账号及密码功能的实现</a></li><li><ul><li><a href=\"#APPconfig_259\">在APP.config中先创建键值对用于储存复选框状态以及记录账号信息</a></li><li><a href=\"#_274\">写一个用于记录账号信息的方法</a></li><li><a href=\"#_296\">在窗体加载的同时写入储存的登录信息</a></li></ul>\n</li><li><a href=\"#5_309\">5.在点击登录时实现这些功能</a></li><li><ul><li><a href=\"#_310\">验证登录信息</a></li><li><a href=\"#_343\">登录功能的实现</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_375\">四、登录页面完整代码：</a></li><li><a href=\"#_535\">五、运行结果截图</a></li><li><ul><li><a href=\"#_536\">正确账号密码登录</a></li><li><a href=\"#_539\">错误账号，错误密码登录</a></li><li><a href=\"#3_541\">错误3次后显示验证码</a></li><li><a href=\"#_544\">验证码错误</a></li><li><a href=\"#_546\">验证码正确</a></li><li><a href=\"#_548\">记住密码后登录</a></li></ul>\n</li><li><a href=\"#_550\">总结</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<h1><a id=\"_4\"></a>前言</h1>\n<p>使用.Net 平台来创建一个应用程序，包含验证登录账号密码功能，验证验证码功能，记住账号功能以及根据登录账号权限不同，跳转到不同界面的功能。<br/> 数据库使用sqlserver数据库</p>\n<hr/>\n<h1><a id=\"_10\"></a>一、问题描述</h1>\n<ol><li>连接数据库，实现对数据的读取操作</li><li>管理人员使用账号与密码登录系统。本系统的管理员包括 3 种类型</li><li>若管理员的登录失败次数达到 3 次，那么系统应显示并且同时包含字母与数字的4位验证码，验证码字符输入正确方可登录。</li><li>若管理员的登录失败次数达到 3 次，那么系统应显示并且同时包含字母与数字的4位验证码，验证码字符输入正确方可登录。</li><li>若选择记住密码，下次登录时直接显示上次输入的账号和密码，</li></ol>\n<h1><a id=\"_17\"></a>二、解题思路</h1>\n<h2><a id=\"1_18\"></a>1.登录界面设计</h2>\n<p><img alt=\"登录界面\" src=\"image\\e719cd2ecbc54820817530eb993c13d8.png\"/></p>\n<h2><a id=\"2_20\"></a>2.数据库</h2>\n<p>需要连接SQL server数据库，则需要创建一个用于链接数据库的类，在登录界面代码中调用。</p>\n<h2><a id=\"3_23\"></a>3.登录</h2>\n<p>登录功能的大致内容为</p>\n<ol><li>验证登录账号和密码</li><li>获取登录账号的权限（以数字代表权限，一共有三种权限，分别是1，2，3）</li><li>若验证错误次数超过三次，则生成验证码</li><li>判断用户是否勾选记住账号</li></ol>\n<h1><a id=\"_30\"></a>三、功能实现</h1>\n<h2><a id=\"1_31\"></a>1.链接数据库</h2>\n<p>创建一个server_connection1.cs的类文件，用于链接数据库</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">OlympicManagement</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">server_connection1</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\">SqlConnection</span> <span class=\"token function\">connection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> conStr <span class=\"token operator\">=</span> <span class=\"token string\">\"Server = localhost; Database = text; User ID = sa; Password = 123456; Trusted_Connection = False;\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> sqlcon <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>conStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            sqlcon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> sqlcon<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\">SqlCommand</span> <span class=\"token function\">command</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlCommand</span> sqlcom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> <span class=\"token function\">connection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> sqlcom<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//用于delete update insert 返回受影响行数</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> <span class=\"token function\">Excute</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">command</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">// 用于select，返回SqldataReader对象，包含select到的数据</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\">SqlDataReader</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">command</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h2><a id=\"2_73\"></a>2.验证登录信息功能的函数</h2>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">bool</span></span> <span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//验证登录账号密码以及验证码</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名和密码不能为空\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Warning<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//链接数据库验证</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from Staff where LoginID = '\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"' and Password = '\"</span> <span class=\"token operator\">+</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">server_connection1</span> ser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">server_connection1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">IDataReader</span> reader <span class=\"token operator\">=</span> ser<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token comment\">//获取登录账号类型</span>\n                    login_role <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">[</span><span class=\"token string\">\"RoleID\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>login_role<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">//查询到结果允许登录</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"密码或用户名不正确\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                reader<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"3_106\"></a>3.实现验证码功能</h2>\n<h3><a id=\"_107\"></a>写一个类用于创建验证码</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Drawing</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">OlympicManagement</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">VrefiyCode</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">///生成随机验证字符串</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> <span class=\"token function\">CreateRandomCode</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> CodeLength<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> rand<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">char</span></span> code<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> randomCode <span class=\"token operator\">=</span> String<span class=\"token punctuation\">.</span>Empty<span class=\"token punctuation\">;</span><span class=\"token comment\">//随机验证码</span>\n            <span class=\"token comment\">//生成特定长度的验证码</span>\n            <span class=\"token class-name\">Random</span> random <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> CodeLength<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                rand <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rand <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    code <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token char\">'A'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>rand <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//随机取字母</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rand <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    code <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token char\">'a'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>rand <span class=\"token operator\">%</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    code <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token char\">'0'</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>rand <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                randomCode <span class=\"token operator\">+=</span> code<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> randomCode<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">///创建图片</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">CreateImage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> strValidCode<span class=\"token punctuation\">,</span> <span class=\"token class-name\">PictureBox</span> pbox<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> RandAnlge <span class=\"token operator\">=</span> <span class=\"token number\">45</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//旋转角度</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> MapWidth <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>strValidCode<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">*</span> <span class=\"token number\">21</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">Bitmap</span> map <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Bitmap</span><span class=\"token punctuation\">(</span>MapWidth<span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建图片背景</span>\n\n                <span class=\"token class-name\">Graphics</span> graph <span class=\"token operator\">=</span> Graphics<span class=\"token punctuation\">.</span><span class=\"token function\">FromImage</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                graph<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span>Color<span class=\"token punctuation\">.</span>AliceBlue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//清除话画面，填充背景颜色</span>\n                graph<span class=\"token punctuation\">.</span><span class=\"token function\">DrawRectangle</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Pen</span><span class=\"token punctuation\">(</span>Color<span class=\"token punctuation\">.</span>Black<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">.</span>Width <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">.</span>Height <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//画一个边框</span>\n                graph<span class=\"token punctuation\">.</span>SmoothingMode <span class=\"token operator\">=</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Drawing2D<span class=\"token punctuation\">.</span>SmoothingMode<span class=\"token punctuation\">.</span>AntiAlias<span class=\"token punctuation\">;</span><span class=\"token comment\">//模式</span>\n                <span class=\"token class-name\">Random</span> rand <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//背景噪点生成</span>\n                <span class=\"token class-name\">Pen</span> blackPen <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Pen</span><span class=\"token punctuation\">(</span>Color<span class=\"token punctuation\">.</span>LightGray<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> x <span class=\"token operator\">=</span> rand<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">.</span>Width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> y <span class=\"token operator\">=</span> rand<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> map<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">DrawRectangle</span><span class=\"token punctuation\">(</span>blackPen<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token comment\">//验证码选装防止机器识别</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">char</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> chars <span class=\"token operator\">=</span> strValidCode<span class=\"token punctuation\">.</span><span class=\"token function\">ToCharArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//拆散字符串组成单字符数组</span>\n                <span class=\"token comment\">//文字居中</span>\n                <span class=\"token class-name\">StringFormat</span> format <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">StringFormat</span><span class=\"token punctuation\">(</span>StringFormatFlags<span class=\"token punctuation\">.</span>NoWrap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                format<span class=\"token punctuation\">.</span>Alignment <span class=\"token operator\">=</span> StringAlignment<span class=\"token punctuation\">.</span>Center<span class=\"token punctuation\">;</span>\n                format<span class=\"token punctuation\">.</span>LineAlignment <span class=\"token operator\">=</span> StringAlignment<span class=\"token punctuation\">.</span>Center<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//定义颜色</span>\n                <span class=\"token class-name\">Color<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> c <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> Color<span class=\"token punctuation\">.</span>Black<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Red<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkBlue<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Brown<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkCyan<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Purple<span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Green <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//定义字体</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> font <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"Verdana\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Microsoft Sans Serif\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Comic Sans MS\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Arial\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"宋体\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> chars<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> cindex <span class=\"token operator\">=</span> rand<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> findex <span class=\"token operator\">=</span> rand<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">Font</span> f <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>Font</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">[</span>findex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>FontStyle<span class=\"token punctuation\">.</span>Bold<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//字体样式，大小</span>\n                    <span class=\"token class-name\">Brush</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">.</span>SolidBrush</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">[</span>cindex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">Point</span> dot <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Point</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    <span class=\"token class-name\"><span class=\"token keyword\">float</span></span> angle <span class=\"token operator\">=</span> rand<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>RandAnlge<span class=\"token punctuation\">,</span> RandAnlge<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//旋转度数</span>\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">TranslateTransform</span><span class=\"token punctuation\">(</span>dot<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">,</span> dot<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//移动光标到指定位置</span>\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">RotateTransform</span><span class=\"token punctuation\">(</span>angle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">DrawString</span><span class=\"token punctuation\">(</span>chars<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> format<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">RotateTransform</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>angle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//转回去</span>\n                    graph<span class=\"token punctuation\">.</span><span class=\"token function\">TranslateTransform</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span>dot<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//移动光标到指定位置</span>\n                <span class=\"token punctuation\">}</span>\n                pbox<span class=\"token punctuation\">.</span>Image <span class=\"token operator\">=</span> map<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"验证图片创建错误\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h3><a id=\"_209\"></a>更新验证码的方法</h3>\n<p>因为验证码验证失败后，需要更新，所以创建一个更新验证码的方法</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            strValidCode <span class=\"token operator\">=</span> VrefiyCode<span class=\"token punctuation\">.</span><span class=\"token function\">CreateRandomCode</span><span class=\"token punctuation\">(</span>ValidCodeLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//生成随机验证码</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>strValidCode <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            VrefiyCode<span class=\"token punctuation\">.</span><span class=\"token function\">CreateImage</span><span class=\"token punctuation\">(</span>strValidCode<span class=\"token punctuation\">,</span> pbox1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建验证码图片</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"_221\"></a>写一个方法调用验证码类和验证验证码</h3>\n<pre><code class=\"prism language-csharp\">\n<span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">bool</span></span> <span class=\"token function\">isvalidcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> validcode <span class=\"token operator\">=</span> textBox3<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrEmpty</span><span class=\"token punctuation\">(</span>validcode<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//验证码不为空</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>validcode<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> strValidCode<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//启动验证吗验证</span>\n                    textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"验证失败\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"警告\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Exclamation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//更新验证码</span>\n                    textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入验证码\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Information<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//更新验证码</span>\n                textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"4_258\"></a>4.保存账号及密码功能的实现</h2>\n<h3><a id=\"APPconfig_259\"></a>在APP.config中先创建键值对用于储存复选框状态以及记录账号信息</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token operator\">&lt;</span>configuration<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>startup<span class=\"token operator\">&gt;</span> \n        <span class=\"token operator\">&lt;</span><span class=\"token class-name\">supportedRuntime</span> version<span class=\"token operator\">=</span><span class=\"token string\">\"v4.0\"</span> sku<span class=\"token operator\">=</span><span class=\"token string\">\".NETFramework,Version=v4.7.2\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>startup<span class=\"token operator\">&gt;</span>\n\t<span class=\"token operator\">&lt;</span>appSettings<span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token keyword\">add</span> key <span class=\"token operator\">=</span><span class=\"token string\">\"remenberme\"</span> <span class=\"token keyword\">value</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token keyword\">add</span> key <span class=\"token operator\">=</span><span class=\"token string\">\"username\"</span> <span class=\"token keyword\">value</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token keyword\">add</span> key <span class=\"token operator\">=</span><span class=\"token string\">\"userpasswd\"</span> <span class=\"token keyword\">value</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n\t\t<span class=\"token operator\">&lt;</span><span class=\"token keyword\">add</span> key <span class=\"token operator\">=</span><span class=\"token string\">\"roleID\"</span> <span class=\"token keyword\">value</span><span class=\"token operator\">=</span><span class=\"token string\">\"\"</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n\t<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>appSettings<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>configuration<span class=\"token operator\">&gt;</span>\n</code></pre>\n<h3><a id=\"_274\"></a>写一个用于记录账号信息的方法</h3>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">remenberme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n        \t<span class=\"token comment\">//提取信息</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> usertext <span class=\"token operator\">=</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> userpasswd <span class=\"token operator\">=</span> textBox2<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Configuration</span> cf <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span><span class=\"token function\">OpenExeConfiguration</span><span class=\"token punctuation\">(</span>ConfigurationUserLevel<span class=\"token punctuation\">.</span>None<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//根据复选框状态储存账号信息</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>checkBox1<span class=\"token punctuation\">.</span>Checked<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> usertext<span class=\"token punctuation\">;</span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"userpasswd\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> userpasswd<span class=\"token punctuation\">;</span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"false\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            cf<span class=\"token punctuation\">.</span><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"_296\"></a>在窗体加载的同时写入储存的登录信息</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Form_Login_Load</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"userpasswd\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                checkBox1<span class=\"token punctuation\">.</span>Checked <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"5_309\"></a>5.在点击登录时实现这些功能</h2>\n<h3><a id=\"_310\"></a>验证登录信息</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">bool</span></span> <span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名和密码不能为空\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span>MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span>MessageBoxIcon<span class=\"token punctuation\">.</span>Warning<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//链接数据库验证</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from Staff where LoginID = '\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"' and Password = '\"</span> <span class=\"token operator\">+</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">server_connection1</span> ser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">server_connection1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">IDataReader</span> reader <span class=\"token operator\">=</span> ser<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token comment\">//获取登录账号类型</span>\n                    login_role <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">[</span><span class=\"token string\">\"RoleID\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>login_role<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">//查询到结果允许登录</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"密码或用户名不正确\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span>MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span>MessageBoxIcon<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                reader<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h3><a id=\"_343\"></a>登录功能的实现</h3>\n<p><code>此处验证成功之后提示成功登录，跳转界面等功能不是此文的终点内容，后文会有对此部分的补充完善</code></p>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Login_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">remenberme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            login_time <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>login_time <span class=\"token operator\">&lt;=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//登录次数小于3次，无需验证码验证</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>login_time <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span><span class=\"token comment\">//登录次数大于3次，需验证码验证</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isvalidcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"_375\"></a>四、登录页面完整代码：</h1>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>ComponentModel</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Drawing</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Configuration</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">OlympicManagement</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form_Login</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">Form</span></span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form_Login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> login_time <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> login_role<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> ValidCodeLength <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//验证码长度</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> strValidCode <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//验证码</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">bool</span></span> <span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名和密码不能为空\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span>MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span>MessageBoxIcon<span class=\"token punctuation\">.</span>Warning<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//链接数据库验证</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from Staff where LoginID = '\"</span> <span class=\"token operator\">+</span> textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"' and Password = '\"</span> <span class=\"token operator\">+</span> textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">server_connection1</span> ser <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">server_connection1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">IDataReader</span> reader <span class=\"token operator\">=</span> ser<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token comment\">//获取登录账号类型</span>\n                    login_role <span class=\"token operator\">=</span> reader<span class=\"token punctuation\">[</span><span class=\"token string\">\"RoleID\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span>login_role<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token comment\">//查询到结果允许登录</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"密码或用户名不正确\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span>MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span>MessageBoxIcon<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                reader<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Login_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">remenberme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            login_time <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>login_time <span class=\"token operator\">&lt;=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//错误次数小于3</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                \n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>login_time <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isvalidcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">islogin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//更新验证码函数</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            strValidCode <span class=\"token operator\">=</span> VrefiyCode<span class=\"token punctuation\">.</span><span class=\"token function\">CreateRandomCode</span><span class=\"token punctuation\">(</span>ValidCodeLength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//生成随机验证码</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>strValidCode <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            VrefiyCode<span class=\"token punctuation\">.</span><span class=\"token function\">CreateImage</span><span class=\"token punctuation\">(</span>strValidCode<span class=\"token punctuation\">,</span> pbox1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//创建验证码图片</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token comment\">//验证验证码</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">bool</span></span> <span class=\"token function\">isvalidcode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> validcode <span class=\"token operator\">=</span> textBox3<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrEmpty</span><span class=\"token punctuation\">(</span>validcode<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//验证码不为空</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>validcode<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> strValidCode<span class=\"token punctuation\">.</span><span class=\"token function\">ToLower</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//启动验证吗验证</span>\n                    textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"验证失败\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"警告\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Exclamation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//启动验证吗验证</span>\n                    textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入验证码\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Information<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">UpdateValidCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//启动验证吗验证</span>\n                textBox3<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                textBox3<span class=\"token punctuation\">.</span><span class=\"token function\">Focus</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">remenberme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> usertext <span class=\"token operator\">=</span> textBox1<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> userpasswd <span class=\"token operator\">=</span> textBox2<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Configuration</span> cf <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span><span class=\"token function\">OpenExeConfiguration</span><span class=\"token punctuation\">(</span>ConfigurationUserLevel<span class=\"token punctuation\">.</span>None<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>checkBox1<span class=\"token punctuation\">.</span>Checked<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> usertext<span class=\"token punctuation\">;</span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"userpasswd\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> userpasswd<span class=\"token punctuation\">;</span>\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n\n                cf<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">.</span>Settings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value <span class=\"token operator\">=</span> <span class=\"token string\">\"false\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            cf<span class=\"token punctuation\">.</span><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Form_Login_Load</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"remenberme\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                textBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                textBox2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> ConfigurationManager<span class=\"token punctuation\">.</span>AppSettings<span class=\"token punctuation\">[</span><span class=\"token string\">\"userpasswd\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                checkBox1<span class=\"token punctuation\">.</span>Checked <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">btn_Exit_Click</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">remenberme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"_535\"></a>五、运行结果截图</h1>\n<h2><a id=\"_536\"></a>正确账号密码登录</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\7e053618bcbc437b96cb09ae83bcb4be.png\"/></p>\n<h2><a id=\"_539\"></a>错误账号，错误密码登录</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\3ac584c455f24540892096661f6be83f.png\"/></p>\n<h2><a id=\"3_541\"></a>错误3次后显示验证码</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\d6e675a38c344c48914b7cd0671856db.png\"/></p>\n<h2><a id=\"_544\"></a>验证码错误</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\14e8179953af401e9f8f797f6613e370.png\"/></p>\n<h2><a id=\"_546\"></a>验证码正确</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a9bbadd32b464b7b86289cc7c3a3f792.png\"/></p>\n<h2><a id=\"_548\"></a>记住密码后登录</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\1e5bffb717324a058a689700e6dd0ecc.png\"/></p>\n<h1><a id=\"_550\"></a>总结</h1>\n<p>以上就是此文章记录的内容，是最近在做的一个小项目的部分内容，简单介绍了并实现常见的登录功能。<br/> 鄙人才疏学浅，若有错误和缺陷还请欢迎大家留言讨论，多多指教，期待于CSDN的各位一起进步！</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}