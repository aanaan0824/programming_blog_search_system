{"blogid": "122336201", "writerAge": "码龄1年", "writerBlogNum": "12", "writerCollect": "2", "writerComment": "0", "writerFan": "0", "writerGrade": "2级", "writerIntegral": "132", "writerName": "EchoBag", "writerProfileAdress": "writer_image\\profile_122336201.jpg", "writerRankTotal": "226344", "writerRankWeekly": "1003631", "writerThumb": "0", "writerVisitNum": "4348", "blog_read_count": "1580", "blog_time": "已于 2022-07-16 15:38:00 修改", "blog_title": "获取DataTable中的某一列及增加一行数据", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>C#中获取DataTable中的某一列数据，存入List&lt;T&gt;</p>\n<p>Field 需要用到System.Data.DataSetExtensions</p>\n<pre><code class=\"language-cs\">using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Data;\n\nnamespace ConsoleApplication108\n{\n    class Program\n    {\n\n        static void Main(string[] args)\n        {\n            DataTable dt = new DataTable();\n\n            dt.Columns.Add(\"ID\", typeof(int));\n            dt.Columns.Add(\"Qty\", typeof(int));\n            dt.Columns.Add(\"Name\", typeof(string));\n\n            dt.Rows.Add(new object[] { 0, 321, 33 });\n            dt.Rows.Add(new object[] { 1, 100, 4 });\n            dt.Rows.Add(new object[] { 2, 355, 23 });\n\n            List&lt;int&gt; results = dt.AsEnumerable().Select(x =&gt; x.Field&lt;int&gt;(\"Qty\")).ToList();\n\n            foreach(var i in results)\n            {\n                Console.WriteLine(i);                \n            }\n            Console.ReadKey();\n        }\n    }\n}  \n\n</code></pre>\n<p>datatable 中增加一行数据的2 种方法：</p>\n<p>1. 列数可能为动态列数</p>\n<p>System.Data.DataRow dr = table.NewRow();<br/>         table.Rows.Add(dr);<br/>         dr[0] = logData.name;<br/>         dr[1] = logData.time;<br/>         for (int i = 0; i &lt;= this.PropertyNames.Value.Count - 1; i++)<br/>         {<!-- --><br/>             dr[i + 2] = logData.values[i];<br/>         }</p>\n<p></p>\n<p>2. 列数为固定列数：</p>\n<p>table.Rows.Add(<br/>             new object[]<br/>             {<!-- --><br/>                 logData.name,<br/>                 logData.time,<br/>                 logData.value<br/>             }<br/>             );     </p>\n</div>\n</div>"}