{"blogid": "123152798", "writerAge": "码龄14年", "writerBlogNum": "178", "writerCollect": "189", "writerComment": "15", "writerFan": "297", "writerGrade": "5级", "writerIntegral": "2007", "writerName": "Mwyldnje2003", "writerProfileAdress": "writer_image\\profile_123152798.jpg", "writerRankTotal": "9866", "writerRankWeekly": "7844", "writerThumb": "30", "writerVisitNum": "68255", "blog_read_count": "2654", "blog_time": "于 2022-03-02 22:46:49 发布", "blog_title": "十六、C# 表格数据控件", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"DataGridView_0\"></a>初始DataGridView</h1>\n<ul><li>DataGridView控件提供了一种强大而灵活的以表格形式显示数据的方式。用户可以使用DataGridView控件来显示少量数据的只读视图，也可以对齐进行缩放以显示特大数据集的可标记视图。</li><li>扩展DataView控件由很多方式，例如可以采用编程方式指定自己的排序算法来创建自己的单元格类型，通过选择一些属性，可以轻松地自定义DataGridView控件的外观：可以将许多类型的数据存储用作数据源：也可以在没有绑定数据源的情况下操作DataGridView控件。</li><li>配置数据源<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20b3c4a2677f480693d6af10d52c4473.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\bddf0790e0b24a608a928c8804d2dc1e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\b06d6162717240988dd3e2efc1e6b1e1.png\"/></li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\64ae386cd8674748b8cf972080b21256.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\8e1dc256072d4ecd8ad46ce920788800.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\630e77fc1a3945778b9a910629e7ee77.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\d84b99ce962844bba30c9929cc8ac46d.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\c8a8e098827746daab9fecf05a225af5.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\e19f2a6c3adb4ba88fdaaf3f37ae0715.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\bf1d2c36227e477584b65321d91eba34.png\"/><br/> 运行前只显示字段，运行后显示具体数据<br/> <img alt=\"在这里插入图片描述\" src=\"image\\0f0b69215e3d4287a0152e614014c1a9.png\"/><br/> 常用属性<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e6d1f88c09404a5d930e5f734cdf166f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\3d9b8f30e2fe4f078114b30b6d3264dc.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\6760c0f6d0b34ae086aad19dcb63aa1f.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\c3e1fc34756f4f88a177520171075208.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\7efda0233e9f4f4f86fbfeaa865b9d49.png\"/></p>\n<h1><a id=\"2_27\"></a>2、绑定数据方法</h1>\n<ul><li>Data Grid view控件用于显示来自多种外部数据源中的数据，用户可在此空间中添加行和列，并可以填充数据。</li><li>入股让DataGrideView显示数据库中的数据，只需要将此控件绑定到代用数据库的数据院上，则可以自动基于数据源的架构生成列。</li><li>绑定模式两种方法： \n  <ul><li>绑定模式：将已存在的数据库中数据绑定到空间上</li><li>非绑定模式：通过代码手动填充数据</li></ul> </li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\55bc332418c0476cbb51ad6868ffb13c.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _2_DataGridView绑定数据源\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            dgvbindMode<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> <span class=\"token function\">BindModSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n            dgvNonbindMode<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> <span class=\"token function\">NonBindSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">DataSet</span> <span class=\"token function\">BindModSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">//绑定模式，有线程数据库</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> constr <span class=\"token operator\">=</span> <span class=\"token string\">\"Server=.;user=sa;pwd=darly;database=csharpzx\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> mycon <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>constr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">DataSet</span> myds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select name,gender from mytable\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlDataAdapter</span> myda <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> mycon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                myda<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>myds<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mytable\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"错误提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">finally</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> myds<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">DataTable</span> <span class=\"token function\">NonBindSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\">//非绑定模式，没有数据库</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">DataTable</span> mydt <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            mydt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> Type<span class=\"token punctuation\">.</span><span class=\"token function\">GetType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"System.String\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            mydt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gender\"</span><span class=\"token punctuation\">,</span> Type<span class=\"token punctuation\">.</span><span class=\"token function\">GetType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"System.String\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span> mystr <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"张三\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"女\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"李四\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"女\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"王五\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"女\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"赵六\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"女\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token string\">\"张祺\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"女\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> mystr<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\">DataRow</span> myRow <span class=\"token operator\">=</span> mydt<span class=\"token punctuation\">.</span><span class=\"token function\">NewRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                myRow<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> mystr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                myRow<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> mystr<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                mydt<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>myRow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">return</span> mydt<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"3_109\"></a>3、获取当前单元格</h1>\n<ul><li>获取DataGridView控件中的当前单元格，是通过DataGridView的Rows属性和Colunm属性的索引来取得的，他们的索引都是从0开始的。</li><li></li></ul>\n<p>实例，当点击单元格时获取到点击的是第几行第几列，并获取单元格内的值<br/> <img alt=\"在这里插入图片描述\" src=\"image\\c2eaffff3c8c4b668bb2ab692a5ebe82.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\9030a47ad22245ef9e0f34783adbc42f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\8fa5b7a4d801411dafab89197cf86157.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _3_获取单元格\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet1.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet1<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token comment\">//方法的定义中第一个参数 sender就是指的当前操作的控件，第二个参数就是用于返回当前操作控件内容值</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_CellClick</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewCellEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">//获取行列索引</span>\n            <span class=\"token comment\">//1种方式</span>\n            <span class=\"token comment\">//int row = e.RowIndex + 1;   //获取的行数；</span>\n            <span class=\"token comment\">//int col = e.ColumnIndex + 1;   //获取列数</span>\n\n            <span class=\"token comment\">//MessageBox.Show(\"你点击的是：第\" + row.ToString() + \"行，第\" + col.ToString() + \"列。\");</span>\n            <span class=\"token comment\">//第2中方式</span>\n\n            <span class=\"token comment\">//int row2 = dataGridView1.CurrentCell.RowIndex + 1;</span>\n            <span class=\"token comment\">//int col2 = dataGridView1.CurrentCell.ColumnIndex + 1;</span>\n            <span class=\"token comment\">//MessageBox.Show(\"你点击的是：第\" + row2.ToString() + \"行，第\" + col2.ToString() + \"列。\");</span>\n\n            <span class=\"token comment\">//第3中方式</span>\n\n            <span class=\"token comment\">//int row3 = dataGridView1.CurrentCellAddress.Y + 1;</span>\n            <span class=\"token keyword\">int</span> col3 <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentCellAddress<span class=\"token punctuation\">.</span>X <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//MessageBox.Show(\"你点击的是：第\" + row3.ToString() + \"行，第\" + col3.ToString() + \"列。\");</span>\n\n            <span class=\"token comment\">//第四种方式</span>\n            <span class=\"token keyword\">int</span> row4 <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentRow<span class=\"token punctuation\">.</span>Index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//此方法仅适用于行，不适用于列。</span>\n\n\n            <span class=\"token comment\">//获取单元格内容Value</span>\n            <span class=\"token comment\">//第一种方式</span>\n            <span class=\"token comment\">//string cell = dataGridView1.Rows[row4-1].Cells[col3-1].Value.ToString();</span>\n\n            <span class=\"token comment\">//第二种方式</span>\n            <span class=\"token keyword\">string</span> cell <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentCell<span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"你点击的是：第\"</span> <span class=\"token operator\">+</span> row4<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"行，第\"</span> <span class=\"token operator\">+</span> col3<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"列。\\n内容是：\"</span><span class=\"token operator\">+</span>cell<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"4DataGridView_186\"></a>4、DataGridView隐藏行、列</h1>\n<p>隐藏与显示<br/> visible: true为显示，false为隐藏<br/> Rows：行<br/> Columns：列</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _4_DataGridView隐藏与显示行和列\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> mystr <span class=\"token operator\">=</span> button1<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mystr<span class=\"token punctuation\">.</span><span class=\"token function\">Contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"隐藏\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//获取单元格所在的列</span>\n                <span class=\"token comment\">//int col = dataGridView1.CurrentCell.ColumnIndex;</span>\n                dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Visible <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n                button1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"显示部门列\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Visible <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\n                button1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"隐藏部门列\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button2_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> mystr <span class=\"token operator\">=</span> button2<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>mystr<span class=\"token punctuation\">.</span><span class=\"token function\">Contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"隐藏\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Visible <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n                button2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"显示张三行\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Visible <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\n                button2<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"隐藏张三行\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"5DataGridView_248\"></a>5、DataGridView右键删除行</h1>\n<p>右键：ContextMenuStrip<br/> 删除行DataGridView1.Rows.RemoveAt（行索引值）；</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> DataGrideView右键删除行\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> rowIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_CellMouseUp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewCellMouseEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Button <span class=\"token operator\">==</span> MouseButtons<span class=\"token punctuation\">.</span>Right<span class=\"token punctuation\">)</span> <span class=\"token comment\">//判断鼠标操作事件，是左键还是右键</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Selected <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//选中当前行</span>\n                <span class=\"token comment\">//如果没有下面命令，每次点击会累加选择，出现多条行记录被选中的情况，下面命令就是右击是定义那个单元格为当前单元格；</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>CurrentCell <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n                rowIndex <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">;</span>  <span class=\"token comment\">//将当前行的索引值赋值给公共变量，以便删除时判断是否为空行（新行）</span>\n                <span class=\"token comment\">//this.contextMenuStrip1.Show(this.dataGridView1, e.Location);   //第一个参数是指定那个控件，第二个参数是当前事件发生的地方</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>contextMenuStrip1<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>Cursor<span class=\"token punctuation\">.</span>Position<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//鼠标点击出显示</span>\n\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 删除行<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>rowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>IsNewRow<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span><span class=\"token function\">RemoveAt</span><span class=\"token punctuation\">(</span>rowIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"6DataGridView_298\"></a>6、DataGridView分类排序与筛选</h1>\n<p>分类： Sort<br/> 筛选：通过声明DataView，更改DataSource，</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _6__DataGridView升序与筛选\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            dataGridView1<span class=\"token punctuation\">.</span><span class=\"token function\">Sort</span><span class=\"token punctuation\">(</span>dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> ListSortDirection<span class=\"token punctuation\">.</span>Ascending<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//第一个参数是按照哪一个列拍序，第二个参数是升序还是降序:Descending-降序，Ascending升序</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button2_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">//参数1源数据表，参数2筛选条件，参数3筛选后的排列方式，参数4当前行的状态（dataview的状态，指定为当前行的状态）</span>\n            <span class=\"token class-name\">DataView</span> dv <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataView</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">,</span> <span class=\"token string\">\"department='开发部'\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"age Asc\"</span><span class=\"token punctuation\">,</span> DataViewRowState<span class=\"token punctuation\">.</span>CurrentRows<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//上面语句可以简单理解，将源数据进行筛选，下面的语句是将筛选出来的数据绑定到DataGridView中。</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dv<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"7DataGridView_341\"></a>7、DataGridView直接修改数据</h1>\n<ul><li>DataGridView单元格进入编辑模式的方法： \n  <ul><li>双击或F12；</li><li>EditCellonEnter属性为True，对DataGridView进行配置，当用户移动到该单元个后，该单元格颗粒剂切换到编辑模式。</li><li>ESC取消编辑。如果EditCellOnEnter属性设置True，则单元格仍将处于编辑模式，但是所有更改都将被放弃。要提交更改，用户只需移到新的单元格，或将焦点切换到其他控件。</li></ul> </li><li>为防止单元格被编辑，用户可以设置</li><li>DataGridViewCell、DataGridViewColumn、DataGrieViewRow或DataGridView的ReadOnly属性（区域与用户要先定更改的内容）</li><li>要在DataGridViwe控件中修改数据，可通过CellValueChanged事件来完成</li></ul>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _7_DataGridView直接修改数据\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">SqlConnection</span> <span class=\"token function\">GeConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> constr <span class=\"token operator\">=</span> <span class=\"token string\">\"Server=.;user=sa;pwd=darly;database=csharpzx\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> mycon <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>constr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> mycon<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dgvBind</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlConnection</span> mycon <span class=\"token operator\">=</span> <span class=\"token function\">GeConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlDataAdapter</span> sda <span class=\"token operator\">=</span><span class=\"token keyword\">new</span>  <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select * from mytable\"</span><span class=\"token punctuation\">,</span> mycon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> table <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                sda<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>AutoGenerateColumns <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//设置DataGridView自动创建列</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> table<span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>EditMode <span class=\"token operator\">=</span> DataGridViewEditMode<span class=\"token punctuation\">.</span>EditOnEnter<span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">finally</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">dgvBind</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_CellValueChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewCellEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlConnection</span> mycon <span class=\"token operator\">=</span> <span class=\"token function\">GeConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">string</span> mystr1<span class=\"token operator\">=</span>dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>ColumnIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText<span class=\"token operator\">+</span><span class=\"token string\">\"=\"</span><span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token operator\">+</span>dataGridView1<span class=\"token punctuation\">.</span>CurrentCell<span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\"'\"</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//获取档前单元格的所在列的标头</span>\n\n                <span class=\"token keyword\">string</span> mystr2<span class=\"token operator\">=</span>dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Cells<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">string</span> updatsql <span class=\"token operator\">=</span> <span class=\"token string\">\"update mytable set \"</span><span class=\"token operator\">+</span>mystr1<span class=\"token operator\">+</span><span class=\"token string\">\" where id = \"</span><span class=\"token operator\">+</span>mystr2<span class=\"token punctuation\">;</span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>updatsql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlCommand</span> mycom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>updatsql<span class=\"token punctuation\">,</span> mycon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                mycom<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">dgvBind</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">finally</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"8DataGridView_437\"></a>8、DataGridView当前行显示不同颜色</h1>\n<p>如果想让选中的DataGridView的行显示不同颜色，就要通过DataGridView控件RowPrePaint事件中重新设置所选的DefaultCellStyle属性来实现</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _8_DataGridView当前行显示不同的颜色\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_RowPrePaint</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewRowPrePaintEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n           \n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex <span class=\"token operator\">&gt;=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//如果选中的行是一个新行（待添加内容）不进行操作，直接返回</span>\n            <span class=\"token class-name\">Color</span> oldForeColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Color</span> oldBackColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// object是所有类的基类， var是可以是所有变量类型,不知道变量类型时，可以声明为var格式</span>\n             \n            <span class=\"token keyword\">var</span> row <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//操作的行</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row <span class=\"token operator\">==</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentRow<span class=\"token punctuation\">)</span>   <span class=\"token comment\">//判断操作行与当前行是不是一行，如果一样代表是首次操作，所以要绘制不同样式</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">!=</span> Color<span class=\"token punctuation\">.</span>White<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    oldForeColor <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 存储现在的前景色</span>\n                    row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>White<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 设置前景色为白色</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">!=</span> Color<span class=\"token punctuation\">.</span>Blue<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    oldBackColor <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor<span class=\"token punctuation\">;</span>\n                    row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Blue<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">=</span> oldForeColor<span class=\"token punctuation\">;</span>\n                row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> oldBackColor<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"9DataGridView_502\"></a>9、DataGridView绘制行号</h1>\n<p>绘制DataGridView的行序列号<br/> RowPostPaint事件（当我们完成DataGridView绘制后执行的事件），通过Rectangle对象矩形区域，然后再通过TextRenderer的DrawText方法绘制序列号<br/> Rectangle（x,y,width,height）<br/> DrawText(IDeviceContext dc, text,font,Rectangle bounds, foreColor,TextFormatFlags) 第一个参数（IDeviceContext dc）是在哪个控件上进行绘制，Rectangle bounds矩形边界，TextFormatFlags字体对齐方式</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _9_DataGridView添加行序号\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_RowPostPaint</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewRowPostPaintEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">//e代表DataGridView，RowBound控件行bianjie</span>\n            <span class=\"token class-name\">Rectangle</span> myrec <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Location<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Location<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersWidth<span class=\"token operator\">-</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//宽度值减小是为了内容与下一列间隔开</span>\n            TextRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">DrawText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersDefaultCellStyle<span class=\"token punctuation\">.</span>Font<span class=\"token punctuation\">,</span> myrec<span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersDefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor<span class=\"token punctuation\">,</span> TextFormatFlags<span class=\"token punctuation\">.</span>VerticalCenter <span class=\"token operator\">|</span> TextFormatFlags<span class=\"token punctuation\">.</span>Right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"10_541\"></a>10、各行显示不同颜色</h1>\n<p>两种方法：<br/> 第一种 DataGridView1.Rows[i].DefaultCellStyle.BAckColor<br/> 第二种：AlternatingRowsDefaultCellStyle属性，获取或这是应用于DataGridView的奇数行的默认单元格样式。RowsDefaultCellStyle属性获取或设置DataGridView的行单元格的默认样式</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _10_DataGridView各行显示不同的颜色\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">第一种方式</span>\n            <span class=\"token comment\">//for (int i=0; i&lt;this.dataGridView1.Rows.Count;i++)</span>\n            <span class=\"token comment\">//{<!-- --></span>\n            <span class=\"token comment\">//    if (i % 2 == 0)</span>\n            <span class=\"token comment\">//        this.dataGridView1.Rows[i].DefaultCellStyle.BackColor = Color.Pink;</span>\n            <span class=\"token comment\">//    else</span>\n            <span class=\"token comment\">//        this.dataGridView1.Rows[i].DefaultCellStyle.BackColor = Color.Violet;</span>\n            <span class=\"token comment\">//}</span>\n\n            <span class=\"token comment\">//第二种</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>RowsDefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Violet<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>dataGridView1<span class=\"token punctuation\">.</span>AlternatingRowsDefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>SaddleBrown<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"11DataGridView_588\"></a>11、DataGridView分页显示</h1>\n<p>思路：将数据表整体填充值一个DataSet中，然后部分现实（DataAdapter Fill重载）<br/> DataGridView<br/> BindingNavigate<br/> <strong>bindingSource：将DataGridView的数据源于BindingNavicat关联</strong></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\654b8f7a93974c6791e1272819e58250.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\14d1e0d529b04beca1c41107042e4c5f.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">.</span>SqlClient<span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">namespace</span> _11_DataGridView分页显示\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">SqlDataAdapter</span> pageDA<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">DataSet</span> pageDS <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> startval <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//起始值</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> valPerPage <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> toalValNumber<span class=\"token punctuation\">;</span>  <span class=\"token comment\">//总条数</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> currentPage <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            dataGridView1<span class=\"token punctuation\">.</span>AllowUserToAddRows <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> constr <span class=\"token operator\">=</span> <span class=\"token string\">\"Server=.;user=sa;pwd=darly;database=csharpzx\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> mycon <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>constr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from mytable\"</span><span class=\"token punctuation\">;</span>\n                pageDA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> mycon<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                pageDA<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>pageDS<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mytable\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                toalValNumber <span class=\"token operator\">=</span> pageDS<span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//总页数计算</span>\n                <span class=\"token keyword\">int</span> totalPageNumber <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>toalValNumber <span class=\"token operator\">%</span> valPerPage <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>toalValNumber <span class=\"token operator\">/</span> valPerPage<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>toalValNumber <span class=\"token operator\">/</span> valPerPage <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//三目表达式</span>\n                toolStripLabel1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> totalPageNumber<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">LoadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">finally</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                mycon<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">LoadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            currentPage <span class=\"token operator\">=</span> startval <span class=\"token operator\">/</span> valPerPage <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//计算初始当前页，初始值为0，故首次打开显示第一页数据</span>\n            toolStripTextBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> currentPage<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pageDS<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//将数据集清空</span>\n            pageDA<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>pageDS<span class=\"token punctuation\">,</span> startval<span class=\"token punctuation\">,</span> valPerPage<span class=\"token punctuation\">,</span> <span class=\"token string\">\"mytable\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            bindingSource1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> pageDS<span class=\"token punctuation\">.</span>Tables<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\">//bindingSource1绑定数据源</span>\n            bindingNavigator1<span class=\"token punctuation\">.</span>BindingSource <span class=\"token operator\">=</span> bindingSource1<span class=\"token punctuation\">;</span>      <span class=\"token comment\">//bindingNavigator1绑定数据源</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> bindingSource1<span class=\"token punctuation\">;</span>\n            \n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">bindingNavigator1_ItemClicked</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ToolStripItemClickedEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>ClickedItem<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"上一页\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                startval <span class=\"token operator\">=</span> startval <span class=\"token operator\">-</span> valPerPage<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>startval <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已经是第一页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    startval <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>ClickedItem<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"下一页\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                startval <span class=\"token operator\">=</span> startval <span class=\"token operator\">+</span> valPerPage<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>startval<span class=\"token operator\">&gt;</span>toalValNumber<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已经是最后一页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    startval <span class=\"token operator\">=</span> startval <span class=\"token operator\">-</span> valPerPage<span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>                \n            <span class=\"token punctuation\">}</span>\n            <span class=\"token function\">LoadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"12DataGridView_694\"></a>12、DataGridView单元格自动填充</h1>\n<p>在DataGridView单元各种，当输入指定字符时，自动完成填充<br/> 通过TExBox实现 TextBox有以下两个属性</p>\n<ul><li>AutoCompleteMode //默认没有自动填充模式 \n  <ul><li>AutoCompleteMode.Suggest; //需要将自动填充模式改为建议模式，建议模式需要下面的属性提供具体内容</li></ul> </li><li>AutoCompleteSource \n  <ul><li>AutoCompleteSource.CustomSource //自动填充数据源设置为客户定义的数据源，再定义一个数据源</li></ul> </li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\b23ab2e14dca4d0a9a0389113f9fb4b6.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>ComponentModel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Linq<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _13_DataGridView自动填充单元格\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token comment\">// TODO: 这行代码将数据加载到表“csharpzxDataSet.mytable”中。您可以根据需要移动或删除它。</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>mytableTableAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>csharpzxDataSet<span class=\"token punctuation\">.</span>mytable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_EditingControlShowing</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewEditingControlShowingEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> titleText <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>dataGridView1<span class=\"token punctuation\">.</span>CurrentCell<span class=\"token punctuation\">.</span>ColumnIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>HeaderText<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>titleText<span class=\"token punctuation\">.</span><span class=\"token function\">Equals</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"department\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\">TextBox</span> autoText <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token class-name\">Control</span> <span class=\"token keyword\">as</span> TextBox<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>autoText <span class=\"token operator\">!=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    autoText<span class=\"token punctuation\">.</span>AutoCompleteMode <span class=\"token operator\">=</span> AutoCompleteMode<span class=\"token punctuation\">.</span>Suggest<span class=\"token punctuation\">;</span>\n                    autoText<span class=\"token punctuation\">.</span>AutoCompleteSource <span class=\"token operator\">=</span> AutoCompleteSource<span class=\"token punctuation\">.</span>CustomSource<span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">AutoCompleteStringCollection</span> dataCollection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">AutoCompleteStringCollection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    dataCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"开发部\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    dataCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"技术部\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    dataCollection<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"测试部\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    autoText<span class=\"token punctuation\">.</span>AutoCompleteCustomSource <span class=\"token operator\">=</span> dataCollection<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h1><a id=\"_756\"></a>本章小结及任务实施</h1>\n<p>创建职员信息表：添加姓名、性别、工资<br/> 绘制行号，选中行显示为蓝色<br/> 其他行就显示不同颜色<br/> 分页显示</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\4c4f2be20ae6466681eed503573aabf3.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">using</span> System<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Drawing<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> System<span class=\"token punctuation\">.</span>Windows<span class=\"token punctuation\">.</span>Forms<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> _14__任务实施\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Form1</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Form1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">int</span> valToalNum <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//产生的总条数</span>\n        <span class=\"token class-name\">DataTable</span> dtable<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">int</span> valPerPage <span class=\"token operator\">=</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//每页条数</span>\n        <span class=\"token keyword\">int</span> pageNum <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//总页数</span>\n        <span class=\"token keyword\">int</span> pageCurrent <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//当前页序号</span>\n        <span class=\"token keyword\">int</span> valCurrent <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//当前条数</span>\n        <span class=\"token keyword\">int</span> valstartCurrent <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//当前页起始条数</span>\n        <span class=\"token keyword\">int</span> valEndIndex <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//当前页终止条数</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dtGenerate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">//数据产生方法</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            dtable <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ClerkSalary\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dtable<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"姓名\"</span><span class=\"token punctuation\">,</span> Type<span class=\"token punctuation\">.</span><span class=\"token function\">GetType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"System.String\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dtable<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"性别\"</span><span class=\"token punctuation\">,</span> Type<span class=\"token punctuation\">.</span><span class=\"token function\">GetType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"System.String\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dtable<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"工资\"</span><span class=\"token punctuation\">,</span> Type<span class=\"token punctuation\">.</span><span class=\"token function\">GetType</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"System.Int32\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">String</span> familyName <span class=\"token operator\">=</span> <span class=\"token string\">\"赵钱孙李周吴郑王冯陈诸卫蒋沈崔胡刘\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> lastName <span class=\"token operator\">=</span> <span class=\"token string\">@\"姓名汉语词语人的姓氏和名字名字是人类为区分个体给每\n个人特定的名称符号是通过语言文字信息区别人群个体\n差异的标志由于有了姓名人类才能正常有序地交往因此每个人都有一个属于自己的姓名\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> gender <span class=\"token operator\">=</span> <span class=\"token string\">\"男女\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Random</span> rd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> valToalNum<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">//增加行方式一</span>\n                <span class=\"token keyword\">string</span> name <span class=\"token operator\">=</span> familyName<span class=\"token punctuation\">[</span>rd<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> familyName<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> lastName<span class=\"token punctuation\">[</span>rd<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> lastName<span class=\"token punctuation\">[</span>rd<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">string</span> Gender <span class=\"token operator\">=</span> gender<span class=\"token punctuation\">[</span>rd<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> gender<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">int</span> salary <span class=\"token operator\">=</span> rd<span class=\"token punctuation\">.</span><span class=\"token function\">Next</span><span class=\"token punctuation\">(</span><span class=\"token number\">1800</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                dtable<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token keyword\">object</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{<!-- --></span> name<span class=\"token punctuation\">,</span> Gender<span class=\"token punctuation\">,</span> salary <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token comment\">//增加行方式二</span>\n                <span class=\"token comment\">//DataRow dr = dtable.NewRow();</span>\n                <span class=\"token comment\">//dr[0] = familyName[rd.Next(0, familyName.Length)].ToString() + lastName[rd.Next(0, lastName.Length)].ToString() + lastName[rd.Next(0, lastName.Length)].ToString();</span>\n                <span class=\"token comment\">//dr[1] = gender[rd.Next(0, gender.Length)].ToString();</span>\n                <span class=\"token comment\">//dr[2] = rd.Next(1800, 1000);</span>\n                <span class=\"token comment\">//dtable.Rows.Add(dr);</span>\n            <span class=\"token punctuation\">}</span>\n\n\n\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">//加载当前页的数据</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">DataTable</span> dtTemp <span class=\"token operator\">=</span> dtable<span class=\"token punctuation\">.</span><span class=\"token function\">Clone</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pageCurrent <span class=\"token operator\">==</span> pageNum<span class=\"token punctuation\">)</span> valEndIndex <span class=\"token operator\">=</span> valToalNum <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//只有一页</span>\n            <span class=\"token keyword\">else</span> valEndIndex <span class=\"token operator\">=</span> pageCurrent <span class=\"token operator\">*</span> valPerPage <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//不止一页</span>\n            valstartCurrent <span class=\"token operator\">=</span> valCurrent<span class=\"token punctuation\">;</span>\n            toolStripTextBox1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> pageCurrent<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            toolStripLabel1<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//从原数据表中读取当前数据</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> valstartCurrent<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> valEndIndex<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                dtTemp<span class=\"token punctuation\">.</span><span class=\"token function\">ImportRow</span><span class=\"token punctuation\">(</span>dtable<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">//将响应航导入到临时表中</span>\n                valCurrent<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">//绑定数据源</span>\n            bindingSource1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dtTemp<span class=\"token punctuation\">;</span>\n            bindingNavigator1<span class=\"token punctuation\">.</span>BindingSource <span class=\"token operator\">=</span> bindingSource1<span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> bindingSource1<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//奇偶行显示不同的颜色</span>\n            dataGridView1<span class=\"token punctuation\">.</span>RowsDefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Pink<span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>AlternatingRowsDefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Violet<span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">try</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token function\">dtGenerate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">//MessageBox.Show(\"数据生产完成\");</span>\n                pageNum <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>valToalNum <span class=\"token operator\">%</span> valPerPage <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token punctuation\">(</span>valToalNum <span class=\"token operator\">/</span> valPerPage<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>valToalNum <span class=\"token operator\">/</span> valPerPage <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                dataGridView1<span class=\"token punctuation\">.</span>ReadOnly <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\n                dataGridView1<span class=\"token punctuation\">.</span>AllowUserToAddRows <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> ex<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span>ex<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                \n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">dataGridView1_RowPostPaint</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataGridViewRowPostPaintEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">Rectangle</span> myrec <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Rectangle</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Location<span class=\"token punctuation\">.</span>X<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Location<span class=\"token punctuation\">.</span>Y<span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersWidth<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span>RowBounds<span class=\"token punctuation\">.</span>Height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//TextRenderer.DrawText(e.Graphics, (e.RowIndex + 1).ToString(), dataGridView1.RowHeadersDefaultCellStyle.Font, myrec, dataGridView1.RowHeadersDefaultCellStyle.ForeColor, TextFormatFlags.VerticalCenter | TextFormatFlags.Right);</span>\n            TextRenderer<span class=\"token punctuation\">.</span><span class=\"token function\">DrawText</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>Graphics<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token operator\">+</span>valstartCurrent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersDefaultCellStyle<span class=\"token punctuation\">.</span>Font<span class=\"token punctuation\">,</span> myrec<span class=\"token punctuation\">,</span> dataGridView1<span class=\"token punctuation\">.</span>RowHeadersDefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor<span class=\"token punctuation\">,</span> TextFormatFlags<span class=\"token punctuation\">.</span>VerticalCenter <span class=\"token operator\">|</span> TextFormatFlags<span class=\"token punctuation\">.</span>Right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>RowIndex <span class=\"token operator\">&gt;=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">//如果选中的行是一个新行（待添加内容）不进行操作，直接返回</span>\n            <span class=\"token class-name\">Color</span> oldForeColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">Color</span> oldBackColor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Color</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// object是所有类的基类， var是可以是所有变量类型,不知道变量类型时，可以声明为var格式</span>\n\n            <span class=\"token keyword\">var</span> row <span class=\"token operator\">=</span> dataGridView1<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>RowIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//操作的行</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row <span class=\"token operator\">==</span> dataGridView1<span class=\"token punctuation\">.</span>CurrentRow<span class=\"token punctuation\">)</span>   <span class=\"token comment\">//判断操作行与当前行是不是一行，如果一样代表是首次操作，所以要绘制不同样式</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">!=</span> Color<span class=\"token punctuation\">.</span>White<span class=\"token punctuation\">)</span> \n                <span class=\"token punctuation\">{<!-- --></span>\n                    oldForeColor <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor<span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 存储现在的前景色</span>\n                    row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>White<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 设置前景色为白色</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">!=</span> Color<span class=\"token punctuation\">.</span>Blue<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    oldBackColor <span class=\"token operator\">=</span> row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor<span class=\"token punctuation\">;</span>\n                    row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Blue<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>ForeColor <span class=\"token operator\">=</span> oldForeColor<span class=\"token punctuation\">;</span>\n                row<span class=\"token punctuation\">.</span>DefaultCellStyle<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span> oldBackColor<span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">bindingNavigator1_ItemClicked</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">ToolStripItemClickedEventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>ClickedItem<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"上一页\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                pageCurrent<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pageCurrent <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已经是最后一页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    pageCurrent<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    valCurrent <span class=\"token operator\">=</span> valPerPage <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>pageCurrent <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>ClickedItem<span class=\"token punctuation\">.</span>Text<span class=\"token operator\">==</span><span class=\"token string\">\"下一页\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                pageCurrent<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>pageCurrent<span class=\"token operator\">&gt;</span>pageNum<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    pageCurrent<span class=\"token operator\">--</span><span class=\"token punctuation\">;</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已经是最后一页\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    valCurrent <span class=\"token operator\">=</span> valPerPage <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>pageCurrent <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token function\">loadData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}