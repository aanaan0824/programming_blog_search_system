{"blogid": "124338426", "writerAge": "码龄10年", "writerBlogNum": "204", "writerCollect": "2652", "writerComment": "118", "writerFan": "11859", "writerGrade": "5级", "writerIntegral": "3879", "writerName": "柯晓楠", "writerProfileAdress": "writer_image\\profile_124338426.jpg", "writerRankTotal": "5245", "writerRankWeekly": "865", "writerThumb": "512", "writerVisitNum": "392169", "blog_read_count": "21014", "blog_time": "已于 2022-06-28 18:00:16 修改", "blog_title": "Linux环境安装mysql数据库详细教程（含卸载和密码重置过程）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>本教程适用于centos7/8，mysql 5.x</p>\n</blockquote>\n<h3><a id=\"1mysql_2\"></a>1、卸载mysql（重要）</h3>\n<p>在安装mysql之前要确保自己的系统中没有mysql，即使你是刚刚重装的系统或者是刚购买的云服务，也需要检查一下是否存在mysql相关的文件，这一点很重要！（腾讯云的一些镜像默认包含mysql的文件），安装前如果已经存在mysql相关的文件，会导致后续的mysql安装失败。<br/> <strong>完全删除mysql步骤：</strong><br/> <strong>（1）使用 rpm 命令查看已安装的安装包</strong><br/> 输入以下命令检查是否安装了mysql软件：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -qa <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> mysql\n</code></pre>\n<p>如果查到了相关文件，例如<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e11c33bbe23e480e8d37619b45e7fb42.png\"/><br/> 使用 <code>rpm -e 文件名</code> 的命令删除该文件，以上面文件为例，执行以下命令：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -e mysql57-community-release-el7-10.noarch\n</code></pre>\n<p>重复使用 <code>rpm -e</code> 命令删除文件，直到所有文件完全删除<br/> <strong>（2）使用yum卸载安装的mysql</strong></p>\n<pre><code class=\"prism language-shell\">yum remove mysql mysql-server mysql-libs mysql-server\n</code></pre>\n<p><strong>（3）搜索mysql文件</strong><br/> 全局搜索名称包含 <code>mysql</code> 的所有文件</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">find</span> / -name <span class=\"token string\">'*mysql*'</span>\n</code></pre>\n<p>删除搜索出来的所有 mysql 文件，如果没有安装过mysql，一般会搜索出来 <code>/var/lib/*</code> 和 <code>/usr/share/*</code> 这两个目录下包含 mysql 文件。删除文件命令：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 以 /var/lib/mysql 为例</span>\n<span class=\"token function\">rm</span> -rf /var/lib/mysql\n</code></pre>\n<p>使用 <code>rm -rf</code> 命令删除所有搜索出来的mysql文件。</p>\n<blockquote>\n<p>Linux中复制快捷键：<code>ctrl + insert</code>，粘贴快捷键：<code>shift + insert</code> 或使用鼠标中键</p>\n</blockquote>\n<p>最后再检查一下：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token comment\"># 检查1</span>\n<span class=\"token function\">rpm</span> -qa<span class=\"token operator\">|</span><span class=\"token function\">grep</span> mysql\n\n<span class=\"token comment\"># 检查2</span>\n<span class=\"token function\">find</span> / -name <span class=\"token string\">'*mysql*'</span>\n</code></pre>\n<p>如果有的话继续执行删除，直到删干净为止！</p>\n<h3><a id=\"2mysql_45\"></a>2、下载mysql安装文件</h3>\n<p>Linux平台上推荐使用RPM包来安装mysql。<br/> 下载：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">wget</span> http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm\n</code></pre>\n<p>rpm安装：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">rpm</span> -ivh mysql-community-release-el7-5.noarch.rpm\n</code></pre>\n<p>yum安装mysql-server：</p>\n<pre><code class=\"prism language-shell\">yum <span class=\"token function\">install</span> -y mysql-server\n</code></pre>\n<p>如果没有权限的，可以执行下面命令设置权限（root用户不用执行）：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">chown</span> -R mysql:mysql /var/lib/mysql/\n</code></pre>\n<p>启动服务：</p>\n<pre><code class=\"prism language-shell\">systemctl start mysqld.service\n</code></pre>\n<p>查看mysql运行状态：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">service</span> mysqld status\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\ebc2151141c54f27bef1054f16572aa1.png\"/><br/> 查看初始密码：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">grep</span> <span class=\"token string\">'password'</span> /var/log/mysqld.log\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\b3f63d274e9b4e6ba27ac304750c1087.png\"/><br/> 红框标记处为初始密码，但是有的情况查询不到初始密码，后面会说怎么修改密码。<br/> 复制初始密码，进行登录：</p>\n<pre><code class=\"prism language-shell\">mysql -u root -p\n</code></pre>\n<p>输入命令后，点击回车，会让你输入密码，然后输入刚刚的初始密码（输密码的时候不可见），当然支持粘贴，你可以复制初始密码后，然后粘贴。如果没有密码，直接回车即可。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\a7cb606587d848098d68d5b00ce3637a.png\"/><br/> 登录成功后显示：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\a0fd8bd3184240cda4ac276e5f6d3b3c.png\"/><br/> 查看所有的数据库：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\92d060ffaf7c4cc197e6baa8bcf008ba.png\"/><br/> 到此，mysql数据库就安装完成了。</p>\n<h3><a id=\"3mysql_90\"></a>3、修改mysql密码</h3>\n<p>很多情况下，需要修改初始密码，但是如果在前面步骤中查看不到初始密码，也是没办法登录数据库的，这时就需要修改密码。我们就以无法查看初始密码为例（或是忘记了登录密码），简单介绍一下密码修改过程。<br/> <strong>（1）设置跳过登录密码</strong><br/> 打开mysql的配置文件：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">vi</span> /etc/my.cnf\n</code></pre>\n<p>打开文件后按 <code>a</code> 键进入编辑模式，在 <code>[mysqld]</code> 配置的下面添加 <code>skip-grant-tables</code>，如下图所示：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\339ff2f0f33e4f02b18019a1c2c76169.png\"/><br/> 然后按 <code>esc</code> 键，输入 <code>:wq</code> 保存文件。</p>\n<p><strong>（2）重启mysql服务</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">service</span> mysqld restart\n</code></pre>\n<p><strong>（3）进入mysql</strong></p>\n<pre><code class=\"prism language-shell\">mysql -u root -p\n</code></pre>\n<p>输入完上面命令后按回车，会跳过密码验证，直接进入到mysql中。</p>\n<p><strong>（4）修改用户登录密码</strong><br/> 进入 mysql 库：</p>\n<pre><code class=\"prism language-shell\">use mysql\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\ca62ff44b09f41b294acc65c80300501.png\"/><br/> 修改密码：</p>\n<pre><code class=\"prism language-shell\">update user <span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span>password<span class=\"token punctuation\">(</span><span class=\"token string\">'你设置的密码'</span><span class=\"token punctuation\">)</span> where <span class=\"token assign-left variable\">User</span><span class=\"token operator\">=</span><span class=\"token string\">'root'</span> and <span class=\"token assign-left variable\">Host</span><span class=\"token operator\">=</span><span class=\"token string\">'localhost'</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<blockquote>\n<p><strong>注意：</strong> 设置了 Host=‘localhost’ 可能会导致远程连接失败！</p>\n</blockquote>\n<p>更新缓存：</p>\n<pre><code class=\"prism language-shell\">flush privileges<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>退出mysql：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token builtin class-name\">exit</span>\n</code></pre>\n<p><strong>（4）还原配置文件</strong><br/> 重新进入 <code>my.cnf</code> 文件注释掉 <code>skip-grant-tables</code>，效果如下图所示<br/> <img alt=\"在这里插入图片描述\" src=\"image\\0983aa20654f4524b403e09fa1bac3e9.png\"/><br/> 按 <code>esc</code> 键退出编辑模式，输入 <code>:wq</code> 保存文件。</p>\n<p>再次重启mysql服务：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">service</span> mysqld restart\n</code></pre>\n<p>然后连接数据库，输入你修改后的密码看能否进入，能够进入就说明密码修改成功，否则再重新按照步骤操作一遍。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}