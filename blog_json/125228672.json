{"blogid": "125228672", "writerAge": "码龄1年", "writerBlogNum": "12", "writerCollect": "58", "writerComment": "46", "writerFan": "531", "writerGrade": "2级", "writerIntegral": "268", "writerName": "Ksd0_Hlk1", "writerProfileAdress": "writer_image\\profile_125228672.jpg", "writerRankTotal": "57883", "writerRankWeekly": "371152", "writerThumb": "88", "writerVisitNum": "69046", "blog_read_count": "6536", "blog_time": "于 2022-06-12 21:43:17 发布", "blog_title": "ctfshow爆破wp", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-dracula\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_1\">前言</a></li><li><a href=\"#web21custom_iteratorbase64_4\">一、web21----custom iterator(自定义迭代器)（base64解码）</a></li><li><a href=\"#web22_23\">二、web22----子域名爆破</a></li><li><a href=\"#web23substrmd5_30\">三、web23----substr()函数（md5加密）</a></li><li><a href=\"#web24mt_srandseed_77\">四、web24----mt_srand(seed)</a></li><li><a href=\"#web25mt_randcookies_85\">五、web25----mt_rand(),cookies</a></li><li><a href=\"#web26_103\">六、web26----爆破弱口令</a></li><li><a href=\"#web27_109\">七、web27----出生日期爆破</a></li><li><a href=\"#web28_119\">八、web28----目录爆破</a></li><li><a href=\"#_129\">总结</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_1\"></a>前言</h1>\n<p>整理了之前写的一些题的wp，回顾回顾一下web暴力破解的一些相关知识。</p>\n<h1><a id=\"web21custom_iteratorbase64_4\"></a>一、web21----custom iterator(自定义迭代器)（base64解码）</h1>\n<p>题目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\841f606dacf849aba0da603364c170ed.png\"/><br/> 看题可猜测可能是要爆破账户名密码，抓包试试。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\8e39483fab624a539a305a8d22a911f3.png\"/><br/> 好像是base64加密，将其解密。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ddf89f155b674c4d9e35d20ae9aaf88f.png\"/><br/> 解密后可得到账户密码传输的格式<br/> 账户：密码<br/> 那么爆破就有一定思路了。打开bp，使用bp构造payload爆破,对需要爆破的地方进行标记。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\f2bc918d7e2944a0adfb06f7c5e563bc.png\"/><br/> 按之前的格式进行设置<br/> position 1，2，3，第三部分记得导入常见的弱口令字典<br/> <img alt=\"在这里插入图片描述\" src=\"image\\13d0322723994591a48514f80b9d65d4.png\"/><br/> 加入base64加密，关闭URL编码，开始爆破。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e1c3309f90a1446aad00fc55d44c548c.png\"/><br/> 爆破结束后查看length最小的回包，即可得到flag，（由于爆破时间过长就不做演示了）</p>\n<h1><a id=\"web22_23\"></a>二、web22----子域名爆破</h1>\n<p>题目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\8e53992a6dd343318a098f58c4258f6b.png\"/><br/> 由题可知，这是子域名爆破。<br/> 在线找一个查找子域名的工具<a href=\"http://z.zcjun.com/\">子域名查询网站</a><br/> <img alt=\"在这里插入图片描述\" src=\"image\\f373445a21ee4095ba1c429c2cbd8bb8.png\"/><br/> 然后可在vip.ctf.show源码可见flag。</p>\n<h1><a id=\"web23substrmd5_30\"></a>三、web23----substr()函数（md5加密）</h1>\n<p>题目如下<br/> <img alt=\"在这里插入图片描述\" src=\"image\\1cb3a83beb1343d3b3bf528221968824.png\"/><br/> 通过简单的阅读代码可知，我们以get传参方式传入token值需要满足两个条件。<br/> 一，MD5加密后的要使第二位，第十五位和第十八位相同。（下标从0开始）<br/> 二，第二位+第十五位+第十八位/第二位=第三十二位；<br/> 在这里直接用脚本<br/> cv其他大佬的python脚本</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> hashlib\ndic <span class=\"token operator\">=</span> <span class=\"token string\">\"0123456789qazwsxedcrfvtgbyhnujmikolp\"</span>\n<span class=\"token keyword\">for</span> a <span class=\"token keyword\">in</span> dic<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> b <span class=\"token keyword\">in</span> dic<span class=\"token punctuation\">:</span>\n        t <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\n        md5 <span class=\"token operator\">=</span> hashlib<span class=\"token punctuation\">.</span>md5<span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hexdigest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> md5<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> md5<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> md5<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> md5<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">:</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>md5<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>md5<span class=\"token punctuation\">[</span><span class=\"token number\">14</span><span class=\"token punctuation\">:</span><span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>md5<span class=\"token punctuation\">[</span><span class=\"token number\">17</span><span class=\"token punctuation\">:</span><span class=\"token number\">18</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>md5<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">==</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>md5<span class=\"token punctuation\">[</span><span class=\"token number\">31</span><span class=\"token punctuation\">:</span><span class=\"token number\">32</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>python脚本跑出来如图<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ba4a93ea8cfb4b0bafe8ea1d98e14347.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\bb8136c6751d4ce6b5a03994b3bfb3a4.png\"/>看其他大佬还有人使用PHP脚本<br/> PHP脚本如下，大家可以去试试。</p>\n<pre><code class=\"prism language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v1</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v1</span><span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v1</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v2</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v2</span><span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v2</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v3</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v3</span><span class=\"token operator\">&lt;</span><span class=\"token number\">10</span><span class=\"token punctuation\">;</span><span class=\"token variable\">$v3</span><span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token variable\">$v</span><span class=\"token operator\">=</span><span class=\"token variable\">$v1</span><span class=\"token operator\">.</span><span class=\"token variable\">$v2</span><span class=\"token operator\">.</span><span class=\"token variable\">$v3</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$token</span> <span class=\"token operator\">=</span> <span class=\"token function\">md5</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$v</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token function\">intval</span><span class=\"token punctuation\">(</span><span class=\"token function\">substr</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$token</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token keyword\">echo</span> <span class=\"token variable\">$v</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n\n<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>这个题个人认为需要掌握其他的小知识点<br/> 1.PHP函数<strong>substr()</strong><br/> <img alt=\"在这里插入图片描述\" src=\"image\\bb43d8d57f5a49b294aa27f30c4d9d02.png\"/><br/> 测试一下以上函数（最好自己手敲加深印象）<br/> <img alt=\"在这里插入图片描述\" src=\"image\\c2126a89e6cf4999aadbf2c86f7addb0.png\"/></p>\n<h1><a id=\"web24mt_srandseed_77\"></a>四、web24----mt_srand(seed)</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\4691a75653234c4faf0d4d4759121cbf.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\d05797a67e15412fa56c20747fa1d585.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\d248541cc11942feba90ae7172947a30.png\"/><br/> 这个题主要涉及的就是PHP生成随机数<br/> 1.mt_srand()和mt_rand()函数（下题详细讲）<br/> 2.intval函数<br/> <img alt=\"在这里插入图片描述\" src=\"image\\8b2d8398038b4f2893796c4863af78f9.png\"/></p>\n<h1><a id=\"web25mt_randcookies_85\"></a>五、web25----mt_rand(),cookies</h1>\n<p>题目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\9870c4f8a0ca4d47ad4bc3c595a65508.png\"/><br/> 阅读代码可知，如果我们使r=0;可以得到mt_rand()第一次产生的数字，以此来反推种子。再使r=mt_rand()第一次产生的数字，可进入下面的语句。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\195472aef86d4fd6973b18865e31105f.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\132aa9ee3569444abfab0e0976221651.png\"/><br/> 即已进入下面语句。<br/> 使用<a href=\"https://www.openwall.com/php_mt_seed/\">反推种子的脚本</a><br/> 即这一页面<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ca7d3361b18d4b5bbc8eb1ebbad326d6.png\"/><br/> 然后把脚本放入Kali中跑。在执行以下命令时先执行make命令，不报错后在执行以下命令。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\411ad1b4bc8a47d784664ec35073dda1.png\"/><br/> 然后进行这一代码，算出值。get传参传入原来rand()的值，然后抓包修改cookie，改成token的值为计算后的值，提交即可得到flag。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\f3d4d92435124467aa61e28727cdc3f3.png\"/><br/> 1.php中rand()函数和mt_rand()函数<br/> 看菜鸟教程中的解释。<img alt=\"在这里插入图片描述\" src=\"image\\9331fd85183d45b7ad583065ba12aaa7.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\3891112e50314bdfa33d03e7f8b2d889.png\"/></p>\n<h1><a id=\"web26_103\"></a>六、web26----爆破弱口令</h1>\n<p>题目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ee5efdaf5d6a4536b1f3238573eea838.png\"/><br/> 抓个包试试<img alt=\"在这里插入图片描述\" src=\"image\\3aaaaa7d08664dd292065e55c39cf760.png\"/><br/> 直接爆破吧，即可得到flag<br/> <img alt=\"在这里插入图片描述\" src=\"image\\4b32222adfe2453290c63b2f3d05e3bb.png\"/></p>\n<h1><a id=\"web27_109\"></a>七、web27----出生日期爆破</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\7eb43bffaf864e339e1e3ae6b02cb06e.png\"/><br/> 信息收集一下其它相关信息可发现有名单<br/> <img alt=\"在这里插入图片描述\" src=\"image\\46074a8b581649dbac44ab43abafa849.png\"/><br/> 发现这表单中缺少年月日，那用bp继续爆破生日<br/> <img alt=\"在这里插入图片描述\" src=\"image\\2c237a11ee5f4e0db91e4f21643e35a0.png\"/><br/> 爆破得到完整的身份证，登录后可得flag<br/> <img alt=\"在这里插入图片描述\" src=\"image\\695efacf403b4ef8ac12525512093f04.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\e61023907053434bb59bf933bdb15e33.png\"/></p>\n<h1><a id=\"web28_119\"></a>八、web28----目录爆破</h1>\n<p>题目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\da234a4a25ce458fbab09821f525687e.png\"/><br/> 这个目录有点怪怪的，去掉2.txt,直接试试爆破这一目录<br/> <img alt=\"在这里插入图片描述\" src=\"image\\373ad02ebca54269b71cc73a21043cfc.png\"/><br/> 爆破payload设置<br/> <img alt=\"在这里插入图片描述\" src=\"image\\bf30e3104cfb4719ba938545690c0248.png\"/></p>\n<h1><a id=\"_129\"></a>总结</h1>\n<p>主要是回顾了一些爆破的相关思路，刷CTF题还是可以不断训练，巩固自己学过的知识点。继续加油，冲冲冲！！！</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}