{"blogid": "124351790", "writerAge": "码龄1年", "writerBlogNum": "201", "writerCollect": "608", "writerComment": "29", "writerFan": "1450", "writerGrade": "5级", "writerIntegral": "2517", "writerName": "山茶花开时。", "writerProfileAdress": "writer_image\\profile_124351790.jpg", "writerRankTotal": "7496", "writerRankWeekly": "1056", "writerThumb": "481", "writerVisitNum": "180673", "blog_read_count": "3047", "blog_time": "已于 2022-08-24 21:24:30 修改", "blog_title": "[Mysql] TIMESTAMPDIFF函数", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><strong>TIMESTAMPDIFF函数</strong>用于计算两个日期的时间差</p>\n<p><span style=\"color:#fe2c24;\">语法结构</span></p>\n<pre><code class=\"language-sql\">TIMESTAMPDIFF(unit,datetime_expr1,datetime_expr2)</code></pre>\n<p><span style=\"color:#fe2c24;\">参数说明 </span></p>\n<p>unit: 日期比较返回的时间差单位，常用可选值如下:</p>\n<blockquote>\n<p>SECOND：秒</p>\n<p>MINUTE：分钟</p>\n<p>HOUR：小时</p>\n<p>DAY：天</p>\n<p>WEEK：星期</p>\n<p>MONTH：月</p>\n<p>QUARTER：季度</p>\n<p>YEAR：年</p>\n</blockquote>\n<p>datetime_expr1: 要比较的日期1</p>\n<p>datetime_expr2: 要比较的日期2</p>\n<p><strong>TIMESTAMPDIFF函数</strong>返回<span style=\"color:#fe2c24;\"><span style=\"background-color:#fef2f0;\">datetime_expr2 - datetime_expr1</span></span>的结果，其中datetime_expr1和datetime_expr2可以是<span style=\"color:#fe2c24;\"><span style=\"background-color:#fef2f0;\">DATE</span></span>或<span style=\"color:#fe2c24;\"><span style=\"background-color:#fef2f0;\">DATETIME</span></span>类型值</p>\n<p><span style=\"color:#fe2c24;\">示例 </span></p>\n<pre><code class=\"language-sql\">-- 相差：25秒\nSELECT TIMESTAMPDIFF(SECOND,'2022-04-23 14:57:00','2022-04-23 14:57:25');\n-- 相差：5分钟\nSELECT TIMESTAMPDIFF(MINUTE,'2022-04-23 15:00:00','2022-04-23 15:05:00');\n-- 相差：5小时\nSELECT TIMESTAMPDIFF(HOUR,'2022-04-23 11:20:00', '2022-04-23 16:20:00');\n-- 相差：2天\nSELECT TIMESTAMPDIFF(DAY,'2022-04-23 11:20:00', '2022-04-25 11:20:00');\n-- 相差：1星期\nSELECT TIMESTAMPDIFF(WEEK,'2022-04-23 11:20:00', '2022-04-30 11:20:00');\n-- 相差：1月\nSELECT TIMESTAMPDIFF(MONTH,'2022-04-23 11:20:00', '2022-05-30 11:20:00');\n-- 相差：1季度\nSELECT TIMESTAMPDIFF(QUARTER,'2022-04-23 11:20:00', '2022-07-23 11:20:00');\n-- 相差：1年\nSELECT TIMESTAMPDIFF(YEAR,'2022-04-23 11:20:00', '2023-04-23 11:20:00');\n</code></pre>\n<blockquote>\n<p>TIMESTAMPDIFF函数允许其搭配使用的参数datetime_expr1和datetime_expr2具有混合类型</p>\n<p><span style=\"color:#fe2c24;\">案例</span></p>\n<p>datetime_expr1是DATE类型值，datetime_expr2是DATETIME类型值，TIMESTAMPDIFF函数会将datetime_expr1自动转换成DATETIME类型值(即在日期后面加上时间<span style=\"color:#fe2c24;\"><span style=\"background-color:#fef2f0;\">“00:00:00”</span></span>) </p>\n<pre><code class=\"language-sql\">-- 12\nSELECT TIMESTAMPDIFF(HOUR,'2022-04-27','2022-04-27 12:00:00');\n-- 12\nSELECT TIMESTAMPDIFF(HOUR,'2022-04-27 00:00:00','2022-04-27 12:00:00');</code></pre>\n<p>上述两行代码等价，返回的都是相同的结果</p>\n</blockquote>\n<p>TIMESTAMPDIFF函数可以结合日期函数进行搭配使用</p>\n<pre><code class=\"language-sql\">-- 可以结合日期函数进行搭配使用\nSELECT TIMESTAMPDIFF(SECOND,'2022-04-23', CURRENT_DATE());\nSELECT TIMESTAMPDIFF(SECOND,'2022-04-23 15:15:00',NOW());\nSELECT TIMESTAMPDIFF(SECOND,'2022-04-23 15:15:00',CURRENT_TIMESTAMP());\n\n-- 上述日期函数补充说明\n-- CURRENT_DATE()用于返回当前时间\n-- 示例结果:2022-04-27\nSELECT CURRENT_DATE();\n\n-- NOW()用于返回当前日期和时间\n-- 示例结果:2022-04-27 11:27:28\nSELECT NOW();\n\n-- CURRENT_TIMESTAMP()用于返回当前日期和时间\n-- 示例结果:2022-04-27 11:30:25\nSELECT CURRENT_TIMESTAMP();</code></pre>\n<p><span style=\"color:#4da8ee;\"><strong>练习案例</strong></span></p>\n<p><span style=\"color:#494949;\">导入数据</span></p>\n<pre><code class=\"language-sql\">DROP TABLE IF EXISTS Student;\nCREATE TABLE Student (\n\tSId VARCHAR (10),\n\tSname VARCHAR (10),\n\tSage datetime,\n\tSsex VARCHAR (10)\n)\nENGINE = InnoDB \nDEFAULT CHARSET = utf8;\nINSERT INTO Student(SId,Sname,Sage,Ssex)\nVALUES('01' , '赵雷' , '1990-01-01' , '男')\n,('02' , '钱电' , '1990-12-21' , '男')\n,('03' , '孙风' , '1990-05-20' , '男')\n,('04' , '李云' , '1990-08-06' , '男')\n,('05' , '周梅' , '1991-12-01' , '女')\n,('06' , '吴兰' , '1992-03-01' , '女')\n,('07' , '郑竹' , '1989-07-01' , '女')\n,('08' , '张三' , '2017-12-20' , '女')\n,('09' , '李四' , '2017-12-25' , '女')\n,('11' , '李四' , '2017-12-30' , '女')\n,('12' , '孙七' , '2018-01-01' , '女');</code></pre>\n<p><strong>Student表 </strong></p>\n<p class=\"img-center\"><img alt=\"\" height=\"245\" src=\"image\\d826a3ca59f84b0684132caf49e7825c.png\" width=\"338\"/></p>\n<p><span style=\"color:#fe2c24;\">问题:</span>按照出生日期来算学生年龄，其中当前月日&lt;出生年月的月日，则年龄减一</p>\n<blockquote>\n<p>解题思路</p>\n<p>使用NOW()、TIMESTAMPDIFF()函数计算年龄</p>\n</blockquote>\n<pre><code class=\"language-sql\">SELECT *, TIMESTAMPDIFF(YEAR,Sage,NOW())AS age\nFROM Student;</code></pre>\n<p>结果展示:</p>\n<p class=\"img-center\"><img alt=\"\" height=\"248\" src=\"image\\94ce9e7d3f7f4a2da81698fa44c06f17.png\" width=\"388\"/></p>\n</div>\n</div>"}