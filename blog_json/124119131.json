{"blogid": "124119131", "writerAge": "码龄5年", "writerBlogNum": "72", "writerCollect": "246", "writerComment": "36", "writerFan": "17", "writerGrade": "4级", "writerIntegral": "979", "writerName": "ly_zszcyx", "writerProfileAdress": "writer_image\\profile_124119131.jpg", "writerRankTotal": "23990", "writerRankWeekly": "73914", "writerThumb": "40", "writerVisitNum": "86407", "blog_read_count": "2202", "blog_time": "于 2022-04-12 15:01:36 发布", "blog_title": "Qt 使用-自定义菜单栏", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>Qt 学习笔记</p>\n<p>使用Qt设计及界面时，常用的两种方式添加菜单，第一使用UI界面添加，第二种 在代码中添加菜单。</p>\n<p>本次示例，为加深学习映象，故混合使用</p>\n<h1>使用UI添加菜单</h1>\n<p>直接在菜单栏输入：</p>\n<p><img alt=\"\" height=\"467\" src=\"image\\f5c0f88f5171437ca610669b72d16062.png\" width=\"1158\"/></p>\n<p></p>\n<p> 注意： 子菜单可能无法输入中文，可在Action Editor 中修改文本与提示信息<img alt=\"\" height=\"731\" src=\"image\\3bd6da9afc924855b2875b66e7f58431.png\" width=\"987\"/></p>\n<h1>使用代码</h1>\n<p><strong>QMenuBar </strong>--菜单栏类：菜单栏类给窗口提供水平菜单栏，此菜单栏占用窗口上方区域，垂直高度不变，水平宽度为窗口宽度，可随窗口大小变化而变化。</p>\n<p><strong>QMenu </strong>--菜单项，包含各个子菜单。<strong>QMenu还可以用来创建弹出菜单</strong>。</p>\n<p><strong>QAction </strong>--子菜单，一个子菜单对应一个操作。</p>\n<p><img alt=\"\" height=\"296\" src=\"image\\7419983b740d49bb922f8c5d2ea5ba50.png\" width=\"477\"/></p>\n<p> 源码：</p>\n<p>如果出现以下错误</p>\n<p><img alt=\"\" height=\"148\" src=\"image\\468016a3184b417c92d030d6e5d945a5.png\" width=\"495\"/></p>\n<p>检查是否有菜单项没有初始化</p>\n<p>如：我的pMenuTest1 没有初始化</p>\n<p><img alt=\"\" height=\"399\" src=\"image\\089b989742c643d5b7d7328baf0530b2.png\" width=\"514\"/></p>\n<p> 源码：</p>\n<p>mainwindow.h</p>\n<pre><code class=\"language-cpp\">#ifndef MAINWINDOW_H\n#define MAINWINDOW_H\n\n#include &lt;QMainWindow&gt;\n\nQT_BEGIN_NAMESPACE\nnamespace Ui { class MainWindow; }\nQT_END_NAMESPACE\n\nclass MainWindow : public QMainWindow\n{\n    Q_OBJECT\n\npublic:\n    MainWindow(QWidget *parent = nullptr);\n    ~MainWindow();\n\n    //菜单栏\n    QMenuBar *pMenuBar;\n    //菜单项\n    QMenu *pMenuTest;\n\n    //子菜单\n    QAction *pActionTest;\n    QAction *pActionTest1;\n\npublic slots:\n    void openFileWindow();\n\nprivate:\n    Ui::MainWindow *ui;   \n};\n#endif // MAINWINDOW_H\n</code></pre>\n<p>mainwindow.cpp</p>\n<p> 我使用utf-8 可能存在乱码现象，使用</p>\n<pre>QStringLiteral(\"中文\") 解决</pre>\n<pre><code class=\"language-cpp\">#include \"mainwindow.h\"\n#include \"ui_mainwindow.h\"\n#include &lt;QFileDialog&gt;\n\n#define USE_DEFAULT_MENU_BAR \"use_default_menu_bar\"\n\nMainWindow::MainWindow(QWidget *parent)\n    : QMainWindow(parent)\n    , ui(new Ui::MainWindow)\n{\n    ui-&gt;setupUi(this);\n    //指定菜单栏\n#ifdef USE_DEFAULT_MENU_BAR\n    //添加菜单栏(此处添加为的为QMainWindow自带的菜单）\n    pMenuBar = this-&gt;menuBar();\n#else\n    //添加自定义菜单\n    pMenuBar = new QMenuBar(this);\n#endif\n    //定义菜单项\n    //（&amp;n)代表快捷方式，当窗口获得焦点时按alt+n即可打开“测试”菜单项\n    pMenuTest = new QMenu(QStringLiteral(\"构建(&amp;D)\"),this);\n\n    //定义子菜单\n    //（&amp;s）为子菜单快捷键，当打开该菜单项后，按下‘s’键即可响应\n    pActionTest = new QAction(QStringLiteral(\"构建所有项目(&amp;S)\"),this);\n    //新建一个带图标的菜单项，图标使用资源文件中的资源\n    pActionTest1 = new QAction(QIcon(\":/new/prefix1/resource/soccer_ball.ico\"),QStringLiteral(\"执行QMark\"),this);\n    //将菜单项添加到子菜单\n    pMenuTest-&gt;addAction(pActionTest);\n    pMenuTest-&gt;addAction(pActionTest1);\n    //在菜单项之间添加分割线\n    pMenuTest-&gt;addSeparator();\n\n    //将子菜单添加到菜单栏\n    pMenuBar-&gt;addMenu(pMenuTest);\n\n#ifndef USE_DEFAULT_MENU_BAR\n    //当不使用QMainWindow自带的菜单栏时，必须要加上此行\n    setMenuBar(pMenuBar);\n#endif\n    //添加菜单响应函数\n    connect(ui-&gt;actionOpenFileProj,SIGNAL(triggered()), this, SLOT(openFileWindow()));\n    connect(pActionTest,&amp;QAction::triggered,this,&amp;MainWindow::openFileWindow);\n\n}\n\nMainWindow::~MainWindow()\n{\n    delete ui;\n}\n\nvoid MainWindow::openFileWindow(){\n     QString fileName = QFileDialog::getOpenFileName(NULL, QStringLiteral(\"导入bin文件\"),\".\",QStringLiteral(\"文本文件(*.bin);;所有文件 (*.*)\"));\n}\n\n</code></pre>\n<p> <img alt=\"\" height=\"353\" src=\"image\\5e3b0d3121b446b5bb60d16938847871.png\" width=\"460\"/></p>\n<p> 运行效果：</p>\n<p><img alt=\"\" height=\"816\" src=\"image\\d6b16ccb20c64850bbc4f2504d505e69.png\" width=\"1176\"/></p>\n<p> 点击打开项目<img alt=\"\" height=\"665\" src=\"image\\47adf306ee70483ea5e152076bd0db39.png\" width=\"1040\"/></p>\n<p>参考：</p>\n<p><a href=\"https://www.cnblogs.com/kyzc/p/11962903.html\" title=\"Qt基础之菜单栏 - kyzc - 博客园\">Qt基础之菜单栏 - kyzc - 博客园</a> </p>\n<p> </p>\n</div>\n</div>"}