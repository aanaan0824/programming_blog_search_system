{"blogid": "126661136", "writerAge": "码龄2年", "writerBlogNum": "79", "writerCollect": "799", "writerComment": "580", "writerFan": "499", "writerGrade": "5级", "writerIntegral": "2841", "writerName": "Python-派大星", "writerProfileAdress": "writer_image\\profile_126661136.jpg", "writerRankTotal": "6767", "writerRankWeekly": "209", "writerThumb": "1004", "writerVisitNum": "147800", "blog_read_count": "602", "blog_time": "已于 2022-09-03 08:24:16 修改", "blog_title": "ACL访问控制列表 基础、创建ACL访问控制列表的两种方式、配置ACL访问控制列表规则、修改ACL规则的默认步长。子网掩码、反掩码、通配符掩码的区别和作用。", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"-toc\" style=\"margin-left:0px;\"></p>\n<p id=\"ACL%E7%9A%84%E7%BB%84%E6%88%90%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#ACL%E7%9A%84%E7%BB%84%E6%88%90%EF%BC%9A\">ACL的组成：</a></p>\n<p id=\"%E5%88%9B%E5%BB%BAACL%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%88%9B%E5%BB%BAACL%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%9A\">创建ACL访问控制列表的两种的方式：</a></p>\n<p id=\"1%E3%80%81%E6%95%B0%E5%AD%97%E5%91%BD%E5%90%8D%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#1%E3%80%81%E6%95%B0%E5%AD%97%E5%91%BD%E5%90%8D%EF%BC%9A\">1、数字命名：</a></p>\n<p id=\"2%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%91%BD%E5%90%8D%E6%96%B9%E5%BC%8F%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#2%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%91%BD%E5%90%8D%E6%96%B9%E5%BC%8F%EF%BC%9A\">2、字符串命名方式：</a></p>\n<p id=\"ACL%E5%88%9B%E5%BB%BA%E6%AD%A5%E9%AA%A4%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#ACL%E5%88%9B%E5%BB%BA%E6%AD%A5%E9%AA%A4%EF%BC%9A\">ACL创建步骤：</a></p>\n<p id=\"1%E3%80%81%E5%85%88%E5%88%9B%E5%BB%BAACL%E5%88%97%E8%A1%A8%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#1%E3%80%81%E5%85%88%E5%88%9B%E5%BB%BAACL%E5%88%97%E8%A1%A8%EF%BC%9A\">1、先创建ACL列表：</a></p>\n<p id=\"%E8%BF%9B%E5%85%A5acl%E5%88%97%E8%A1%A8%EF%BC%9A-toc\" style=\"margin-left:80px;\"><a href=\"#%E8%BF%9B%E5%85%A5acl%E5%88%97%E8%A1%A8%EF%BC%9A\">进入acl列表：</a></p>\n<p id=\"2%E3%80%81%E9%85%8D%E7%BD%AEACL%E7%9A%84%E4%B8%80%E6%9D%A1%E6%9D%A1%E8%A7%84%E5%88%99%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#2%E3%80%81%E9%85%8D%E7%BD%AEACL%E7%9A%84%E4%B8%80%E6%9D%A1%E6%9D%A1%E8%A7%84%E5%88%99%EF%BC%9A\">2、配置ACL的一条条规则：</a></p>\n<p id=\"3%E3%80%81%E8%BF%9B%E5%85%A5%E9%9C%80%E8%A6%81%E5%BA%94%E7%94%A8%E8%BF%99%E4%B8%AA%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E6%8E%A5%E5%8F%A3%EF%BC%9A-toc\" style=\"margin-left:40px;\"><a href=\"#3%E3%80%81%E8%BF%9B%E5%85%A5%E9%9C%80%E8%A6%81%E5%BA%94%E7%94%A8%E8%BF%99%E4%B8%AA%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E6%8E%A5%E5%8F%A3%EF%BC%9A\">3、进入需要应用这个访问控制列表的接口：</a></p>\n<p id=\"%E4%BF%AE%E6%94%B9%E8%A7%84%E5%88%99%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%3A%EF%BC%88%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%E4%B8%BA5%EF%BC%89-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BF%AE%E6%94%B9%E8%A7%84%E5%88%99%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%3A%EF%BC%88%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%E4%B8%BA5%EF%BC%89\">修改规则默认步长:（默认步长为5）</a></p>\n<p id=\"%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%EF%BC%9A\">子网掩码：</a></p>\n<p id=\"%E5%8F%8D%E6%8E%A9%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E5%8F%8D%E6%8E%A9%E7%A0%81%EF%BC%9A\">反掩码：</a></p>\n<p id=\"%E9%80%9A%E9%85%8D%E7%AC%A6%E6%8E%A9%E7%A0%81%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#%E9%80%9A%E9%85%8D%E7%AC%A6%E6%8E%A9%E7%A0%81%EF%BC%9A\">通配符掩码：</a></p>\n<p id=\"ACL%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E6%A0%87%E8%AF%86%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#ACL%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E6%A0%87%E8%AF%86%EF%BC%9A\">ACL的分类与标识：</a></p>\n<p id=\"ACL%E5%8C%B9%E9%85%8D%E6%9C%BA%E5%88%B6%EF%BC%9A-toc\" style=\"margin-left:0px;\"><a href=\"#ACL%E5%8C%B9%E9%85%8D%E6%9C%BA%E5%88%B6%EF%BC%9A\">ACL匹配机制：</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h1 id=\"ACL%E7%9A%84%E7%BB%84%E6%88%90%EF%BC%9A\">ACL的组成：</h1>\n<p>ACL由若干条permit或deny语句组成，每条语句就是该ACL的一条规则，每条语句中的permit或deny就是与这条规则相对应的处理动作。</p>\n<blockquote>\n<p>permit  ----&gt;  允许列表</p>\n<p>deny    ----&gt;  拒绝列表</p>\n</blockquote>\n<h1 id=\"%E5%88%9B%E5%BB%BAACL%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%9A%84%E6%96%B9%E5%BC%8F%EF%BC%9A\">创建ACL访问控制列表的两种的方式：</h1>\n<h2 id=\"1%E3%80%81%E6%95%B0%E5%AD%97%E5%91%BD%E5%90%8D%EF%BC%9A\">1、数字命名：</h2>\n<pre><code>acl number +数字（0~4294967294）\n</code></pre>\n<h2 id=\"2%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%91%BD%E5%90%8D%E6%96%B9%E5%BC%8F%EF%BC%9A\">2、字符串命名方式：</h2>\n<pre><code>acl name +字母 +acl类型\n\n举例两种acl类型：\nBasic --- 基础acl\nAdvanced --- 高级acl</code></pre>\n<p>如下图所示字符串命名方式： </p>\n<p><img alt=\"\" height=\"302\" src=\"image\\af1ade939754448a93995988af8a5fa5.png\" width=\"750\"/> </p>\n<p> </p>\n<h1 id=\"ACL%E5%88%9B%E5%BB%BA%E6%AD%A5%E9%AA%A4%EF%BC%9A\">ACL创建步骤：</h1>\n<h2 id=\"1%E3%80%81%E5%85%88%E5%88%9B%E5%BB%BAACL%E5%88%97%E8%A1%A8%EF%BC%9A\">1、先创建ACL列表：</h2>\n<pre><code>acl number 2000      //创建基础访问控制列表的编号为2000 </code></pre>\n<h3 id=\"%E8%BF%9B%E5%85%A5acl%E5%88%97%E8%A1%A8%EF%BC%9A\">进入acl列表：</h3>\n<pre><code>acl +acl列表名字\n\n进入acl列表2000\nacl 2000</code></pre>\n<h2 id=\"2%E3%80%81%E9%85%8D%E7%BD%AEACL%E7%9A%84%E4%B8%80%E6%9D%A1%E6%9D%A1%E8%A7%84%E5%88%99%EF%BC%9A\">2、<strong><strong>配置ACL的一条条规则：</strong></strong></h2>\n<p>（用户自定义规则）---（规则编号的范围：0~4294967294）</p>\n<pre><code>rule 5 permit source 1.1.1.0 0.0.0.255   \n //rele 5 规则的编号为5（可以不写，每个规则编号默认隔开5号【默认编号间隔步长为5，步长是为了后续在旧规则之间，插入新的规则】），编号越小越优先处理\n\nrule 10 deny source 2.2.2.0 0.0.0.255    // permit、deny允许通过或拒绝该流量通过\n\nrule 15 permit source 3.3.3.0 0.0.0.255  // 匹配项（此处为源IP地址）</code></pre>\n<h2 id=\"3%E3%80%81%E8%BF%9B%E5%85%A5%E9%9C%80%E8%A6%81%E5%BA%94%E7%94%A8%E8%BF%99%E4%B8%AA%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%88%97%E8%A1%A8%E7%9A%84%E6%8E%A5%E5%8F%A3%EF%BC%9A\" style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>3、进入需要应用这个访问控制列表的接口：</strong></strong></h2>\n<pre><code>traffic-filter inbound acl 2000   //流量过滤使用编号为acl 2000的访问控制列表</code></pre>\n<p><img alt=\"\" height=\"318\" src=\"image\\898ffe7b43a04efc860e50172de61232.png\" width=\"692\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"color:#fe2c24;\"><strong>注：</strong></span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>1、</strong></strong>每个ACl列表末尾隐含的规则----每个ACL列表默认规则，我们看不到的规则</p>\n<pre><code>Rule 4294967294 permit any  \n //编号为4294967294的规则，默认允许所有数据通过（也就是没被前面规则拒绝的流量都会被允许通过【华为设备默认通过】【思科设备默认全部拒绝】）</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\">2、越精确的ACl规则越先写，规则号数越前，因为数据匹配到该规则后，就不会继续往下匹配。</p>\n<h2 id=\"%E4%BF%AE%E6%94%B9%E8%A7%84%E5%88%99%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%3A%EF%BC%88%E9%BB%98%E8%AE%A4%E6%AD%A5%E9%95%BF%E4%B8%BA5%EF%BC%89\" style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"color:#fe2c24;\"><strong><strong>修改规则默认步长:</strong></strong>（默认步长为5）</span></h2>\n<p style=\"margin-left:.0001pt;text-align:justify;\">#需进入访问控制列表设置</p>\n<pre><code>Step 10   //修改acl规则默认步长为10，已存在的规则也会重新以步长为10的间隔排序好。</code></pre>\n<p><img alt=\"\" height=\"186\" src=\"image\\e1949a1d860b4173bae6a0dafe87485f.png\" width=\"286\"/></p>\n<p><img alt=\"\" height=\"569\" src=\"image\\348e36ace0e4469e8dbaedbdf8d08188.png\" width=\"641\"/></p>\n<p></p>\n<p></p>\n<h1 id=\"%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%EF%BC%9A\" style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>子网掩码：</strong></strong></h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">配置地址时，配置子网掩码</p>\n<h1 id=\"%E5%8F%8D%E6%8E%A9%E7%A0%81%EF%BC%9A\" style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>反掩码：</strong></strong></h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">ospf配置用到反掩码，255.255.255.255 -（减去）子网掩码。0代表匹配，1代表忽略，反掩码0和1是连续的。</p>\n<h1 id=\"%E9%80%9A%E9%85%8D%E7%AC%A6%E6%8E%A9%E7%A0%81%EF%BC%9A\" style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>通配符掩码：</strong></strong></h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">ACL用到通配符掩码，0代表匹配，1代表忽略，0和1可以不连续。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">注：要精确放行某个IP地址就需要全0的通配符掩码。</p>\n<blockquote>\n<p style=\"margin-left:.0001pt;text-align:justify;\">例：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">#全0的通配符掩码用于匹配一个具体的地址。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">192.168.1.1 0.0.0.0</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">#放行某一个网段的话，就用那个位数的通配符掩码</p>\n</blockquote>\n<p> <img alt=\"\" height=\"336\" src=\"image\\b44946c77d7f4d5a89b9fc0a13127b92.png\" width=\"691\"/></p>\n<h1 id=\"ACL%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E6%A0%87%E8%AF%86%EF%BC%9A\">ACL的分类与标识：</h1>\n<p>创建acl访问控制列表时，使用的数字编号在2000到2999这个范围，则创建的是基本acl。</p>\n<p><span style=\"color:#fe2c24;\">基本acl只会管理看源IP地址，不会管目标IP地址</span></p>\n<pre><code>acl number 2000    //创建一个基本acl访问控制列表\n\n简写：acl 2000\n退出访问控制列表后，想要回到访问控制列表继续配置规则时，进入方式也是：acl 200\n进入acl访问控制列表：\nacl +ACL列表名</code></pre>\n<p>创建acl访问控制列表时，使用数字编号在3000到3999这个范围，则创建的基本acl。以此类推。</p>\n<p>高级acl会看源IP地址，也会看目标IP地址，可以更精确的确定规则</p>\n<pre><code>acl number 3000    //创建一个高级acl，列表名为3000</code></pre>\n<p><img alt=\"\" height=\"324\" src=\"image\\8fae68c164e840109ec228d94d745f45.png\" width=\"691\"/></p>\n<h1>创建基础访问控制列表：</h1>\n<h3><strong>acl 2000~2999都是基础访问控制列表：</strong></h3>\n<pre><code>acl number 2000</code></pre>\n<h3><strong>定义规则：</strong></h3>\n<p> 基本acl只能对数据的源ip地址进行控制，拒绝或允许某网段的数据访问，</p>\n<pre><code>rule 100 deny source 1.1.1.0 0.0.0.255 \n拒绝来自1.1.1.0网段的数据通过该接口</code></pre>\n<h1><img alt=\"\" height=\"193\" src=\"image\\df6f1160549443d386252da0500aeed9.png\" width=\"446\"/></h1>\n<h3> 进入接口配置流量过滤器：</h3>\n<p> 进入需要配置流量过滤器的接口</p>\n<pre><code>traffic-filter inbound acl 2000   //入站流量控制\ntraffic-filter outbound acl 2000  //出站流量控制\n</code></pre>\n<h1><img alt=\"\" height=\"260\" src=\"image\\9603179ddc9f4ad2a14be0e70bc2e4eb.png\" width=\"640\"/></h1>\n<h1>创建高级访问控制列表步骤：</h1>\n<h3><strong>acl 3000~3999都是高级访问控制列表：</strong></h3>\n<pre><code>acl number 3000</code></pre>\n<h3><strong> 定义规则：</strong></h3>\n<p><strong>高级访问控制列表可以实现源ip到目标ip的数据访问控制，可以更精确更精准的实现数据访问操控。</strong></p>\n<pre><code> rule 21 permit ip source 3.3.3.0 0.0.0.255 destination 1.1.1.0 0.0.0.255 \n\n1、定义编号为21号的规则\n2、允许IP协议数据通过\n3、允许源IP地址网段为3.3.3.0 目的地址网段是1.1.1.0 的数据通过</code></pre>\n<h3><strong>进入接口使用该访问控制列表规则 ：</strong></h3>\n<p>流量过滤器使用acl 3000的访问控制列表</p>\n<pre><code>traffic-filter inbound acl 3000\n</code></pre>\n<p><img alt=\"\" height=\"227\" src=\"image\\35e65f2401da47c68b52c341c9303fb9.png\" width=\"658\"/></p>\n<p><strong>实例： </strong></p>\n<p><img alt=\"\" height=\"323\" src=\"image\\75d5bed047b34b77b4fc8ebceb22b1ed.png\" width=\"1139\"/><strong> 小提示：</strong>每个规则编号默认间隔5位整数位<img alt=\"\" height=\"233\" src=\"image\\6e43fa331d3d4ebbab18febaa8006c02.png\" width=\"835\"/></p>\n<p> 然后就可以实现3.3.3.0网段的pc机能与1.1.1.0网段的pc机通信，与3.3.3.0网段的pc机无法通信。<img alt=\"\" height=\"667\" src=\"image\\c51425b52ca4482fa942aecb2379bc7a.png\" width=\"976\"/></p>\n<p></p>\n<p> 其余未命中规则的pc机可以相互访问（华为设备）<img alt=\"\" height=\"666\" src=\"image\\25fd2159e7f54a55a5e4bc4f048bfa19.png\" width=\"977\"/></p>\n<p></p>\n<h1 id=\"ACL%E5%8C%B9%E9%85%8D%E6%9C%BA%E5%88%B6%EF%BC%9A\">ACL匹配机制：</h1>\n<p>1、数据会在接收和发送时检测接口是否存在ACL访问控制列表。不存在控制列表在则直接通行。</p>\n<p>2、若有访问控制列表，则查看是否存在访问规则。不存在规则则直接通行。</p>\n<p>3、若存在规则，则分析第一条规则。若命中规则，则查看第6条。</p>\n<p>4、若未命中规则，则查看是否有下一条规则。若没有下一条规则，则ACL匹配结果为不匹配，华为设备对ACL匹配结果为不匹配的数据默认为允许通行、思科设备则不允许通行。</p>\n<p>5、访问下一条规则，若命中规则，ACL动作是permit还是deny。</p>\n<p>6、若命中规则为permit，则ACL匹配结果为允许。若命中规则为deny，则ACL匹配结果为拒绝。</p>\n<p><img alt=\"\" height=\"360\" src=\"image\\a6ff66af25e5446db187d53609f3cd83.png\" width=\"692\"/></p>\n<p></p>\n</div>\n</div>"}