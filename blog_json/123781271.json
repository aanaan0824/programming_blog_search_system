{"blogid": "123781271", "writerAge": "码龄2年", "writerBlogNum": "42", "writerCollect": "34", "writerComment": "3", "writerFan": "4", "writerGrade": "3级", "writerIntegral": "432", "writerName": "落尘小C", "writerProfileAdress": "writer_image\\profile_123781271.jpg", "writerRankTotal": "38883", "writerRankWeekly": "320477", "writerThumb": "8", "writerVisitNum": "19873", "blog_read_count": "8608", "blog_time": "于 2022-03-27 21:02:29 发布", "blog_title": "SQL Server修改数据", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p style=\"margin-left:.0001pt;text-align:justify;\">本篇主要讲解的是SQL Server 中修改数据的几种语句：</p>\n<ol><li style=\"text-align:justify;\"><strong><strong>INSERT语句</strong></strong></li><li style=\"text-align:justify;\"><strong><strong>INSERT INTO SELECT语句</strong></strong></li><li style=\"text-align:justify;\"><strong><strong>UPDATE语句</strong></strong></li><li style=\"text-align:justify;\"><strong><strong>DELETE语句</strong></strong></li></ol>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>一：INSERT语句</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">INSERT语句向表中添加新行，以下是INSERT语句的最基本形式：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"66\" src=\"image\\104a4c573b524564bcb8661e3a2818ce.png\" width=\"440\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<ol><li style=\"text-align:justify;\">首先：<span style=\"color:#ff0000;\">table_name</span>指定要插入的表的名称；</li><li style=\"text-align:justify;\">其次，<span style=\"color:#ff0000;\">column_list</span>指定要在其中插入数据的一个或多个列的列表。必须将列的列表包括在括号中并用逗号分隔离列</li><li style=\"text-align:justify;\">如果列在列列表中没有出现，则SQL Server必须能够提供插入值，否则无法插入行。</li><li style=\"text-align:justify;\">SQL Server自动对表中可用的列使用以下值，但不会出现在 INSERT 语句的列列表中：</li></ol>\n<ul><li style=\"text-align:justify;\">如果列具有[IDENTITY]属性，则为下一个增量值。 如果列具有指定的默认值，则为默认值。</li><li style=\"text-align:justify;\">如果列的数据类型是时间戳数据类型（timestamp），则默认为当前时间戳值。</li><li style=\"text-align:justify;\">如果列可以为 NULL 值，则使用 NULL 。</li></ul>\n<p style=\"text-align:justify;\">      5.第三，要在 VALUES 子句中提供插入的值列表。列列表中的每列必须在值列表中具有相应的   值。 此外，必须将值列表括在括号中。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">以下是创建一个名为promotions 的新表：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"167\" src=\"image\\a15a14adeb8547f6a304d3b9f1cf0c94.png\" width=\"384\"/></p>\n<h3 style=\"text-align:justify;\"><span style=\"color:#ed7d31;\">（</span><span style=\"color:#ed7d31;\">在sales模式中创建了一个名为promotions的新表。 promotions表有五列，包括:促销标识号 (promotion_id)，名称(name)，折扣(discount)，开始日期(start_date)和过期日期 (expired_date)。 promotion_id是标识列，因此当向表中添加新行时，SQL Server会自动填充其值。</span><span style=\"color:#ed7d31;\">）</span></h3>\n<p></p>\n<p><img alt=\"\" height=\"88\" src=\"image\\f4998671ed814a8ba26448ba99666eaa.png\" width=\"640\"/></p>\n<p><span style=\"color:#ed7d31;\">注：promotions表暂无任何数据</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">以下语句是将新行添加到promotions表中 (<span style=\"color:#ed7d31;\">添加行数据</span>)：</p>\n<p><img alt=\"\" height=\"285\" src=\"image\\88643f539780436aadffd2b78619c8cf.png\" width=\"693\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"color:#ed7d31;\">注：</span><span style=\"color:#ed7d31;\">在此示例中，为 promotions 表中的四列指定了值。但没有为 promotion_id 列指定值，</span><span style=\"color:#ed7d31;\">这是为什么呢？</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"color:#ed7d31;\">因为SQL Server会自动为此列提供值。</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">查询结果为：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"125\" src=\"image\\de65bcd7effb4ca1b00607ec5a6a9a55.png\" width=\"674\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong>将显示值插入标识列：</strong></p>\n<h2 style=\"text-align:justify;\">通常情况下，不为标识列指定值，因为SQL Server将自动提供，但是，在某些情况下，可能希望在标识列中插入值，例如数据的迁移。</h2>\n<p style=\"margin-left:.0001pt;text-align:justify;\">要为标识列 插入显示值，必须首先执行以下语句：（<span style=\"color:#ed7d31;\">开启</span>）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"45\" src=\"image\\d41780640be94307ac19efea03a59ec6.png\" width=\"659\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">若要关闭标识插入，请使用以下语句：（<span style=\"color:#ed7d31;\">关闭</span>）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"44\" src=\"image\\3dab5b0a33f34b8584e035b1ffb59de9.png\" width=\"653\"/></p>\n<p> </p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">以下是在promotions 表中插入标识列的值：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"364\" src=\"image\\fd4298c0e83e4be3b49028d5a8c0e54e.png\" width=\"692\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">INSERT 一次添加多行数据：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">若要一次向表中添加多行数据，请使用以下形式的INSERT语句:</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"162\" src=\"image\\7f035ac97ade47da883abfea36b526da.png\" width=\"692\"/></p>\n<p> <span style=\"color:#ed7d31;\">在此语法中，不使用单个值列表，而是使用多个以逗号分隔的值列表进行插入。 使用此形式的 INSERT 语句，一次可以插入的行数为 1000 行</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>二：INSERT INTO SELECT语句</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">要将其他表中的数据插入另一个表中，请使用以下SQL Server INSERT INTO SELECT 语句：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"74\" src=\"image\\4b8e50869f17477c8ad40d55d04b3e85.png\" width=\"692\"/></p>\n<p> <span style=\"color:#ed7d31;\">在此语法中，查询语句返回的行将插入 target_table 。该查询是从任何其他表中检索数据的有效 SELECT 语句。它必须返回与 column_list 中指定的列对应的数据</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">以下所写的语句是将customers表中的所有地址都插入到addresses表中：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"169\" src=\"image\\29311b3fafa240db877a47d21d9b8de8.png\" width=\"692\"/></p>\n<p> <span style=\"color:#ed7d31;\">注：列值要一一对应</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>三：UPDATE语句</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">要修改表中的现有数据，请使用以下 UPDATE 语句语法：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"75\" src=\"image\\caecbd2ddd5146799aef868e01a1f9cc.png\" width=\"692\"/></p>\n<p> 在上面语法中:</p>\n<p>1.首先，指定要从中更新数据的表的名称；</p>\n<p>2.其次，指定要更新的列 c1 ，c2 ... ，cn 和值 v1 ，v2  ... vn 的列表； </p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">3.第三，在 WHERE 子句中指定条件以选择更新的行。WHERE子句是可选的。 如果不指定 WHERE 子 句，则表中的所有行都将更新；</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">四：DELETE语句</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">删除表中的现有数据，请使用以下 DELETE 语句语法：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"51\" src=\"image\\5b607af2703f4a1bb58ee7c5e66fdbfc.png\" width=\"692\"/> 在上面语法中:</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">1.首先，指定要从中删除数据的表的名称。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">2.其次，在 WHERE 子句中指定条件以选择删除的行。WHERE子句是可选的。 如果不指定 WHERE子句，则表中的所有行都将被删除。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"112\" src=\"image\\6889bbc79a7b435ebff6cad99cce3ea1.png\" width=\"692\"/></p>\n<p> </p>\n</div>\n</div>"}