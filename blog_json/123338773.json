{"blogid": "123338773", "writerAge": "码龄2年", "writerBlogNum": "39", "writerCollect": "5028", "writerComment": "764", "writerFan": "4919", "writerGrade": "5级", "writerIntegral": "3092", "writerName": "鸢也", "writerProfileAdress": "writer_image\\profile_123338773.jpg", "writerRankTotal": "5729", "writerRankWeekly": "2328", "writerThumb": "1500", "writerVisitNum": "191468", "blog_read_count": "68505", "blog_time": "于 2022-03-07 20:32:13 发布", "blog_title": "自动化测试——selenium（完结篇)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"selenium_0\"></a>自动化测试——selenium（完结篇)</h1>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#selenium_0\">自动化测试——selenium（完结篇)</a></li><li><ul><li><a href=\"#_5\">一、元素操作方法</a></li><li><a href=\"#_47\">二、浏览器操作方法</a></li><li><a href=\"#_186\">三、获取元素信息操作</a></li><li><a href=\"#__267\">四、鼠标操作 （需要实例化鼠标对象）</a></li><li><ul><li><a href=\"#41__295\">4.1 鼠标右键及双击</a></li><li><a href=\"#42__328\">4.2 鼠标拖拽</a></li><li><a href=\"#43___361\">4.3 鼠标悬停 【重点】</a></li></ul>\n</li><li><a href=\"#_394\">五、键盘操作（不需要实例化对象）☆</a></li><li><a href=\"#_454\">六、元素等待</a></li><li><a href=\"#_508\">七、下拉框（需要实例化下拉框）</a></li><li><a href=\"#_567\">八、弹出框</a></li><li><a href=\"#_642\">九、滚动条</a></li><li><a href=\"#frame__689\">十、切换frame表单 ☆</a></li><li><ul><li><a href=\"#101_frame_723\">10.1 连续切换frame</a></li></ul>\n</li><li><a href=\"#__755\">十一、多窗口的切换 ☆</a></li><li><a href=\"#_811\">十二、截图操作</a></li><li><a href=\"#_848\">十三、验证码</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<blockquote>\n<p>前言：看这篇帖子，最好要在知道定位八大元素的基础之上才能够比较熟练的看完这篇帖子，<a href=\"https://blog.csdn.net/qq_54219272/article/details/123310772?spm=1001.2014.3001.5501\">selenium八大元素基础</a> ，点击这个链接，这个链接是八大元素定位的帖子。</p>\n</blockquote>\n<h2><a id=\"_5\"></a>一、元素操作方法</h2>\n<pre><code class=\"prism language-yacas\">方法：\n1、.send_keys()  # 输入方法\n2、.click()  # 点击方法\n3、.clear()  # 清空方法\n</code></pre>\n<blockquote>\n<p>注意：在输入方法之前一定要清空操作!!</p>\n</blockquote>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 导包</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\n<span class=\"token comment\"># 实例化浏览器</span>\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 打开网址</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 需求</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'#kw'</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'易烊千玺'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 清空</span>\nele<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'王嘉尔'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 时间轴看效果</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭页面</span>\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"浏览器清除\" src=\"https://img-blog.csdnimg.cn/img_convert/681a02324de378894da117cf4d5fdda5.gif\"/></p>\n<h2><a id=\"_47\"></a>二、浏览器操作方法</h2>\n<p>常用的浏览器操作系统API</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 方法</span>\n<span class=\"token triple-quoted-string string\">\"\"\"\n1、driver.maximize_window()  # 最大化浏览器\n2、driver.set_window_size(w,h)  # 设置浏览器大小 单位像素 【了解】\n3、driver.set_window_position(x,y)  # 设置浏览器位置  【了解】\n4、driver.back() # 后退操作\n5、driver.forward() # 前进操作\n6、driver.refrensh() # 刷新操作\n7、driver.close() # 关闭当前主窗口（主窗口：默认启动那个界面，就是主窗口）\n8、driver.quit() # 关闭driver对象启动的全部页面\n9、driver.title # 获取当前页面title信息\n10、driver.current_url # 获取当前页面url信息\n\"\"\"</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n应用：driver.maximize_windows()  # 窗口最大化\n\t driver.set_window_size(w,h) # 设置浏览器大小 【了解】\n\t driver.set_window_position(x,y) # 设置浏览器窗口位置 【了解】\n\"\"\"</span>\n\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 窗口最大化</span>\ndriver<span class=\"token punctuation\">.</span>maximize_window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置浏览器宽，高 【了解】</span>\ndriver<span class=\"token punctuation\">.</span>set_window_size<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置窗口浏览器位置  【了解】</span>\ndriver<span class=\"token punctuation\">.</span>set_window_position<span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n</code></pre>\n<p><img alt=\"浏览器位置切换\" src=\"https://img-blog.csdnimg.cn/img_convert/50cb11b7dc2b6a61ad992a90245a7d1a.gif\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\ndriver.back()\ndriver.forward()\ndriver.refresh()\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.sogou.com/'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_css_selector<span class=\"token punctuation\">(</span><span class=\"token string\">'#query'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'易烊千玺'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'stb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 后退</span>\ndriver<span class=\"token punctuation\">.</span>back<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 前进</span>\ndriver<span class=\"token punctuation\">.</span>forward<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 刷新</span>\ndriver<span class=\"token punctuation\">.</span>refresh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/8974b3d0f3e74c5ea2f8c7d229782d21.gif\"/></p>\n<pre><code class=\"prism language-python\">\n<span class=\"token triple-quoted-string string\">\"\"\"\ndriver.close() # 关闭当前主窗口，默认启动的界面就是主窗口\ndriver.quit() # 关闭全部页面\ndriver.title  # 获取页面标题\ndriver.current_url  # 获取页面地址 \n\"\"\"</span>\n\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.sogou.com/'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">'图片'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 这两个属性可以用来做断言使用</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前页面标题：\"</span><span class=\"token punctuation\">,</span> driver<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前页面的url：\"</span><span class=\"token punctuation\">,</span> driver<span class=\"token punctuation\">.</span>current_url<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 这里关闭的是原始页面，而不是新的页面，只有完成页面切换才可以关闭新的页面</span>\n<span class=\"token comment\"># 场景：关闭单个页面使用</span>\ndriver<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭浏览器驱动对象的所有页面</span>\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"red\" size=\"3\">注意：</font><code>driver.close()</code> ，<font color=\"red\" size=\"3\">当前关闭的是主窗口，只有完成页面切换才可以关闭当前新的页面 </font></p>\n<p>提示：</p>\n<p>1、<code>driver.title</code> 和 <code>drivet.current_url</code>是属性没有括号。应用场景：一般判断上不操作是否执行成功。</p>\n<p>2、<code>driver.maximize_window()</code> 一般为前置代码放到获取driver地址后，进行浏览器窗口的最大化</p>\n<p>3、<code>driver.refresh()</code> 向浏览器重新发出请求，刷新页面，在cookie 会用到</p>\n<p>4、<code>driver.close()</code> 和 <code>driver.quit()</code> 的区别：</p>\n<ul><li><code>close()</code>:关闭当前主窗口</li><li><code>quit()</code>:关闭由driver对象启动的所有页面</li><li>如果只有一个窗口那么<code>quit（）</code>和 <code>close（）</code>没有区别。</li></ul>\n<h2><a id=\"_186\"></a>三、获取元素信息操作</h2>\n<p>常用元素信息操作API</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n方法：\n1、text 获取元素的文本； 如：driver.text\n2、size 获取元素的大小： 如：driver.size\n3、get_attribute 获取元素属性值；如：driver.get_attribute(\"id\") ,传递的参数是元素的属性名\n4、is_displayed 判断元素是否可见 如：element.is_displayed()\n5、is_enabled 判断元素是否可用 如：element.is_enabled()\n6、is_selected 判断元素是否被选中 如：element.is_selected()\n\n\"\"\"</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\ntext  获取元素文本 ,没有（）\nsize  获取元素大小 ，没有（）\nget_attribute(\"属性名\") 获取的是属性值\n\"\"\"</span>\n\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.sogou.com/'</span><span class=\"token punctuation\">)</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'query'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"目标元素尺寸：\"</span><span class=\"token punctuation\">,</span> ele<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">)</span>\n\nnew_ele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'hanyu'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"目标元素文本：\"</span><span class=\"token punctuation\">,</span> new_ele<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\nlink <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_link_text<span class=\"token punctuation\">(</span><span class=\"token string\">\"图片\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"目标元素属性值：\"</span><span class=\"token punctuation\">,</span> link<span class=\"token punctuation\">.</span>get_attribute<span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭浏览器驱动对象的所有页面</span>\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<pre><code class=\"prism language-python\">\n<span class=\"token triple-quoted-string string\">\"\"\"\nis_displayed() 判断元素是否可见，如：element.is_displayed\nis_enabled() 判断元素是否可用， 如：element.is_enabled\nis_selected() 判断元素是否被选中，如：element.is_selected\n\"\"\"</span>\n\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8CA.html'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 判断元素是否可见，不可见并不代表不能定位</span>\nspan <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_name<span class=\"token punctuation\">(</span><span class=\"token string\">'sp1'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"元素是否可见：\"</span><span class=\"token punctuation\">,</span> span<span class=\"token punctuation\">.</span>is_displayed<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nbtn <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'cancelA'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"元素是否可用：\"</span><span class=\"token punctuation\">,</span> btn<span class=\"token punctuation\">.</span>is_enabled<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncheck <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'lia'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"元素是否被选中：\"</span><span class=\"token punctuation\">,</span> check<span class=\"token punctuation\">.</span>is_selected<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 关闭浏览器驱动对象的所有页面</span>\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"red\" size=\"3\">注意：里面的返回的结果都是<code>True</code> 和 <code>False</code>。</font></p>\n<h2><a id=\"__267\"></a>四、鼠标操作 （需要实例化鼠标对象）</h2>\n<p>1、我们有了鼠标为什么还要使用鼠标操作？？</p>\n<p>​ 为了满足丰富的html鼠标效果，必须使用对应的方法。</p>\n<p>2、鼠标时间对应的方法在那个类中？</p>\n<p>​ <code>ActionChains</code>类,<code>实例化 鼠标对象</code></p>\n<p>导包：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>action_chains <span class=\"token keyword\">import</span> ActionChains\n</code></pre>\n<p>3、鼠标事件常用的操作 ☆</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n1、context_click(element) # 右击\n2、double_click(element)  #双击\n3、double_and_drop(source, target)  # 拖拽\n4、move_to_element(element)  # 悬停 【重点】\n5、perform()  # 执行以上事件的方法 【重点】\n\"\"\"</span>\n</code></pre>\n<h3><a id=\"41__295\"></a>4.1 鼠标右键及双击</h3>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n鼠标操作：\ncontext_click() 右键\ndouble_click() 鼠标双击\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver <span class=\"token keyword\">import</span> ActionChains\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 定位目标</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'kw'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 实例化 鼠标对象</span>\naction <span class=\"token operator\">=</span> ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>、\n\n<span class=\"token comment\"># 鼠标右键</span>\naction<span class=\"token punctuation\">.</span>context_click<span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 鼠标双击</span>\naction<span class=\"token punctuation\">.</span>double_click<span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 鼠标执行操作！！！不执行没效果</span>\naction<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"42__328\"></a>4.2 鼠标拖拽</h3>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n鼠标操作：\n# 鼠标拖拽\naction.drag_and_drop(source， target)\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver <span class=\"token keyword\">import</span> ActionChains\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/drag.html'</span><span class=\"token punctuation\">)</span>\n\nred <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"div1\"]'</span><span class=\"token punctuation\">)</span>\nblue <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"div2\"]'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 实例化鼠标</span>\naction <span class=\"token operator\">=</span> ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 鼠标拖拽</span>\naction<span class=\"token punctuation\">.</span>drag_and_drop<span class=\"token punctuation\">(</span>red<span class=\"token punctuation\">,</span> blue<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 鼠标执行</span>\naction<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/a474209807a748049117a42ab26995c0.gif\"/></p>\n<h3><a id=\"43___361\"></a>4.3 鼠标悬停 【重点】</h3>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n鼠标操作：\n# 鼠标悬停 【重点】\naction.move_to_element(element)\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver <span class=\"token keyword\">import</span> ActionChains\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>maximize_window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'s-usersetting-top'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 实例化鼠标</span>\naction <span class=\"token operator\">=</span> ActionChains<span class=\"token punctuation\">(</span>driver<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 鼠标悬停</span>\naction<span class=\"token punctuation\">.</span>move_to_element<span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 鼠标执行</span>\naction<span class=\"token punctuation\">.</span>perform<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"red\" size=\"3\">注意: selenium 框架虽然提供了 鼠标右键方法，但是没有提供选择右键菜单方法，可以通过键盘快捷键操作实现</font></p>\n<h2><a id=\"_394\"></a>五、键盘操作（不需要实例化对象）☆</h2>\n<p>1、说明：键盘对应的方法在Keys类中</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 包</span>\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>keys <span class=\"token keyword\">import</span> Keys\n</code></pre>\n<p>2、快捷键（这里只讲windows操作系统的快捷键）：</p>\n<p>​ CONTROL: Ctrl键</p>\n<p>​ BACK_SPACE : 等价于 BACKSPACE （删除）</p>\n<p>​ 其他：可以藏奥Keys底层的定义</p>\n<p>3、应用</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 单键</span>\nelement<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>XXX<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 组合键</span>\nelement<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>XXX<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 注意这里的组合键都是小写</span>\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n键盘操作\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>keys <span class=\"token keyword\">import</span> Keys\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\n\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'kw'</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'易烊千玺'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>BACK_SPACE<span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 组合键 Ctrl + a 全选 ，注意这里的组合键都是小写</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>CONTROL<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>CONTROL<span class=\"token punctuation\">,</span> <span class=\"token string\">'x'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span>Keys<span class=\"token punctuation\">.</span>CONTROL<span class=\"token punctuation\">,</span> <span class=\"token string\">'v'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/ac2d2fcad3084ed5bf6fc106d6b5589d.gif\"/></p>\n<h2><a id=\"_454\"></a>六、元素等待</h2>\n<p>1、为什么要设置元素等待</p>\n<p>​ 由于电脑配置或网络原因，在查找元素时，元素代码未在第一时间内被加载出来，而抛出未找到元素异常。</p>\n<p>2、什么是元素等待</p>\n<p>​ 元素在第一次未找到时，元素等待设置的时长被激活，如果在设置的有效时长内找到元素，继续执行代码，如果超出设置的时长未找打元素，抛出未找到元素异常。</p>\n<p>3、元素等待分类</p>\n<p>​ 隐式等待：针对全局元素生效；（讲这个）</p>\n<p>​ 显示等待：稍微麻烦，有兴趣的可以下去了解，他是针对单个元素生效。</p>\n<p>隐式等待方法：</p>\n<pre><code class=\"prism language-python\">driver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 一般情况下设置30秒</span>\n</code></pre>\n<p>​ 特色：</p>\n<pre><code class=\"prism language-yacas\">1. 针对所有元素生效。\n2. 一般情况下为前置必写代码(1.获取浏览器驱动对象；2. 最大化浏览器；3. 设置隐式等待)\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n隐式等待\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>keys <span class=\"token keyword\">import</span> Keys\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1、获取浏览器驱动对象</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8CA%E7%AD%89%E5%BE%85.html'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 2、窗口最大化</span>\ndriver<span class=\"token punctuation\">.</span>maximize_window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3、设置隐式等待</span>\ndriver<span class=\"token punctuation\">.</span>implicitly_wait<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'userA'</span><span class=\"token punctuation\">)</span>\nele<span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'admin'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_508\"></a>七、下拉框（需要实例化下拉框）</h2>\n<p>1、为什么单独使用下拉框？</p>\n<p>​ 1)、如果option选项没有value值的化，css定位或其他定位就不太方便。</p>\n<p>2、使用Select类</p>\n<p>​ 1）、导包：<code>from selenium.webdriver.support.select improt Select</code></p>\n<p>​ 2）、实例化下拉框：<code>s = Select(element)</code></p>\n<p>​ 3）、调用方法：<code>s.select_by_index()</code>索引从0开始</p>\n<p>3、Select类提供的方法</p>\n<p>​ 1）、select_by_index() # 通过索引定位</p>\n<p>​ 2）、select _by_value() # 通过value值</p>\n<p>​ 3）、select_by_visible_text() # 显示文本</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\nSelect类方法：\n需要实例化下拉框元素定位\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>select <span class=\"token keyword\">import</span> Select\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8CA.html'</span><span class=\"token punctuation\">)</span>\nele <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'selectA'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 实例化下拉框</span>\ns <span class=\"token operator\">=</span> Select<span class=\"token punctuation\">(</span>ele<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># index 索引方法</span>\ns<span class=\"token punctuation\">.</span>select_by_index<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># value 属性值选择目标元素</span>\ns<span class=\"token punctuation\">.</span>select_by_value<span class=\"token punctuation\">(</span><span class=\"token string\">'sz'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># text 采用文本的方式选择目标信息</span>\ns<span class=\"token punctuation\">.</span>select_by_visible_text<span class=\"token punctuation\">(</span><span class=\"token string\">'A北京'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_567\"></a>八、弹出框</h2>\n<p>1、为什么要处理弹出框？</p>\n<p>​ 一旦出现弹出框，如果不进行处理，则后续操作不可实现</p>\n<p>2、弹窗分类</p>\n<p>​ 系统弹窗：JS实现</p>\n<p>​ 自定义弹窗：前端代码封装</p>\n<p>3、对话框的分类：</p>\n<p>​ alert：警告框</p>\n<p>​ confirm：确认框</p>\n<p>​ prompt：提示框</p>\n<p>4、如何处理</p>\n<p>​ 系统弹窗：上面的对话框处理方式都一样；</p>\n<pre><code class=\"prism language-yacas\">步骤：\n1、需要切换到对话框\n\tdriver.switch_to.alert\n2、处理对话框\n\talert.text # 获取文本\n\talert.accept() # 接受\n\talert.dismiss() # 拒接\n</code></pre>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n系统弹窗：\n切换对话框：driver.switch_to.alert\n同意：alert.accept()\n拒绝：alert.dismiss()\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>support<span class=\"token punctuation\">.</span>select <span class=\"token keyword\">import</span> Select\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8CA.html'</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'confirma'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 切换对话框</span>\nalert <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>alert\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"文本内容是：\"</span><span class=\"token punctuation\">,</span> alert<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 拒绝</span>\nalert<span class=\"token punctuation\">.</span>dismiss<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 同意</span>\n<span class=\"token comment\"># alert.accept()</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<blockquote>\n<p>自定义弹窗，由于可以鼠标右击检查选项获取元素信息，所以出现自行已弹窗的时候，直接定义目标元素，并进行移除操作即可。</p>\n</blockquote>\n<h2><a id=\"_642\"></a>九、滚动条</h2>\n<p>1、为什么要是用滚动条？</p>\n<p>​ 在一些特殊场景中，一些按钮是在页面最下角，需要使用滚动条拉到最底层。</p>\n<p>2、操作步骤</p>\n<p>Selenium框架中没有专门处理滚动条的方法，需要通过调用 <code>Js</code> 代码实现操作；</p>\n<p>​ 1）、第一步：设置操作滚动条操作语句：<code>js_down=\"window.scollTo(0,1000)\"</code></p>\n<p>​ &gt; 0:为左边距-----》水平滚动条</p>\n<p>​ &gt; 1000: 为垂直滚动条</p>\n<p>​ 2）、第二步：调用执行js方法，将设置js语句传入方法中</p>\n<p>​ &gt; 方法：<code>driver.execute_script(js_down)</code></p>\n<p>​</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n滚动条：selenium中没有滚动条方法，需要js代码实现\n1、准备js代码：\"window.scrollTo(0, 1000)\"\n2、执行js代码：driver.execute_script(js的变量)\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8CA.html'</span><span class=\"token punctuation\">)</span>\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1、准备js代码</span>\njs_down <span class=\"token operator\">=</span> <span class=\"token string\">\"window.scrollTo(0, 1000)\"</span>\n<span class=\"token comment\"># 2、执行js代码</span>\ndriver<span class=\"token punctuation\">.</span>execute_script<span class=\"token punctuation\">(</span>js_down<span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"frame__689\"></a>十、切换frame表单 ☆</h2>\n<p>1、应用场景：</p>\n<p>处于frame 中的元素，虽然可以获取元素信息，但是代码执行时无法定位元素，因此需要<code>先切换到frame</code>，再进行元素定位操作。</p>\n<p>2、如何切换frame</p>\n<p>方法：<code>driver.switch_to.frame(\"id/name/element\")</code> 传入的是代表frame唯一的特征值</p>\n<pre><code class=\"prism language-python\">\n<span class=\"token triple-quoted-string string\">\"\"\"\nframe的切换\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8C%E5%AE%9E%E4%BE%8B.html'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 切换到frame</span>\ndriver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">(</span><span class=\"token string\">'idframe1'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 在frame表单中填写信息</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'userA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'admin'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"101_frame_723\"></a>10.1 连续切换frame</h3>\n<p>说明：如果要连续切换frame必须要先回到默认页面，才能够实现下一个frame的切换</p>\n<p>回到主页面的方法：<code>driver.switch_to.default_content()</code></p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n需要默认切换到frame\n方法：driver.switch_to.default_content()\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8C%E5%AE%9E%E4%BE%8B.html'</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">(</span><span class=\"token string\">'idframe1'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'userA'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'admin'</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>default_content<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">(</span><span class=\"token string\">'myframe2'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'userB'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'admin4'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"__755\"></a>十一、多窗口的切换 ☆</h2>\n<p>1、为什么要切换多窗口</p>\n<p>​ 页面是存在多窗口的，但是selenium默认焦点只会在<code>主窗口</code>上的所有元素，不切换窗口，就不能操作除主窗口以外的窗口内元素。</p>\n<p>2、如何切换</p>\n<p>每个窗口都有唯一的一个句柄值，那么我们就可以通过句柄值来完成窗口的切换操作</p>\n<p>​ 方法：</p>\n<p>​ 1）、<code>driver.current_window_handle</code> (获取当前的句柄值)</p>\n<p>​ 2）、<code>driver.window_handles</code> （ 获取当前由driver启动所有窗口句柄）</p>\n<p>​ 3）、<code>driver.switch_to.window(handle)</code> —&gt; 切换窗口</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n多窗口切换\ndriver.current_window_handle  获取当前的句柄值\ndriver.window_handles  获取driver启动的所有窗口句柄\ndriver.switch_to.window(handles[-1]) 切换窗口操作\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'file:///D:/%E6%A1%8C%E9%9D%A2/page/%E6%B3%A8%E5%86%8C%E5%AE%9E%E4%BE%8B.html'</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'ZCB'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 1、获取当前的句柄值</span>\n<span class=\"token comment\"># print(\"当前的句柄值是：\", driver.current_window_handle)</span>\n\n<span class=\"token comment\"># 2、</span>\n<span class=\"token comment\"># 1).切换窗口操作,driver.window_handles 获取driver启动的所有窗口句柄</span>\nhandles <span class=\"token operator\">=</span> driver<span class=\"token punctuation\">.</span>window_handles\n\n<span class=\"token comment\"># 2).切换窗口工作</span>\ndriver<span class=\"token punctuation\">.</span>switch_to<span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">(</span>handles<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>find_element_by_id<span class=\"token punctuation\">(</span><span class=\"token string\">'userB'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'admin9'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"red\" size=\"4\">注意：这里的窗口切换也对应到了 close() 方法的作用，现在使用close（）就是关闭当前页面，如果还想重新操作原始页面，务必完成窗口切换。</font></p>\n<h2><a id=\"_811\"></a>十二、截图操作</h2>\n<p>使用的方法：</p>\n<p><code>driver.get_screenshot_as_file(imgepath)</code></p>\n<p>参数：</p>\n<p><code>imagepath</code>：为图片要保存的目录地址及文件名称</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n截图：driver.get_screenshot_as_file(imgepath)\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"kw\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>send_keys<span class=\"token punctuation\">(</span><span class=\"token string\">'易烊千玺'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 截图方法，建议使用png格式 ， ./为当前路径，  ../为上一级路径</span>\ndriver<span class=\"token punctuation\">.</span>get_screenshot_as_file<span class=\"token punctuation\">(</span><span class=\"token string\">'./info.png'</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"blue\" size=\"3\">注意：指定图片存放的路径，需要自己手动创建文件夹</font></p>\n<h2><a id=\"_848\"></a>十三、验证码</h2>\n<p>1、什么是验证码？</p>\n<p>​ 一种随机生成的信息（文字，数字，图片）</p>\n<p>2、验证码的作用？</p>\n<p>​ 防止恶意请求</p>\n<p>3、验证码的处理</p>\n<p>​ 这边讲的是cookie解决</p>\n<p>4、使用cookie 登录</p>\n<p>​ 客户端登录账号后，将登录状态的想关 cookie 信息发给服务器保存，再发送去请求，携带cookie信息如果跟服务器保留的一致，则服务器认为客户端是登录状态。</p>\n<p>5、这里实现自动登录的功能</p>\n<p>​ 1）、准备工作，在客户端登录的状态下，获取cookie字段</p>\n<p><img alt=\"image-20220307191508407\" src=\"image\\549f5882e257b4c23e86e969205b1dc9.png\"/></p>\n<p>2、方法步骤：</p>\n<pre><code class=\"prism language-yacas\">1、整理cookie信息为字典数据，对应的是name和value，保存的一个变量中\n2、调用方法添加cookie\n\tdriver.add_cookie(cookie变量)\n# 3、刷新页面 --&gt;发送cookie给服务器验证\n\tdriver.refresh()\n</code></pre>\n<p>cookie 的value就不给你们了，怕你们登录我的账号😂😂😂</p>\n<pre><code class=\"prism language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\n验证码：\n{'name':'BDUSS',\n'value':'............................'}\n\"\"\"</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'https://www.baidu.com/'</span><span class=\"token punctuation\">)</span>\ndriver<span class=\"token punctuation\">.</span>maximize_window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 1、整理cookie信息为字典数据，对应的是name和value，保存的一个变量中</span>\ncookie_value <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'BDUSS'</span><span class=\"token punctuation\">,</span>\n<span class=\"token string\">'value'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'........................'</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># 2、调用方法添加cookie</span>\ndriver<span class=\"token punctuation\">.</span>add_cookie<span class=\"token punctuation\">(</span>cookie_value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 3、刷新页面 --&gt;发送cookie给服务器验证</span>\ndriver<span class=\"token punctuation\">.</span>refresh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\ndriver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<ul><li>演示：</li></ul>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/f3d822df461948eaa23d730d2f4272de.gif\"/></p>\n<hr/>\n<p>​ 终于把Selenium 给完结了，完结撒花❀❀❀❀❀❀❀❀❀❀ ，这里面的方法都要掌握，然后可以找需求文档练习，铁汁们，觉得笔者写的不错的可以点个赞哟❤🧡💛💚💙💜🤎🖤🤍💟，收藏关注呗，你们支持就是我写博客最大的动力！！！！</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}