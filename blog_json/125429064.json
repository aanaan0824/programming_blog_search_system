{"blogid": "125429064", "writerAge": "码龄9年", "writerBlogNum": "33", "writerCollect": "27", "writerComment": "0", "writerFan": "3", "writerGrade": "2级", "writerIntegral": "346", "writerName": "u010799534", "writerProfileAdress": "writer_image\\profile_125429064.jpg", "writerRankTotal": "57186", "writerRankWeekly": "146527", "writerThumb": "13", "writerVisitNum": "27243", "blog_read_count": "3151", "blog_time": "于 2022-06-28 17:14:38 发布", "blog_title": "python 使用pandas 读写excel文件", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>现在本地创建一个excel表，以及两个sheet，具体数据如下：</p>\n<p>sheet1：</p>\n<p><img alt=\"\" height=\"415\" src=\"image\\5e8f15a321134d6d94548892e4bc7297.png\" width=\"849\"/></p>\n<p> sheet2:</p>\n<p><img alt=\"\" height=\"316\" src=\"image\\9bd76b601fe64ae5ae61623725d743b3.png\" width=\"531\"/></p>\n<blockquote>\n<p><strong>读取excel文件</strong></p>\n</blockquote>\n<p>pandas.read_excel(io, sheet_name=0, header=0, names=None, index_col=None, usecols=None)</p>\n<p>io：excel文件路径。</p>\n<p>sheet_name：返回指定的sheet。</p>\n<p>header：表头，默认值为0。也可以指定多行。当header取值为None时候data打印值最多，0相比None会少一行，1对比0又会在少一行。也就是说设置header为多少，那么那行之前的数据就会缺失。header也可以设置为一个范围值如header=[0, 1]表示前两行为多重索引。</p>\n<p>usecols：读取指定的列。</p>\n<p>skiprows：跳过特定行。</p>\n<pre><code class=\"language-python\">import pandas\n\na = pandas.read_excel(\"t.xlsx\",sheet_name=0)#sheet_name可以使用下标，sheet的名称\nprint(a) #打印所有\nprint(a.values) #打印除第一行以外的信息\nprint(a.values[0]) #打印第一行的值\nprint(data['标题列'].values) #打印具体一列的值\n\n#读取同一文件的不同sheet\ndata= pandas.read_excel(\"t.xlsx\", ['Sheet1', 'Sheet2'])\nprint(data)#打印sheet1和sheet2的所有元素\nprint(data.get('Sheet1')['result'][0]) #打印sheet1表的result列的第一个元素\n\n\n#sheet_name = None时，返回所有表的数据\ndata = pandas.read_excel(\"t.xlsx\", sheet_name=None)\nprint(data)\n结果:\n\"\"\"\n{'Sheet1':    case_id account      pswd  hope result\n0      1.0     qwe  123456.0  登陆成功  cheng\n1      NaN     NaN       NaN   NaN    bai, 'Sheet2':    1  2  3  4  5\n0  a  b  c  d  e}\n\"\"\"\n\n#sheet_name可以选择名称，下标组合方式提取多张表数据\ndata = pandas.read_excel(\"t.xlsx\", sheet_name=['Sheet1',1])\nprint(data)\n结果:\n\"\"\"\n{'Sheet1':    case_id account      pswd  hope result\n0      1.0     qwe  123456.0  登陆成功  cheng\n1      NaN     NaN       NaN   NaN    bai, 1:    1  2  3  4  5\n0  a  b  c  d  e}\n\"\"\"\n\n#查询指定列的数据\ndata = pandas.read_excel('t.xlsx', sheet_name='Sheet1', usecols=['result',])\nprint(data)\n结果：\n\"\"\"\n  result\n0  cheng\n1    bai\n\"\"\"\ndata = pandas.read_excel('t.xlsx', sheet_name='Sheet1', usecols=[0])\nprint(data)\n结果：\n\"\"\"\n   case_id\n0      1.0\n1      NaN\n\"\"\"\ndata = pandas.read_excel('t.xlsx', sheet_name='Sheet1', usecols=[0, 1])\nprint(data)\n结果：\n\"\"\"\n   case_id account\n0      1.0     qwe\n1      NaN     NaN\n\"\"\"</code></pre>\n<p>ExcelFile:为了更方便地读取同一个文件的多张表格</p>\n<pre><code class=\"language-python\">import pandas\n\n\n#同时读取一个文件的多个sheet，仅需读取一次内存，性能更好\ndata = pandas.ExcelFile(\"t.xlsx\")\nsheets = pandas.read_excel(data)#sheet_name不写，默认为查第一个sheet的数据\nsheets = pandas.read_excel(data, sheet_name=\"Sheet2\")#查看指定sheet的数据\nprint(sheets)\n\n#也可以这么写\nwith pandas.ExcelFile(\"t.xlsx\") as xlsx:\n    s1 = pandas.read_excel(xlsx, sheet_name=\"Sheet1\")\n    s2 = pandas.read_excel(xlsx, sheet_name=\"Sheet2\")\nprint(s1)\nprint(\"-----------------------\")\nprint(s2)\n\n结果:\n\"\"\"\n   case_id account      pswd  hope result\n0      1.0     qwe  123456.0  登陆成功  cheng\n1      NaN     NaN       NaN   NaN    bai\n-----------------------\n   1  2  3  4  5\n0  a  b  c  d  e\n\"\"\"</code></pre>\n<pre><code class=\"language-python\">\"\"\"\nindex_col:索引对应的列,可以设置范围如[0, 1]来设置多重索引\nna_values:指定字符串展示为NAN\n\"\"\"\nwith pandas.ExcelFile('t.xlsx') as xls:\n    data['Sheet1'] = pandas.read_excel(xls, 'Sheet1', index_col=None,\n                                       na_values=['NA'])\n    data['Sheet2'] = pandas.read_excel(xls, 'Sheet2', index_col=1)\n\n    print(data)\n    print(\"-------------------------------\")\n    print(data['Sheet1'])\n    print(\"--------------------------------\")\n    print(data['Sheet2'])\n\n结果：\n\"\"\"\n{'Sheet1':    case_id account      pswd  hope result\n0      1.0     qwe  123456.0  登陆成功  cheng\n1      NaN     NaN       NaN   NaN    bai, 'Sheet2':    1  3  4  5\n2            \nb  a  c  d  e}\n-------------------------------\n   case_id account      pswd  hope result\n0      1.0     qwe  123456.0  登陆成功  cheng\n1      NaN     NaN       NaN   NaN    bai\n--------------------------------\n   1  3  4  5\n2            \nb  a  c  d  e\n\"\"\"</code></pre>\n<p></p>\n<blockquote>\n<p><strong>写入文件</strong>：</p>\n</blockquote>\n<p><strong>将数据写入excel</strong></p>\n<p>1.当文件不存在时，会自动创建文件，并写入数据；</p>\n<p>2.当文件存在时，会覆盖数据;</p>\n<p>3.sheet_name 不写默认为Sheet1;</p>\n<p><span style=\"color:#fe2c24;\">4.文件写入，切记关闭excel。</span></p>\n<pre><code class=\"language-python\">data = {'名字': ['张三','李四'],\n        '分数': [100, 100]\n       }\na= pandas.DataFrame(data)\na.to_excel('1.xlsx', sheet_name='Sheet1',index=False)# index = False表示不写入索引</code></pre>\n<p>excel一次写入多sheet：</p>\n<p>1.下面代码为在1.xlsx中写入sheet1，sheet2两个表。</p>\n<p>2.可以通过在ExcelWriter中添加mode参数，该参数默认为w，修改为a的话，可以在已存在sheet的excel中添加sheet表。</p>\n<pre><code class=\"language-python\">df1 = pandas.DataFrame({'名字': ['张三', '王四'], '分数': [100, 100]})\ndf2 = pandas.DataFrame({'年龄': ['18', '19'], '性别': ['男', '女']})\n\nwith pandas.ExcelWriter('1.xlsx') as writer:\n    df1.to_excel(writer, sheet_name='Sheet1', index=False)\n    df2.to_excel(writer, sheet_name='Sheet2', index=False)\n\n#新增一个sheet\ndf3 = pandas.DataFrame({'新增表': ['1', '2']})\nwith pandas.ExcelWriter('1.xlsx', mode='a') as writer:\n    df3.to_excel(writer, sheet_name='Sheet3', index=False)</code></pre>\n<p></p>\n</div>\n</div>"}