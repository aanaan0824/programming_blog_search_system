{"blogid": "124614467", "writerAge": "码龄3年", "writerBlogNum": "11", "writerCollect": "2", "writerComment": "0", "writerFan": "1", "writerGrade": "2级", "writerIntegral": "117", "writerName": "Finneab", "writerProfileAdress": "writer_image\\profile_124614467.jpg", "writerRankTotal": "129735", "writerRankWeekly": "697738", "writerThumb": "2", "writerVisitNum": "3813", "blog_read_count": "2128", "blog_time": "已于 2022-06-15 10:41:15 修改", "blog_title": "sql多表查询", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>1.多表查询概念：从多张表查询数据</p>\n<p></p>\n<p>2.分类：连接查询和子查询。</p>\n<p>有两张表A、B</p>\n<p><span style=\"color:#511b78;\">连接查询</span>： 内连接      相当于查询A、B交集数据</p>\n<p>例1：select * from emp,dept <span style=\"color:#be191c;\">where</span> emp.dep_id=dept.id;</p>\n<p>                    外连接      左外连接：相当于查询A表所有数据和交集部分数据</p>\n<p>                                     右外连接：相当于查询B表所有数据和交集部分数据</p>\n<p><span style=\"color:#511b78;\">子查询</span>：查询中嵌套查询。</p>\n<p></p>\n<p></p>\n<p></p>\n<p>3.内连接（同时查询两张表的列）</p>\n<p> <span style=\"color:#956fe7;\">隐式内连接</span>         select 字段列表 from 表一，表二 where 条件；</p>\n<p>   如上面的例子：select * from emp,dept <span style=\"color:#be191c;\">where</span> emp.dep_id=dept.id;</p>\n<p>         <span style=\"background-color:#ffd900;\"> 在没有条件语句的情况下返回笛卡尔积（排列组合）</span></p>\n<p>   例2：select emp.name,emp.gender,dept.name  <span style=\"color:#fe2c24;\">from </span>emp,dept <span style=\"color:#be191c;\">where</span> emp.dep_id=dept.id;</p>\n<p>  <span style=\"color:#956fe7;\">显式内连接  </span>  <span style=\"color:#be191c;\">   select</span> 字段列表 from 表一 <span style=\"color:#be191c;\">inner join </span>表二 on 条件；  </p>\n<p>    例3：select * from emp<span style=\"color:#be191c;\"> iennr join</span> dept <span style=\"color:#be191c;\">on </span><span style=\"color:#0d0016;\">emp.dep_id = dept.id;           innner可以省略</span></p>\n<p></p>\n<p><span style=\"color:#0d0016;\">4.外连接</span></p>\n<p><span style=\"color:#956fe7;\">    左外连接     </span><span style=\"color:#0d0016;\">select 字段列表 from 表1 </span><span style=\"color:#4da8ee;\">left join </span><span style=\"color:#0d0016;\">表2 </span><span style=\"color:#be191c;\">on</span><span style=\"color:#0d0016;\"> 条件；</span></p>\n<p><span style=\"color:#956fe7;\">     </span><span style=\"color:#0d0016;\">例4：查询</span><span style=\"color:#1c7331;\">emp表所有数据</span><span style=\"color:#0d0016;\">和对应的部门信息 </span></p>\n<p><span style=\"color:#0d0016;\">                select * from </span><span style=\"color:#1c7331;\">emp </span><span style=\"color:#be191c;\">left join</span><span style=\"color:#0d0016;\"> dept</span><span style=\"color:#be191c;\"> on </span><span style=\"color:#0d0016;\">emp.dep_id = dept.id; </span></p>\n<p><span style=\"color:#956fe7;\">    右外连接     </span><span style=\"color:#0d0016;\">select 字段列表 from 表1 </span><span style=\"color:#4da8ee;\">right join </span><span style=\"color:#0d0016;\">表2 </span><span style=\"color:#be191c;\">on</span><span style=\"color:#0d0016;\"> 条件；</span></p>\n<p>    例5：查询dept表所有数据和对应员工信息</p>\n<p>                  select * from emp <span style=\"color:#4da8ee;\">right join</span> dept on emp.dep_id = dept.id;</p>\n<p>             或：  select * from  dept <span style=\"color:#4da8ee;\">left join</span> emp on emp.dep_id = dept.id;(工作中最常使用left join)</p>\n<p><span style=\"color:#0d0016;\">5.子查询</span></p>\n<p>  （1）概念：查询中嵌套查询。</p>\n<p>    <span style=\"color:#be191c;\">       子查询</span>分为：单行单列         select 字段列表 from 表 where 字段名 = 子查询;</p>\n<p>                                多行单列          select 字段列表 from 表 where 字段名 <span style=\"color:#1a439c;\"> in </span>子查询;</p>\n<p>                                多行多列          select 字段列表 from （子查询）where   条件;</p>\n<p>        例1：查询班级中成绩高于叶淑华的学生的信息：</p>\n<p>           select * from stus where score&gt;(select score from stus where name = \"叶淑华\");</p>\n<p>         <img alt=\"\" height=\"144\" src=\"image\\cbb6f0b147d44bbe8c1d321eab5e7e1b.png\" width=\"560\"/></p>\n<p>     例2：查询财务部和销售部的所有员工信息：</p>\n<p>             select * from emp where dep_id <span style=\"color:#be191c;\">in</span> (select id from dept where dept_name = \"财务部\" or dept_name = \"销售部\")</p>\n<p>            <img alt=\"\" height=\"87\" src=\"image\\509c7f4344fa414c87d5ce1ee3dbdc7c.png\" width=\"341\"/></p>\n<p><span style=\"color:#be191c;\"><strong>IN</strong> 操作符用于匹配一组值，其后也可以接一个 SELECT 子句，从而匹配子查询得到的一组值。</span></p>\n<blockquote>\n<p>         例3：查询年龄大于20的员工信息和部门信息</p>\n<p>                 思路：先列出年龄大于20岁的员工的所有信息，作为虚拟表与dep_id进行内连接</p>\n<p>      select * from (select * from emp where age&gt;20)<span style=\"color:#4da8ee;\">t1</span>,dept where <span style=\"color:#4da8ee;\">t1</span>.dep_id =  dept.id;</p>\n<p>t1是别名，<span style=\"color:#9c8ec1;\"><strong><span style=\"background-color:#ffd900;\">select * from emp where age&gt;20作为虚拟表。</span></strong></span></p>\n</blockquote>\n<p></p>\n<p>多表查询案例：</p>\n<p><img alt=\"\" height=\"86\" src=\"image\\b608a459f5da463599ad98a04de1ee5b.png\" width=\"205\"/><em>职位表                                </em><img alt=\"\" height=\"83\" src=\"image\\305b5b8bb1bc47e993f2d483c0035de7.png\" width=\"195\"/><em>部门</em></p>\n<p> <img alt=\"\" height=\"81\" src=\"image\\9ca0348359694e89ace26228a16124cb.png\" width=\"213\"/><em>薪资等级表</em></p>\n<p>                  <img alt=\"\" height=\"161\" src=\"image\\96334b853a6e45618f5612ec85968010.png\" width=\"421\"/><em>员工表</em> </p>\n<p></p>\n<p><img alt=\"\" height=\"45\" src=\"image\\6ca213f653a0474085dfc7b0b84e791d.png\" width=\"777\"/></p>\n<p><img alt=\"\" height=\"130\" src=\"image\\6dcfc2da2b8548068f10f0d3b1c68cbd.png\" width=\"361\"/></p>\n<p> <img alt=\"\" height=\"171\" src=\"image\\217d623fc07342ba92556585cfda8910.png\" width=\"627\"/></p>\n<p>注意第三条要求里，由于peach的工资不在工资区间里，所以查询出来没有peach的记录。（对连接条件的理解）</p>\n<p><img alt=\"\" height=\"260\" src=\"image\\11d308c93e7e4cbcba09e2788fb838aa.png\" width=\"714\"/></p>\n<p>第五条要求中，第一行是仅分组，第二行是分组后的表作为虚拟表跟dept连接，然后查询。</p>\n<p>第五条还可写成别名形式：</p>\n<blockquote>\n<p>select * from dept,(select count(emp.id) 人数,emp.dep_id 部门编号 <span style=\"color:#be191c;\">from</span> emp group by dep_id)t1 where dept.id = t1.部门编号</p>\n</blockquote>\n<p>运行结果：</p>\n<p> <img alt=\"\" height=\"90\" src=\"image\\a5f4d32dce9c412e900c6cf44068b854.png\" width=\"329\"/></p>\n<p></p>\n<p></p>\n<p></p>\n</div>\n</div>"}