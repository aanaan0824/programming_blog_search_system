{"blogid": "123157905", "writerAge": "码龄3年", "writerBlogNum": "31", "writerCollect": "85", "writerComment": "15", "writerFan": "4", "writerGrade": "2级", "writerIntegral": "383", "writerName": "xi12", "writerProfileAdress": "writer_image\\profile_123157905.jpg", "writerRankTotal": "45449", "writerRankWeekly": "19715", "writerThumb": "58", "writerVisitNum": "23554", "blog_read_count": "6519", "blog_time": "于 2022-02-27 00:23:07 发布", "blog_title": "vuex的使用", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"vuex_0\"></a>vuex是什么</h1>\n<p>vuex是一个专门为vue开发的状态管理工具，它采用集中式存储管理应用的所有组件的状态，其核心是state。</p>\n<h1><a id=\"vuex_2\"></a>vuex中有什么</h1>\n<p>state：存放状态数据的地方，其中数据是响应式的，数据改变对应组件的数据也会跟新改变，禁止直接改变state中的数据否则数据无法被调试工具监测。<br/> getter:可理解为store的计算属性，能读取state中的数据。<br/> mutations：装着处理数据逻辑方法的集合体，是该改变state中数据的唯一方法，修改数据是同步的。<br/> actions：提交mutations修改数据，与mutations功能类似，但修改数据是异步的。<br/> modules：当store过于臃肿时，可使用modules将store分割成模块，每个模块中都有自己的state、getter、mutations、actions</p>\n<h1><a id=\"vuex_8\"></a>vuex使用示例</h1>\n<p><img alt=\"image\" src=\"image\\d71a15580f93b2713e90623d3056718a.png\"/><br/> 场景：将store中的数据在ComOne组件中渲染出来，在ComTwo组件中分别同步异步修改。<br/> 1、一般使用\"vue create xxx\"命令创建的项目的默认选项是自带vuex的，无需手动添加。<br/> 2、vuex的各种状态和方法是写在src下的store里的index.js中的。<br/> 3、在state中存入需要共用的数据：<br/> <img alt=\"image\" src=\"image\\40df7dbf39079c8ad7360cbba44483ff.png\"/><br/> 4、在store中分别写出vuex的getters、mutations、action(modules在数据臃肿时也可将之模块化写出):<br/> <img alt=\"image\" src=\"image\\de6ce822e1a26b71e99c7ead53072908.png\"/><br/> 5、在ComOne中导入vuex中的辅助函数mapState与mapGetters：<br/> <img alt=\"image\" src=\"image\\efa0e76b09e273eaa385be904b49aa92.png\"/><br/> 6、在ComOne中用辅助函数映射出vuex的state与getters作为计算属性：<br/> <img alt=\"image\" src=\"image\\065591618622140f342d68f936b0347b.png\"/><br/> 7、在页面直接使用映射出的数据：<br/> <img alt=\"image\" src=\"image\\d6b21ff0cc28b3137770dc74d6ba653a.png\"/><br/> 8、在ComTwo中导入修改vuex数据的辅助函数mapMutations与mapActions：<br/> <img alt=\"image\" src=\"image\\74cbf73774968a7694f01c63af6ff6f1.png\"/><br/> 9、在ComTwo中使用辅助函数生成修改vuex对应数据的方法：<br/> <img alt=\"image\" src=\"image\\ff8d037083eaa10a5016c02fb8f5b31e.png\"/><br/> 10、直接在页面中通过回车事件触发修改vuex的方法：<br/> <img alt=\"image\" src=\"image\\00d390468fd02be015a430bb07f58871.png\"/><br/> 11、在第一行输入框中输入数据按下回车后name与age会立刻更新修改(同步)，在第二行输入框中输入数据按下回车后name与age会等待一秒后更新修改(异步)。<br/> <img alt=\"image\" src=\"image\\a075346d9dd51c65d7d16fad7ca93d29.png\"/></p>\n<h1><a id=\"_31\"></a>具体实现代码</h1>\n<p>store的index.js：</p>\n<pre><code class=\"prism language-csharp\">import Vue <span class=\"token keyword\">from</span> 'vue'\nimport Vuex <span class=\"token keyword\">from</span> 'vuex'\n\nVue<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>Vuex<span class=\"token punctuation\">)</span>\n\nexport <span class=\"token keyword\">default</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Vuex<span class=\"token punctuation\">.</span>Store</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token comment\">//state存放状态,</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"tom\"</span><span class=\"token punctuation\">,</span><span class=\"token comment\">//需要共用的数据</span>\n    age<span class=\"token punctuation\">:</span> <span class=\"token string\">\"22\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//getter为state的计算属性</span>\n  getters<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    getName<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> state<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span><span class=\"token comment\">//获取name</span>\n    getAge<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> state<span class=\"token punctuation\">.</span>age<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//mutations可更改状态的逻辑，同步操作</span>\n  mutations<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    setName<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> state<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> data<span class=\"token punctuation\">,</span>\n    <span class=\"token named-parameter punctuation\">setAge</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> state<span class=\"token punctuation\">.</span>age <span class=\"token operator\">=</span> data<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//提交mutation，异步操作</span>\n  actions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token function\">acSetName</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n      <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token comment\">//延时1秒提交至mutations中的方法</span>\n        context<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setName\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token function\">acSetAge</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n      <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n        context<span class=\"token punctuation\">.</span><span class=\"token function\">commit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"setAge\"</span><span class=\"token punctuation\">,</span> age<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// 将store模块化</span>\n  modules<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>ComOne.vue:</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token operator\">&lt;</span>template<span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"wrapper\"</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>读取mapGetters中的getName与getAge<span class=\"token operator\">--</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">&gt;</span>\n      name：<span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">{<!-- --></span> getName <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">&gt;</span>\n      age：<span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">{<!-- --></span> getAge <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">&gt;</span>\nimport <span class=\"token punctuation\">{<!-- --></span> mapState<span class=\"token punctuation\">,</span> mapGetters <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vuex\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//导入vuex的辅助函数</span>\nexport <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{<!-- --></span>\n  components<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//计算属性computed无法传递参数</span>\n  computed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">// 映射 state 中的数据为计算属性</span>\n    <span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token function\">mapState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"age\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// 映射 getters 中的数据为计算属性</span>\n    <span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token function\">mapGetters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"getName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"getAge\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>style scoped<span class=\"token operator\">&gt;</span>\n<span class=\"token punctuation\">.</span>wrapper <span class=\"token punctuation\">{<!-- --></span>\n  color<span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>ComTwo.vue:</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token operator\">&lt;</span>template<span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"wrapper\"</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span>同步修改：<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>直接回车调用mapMutations中的setName方法与setAge方法<span class=\"token operator\">--</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>input\n        v<span class=\"token operator\">-</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"nameInp\"</span>\n        @keydown<span class=\"token punctuation\">.</span>enter<span class=\"token operator\">=</span><span class=\"token string\">\"setName(nameInp)\"</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"同步修改name\"</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>input\n        v<span class=\"token operator\">-</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"ageInp\"</span>\n        @keydown<span class=\"token punctuation\">.</span>enter<span class=\"token operator\">=</span><span class=\"token string\">\"setAge(ageInp)\"</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"同步修改age\"</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span>异步修改：<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">!</span><span class=\"token operator\">--</span>直接回车调用mapAtions中的acSetName方法与acSetAge方法<span class=\"token operator\">--</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>input\n        v<span class=\"token operator\">-</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"acNameInp\"</span>\n        @keydown<span class=\"token punctuation\">.</span>enter<span class=\"token operator\">=</span><span class=\"token string\">\"acSetName(acNameInp)\"</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"异步修改name\"</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span>input\n        v<span class=\"token operator\">-</span>model<span class=\"token operator\">=</span><span class=\"token string\">\"AcAgeInp\"</span>\n        @keydown<span class=\"token punctuation\">.</span>enter<span class=\"token operator\">=</span><span class=\"token string\">\"acSetAge(AcAgeInp)\"</span>\n        placeholder<span class=\"token operator\">=</span><span class=\"token string\">\"异步修改age\"</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">&gt;</span>\n\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">&gt;</span>\nimport <span class=\"token punctuation\">{<!-- --></span> mapMutations<span class=\"token punctuation\">,</span> mapActions <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"vuex\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//导入vuex的辅助函数</span>\nexport <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{<!-- --></span>\n  components<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{<!-- --></span>\n      nameInp<span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">//绑定输入框的值</span>\n      ageInp<span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token named-parameter punctuation\">acNameInp</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token named-parameter punctuation\">AcAgeInp</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token named-parameter punctuation\">methods</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">//用于生成与 mutations 对话的方法，即：包含 $store.commit(xx) 的函数</span>\n    <span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token function\">mapMutations</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"setName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"setAge\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">//用于生成与 actions 对话的方法，即：包含 $store.dispatch(xx) 的函数</span>\n    <span class=\"token range operator\">..</span><span class=\"token punctuation\">.</span><span class=\"token function\">mapActions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"acSetName\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"acSetAge\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span>style scoped<span class=\"token operator\">&gt;</span>\n<span class=\"token punctuation\">.</span>wrapper <span class=\"token punctuation\">{<!-- --></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">&gt;</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}