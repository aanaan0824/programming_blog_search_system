{"blogid": "126697554", "writerAge": "码龄5年", "writerBlogNum": "299", "writerCollect": "36", "writerComment": "8", "writerFan": "15", "writerGrade": "5级", "writerIntegral": "3105", "writerName": "重庆熊猫", "writerProfileAdress": "writer_image\\profile_126697554.jpg", "writerRankTotal": "7622", "writerRankWeekly": "7890", "writerThumb": "5", "writerVisitNum": "29098", "blog_read_count": "33", "blog_time": "于 2022-09-05 07:38:00 发布", "blog_title": "MySQL教程 - 权限管理", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<div class=\"blogpost-body cnblogs-markdown\" id=\"cnblogs_post_body\" style=\"font-size: 16px;\">\n<blockquote>\n<p>更新记录<br/> 转载请注明出处。<br/> 2022年9月5日 发布。<br/> 2022年9月5日 从笔记迁移到博客。</p>\n</blockquote>\n<h2 id=\"mysql中用户类型\">MySQL中用户类型</h2>\n<p>普通用户<br/> root(超级管理员)</p>\n<h2 id=\"mysql中系统自带数据库\">MySQL中系统自带数据库</h2>\n<p>information_schema<br/> mysql<br/> performance_schema<br/> sys</p>\n<h2 id=\"mysql数据库的作用\">mysql数据库的作用</h2>\n<p>权限管理</p>\n<h2 id=\"user权限表\">user权限表</h2>\n<h3 id=\"说明\">说明</h3>\n<p>表示用户信息和用户权限信息</p>\n<h3 id=\"作用\">作用</h3>\n<p>管理用户的全局DDL、DQL、DML、DCL权限<br/> 管理用户的密码</p>\n<h3 id=\"属性分类\">属性分类</h3>\n<ul><li>第一部分：用户信息的属性<br/> 主要包含HOST/USER/PASSWORD等属性，这是核心信息</li><li>第二部分：以priv结尾的属性<br/> 用户DDL、DQL、DML、DCL的权限控制，值是Y或者N</li><li>第三部分：SSL相关的属性<br/> 默认没有SSL，所以属性值为空</li><li>第四部分：用户资源限制属性<br/> 主要包含对用户请求、连接数量等的限制，默认不限制</li></ul>\n<h3 id=\"用户信息列\">用户信息列</h3>\n<p>Host<br/> User<br/> password_expired<br/> password_last_changed<br/> password_lifetime<br/> account_locked</p>\n<h3 id=\"权限列\">权限列</h3>\n<p>Select_priv<br/> Insert_priv<br/> Update_priv<br/> Delete_priv<br/> Create_priv<br/> Drop_priv<br/> Reload_priv<br/> Shutdown_priv<br/> Process_priv<br/> File_priv<br/> Grant_priv<br/> References_priv<br/> Index_priv<br/> Alter_priv<br/> Show_db_priv<br/> Super_priv<br/> Create_tmp_table_priv<br/> Lock_tables_priv<br/> Execute_priv<br/> Repl_slave_priv<br/> Repl_client_priv<br/> Create_view_priv<br/> Show_view_priv<br/> Create_routine_priv<br/> Alter_routine_priv<br/> Create_user_priv<br/> Event_priv<br/> Trigger_priv<br/> Create_tablespace_priv</p>\n<h3 id=\"安全列\">安全列</h3>\n<p>ssl_type<br/> ssl_cipher<br/> x509_issuer<br/> x509_subject<br/> plugin<br/> authentication_string</p>\n<h3 id=\"资源控制列\">资源控制列</h3>\n<p>max_questions<br/> max_updates<br/> max_connections<br/> max_user_connections</p>\n<p>图示<img alt=\"image\" src=\"image\\d1734d9b675c686bcda46c305c4a362e.png\" style=\"outline: none;\"/><img alt=\"image\" src=\"image\\9e88bc8ad750d9627b14772841671bfc.png\" style=\"outline: none;\"/><img alt=\"image\" src=\"image\\f6355c7fcb34c02606ffb0c8bf6cf769.png\" style=\"outline: none;\"/><img alt=\"image\" src=\"image\\2bd73255369b4dfad6c2070713668a49.png\" style=\"outline: none;\"/></p>\n<h2 id=\"db权限表\">db权限表</h2>\n<h3 id=\"说明-1\">说明</h3>\n<p>数据库的操作权限</p>\n<h3 id=\"用户列\">用户列</h3>\n<p>Host<br/> Db<br/> User</p>\n<h3 id=\"权限列-1\">权限列</h3>\n<p>Select_priv<br/> Insert_priv<br/> Update_priv<br/> Delete_priv<br/> Create_priv<br/> Drop_priv<br/> Grant_priv<br/> References_priv<br/> Index_priv<br/> Alter_priv<br/> Create_tmp_table_priv<br/> Lock_tables_priv<br/> Create_view_priv<br/> Show_view_priv<br/> Create_routine_priv<br/> Alter_routine_priv<br/> Execute_priv<br/> Event_priv<br/> Trigger_priv</p>\n<h3 id=\"图示\">图示</h3>\n<p><img alt=\"image\" src=\"image\\224e25c7f0088e75cd93b2cbb68aa0c8.png\" style=\"outline: none;\"/></p>\n<h2 id=\"host权限表\">host权限表</h2>\n<h3 id=\"说明-2\">说明</h3>\n<p>主机的操作权限</p>\n<h3 id=\"主要属性\">主要属性</h3>\n<p>第一部分：用户、数据库信息</p>\n<p>​ 主要包含Host、DB、User列</p>\n<p>第二部分：权限列</p>\n<p>​ 主要包含数据库相关的DDL/DQL/DML/DCL的权限</p>\n<h3 id=\"用户列-1\">用户列</h3>\n<p>Host<br/> Db</p>\n<h3 id=\"权限列-2\">权限列</h3>\n<p>Select_priv<br/> Insert_priv<br/> Update_priv<br/> Delete_priv<br/> Create_priv<br/> Drop_priv<br/> Grant_priv<br/> References_priv<br/> Index_priv<br/> Alter_priv<br/> Create_tem_table_priv<br/> Lock_tables_priv<br/> Create_view_priv<br/> Show_view_priv<br/> Create_routine_priv<br/> Alter_routine_priv<br/> Execute_priv<br/> Trigger_priv</p>\n<h3 id=\"图示-1\">图示</h3>\n<p><img alt=\"image\" src=\"image\\548088ed4307eb6b4902117ec283a13f.png\" style=\"outline: none;\"/></p>\n<h2 id=\"tables_priv权限表\">tables_priv权限表</h2>\n<h3 id=\"说明-3\">说明</h3>\n<p>表权限操作</p>\n<h3 id=\"主要字段\">主要字段</h3>\n<p>Host<br/> Db<br/> User<br/> Table_name<br/> Grantor<br/> Timestamp<br/> Table_priv<br/> Column_priv</p>\n<h3 id=\"图示-2\">图示</h3>\n<p><img alt=\"image\" src=\"image\\6df85d0c43576575aa869f5e79bea634.png\" style=\"outline: none;\"/></p>\n<h2 id=\"columns_priv权限表\">columns_priv权限表</h2>\n<h3 id=\"说明-4\">说明</h3>\n<p>列权限操作</p>\n<h3 id=\"主要字段-1\">主要字段</h3>\n<p>Host<br/> Db<br/> User<br/> Table_name<br/> Column_name<br/> Timestamp<br/> Column_priv</p>\n<h3 id=\"图示-3\">图示</h3>\n<p><img alt=\"image\" src=\"image\\f97583e3177d187d78eaafb1090bfca2.png\" style=\"outline: none;\"/></p>\n<h2 id=\"proces_priv权限表\">proces_priv权限表</h2>\n<h3 id=\"说明-5\">说明</h3>\n<p>存储过程和函数的权限</p>\n<h3 id=\"主要字段-2\">主要字段</h3>\n<p>Host<br/> Db<br/> User<br/> Routine_name<br/> Routine_type<br/> Grantor<br/> Proc_priv<br/> Timestamp</p>\n<h3 id=\"图示-4\">图示</h3>\n<p><img alt=\"image\" src=\"image\\755277d79641e7e158332ef302a1d20a.png\" style=\"outline: none;\"/></p>\n<h2 id=\"授予权限\">授予权限</h2>\n<p>语法 使用GRANT：</p>\n<pre class=\"has\"><code class=\"language-sql\">GRANT [ALL] 权限,权限,... ON 数据库.数据表 TO 用户名@主机 \nWITH [限制选项];</code></pre>\n<p>备注：权限可以是上个小节中的权限名称的集合，EG：SELECT,UPDATE<br/> 限制选项可以是以下的一个或多个:</p>\n<pre class=\"has\"><code class=\"language-sql\">MAX QUERIES PER HOUR v      \t\t//表示每小时可以查询v次\nMAX UPDATES PER HOUR v         //表示每小时可以更新v次\nMAX CONNECTIONS PER HOUR v     //表示每小时可以建立v次连接\nMAX USER_CONNECTIONS    v      //表示该用户可以同时有的连接数量为v个\nGRANT OPTION                   //表示该用户可以将同样的权限给别的用户</code></pre>\n<p>限制选项是可选的<br/> 选择所有数据库可以使用<em>.</em><br/> 实例：</p>\n<pre class=\"has\"><code class=\"language-sql\">GRANT SELECT,UPDATE,INSERT ON *.* TO user@localhost IDENTIFIFD BY '123456' WITH GRANT OPTION;</code></pre>\n<p>回收权限<br/> 回收权限-REVOKE<br/> 语法 使用REVOKE：</p>\n<pre class=\"has\"><code class=\"language-sql\">REVOKE [ALL] 权限,权限,... ON 数据库.数据表 FROM '用户名'[@'主机'];</code></pre>\n<p>回收所有权限的语法：</p>\n<pre class=\"has\"><code class=\"language-sql\">REVOKE ALL PRIVILEGES,GRANT OPTION FROM '用户名'@'主机';</code></pre>\n<p>回收权限-操作user表</p>\n<pre class=\"has\"><code class=\"language-sql\">UPDATE mysql.user SET 权限名称 = '权限值' WHERE user= '用户名';</code></pre>\n<h2 id=\"查看权限\">查看权限</h2>\n<p>语法一 使用SHOW GRANT：</p>\n<pre class=\"has\"><code class=\"language-sql\">SHOW GRANT FOR '用户名'[@'主机'];</code></pre>\n<p>语法二 查看USER表：</p>\n<pre class=\"has\"><code class=\"language-sql\">SELECT * FROM mysql.user;</code></pre>\n<h2 id=\"权限控制流程\">权限控制流程</h2>\n<p>检测用户名、密码和主机是否匹配</p>\n<p>检测是否有权限</p>\n<p>流程：用户发起请求 -&gt; 检测User表权限 -&gt; 检测db表权限 -&gt; 检测tables_priv表权限 -&gt; 检测columns_priv表权限</p>\n<h2 id=\"权限对应的列\">权限对应的列</h2>\n<p><img alt=\"image\" src=\"image\\5dda99c7f2a3c05d891615f65676a2e2.png\" style=\"outline: none;\"/></p>\n<p><img alt=\"image\" src=\"image\\f7d313f75b98c824a9e76a8dd33be081.png\" style=\"outline: none;\"/></p>\n</div>\n</div>\n</div>"}