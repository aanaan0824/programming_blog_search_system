{"blogid": "122115932", "writerAge": "码龄1年", "writerBlogNum": "46", "writerCollect": "100", "writerComment": "0", "writerFan": "9", "writerGrade": "3级", "writerIntegral": "470", "writerName": "小白花lll", "writerProfileAdress": "writer_image\\profile_122115932.jpg", "writerRankTotal": "102270", "writerRankWeekly": "391429", "writerThumb": "10", "writerVisitNum": "23778", "blog_read_count": "2810", "blog_time": "于 2021-12-27 00:06:11 发布", "blog_title": "PHP学习——phpstudy数据库连接（数据库创建，操作）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><strong>一、创建一个数据库</strong>： </p>\n<p> 打开mysql</p>\n<p><img alt=\"\" height=\"945\" src=\"image\\033f002999ff40769147252f945c90bd.png\" width=\"1200\"/></p>\n<p>软件管理=》 phpMyAdmin=》安装=》管理</p>\n<p><img alt=\"\" height=\"926\" src=\"image\\f760417752ad432486b1fef91780b5db.png\" width=\"1200\"/></p>\n<p>输入用户名密码（如果没有修改密码，密码为root） </p>\n<p><img alt=\"\" height=\"725\" src=\"image\\e609328bff904fdd972c5e223333212d.png\" width=\"874\"/></p>\n<p>创建一个数据库：</p>\n<p><img alt=\"\" height=\"294\" src=\"image\\3619c64eb3e4495181e1a9d1500efc54.png\" width=\"313\"/></p>\n<p><strong> 二、连接数据库</strong></p>\n<p><strong>1.创建一个连接：</strong>使用mysqli_connect()函数，几个参数分别是：</p>\n<p>mysqli_connect('数据库的地址（在本机一般为localhost）', '用户名', '密码', '数据库的名字', 端口号（一般为3306）)</p>\n<pre><code>//@用于屏蔽错误\n$link=@mysqli_connect('localhost', 'root', '011216', 'test', 3306);</code></pre>\n<p><strong>2.连接错误时的提示</strong></p>\n<pre><code>//返回最后一次连接调用的错误代码，发生错误是0\nif (mysqli_connect_errno()) {\n    var_dump(mysqli_connect_error());\n}</code></pre>\n<p><strong>3.设置默认字符编码</strong></p>\n<pre><code>mysqli_set_charset($link, 'utf-8');</code></pre>\n<p><strong>4.选择特定的数据库</strong>（在第一步已经指定了数据库为‘test’，此语句可以不写，但若第一步未指定或者中间需要切换数据时，可以使用这句话）</p>\n<pre><code>mysqli_select_db($link,'d2');</code></pre>\n<p><strong>5.关闭数据库连接</strong>（使用完数据库之后一定要关闭）</p>\n<pre><code>mysqli_close($link);</code></pre>\n<p><strong>三、对数据库进行一些操作</strong></p>\n<p><strong>1.执行insert，update，delete等操作</strong>：执行成功时会返回一个true</p>\n<pre><code>$query='INSERT into userinfo(sno,sname) VALUES(\"555\",\"王五\")';\nmysqli_query($link, $query);</code></pre>\n<p><img alt=\"\" height=\"45\" src=\"image\\4190da05a7ec4a3ea37fc68db9ac473d.png\" width=\"137\"/></p>\n<p><strong>2.执行查询操作，返回数据库中的数据的操作</strong></p>\n<pre><code>$query='select * from userinfo';\n\n//用一个变量保存返回的结果\n$result=mysqli_query($link, $query);</code></pre>\n<p> <strong>（1）以索引数组的方式获取一条记录</strong>（mysqli_fetch_row()函数）</p>\n<pre><code>//执行一次返回一条结果，想要多条结果，多执行几遍，因此可以使用循环\n// var_dump(mysqli_fetch_row($result));\n// var_dump(mysqli_fetch_row($result));\n// var_dump(mysqli_fetch_row($result));\n\n//使用循环\nwhile($data=mysqli_fetch_row($result)){\n    var_dump($data);\n}</code></pre>\n<p><img alt=\"\" height=\"98\" src=\"image\\0c2f2ad290e646d3819a421f172d2f46.png\" width=\"1028\"/></p>\n<p> （<strong>2）以关联数组的方式获取一条记录</strong>（mysqli_fetch_assoc()函数）</p>\n<pre><code>// var_dump(mysqli_fetch_assoc($result));\n// var_dump(mysqli_fetch_assoc($result));\n// var_dump(mysqli_fetch_assoc($result));\n//使用循环\nwhile($data=mysqli_fetch_assoc($result)){\n    var_dump($data);\n}</code></pre>\n<p><strong>（3）以索引数组或关联数组的方式获取一条记录</strong>（mysqli_fetch_array($result[,有一个可选参数，默认为索引数组和关联数组都有（MYSQLI_BOTH）])）</p>\n<pre><code>var_dump(mysqli_fetch_array($result));</code></pre>\n<p><img alt=\"\" height=\"51\" src=\"image\\3f81946aa3a3431f9df54d5abf03a8db.png\" width=\"965\"/></p>\n<p>以关联数组获取</p>\n<pre><code>var_dump(mysqli_fetch_array($result,MYSQLI_ASSOC));</code></pre>\n<p><img alt=\"\" height=\"44\" src=\"image\\9f21eee8abf5446f8fc898b7d05f2271.png\" width=\"602\"/></p>\n<p>以索引数组获取</p>\n<pre><code>var_dump(mysqli_fetch_array($result,MYSQLI_NUM));</code></pre>\n<p><img alt=\"\" height=\"42\" src=\"image\\b1c7e9df960f4569aa28acaca2f75c85.png\" width=\"479\"/></p>\n<pre><code>//索引数组\n// var_dump(mysqli_fetch_array($result,MYSQLI_ASSOC));\n//关联数组\n// var_dump(mysqli_fetch_array($result,MYSQLI_NUM));\n//默认，两个都有\n// var_dump(mysqli_fetch_array($result));\n\n//使用循环\nwhile($data=mysqli_fetch_assoc($result)){\n    var_dump($data);\n}</code></pre>\n<p><img alt=\"\" height=\"102\" src=\"image\\e70bab1ffbfc4bfa8e1e67e106b0d710.png\" width=\"1029\"/></p>\n<p> <strong>（4）以索引数组或关联数组的方式获取全部记录</strong>（mysqli_fetch_all($result[,有一个可选参数，默认为索引数组和关联数组都有（MYSQLI_BOTH）])函数）</p>\n<pre><code>var_dump(mysqli_fetch_all($result));</code></pre>\n<p><img alt=\"\" height=\"101\" src=\"image\\0dcd8ba2715043af98ed4131202b2204.png\" width=\"1055\"/></p>\n<p> 以关联数组获取</p>\n<pre><code>var_dump(mysqli_fetch_all($result,MYSQLI_ASSOC));</code></pre>\n<p><img alt=\"\" height=\"127\" src=\"image\\80c189b30a314be5980ad36b6e0d76cc.png\" width=\"1042\"/></p>\n<p> 以索引数组获取</p>\n<pre><code>var_dump(mysqli_fetch_all($result,MYSQLI_NUM));</code></pre>\n<p><img alt=\"\" height=\"94\" src=\"image\\2fedcd44da7649fbb706d20da7a56d0d.png\" width=\"1042\"/></p>\n<p><strong>3.预执行语句</strong></p>\n<p><strong>        执行insert，update等操作</strong></p>\n<p><strong>（1）准备好需要执行的SQL语句</strong></p>\n<pre><code>$query='insert into userinfo(sno,pwd,sname,identity) values(?,?,?,?)';\n$stmt=mysqli_prepare($link, $query);</code></pre>\n<p><strong>（2）绑定变量：</strong>mysqli_stmt_bind_param(准备好的sql语句，变量类型(一一对应)，自定义变量（有多少个就写多少个，即问号有多少个就写多少个）)</p>\n<p>i：int类型</p>\n<p>d：double类型或float类型</p>\n<p>s：字符串类型</p>\n<p>b：二进制数据类型</p>\n<pre><code>mysqli_stmt_bind_param($stmt, 'sssi', $val1, $val2, $val3, $val4);</code></pre>\n<p><strong>（3）对变量赋值</strong></p>\n<pre><code>$val1='2002';\n$val2='666666';\n$val3='王二';\n$val4=0;</code></pre>\n<p><strong>（4）执行</strong></p>\n<pre><code>mysqli_stmt_execute($stmt);</code></pre>\n<p>完整代码：</p>\n<pre><code>//预执行语句\n$query='insert into userinfo(sno,pwd,sname,identity) values(?,?,?,?)';\n//准备要执行的SQL语句\n$stmt=mysqli_prepare($link, $query);\n//绑定变量\n// i：int类型\n// d：double类型或float类型\n// s：字符串类型\n// b：二进制数据类型\nmysqli_stmt_bind_param($stmt, 'sssi', $val1, $val2, $val3, $val4);\n$val1='2002';\n$val2='666666';\n$val3='王二';\n$val4=0;\n//执行准备好的SQL语句\nmysqli_stmt_execute($stmt);</code></pre>\n<p><strong>         执行select操作需要具体的结果</strong></p>\n<p><strong>（1）准备好需要执行的SQL语句</strong></p>\n<pre><code>$query='select * from userinfo where sno=?';\n$stmt=mysqli_prepare($link, $query);</code></pre>\n<p><strong>（2）绑定变量：</strong>mysqli_stmt_bind_param(准备好的sql语句，变量类型(一一对应)，自定义变量（有多少个就写多少个，即问号有多少个就写多少个）)</p>\n<pre><code>mysqli_stmt_bind_param($stmt, 's', $val1);</code></pre>\n<p><strong>（3）变量赋值</strong></p>\n<pre><code>$val1='2001';</code></pre>\n<p><strong>（4）执行</strong></p>\n<pre><code>mysqli_stmt_execute($stmt);</code></pre>\n<p><strong>（5）将执行结果绑定到某个变量中：</strong>mysqli_stmt_bind_result(准备好的语句,后面几个分别为自定义变量用来保存查询的结果(返回的结果有几个变量，就需要写几个变量));</p>\n<pre><code>mysqli_stmt_bind_result($stmt,$sno,$pwd,$sname,$identity);</code></pre>\n<p><strong>（6）抓取</strong></p>\n<pre><code>mysqli_stmt_fetch($stmt);</code></pre>\n<p><strong>（7）输出</strong></p>\n<pre><code>echo \"{$sno}&lt;br&gt;{$pwd}&lt;br&gt;{$sname}&lt;br&gt;{$identity}\";</code></pre>\n<p><img alt=\"\" height=\"109\" src=\"image\\d0e7ba4294514ffa91b4ed6b96bb0ae0.png\" width=\"136\"/></p>\n<p> 完整代码：</p>\n<pre><code>$query='select * from userinfo where sno=?';\n$stmt=mysqli_prepare($link, $query);\nmysqli_stmt_bind_param($stmt, 's', $val1);\n\n$val1='2001';\n//如果执行成功\nif(mysqli_stmt_execute($stmt)){\n    //将执行结果绑定到某个变量中\n    //第一个变量为准备好的语句，后面几个分别为自定义变量用来保存查询的结果\n    mysqli_stmt_bind_result($stmt,$sno,$pwd,$sname,$identity);\n    //抓取\n    while(mysqli_stmt_fetch($stmt)){\n        echo \"{$sno}&lt;br&gt;{$pwd}&lt;br&gt;{$sname}&lt;br&gt;{$identity}\";\n    }\n}</code></pre>\n<p><strong>总结：</strong></p>\n<pre><code>&lt;?php\n//设置页面的字符编码\nheader('Conten-type:text/html;charset=utf-8');\n//与mysql连接\n//@用于屏蔽错误\n\n//运行时自行修改数据库密码和数据库\n$link=@mysqli_connect('localhost', 'root', 密码, 数据库, 3306);\n\n//返回最后一次连接调用的错误代码，发生错误是0\nif (mysqli_connect_errno()) {\n    var_dump(mysqli_connect_error());\n}\nmysqli_set_charset($link, 'utf-8');\n\n//使用特定的数据库\n//在前面数据库连接的时候已经指定了，可以不用写这句话\n//但是如果中间需要切换数据库，可以使用这句话\n//mysqli_select_db($link,'d2');\n\n//执行sql语句\n\n//（1）执行insert，update，delete等操作\n// $query='INSERT into userinfo(sno,sname) VALUES(\"555\",\"王五\")';\n// var_dump(mysqli_query($link, $query));\n\n//（2）执行查询操作，返回数据库中的数据的操作\n// $query='select * from userinfo';\n//用一个变量保存返回的结果\n// $result=mysqli_query($link, $query);\n\n//1.以索引数组的方式获取一条记录\n//执行一次返回一条结果，想要多条结果，多执行几遍，因此可以使用循环\n// var_dump(mysqli_fetch_row($result));\n// var_dump(mysqli_fetch_row($result));\n// var_dump(mysqli_fetch_row($result));\n\n//使用循环\n// while($data=mysqli_fetch_row($result)){\n//     var_dump($data);\n// }\n\n//2.以关联数组的方式获取一条记录\n// var_dump(mysqli_fetch_assoc($result));\n// var_dump(mysqli_fetch_assoc($result));\n// var_dump(mysqli_fetch_assoc($result));\n\n//使用循环\n// while($data=mysqli_fetch_assoc($result)){\n//     var_dump($data);\n// }\n\n//3.以索引数组或关联数组的方式获取一条记录\n//索引数组\n// var_dump(mysqli_fetch_array($result,MYSQLI_ASSOC));\n//关联数组\n// var_dump(mysqli_fetch_array($result,MYSQLI_NUM));\n//默认，两个都有\n// var_dump(mysqli_fetch_array($result));\n\n//使用循环\n// while($data=mysqli_fetch_assoc($result)){\n//     var_dump($data);\n// }\n\n//4.以索引数组或关联数组的方式获取全部记录\n// var_dump(mysqli_fetch_all($result));\n// var_dump(mysqli_fetch_all($result,MYSQLI_ASSOC));\n// var_dump(mysqli_fetch_all($result,MYSQLI_NUM));\n\n//预执行语句\n// $query='insert into userinfo(sno,pwd,sname,identity) values(?,?,?,?)';\n//准备要执行的SQL语句\n// $stmt=mysqli_prepare($link, $query);\n//绑定变量\n// i：int类型\n// d：double类型或float类型\n// s：字符串类型\n// b：二进制数据类型\n// mysqli_stmt_bind_param($stmt, 'sssi', $val1, $val2, $val3, $val4);\n// $val1='2002';\n// $val2='666666';\n// $val3='王二';\n// $val4=0;\n//执行准备好的SQL语句\n// var_dump(mysqli_stmt_execute($stmt));\n\n\n\n$query='select * from userinfo where sno=?';\n$stmt=mysqli_prepare($link, $query);\nmysqli_stmt_bind_param($stmt, 's', $val1);\n\n$val1='2001';\n//如果执行成功\nif(mysqli_stmt_execute($stmt)){\n    //将执行结果绑定到某个变量中\n    //第一个变量为准备好的语句，后面几个分别为自定义变量用来保存查询的结果\n    mysqli_stmt_bind_result($stmt,$sno,$pwd,$sname,$identity);\n    //抓取\n    while(mysqli_stmt_fetch($stmt)){\n        echo \"{$sno}&lt;br&gt;{$pwd}&lt;br&gt;{$sname}&lt;br&gt;{$identity}\";\n    }\n}\n\n\n\n\n\n\n//关闭数据库连接\nmysqli_close($link);\n</code></pre>\n<p></p>\n</div>\n</div>"}