{"blogid": "122354279", "writerAge": "码龄6年", "writerBlogNum": "31", "writerCollect": "112", "writerComment": "17", "writerFan": "29", "writerGrade": "3级", "writerIntegral": "454", "writerName": "草原上唱山歌", "writerProfileAdress": "writer_image\\profile_122354279.jpg", "writerRankTotal": "38319", "writerRankWeekly": "59730", "writerThumb": "120", "writerVisitNum": "33279", "blog_read_count": "1657", "blog_time": "于 2022-01-06 23:08:47 发布", "blog_title": "什么是COM组件以及怎样创建（C#）？", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><strong>什么是COM组件？</strong></p>\n<p><strong>       </strong> 1.COM组件是以WIN32动态链接库（DLL）或可执行文件（EXE）形式发布的可执行代码组成。</p>\n<p>        2.COM组件是一些小的二进制可执行文件，必须以二进制的形式发布。</p>\n<p>        3.COM组件可以给应用程序、操作系统以及其它组件提供服务。</p>\n<p>        4.自定义的COM组件可以在运行时刻同其它组件连接起来构成某个应用程序。</p>\n<p>        5.COM组件必须是动态链接的。</p>\n<p><strong>使用COM组件需要注意：</strong>1.必须要保证升级应用时不破坏与以前版本的向后兼容性；2.必须要做到扩展系统服务时不依赖于特定的操作系统。</p>\n<p>        COM组件不是一种计算机语言；</p>\n<p>        COM组件不是DLL，只是利用DLL来给组件提供动态链接的能力；</p>\n<p>        COM组件不是API函数集；</p>\n<p>        COM组件不是类；</p>\n<p></p>\n<p>        COM组件中的接口是一组由组件实现的，提供给客户使用的函数（在COM中的接口是一个包含函数指针数组的内存结构，数组元素是一个由组件实现的函数地址）。DLL的接口就是它所输出的函数。</p>\n<p><strong>COM组件创建的步骤</strong></p>\n<p>        1.在项目“ConsoleApp”右击，选择“属性”</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"image\\140706f73fc6424a9002008e3eb0c491.png\"/></p>\n<p>        2.选择“应用程序”。如果不是代码需要，目标框架尽量选择较低，便于选择支持更多版本的操作系统。输出类型选择“类库”，目的是将一个封装好的DLL注册到系统中。</p>\n<p><img alt=\"\" src=\"image\\354702de8ffa4544969fb05f80b0fc5c.png\"/></p>\n<p>        3.选择“生成”。目标平台有两种，x64和x86。主要区别在于注册时使用的工具和使用COM组件的软件限制。如，若你的程序需要使用到COM组件，而你当前的应用程序属于32位，那么你需要将你的目标平台设置为“x86”，否则将不能使用，会出现报错信息。反之，如果你的应用程序是64位，那么你需要将你的目标平台设置为“x64”。只有这样，才能正确使用COM组件。</p>\n<p>        在Visual Studio2019中，为了对“x86”和“x64”的应用程序进行兼容，可以将目标平台设置为“Any CPU”。</p>\n<p>        如果勾选了“为COM互操作注册”，在Visual Studio中可以自动将“生成”好的DLL注册到系统中（需要使用管理员权限）。如果需要把这个DLL注册到另一台计算机上，需要手动使用CMD命令注册（有32为注册和64位注册两种方式）。</p>\n<p><img alt=\"\" src=\"image\\97b7917c083f4dd281a106db0b6333cd.png\"/></p>\n<p> </p>\n<p>        4.选择“签名”。要生成COM组件，必须创建签名。</p>\n<p style=\"text-align:center;\"><img alt=\"\" src=\"image\\5e57eff771e24e60bdd8735d8c620c77.png\"/></p>\n<p> </p>\n<p></p>\n<p></p>\n</div>\n</div>"}