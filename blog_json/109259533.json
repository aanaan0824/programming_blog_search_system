{"blogid": "109259533", "writerAge": "码龄2年", "writerBlogNum": "97", "writerCollect": "3883", "writerComment": "158", "writerFan": "2717", "writerGrade": "5级", "writerIntegral": "2970", "writerName": "这么神奇", "writerProfileAdress": "writer_image\\profile_109259533.jpg", "writerRankTotal": "5766", "writerRankWeekly": "1230", "writerThumb": "658", "writerVisitNum": "360544", "blog_read_count": "45578", "blog_time": "已于 2022-07-18 18:33:24 修改", "blog_title": "Python基础之pyautogui模块（详细总结鼠标键盘操作）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"Python_0\"></a>Python基础之鼠标操作</h1>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#Python_0\">Python基础之鼠标操作</a></li><li><ul><li><a href=\"#1_GUI__3\">1. GUI 控制功能</a></li><li><ul><li><a href=\"#11___6\">1.1 自动 防故障功能</a></li><li><a href=\"#12__15\">1.2 停顿功能</a></li></ul>\n</li><li><a href=\"#2__22\">2. 鼠标操作</a></li><li><ul><li><a href=\"#21__24\">2.1 控制鼠标移动</a></li><li><a href=\"#22__58\">2.2 控制鼠标点击</a></li><li><a href=\"#23__84\">2.3 控制鼠标拖动</a></li><li><a href=\"#24__101\">2.4 控制鼠标滚动</a></li></ul>\n</li><li><a href=\"#3__110\">3. 屏幕处理</a></li><li><ul><li><a href=\"#31__112\">3.1 获取屏幕截图</a></li><li><a href=\"#32__128\">3.2 识别图像</a></li></ul>\n</li><li><a href=\"#4__149\">4. 键盘输入</a></li><li><ul><li><a href=\"#41__150\">4.1 键盘输入函数</a></li><li><a href=\"#42__172\">4.2 键盘特殊按键</a></li><li><a href=\"#43__204\">4.3 快捷键</a></li></ul>\n</li><li><a href=\"#5__219\">5. 提示信息框</a></li><li><ul><li><a href=\"#51__221\">5.1 提示框/警告框</a></li><li><a href=\"#52__233\">5.2 选择框</a></li><li><a href=\"#53__243\">5.3 密码输入</a></li><li><a href=\"#54__255\">5.4 普通输入</a></li></ul>\n</li><li><a href=\"#6__269\">6. 实例</a></li><li><ul><li><a href=\"#61___270\">6.1 鼠标控制 鼠标画一个正方形</a></li><li><a href=\"#62__281\">6.2 获取鼠标的实时位置</a></li><li><a href=\"#63____304\">6.3 获取鼠标位置 与 所在位置的颜色</a></li><li><a href=\"#64__327\">6.4 自动点赞程序</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h2><a id=\"1_GUI__3\"></a>1. GUI 控制功能</h2>\n<p>控制鼠标键盘使用的模块为：<code>pyautogui</code>，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标后，程序比较难关闭，这时我们有两个方法专门针对以上的情况：</p>\n<h3><a id=\"11___6\"></a>1.1 自动 防故障功能</h3>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>FAILSAFE <span class=\"token operator\">=</span><span class=\"token boolean\">False</span>  \n</code></pre>\n<p>默认这项功能为True, 这项功能意味着：当鼠标的指针在屏幕的最坐上方，程序会报错；目的是为了防止程序无法停止；</p>\n<h3><a id=\"12__15\"></a>1.2 停顿功能</h3>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>PAUSE <span class=\"token operator\">=</span> <span class=\"token number\">1</span>    \n</code></pre>\n<p>意味着所有pyautogui的指令都要暂停一秒；其他指令不会停顿；这样做，可以防止键盘鼠标操作太快；</p>\n<h2><a id=\"2__22\"></a>2. 鼠标操作</h2>\n<h3><a id=\"21__24\"></a>2.1 控制鼠标移动</h3>\n<p><strong>1. 获得屏幕分辨率</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pyautogui<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 返回所用显示器的分辨率； 输出：Size(width=1920, height=1080)</span>\nwidth<span class=\"token punctuation\">,</span>height <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">,</span>height<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 1920 1080</span>\n</code></pre>\n<p><strong>2. 移动鼠标</strong></p>\n<ul><li>移动到指定位置</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>   \n</code></pre>\n<p>将鼠标移动到指定的坐标；duration 的作用是设置移动时间，所有的gui函数都有这个参数，而且都是可选参数；</p>\n<ul><li>按方向移动</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>moveRel<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 第一个参数是左右移动像素值，第二个是上下，</span>\n</code></pre>\n<p>向右移动100px，向下移动500px, 这个过程持续 1 秒钟；</p>\n<p><strong>3. 获取鼠标位置</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pyautogui<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 得到当前鼠标位置；输出：Point(x=200, y=800)</span>\n</code></pre>\n<h3><a id=\"22__58\"></a>2.2 控制鼠标点击</h3>\n<ul><li>单击鼠标</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 点击鼠标</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 鼠标点击指定位置，默认左键</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单击左键</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'right'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单击右键</span>\npyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span>button<span class=\"token operator\">=</span><span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 单击中间</span>\n</code></pre>\n<ul><li>双击鼠标</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>doubleClick<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 指定位置，双击左键</span>\npyautogui<span class=\"token punctuation\">.</span>rightClick<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 指定位置，双击右键</span>\npyautogui<span class=\"token punctuation\">.</span>middleClick<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 指定位置，双击中键</span>\n</code></pre>\n<ul><li>点击 &amp; 释放</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>mouseDown<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 鼠标按下</span>\npyautogui<span class=\"token punctuation\">.</span>mouseUp<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 鼠标释放</span>\n</code></pre>\n<h3><a id=\"23__84\"></a>2.3 控制鼠标拖动</h3>\n<ul><li>拖动到指定位置</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>dragTo<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>   \n</code></pre>\n<p>将鼠标拖动到指定的坐标；duration 的作用是设置移动时间，所有的gui函数都有这个参数，而且都是可选参数；</p>\n<ul><li>按方向拖动</li></ul>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>dragRel<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 第一个参数是左右移动像素值，第二个是上下，</span>\n</code></pre>\n<p>向右拖动100px，向下拖动500px, 这个过程持续 1 秒钟；</p>\n<h3><a id=\"24__101\"></a>2.4 控制鼠标滚动</h3>\n<p>控制鼠标滚动的函数是scroll()， 传入一个整数的参数，说明向上或向下滚动多少个单位；单位根据操作系统不同而不同；</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>scroll<span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 向上滚动300个单位；</span>\n</code></pre>\n<h2><a id=\"3__110\"></a>3. 屏幕处理</h2>\n<h3><a id=\"31__112\"></a>3.1 获取屏幕截图</h3>\n<p>我们控制鼠标的操作，不能盲目的进行，所以我们需要监控屏幕上的内容，从而决定要不要进行对应的操作， pyautogui 提供了一个方法screenshot()，可以返回一个Pillow的image对象；</p>\n<p>这里有三个常用函数：</p>\n<p><code>im = pyautogui.screenshot()</code>：返回屏幕的截图，是一个Pillow的image对象<br/> <code>im.getpixel((500, 500))</code>：返回im对象上，（500，500）这一点像素的颜色，是一个RGB元组<br/> <code>pyautogui.pixelMatchesColor(500,500,(12,120,400))</code> ：是一个对比函数，对比的是屏幕上（500，500）这一点像素的颜色，与所给的元素是否相同；</p>\n<pre><code class=\"prism language-python\">im <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>screenshot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nim<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'屏幕截图.png'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>保存屏幕截图；</p>\n<h3><a id=\"32__128\"></a>3.2 识别图像</h3>\n<p>首先，我们需要先获得一个屏幕快照，例如我们想要点赞，我们就先把大拇指的图片保存下来；然后使用函数：locateOnScreen(‘zan.png’) ，如果可以找到图片，则返回图片的位置，如：Box(left=25, top=703, width=22, height=22)；如果找不到图片，则返回None;<br/> 如果，屏幕上有多处图片可以匹配，则需要使用locateAllOnScreen(‘zan.png’) ，如果匹配到多个值，则返回一个list，参考如下：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\npyautogui<span class=\"token punctuation\">.</span>PAUSE <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n\n<span class=\"token comment\"># 图像识别（一个）</span>\nbtm <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>locateOnScreen<span class=\"token punctuation\">(</span><span class=\"token string\">'zan.png'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>btm<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Box(left=1280, top=344, width=22, height=22)</span>\n\n<span class=\"token comment\"># 图像识别（多个）</span>\nbtm <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>locateAllOnScreen<span class=\"token punctuation\">(</span><span class=\"token string\">'zan.png'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>btm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># [Box(left=1280, top=344, width=22, height=22), Box(left=25, top=594, width=22, height=22)]</span>\n</code></pre>\n<p><code>pyautogui.center((left, top, width, height))</code> 返回指定位置的中心点；这样，我们就可以再配合鼠标操作点击找到图片的中心；参考实例：<a href=\"#auto_64\">《4.4 自动点赞程序》</a></p>\n<h2><a id=\"4__149\"></a>4. 键盘输入</h2>\n<h3><a id=\"41__150\"></a>4.1 键盘输入函数</h3>\n<p><code>pyautogui.keyDown()</code> ： 模拟按键按下；<br/> <code>pyautogui.keyUp()</code> ： 模拟按键释放；<br/> <code>pyautogui.press()</code> ： # 就是调用keyDown() &amp; keyUp(),模拟一次按键；<br/> <code>pyautogui.typewrite('this',0.5)</code> ： 第一参数是输入内容，第二个参数是每个字符间的间隔时间；<br/> <code>pyautogui.typewrite(['T','h','i','s'])</code>：typewrite 还可以传入单字母的列表；</p>\n<p>举例：</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>keyDown<span class=\"token punctuation\">(</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 按下shift</span>\npyautogui<span class=\"token punctuation\">.</span>press<span class=\"token punctuation\">(</span><span class=\"token string\">'4'</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 按下 4</span>\npyautogui<span class=\"token punctuation\">.</span>keyUp<span class=\"token punctuation\">(</span><span class=\"token string\">'shift'</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 释放 shift</span>\n</code></pre>\n<p>输出： $ ；</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>typewrite<span class=\"token punctuation\">(</span><span class=\"token string\">'$$$$'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>缓慢的输出：$$$$</p>\n<h3><a id=\"42__172\"></a>4.2 键盘特殊按键</h3>\n<p>有时我们需要输入一些特殊的按键，比如向左的箭头，这些有相对应的键盘字符串表示，例如：</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>typewrite<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'i'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'s'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'left'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'h'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 输出：This</span>\n</code></pre>\n<p>解释：这里的left就是向左的箭头；诸如此类的键盘字符串，还有很多，参考下表：</p>\n<table><thead><tr><th>键盘字符串</th><th>说明</th></tr></thead><tbody><tr><td>enter(或return 或 \\n)</td><td>回车</td></tr><tr><td>esc</td><td>ESC键</td></tr><tr><td>shiftleft, shiftright</td><td>左右SHIFT键</td></tr><tr><td>altleft, altright</td><td>左右ALT键</td></tr><tr><td>ctrlleft, ctrlright</td><td>左右CTRL键</td></tr><tr><td>tab (\\t)</td><td>TAB键</td></tr><tr><td>backspace, delete</td><td>BACKSPACE 、DELETE键</td></tr><tr><td>pageup, pagedown</td><td>PAGE UP 和 PAGE DOWN键</td></tr><tr><td>home, end</td><td>HOME 和 END键</td></tr><tr><td>up, down, left,right</td><td>箭头键</td></tr><tr><td>f1, f2, f3…. f12</td><td>F1…….F12键</td></tr><tr><td>volumemute, volumedown,volumeup</td><td>声音变大变小静音（有些键盘没有）</td></tr><tr><td>pause</td><td>PAUSE键，暂停键</td></tr><tr><td>capslock</td><td>CAPS LOCK 键</td></tr><tr><td>numlock</td><td>NUM LOCK 键</td></tr><tr><td>scrolllock</td><td>SCROLLLOCK 键</td></tr><tr><td>insert</td><td>INSERT键</td></tr><tr><td>printscreen</td><td>PRINT SCREEN键</td></tr><tr><td>winleft, winright</td><td>Win键（windows ）</td></tr><tr><td>command</td><td>command键（Mac OS X ）</td></tr><tr><td>option</td><td>option（Mac OS X）</td></tr></tbody></table>\n<h3><a id=\"43__204\"></a>4.3 快捷键</h3>\n<p>如果我们需要模拟复制的快捷键 <kbd>ctrl</kbd> + <kbd>c</kbd> ，如果用前面的方法，则代码为：</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>keyDown<span class=\"token punctuation\">(</span><span class=\"token string\">'ctrl'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyDown<span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyUp<span class=\"token punctuation\">(</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span>\npyautogui<span class=\"token punctuation\">.</span>keyUp<span class=\"token punctuation\">(</span><span class=\"token string\">'ctrl'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>快捷键的按键与释放顺序非常关键，这时我们可以使用 pyautogui.hotkey()，这个函数可以接受多个参数，按传入顺序按下，再按照相反顺序释放。上述快捷键 <kbd>ctrl</kbd> + <kbd>c</kbd> ，可以将代码变为：</p>\n<pre><code class=\"prism language-python\">pyautogui<span class=\"token punctuation\">.</span>hotkey<span class=\"token punctuation\">(</span><span class=\"token string\">'ctrl'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"5__219\"></a>5. 提示信息框</h2>\n<h3><a id=\"51__221\"></a>5.1 提示框/警告框</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\na <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>alert<span class=\"token punctuation\">(</span>text<span class=\"token operator\">=</span><span class=\"token string\">'This is an alert box.'</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">=</span><span class=\"token string\">'Test'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>输出如下图：点击确定，返回值为‘OK’<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201025213623294.png\"/></p>\n<h3><a id=\"52__233\"></a>5.2 选择框</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\na <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>confirm<span class=\"token punctuation\">(</span><span class=\"token string\">'选择一项'</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'B'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'C'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\20201025213650884.png\"/><br/> 输出如下图：点击B选项，返回值为‘B’</p>\n<h3><a id=\"53__243\"></a>5.3 密码输入</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\n\na <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">(</span><span class=\"token string\">'Enter password (text will be hidden)'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>输出如下图：输入密码，显示为密文，点击OK，返回值为刚刚输入的值；<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201025213725643.png\"/></p>\n<h3><a id=\"54__255\"></a>5.4 普通输入</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\n\na <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>prompt<span class=\"token punctuation\">(</span><span class=\"token string\">'请输入一个数字：'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\20201025214204838.png\"/><br/> 输出如下图：显示为明文，点击OK，返回值为刚刚输入的值；</p>\n<h2><a id=\"6__269\"></a>6. 实例</h2>\n<h3><a id=\"61___270\"></a>6.1 鼠标控制 鼠标画一个正方形</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>   <span class=\"token comment\"># 画正方形</span>\n    pyautogui<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    pyautogui<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    pyautogui<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n    pyautogui<span class=\"token punctuation\">.</span>moveTo<span class=\"token punctuation\">(</span><span class=\"token number\">400</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span>duration<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\t\n</code></pre>\n<h3><a id=\"62__281\"></a>6.2 获取鼠标的实时位置</h3>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># author：Zhang Kai time:</span>\n\n<span class=\"token keyword\">import</span> pyautogui\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        x<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        posi <span class=\"token operator\">=</span> <span class=\"token string\">'x:'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">' y:'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\r'</span><span class=\"token punctuation\">,</span>posi<span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">except</span> KeyboardInterrupt<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'已退出！'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>显示效果：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201024151713911.png\"/></p>\n<h3><a id=\"63____304\"></a>6.3 获取鼠标位置 与 所在位置的颜色</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pyautogui\n<span class=\"token keyword\">import</span> time\n\n<span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        x<span class=\"token punctuation\">,</span>y <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        rgb <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>screenshot<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>getpixel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        posi <span class=\"token operator\">=</span> <span class=\"token string\">'x:'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">' y:'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rjust<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'  RGB:'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>rgb<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\r'</span><span class=\"token punctuation\">,</span>posi<span class=\"token punctuation\">,</span>end<span class=\"token operator\">=</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">except</span> KeyboardInterrupt<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'已退出！'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>显示效果：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201024170254495.png\"/></p>\n<h3><a id=\"64__327\"></a>6.4 自动点赞程序</h3>\n<p id=\"auto_64\"> </p>\n<blockquote>\n<p>我们需要将所有的文章点赞，本页上的点赞完成后，就滚动鼠标，把新加载的文章也全部点赞；</p>\n</blockquote>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\20201024223612450.png\"/><br/> 代码如下：</p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\">#!/usr/bin/env python</span>\n<span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># author：Zhang Kai </span>\n\n<span class=\"token keyword\">import</span> pyautogui\n<span class=\"token keyword\">import</span> time\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">zan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 等待 0.5 秒</span>\n    left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>locateOnScreen<span class=\"token punctuation\">(</span><span class=\"token string\">'zan.png'</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 寻找 点赞图片；</span>\n    center <span class=\"token operator\">=</span> pyautogui<span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>left<span class=\"token punctuation\">,</span> top<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 寻找 图片的中心</span>\n    pyautogui<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span>center<span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 点击</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'点赞成功！'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> pyautogui<span class=\"token punctuation\">.</span>locateOnScreen<span class=\"token punctuation\">(</span><span class=\"token string\">'zan.png'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        zan<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 调用点赞函数</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        pyautogui<span class=\"token punctuation\">.</span>scroll<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 本页没有图片后，滚动鼠标；</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'没有找到目标，屏幕下滚~'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>运行后，会逐个进行点赞：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201024224213871.png\"/><br/> Pycharm中的输入如下：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\20201024224509956.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}