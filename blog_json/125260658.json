{"blogid": "125260658", "writerAge": "码龄10年", "writerBlogNum": "19", "writerCollect": "44", "writerComment": "15", "writerFan": "10", "writerGrade": "2级", "writerIntegral": "288", "writerName": "fish1208", "writerProfileAdress": "writer_image\\profile_125260658.jpg", "writerRankTotal": "71970", "writerRankWeekly": "136134", "writerThumb": "9", "writerVisitNum": "28339", "blog_read_count": "1202", "blog_time": "已于 2022-06-13 15:36:41 修改", "blog_title": "基于lighthouse+长安链的轻量级云服务器产品，实现部署合约、区块链服务一系列操作文档", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p style=\"margin-left:.0001pt;text-align:left;\"><strong><strong>长安链已上架一款lighthouse+长安链的轻量级云服务器产品</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:left;\">体验入口：<a href=\"https://cloud.tencent.com/product/lighthouse\" title=\"轻量应用服务器Lighthouse_香港轻量服务器_海外轻量服务器-腾讯云\">轻量应用服务器Lighthouse_香港轻量服务器_海外轻量服务器-腾讯云</a></p>\n<h1 style=\"text-align:justify;\"><strong>长安链管理平台</strong></h1>\n<h2 style=\"text-align:left;\"><strong><strong><strong>区块链管理</strong></strong></strong></h2>\n<h3 style=\"text-align:left;\"><strong><strong><strong>区块链概览</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">获取区块链ID（DApp需要配置）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"379\" src=\"image\\aa341baacb894ffba4c9705cc06a73db.png\" width=\"830\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>合约管理</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:left;\">智能合约git地址：https://git.chainmaker.org.cn/fish/fish1208-chainmaker-lighthouse/-/tree/master/contract</p>\n<p><strong>EVM虚拟机</strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>部署合约</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">合约名：HelloWorld</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">合约语言：solidity</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">git地址：</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><a href=\"https://git.chainmaker.org.cn/fish/fish1208-chainmaker-lighthouse/-/blob/master/contract/solidity/HelloWorld/HelloWorld.bin\" title=\"contract/solidity/HelloWorld/HelloWorld.bin · master · fish yu / fish1208-chainmaker-lighthouse · ChainMaker\">contract/solidity/HelloWorld/HelloWorld.bin · master · fish yu / fish1208-chainmaker-lighthouse · ChainMaker</a></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><a href=\"https://git.chainmaker.org.cn/fish/fish1208-chainmaker-lighthouse/-/blob/master/contract/solidity/HelloWorld/HelloWorld.abi\" title=\"contract/solidity/HelloWorld/HelloWorld.abi · master · fish yu / fish1208-chainmaker-lighthouse · ChainMaker\">contract/solidity/HelloWorld/HelloWorld.abi · master · fish yu / fish1208-chainmaker-lighthouse · ChainMaker</a></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"563\" src=\"image\\9fa4930b28ed4642896996047f5b0629.png\" width=\"830\"/></p>\n<p></p>\n<p><strong>WASM虚拟机</strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>部署合约</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">合约名：hello</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">合约语言：rust</p>\n<p style=\"margin-left:.0001pt;text-align:left;\">git地址：https://git.chainmaker.org.cn/fish/fish1208-chainmaker-lighthouse/-/blob/master/contract/rust/hello/contract_helloworld.wasm</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"624\" src=\"image\\f2d7d27916f74f4e9e9abb75d3e49414.png\" width=\"831\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">注：需要在【投票管理】进行投票，允许部署合约。</p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>投票管理</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"311\" src=\"image\\374b1e38424847eb883afb1b4ea78ae1.png\" width=\"829\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"457\" src=\"image\\94809b54201f4decaadf72d33e0eb319.png\" width=\"831\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>上链管理</strong></strong></strong></h3>\n<p><strong>HelloWorld合约</strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">1、发起上链（set方法）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"436\" src=\"image\\8347a4dd997c436abb92feb2d72ce6b7.png\" width=\"830\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">2、发起上链（get方法）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"402\" src=\"image\\d5b59e7a04dd492081c3f9205f2288fe.png\" width=\"831\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">查看</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"498\" src=\"image\\dfaf880b3927457eae835910fec0a843.png\" width=\"830\"/></p>\n<p></p>\n<p><strong>hello合约</strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">1、发起上链（set方法）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"480\" src=\"image\\0563bf2b6425429a86d5d398fd9aa88d.png\" width=\"830\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">2、发起上链（get方法）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"429\" src=\"image\\3d1a0382fca74ec1a299a8aaf1f9cea3.png\" width=\"830\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">查看</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"487\" src=\"image\\12a27eac91e648c0b2c1f39640172ecd.png\" width=\"831\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>组织信息</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">获取org1组织ID（DApp需要配置）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"300\" src=\"image\\c065f86f50c54aae8a5d999c40859dde.png\" width=\"830\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>节点信息</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">获取consensus1节点端口（DApp需要配置）</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"347\" src=\"image\\e02902a156d245feb50e8e10e6d417e3.png\" width=\"831\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>区块链浏览器</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">查看区块信息</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"347\" src=\"image\\3c7f9517519444c4aa2a21d5652940f8.png\" width=\"829\"/></p>\n<p></p>\n<h1 style=\"text-align:justify;\"><strong>DApp代码开发</strong></h1>\n<p style=\"margin-left:.0001pt;text-align:justify;\">需要先开放端口，允许外部服务访问</p>\n<p style=\"margin-left:.0001pt;text-align:left;\">netstat -tunlp | grep 12301</p>\n<p style=\"margin-left:.0001pt;text-align:left;\"><img alt=\"\" height=\"31\" src=\"image\\a8f8a93cbf814137a5bcb69efbb9af99.png\" width=\"830\"/></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>添加规则，允许外部访问12301、12302、12303、12304端口</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"306\" src=\"image\\7ef3bc636d51445c8eb145b4c3009e76.png\" width=\"830\"/></p>\n<p></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>拷贝证书</strong></strong></strong></h2>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"background-color:#ffff00;\">使用本地SSH客户端软件远程登录实例</span><span style=\"background-color:#ffff00;\">。</span></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">证书文件在/root/chainmaker/chain目录下</p>\n<pre><code>cd /root/chainmaker/chain</code></pre>\n<p style=\"margin-left:.0001pt;text-align:left;\"><img alt=\"\" height=\"139\" src=\"image\\8615278b809545e09d766062895561eb.png\" width=\"831\"/></p>\n<p style=\"margin-left:.0001pt;text-align:left;\">将证书文件夹crypto-config拷贝到项目根目录下<img alt=\"\" height=\"294\" src=\"image\\ebceb141032940a09e272c7f083befe9.png\" width=\"830\"/></p>\n<p></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>代码开发</strong></strong></strong></h2>\n<pre><code>contract_helloworld.rs\nrust语言智能合约。\n\nHelloWorld.sol\nsolidity语言智能合约。\n\nsdk-config.yml\n配置文件。\n\nChainSDKConfig.java\n通过sdk-config.yml配置文件获取ChainClient、User对象。\n\nChainController.java\n根据区块高度来获取区块信息。\n\nHelloController.java\nhello合约控制器，执行合约中的方法。</code></pre>\n<h3 style=\"text-align:left;\"><strong><strong><strong>智能合约</strong></strong></strong></h3>\n<h3 style=\"text-align:left;\"><img alt=\"\" height=\"442\" src=\"image\\40f84b283b0b4faea0928fc5a86c7d5f.png\" width=\"831\"/></h3>\n<p> <img alt=\"\" height=\"376\" src=\"image\\d85cf885411f4c45b8e13033ce2584ba.png\" width=\"830\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>配置sdk-config.yml</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">配置链ID、组织ID、节点信息。</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"437\" src=\"image\\1a7ccfcf130444c99cfb99382efd2959.png\" width=\"830\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>获取区块基本信息</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\">根据区块高度来获取区块信息（传参blockHeight=6，返回该区块的区块高度、区块哈希、前区块哈希、时间戳）</p>\n<pre><code>http://127.0.0.1:7022/chain/block/info?blockHeight=6</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"289\" src=\"image\\5b42d6f676df475f8bc8c6959f3e46fd.png\" width=\"831\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"347\" src=\"image\\0cba898c14f94952aa03154d34d962e9.png\" width=\"829\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>hello合约</strong></strong></strong></h3>\n<p><strong><strong>set方法</strong></strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>请求</strong></strong></p>\n<pre><code>GET http://127.0.0.1:7022/hello/set?n=Hello Xiao HTTP/1.1</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>响应</strong></strong></p>\n<pre><code>HTTP/1.1 200\n\nContent-Type: application/json\n\n{\n\n    \"code\": 200,\n\n    \"success\": true,\n\n    \"msg\": \"操作成功\",\n\n    \"data\": \"d160188d93204f3b60f54ddf09a6bc191d236944bf1f26aa9287164aee57183e\"\n\n}</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">返回交易id</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"392\" src=\"image\\ee4f746046c9439d8f2735cdbe50ec65.png\" width=\"830\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\">使用交易id在区块链浏览器查询</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"535\" src=\"image\\176737b775634b7eb4895c8e69ab3237.png\" width=\"830\"/></p>\n<p></p>\n<p><strong>get方法</strong></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>请求</strong></strong></p>\n<pre><code>GET http://127.0.0.1:7022/hello/get HTTP/1.1</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><strong><strong>响应</strong></strong></p>\n<pre><code>HTTP/1.1 200\n\nContent-Type: application/json\n\n{\n\n    \"code\": 200,\n\n    \"success\": true,\n\n    \"msg\": \"操作成功\",\n\n    \"data\": \"&lt;ByteString@7411105a size=18 contents=\\\"{\\\\\\\"n\\\\\\\":\\\\\\\"Hello Xiao\\\\\\\"}\\\"&gt;\"\n\n}</code></pre>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"338\" src=\"image\\fa27d4109a29440c8724f1670e6a625f.png\" width=\"831\"/></p>\n<p></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>Git地址</strong></strong></strong></h2>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><a href=\"https://git.chainmaker.org.cn/fish/fish1208-chainmaker-lighthouse.git\" title=\"fish yu / fish1208-chainmaker-lighthouse · ChainMaker\">fish yu / fish1208-chainmaker-lighthouse · ChainMaker</a></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n<h2 style=\"text-align:left;\"><strong><strong><strong>测试地址（可访问）</strong></strong></strong></h2>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><span style=\"background-color:#ff0000;\">注：测试地址失效时间为2022-07-10。</span></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>hello合约set方法</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><a href=\"http://1.13.249.4:7022/hello/set?n=Hello\" title=\"http://1.13.249.4:7022/hello/set?n=\">http://1.13.249.4:7022/hello/set?n=</a>ChainMaker</p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"172\" src=\"image\\f28ceb6e347b4bcbb8aa7487bddb850d.png\" width=\"830\"/></p>\n<p></p>\n<h3 style=\"text-align:left;\"><strong><strong><strong>hello合约get方法</strong></strong></strong></h3>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><a href=\"http://1.13.249.4:7022/hello/get\" title=\"http://1.13.249.4:7022/hello/get\">http://1.13.249.4:7022/hello/get</a></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"><img alt=\"\" height=\"143\" src=\"image\\d90d4375dd1d4b55ad87e7d0ebfd9713.png\" width=\"831\"/></p>\n<p></p>\n<p style=\"margin-left:.0001pt;text-align:justify;\"></p>\n</div>\n</div>"}