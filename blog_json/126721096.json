{"blogid": "126721096", "writerAge": "码龄1年", "writerBlogNum": "89", "writerCollect": "1108", "writerComment": "1784", "writerFan": "4057", "writerGrade": "5级", "writerIntegral": "4245", "writerName": "小白又菜", "writerProfileAdress": "writer_image\\profile_126721096.jpg", "writerRankTotal": "4022", "writerRankWeekly": "310", "writerThumb": "1871", "writerVisitNum": "66930", "blog_read_count": "39", "blog_time": "于 2022-09-06 12:30:37 发布", "blog_title": "[ Linux ] Linux调试器--gdb使用", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"1.%E4%BD%BF%E7%94%A8gdb-toc\" style=\"margin-left:0px;\"><a href=\"#1.%E4%BD%BF%E7%94%A8gdb\">1.使用gdb</a></p>\n<p id=\"1.1%20gdb%E4%BA%86%E8%A7%A3%E5%8F%8A%E5%87%86%E5%A4%87-toc\" style=\"margin-left:40px;\"><a href=\"#1.1%20gdb%E4%BA%86%E8%A7%A3%E5%8F%8A%E5%87%86%E5%A4%87\">1.1 gdb了解及准备</a></p>\n<p id=\"2.%E4%BD%BF%E7%94%A8gdb-toc\" style=\"margin-left:0px;\"><a href=\"#2.%E4%BD%BF%E7%94%A8gdb\">2.使用gdb</a></p>\n<p id=\"2.1%20%E8%BF%9B%E5%85%A5gdb-toc\" style=\"margin-left:40px;\"><a href=\"#2.1%20%E8%BF%9B%E5%85%A5gdb\">2.1 进入gdb</a></p>\n<p id=\"2.2%20%E6%98%BE%E7%A4%BA%E6%BA%90%E4%BB%A3%E7%A0%81-toc\" style=\"margin-left:40px;\"><a href=\"#2.2%20%E6%98%BE%E7%A4%BA%E6%BA%90%E4%BB%A3%E7%A0%81\">2.2 显示源代码</a></p>\n<p id=\"2.3%20%E6%89%93%E6%96%AD%E7%82%B9%20%E6%9F%A5%E7%9C%8B%E6%96%AD%E7%82%B9%E4%BF%A1%E6%81%AF-toc\" style=\"margin-left:40px;\"><a href=\"#2.3%20%E6%89%93%E6%96%AD%E7%82%B9%20%E6%9F%A5%E7%9C%8B%E6%96%AD%E7%82%B9%E4%BF%A1%E6%81%AF\">2.3 打断点 查看断点信息</a></p>\n<p id=\"2.4%20%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F-toc\" style=\"margin-left:40px;\"><a href=\"#2.4%20%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F\">2.4 运行程序</a></p>\n<p id=\"2.5%20%E6%9F%A5%E7%9C%8B%E5%8F%98%E9%87%8F%E4%BF%A1%E6%81%AF-toc\" style=\"margin-left:40px;\"><a href=\"#2.5%20%E6%9F%A5%E7%9C%8B%E5%8F%98%E9%87%8F%E4%BF%A1%E6%81%AF\">2.5 查看变量信息</a></p>\n<p id=\"2.6%20%E9%80%90%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C-toc\" style=\"margin-left:40px;\"><a href=\"#2.6%20%E9%80%90%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C\">2.6 逐语句执行</a></p>\n<p id=\"2.7%C2%A0%20%E9%80%90%E8%BF%87%E7%A8%8B%E6%89%A7%E8%A1%8C%C2%A0-toc\" style=\"margin-left:40px;\"><a href=\"#2.7%C2%A0%20%E9%80%90%E8%BF%87%E7%A8%8B%E6%89%A7%E8%A1%8C%C2%A0\">2.7  逐过程执行 </a></p>\n<p id=\"2.8%20%E5%88%A0%E9%99%A4%E6%96%AD%E7%82%B9%C2%A0-toc\" style=\"margin-left:40px;\"><a href=\"#2.8%20%E5%88%A0%E9%99%A4%E6%96%AD%E7%82%B9%C2%A0\">2.8 删除断点 </a></p>\n<p id=\"%C2%A02.9%20%E8%B0%83%E7%94%A8%E5%A0%86%E6%A0%88-toc\" style=\"margin-left:40px;\"><a href=\"#%C2%A02.9%20%E8%B0%83%E7%94%A8%E5%A0%86%E6%A0%88\"> 2.9 调用堆栈</a></p>\n<p id=\"2.10%C2%A0%E8%B7%9F%E8%B8%AA%E5%8F%98%E9%87%8F-toc\" style=\"margin-left:40px;\"><a href=\"#2.10%C2%A0%E8%B7%9F%E8%B8%AA%E5%8F%98%E9%87%8F\">2.10 跟踪变量</a></p>\n<p id=\"2.11%20%E8%B7%B3%E8%BD%AC%E8%87%B3x%E8%A1%8C-toc\" style=\"margin-left:40px;\"><a href=\"#2.11%20%E8%B7%B3%E8%BD%AC%E8%87%B3x%E8%A1%8C\">2.11 跳转至x行</a></p>\n<p id=\"2.12%20%E8%B7%B3%E8%BD%AC%E8%87%B3%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%96%AD%E7%82%B9-toc\" style=\"margin-left:40px;\"><a href=\"#2.12%20%E8%B7%B3%E8%BD%AC%E8%87%B3%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%96%AD%E7%82%B9\">2.12 跳转至下一个断点</a></p>\n<p id=\"2.13%20%E5%B0%86%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E5%87%BD%E6%95%B0%E8%B7%91%E5%AE%8C%20finish-toc\" style=\"margin-left:40px;\"><a href=\"#2.13%20%E5%B0%86%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E5%87%BD%E6%95%B0%E8%B7%91%E5%AE%8C%20finish\">2.13 将一个指定函数跑完 finish</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<p>1.<span style=\"color:#777777;\">程序的发布方式有两种，</span><span style=\"color:#777777;\">debug</span><span style=\"color:#777777;\">模式和</span><span style=\"color:#777777;\">release</span><span style=\"color:#777777;\">模式，Linux默认是release模式，VS模式是debug模式。</span></p>\n<p><span style=\"color:#777777;\">2.Linux gcc/g++</span><span style=\"color:#777777;\">出来的二进制程序，默认是</span><span style=\"color:#777777;\">release</span><span style=\"color:#777777;\">模式</span></p>\n<p>3.<span style=\"color:#777777;\">要使用</span><span style=\"color:#777777;\">gdb</span><span style=\"color:#777777;\">调试，必须在源代码生成二进制程序的时候</span><span style=\"color:#777777;\">, </span><span style=\"color:#777777;\">加上 </span><span style=\"color:#777777;\">-</span><span style=\"color:#777777;\">g </span><span style=\"color:#777777;\">选项 </span></p>\n<h1 id=\"1.%E4%BD%BF%E7%94%A8gdb\"><span style=\"color:#777777;\">1.使用gdb</span></h1>\n<h2 id=\"1.1%20gdb%E4%BA%86%E8%A7%A3%E5%8F%8A%E5%87%86%E5%A4%87\"><span style=\"color:#777777;\">1.1 gdb了解及准备</span></h2>\n<p><span style=\"color:#777777;\">开始调试 gdb binFile</span></p>\n<p><span style=\"color:#777777;\">退出：ctrl + d 或 quit </span></p>\n<p><span style=\"color:#777777;\">首先我们写出一段简单的C语言程序</span></p>\n<pre><code class=\"language-cpp\">#include &lt;stdio.h&gt;\nint main()\n{\n  int i = 0;\n  for(i = 0;i&lt;10;++i)\n  {\n    printf(\"%d \",i);\n  }\n  printf(\"\\n\");\n  return 0;\n}\n</code></pre>\n<p><img alt=\"\" height=\"355\" src=\"image\\b08a175073344f8b9839a514c7e87640.png\" width=\"578\"/></p>\n<p> </p>\n<p>开始调试：<strong><span style=\"color:#fe2c24;\">注意：默认形成的可执行程序，无法调试！！ </span></strong></p>\n<p><strong><span style=\"color:#0d0016;\">因为Linux下默认的版本是release，我们都知道要调试必须在debug版本下</span></strong></p>\n<p>系统当中有一条命令 可以以断的形式能够把结构信息显示出来</p>\n<pre><code class=\"language-cpp\">readelf -S test</code></pre>\n<p><img alt=\"\" height=\"785\" src=\"image\\926ccbc5fe7a486488edfac422256a7c.png\" width=\"940\"/></p>\n<p><img alt=\"\" height=\"199\" src=\"image\\04dc806b0a0a424182cf0272e2078182.png\" width=\"801\"/> </p>\n<p>如何生成debug版本的可执行程序呢？可以使用下面这条命令</p>\n<pre><code class=\"language-cpp\">gcc test.c -o test_g -g</code></pre>\n<p><strong><span style=\"color:#fe2c24;\">注意：所有的调试代码操作必须在debug版本下执行</span></strong></p>\n<p><strong><span style=\"color:#0d0016;\">我们发现debug版本的体积明显大于release版本下的体积，大的这部分正式调试信息</span></strong></p>\n<p><img alt=\"\" height=\"159\" src=\"image\\42faf2dbd245477ea2c4e7b9464599a8.png\" width=\"617\"/></p>\n<p> </p>\n<p>我们使用这条指令可以查看调试信息：</p>\n<pre><code class=\"language-cpp\">readelf -S test_g | grep debug</code></pre>\n<p><img alt=\"\" height=\"199\" src=\"image\\2ef52645d6e74e7586ecc2f6e4c372c8.png\" width=\"846\"/></p>\n<p> </p>\n<h1 id=\"2.%E4%BD%BF%E7%94%A8gdb\">2.使用gdb</h1>\n<h2 id=\"2.1%20%E8%BF%9B%E5%85%A5gdb\">2.1 进入gdb</h2>\n<pre><code class=\"language-cpp\">gdb test_g</code></pre>\n<p><img alt=\"\" height=\"311\" src=\"image\\ab2804a1dced4305ac014290611381b7.png\" width=\"955\"/></p>\n<p><span style=\"color:#fe2c24;\"><strong>注意：这里要进入的是test_g</strong></span></p>\n<h2 id=\"2.2%20%E6%98%BE%E7%A4%BA%E6%BA%90%E4%BB%A3%E7%A0%81\">2.2 显示源代码</h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">list</span>\n<span style=\"color:#777777;\">／</span>\n<span style=\"color:#777777;\">l </span>\n<span style=\"color:#777777;\">行号：显示</span>\n<span style=\"color:#777777;\">binFile</span>\n<span style=\"color:#777777;\">源代码，接着上次的位置往下列，每次列</span>\n<span style=\"color:#777777;\">10</span>\n<span style=\"color:#777777;\">行。 </span>\n</div>\n<div>\n<span style=\"color:#777777;\">list</span>\n<span style=\"color:#777777;\">／</span>\n<span style=\"color:#777777;\">l </span>\n<span style=\"color:#777777;\">函数名：列出某个函数的源代码。</span>\n</div>\n</blockquote>\n<pre><code class=\"language-cpp\">list\nlist 0</code></pre>\n<p><img alt=\"\" height=\"287\" src=\"image\\b775d431ad71494186f74977633918cf.png\" width=\"528\"/></p>\n<p><img alt=\"\" height=\"319\" src=\"image\\627c469f84c642538e550ed94fdbe660.png\" width=\"480\"/> </p>\n<p></p>\n<h2 id=\"2.3%20%E6%89%93%E6%96%AD%E7%82%B9%20%E6%9F%A5%E7%9C%8B%E6%96%AD%E7%82%B9%E4%BF%A1%E6%81%AF\">2.3 打断点 查看断点信息</h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">break(b) </span>\n<span style=\"color:#777777;\">行号：在某一行设置断点 </span>\n</div>\n<div>\n<span style=\"color:#777777;\">break </span>\n<span style=\"color:#777777;\">函数名：在某个函数开头设置断点</span>\n</div>\n</blockquote>\n<div>\n<pre><code class=\"language-cpp\">b 行号</code></pre>\n<p><img alt=\"\" height=\"62\" src=\"image\\15835c94caee468f829628b2b9e57b26.png\" width=\"797\"/></p>\n<blockquote>\n<p> info b ：<span style=\"color:#777777;\">查看断点信息。</span></p>\n</blockquote>\n</div>\n<p><img alt=\"\" height=\"88\" src=\"image\\db4e68ded61c4a89b72306bd073f0c6c.png\" width=\"890\"/> </p>\n<p> </p>\n<h2 id=\"2.4%20%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F\">2.4 运行程序</h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">r</span>\n<span style=\"color:#777777;\">或</span>\n<span style=\"color:#777777;\">run</span>\n<span style=\"color:#777777;\">：运行程序</span>\n</div>\n</blockquote>\n<p><img alt=\"\" height=\"181\" src=\"image\\f66b07f01552491b94490631d46ca613.png\" width=\"964\"/> </p>\n<h2 id=\"2.5%20%E6%9F%A5%E7%9C%8B%E5%8F%98%E9%87%8F%E4%BF%A1%E6%81%AF\">2.5 查看变量信息</h2>\n<blockquote>\n<p><span style=\"color:#777777;\">print(p)</span><span style=\"color:#777777;\">：打印表达式的值，通过表达式可以修改变量的值或者调用函数 </span></p>\n<p><span style=\"color:#777777;\">p </span><span style=\"color:#777777;\">变量：打印变量值。</span></p>\n<p><span style=\"color:#777777;\">p &amp;变量：打印变量地址</span></p>\n</blockquote>\n<p><img alt=\"\" height=\"110\" src=\"image\\97869c2aafc64289bd9d15af22a2cc1c.png\" width=\"383\"/> </p>\n<h2 id=\"2.6%20%E9%80%90%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C\">2.6 逐语句执行</h2>\n<blockquote>\n<p> <span style=\"color:#777777;\">s</span><span style=\"color:#777777;\">或</span><span style=\"color:#777777;\">step</span><span style=\"color:#777777;\">：进入函数调用</span></p>\n</blockquote>\n<pre><code class=\"language-cpp\">s</code></pre>\n<p> <img alt=\"\" height=\"110\" src=\"image\\722366f2884f491d92b32f581f062044.png\" width=\"415\"/></p>\n<h2 id=\"2.7%C2%A0%20%E9%80%90%E8%BF%87%E7%A8%8B%E6%89%A7%E8%A1%8C%C2%A0\">2.7  逐过程执行 </h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">n </span>\n<span style=\"color:#777777;\">或</span>\n<span style=\"color:#777777;\"> next</span>\n<span style=\"color:#777777;\">：单条执行（不进入函数调用）</span>\n</div>\n</blockquote>\n<pre><code class=\"language-cpp\">n</code></pre>\n<p> <img alt=\"\" height=\"111\" src=\"image\\04bace8abfeb4f9d82874626652b9813.png\" width=\"397\"/></p>\n<p> </p>\n<div></div>\n<h2 id=\"2.8%20%E5%88%A0%E9%99%A4%E6%96%AD%E7%82%B9%C2%A0\">2.8 删除断点 </h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">delete breakpoints</span>\n<span style=\"color:#777777;\">：删除所有断点 </span>\n</div>\n<div>\n<span style=\"color:#777777;\">delete breakpoints n</span>\n<span style=\"color:#777777;\">：删除序号为</span>\n<span style=\"color:#777777;\">n</span>\n<span style=\"color:#777777;\">的断点</span>\n</div>\n</blockquote>\n<pre><code class=\"language-cpp\">d 断点num</code></pre>\n<p><img alt=\"\" height=\"160\" src=\"image\\cebb1ddd089640afb522d3891e2c9a26.png\" width=\"891\"/></p>\n<p> </p>\n<h2 id=\"%C2%A02.9%20%E8%B0%83%E7%94%A8%E5%A0%86%E6%A0%88\"> 2.9 调用堆栈</h2>\n<blockquote>\n<p> <span style=\"color:#777777;\">breaktrace(</span><span style=\"color:#777777;\">或</span><span style=\"color:#777777;\">bt)</span><span style=\"color:#777777;\">：查看各级函数调用及参数 </span></p>\n</blockquote>\n<pre><code class=\"language-cpp\">bt</code></pre>\n<p><img alt=\"\" height=\"60\" src=\"image\\b6eedfdd4e1249b6a00bdaa1a00cf59a.png\" width=\"377\"/></p>\n<p></p>\n<h2 id=\"2.10%C2%A0%E8%B7%9F%E8%B8%AA%E5%8F%98%E9%87%8F\">2.10 <span style=\"color:#777777;\">跟踪变量</span></h2>\n<blockquote>\n<p></p>\n<div>\n<span style=\"color:#777777;\">display </span>\n<span style=\"color:#777777;\">变量名：跟踪查看一个变量，每次停下来都显示它的值 </span>\n</div>\n<div>\n<span style=\"color:#777777;\">undisplay</span>\n<span style=\"color:#777777;\">：取消对先前设置的那些变量的跟踪</span>\n</div>\n</blockquote>\n<p><img alt=\"\" height=\"400\" src=\"image\\3119fa79ddff4b559320fd75be19a710.png\" width=\"540\"/></p>\n<p> <img alt=\"\" height=\"203\" src=\"image\\ac6d51cd7b5749f3990966d8726a85cc.png\" width=\"588\"/></p>\n<p></p>\n<h2 id=\"2.11%20%E8%B7%B3%E8%BD%AC%E8%87%B3x%E8%A1%8C\">2.11 跳转至x行</h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">until X</span>\n<span style=\"color:#777777;\">行号：跳至</span>\n<span style=\"color:#777777;\">X</span>\n<span style=\"color:#777777;\">行 </span>\n</div>\n</blockquote>\n<p><img alt=\"\" height=\"107\" src=\"image\\9a75f47fc2da4762a44e38d7cbea95cb.png\" width=\"333\"/></p>\n<p></p>\n<h2 id=\"2.12%20%E8%B7%B3%E8%BD%AC%E8%87%B3%E4%B8%8B%E4%B8%80%E4%B8%AA%E6%96%AD%E7%82%B9\">2.12 跳转至下一个断点</h2>\n<blockquote>\n<div>\n<span style=\"color:#777777;\">continue(</span>\n<span style=\"color:#777777;\">或</span>\n<span style=\"color:#777777;\">c)</span>\n<span style=\"color:#777777;\">：从当前位置开始连续而非单步执行程序</span>\n</div>\n</blockquote>\n<p><img alt=\"\" height=\"414\" src=\"image\\3af1e46e9e4a47579f5598397dc111c7.png\" width=\"688\"/> </p>\n<h2 id=\"2.13%20%E5%B0%86%E4%B8%80%E4%B8%AA%E6%8C%87%E5%AE%9A%E5%87%BD%E6%95%B0%E8%B7%91%E5%AE%8C%20finish\">2.13 将一个指定函数跑完 finish</h2>\n<blockquote>\n<p>finish:执行完成一个函数就停止</p>\n</blockquote>\n<p></p>\n<p>（本篇完）</p>\n</div>\n</div>"}