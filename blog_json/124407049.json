{"blogid": "124407049", "writerAge": "码龄7年", "writerBlogNum": "22", "writerCollect": "52", "writerComment": "30", "writerFan": "688", "writerGrade": "2级", "writerIntegral": "362", "writerName": "我是大咸鱼", "writerProfileAdress": "writer_image\\profile_124407049.jpg", "writerRankTotal": "77618", "writerRankWeekly": "24610", "writerThumb": "47", "writerVisitNum": "27701", "blog_read_count": "1750", "blog_time": "已于 2022-04-25 16:10:51 修改", "blog_title": "Unity3D使用LitJson.dll解析报错问题", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><strong>报错内容：</strong></p>\n<p>JsonException: Invalid character '<br/> LitJson.Lexer.NextToken () (at &lt;e591cc6acad24a94a39b4890df7f7e01&gt;:0)</p>\n<p></p>\n<p><strong>需要解析的数据格式：</strong></p>\n<p>{<!-- --><br/>   \"success\" : true,<br/>   \"message\" : \"操作成功\",<br/>   \"code\" : \"0002\",<br/>   \"data\" : {<!-- --><br/>     \"role\" : \"0\",<br/>     \"updateUser\" : \"142\",<br/>     \"updateTime\" : \"2022-04-24T17:19:33.887\",<br/>     \"userName\" : \"ceshi1\",<br/>     \"realName\" : \"测试1\",<br/>     \"isDeleted\" : \"false\",<br/>     \"createTime\" : \"2022-03-04T18:12:43\",<br/>     \"roleName\" : \"管理员\",<br/>     \"createUser\" : \"139\",<br/>     \"id\" : \"142\",<br/>   }<br/> }</p>\n<p></p>\n<p><strong>解析报错原因：</strong></p>\n<p>由于有的协议在解密处理转换为C#的字符串时，会在末尾有“\\0”字符，也就是对应ascii的空格，C#中不需要；</p>\n<p>LitJson.dll库实现时考虑不周全，没有考虑到字符‘\\0’的关系；LitJson.dll认为一个C#字符串中不应</p>\n<p>该包含‘\\0’，所以他没有处理这种情况，对于不能处理的字符他抛出异常。</p>\n<p></p>\n<p><strong>解决方案：</strong></p>\n<p>原来的代码</p>\n<p>Encoding.UTF8.GetString(resultArray)</p>\n<p>修改后的代码</p>\n<p>Encoding.UTF8.GetString(resultArray).TrimEnd('\\0')</p>\n<p>把字符串尾部的空格删除</p>\n</div>\n</div>"}