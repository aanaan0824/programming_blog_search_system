{"blogid": "125041112", "writerAge": "码龄5年", "writerBlogNum": "5", "writerCollect": "16", "writerComment": "11", "writerFan": "4", "writerGrade": "1级", "writerIntegral": "67", "writerName": "大白的自习室", "writerProfileAdress": "writer_image\\profile_125041112.jpg", "writerRankTotal": "135941", "writerRankWeekly": "321844", "writerThumb": "9", "writerVisitNum": "2272", "blog_read_count": "1519", "blog_time": "于 2022-05-30 09:59:41 发布", "blog_title": "[c#]一键设置popo猫回收站工具含源码", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p style=\"text-align:center;\"><img alt=\"\" src=\"https://img-blog.csdnimg.cn/d6e44db871074f95b5d9a4fa154fa45e.gif\"/></p>\n<p></p>\n<p>功能介绍：</p>\n<p>[c#]一键设置popo猫回收站工具含源码</p>\n<p>在抖音上看到挺好玩的，设置popo猫回收站图标，回收站内没有文件时嘴巴是张开的，当回收站内放置文件时嘴巴是闭合的。</p>\n<p><strong>其实功能实现很简单，准备两个新的素材图标文件，通过修改注册表值将素材文件的路径写入进去即可。</strong></p>\n<p><strong><strong>一键设置</strong>popo猫回收站工具含源码.主要的功能实现：</strong></p>\n<p><strong>1、将素材文件复制到c盘根目录</strong></p>\n<p><strong>2、修改注册表的相关键值，将素材文件的路径写入进去</strong></p>\n<p><strong>3、在注册表内重新写入原先的键值，恢复回收站默认图标</strong></p>\n<p>主要源码：</p>\n<p>拷贝文件到另一个文件夹下功能实现代码：</p>\n<pre><code class=\"language-cs\">public void CopyToFile(string sourceName, string folderPath)\n        {\n            //例子：\n            //源文件路径\n            //string sourceName = @\"D:\\Source\\Test.txt\";\n            //目标路径:项目下的NewTest文件夹,(如果没有就创建该文件夹)\n            //string folderPath = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, \"NewTest\");\n\n            if (!Directory.Exists(folderPath))\n            {\n                Directory.CreateDirectory(folderPath);\n            }\n\n            //当前文件如果不用新的文件名，那么就用原文件文件名\n            string fileName = Path.GetFileName(sourceName);\n            //这里可以给文件换个新名字，如下：\n            //string fileName = string.Format(\"{0}.{1}\", \"newFileText\", \"txt\");\n\n            //目标整体路径\n            string targetPath = Path.Combine(folderPath, fileName);\n\n            //Copy到新文件下\n            FileInfo file = new FileInfo(sourceName);\n            if (file.Exists)\n            {\n                //true 为覆盖已存在的同名文件，false 为不覆盖\n                file.CopyTo(targetPath, true);\n            }\n        }</code></pre>\n<p>修改注册表键值实现popo猫图标功能实现代码：</p>\n<pre><code class=\"language-cs\">\nif (radioButton1.Checked == true)\n            {\n                //将素材文件复制到c盘根目录\n                CopyToFile(strExePath + @\"\\popo1close.dll\", @\"C:\\\");  \n                CopyToFile(strExePath + @\"\\popo1open.dll\", @\"C:\\\");\n\n                //修改注册表更换回收站图标\n                RegistryKey key = Registry.CurrentUser;\n                RegistryKey software = key.OpenSubKey(@\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\DefaultIcon\", true);\n                software.SetValue(\"full\", @\"C:\\popo1close.dll\");\n                software.SetValue(\"empty\", @\"C:\\popo1open.dll\");\n                software.SetValue(\"(默认)\", @\"C:\\popo1open.dll\");\n                key.Close();\n\n                MessageBox.Show(\"popo猫回收站1设置成功!\");\n            }\n            else if (radioButton2.Checked == true)\n            {\n                //将素材文件复制到c盘根目录\n                CopyToFile(strExePath + @\"\\popo2close.dll\", @\"C:\\\");\n                CopyToFile(strExePath + @\"\\popo2open.dll\", @\"C:\\\");              \n                \n                //修改注册表更换回收站图标\n                RegistryKey key = Registry.CurrentUser;\n                RegistryKey software = key.OpenSubKey(@\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\DefaultIcon\", true);\n                software.SetValue(\"full\", @\"C:\\popo2close.dll\");\n                software.SetValue(\"empty\", @\"C:\\popo2open.dll\");\n                software.SetValue(\"(默认)\", @\"C:\\popo2open.dll\");\n                key.Close();\n\n                MessageBox.Show(\"popo猫回收站2设置成功!\");\n            }</code></pre>\n<p>有分的来这下：<a href=\"https://download.csdn.net/download/huamuxiansen/85497825\" title=\"[c#]一键设置popo猫回收站工具含源码-C#文档类资源-CSDN下载\">[c#]一键设置popo猫回收站工具含源码-C#文档类资源-CSDN下载</a></p>\n<p>没分的来这下：</p>\n<p>https://pan.baidu.com/s/1IU1Iz5hHqeGwZG9RQZqUFg</p>\n<p>提取码：i5za</p>\n</div>\n</div>"}