{"blogid": "125963655", "writerAge": "码龄4年", "writerBlogNum": "82", "writerCollect": "3863", "writerComment": "406", "writerFan": "3165", "writerGrade": "5级", "writerIntegral": "3111", "writerName": "小王不头秃", "writerProfileAdress": "writer_image\\profile_125963655.jpg", "writerRankTotal": "8379", "writerRankWeekly": "19370", "writerThumb": "1060", "writerVisitNum": "362632", "blog_read_count": "20139", "blog_time": "已于 2022-07-26 12:34:20 修改", "blog_title": "opencv可以有多有趣", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>opencv可以有多有趣</h3>\n<ul><li><a href=\"#_1\">前言</a></li><li><a href=\"#_8\">内容</a></li><li><a href=\"#_30\">实现</a></li><li><a href=\"#_81\">成果</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_1\"></a>前言</h1>\n<p>这一段时间没怎么写博客，偶尔写一次也是比较正经的博客，感觉自己都不正常了。今天看课的时候突然来了灵感，那就整个烂活玩一玩。</p>\n<p>先把视频中的人物边缘找出来，然后再在一张白色底板上绘制出来，再配以rgb的变化，会是什么样的！</p>\n<p>来试试吧<br/> <img alt=\"在这里插入图片描述\" src=\"image\\30da684fdc28499e815bad5b3b4fd69e.png\"/></p>\n<h1><a id=\"_8\"></a>内容</h1>\n<p>首先我们需要一个有人物的视频，建议使用哪些人物和背景区分度比较高的视频。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\18152cbf926346a7a151459e58c4f26b.png\"/></p>\n<p>我么想要完成的功能就是在视频中把一个人的轮廓画出来，然后随着视频一起播放。</p>\n<p>接下来就可以聊聊解决思路了。</p>\n<p>第一步其实先把图像给整成灰度图，直接使用opencv的cvtColor函数即可</p>\n<p>接下来为了方便提取人物的轮廓，我们需要做一下二值处理，这里使用的函数是threshold，这个函数中会设置一个的阈值，当像素值超过这个阈值时，会直接将像素值设置为我们预定的像素值，当小于阈值时，则会将像素值设置为0，这样就可以得到一个二值图像。如下图所示，可以看到轮廓很清晰了<br/> <img alt=\"在这里插入图片描述\" src=\"image\\70ec5752150e479c814bd5f72537fb2e.png\"/></p>\n<p>相对于原视频，这个时候的图像已经很清楚的展示出了我们需要的内容，并且很容易就可以提取出轮廓</p>\n<p>这之后，再将轮廓画在视频上就可以了，如下图<br/> <img alt=\"在这里插入图片描述\" src=\"image\\6a0264b80c9b4b32a6f0b6a4b5d01a5b.png\"/></p>\n<p>接下来就可以开始搞代码了</p>\n<h1><a id=\"_30\"></a>实现</h1>\n<p>完整代码如下</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> 图像识别 <span class=\"token keyword\">import</span> picutils\n<span class=\"token keyword\">import</span> cv2\n<span class=\"token comment\"># 读取视频</span>\ncap <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>VideoCapture<span class=\"token punctuation\">(</span><span class=\"token string\">'xxx.mp4'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 设置标志位 超过5就变色</span>\nm <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    m <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token comment\"># 颜色数组的下标</span>\n    l <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\"># 颜色数组  实现rgb变化效果 </span>\n    colos <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># frame存储每一帧的图像</span>\n    ret<span class=\"token punctuation\">,</span> frame <span class=\"token operator\">=</span> cap<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 转换为灰度图</span>\n    gray <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2GRAY<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 二值处理   这里的阈值设置为130可能不是最好的，可以试着再改改  超过130就会变255，否则就是0，从而实现二值图像的生成</span>\n    thresh <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>threshold<span class=\"token punctuation\">(</span>gray<span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>THRESH_BINARY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># 边缘检测，检测出边缘方便轮廓提取</span>\n    edged <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>Canny<span class=\"token punctuation\">(</span>thresh<span class=\"token punctuation\">,</span> <span class=\"token number\">75</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 获取所有的轮廓，这里没有在进行处理，有兴趣可以提取出需要的</span>\n    cnts <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>findContours<span class=\"token punctuation\">(</span>edged<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>RETR_EXTERNAL<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>CHAIN_APPROX_SIMPLE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token comment\"># 选择较大的轮廓</span>\n    real_cnts<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> cnts<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> cv2<span class=\"token punctuation\">.</span>arcLength<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&gt;</span><span class=\"token number\">30</span><span class=\"token punctuation\">:</span>\n            real_cnts<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 设置一个白板图片，作为人物的背景板</span>\n    back <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">480</span><span class=\"token punctuation\">,</span> <span class=\"token number\">720</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span><span class=\"token string\">\"uint8\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">255</span>\n    <span class=\"token comment\"># 展示5帧修改一次颜色数组的下标  l就是下标值</span>\n    <span class=\"token keyword\">if</span>  m <span class=\"token operator\">==</span> <span class=\"token number\">5</span><span class=\"token punctuation\">:</span>\n        l <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">3</span>\n        m<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n    <span class=\"token comment\"># 把轮廓绘制在白色的背景板上</span>\n    cv2<span class=\"token punctuation\">.</span>drawContours<span class=\"token punctuation\">(</span>back<span class=\"token punctuation\">,</span> real_cnts<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> colos<span class=\"token punctuation\">[</span>l<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    cv2<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span><span class=\"token string\">'frame'</span><span class=\"token punctuation\">,</span> back<span class=\"token punctuation\">)</span>\n    k <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>waitKey<span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span>\n    <span class=\"token comment\"># 等待退出键，就可以直接退出</span>\n    <span class=\"token keyword\">if</span> k <span class=\"token operator\">==</span> <span class=\"token number\">27</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">break</span>\n\ncap<span class=\"token punctuation\">.</span>release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ncv2<span class=\"token punctuation\">.</span>destroyAllWindows<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n</code></pre>\n<h1><a id=\"_81\"></a>成果</h1>\n<p>成果如下</p>\n<p><img alt=\"在这里插入图片描述\" src=\"https://img-blog.csdnimg.cn/5635f43921aa4732bec6c43111a91d59.gif\"/></p>\n<p><strong>刚接触opencv做的很粗糙</strong></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\12421594411f473982d60001ceec3fb3.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}