{"blogid": "125490078", "writerAge": "码龄5年", "writerBlogNum": "157", "writerCollect": "1261", "writerComment": "439", "writerFan": "4709", "writerGrade": "5级", "writerIntegral": "3185", "writerName": "小满zs", "writerProfileAdress": "writer_image\\profile_125490078.jpg", "writerRankTotal": "6067", "writerRankWeekly": "953", "writerThumb": "1100", "writerVisitNum": "383381", "blog_read_count": "4458", "blog_time": "已于 2022-07-30 17:23:43 修改", "blog_title": "小满Vue3第三十六章（Vue如何开发移动端）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><a href=\"https://www.bilibili.com/video/BV1dS4y1y7vd?p=52&amp;vd_source=7313597670b28c3c44c50e326d82d040\" title=\"视频教程Vue3 + vite + Ts + pinia + 实战 + 源码 +全栈_哔哩哔哩_bilibili\">视频教程Vue3 + vite + Ts + pinia + 实战 + 源码 +全栈_哔哩哔哩_bilibili</a></p>\n<p><strong><span style=\"color:#fe2c24;\">如果使用npm init vue@latest 报错</span></strong></p>\n<p><strong><span style=\"color:#fe2c24;\">error when starting dev server: Error: Cannot find module 'node:path'</span></strong></p>\n<p><strong><span style=\"color:#fe2c24;\">nodejs 升级为16版本就好了</span></strong></p>\n<p>开发移动端最主要的就是适配各种手机，为此我研究了一套解决方案</p>\n<p>在之前我们用的是rem 根据HTML font-size 去做缩放</p>\n<p>现在有了更好用的vw vh</p>\n<p>vw 视口的最大宽度，1vw等于视口宽度的百分之一</p>\n<p>vh 视口的最大高度，1vh等于视口高度的百分之一</p>\n<p>1.安装依赖</p>\n<pre><code>\nnpm install postcss-px-to-viewport -D</code></pre>\n<p>因为vite中已经内联了postcss，所以并不需要额外的创建 postcss.config.js文件</p>\n<p>vite.config.ts</p>\n<pre><code>import { fileURLToPath, URL } from 'url'\n\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport vueJsx from '@vitejs/plugin-vue-jsx'\nimport postcsspxtoviewport from \"postcss-px-to-viewport\" //插件\n// https://vitejs.dev/config/\nexport default defineConfig({\n  plugins: [vue(), vueJsx()],\n  css: {\n    postcss: {\n      plugins: [\n        postcsspxtoviewport({\n          unitToConvert: 'px', // 要转化的单位\n          viewportWidth: 750, // UI设计稿的宽度\n          unitPrecision: 6, // 转换后的精度，即小数点位数\n          propList: ['*'], // 指定转换的css属性的单位，*代表全部css属性的单位都进行转换\n          viewportUnit: 'vw', // 指定需要转换成的视窗单位，默认vw\n          fontViewportUnit: 'vw', // 指定字体需要转换成的视窗单位，默认vw\n          selectorBlackList: ['ignore-'], // 指定不转换为视窗单位的类名，\n          minPixelValue: 1, // 默认值1，小于或等于1px则不进行转换\n          mediaQuery: true, // 是否在媒体查询的css代码中也进行转换，默认false\n          replace: true, // 是否转换后直接更换属性值\n          landscape: false // 是否处理横屏情况\n        })\n      ]\n    }\n  },\n  resolve: {\n    alias: {\n      '@': fileURLToPath(new URL('./src', import.meta.url))\n    }\n  }\n})</code></pre>\n<p><strong><span style=\"color:#fe2c24;\">如果你用的vite 是 ts 他这个插件并没有提供声明文件我已经帮大家写好了声明文件（良心）</span></strong></p>\n<pre><code>declare module 'postcss-px-to-viewport' {\n\n    type Options = {\n        unitToConvert: 'px' | 'rem' | 'cm' | 'em',\n        viewportWidth: number,\n        viewportHeight: number, // not now used; TODO: need for different units and math for different properties\n        unitPrecision: number,\n        viewportUnit: string,\n        fontViewportUnit: string,  // vmin is more suitable.\n        selectorBlackList: string[],\n        propList: string[],\n        minPixelValue: number,\n        mediaQuery: boolean,\n        replace: boolean,\n        landscape: boolean,\n        landscapeUnit: string,\n        landscapeWidth: number\n    }\n\n    export default function(options: Partial&lt;Options&gt;):any\n}</code></pre>\n<p>引入声明文件 tsconfig.app <span style=\"color:#fe2c24;\"><strong>postcss-px-to-viewport.d.ts跟vite.ts同级</strong></span></p>\n<pre><code>{\n  \"extends\": \"@vue/tsconfig/tsconfig.web.json\",\n  \"include\": [\"env.d.ts\", \"src/**/*\", \"src/**/*.vue\", \"postcss-px-to-viewport.d.ts\"],\n  \"exclude\": [\"src/**/__tests__/*\"],\n  \"compilerOptions\": {\n    \"composite\": true,\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"./src/*\"]\n    }\n  }\n}</code></pre>\n<p>代码案例</p>\n<pre><code>&lt;template&gt;\n  &lt;div class=\"wraps\"&gt;\n    &lt;header class=\"header\"&gt;\n      &lt;div&gt;left&lt;/div&gt;\n      &lt;div&gt;中间&lt;/div&gt;\n      &lt;div&gt;right&lt;/div&gt;\n    &lt;/header&gt;\n\n    &lt;main class=\"main\"&gt;\n      &lt;div class=\"main-items\" v-for=\"item in 100\"&gt;\n        &lt;div class=\"main-port\"&gt;头像&lt;/div&gt;\n        &lt;div class=\"main-desc\"&gt;\n          &lt;div&gt;小满{<!-- -->{item}}&lt;/div&gt;\n          &lt;div&gt;你妈妈喊你回家穿丝袜啦&lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/main&gt;\n\n\n    &lt;footer class=\"footer\"&gt;\n      &lt;div class=\"footer-items\" v-for=\"item in footer\"&gt;\n        &lt;div&gt;{<!-- -->{ item.icon }}&lt;/div&gt;\n        &lt;div&gt;{<!-- -->{ item.text }}&lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/footer&gt;\n  &lt;/div&gt;\n\n&lt;/template&gt;\n  \n&lt;script setup lang='ts'&gt;\nimport { reactive } from 'vue';\n\ntype Footer&lt;T&gt; = {\n  icon: T,\n  text: T\n}\n\nconst footer = reactive&lt;Footer&lt;string&gt;[]&gt;([\n  {\n    icon: \"1\",\n    text: \"首页\"\n  },\n  {\n    icon: \"2\",\n    text: \"商品\"\n  },\n  {\n    icon: \"3\",\n    text: \"信息\"\n  },\n  {\n    icon: \"4\",\n    text: \"我的\"\n  }\n])\n&lt;/script&gt;\n  \n&lt;style lang=\"less\"&gt;\n@import url('@/assets/base.css');\n\nhtml,\nbody,\n#app {\n  height: 100%;\n  overflow: hidden;\n  font-size: 14px;\n}\n\n.wraps {\n  height: inherit;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.header {\n  background-color: pink;\n  display: flex;\n  height: 30px;\n  align-items: center;\n  justify-content: space-around;\n\n  div:nth-child(1) {\n    width: 40px;\n  }\n\n  div:nth-child(2) {\n    text-align: center;\n  }\n\n  div:nth-child(3) {\n    width: 40px;\n    text-align: right;\n  }\n}\n\n.main {\n  flex: 1;\n  overflow: auto;\n\n  &amp;-items {\n    display: flex;\n    border-bottom: 1px solid #ccc;\n    box-sizing: border-box;\n    padding: 5px;\n  }\n\n  &amp;-port {\n    background: black;\n    width: 30px;\n    height: 30px;\n    border-radius: 200px;\n  }\n  &amp;-desc{\n     margin-left:10px;\n     div:last-child{\n        font-size: 10px;\n        color:#333;\n        margin-top: 5px;\n     }\n  }\n}\n\n.footer {\n\n  border-top: 1px solid #ccc;\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr 1fr;\n\n  &amp;-items {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    padding: 5px;\n  }\n}\n&lt;/style&gt;</code></pre>\n<p><img alt=\"\" height=\"804\" src=\"image\\ce8fab58321d419ba5a70fa239b6b4cf.png\" width=\"597\"/></p>\n<p><img alt=\"\" height=\"1011\" src=\"image\\87a3a853375f4529a3affdb1576ca469.png\" width=\"1197\"/></p>\n<p><img alt=\"\" height=\"911\" src=\"image\\8c7cad522fdc486280459a64de992239.png\" width=\"533\"/></p>\n<p><strong> 基本适配百分之99的屏幕</strong></p>\n<h2>如何将我们的Vue 项目打包成App（<span style=\"color:#fe2c24;\">会安卓的可以跳过</span>）</h2>\n<p>1.安装JDK <a href=\"https://www.oracle.com/java/technologies/downloads/#java8-windows\" title=\"Java Downloads | Oracle\">Java Downloads | Oracle</a></p>\n<p>配置环境变量</p>\n<p>JAVA_HOME</p>\n<p> <img alt=\"\" height=\"190\" src=\"image\\b2f88a32523c450a931860bc19fa7f08.png\" width=\"667\"/></p>\n<p> CLASSPATH （下面的照抄就行）</p>\n<pre><code>.;%JAVA_HOME%\\lib\\dt.jar;%JAVA_HOME%\\lib\\tools.jar;</code></pre>\n<p> 最后一个Path</p>\n<p>添加 %JAVA_HOME%\\bin</p>\n<p><img alt=\"\" height=\"570\" src=\"image\\a4c247b6f85f4d798c425fb8a0f45dd4.png\" width=\"541\"/></p>\n<p>2.安卓编辑器下载地址（建议科学上网不然很慢）<a href=\"https://developer.android.com/\" title=\"https://developer.android.com/\">https://developer.android.com/</a></p>\n<p>一直next 就行了 然后磁盘选一下 安装就可以了 </p>\n<p>装完启动需要还需要安装sdk 然后就可以打开了</p>\n<p>新建一个空项目选这个就可以了</p>\n<p><img alt=\"\" height=\"658\" src=\"image\\7695ebb4fb9d4aa39f0b32a3917631e4.png\" width=\"916\"/></p>\n<p><img alt=\"\" height=\"658\" src=\"image\\d261bade1d2f4ebebc63d1f6d9e6bef5.png\" width=\"916\"/> 语言会java选java 会别的就选别的</p>\n<p><img alt=\"\" height=\"1040\" src=\"image\\8599bf20eb154cecb7b5d553b509c4b8.png\" width=\"1200\"/></p>\n<p> 等待加载完成</p>\n<p><img alt=\"\" height=\"1029\" src=\"image\\3dd87412d79041ab8516ecbd104396ab.png\" width=\"1200\"/></p>\n<p>打开之后可以创建一个虚拟机 </p>\n<p><img alt=\"\" height=\"800\" src=\"image\\ae3fcdcd9f044099867b5c9e26abb719.png\" width=\"1016\"/></p>\n<p> 创建完成之后就可以运行安卓项目</p>\n<p><img alt=\"\" height=\"1040\" src=\"image\\4cbda0eaadd3401ebac37c4c4a840f92.png\" width=\"1200\"/></p>\n<p> 其实就是一个虚拟手机</p>\n<p><img alt=\"\" height=\"972\" src=\"image\\67ce399b7bec47dc8ac4adb347982d18.png\" width=\"1200\"/></p>\n<p>切换成代码模式</p>\n<p><img alt=\"\" height=\"1027\" src=\"image\\0acf8d80df214fe3bb48111f499640a6.png\" width=\"1200\"/></p>\n<p> 修改成以下代码</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LinearLayout  xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:id=\"@+id/activity_main\"\n    android:layout_width=\"match_parent\"\n    android:orientation=\"vertical\"\n    android:layout_height=\"match_parent\"&gt;\n\n    &lt;WebView\n        android:id=\"@+id/web_view\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\" /&gt;\n&lt;/LinearLayout  &gt;</code></pre>\n<p> 其实就是类似于我们前端的display felx <img alt=\"\" height=\"456\" src=\"image\\c91b046eb9c34db9ad5c32dd2326e6ea.png\" width=\"976\"/></p>\n<p> webView 就和小程序的webView 基本一样 套网页的</p>\n<p><strong>match_parent表示让当前控件的大小和父布局的大小一样，也就是让父布局来决定当前控件的大小</strong></p>\n<p><img alt=\"\" height=\"497\" src=\"image\\8699ec151b4c494e8a33a2339abee988.png\" width=\"1200\"/></p>\n<p>java 代码逻辑</p>\n<pre><code>package com.example.myapplication;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.os.Bundle;\n\nimport android.webkit.WebView;\n\nimport android.app.Activity;\n\nimport android.webkit.WebViewClient;\n\npublic class MainActivity extends Activity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        //设置一个Activity的显示界面，\n        setContentView(R.layout.activity_main);\n\n        WebView view = (WebView)findViewById(R.id.web_view);\n        //设置 WebView 属性，能够执行 Javascript 脚本\n        view.getSettings().setJavaScriptEnabled(true);\n        //加载需要显示的网页 不能使用局域网地址 只能虚拟机专属地址 http://10.0.2.2 端口是我们vue 项目端口\n        view.loadUrl(\"http://10.0.2.2:3000\");\n\n        view.setWebViewClient(new WebViewClient());\n    }\n}</code></pre>\n<p></p>\n<pre><strong>加载需要显示的网页 不能使用局域网地址 只能虚拟机专属地址 http://10.0.2.2 端口是我们vue 项目端口</strong></pre>\n<p><img alt=\"\" height=\"732\" src=\"image\\99db1ba5e6af4fa9ba78f0251a37a8fe.png\" width=\"1200\"/></p>\n<p> 配置权限</p>\n<p><img alt=\"\" height=\"851\" src=\"image\\1b0e1c3fb81f4138a7acda3248502774.png\" width=\"1200\"/></p>\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.example.myapplication\"&gt;\n\n    &lt;application\n        android:allowBackup=\"true\"\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\n        android:fullBackupContent=\"@xml/backup_rules\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.MyApplication\"\n        android:usesCleartextTraffic=\"true\"\n        tools:targetApi=\"31\"&gt;\n        &lt;activity\n            android:name=\".MainActivity\"\n            android:exported=\"true\"&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=\"android.intent.action.MAIN\" /&gt;\n\n                &lt;category android:name=\"android.intent.category.LAUNCHER\" /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/activity&gt;\n    &lt;/application&gt;\n    &lt;uses-permission android:name=\"android.permission.INTERNET\" /&gt;\n    &lt;uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" /&gt;\n    &lt;uses-permission android:name=\"android.permission.ACCESS_WIFI_STATE\" /&gt;\n&lt;/manifest&gt;</code></pre>\n<p> <img alt=\"\" height=\"1019\" src=\"image\\5901aa08c9d04ca488ecb21a68674ad9.png\" width=\"1200\"/></p>\n<p> 你就可以看到我们的项目了</p>\n<p>最后打包</p>\n<p>打包的时候路径记得换成线上的服务器地址</p>\n<p><img alt=\"\" height=\"996\" src=\"image\\eaa5fe2685bf4791bfd658be93eda4e7.png\" width=\"1200\"/></p>\n<p><img alt=\"\" height=\"1200\" src=\"image\\5be35b73dcdf4ddba3ff7c7428f23c84.jpeg\" width=\"864\"/></p>\n<p> 安卓手机实测</p>\n<p></p>\n</div>\n</div>"}