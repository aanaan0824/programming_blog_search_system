{"blogid": "123054726", "writerAge": "码龄4年", "writerBlogNum": "70", "writerCollect": "277", "writerComment": "11", "writerFan": "74", "writerGrade": "4级", "writerIntegral": "836", "writerName": "the zl", "writerProfileAdress": "writer_image\\profile_123054726.jpg", "writerRankTotal": "65200", "writerRankWeekly": "280722", "writerThumb": "48", "writerVisitNum": "132403", "blog_read_count": "1805", "blog_time": "于 2022-02-21 21:16:42 发布", "blog_title": "文件包含漏洞—allow_url_fopen和allow_url_include详解", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"_allow_url_fopenallow_url_include_0\"></a>文件包含漏洞_allow_url_fopen和allow_url_include详解</h2>\n<p><strong>提要</strong>：在文件包含漏洞中，PHP脚本环境中php.ini文件中通常会涉及到这两个参数，两个参数的开启或关闭影响文件包含漏洞的利用。</p>\n<h2><a id=\"1_3\"></a>1，参数简介：</h2>\n<p><strong>allow_url_fopen参数（只影响RFI，不影响LFI）</strong></p>\n<p><strong>简介</strong>：是否允许将URL（HTTP，HTTPS等）作为文件打开处理</p>\n<p><strong>allow_url_include参数（只影响RFI，不影响LFI）</strong><br/> <strong>简介</strong>：是否允许includeI()和require()函数包含URL（HTTP，HTTPS）作为文件处理</p>\n<h2><a id=\"2_12\"></a>2，验证：</h2>\n<pre><code class=\"prism language-c\">本地创建文件内容为<span class=\"token operator\">&lt;</span><span class=\"token operator\">?</span>php phpinfo<span class=\"token operator\">?</span><span class=\"token operator\">&gt;</span>的文件<span class=\"token number\">123.</span>txt，\n\n</code></pre>\n<p>当allow_url_fopen=Off和allow_url_include=Off或allow_url_fopen=Off和allow_url_include=On时，文件包含失败：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\f03c5e73a0ef47839e3d2824dd937b4d.png\"/><br/> 当allow_url_fopen=On和allow_url_include=On时，include等其他包含函数才会将URL代表的文件包含执行，文件包含成功:<br/> <img alt=\"在这里插入图片描述\" src=\"image\\c760838bc04c4d10ae071b8da2fbfd9b.png\"/></p>\n<h2><a id=\"3_23\"></a>3，总结：</h2>\n<p>只有当allow_url_fopen=On和allow_url_include=On时，include等其他包含函数才会将URL代表的文件包含执行</p>\n<h2><a id=\"_27\"></a>参考文章</h2>\n<p><a href=\"https://www.cnblogs.com/yinqin/articles/4958922.html\">allow_url_fopen 和 allow_url_include</a><br/> <a href=\"https://blog.csdn.net/qq_29566629/article/details/107779082?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5.pc_relevant_paycolumn_v3&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-5.pc_relevant_paycolumn_v3&amp;utm_relevant_index=10\">allow_url_include和allow_url_fopen 详解</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}