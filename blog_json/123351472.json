{"blogid": "123351472", "writerAge": "码龄1年", "writerBlogNum": "8", "writerCollect": "54", "writerComment": "7", "writerFan": "4", "writerGrade": "1级", "writerIntegral": "97", "writerName": "asdf_song", "writerProfileAdress": "writer_image\\profile_123351472.jpg", "writerRankTotal": "109907", "writerRankWeekly": "979320", "writerThumb": "10", "writerVisitNum": "6468", "blog_read_count": "1832", "blog_time": "已于 2022-03-14 15:49:43 修改", "blog_title": "企业人事管理系统", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>（C#、SQL）数据库人事管理系统（源代码下载、E-R图，数据库）</h3>\n<ul><li><a href=\"#_2\">企业人事管理系统功能</a></li><li><ul><li><a href=\"#_9\">系统需求分析</a></li><li><a href=\"#_12\">系统模块划分（功能模块图）</a></li><li><a href=\"#_15\">系统数据库设计</a></li><li><ul><li><a href=\"#ER_16\">E-R图设计</a></li><li><a href=\"#_19\">数据表设计</a></li></ul>\n</li><li><a href=\"#_37\">各个界面窗体类</a></li><li><a href=\"#_54\">各功能模块实现的主要源程序代码和运行截图</a></li><li><a href=\"#_78\">核心代码展示</a></li><li><a href=\"#_526\">源文件下载</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"_2\"></a>企业人事管理系统功能</h1>\n<pre><code>（1）职工档案信息的基本管理。能对职工档案信息进行添加、删除和修改等基本操作。\n（2）职工档案信息查询。可以按姓名、部门或任意条件查询相关职工的情况。\n（3）统计分析。包括统计文化程度、技术职务、年龄、工资等。\n（4）档案信息输出。可以输出职工信息到屏幕或打印机上。\n（5）其他操作。包括修改密码、设置权限（只有系统管理员能够进行）等\n</code></pre>\n<h2><a id=\"_9\"></a>系统需求分析</h2>\n<p>随着计算机软件开发水平不断进步，工作中许多方面都对传统技术做了改进，利用计算机实现更高效更便利的工作。如今的企业人事管理摒弃传统的人工管理方式，改用企业人事管理系统来实现人事管理。传统的人工管理方式，容易出现纰漏，并且人工性增加了遗失、篡改、泄露的风险。如今的人事管理系统，通过程序设计实现，不仅对人事管理过程进行了保密，并且提高了管理效率，达到事半功倍的效果，在企业人事管理中发挥着巨大作用。</p>\n<h2><a id=\"_12\"></a>系统模块划分（功能模块图）</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\87b18874c28349f4977ecffa02ee1114.png\"/></p>\n<h2><a id=\"_15\"></a>系统数据库设计</h2>\n<h3><a id=\"ER_16\"></a>E-R图设计</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\f46d13ed883040f9b9b0ef93ec9fd041.png\"/>E-R图可能不规范，因为我还没学，还请各位大神指教。</p>\n<h3><a id=\"_19\"></a>数据表设计</h3>\n<p>一. 根据概念结构设计，可转换得到如下关系模式：<br/> 职工（员工号，姓名，性别，年龄，电话，邮箱，部门号，家庭住址，文化程度，技术职务）<br/> 部门（部门号，部门名）<br/> 工资（工资号，基本工资，奖金，罚金，净工资，员工号）<br/> 考勤（考勤号，员工号，考勤日期，考勤类型）<br/> 用户（用户ID，密码，权限，员工号，工资号）</p>\n<p>职工表<br/> <img alt=\"在这里插入图片描述\" src=\"image\\285927fc6f5245d6897a0c246e3066c8.png\"/><br/> 部门表<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b5ae4d2aaf184e499a4a165f43a1bdbc.png\"/><br/> 工资表<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ed5968081c78437ba8b740b30a25243c.png\"/><br/> 考勤表<br/> <img alt=\"在这里插入图片描述\" src=\"image\\db881a47079849c5921ff9c3167761c6.png\"/><br/> 用户表<br/> <img alt=\"在这里插入图片描述\" src=\"image\\37b3aa3fc4c645899c47ae49392e23b5.png\"/></p>\n<h2><a id=\"_37\"></a>各个界面窗体类</h2>\n<p>登录界面窗口 EnterForm类<img alt=\"在这里插入图片描述\" src=\"image\\68f0a811105b4bb0b54b874fd5279344.png\"/><br/> 管理员窗口 ManegeForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\51ea0fae11444bc9a7a6f9bcc8ddba27.png\"/><br/> 员工窗口 StaffForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\4941d3e05d364e9baee588531d3d100a.png\"/><br/> 修改密码 PwdForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\a53ffe3f3c234c6ea64d7e49b69fe1a4.png\"/>用户注册 RegisterForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b57f700074b8426cabae6a9d168a68ac.png\"/><br/> 统计信息 StatisticsForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\5d4b0d758cbd40519a0aa09489e83d5f.png\"/><br/> 查询工资 FindsalaryForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\936455ad635e49c9a585a81b3abefb9b.png\"/><br/> 考勤管理 CheckForm类<br/> <img alt=\"在这里插入图片描述\" src=\"image\\12457694531c4e76b2b1591123aa32f2.png\"/><br/> 其余还有部分窗体类太多不便于一一展示，有读者需要自行下载源文件查看</p>\n<h2><a id=\"_54\"></a>各功能模块实现的主要源程序代码和运行截图</h2>\n<p>链接: <a href=\"https://www.csdn.net/\">link</a>.</p>\n<p>管理员登陆<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b75030aa3aea45dbbdeb43f6584c3d60.png\"/><br/> 员工档案信息显示<br/> <img alt=\"在这里插入图片描述\" src=\"image\\27e4f6a3870940c5b0f956844d4d5560.png\"/><br/> 管理员工资管理<br/> <img alt=\"在这里插入图片描述\" src=\"image\\9011085eedc047c0a6bdf94c47b302f3.png\"/><br/> 管理员部门管理<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ce52e6e7f33d448faa813f7ce2b01961.png\"/><br/> 查看工资<br/> <img alt=\"\" src=\"image\\946d853d379e4cc89f5e4e33d9892d56.png\"/>管理员课查看所有人员工资，且不需要账户密码，员工查看工资需要账户密码，否则不能查看（避免员工查看其他员工工资）</p>\n<p>统计信息<br/> <img alt=\"在这里插入图片描述\" src=\"image\\6a5026f687e442429d77273fecdac8e3.png\"/><br/> 按各种方式检索信息<br/> <img alt=\"在这里插入图片描述\" src=\"image\\2508223562e44989a1f0890b9a5979c1.png\"/><br/> 添加管理人员<br/> <img alt=\"在这里插入图片描述\" src=\"image\\6112fb04548046459d45e5bfd52cfb44.png\"/>管理员添加需要管理员权限，添加过程中需要核对该职工人员信息，错误不能设置权限需要重新操作，确认信息则可以添加</p>\n<h2><a id=\"_78\"></a>核心代码展示</h2>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//登陆EnterForm类代码</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EnterForm</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">EnterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         \n            <span class=\"token comment\">//My_Conbobox();        </span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">int</span> admin <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">judgeAdmin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>radioButton1<span class=\"token punctuation\">.</span>Checked <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>radioButton2<span class=\"token punctuation\">.</span>Checked<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请选择管理员登陆或者员工登录！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DialogResult</span> dr <span class=\"token operator\">=</span> MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"是否选择为管理员？\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"登录失败\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>YesNo<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Question<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dr <span class=\"token operator\">==</span> DialogResult<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    radioButton1<span class=\"token punctuation\">.</span>Checked <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>                    \n                    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   \n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    radioButton2<span class=\"token punctuation\">.</span>Checked <span class=\"token operator\">=</span> <span class=\"token keyword\">true</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>           \n        <span class=\"token punctuation\">}</span>      \n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">EnterForm_Load</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            txt_userID<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">;</span>\n            txt_userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"123456\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token comment\">//可注释掉，这是为了方便测试管理员登陆做的初始化</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btEnter_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> user <span class=\"token operator\">=</span> txt_userID<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   \n            <span class=\"token keyword\">string</span> pwd <span class=\"token operator\">=</span> txt_userPwd<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            \n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>String<span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrEmpty</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrEmpty</span><span class=\"token punctuation\">(</span>pwd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名或密码不能为空！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>  <span class=\"token comment\">//到数据库中验证</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token function\">judgeAdmin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">string</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog=Company ;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">string</span> selectSql <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(*) from users where id='\"</span> <span class=\"token operator\">+</span> user <span class=\"token operator\">+</span> <span class=\"token string\">\" ' and pwd='\"</span> <span class=\"token operator\">+</span> pwd <span class=\"token operator\">+</span> <span class=\"token string\">\"'and rights='\"</span> <span class=\"token operator\">+</span> admin <span class=\"token operator\">+</span> <span class=\"token string\">\" ' \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">SqlConnection</span> con <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//创建连接对象 </span>\n                <span class=\"token class-name\">SqlCommand</span> mycom <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>selectSql<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">//定义对象并连接数据库</span>\n\n                <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>selectSql<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//定义对象并连接数据库</span>\n                cmd<span class=\"token punctuation\">.</span>CommandType <span class=\"token operator\">=</span> CommandType<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">;</span>\n\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//打开连接 </span>\n                Console<span class=\"token punctuation\">.</span><span class=\"token function\">WriteLine</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"数据库打开\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    <span class=\"token comment\">//正常打印说明没问题，否则会抛出异常</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt64</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteScalar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> admin<span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//满足用户名与密码一致，进入下一个界面</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\">ManegeForm</span> form <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ManegeForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"管理员登录成功，欢迎您！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    form<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                    \n                    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToInt64</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteScalar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> admin<span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token comment\">//满足用户名与密码一致，进入下一个界面</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token class-name\">StaffForm</span> form <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StaffForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"员工登录成功，欢迎您！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n                    form<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                   \n                    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span> <span class=\"token comment\">//如果登录失败，询问是否注册新用户</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"登录失败！\\n\"</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"用户名或密码错误！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token class-name\">DialogResult</span> dr <span class=\"token operator\">=</span> MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"是否注册新用户？\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"登录失败\"</span><span class=\"token punctuation\">,</span> MessageBoxButtons<span class=\"token punctuation\">.</span>YesNo<span class=\"token punctuation\">,</span> MessageBoxIcon<span class=\"token punctuation\">.</span>Question<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dr <span class=\"token operator\">==</span> DialogResult<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span><span class=\"token comment\">//打开注册界面</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token class-name\">RegisterForm</span> form <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegisterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        form<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n\n                <span class=\"token punctuation\">}</span>\n                con<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//关闭连接 </span>\n\n            <span class=\"token punctuation\">}</span>      \n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btSign_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">RegisterForm</span> register <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegisterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            register<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            \n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btCancel_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"退出成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">comboBox1_SelectedIndexChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>     \n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">radioButton1_CheckedChanged</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>radioButton1<span class=\"token punctuation\">.</span>Checked<span class=\"token punctuation\">)</span>\n                admin <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>radioButton2<span class=\"token punctuation\">.</span>Checked<span class=\"token punctuation\">)</span>\n                admin <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>            \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//修改密码类PwdForm </span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">PwdForm</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">PwdForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btOK_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>        \n           <span class=\"token comment\">/* 假如文本框有空的则提示*/</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>txtName<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> txtOldPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> txtNewPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> txtNewPwdConfirm<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"信息不完整，请确认完整后再提交！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">/*连接数据库字符串*/</span>\n            <span class=\"token keyword\">string</span> str <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">/*创建连接数据库对象*/</span>\n            <span class=\"token class-name\">SqlConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">/*查询密码*/</span>\n            <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select pwd from users where id='\"</span> <span class=\"token operator\">+</span> txtName<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">/*创建操作数据库对象*/</span>\n            <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         \n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">/*创建SqlDataReader对象并执行cmd.ExecuteReader()方法*/</span>\n            <span class=\"token class-name\">SqlDataReader</span> reader <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">/*判断是否有下一条数据并把游标定位在下一条数据*/</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>reader<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">/*txtOldPwd文本框的值是否等于sdr的第一列数据*/</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>txtOldPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> reader<span class=\"token punctuation\">.</span><span class=\"token function\">GetString</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    <span class=\"token comment\">/*判断两次输入的新密码是否一致*/</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>txtNewPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">!=</span> txtNewPwdConfirm<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{<!-- --></span>\n                        MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"两次输入的新密码不一样，请重新输入\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token comment\">/*清空新密码文本框*/</span>\n                        txtNewPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                        txtNewPwdConfirm<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">}</span>\n                    <span class=\"token keyword\">else</span>\n                    <span class=\"token punctuation\">{<!-- --></span>                      \n                        reader<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token comment\">/*更新VipAccount表语句*/</span>\n                        <span class=\"token keyword\">string</span> sqlupdate <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"update users set pwd='{0}' where id='{1}'\"</span><span class=\"token punctuation\">,</span> txtNewPwd<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">,</span>txtName<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                       <span class=\"token comment\">/* 创建操作数据库对象*/</span>\n                        <span class=\"token class-name\">SqlCommand</span> command <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sqlupdate<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token comment\">/*command.ExecuteNonQuery()方法，并判断返回的值是否为0*/</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">{<!-- --></span>\n                            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"未知异常\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">}</span>\n                        <span class=\"token keyword\">else</span>\n                        <span class=\"token punctuation\">{<!-- --></span>\n                            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"密码修改成功\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n                <span class=\"token keyword\">else</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"旧密码错误，或者不能为空\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    txtOldPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    txtNewPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    txtNewPwdConfirm<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>          \n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btCancel_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button2_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            txtOldPwd<span class=\"token punctuation\">.</span>UseSystemPasswordChar <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n            txtNewPwd<span class=\"token punctuation\">.</span>UseSystemPasswordChar <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n            txtNewPwdConfirm<span class=\"token punctuation\">.</span>UseSystemPasswordChar <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//注册账户RegisterForm类</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RegisterForm</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">RegisterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>                   \n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btRegister_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> name <span class=\"token operator\">=</span> userName<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>                      \n            <span class=\"token class-name\">SqlConnection</span> sqlconnection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \n            sqlconnection<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           \n            <span class=\"token class-name\">SqlCommand</span> command <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"select id from users where id='\"</span> <span class=\"token operator\">+</span> name <span class=\"token operator\">+</span> <span class=\"token string\">\"'\"</span><span class=\"token punctuation\">,</span> sqlconnection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>            \n            <span class=\"token class-name\">SqlDataAdapter</span> adapter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>command<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">// 建立SqlDataAdapter和DataSet对象</span>\n            <span class=\"token class-name\">DataSet</span> dataset <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">int</span> n <span class=\"token operator\">=</span> adapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataset<span class=\"token punctuation\">,</span> <span class=\"token string\">\"register\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名已存在！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                userName<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                userPwdCheck<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userName<span class=\"token punctuation\">.</span>TextLength <span class=\"token operator\">&gt;</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名太长，请重新输入！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">!=</span> userPwdCheck<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"两次输入的密码不一致！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                userPwdCheck<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userName<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">||</span> userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"用户名或密码不能为空！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userPwd<span class=\"token punctuation\">.</span>TextLength <span class=\"token operator\">&lt;</span> <span class=\"token number\">6</span> <span class=\"token operator\">||</span> userPwd<span class=\"token punctuation\">.</span>TextLength <span class=\"token operator\">&gt;</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"密码长度不能小于6！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n                userPwdCheck<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">else</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token comment\">// 指定SQL语句</span>\n                command <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommand</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"insert into users(id,pwd) values ('\"</span>\n                    <span class=\"token operator\">+</span> userName<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"','\"</span> <span class=\"token operator\">+</span> userPwd<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">+</span> <span class=\"token string\">\"')\"</span><span class=\"token punctuation\">,</span> sqlconnection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token comment\">// 建立SqlDataAdapter和DataSet对象</span>\n                command<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteNonQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                command <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n                MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"注册成功！\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"提示\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            sqlconnection<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                                \n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">btCancel_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>         \n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"取消成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          \n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">button1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            userPwd<span class=\"token punctuation\">.</span>UseSystemPasswordChar <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>\n            userPwdCheck<span class=\"token punctuation\">.</span>UseSystemPasswordChar <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span><span class=\"token punctuation\">;</span>            \n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//管理员界面ManegeForm类</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">partial</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ManegeForm</span> <span class=\"token punctuation\">:</span> <span class=\"token class-name\">Form</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">ManegeForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token function\">InitializeComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">int</span> wCount <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n        \n        <span class=\"token keyword\">private</span> <span class=\"token class-name\">DataGridViewForm</span> dataViewForm<span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">SqlDataAdapter</span> dataAdapter<span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">DataSet</span> dataSet<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">newDateViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            dataViewForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataGridViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">BringToFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>         \n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 查询信息<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">CheckForm</span> checkForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CheckForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            checkForm<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            checkForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            checkForm<span class=\"token punctuation\">.</span><span class=\"token function\">BringToFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 修改密码<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">PwdForm</span> pwdForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PwdForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pwdForm<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            pwdForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pwdForm<span class=\"token punctuation\">.</span><span class=\"token function\">BringToFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 登录<span class=\"token function\">ToolStripMenuItem1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">EnterForm</span> enterForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EnterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enterForm<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            enterForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enterForm<span class=\"token punctuation\">.</span><span class=\"token function\">BringToFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 注册<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">RegisterForm</span> register <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">RegisterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            register<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            register<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 退出<span class=\"token function\">ToolStripMenuItem1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">EnterForm</span> enterForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EnterForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                     \n            enterForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            enterForm<span class=\"token punctuation\">.</span><span class=\"token function\">BringToFront</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>      \n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 工资信息<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SalaryForm</span> salaryForm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SalaryForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            salaryForm<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            salaryForm<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         \n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 部门管理<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            deptForm dept <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">deptForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dept<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            dept<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 更新<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommandBuilder</span><span class=\"token punctuation\">(</span>dataAdapter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"staff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 更新<span class=\"token function\">ToolStripMenuItem1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommandBuilder</span><span class=\"token punctuation\">(</span>dataAdapter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"salary\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 更新<span class=\"token function\">ToolStripMenuItem2_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommandBuilder</span><span class=\"token punctuation\">(</span>dataAdapter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"department\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 更新<span class=\"token function\">ToolStripMenuItem3_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SqlCommandBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlCommandBuilder</span><span class=\"token punctuation\">(</span>dataAdapter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"attendancesheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 退出系统<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>         \n            Application<span class=\"token punctuation\">.</span><span class=\"token function\">Exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            MessageBox<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"已退出系统！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 显示<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> connection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from staff \"</span><span class=\"token punctuation\">;</span>\n            dataAdapter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> connection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataSet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"staff\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">newDateViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">dataView</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 显示<span class=\"token function\">ToolStripMenuItem1_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> connection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from salary \"</span><span class=\"token punctuation\">;</span>\n            dataAdapter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> connection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataSet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"salary\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">newDateViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">dataView</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 显示<span class=\"token function\">ToolStripMenuItem2_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> connection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from department \"</span><span class=\"token punctuation\">;</span>\n            dataAdapter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> connection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataSet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"department\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">newDateViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">dataView</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 显示<span class=\"token function\">ToolStripMenuItem3_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">string</span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source= 你的电脑 ;Initial Catalog= Company;Integrated Security= True\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> connection <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">string</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from attendancesheet \"</span><span class=\"token punctuation\">;</span>\n            dataAdapter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> connection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataSet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataAdapter<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">,</span> <span class=\"token string\">\"attendancesheet\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">newDateViewForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataViewForm<span class=\"token punctuation\">.</span><span class=\"token function\">dataView</span><span class=\"token punctuation\">(</span>dataSet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 设置管理<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">SetAdminForm</span> setAdmin <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SetAdminForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            setAdmin<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            setAdmin<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 查询<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">FindStaffForm</span> findStaff <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FindStaffForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            findStaff<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            findStaff<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 统计分析<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">StatisticsForm</span> statistics <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StatisticsForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            statistics<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            statistics<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 查看工资<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">FindsalaryForm</span> findsalary  <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span>  <span class=\"token class-name\">FindsalaryForm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            findsalary<span class=\"token punctuation\">.</span>MdiParent <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n            findsalary<span class=\"token punctuation\">.</span><span class=\"token function\">Show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> 登录<span class=\"token function\">ToolStripMenuItem_Click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">object</span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"_526\"></a>源文件下载</h2>\n<p>源代码内容太长，如需完整代码请自行下载查阅<br/> <a href=\"https://pan.baidu.com/s/1f4FSpSNiSaj1U7cNpLNYpQ\">下载地址</a><br/> 链接：https://pan.baidu.com/s/1f4FSpSNiSaj1U7cNpLNYpQ<br/> 提取码：1234</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}