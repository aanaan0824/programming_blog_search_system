{"blogid": "126737583", "writerAge": "ç é¾„10å¹´", "writerBlogNum": "194", "writerCollect": "29331", "writerComment": "9549", "writerFan": "59353", "writerGrade": "8çº§", "writerIntegral": "39536", "writerName": "å°å°æ˜-ä»£ç å®ä½“", "writerProfileAdress": "writer_image\\profile_126737583.jpg", "writerRankTotal": "101", "writerRankWeekly": "196", "writerThumb": "20407", "writerVisitNum": "6705117", "blog_read_count": "809", "blog_time": "å·²äºÂ 2022-09-07 14:34:45Â ä¿®æ”¹", "blog_title": "ä»¥æ·±åœ³ä¸ºä¾‹Pythonä¸€é”®ç”Ÿæˆæ ¸é…¸æ£€æµ‹æ—¥å†", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>ğŸ“¢ä½œè€…ï¼š <strong>å°å°æ˜-ä»£ç å®ä½“</strong></p>\n<p>ğŸ“¢åšå®¢ä¸»é¡µï¼š<a href=\"https://blog.csdn.net/as604049322\">https://blog.csdn.net/as604049322</a></p>\n<p>ğŸ“¢æ¬¢è¿ç‚¹èµ ğŸ‘ æ”¶è— â­ç•™è¨€ ğŸ“ æ¬¢è¿è®¨è®ºï¼</p>\n</blockquote>\n<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°å°æ˜ã€‚é‰´äºæ·±åœ³æœ€è¿‘æ¯å¤©éƒ½è¦åšæ ¸é…¸ï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦ç”¨ç¨‹åºç”Ÿæˆè‡ªå·±çš„æ£€æµ‹æ—¥å†ï¼Œæ–¹ä¾¿æŸ¥çœ‹ã€‚</p>\n<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä»<code>æ·±iæ‚¨-è‡ªä¸»ç”³æŠ¥</code>çš„å¾®ä¿¡å°ç¨‹åºä¸­æå–è‡ªå·±çš„æ ¸é…¸æ£€æµ‹è®°å½•ï¼Œç„¶åä½¿ç”¨ç»˜å›¾åº“è‡ªåŠ¨ç»˜åˆ¶æ£€æµ‹æ—¥å†ã€‚</p>\n<h1><a id=\"UI_11\"></a>UIè‡ªåŠ¨åŒ–æå–æ£€æµ‹è®°å½•</h1>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨PCç«¯å¾®ä¿¡æ‰“å¼€<code>æ·±iæ‚¨-è‡ªä¸»ç”³æŠ¥</code>å¾®ä¿¡å°ç¨‹åºï¼š</p>\n<p><img alt=\"image-20220907004822465\" src=\"image\\05eace95029e3c615ce060ed184630f7.png\"/></p>\n<p>ç‚¹å‡» æ ¸é…¸æ£€æµ‹è®°å½•ï¼Œå†ç‚¹å‡»è‡ªå·±çš„å§“åå³å¯æŸ¥çœ‹è‡ªå·±çš„æ ¸é…¸æ£€æµ‹è®°å½•ï¼š</p>\n<p><img alt=\"image-20220907004955288\" src=\"image\\8a68b3fdbf5e85248ad5efd8f288c3d3.png\"/></p>\n<p>ä¸‹é¢æˆ‘ä»¬æ‰“å¼€<code>inspect.exe</code>å·¥å…·åˆ†ææŸ¥çœ‹èŠ‚ç‚¹ï¼š</p>\n<p><img alt=\"image-20220907005130425\" src=\"image\\a2526b6a4399fad756dd0a1d538149e6.png\"/></p>\n<p>äºæ˜¯å¼€å§‹ç¼–ç ï¼š</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> uiautomation <span class=\"token keyword\">as</span> auto\n\npane <span class=\"token operator\">=</span> auto<span class=\"token punctuation\">.</span>PaneControl<span class=\"token punctuation\">(</span>searchDepth<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> Name<span class=\"token operator\">=</span><span class=\"token string\">\"æ·±iæ‚¨ - è‡ªä¸»ç”³æŠ¥\"</span><span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetActive<span class=\"token punctuation\">(</span>waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetTopmost<span class=\"token punctuation\">(</span>waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\n\ntags <span class=\"token operator\">=</span> pane<span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>GetLastChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>GetChildren<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nresult <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> tag <span class=\"token keyword\">in</span> tags<span class=\"token punctuation\">:</span>\n    tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> item<span class=\"token punctuation\">,</span> depth <span class=\"token keyword\">in</span> auto<span class=\"token punctuation\">.</span>WalkControl<span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> maxDepth<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> item<span class=\"token punctuation\">.</span>ControlType <span class=\"token operator\">!=</span> auto<span class=\"token punctuation\">.</span>ControlType<span class=\"token punctuation\">.</span>TextControl<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">continue</span>\n        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n    row <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"æ£€æµ‹ç»“æœ\"</span><span class=\"token punctuation\">:</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        row<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v\n    result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetTopmost<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>é‡‡æ ·æ—¶é—´ <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>é‡‡æ ·æ—¶é—´<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>æ£€æµ‹æ—¶é—´ <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>æ£€æµ‹æ—¶é—´<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>ç»“æœå¦‚ä¸‹ï¼š</p>\n<p><img alt=\"image-20220907005308295\" src=\"image\\49269dcf2a28b5e154b028bfcc5bc469.png\"/></p>\n<p>æœ‰äº†æ£€æµ‹æ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆæ£€æµ‹æ—¥å†äº†ã€‚ä¹Ÿå¯ä»¥å…ˆå°†æ£€æµ‹æ•°æ®ä¿å­˜èµ·æ¥ï¼š</p>\n<pre><code class=\"prism language-python\">df<span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>pd<span class=\"token punctuation\">.</span>Timestamp<span class=\"token punctuation\">(</span><span class=\"token string\">'now'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">æ ¸é…¸æ£€æµ‹è®°å½•.xlsx\"</span></span><span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<blockquote>\n<p>æ³¨æ„ï¼šå…¶ä»–çœå¸‚çš„ç«¥é‹ï¼Œè¯·æ ¹æ®è‡ªå·±åŸå¸‚å¯¹åº”çš„å°ç¨‹åºå®é™…æƒ…å†µç¼–å†™ä»£ç è¿›è¡Œæå–ã€‚</p>\n<p>åŸæœ¬æƒ³æŠ“åŒ…è·å–æ£€æµ‹æ•°æ®ï¼Œå´å‘ç°æ–°ç‰ˆçš„PCç«¯å¾®ä¿¡çš„å°ç¨‹åºå·²ç»æ— æ³•è¢«æŠ“åŒ…ï¼Œæš‚æ—¶è¿˜æœªç†è§£å•¥åŸç†å•¥å®ç°çš„ã€‚</p>\n</blockquote>\n<p>åé¢ç¢°åˆ°æ­£åœ¨æ£€æµ‹çš„è®°å½•ä¸Šé¢çš„ä»£ç ä¼šæŠ¥é”™ï¼Œåˆ†æèŠ‚ç‚¹åï¼Œä¸‹é¢å‡çº§åˆ°èƒ½å¤Ÿå…¼å®¹å‡ºç°æ£€æµ‹è®°å½•çš„æƒ…å†µï¼š</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> uiautomation <span class=\"token keyword\">as</span> auto\n\npane <span class=\"token operator\">=</span> auto<span class=\"token punctuation\">.</span>PaneControl<span class=\"token punctuation\">(</span>searchDepth<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> Name<span class=\"token operator\">=</span><span class=\"token string\">\"æ·±iæ‚¨ - è‡ªä¸»ç”³æŠ¥\"</span><span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetActive<span class=\"token punctuation\">(</span>waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetTopmost<span class=\"token punctuation\">(</span>waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\n\ntag <span class=\"token operator\">=</span> pane<span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \\\n    <span class=\"token punctuation\">.</span>GetLastChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ntmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> item<span class=\"token punctuation\">,</span> depth <span class=\"token keyword\">in</span> auto<span class=\"token punctuation\">.</span>WalkControl<span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> maxDepth<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> item<span class=\"token punctuation\">.</span>ControlType <span class=\"token operator\">!=</span> auto<span class=\"token punctuation\">.</span>ControlType<span class=\"token punctuation\">.</span>TextControl<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">continue</span>\n    tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\nresult <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\ntags <span class=\"token operator\">=</span> tag<span class=\"token punctuation\">.</span>GetChildren<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> tmp<span class=\"token punctuation\">:</span>\n    row <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"æ£€æµ‹ç»“æœ\"</span><span class=\"token punctuation\">:</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        row<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v\n    result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> tag <span class=\"token keyword\">in</span> tags<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> tag<span class=\"token punctuation\">.</span>Name <span class=\"token keyword\">or</span> tag<span class=\"token punctuation\">.</span>GetFirstChildControl<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">continue</span>\n    tmp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> item<span class=\"token punctuation\">,</span> depth <span class=\"token keyword\">in</span> auto<span class=\"token punctuation\">.</span>WalkControl<span class=\"token punctuation\">(</span>tag<span class=\"token punctuation\">,</span> maxDepth<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> item<span class=\"token punctuation\">.</span>ControlType <span class=\"token operator\">!=</span> auto<span class=\"token punctuation\">.</span>ControlType<span class=\"token punctuation\">.</span>TextControl<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">continue</span>\n        tmp<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">)</span>\n    row <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"æ£€æµ‹ç»“æœ\"</span><span class=\"token punctuation\">:</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> k<span class=\"token punctuation\">,</span> v <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>tmp<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> tmp<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        row<span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v\n    result<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span>\npane<span class=\"token punctuation\">.</span>SetTopmost<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> waitTime<span class=\"token operator\">=</span><span class=\"token number\">0.01</span><span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>é‡‡æ ·æ—¶é—´ <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>é‡‡æ ·æ—¶é—´<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>æ£€æµ‹æ—¶é—´ <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>æ£€æµ‹æ—¶é—´<span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"image-20220907142944133\" src=\"image\\8c9ce4f9f9af834ac127da5a17ca1869.png\"/></p>\n<h1><a id=\"_115\"></a>ç”Ÿæˆæ ¸é…¸æ£€æµ‹æ—¥å†</h1>\n<p>ç»è¿‡å‡ å°æ—¶çš„æµ‹è¯•ï¼Œæœ€ç»ˆç¼–å†™å‡ºå¦‚ä¸‹æ–¹æ³•ï¼š</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> calendar\n<span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image<span class=\"token punctuation\">,</span> ImageFont<span class=\"token punctuation\">,</span> ImageDraw\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">create_calendar_img</span><span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> month<span class=\"token punctuation\">,</span> days<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">\"ä½œè€…ï¼šå°å°æ˜ https://xxmdmst.blog.csdn.net\"</span>\n    font <span class=\"token operator\">=</span> ImageFont<span class=\"token punctuation\">.</span>truetype<span class=\"token punctuation\">(</span><span class=\"token string\">'msyh.ttc'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span>\n    im <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span>mode<span class=\"token operator\">=</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">505</span><span class=\"token punctuation\">,</span> <span class=\"token number\">251</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span><span class=\"token punctuation\">)</span>\n    draw <span class=\"token operator\">=</span> ImageDraw<span class=\"token punctuation\">.</span>Draw<span class=\"token punctuation\">(</span>im<span class=\"token operator\">=</span>im<span class=\"token punctuation\">)</span>\n    draw<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">504</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token string\">'#418CFA'</span><span class=\"token punctuation\">,</span> outline<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    draw<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>xy<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">170</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>year<span class=\"token punctuation\">}</span></span><span class=\"token string\">å¹´</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>month<span class=\"token punctuation\">}</span></span><span class=\"token string\">æœˆ\"</span></span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n              font<span class=\"token operator\">=</span>ImageFont<span class=\"token punctuation\">.</span>truetype<span class=\"token punctuation\">(</span><span class=\"token string\">'msyh.ttc'</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    title_datas <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'æ˜ŸæœŸä¸€'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸäºŒ'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸä¸‰'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸå››'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸäº”'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸå…­'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'æ˜ŸæœŸæ—¥'</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> title_data <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>title_datas<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        draw<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                       fill<span class=\"token operator\">=</span><span class=\"token string\">'lightblue'</span><span class=\"token punctuation\">,</span> outline<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        draw<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>xy<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token operator\">+</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span>title_data<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                  font<span class=\"token operator\">=</span>font<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ å’Œä¸€ä¸ªæœˆçš„å¤©æ•°</span>\n    weekday<span class=\"token punctuation\">,</span> day_num <span class=\"token operator\">=</span> calendar<span class=\"token punctuation\">.</span>monthrange<span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> month<span class=\"token punctuation\">)</span>\n    col<span class=\"token punctuation\">,</span> row <span class=\"token operator\">=</span> weekday<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> day_num<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> col <span class=\"token operator\">&gt;=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">:</span>\n            col <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n            row <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        fill <span class=\"token operator\">=</span> <span class=\"token string\">\"#009B3C\"</span> <span class=\"token keyword\">if</span> i <span class=\"token keyword\">in</span> days <span class=\"token keyword\">else</span> <span class=\"token boolean\">None</span>\n        draw<span class=\"token punctuation\">.</span>rectangle<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>col<span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token number\">30</span><span class=\"token operator\">*</span>row<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>col<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token number\">30</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>row<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                       fill<span class=\"token operator\">=</span>fill<span class=\"token punctuation\">,</span> outline<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        draw<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span>xy<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>col<span class=\"token operator\">*</span><span class=\"token number\">72</span><span class=\"token operator\">+</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token operator\">+</span><span class=\"token number\">30</span><span class=\"token operator\">*</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>zfill<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                  font<span class=\"token operator\">=</span>font<span class=\"token punctuation\">)</span>\n        col <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">return</span> im\n</code></pre>\n<p>ç„¶åæˆ‘ä»¬å¯ä»¥ç”Ÿæˆæœ€è¿‘1-3ä¸ªæœˆçš„æ ¸é…¸æ£€æµ‹æ—¥å†ï¼š</p>\n<pre><code class=\"prism language-python\">dates <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>é‡‡æ ·æ—¶é—´<span class=\"token punctuation\">.</span>dt<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">.</span>sort_values<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> month<span class=\"token punctuation\">,</span> date_split <span class=\"token keyword\">in</span> dates<span class=\"token punctuation\">.</span>groupby<span class=\"token punctuation\">(</span>dates<span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    year<span class=\"token punctuation\">,</span> month <span class=\"token operator\">=</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> month<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"-\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    days <span class=\"token operator\">=</span> date_split<span class=\"token punctuation\">.</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>astype<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n    im <span class=\"token operator\">=</span> create_calendar_img<span class=\"token punctuation\">(</span>year<span class=\"token punctuation\">,</span> month<span class=\"token punctuation\">,</span> days<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">)</span>\n    display<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"image-20220907010248874\" src=\"image\\fc297b502912e32485b934ae11a88008.png\"/></p>\n<p>å¯ä»¥çœ‹åˆ°æˆ‘æœ€è¿‘è¿ç»­9å¤©éƒ½æ˜¯æ¯å¤©åšä¸€æ¬¡æ ¸é…¸ã€‚</p>\n<p>å¦‚æœæœ‰éœ€è¦ï¼Œè¿™äº›å›¾ç‰‡ä¹Ÿå¯ä»¥æŒ‰éœ€ä¿å­˜ï¼š</p>\n<pre><code class=\"prism language-python\">im<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>year<span class=\"token punctuation\">}</span></span><span class=\"token string\">å¹´</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>month<span class=\"token punctuation\">}</span></span><span class=\"token string\">æœˆæ£€æµ‹è®°å½•.jpg\"</span></span><span class=\"token punctuation\">)</span>\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}