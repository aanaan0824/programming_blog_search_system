{"blogid": "121978197", "writerAge": "码龄4年", "writerBlogNum": "9", "writerCollect": "30", "writerComment": "5", "writerFan": "7", "writerGrade": "2级", "writerIntegral": "108", "writerName": "YoungPn", "writerProfileAdress": "writer_image\\profile_121978197.jpg", "writerRankTotal": "254406", "writerRankWeekly": "973856", "writerThumb": "8", "writerVisitNum": "5117", "blog_read_count": "2123", "blog_time": "于 2021-12-16 20:25:47 发布", "blog_title": "C#调用interface与fanuc机器人通信", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>由于项目需要利用C#做上位机与FANUC机器人进行通讯，用的是fanuc的interface。网上相关资料比较少，摸索之后整理出这篇文章并测试通过，希望对大家有所帮助。</p>\n<p>注意要用interface实现与fanuc机器人的通信，需要机器人已购买该功能。</p>\n<p>自己实现的demo、参考的文档和案例、interface软件可在此下载：<br/> <a href=\"https://download.csdn.net/download/pnyee/64847744\">下载地址</a></p>\n<h2><a id=\"dll_6\"></a>一：准备dll文件</h2>\n<p>安装fanuc的interface软件，在安装目录下找到<mark>FRRJIF.dll</mark>文件。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\67c9a0d9ce9a4d38b72a1b6b8e5dfac6.png\"/></p>\n<h2><a id=\"C_9\"></a>二：C#中引用</h2>\n<p>在自己的C#项目中添加引用，将上述的DLL文件添加进来。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\2d1f64cb1ae049fa8efecc97abd67853.png\"/><br/> 添加完成之后，在 对象浏览器中可以 看到刚刚添加的DLL</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\e1504b8a87b34a188064d69c6b859789.png\"/></p>\n<h2><a id=\"DLL_15\"></a>三：DLL怎么用</h2>\n<blockquote>\n<p>这方面搜集到的资料不多，有用的包括一个英文版的interface文档和一个别人的案例，经过自己研究，目前可以完成自己的需求，下面的步骤也是基于我自己的研究和理解所写，如果有误请指出。</p>\n</blockquote>\n<p>下面这幅图是文档中的读写数据的流程图（文档第二页），自己在写代码的时候也要按照图中的步骤来，否则会出现问题。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\d5d1b21ff7f0439292cf83a8b4fdd39d.png\"/></p>\n<h3><a id=\"1_21\"></a>（1）定义变量</h3>\n<p>首先定义一些变量，方便使用，这里基本涵盖了我们能用到的功能</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>Core</span> mobjCore<span class=\"token punctuation\">;</span><span class=\"token comment\">//</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTable</span> mobjDataTable<span class=\"token punctuation\">;</span><span class=\"token comment\">//数据表</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTable</span> mobjDataTable2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataCurPos</span> mobjCurPos<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataCurPos</span> mobjCurPosUF<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataCurPos</span> mobjCurPos2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTask</span> mobjTask<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTask</span> mobjTaskIgnoreMacro<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTask</span> mobjTaskIgnoreKarel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTask</span> mobjTaskIgnoreMacroKarel<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataPosReg</span> mobjPosReg<span class=\"token punctuation\">;</span><span class=\"token comment\">//PR寄存器</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataPosReg</span> mobjPosReg2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataPosRegXyzwpr</span> mobjPosRegXyzwpr<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataPosRegMG</span> mobjPosRegMG<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjSysVarInt<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjSysVarInt2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjSysVarReal<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjSysVarReal2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjSysVarString<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVarPos</span> mobjSysVarPos<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> mobjSysVarIntArray<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataNumReg</span> mobjNumReg<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataNumReg</span> mobjNumReg2<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataNumReg</span> mobjNumReg3<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataAlarm</span> mobjAlarm<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataAlarm</span> mobjAlarmCurrent<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataSysVar</span> mobjVarString<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataString</span> mobjStrReg<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">static</span> <span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataString</span> mobjStrRegComment<span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"2CORE_55\"></a>（2）创建CORE对象</h3>\n<pre><code class=\"prism language-csharp\"><span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>Core</span> mobjCore <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">FRRJIf<span class=\"token punctuation\">.</span>Core</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h3><a id=\"3_DATATABLE_60\"></a>（3）创建 DATATABLE</h3>\n<p>一定要先创建datatable，后面的操作很多都是通过这个表进行的，文档中（第六页）也说了连接前先创建表。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\9eae6f103e014bd3856a22e369b4953b.png\"/></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token class-name\">FRRJIf<span class=\"token punctuation\">.</span>DataTable</span> mobjDataTable <span class=\"token operator\">=</span> mobjCore<span class=\"token punctuation\">.</span>DataTable<span class=\"token punctuation\">;</span>\n\n<span class=\"token punctuation\">{<!-- --></span>\n    mobjAlarm <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddAlarm</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>ALARM_LIST<span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjAlarmCurrent <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddAlarm</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>ALARM_CURRENT<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjCurPos <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddCurPos</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>CURPOS<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjCurPosUF <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddCurPosUF</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>CURPOS<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjCurPos2 <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddCurPos</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>CURPOS<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjTask <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddTask</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>TASK<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjTaskIgnoreMacro <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddTask</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>TASK_IGNORE_MACRO<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjTaskIgnoreKarel <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddTask</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>TASK_IGNORE_KAREL<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjTaskIgnoreMacroKarel <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddTask</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>TASK_IGNORE_MACRO_KAREL<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//定义PR</span>\n    mobjPosReg <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddPosReg</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>POSREG<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    mobjPosReg2 <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddPosReg</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>POSREG<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarInt <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_INT<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$FAST_CLOCK\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarInt2 <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_INT<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$TIMER[10].$TIMER_VAL\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarReal <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_REAL<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$MOR_GRP[1].$CURRENT_ANG[1]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarReal2 <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_REAL<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$DUTY_TEMP\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarString <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_STRING<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$TIMER[10].$COMMENT\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjSysVarPos <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVarPos</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_POS<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$MNUTOOL[1,1]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjVarString <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddSysVar</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>SYSVAR_STRING<span class=\"token punctuation\">,</span> <span class=\"token string\">\"$[HTTPKCL]CMDS[1]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjNumReg <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumReg</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>NUMREG_INT<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjNumReg2 <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumReg</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>NUMREG_REAL<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjPosRegXyzwpr <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddPosRegXyzwpr</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>POSREG_XYZWPR<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjPosRegMG <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddPosRegMG</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>POSREGMG<span class=\"token punctuation\">,</span> <span class=\"token string\">\"C,J6\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjStrReg <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddString</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>STRREG<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    mobjStrRegComment <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddString</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>STRREG_COMMENT<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   \n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>valid（）函数可查看datatable中添加的方法是否生效。</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//是否有效</span>\n<span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> aa <span class=\"token operator\">=</span> mobjPosReg<span class=\"token punctuation\">.</span>Valid<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>关于datatable中各个方法的具体使用方法可自行在文档中查阅，都大同小异，本文以读写PR寄存器为例进行介绍。<br/> 通过<mark>mobjPosReg</mark>可以读写PR寄存器。</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//定义PR</span>\nmobjPosReg <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">AddPosReg</span><span class=\"token punctuation\">(</span>FRRJIf<span class=\"token punctuation\">.</span>FRIF_DATA_TYPE<span class=\"token punctuation\">.</span>POSREG<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\aeaaabdc4ad0412fa7c4379184292211.png\"/><br/> 第一个参数是数据类型，第二个参数是 组号，我也没明白什么意思，这两个固定写就行，第三和第四个参数就是需要读的寄存器的开始和结束索引，比如你要读写PR[1]到PR[15]这几个寄存器，就写成1和15。</p>\n<h3><a id=\"4_113\"></a>（4）连接机器人</h3>\n<p>输入机器人的IP地址（在示教器中可查看）</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//连接</span>\n<span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> res <span class=\"token operator\">=</span>mobjCore<span class=\"token punctuation\">.</span><span class=\"token function\">Connect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"172.16.1.1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>网线连接机器人和PC，修改PCIP地址<br/> <img alt=\"在这里插入图片描述\" src=\"image\\9d2e22bb7643429e957347437535f4da.png\"/><br/> 测试是否通讯成功，通讯成功会返回 true</p>\n<h3><a id=\"5PR_122\"></a>（5）读写PR寄存器</h3>\n<p><mark>操作前一定先更新datatable，否则会失败。</mark></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//使用前先刷新</span>\n<span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> blnDT <span class=\"token operator\">=</span> mobjDataTable<span class=\"token punctuation\">.</span><span class=\"token function\">Refresh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>接下来就可以读写寄存器了，不同类型的寄存器的读写略有不同，文档中都有说明。<br/> 用mobjPosReg进行PR寄存器的读写操作。<br/> 在读写之前，需要先定义一下一些需要的参数，</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token class-name\">Array</span> xyzwpr <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">float</span></span><span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Array</span> config <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">short</span></span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Array</span> joint <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">float</span></span><span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">short</span></span> intUF <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">short</span></span> intUT <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">short</span></span> intValidC <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">short</span></span> intValidJ <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>xyzwpr不用多说，其他参数文档13、14页有对这些参数的详细解释，<br/> <strong>读PR寄存器：</strong><br/> 这里以读PR[6]为例，想要读其他寄存器更改第一个参数即可，需要注意的是这个数值只能介于中（3）中定义的索引之间，比如上文我定义的是1-15，那么这里我可以读写1-15之间的寄存器。</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> res_r <span class=\"token operator\">=</span>  mobjPosReg<span class=\"token punctuation\">.</span><span class=\"token function\">GetValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> xyzwpr<span class=\"token punctuation\">,</span><span class=\"token keyword\">ref</span> config<span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> joint<span class=\"token punctuation\">,</span><span class=\"token keyword\">ref</span>  intUF<span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> intUT<span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> intValidC<span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> intValidJ<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p><mark>这里要注意ref不要忘记加，否则虽然可以返回true，但是不能成功接收到值。</mark></p>\n<p><strong>写PR寄存器：</strong></p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//写PR11</span>\n<span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> res_w <span class=\"token operator\">=</span> mobjPosReg<span class=\"token punctuation\">.</span><span class=\"token function\">SetValueXyzwpr</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> xyzwpr<span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> config<span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>也没什么好说的，</p>\n<h3><a id=\"6IO_156\"></a>（6）读写I/O</h3>\n<p>读写IO应该不用datatable，用Core就可以。</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token comment\">//读取SDI</span>\n<span class=\"token class-name\">Array</span> intSDI <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\"><span class=\"token keyword\">short</span></span><span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> blnSDI <span class=\"token operator\">=</span> mobjCore<span class=\"token punctuation\">.</span><span class=\"token function\">ReadSDI</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> intSDI<span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>其他的也都大同小异</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}