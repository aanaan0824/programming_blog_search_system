{"blogid": "124998565", "writerAge": "码龄2年", "writerBlogNum": "2", "writerCollect": "18", "writerComment": "11", "writerFan": "2", "writerGrade": "1级", "writerIntegral": "37", "writerName": "barelank", "writerProfileAdress": "writer_image\\profile_124998565.jpg", "writerRankTotal": "170604", "writerRankWeekly": "1074890", "writerThumb": "5", "writerVisitNum": "1925", "blog_read_count": "1110", "blog_time": "已于 2022-07-26 09:28:11 修改", "blog_title": "C# chart画折线", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>提示：文章写完后，目录可以自动生成，如何生成可参考右边的帮助文档</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#DataGridView__Chart_8\">一、版本一（DataGridView 和 Chart）</a></li><li><ul><li><a href=\"#1_9\">1.小目标</a></li><li><a href=\"#2_15\">2.过程实现</a></li><li><a href=\"#3_91\">3.结果</a></li></ul>\n</li><li><a href=\"#Combobox__Chart_109\">二、版本二（Combobox 和 Chart）</a></li><li><ul><li><a href=\"#1_110\">1.小目标</a></li><li><a href=\"#2_115\">2.过程实现</a></li><li><a href=\"#3_394\">3.浅贴一下效果</a></li></ul>\n</li><li><a href=\"#__403\">算是完结了吧 ，有问题一起交流鸭</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<h1><a id=\"DataGridView__Chart_8\"></a>一、版本一（DataGridView 和 Chart）</h1>\n<h2><a id=\"1_9\"></a>1.小目标</h2>\n<ol><li> <p>控件绑定Sql Sever 数据库</p> </li><li> <p>DataGridView列出数据，Chart画折线</p> </li></ol>\n<h2><a id=\"2_15\"></a>2.过程实现</h2>\n<ul><li> <p>chart的初始设置（个人习惯）</p>\n<ul><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>1.图列关掉（属性&gt;Legends&gt;(Endable)=False&gt;确定）</strong><img alt=\"在这里插入图片描述\" src=\"image\\03dccd447faa498083e9e1e3bf70a129.png\"/></p> </li><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>2.去网格X轴（属性&gt;ChartAreas&gt;Axes&gt;X axis&gt;MajorGrid&gt;Enanled=False）</strong><img alt=\"在这里插入图片描述\" src=\"image\\19d6e178f2ca46379fb41c9ac69c44b4.png\"/></p> </li><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>3.去网格Y轴（X轴设置好，直接按Y(Value) axis&gt;MajorGrid&gt;Enanled=False&gt;确定）</strong><img alt=\"在这里插入图片描述\" src=\"image\\fb2b141d7c8a49e8b8555a8355f2c253.png\"/></p> </li><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>4.柱状图变为折线（属性&gt;Series&gt;ChartType&gt;Line&gt;确定）</strong><img alt=\"在这里插入图片描述\" src=\"image\\86b871e5002f4fd29dd7da6feca3e7c6.png\"/></p> </li><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>5.铺满上半页面（属性&gt;Dock&gt;top）</strong><img alt=\"在这里插入图片描述\" src=\"image\\a9ba1d47dbd748a9995fb2c7fc759470.png\"/></p> </li></ul> </li><li> <p>DataGridView的初始设置（个人习惯）</p>\n<ul><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>1.放左边方便查看数据（属性&gt;Dock&gt;Left）</strong><img alt=\"在这里插入图片描述\" src=\"image\\40414fd9eee044c1bfeddc8dbc59105b.png\"/></p> </li><li class=\"task-list-item\"> <p><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <strong>2.数据设置（编辑列，按图顺序添加列名和绑定数据，完成后确定）</strong><img alt=\"在这里插入图片描述\" src=\"image\\75acb7d6add340e69fa5c3977a74ddcf.png\"/><br/> <strong>添加两个列名</strong><img alt=\"在这里插入图片描述\" src=\"image\\c09db83ad5e14a0bb3bbf712f9e37ccb.png\"/></p> </li></ul> </li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\593fc6f151874c54a3ac58b15a3ff194.png\"/><br/> <strong>数据绑定</strong><br/> <img alt=\"在这里插入图片描述\" src=\"image\\d301b3facc8f4ef68c5c0a6d63329d22.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\c55742b745614a1f8c26fe86db6cdfdc.png\"/></p>\n<ul><li>具体代码（在窗体加载事件里写）</li></ul>\n<p>1.创建SqlHelper类</p>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SqlHelper</span>\n    <span class=\"token punctuation\">{<!-- --></span> \n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">DataTable</span> <span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">DataTable</span> dataTable <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=.;Initial Catalog = Line;User ID = sa;Password=abcdef\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cmd<span class=\"token punctuation\">.</span>Parameters<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlDataAdapter</span> da <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            da<span class=\"token punctuation\">.</span>SelectCommand <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            da<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataTable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> dataTable<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>2.窗体代码</p>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> Sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//DataGridView绑定</span>\n            <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span>Sql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            dataGridView1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//画图</span>\n            <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span>dt<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span>i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>Points<span class=\"token punctuation\">.</span><span class=\"token function\">AddXY</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>dt<span class=\"token punctuation\">.</span>Rows<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token comment\">//设置Y轴范围（属性&gt;ChartArea&gt;Axes&gt;Y(Value)axis&gt;Maximum和Minimun里也能设置）</span>\n            chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> <span class=\"token number\">27.5</span><span class=\"token punctuation\">;</span>\n            chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> <span class=\"token number\">31.5</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//粗细（属性中也能设置）</span>\n            chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>BorderWidth <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"3_91\"></a>3.结果</h2>\n<ul><li>读取到了数据库中的数据，显示在表格中</li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\c7b60b12d8cf46a4bbbf0bb7f011c193.png\"/></p>\n<ul><li>下一步是画出折线</li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\8d931257a96246c3916ca98923edbd6d.png\"/></p>\n<ul><li>做一下改善，将线变粗，设置了Y轴上下限</li><li>X轴还可以在属性中做更一步设置，让折线从1开始</li><li>空白部分还能发挥空间，添加一些标签和文本，做些数据统计</li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\5366075ce68840ef806e71982673e3b1.png\"/></p>\n<h1><a id=\"Combobox__Chart_109\"></a>二、版本二（Combobox 和 Chart）</h1>\n<h2><a id=\"1_110\"></a>1.小目标</h2>\n<ol><li>Combobox选择不同的值，Chart显示相对应的折线</li><li>在Chart中显示具体数据、Y轴上下限随数值变化，添加三条辅助线，分别代表数据中的最大值，最小值和标准值</li></ol>\n<h2><a id=\"2_115\"></a>2.过程实现</h2>\n<ul><li>界面设置<br/> 与前一部分设置相同，主要是只想呈现X轴和Y轴<br/> combobox属性中(Name)改为cbbMidLine<br/> 放一些标签和文本，分别改(Name)为textAvg,textMAX,textMIN,textCount</li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\4b11e085c41b42839b1d7846fa530ccf.png\"/></p>\n<ul><li>SqlHelper类</li></ul>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SqlHelper</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">DataTable</span> <span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">DataTable</span> dataTable <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">DataTable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=.;Initial Catalog = Line;User ID = sa;Password=abcdef\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cmd<span class=\"token punctuation\">.</span>Parameters<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlDataAdapter</span> da <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlDataAdapter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            da<span class=\"token punctuation\">.</span>SelectCommand <span class=\"token operator\">=</span> cmd<span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             da<span class=\"token punctuation\">.</span><span class=\"token function\">Fill</span><span class=\"token punctuation\">(</span>dataTable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> dataTable<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">double</span></span> <span class=\"token function\">Count</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> result <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=.;Initial Catalog = Line;User ID = sa;Password=cacl0575\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cmd<span class=\"token punctuation\">.</span>Parameters<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            result <span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToDouble</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteScalar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\3bd3b1d046f04f85a15146f6e28cd6b7.png\"/></p>\n<ul><li>Line类</li></ul>\n<pre><code class=\"prism language-csharp\"> <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span>  <span class=\"token keyword\">class</span> <span class=\"token class-name\">Line</span>\n    <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">StripLine</span> <span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sql<span class=\"token punctuation\">,</span><span class=\"token class-name\"><span class=\"token keyword\">double</span></span> stripWidth<span class=\"token punctuation\">,</span><span class=\"token class-name\">Color</span> color<span class=\"token punctuation\">,</span><span class=\"token keyword\">out</span> <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Line<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> connString <span class=\"token operator\">=</span> <span class=\"token string\">\"Data Source=.;Initial Catalog = Line;User ID = sa;Password=cacl0575\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlConnection</span><span class=\"token punctuation\">(</span>connString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">SqlCommand</span> cmd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">SqlCommand</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cmd<span class=\"token punctuation\">.</span>Parameters<span class=\"token punctuation\">.</span><span class=\"token function\">Clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            conn<span class=\"token punctuation\">.</span><span class=\"token function\">Open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n             Line<span class=\"token operator\">=</span> Convert<span class=\"token punctuation\">.</span><span class=\"token function\">ToDouble</span><span class=\"token punctuation\">(</span>cmd<span class=\"token punctuation\">.</span><span class=\"token function\">ExecuteScalar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            conn <span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">StripLine</span> stripLine <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">StripLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            stripLine<span class=\"token punctuation\">.</span>Interval <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//偏移</span>\n            stripLine<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">;</span><span class=\"token comment\">//刻度</span>\n            stripLine<span class=\"token punctuation\">.</span>StripWidth <span class=\"token operator\">=</span> stripWidth<span class=\"token punctuation\">;</span>\n            stripLine<span class=\"token punctuation\">.</span>BackColor <span class=\"token operator\">=</span>color<span class=\"token punctuation\">;</span>\n            stripLine<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"{0:F}\"</span><span class=\"token punctuation\">,</span> Line<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">return</span> stripLine<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a0ce834599ef42e5bf06568042208170.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\1538420c56154cdfaa7572102b25b7c6.png\"/></p>\n<ul><li>窗体代码</li></ul>\n<pre><code class=\"prism language-csharp\"><span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Form1_Load</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//dgvLine.DataSource = dt;</span>\n\n            <span class=\"token comment\">//combobox数据绑定</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlM <span class=\"token operator\">=</span> <span class=\"token string\">\"select * from MidLLine\"</span><span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">DataTable</span> dtM <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            cbbMidLine<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dtM<span class=\"token punctuation\">;</span>\n            cbbMidLine<span class=\"token punctuation\">.</span>ValueMember <span class=\"token operator\">=</span> <span class=\"token string\">\"MidLine\"</span><span class=\"token punctuation\">;</span>\n            cbbMidLine<span class=\"token punctuation\">.</span>DisplayMember <span class=\"token operator\">=</span> <span class=\"token string\">\"MidLine\"</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">cbbMidLine_SelectedIndexChanged</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">object</span></span> sender<span class=\"token punctuation\">,</span> <span class=\"token class-name\">EventArgs</span> e<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n        \t\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Max<span class=\"token punctuation\">,</span>Min<span class=\"token punctuation\">,</span>Mid<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\">StripLine</span> stripMax <span class=\"token punctuation\">,</span> stripMin<span class=\"token punctuation\">,</span> stripMid<span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cbbMidLine<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlA <span class=\"token operator\">=</span> <span class=\"token string\">\"select AVG(numY) from BrokenLine10 \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMax <span class=\"token operator\">=</span> <span class=\"token string\">\"select MAX(numY) from BrokenLine10\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMin <span class=\"token operator\">=</span> <span class=\"token string\">\"select MIN(numY) from BrokenLine10\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlCount <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(1) from BrokenLine10\"</span><span class=\"token punctuation\">;</span>\n                \n                stripMax <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMax<span class=\"token punctuation\">,</span><span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span><span class=\"token keyword\">out</span> Max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMAX<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Max<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMin<span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMin<span class=\"token punctuation\">,</span><span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span><span class=\"token keyword\">out</span> Min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMIN<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Min<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid<span class=\"token operator\">=</span>Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlA<span class=\"token punctuation\">,</span><span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span><span class=\"token keyword\">out</span> Mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                texAvg<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Mid<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Count<span class=\"token operator\">=</span>SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">Count</span><span class=\"token punctuation\">(</span>sqlCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textCount<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Count<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                stripMid<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"标准值：{0:F}\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//展示文本</span>\n                stripMid<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine10\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>YValueMembers <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ColumnName<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> Min<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> Max<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cbbMidLine<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlA <span class=\"token operator\">=</span> <span class=\"token string\">\"select AVG(numY) from BrokenLine20 \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMax <span class=\"token operator\">=</span> <span class=\"token string\">\"select MAX(numY) from BrokenLine20\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMin <span class=\"token operator\">=</span> <span class=\"token string\">\"select MIN(numY) from BrokenLine20\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlCount <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(1) from BrokenLine20\"</span><span class=\"token punctuation\">;</span>\n                stripMax <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMax<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMAX<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Max<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMin <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMin<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span><span class=\"token keyword\">out</span> Min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMIN<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Min<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid<span class=\"token operator\">=</span>Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlA<span class=\"token punctuation\">,</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>    \n                texAvg<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Mid<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Count <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">Count</span><span class=\"token punctuation\">(</span>sqlCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textCount<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Count<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                stripMid<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"标准值：{0:F}\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine20\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>YValueMembers <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ColumnName<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> Min<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> Max<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cbbMidLine<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlA <span class=\"token operator\">=</span> <span class=\"token string\">\"select AVG(numY) from BrokenLine30 \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMax <span class=\"token operator\">=</span> <span class=\"token string\">\"select MAX(numY) from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMin <span class=\"token operator\">=</span> <span class=\"token string\">\"select MIN(numY) from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlCount <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(1) from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n                stripMax <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMax<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMAX<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Max<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMin <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMin<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMIN<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Min<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlA<span class=\"token punctuation\">,</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                texAvg<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Mid<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n               \n                <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Count <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">Count</span><span class=\"token punctuation\">(</span>sqlCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textCount<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Count<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                stripMid<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"标准值：{0:F}\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> <span class=\"token number\">30</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine30\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>YValueMembers <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ColumnName<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> Min<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> Max<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cbbMidLine<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlA <span class=\"token operator\">=</span> <span class=\"token string\">\"select AVG(numY) from BrokenLine40 \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMax <span class=\"token operator\">=</span> <span class=\"token string\">\"select MAX(numY) from BrokenLine40\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMin <span class=\"token operator\">=</span> <span class=\"token string\">\"select MIN(numY) from BrokenLine40\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlCount <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(1) from BrokenLine40\"</span><span class=\"token punctuation\">;</span>\n                stripMax <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMax<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMAX<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Max<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMin <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMin<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMIN<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Min<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlA<span class=\"token punctuation\">,</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                texAvg<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Mid<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Count <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">Count</span><span class=\"token punctuation\">(</span>sqlCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textCount<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Count<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                stripMid<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"标准值：{0:F}\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//展示文本</span>\n                stripMid<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> <span class=\"token number\">40</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine40\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>YValueMembers <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ColumnName<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> Min<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> Max<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cbbMidLine<span class=\"token punctuation\">.</span>SelectedIndex <span class=\"token operator\">==</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlA <span class=\"token operator\">=</span> <span class=\"token string\">\"select AVG(numY) from BrokenLine50 \"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMax <span class=\"token operator\">=</span> <span class=\"token string\">\"select MAX(numY) from BrokenLine50\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlMin <span class=\"token operator\">=</span> <span class=\"token string\">\"select MIN(numY) from BrokenLine50\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlCount <span class=\"token operator\">=</span> <span class=\"token string\">\"select count(1) from BrokenLine50\"</span><span class=\"token punctuation\">;</span>\n                stripMax <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMax<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMAX<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Max<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMin <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlMin<span class=\"token punctuation\">,</span> <span class=\"token number\">0.02</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>DarkGreen<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Min<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textMIN<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Min<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                stripMid <span class=\"token operator\">=</span> Line<span class=\"token punctuation\">.</span><span class=\"token function\">SetLine</span><span class=\"token punctuation\">(</span>sqlA<span class=\"token punctuation\">,</span> <span class=\"token number\">0.03</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">.</span>Orange<span class=\"token punctuation\">,</span> <span class=\"token keyword\">out</span> Mid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                texAvg<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Mid<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.00\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Count <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">Count</span><span class=\"token punctuation\">(</span>sqlCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                textCount<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> Count<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                stripMid<span class=\"token punctuation\">.</span>Text <span class=\"token operator\">=</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">Format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"标准值：{0:F}\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//展示文本</span>\n                stripMid<span class=\"token punctuation\">.</span>IntervalOffset <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> sqlS <span class=\"token operator\">=</span> <span class=\"token string\">\"select numX,numY from BrokenLine50\"</span><span class=\"token punctuation\">;</span>\n                <span class=\"token class-name\">DataTable</span> dt <span class=\"token operator\">=</span> SqlHelper<span class=\"token punctuation\">.</span><span class=\"token function\">GetDataTable</span><span class=\"token punctuation\">(</span>sqlS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>DataSource <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{<!-- --></span>\n                    chart1<span class=\"token punctuation\">.</span>Series<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>YValueMembers <span class=\"token operator\">=</span> dt<span class=\"token punctuation\">.</span>Columns<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ColumnName<span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n               \n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMax<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>StripLines<span class=\"token punctuation\">.</span><span class=\"token function\">Add</span><span class=\"token punctuation\">(</span>stripMid<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Minimum <span class=\"token operator\">=</span> Min<span class=\"token operator\">-</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n                <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>chart1<span class=\"token punctuation\">.</span>ChartAreas<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>AxisY<span class=\"token punctuation\">.</span>Maximum <span class=\"token operator\">=</span> Max<span class=\"token operator\">+</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n</code></pre>\n<ul><li>窗体Load事件是双击触发</li><li>combobox（在此项目中改名为cbbMidLine）的值改变事件是在属性里的事件里找到SelectedChanged再点击<br/> <img alt=\"在这里插入图片描述\" src=\"image\\a96aee8562d04df7b419cf6d0d1da23f.png\"/></li><li>点击完的效果</li><li><img alt=\"在这里插入图片描述\" src=\"image\\5494c797036f4605ae1e204484261786.png\"/></li><li>数据库的设计<br/> <img alt=\"在这里插入图片描述\" src=\"image\\f407ff0218ea45c08bf7a59ab436723a.png\"/></li><li>表的设计<br/> BrokenLine10–BrokenLine50，设计都是一样的<img alt=\"在这里插入图片描述\" src=\"image\\f903f2786ec2422c987477e54b1de185.png\"/>此表放平均值<img alt=\"在这里插入图片描述\" src=\"image\\7ad241b32d1e416abc877c69b35e4bd8.png\"/></li></ul>\n<h2><a id=\"3_394\"></a>3.浅贴一下效果</h2>\n<ul><li>标准值为10<img alt=\"在这里插入图片描述\" src=\"image\\bc63efe8193f454bb1038b6ea55866a0.png\"/></li><li>20<img alt=\"在这里插入图片描述\" src=\"image\\90fb0f83e18b48528c7db67bfb1bbdbb.png\"/></li><li>30<img alt=\"在这里插入图片描述\" src=\"image\\782231238b5a4101a096701849c2a407.png\"/></li></ul>\n<hr/>\n<h1><a id=\"__403\"></a>算是完结了吧 ，有问题一起交流鸭</h1>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}