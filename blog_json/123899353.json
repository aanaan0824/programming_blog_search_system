{"blogid": "123899353", "writerAge": "码龄1年", "writerBlogNum": "111", "writerCollect": "326", "writerComment": "7", "writerFan": "56", "writerGrade": "4级", "writerIntegral": "1147", "writerName": "XWenXiang", "writerProfileAdress": "writer_image\\profile_123899353.jpg", "writerRankTotal": "16055", "writerRankWeekly": "14601", "writerThumb": "37", "writerVisitNum": "49568", "blog_read_count": "7104", "blog_time": "于 2022-04-01 18:13:19 发布", "blog_title": "Python openpyxl模块简单介绍", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><ul><li><ul><li><a href=\"#openpyxl_1\">openpyxl</a></li><li><a href=\"#_9\">创建文件</a></li><li><ul><li><a href=\"#Workbook__excel__10\">Workbook() ---创建 excel 文件</a></li><li><a href=\"#Workbookcreate_sheet__excel__18\">Workbook.create_sheet() ---创建 excel 工作簿</a></li><li><a href=\"#Worksheettitle__35\">Worksheet.title ---给工作簿重命名</a></li><li><a href=\"#wssheet_propertiestabColor______50\">ws.sheet_properties.tabColor = \" \" 修改标题背景</a></li><li><a href=\"#Workbooksheetname__excel__64\">Workbook.sheetname ---查看 excel 所有工作簿</a></li><li><a href=\"#Workbookcopy_worksheet__75\">Workbook.copy_worksheet() ---创建工作表的副本</a></li></ul>\n</li><li><a href=\"#_79\">获取修改数据</a></li><li><ul><li><a href=\"#_80\">访问一个单元格</a></li><li><ul><li><a href=\"#Worksheet__83\">Worksheet[ ]</a></li><li><a href=\"#Worksheetcell_95\">Worksheet.cell()</a></li><li><a href=\"#Worksheetappend_112\">Worksheet.append()</a></li><li><a href=\"#_127\">公式</a></li></ul>\n</li><li><a href=\"#_134\">访问多个单元格</a></li><li><ul><li><a href=\"#_135\">可以使用切片访问单元格范围</a></li><li><a href=\"#Worksheetvalues__144\">Worksheet.values ---获取单元格值</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_160\">保存文件</a></li><li><a href=\"#_169\">打开文件</a></li><li><ul><li><a href=\"#openpyxlload_workbook__excel__170\">openpyxl.load_workbook() ---读取 excel 文件</a></li><li><ul><li><a href=\"#_179\">读取工作簿数据</a></li></ul>\n</li></ul>\n</li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h3><a id=\"openpyxl_1\"></a>openpyxl</h3>\n<p>openpyxl模块属于第三方模块，是一个在 python 中能够处理 excel 文件的模块，还有比较出名的是xlrd、xlwt 分别控制excel文件的读写，这俩个能够兼容所有版本的文件。openpyxl 针对 excel 2003版本之前的兼容性可能不好 但是功能更加强大。</p>\n<pre><code class=\"prism language-python\">excel文件的版本及后缀\n\t<span class=\"token number\">2003</span>版本之前 excel的文件后缀是xls\n\t<span class=\"token number\">2003</span>版本之后 excel的文件后缀是xlsx、csv\n</code></pre>\n<h3><a id=\"_9\"></a>创建文件</h3>\n<h4><a id=\"Workbook__excel__10\"></a>Workbook() —创建 excel 文件</h4>\n<p>使用 openpyxl 创建文件。只需导入Workbook类</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 一个 excel 文件创建成功</span>\n</code></pre>\n<h4><a id=\"Workbookcreate_sheet__excel__18\"></a>Workbook.create_sheet() —创建 excel 工作簿</h4>\n<p>Workbook.create_sheet() 可以创建自定义名称的工作簿。括号里的参数是工作簿名称，还有一个参数是工作簿的位置，也可以不写</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建了一个用户信息表并放在第一位，如下图</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" height=\"120\" src=\"image\\7a93669418da4b8489c4df9d5c034aad.png\" width=\"600\"/><br/> <code>Sheet 工作簿是自动生成的</code></p>\n</blockquote>\n<pre><code class=\"prism language-python\">可以创建多个工作簿，并且它们按顺序排列。\n</code></pre>\n<h4><a id=\"Worksheettitle__35\"></a>Worksheet.title —给工作簿重命名</h4>\n<p>使用 Worksheet.title属性更改表名称</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建 excel 文件</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建工作簿用户信息表放在第一位</span>\nws2 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'bank_info'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建工作簿bank_info</span>\nws1<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'user_info'</span>  <span class=\"token comment\"># 更改工作簿用户信息表的名称</span>\n<span class=\"token triple-quoted-string string\">'''用代码保存一下后，如下图所示'''</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" height=\"120\" src=\"image\\f36fe46506044a11a0a4b1218247d65d.png\" width=\"600\"/><br/> <strong>用户信息表 被改名成 user_info</strong></p>\n</blockquote>\n<h4><a id=\"wssheet_propertiestabColor______50\"></a>ws.sheet_properties.tabColor = \" \" 修改标题背景</h4>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>sheet_properties<span class=\"token punctuation\">.</span>tabColor <span class=\"token operator\">=</span> <span class=\"token string\">'FF6666'</span>  <span class=\"token comment\"># 将标题背景改为指定RRGGBB颜色代码</span>\n<span class=\"token triple-quoted-string string\">'''用代码保存一下后，如下图所示'''</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" height=\"120\" src=\"image\\42f6f2848c7e4e2ba11969f9d63469cf.png\" width=\"600\"/><br/> 变得更好看了…</p>\n</blockquote>\n<h4><a id=\"Workbooksheetname__excel__64\"></a>Workbook.sheetname —查看 excel 所有工作簿</h4>\n<p>返回包含 excel 文件下所有工作簿名称的列表</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>\n\n打印结果 <span class=\"token punctuation\">[</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Sheet'</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h4><a id=\"Workbookcopy_worksheet__75\"></a>Workbook.copy_worksheet() —创建工作表的副本</h4>\n<p>Workbook.copy_worksheet()方法可以在单个工作簿中创建工作表的副本。 仅复制单元格（包括值、样式、超链接和注释）和某些工作表属性（包括尺寸、格式和属性）。不会复制所有其他工作簿/工作表属性 - 例如图像、图表。</p>\n<p><img alt=\"\" height=\"200\" src=\"image\\d441032b115f6280de07f774c924e080.jpg\" width=\"200\"/></p>\n<h3><a id=\"_79\"></a>获取修改数据</h3>\n<h4><a id=\"_80\"></a>访问一个单元格</h4>\n<p>在 excel 中可以通过位置找到里面的内容，同样使用代码也能通过位置找到内容。</p>\n<h5><a id=\"Worksheet__83\"></a>Worksheet[ ]</h5>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'XWenXiang'</span>  <span class=\"token comment\"># ws1['A1'] 代表的是该表中的 A1 位置，我们可以将数据直接赋值给它</span>\n<span class=\"token triple-quoted-string string\">'''用代码保存一下后，如下图所示'''</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" height=\"130\" src=\"image\\ad4f24673f6d403190806aa34f7c75e5.png\" width=\"300\"/><br/> 此时的 A1 被填入内容 XWenXiang</p>\n</blockquote>\n<h5><a id=\"Worksheetcell_95\"></a>Worksheet.cell()</h5>\n<pre><code class=\"prism language-python\"><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token string\">'除了直接获取位置还可以使用 Worksheet.cell()方法'</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">-</span>\n \n<span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>  \n\n此方法是通过指定坐标的方式赋值，其中 row 参数代表行数， column 代表列数，value 是填入的数据。\n<span class=\"token triple-quoted-string string\">'''用代码保存一下后，如下图所示'''</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\1174abe875f24434bb21d66faee5e5be.png\"/><br/> 在第2列第4行的位置填入数字10</p>\n</blockquote>\n<h5><a id=\"Worksheetappend_112\"></a>Worksheet.append()</h5>\n<p>Worksheet.append() 可以同时写入多个数据。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'XWenXiang'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'man'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 要用 [] 括起来</span>\n<span class=\"token triple-quoted-string string\">'''用代码保存一下后，如下图所示'''</span>\n</code></pre>\n<blockquote>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\6d7b58c0cc7246d7a20f1df53edea502.png\"/><br/> 批量写入数据，重复数据还可以加一个循环写入。</p>\n</blockquote>\n<h5><a id=\"_127\"></a>公式</h5>\n<p>模块里使用的公式和 excel 中的公式是一样的</p>\n<pre><code class=\"prism language-python\">ws1<span class=\"token punctuation\">[</span><span class=\"token string\">'A6'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'=sum(A4:A5)'</span>  <span class=\"token comment\"># 对A4和A5进行求和并写入到A6</span>\n</code></pre>\n<h4><a id=\"_134\"></a>访问多个单元格</h4>\n<h5><a id=\"_135\"></a>可以使用切片访问单元格范围</h5>\n<pre><code class=\"prism language-python\">x <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'C2'</span><span class=\"token punctuation\">]</span>\nx1 <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">[</span><span class=\"token string\">'C'</span><span class=\"token punctuation\">]</span>\nx2 <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">[</span><span class=\"token string\">'C:D'</span><span class=\"token punctuation\">]</span>\nx3 <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span>\nx4 <span class=\"token operator\">=</span> ws<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">:</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h5><a id=\"Worksheetvalues__144\"></a>Worksheet.values —获取单元格值</h5>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> Workbook\n\nwb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nws1 <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gender'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nws1<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'XWenXiang'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'man'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> ws1<span class=\"token punctuation\">.</span>values<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span>\n\n打印结果：\n<span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gender'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span><span class=\"token string\">'XWenXiang'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'15'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'man'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_160\"></a>保存文件</h3>\n<p>保存工作簿最简单、最安全的方法是使用 对象的 Workbook.save() 方法 Workbook。<br/> 在前面的代码示例都没有将保存代码加入。</p>\n<pre><code class=\"prism language-python\">wb <span class=\"token operator\">=</span> Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nwb<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'balances.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># balances.xlsx 是保存的路径，也就是文件名。</span>\n编辑完要保存才行。\n</code></pre>\n<p><img alt=\"\" height=\"200\" src=\"image\\f9327156d9a2e97f4864ab291ad31d8b.jpg\" width=\"200\"/></p>\n<h3><a id=\"_169\"></a>打开文件</h3>\n<h4><a id=\"openpyxlload_workbook__excel__170\"></a>openpyxl.load_workbook() —读取 excel 文件</h4>\n<p>和 Workbook 写入一样，使用 openpyxl.load_workbook() 可以打开现有工作簿。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook  <span class=\"token comment\"># 导入 load_workbook </span>\nwb <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'ex_a.xlsx'</span><span class=\"token punctuation\">,</span> read_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> data_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># ex_a.xlsx是文件名</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>wb<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印所有工作簿的名称</span>\n</code></pre>\n<h5><a id=\"_179\"></a>读取工作簿数据</h5>\n<pre><code class=\"prism language-python\">方式一\n\t<span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook\n\t\n\twb <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'ex_a.xlsx'</span><span class=\"token punctuation\">,</span> read_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> data_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\tws <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">[</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 拿到工作薄对象</span>\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 取出工作薄对象中 A1 位置的值</span>\n\n</code></pre>\n<pre><code class=\"prism language-python\">方式二\n\t<span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook\n\t\n\twb <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'ex_a.xlsx'</span><span class=\"token punctuation\">,</span> read_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> data_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\tws <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">[</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">]</span>\n\t<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 通过行与列的形式来取值</span>\n\t\n</code></pre>\n<pre><code class=\"prism language-python\">方式三（逐行读取）\n\t<span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook\n\t\n\twb <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'ex_a.xlsx'</span><span class=\"token punctuation\">,</span> read_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> data_only<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\tws <span class=\"token operator\">=</span> wb<span class=\"token punctuation\">[</span><span class=\"token string\">'用户信息表'</span><span class=\"token punctuation\">]</span>\n\t<span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> ws<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 获取每一行的数据</span>\n\t    <span class=\"token keyword\">for</span> data <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 获取每一行中单元格的数据</span>\n\t        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印单元格的值</span>\n\n</code></pre>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}