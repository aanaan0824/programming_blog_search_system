{"blogid": "126229040", "writerAge": "码龄2年", "writerBlogNum": "179", "writerCollect": "4011", "writerComment": "3021", "writerFan": "23545", "writerGrade": "7级", "writerIntegral": "11061", "writerName": "侯小啾", "writerProfileAdress": "writer_image\\profile_126229040.jpg", "writerRankTotal": "1009", "writerRankWeekly": "23", "writerThumb": "3342", "writerVisitNum": "332465", "blog_read_count": "3216", "blog_time": "已于 2022-08-17 21:11:50 修改", "blog_title": "逻辑回归原理梳理_以python为工具 【Python机器学习系列（九）】", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-kimbie-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><font color=\"purple\" size=\"5\">逻辑回归原理梳理_以python为工具 【Python机器学习系列（九）】<br/> </font></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#1_12\">1.传统线性回归</a></li><li><a href=\"#2sigmoid_19\">2.引入sigmoid函数并复合</a></li><li><a href=\"#3__40\">3. 代价函数</a></li><li><a href=\"#4_54\">4.似然函数也可以</a></li><li><a href=\"#5_python_69\">5. python梯度下降实现逻辑回归</a></li><li><a href=\"#6python_179\">6.python梯度下降实现非线性逻辑回归</a></li></ul>\n</div>\n<p></p>\n<hr/>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\1420d461b74e4448a2f85e9af353ab0e.png\"/></p>\n<hr/>\n<p><font color=\"purple\" size=\"4\">大家好，我是侯小啾！</font><img alt=\"在这里插入图片描述\" src=\"image\\3ed5e82a513a4a41b019a3b3d747ef7f.png\"/></p>\n<p><font color=\"brown\" size=\"4\"> <img alt=\"在这里插入图片描述\" src=\"image\\4e3c21f29fd0442a8bf8b90dcf152434.png\"/>今天分享的内容是，逻辑回归的原理，及过程中的公式推导。并使用python实现梯度下降法的逻辑回归。<br/> <font size=\"5\">    ʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞʚʕ̯•͡˔•̯᷅ʔɞ</font></font></p>\n<hr/>\n<h1><a id=\"1_12\"></a>1.传统线性回归</h1>\n<p><font color=\"brown\" size=\"4\">逻辑回归是一种常用的回归模型，是广义的线性回归的一种特例。做线性回归时，我们采用预测函数的一般形式为：</font></p>\n<p><font color=\"red\" size=\"5\">              <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         h\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         =\n        \n        \n         \n          ω\n         \n         \n          T\n         \n        \n        \n         X\n        \n        \n         +\n        \n        \n         b\n        \n        \n         =\n        \n        \n         \n          θ\n         \n         \n          T\n         \n        \n        \n         X\n        \n       \n       \n        h(X)=\\omega^TX+b=\\theta^TX\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.9247em; vertical-align: -0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8413em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0278em;\">θ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8413em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span></span></span></span></span></font></p>\n<p>（其中<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n    \n     \n      \n       \n        b\n       \n      \n      \n       b\n      \n     \n    </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>可以和<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n    \n     \n      \n       \n        ω\n       \n      \n      \n       \\omega\n      \n     \n    </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span></span></span></span></span>和并写为<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n    \n     \n      \n       \n        θ\n       \n      \n      \n       \\theta\n      \n     \n    </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0278em;\">θ</span></span></span></span></span>，这样即相当于给矩阵X一个全为1的列。）</p>\n<hr/>\n<h1><a id=\"2sigmoid_19\"></a>2.引入sigmoid函数并复合</h1>\n<p><font size=\"4\">在使用逻辑回归做分类问题时，单纯的这个式子已经不能满足我们的需求。以二分类为例，样本数据中对事件是否发生的描述，只有0和1。为建立描述目标事件发生概率与样本特征之间的关系，因为事件发生的概率分布在[0,1]区间内，所以这里可以与<code>sigmoid</code>函数组成复合函数：<br/>  <br/> <font color=\"red\" size=\"6\">          <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          g\n         \n         \n          (\n         \n         \n          z\n         \n         \n          )\n         \n         \n          =\n         \n         \n          \n           1\n          \n          \n           \n            1\n           \n           \n            +\n           \n           \n            \n             e\n            \n            \n             \n              −\n             \n             \n              z\n             \n            \n           \n          \n         \n        \n        \n         g(z)=\\frac{1}{1+e^{-z}}\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.044em;\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.2484em; vertical-align: -0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8451em;\"><span class=\"\" style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.7027em;\"><span class=\"\" style=\"top: -2.786em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.044em;\">z</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"\" style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span class=\"\" style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.4033em;\"><span class=\"\"></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></font></font></p>\n<hr/>\n<p><font color=\"brown\" size=\"4\"><code>sigmoid</code>函数的定义域为全体实数，而值域为(0,1)，函数曲线如图所示：<br/>       <img alt=\"在这里插入图片描述\" src=\"image\\d6f8bcad36ed47eb817ffc3aeb605fd5.png\"/></font></p>\n<hr/>\n<p><font color=\"purple\" size=\"4\">将h(x)嵌套进g(z)得到新的H(x)表达式为：<br/>  <br/> <font color=\"red\" size=\"6\">     <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          H\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          =\n         \n         \n          g\n         \n         \n          (\n         \n         \n          h\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          )\n         \n         \n          =\n         \n         \n          p\n         \n         \n          =\n         \n         \n          \n           1\n          \n          \n           \n            1\n           \n           \n            +\n           \n           \n            \n             e\n            \n            \n             \n              −\n             \n             \n              (\n             \n             \n              \n               ω\n              \n              \n               T\n              \n             \n             \n              X\n             \n             \n              +\n             \n             \n              b\n             \n             \n              )\n             \n            \n           \n          \n         \n        \n        \n         H(X)=g(h(X))=p=\\frac{1}{1+e^{-(\\omega^T X+b)}}\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.4025em; vertical-align: -0.5574em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8451em;\"><span class=\"\" style=\"top: -2.5009em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.9844em;\"><span class=\"\" style=\"top: -2.9844em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.6981em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mopen mtight\">(</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.9773em;\"><span class=\"\" style=\"top: -2.9773em; margin-right: 0.1em;\"><span class=\"pstrut\" style=\"height: 2.6833em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"\" style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span class=\"\" style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.5574em;\"><span class=\"\"></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></font></font></p>\n<p><font color=\"purple\" size=\"4\">这里的H(X)表示事件发生概率的的预测值 p。（即结果为1的概率，值越大表示结果越可能为1，越小表示结果越可能为0）</font></p>\n<hr/>\n<p><font color=\"purple\" size=\"4\">此式，也等价于将对数几率<font color=\"red\" size=\"5\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          \n           p\n          \n          \n           \n            1\n           \n           \n            −\n           \n           \n            p\n           \n          \n         \n        \n        \n         \\ln\\frac{p}{1-p}\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.2286em; vertical-align: -0.4811em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.7475em;\"><span class=\"\" style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"\" style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span class=\"\" style=\"top: -3.4461em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.4811em;\"><span class=\"\"></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></font> 对 X 做回归：<br/>  <br/> <font color=\"red\" size=\"6\">         <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          \n           p\n          \n          \n           \n            1\n           \n           \n            −\n           \n           \n            p\n           \n          \n         \n         \n          =\n         \n         \n          \n           ω\n          \n          \n           T\n          \n         \n         \n          X\n         \n         \n          +\n         \n         \n          b\n         \n        \n        \n         \\ln\\frac{p}{1-p}=\\omega^T X+b\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1.2286em; vertical-align: -0.4811em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.7475em;\"><span class=\"\" style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"\" style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span class=\"\" style=\"top: -3.4461em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.4811em;\"><span class=\"\"></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.9247em; vertical-align: -0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8413em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span></font></font></p>\n<p>（这里只做普及，下边进一步的过程还使用H(x)而不用对数几率。因为以样本结果的1和0作为真实的p值，取值只有0和1，而当p=1时的对数几率为无穷，所以不适用。）</p>\n<hr/>\n<h1><a id=\"3__40\"></a>3. 代价函数</h1>\n<p><font color=\"brown\" size=\"4\">在传统的线性回归中，我们只需找到能使均方误差最小的<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ω\n        \n       \n       \n        \\omega\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span></span></span></span></span>和<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         b\n        \n       \n       \n        b\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>值即可，这个表示均方误差的表达式即“代价函数”。在这里的逻辑回归中，我们同样需要选择合适的代价函数：</font></p>\n<p><font color=\"red\" size=\"5\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         c\n        \n        \n         o\n        \n        \n         s\n        \n        \n         t\n        \n        \n         (\n        \n        \n         H\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         ,\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         )\n        \n        \n         =\n        \n        \n         −\n        \n        \n         \n          1\n         \n         \n          m\n         \n        \n        \n         \n          ∑\n         \n         \n          \n           i\n          \n          \n           =\n          \n          \n           1\n          \n         \n         \n          m\n         \n        \n        \n         [\n        \n        \n         −\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         (\n        \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         (\n        \n        \n         H\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         )\n        \n        \n         −\n        \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         y\n        \n        \n         )\n        \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         H\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         )\n        \n        \n         )\n        \n        \n         ]\n        \n       \n       \n        cost(H(X),y_i)=-\\frac{1}{m}\\sum_{i=1}^m[-y_i(\\ln(H(X))-(1-y)\\ln(1-H(X)))]\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.1901em; vertical-align: -0.345em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8451em;\"><span class=\"\" style=\"top: -2.655em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"\" style=\"top: -3.23em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width: 0.04em;\"></span></span><span class=\"\" style=\"top: -3.394em;\"><span class=\"pstrut\" style=\"height: 3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.345em;\"><span class=\"\"></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position: relative; top: 0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8043em;\"><span class=\"\" style=\"top: -2.4003em; margin-left: 0em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span class=\"\" style=\"top: -3.2029em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2997em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)))]</span></span></span></span></span></font></p>\n<p><font color=\"brown\" size=\"4\">其中，m表示样本总数为m。如何理解这个式子呢：<br/>  <br/> 因为H(X)是在(0,1)范围内的，所以<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         (\n        \n        \n         H\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         )\n        \n       \n       \n        \\ln(H(X))\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">))</span></span></span></span></span>是负数，在前边再加负号即为正值，取值范围为大于0的全体实数。<br/> <font color=\"purple\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          −\n         \n         \n          \n           y\n          \n          \n           i\n          \n         \n         \n          (\n         \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          (\n         \n         \n          H\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          )\n         \n        \n        \n         -y_i(\\ln(H(X))\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">))</span></span></span></span></span></font> 和 <font color=\"purple\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          −\n         \n         \n          (\n         \n         \n          1\n         \n         \n          −\n         \n         \n          y\n         \n         \n          )\n         \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          (\n         \n         \n          1\n         \n         \n          −\n         \n         \n          H\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          )\n         \n         \n          )\n         \n        \n        \n         -(1-y)\\ln(1-H(X)))\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)))</span></span></span></span></span></font>两个式子总是有一个为0。<br/>  <br/> 当<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          y\n         \n         \n          i\n         \n        \n       \n       \n        y_i\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span>为1时，<font color=\"red\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          −\n         \n         \n          \n           y\n          \n          \n           i\n          \n         \n         \n          (\n         \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          (\n         \n         \n          H\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          )\n         \n        \n        \n         -y_i(\\ln(H(X))\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">))</span></span></span></span></span></font>不为0，该式子越大，则表示预测错误的越严重，越小则表示预测的越准确；同理，<font color=\"red\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          −\n         \n         \n          (\n         \n         \n          1\n         \n         \n          −\n         \n         \n          y\n         \n         \n          )\n         \n         \n          ln\n         \n         \n          ⁡\n         \n         \n          (\n         \n         \n          1\n         \n         \n          −\n         \n         \n          H\n         \n         \n          (\n         \n         \n          X\n         \n         \n          )\n         \n         \n          )\n         \n         \n          )\n         \n        \n        \n         -(1-y)\\ln(1-H(X)))\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)))</span></span></span></span></span></font>式子则表示<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         =\n        \n        \n         0\n        \n       \n       \n        y_i=0\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span>的时候，预测的的准确性（也是越大越不准确）。所以我们需要找到能使得<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         c\n        \n        \n         o\n        \n        \n         s\n        \n        \n         t\n        \n        \n         (\n        \n        \n         H\n        \n        \n         (\n        \n        \n         X\n        \n        \n         )\n        \n        \n         ,\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         )\n        \n       \n       \n        cost(H(X),y_i)\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0813em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0785em;\">X</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>最小 的<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ω\n        \n       \n       \n        \\omega\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span></span></span></span></span>和<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         b\n        \n       \n       \n        b\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>值。</font></p>\n<p>这个式子还可以进一步化简，具体这里不再展示。</p>\n<hr/>\n<h1><a id=\"4_54\"></a>4.似然函数也可以</h1>\n<p><font color=\"brown\" size=\"4\">也可以使用似然函数代替代价函数：</font></p>\n<p><font color=\"red\" size=\"6\">      <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         L\n        \n        \n         (\n        \n        \n         ω\n        \n        \n         )\n        \n        \n         =\n        \n        \n         \n          ∏\n         \n         \n          \n           i\n          \n          \n           =\n          \n          \n           1\n          \n         \n         \n          m\n         \n        \n        \n         \n          p\n         \n         \n          \n           y\n          \n          \n           i\n          \n         \n        \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         p\n        \n        \n         \n          )\n         \n         \n          \n           1\n          \n          \n           −\n          \n          \n           \n            y\n           \n           \n            i\n           \n          \n         \n        \n       \n       \n        L(\\omega)=\\prod_{i=1}^m p^{y_i}(1-p)^{1-y_i}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.104em; vertical-align: -0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position: relative; top: 0em;\">∏</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8043em;\"><span class=\"\" style=\"top: -2.4003em; margin-left: 0em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span class=\"\" style=\"top: -3.2029em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2997em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6644em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3281em;\"><span class=\"\" style=\"top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.143em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.0641em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8141em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3281em;\"><span class=\"\" style=\"top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.143em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></p>\n<p><font size=\"4\">此表达式的含义是，每个样本预测正确的概率的乘积。<br/> 其中p即H(X)预测的结果。<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          y\n         \n         \n          i\n         \n        \n       \n       \n        y_i\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span>的取值可以是1和0，所以当<font size=\"5\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          \n           y\n          \n          \n           i\n          \n         \n        \n        \n         y_i\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></font>为1时<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         p\n        \n        \n         \n          )\n         \n         \n          \n           1\n          \n          \n           −\n          \n          \n           \n            y\n           \n           \n            i\n           \n          \n         \n        \n       \n       \n        (1-p)^{1-y_i}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.0641em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8141em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3281em;\"><span class=\"\" style=\"top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.143em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>为1，而<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          y\n         \n         \n          i\n         \n        \n       \n       \n        y_i\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.625em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span>为0时<font size=\"5\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n      \n       \n        \n         \n          \n           p\n          \n          \n           \n            y\n           \n           \n            i\n           \n          \n         \n        \n        \n         p^{<!-- -->{y_i}}\n        \n       \n      </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.8588em; vertical-align: -0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.6644em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3281em;\"><span class=\"\" style=\"top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.143em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font>为1。<br/> 而我们的目的是，尽可能地使得这个乘积最大。</font></p>\n<p><font color=\"brown\" size=\"4\">对该表达式两边同时去对数，得：</font></p>\n<p><font size=\"5\"><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         l\n        \n        \n         (\n        \n        \n         ω\n        \n        \n         )\n        \n        \n         =\n        \n        \n         \n          ∑\n         \n         \n          \n           i\n          \n          \n           =\n          \n          \n           1\n          \n         \n         \n          m\n         \n        \n        \n         (\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         p\n        \n        \n         +\n        \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         )\n        \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         (\n        \n        \n         1\n        \n        \n         −\n        \n        \n         p\n        \n        \n         )\n        \n        \n         )\n        \n       \n       \n        l(\\omega)=\\sum_{i=1}^{m}(y_i \\ln p + (1-y_i)\\ln (1-p))\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0197em;\">l</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.104em; vertical-align: -0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position: relative; top: 0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8043em;\"><span class=\"\" style=\"top: -2.4003em; margin-left: 0em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span class=\"\" style=\"top: -3.2029em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2997em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right: 0.1667em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">))</span></span></span></span></span><br/>  <br/>    <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         =\n        \n        \n         \n          ∑\n         \n         \n          \n           i\n          \n          \n           =\n          \n          \n           1\n          \n         \n         \n          m\n         \n        \n        \n         (\n        \n        \n         \n          y\n         \n         \n          i\n         \n        \n        \n         \n          ω\n         \n         \n          T\n         \n        \n        \n         \n          x\n         \n         \n          i\n         \n        \n        \n         −\n        \n        \n         ln\n        \n        \n         ⁡\n        \n        \n         (\n        \n        \n         1\n        \n        \n         +\n        \n        \n         \n          e\n         \n         \n          \n           \n            ω\n           \n           \n            T\n           \n          \n          \n           \n            x\n           \n           \n            i\n           \n          \n         \n        \n        \n         )\n        \n        \n         )\n        \n       \n       \n        =\\sum_{i=1}^{m}(y_i\\omega^Tx_i-\\ln (1+e^{\\omega^Tx_i}))\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.3669em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right: 0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.141em; vertical-align: -0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position: relative; top: 0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8043em;\"><span class=\"\" style=\"top: -2.4003em; margin-left: 0em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span class=\"\" style=\"top: -3.2029em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.2997em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.8413em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3117em;\"><span class=\"\" style=\"top: -2.55em; margin-left: 0em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.15em;\"><span class=\"\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1em; vertical-align: -0.25em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right: 0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height: 1.2564em; vertical-align: -0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 1.0064em;\"><span class=\"\" style=\"top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.9191em;\"><span class=\"\" style=\"top: -2.931em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right: 0.1389em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.3281em;\"><span class=\"\" style=\"top: -2.357em; margin-left: 0em; margin-right: 0.0714em;\"><span class=\"pstrut\" style=\"height: 2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height: 0.143em;\"><span class=\"\"></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span></font></p>\n<hr/>\n<h1><a id=\"5_python_69\"></a>5. python梯度下降实现逻辑回归</h1>\n<p><font size=\"4\">得到或part3和part4得到的表达式后，可以使用梯度下降或牛顿法的方法进一步对参数 <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ω\n        \n       \n       \n        \\omega\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span></span></span></span></span> 和 <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         b\n        \n       \n       \n        b\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span> 进行求解了。<br/>  <br/> <font color=\"brown\" size=\"4\">以梯度下降法为例，首先自行准备一组数据，形如：<br/>         <img alt=\"在这里插入图片描述\" src=\"image\\a90354506d794ecc9ab6a47ff5d2810d.png\"/><br/> <font color=\"brown\" size=\"4\">其中第一列，第二列为两列特征，第三列为标签值。</font></font></font></p>\n<hr/>\n<p><font color=\"brown\" size=\"4\">梯度下降法实现逻辑回归的python代码如下，：</font></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\"># 读取数据</span>\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">\"data.csv\"</span><span class=\"token punctuation\">,</span> delimiter<span class=\"token operator\">=</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 特征：选择前两列</span>\nx_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 标签：y</span>\ny_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 给X添加一列全为1的数据，即 将b和Ω合并写为θ。</span>\nX_data <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> x_data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 定义sigmoid函数</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">sigmoid_</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">1</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">+</span> np<span class=\"token punctuation\">.</span>exp<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 定义损失函数 </span>\n<span class=\"token comment\"># xMat:x_data矩阵  yMat：y_data矩阵  ws：参数向量的转置</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">cost_</span><span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">,</span> yMat<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\t<span class=\"token comment\"># 左式，即y实际为1时</span>\n    left <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>multiply<span class=\"token punctuation\">(</span>yMat<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 右式，即y实际为0时</span>\n    right <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>multiply<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> yMat<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>left <span class=\"token operator\">+</span> right<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 定义梯度下降求解θ</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">gradAscent</span><span class=\"token punctuation\">(</span>xArr<span class=\"token punctuation\">,</span> yArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 将ndarry类型转为矩阵类型</span>\n    xMat <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>xArr<span class=\"token punctuation\">)</span>\n    yMat <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>yArr<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 初始化学习率</span>\n    lr <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span>\n    <span class=\"token comment\"># 初始化迭代次数</span>\n    epochs <span class=\"token operator\">=</span> <span class=\"token number\">10000</span>\n\n    <span class=\"token comment\"># 取出 样本个数m 以及 特征个数n</span>\n    m<span class=\"token punctuation\">,</span> n <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 初始化的θ --&gt; θ^T*xMat   θ0*x0+θ1*x1+θ2*x2</span>\n    ws <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 初始化损失列表</span>\n    costList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\"># 迭代</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>epochs <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 求导</span>\n        <span class=\"token comment\"># 1.h(x)  100*3 3*1 --&gt; 100*1 --&gt;每个样本都有一个h(x)</span>\n        h <span class=\"token operator\">=</span> sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># print(f\"xMat shape:{np.shape(xMat)}\")</span>\n        <span class=\"token comment\"># print(f\"ws shape:{np.shape(ws)}\")</span>\n\n        <span class=\"token comment\"># 矩阵乘法：n*m m*1 --&gt; n*1 --&gt;</span>\n        <span class=\"token comment\"># xMat:m*n  3*100   m*1 1*100</span>\n        <span class=\"token comment\"># h--&gt;预测值  (m*1)</span>\n        <span class=\"token comment\"># yMat--&gt;真实值 (m*1)</span>\n        ws_grad <span class=\"token operator\">=</span> xMat<span class=\"token punctuation\">.</span>T <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">-</span> yMat<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> m\n        <span class=\"token comment\"># print(f\"xmat.T shape{np.shape(xMat.T)}\")</span>\n        <span class=\"token comment\"># print(f\"yMat shape{np.shape(h - yMat.T)}\")</span>\n\n        <span class=\"token comment\"># print(np.shape(ws_grad))</span>\n\n        <span class=\"token comment\"># 更新ws--&gt;theta向量</span>\n        ws <span class=\"token operator\">=</span> ws <span class=\"token operator\">-</span> lr <span class=\"token operator\">*</span> ws_grad\n\n        <span class=\"token keyword\">if</span> i <span class=\"token operator\">%</span> <span class=\"token number\">50</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            costList<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>cost_<span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">,</span> yMat<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 返回theta向量ws，以及损失列表</span>\n    <span class=\"token keyword\">return</span> ws<span class=\"token punctuation\">,</span> costList\n\n\n<span class=\"token comment\"># 训练模型</span>\nws<span class=\"token punctuation\">,</span> costList <span class=\"token operator\">=</span> gradAscent<span class=\"token punctuation\">(</span>X_data<span class=\"token punctuation\">,</span> y_data<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 初始化测试集的数据</span>\nx_test <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 计算分类函数</span>\ny_test <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span>x_test<span class=\"token operator\">*</span>ws<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span>ws<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span>ws<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 绘制loss曲线</span>\n<span class=\"token comment\"># 生成0,10000</span>\nx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">10000</span><span class=\"token punctuation\">,</span><span class=\"token number\">201</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>costList<span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"epochs\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">\"Cost\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"brown\" size=\"4\">损失曲线如图所示：<br/>       <img alt=\"在这里插入图片描述\" src=\"image\\d4bca8978c8d422d95590ec77231abf1.png\"/><br/> <font color=\"red\" size=\"4\">可见当迭代次数在2000左右时，函数的损失已经区域稳定，所以10000次迭代是绝对可靠的。</font></font></p>\n<hr/>\n<p><font color=\"brown\" size=\"4\">最终返回<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         θ\n        \n       \n       \n        \\theta\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0278em;\">θ</span></span></span></span></span>向量的列表如图所示，即我们要求的参数：<br/>           <img alt=\"在这里插入图片描述\" src=\"image\\d5f7c5409dbf4645969676c44c38f194.png\"/><br/> 所以<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ω\n        \n        \n         1\n        \n       \n       \n        \\omega1\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"mord\">1</span></span></span></span></span>值为2.05836354，<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         ω\n        \n        \n         2\n        \n       \n       \n        \\omega2\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right: 0.0359em;\">ω</span><span class=\"mord\">2</span></span></span></span></span>值为0.3510579，<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         b\n        \n       \n       \n        b\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span>值为-0.36341304。</font></p>\n<hr/>\n<h1><a id=\"6python_179\"></a>6.python梯度下降实现非线性逻辑回归</h1>\n<p><font color=\"brown\" size=\"4\">python梯度下降实现非线性逻辑回归代码示例如下：</font></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> seaborn <span class=\"token keyword\">as</span> sns\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>metrics <span class=\"token keyword\">import</span> classification_report\n<span class=\"token keyword\">from</span> sklearn<span class=\"token punctuation\">.</span>preprocessing <span class=\"token keyword\">import</span> PolynomialFeatures\n\n\n<span class=\"token comment\"># 读取数据</span>\ndata <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>genfromtxt<span class=\"token punctuation\">(</span><span class=\"token string\">\"data2.txt\"</span><span class=\"token punctuation\">,</span> delimiter<span class=\"token operator\">=</span><span class=\"token string\">\",\"</span><span class=\"token punctuation\">)</span>\n\nx_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\ny_data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">]</span>\n\n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nsns<span class=\"token punctuation\">.</span>scatterplot<span class=\"token punctuation\">(</span>x<span class=\"token operator\">=</span><span class=\"token string\">\"x1\"</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">=</span><span class=\"token string\">\"x2\"</span><span class=\"token punctuation\">,</span> data<span class=\"token operator\">=</span>df<span class=\"token punctuation\">,</span> hue<span class=\"token operator\">=</span><span class=\"token string\">\"y\"</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"brown\" size=\"4\">首先准备一组数据，其中有两个特征，一组标签，标签分为0和1两类。绘制出数据分布散点图如下图所示：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\8274c0e1e6324460b917e0197354b898.png\"/><br/> <font color=\"brown\" size=\"4\">其中，蓝色点表示0类，黄色点表示1类。<br/> 则这里的回归过程需要涉及多项式。</font></font></p>\n<hr/>\n<p><font color=\"purple\" size=\"4\">接下来定义损失函数和梯度下降求解的函数。代码入下所示：</font></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">cost_</span><span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">,</span> yMat<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 进行相乘</span>\n    left <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>multiply<span class=\"token punctuation\">(</span>yMat<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span>sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    right <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>multiply<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> yMat<span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>log<span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">-</span> sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>left <span class=\"token operator\">+</span> right<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token operator\">-</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\"># 定义梯度下降求解θ</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">gradAscent</span><span class=\"token punctuation\">(</span>xArr<span class=\"token punctuation\">,</span> yArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 将ndarry类型转为矩阵</span>\n    xMat <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>xArr<span class=\"token punctuation\">)</span>\n    yMat <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>yArr<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 初始化学习率</span>\n    lr <span class=\"token operator\">=</span> <span class=\"token number\">0.001</span>\n    <span class=\"token comment\"># 初始化迭代次数</span>\n    epochs <span class=\"token operator\">=</span> <span class=\"token number\">10000</span>\n    m<span class=\"token punctuation\">,</span> n <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">)</span>\n    ws <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>ones<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    costList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\"># 迭代</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>epochs <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        h <span class=\"token operator\">=</span> sigmoid_<span class=\"token punctuation\">(</span>xMat <span class=\"token operator\">*</span> ws<span class=\"token punctuation\">)</span>\n        ws_grad <span class=\"token operator\">=</span> xMat<span class=\"token punctuation\">.</span>T <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">-</span> yMat<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> m\n        <span class=\"token comment\"># 更新ws--&gt;theta向量</span>\n        ws <span class=\"token operator\">=</span> ws <span class=\"token operator\">-</span> lr <span class=\"token operator\">*</span> ws_grad\n        <span class=\"token keyword\">if</span> i <span class=\"token operator\">%</span> <span class=\"token number\">50</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            costList<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>cost_<span class=\"token punctuation\">(</span>xMat<span class=\"token punctuation\">,</span> yMat<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># 返回theta向量ws，以及损失列表</span>\n    <span class=\"token keyword\">return</span> ws<span class=\"token punctuation\">,</span> costList\n</code></pre>\n<hr/>\n<p><font color=\"brown\" size=\"4\">将最高次项设定为3次项，并将原数据转换为多项式数据，然后梯度下降求解：</font></p>\n<pre><code class=\"prism language-python\">poly_reg <span class=\"token operator\">=</span> PolynomialFeatures<span class=\"token punctuation\">(</span>degree<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nx_poly <span class=\"token operator\">=</span> poly_reg<span class=\"token punctuation\">.</span>fit_transform<span class=\"token punctuation\">(</span>x_data<span class=\"token punctuation\">)</span>\nws<span class=\"token punctuation\">,</span> costList <span class=\"token operator\">=</span> gradAscent<span class=\"token punctuation\">(</span>x_poly<span class=\"token punctuation\">,</span> y_data<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 输出求解结果（假设两个特征的名字分别为x1,x2）</span>\npoint <span class=\"token operator\">=</span> poly_reg<span class=\"token punctuation\">.</span>get_feature_names_out<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'x1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'x2'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>point<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><font color=\"brown\" size=\"4\">则求解情况如下图所示：<br/>  <img alt=\"在这里插入图片描述\" src=\"image\\c5bfe8c2c60642e3a9a300b80079e13f.png\"/></font></p>\n<hr/>\n<p><font color=\"brown\" size=\"4\">这里不再额外准备数据了，还使用原训练样本数据，来进行预测，目的在于体现代码及逻辑：</font></p>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 定义预测函数</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">predict_</span><span class=\"token punctuation\">(</span>x_data<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 首先将ndarray转换为matrix</span>\n    xMat <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>x_data<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 将theta转变为矩阵</span>\n    ws <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mat<span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 以0.5为阈值，h(x)&gt;5则1，否则为0</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span> <span class=\"token keyword\">if</span> x <span class=\"token operator\">&gt;=</span> <span class=\"token number\">0.5</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> sigmoid_<span class=\"token punctuation\">(</span>xMat<span class=\"token operator\">*</span>ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\"># 预测</span>\npred <span class=\"token operator\">=</span> predict_<span class=\"token punctuation\">(</span>x_poly<span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>pred<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 输出报告</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>classification_report<span class=\"token punctuation\">(</span>y_data<span class=\"token punctuation\">,</span> pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p>预测结果与评估报告输出如下：<br/>   <img alt=\"在这里插入图片描述\" src=\"image\\c923b3b79b824925a7a47348b9c69d42.png\"/></p>\n<hr/>\n<p><font color=\"red\" size=\"5\">本次分享就到这里，小啾感谢您的关注与支持！<br/> 🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ🌹꧔ꦿ</font></p>\n<blockquote>\n<p><font color=\"purple\" size=\"4\">本专栏更多好文欢迎点击下方连接：<br/>  <br/> 1.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/122967282\">初识机器学习前导内容_你需要知道的基本概念罗列_以PY为工具 【Python机器学习系列（一）】</a><br/>  <br/> 2.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/122921512\">sklearn库数据标准预处理合集_【Python机器学习系列（二）】</a><br/>  <br/> 3.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/122896585\">K_近邻算法_分类Ionosphere电离层数据【python机器学习系列（三）】</a><br/>  <br/> 4.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/126194659\">python机器学习 一元线性回归 梯度下降法的实现 【Python机器学习系列（四）】</a><br/>  <br/> 5.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/126217014\">sklearn实现一元线性回归 【Python机器学习系列（五）】</a><br/>  <br/> 6.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/126217379\">多元线性回归_梯度下降法实现【Python机器学习系列（六）】</a><br/>  <br/> 7.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/126221430\">sklearn实现多元线性回归 【Python机器学习系列（七）】</a><br/>  <br/> 8.<a href=\"https://skylarkprogramming.blog.csdn.net/article/details/126222929\">sklearn实现多项式线性回归_一元/多元 【Python机器学习系列（八）】</a><br/>  </font></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}