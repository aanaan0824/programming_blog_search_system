{"blogid": "126732114", "writerAge": "码龄6年", "writerBlogNum": "79", "writerCollect": "23", "writerComment": "4", "writerFan": "11", "writerGrade": "4级", "writerIntegral": "814", "writerName": "永远是深夜该多好。", "writerProfileAdress": "writer_image\\profile_126732114.jpg", "writerRankTotal": "24658", "writerRankWeekly": "20543", "writerThumb": "14", "writerVisitNum": "28049", "blog_read_count": "10", "blog_time": "已于 2022-09-07 11:32:12 修改", "blog_title": "HTB-RouterSpace", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\35be85603ae04466a817ccdae9e98116.png\"/><br/> </p>\n<div class=\"toc\">\n<h3>HTB-RouterSpace</h3>\n</div>\n<p></p>\n<blockquote>\n<p><strong>这个机器有点意思。</strong></p>\n</blockquote>\n<p>nmap<br/> <img alt=\"\" src=\"image\\77c11f082d7647f49a761fa34ae532d1.png\"/><br/> 目录扫描没有什么特别的。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\562c71d5d2c246138d0dee866db9ad52.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\864e5fe0d8f14d688ec7ffb4ce5e21ca.png\"/></p>\n<p>源码也没有什么特别的。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\f1bb964957a644dda960d6e825a084df.png\"/><br/> 这个网站提供下载一个<code>APK</code>。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\8ce86b4afa2241b19300c79ee46201ba.png\"/><br/> JEB逆向也没看出个什么东西。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\7b01c6fd50784b9ca145ecd4f073094d.png\"/><br/> 用虚拟机安装apk（因为电脑缘故选择备用机安装），估计是要配合目标靶机进行连接。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e3122b7107f943bfb903acbd7f3279ea.jpeg\"/><br/> 但是没有发现能够进行的操作，于是想抓一下包试试。看了看本地IP。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\10030f56ecde4308916a745c64c3b4a7.png\"/><br/> 先让电脑和手机处于同一个网络下，然后burp suite设置好代理。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\77d81d639ead4d1aa28ab93d0dc523de.png\"/></p>\n<p>然后设置好手机代理与特别地址一样<img alt=\"在这里插入图片描述\" src=\"image\\a1ff784eb52b462a9c3487d945a43559.png\"/><br/> 电脑输入对应ip和端口下载证书，并在手机上安装。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\3a62f58507d7425a8e8ac08218f44775.png\"/><img alt=\"在这里插入图片描述\" src=\"image\\bcb8d017f91543bdbf844150b7bf2c9b.jpeg\"/></p>\n<p>然后顺利抓包。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b22d9a15b46d4ae18e98321416d5abaa.png\"/><br/> 丢进<code>repeater</code>继续测试。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e40e5559767b4a6e89a321bb8f21eb4f.png\"/><br/> IP改成127.0.0.1后得到反馈。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\faf32c359a3e490d87d5639055124b69.png\"/></p>\n<p>然后就没然后了，测试一下IP能接受的输入字符，发现<code>;</code>会出现与众不同的反馈。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\81ee5d33950b48c19ee469d62613c1a2.png\"/><br/> 加上<code>id</code>试试。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\cff66d46d2194b129e484fe5c0f43cc6.png\"/><br/> 尝试反弹，没有反应猜测进行了过滤。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\8d9644d71213433dbc70dd2cf5716392.png\"/><br/> <code>ping</code> 也是。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\5e240b78170c4fcb8d25a2194308581d.png\"/></p>\n<p><code>.ssh</code>文件也是空的。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e32be5335f76424bb92f4e75f9e46883.png\"/></p>\n<p>可以考虑攻击端生成ssh私钥和公钥，公钥上传到靶机再用生成时输入的密码登录应该就可以。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\40f2d230c5744b21a51b065665a4f971.png\"/><br/> 因为有防火墙所以直接上传可能性不大，考虑复制后在<code>burp suite</code>里面复制进去。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\76011daaf0774c8c94e33039733a8190.png\"/><br/> 将公钥放入<code>用户/.ssh/authorized_keys</code>里面。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\528c6508127246fa8f0db5f64c685def.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\35370924d706452d84d96e74073e3fb8.png\"/><br/> 然后用私钥和密码配合ssh。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\bd85817cd8bf493da4d53f8106a4f583.png\"/><br/> 不知道为什么这个shell异常的卡。由于前面有防火墙的缘故，所以无法使用wget上传。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\7f729c5006954c1185f37323a7237abf.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\c26b438d2cd84efd8401328ff2aab79f.png\"/><br/> 使用LinEnum.sh暂时没发现有用信息，使用linpeas.sh发现了与sudo的版本有关的CVE。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\5c5666de64444bb2be0eb7f61ef5c3f1.png\"/><br/> 找到几个利用脚本.<br/> <img alt=\"在这里插入图片描述\" src=\"image\\49e47b88f9c44adcbc371d4ed1c2df92.png\"/><br/> 还有这个<a href=\"https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit\">利用</a>。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\25b9fd19a8124d399044dcce62c006fa.png\"/><br/> 吧需要的文件<code>scp</code>过去。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b6677b62d2324ace92816d2011c0a0b4.png\"/></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\862cb8d3a56c40fdad49640f47a9d0a2.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}