{"blogid": "125580619", "writerAge": "ç é¾„2å¹´", "writerBlogNum": "58", "writerCollect": "6726", "writerComment": "5568", "writerFan": "20372", "writerGrade": "7çº§", "writerIntegral": "11788", "writerName": "å°å¨è¦å‘è¯¸ä½¬å­¦ä¹ å‘€", "writerProfileAdress": "writer_image\\profile_125580619.jpg", "writerRankTotal": "915", "writerRankWeekly": "9", "writerThumb": "4548", "writerVisitNum": "232335", "blog_read_count": "6884", "blog_time": "å·²äºÂ 2022-07-15 10:30:23Â ä¿®æ”¹", "blog_title": "ã€äº‘åŸç”Ÿã€‘å¾®æœåŠ¡ä¹‹Feignçš„ä»‹ç»ä¸ä½¿ç”¨", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>å‰è¨€ï¼š<br/> æœ€è¿‘åœ¨å­¦ä¹ å¾®æœåŠ¡ç›¸å…³çš„çŸ¥è¯†ï¼Œçœ‹äº†é»‘é©¬çš„ç›¸å…³è¯¾ç¨‹ï¼Œå°†å…³äºFeignçš„çŸ¥è¯†åˆæ€»ç»“äº†ä¸€äº›ï¼Œå¸Œæœ›èƒ½å¸®åˆ°å„ä½å°ä¼™å„¿ä»¬ä»¥åŠåŠ æ·±ä¸‹è‡ªå·±çš„å°è±¡ğŸŠ<br/> å¦‚æœæ–‡ç« æœ‰ä»€ä¹ˆéœ€è¦æ”¹è¿›çš„åœ°æ–¹è¿˜è¯·å¤§ä½¬å¤šå¤šæŒ‡æ•™ğŸ¥‚<br/> å°å¨å…ˆæ„Ÿè°¢å¤§å®¶çš„æ”¯æŒäº†ğŸ˜<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"https://img-blog.csdnimg.cn/19466b4656e841c085c6ccea20f7e549.gif#pic_center\"/></p>\n<blockquote>\n<p>ğŸ ä¸ªäººä¸»é¡µï¼š<a href=\"https://blog.csdn.net/qq_53847859?spm=1011.2415.3001.5343\">å°å¨è¦å‘è¯¸ä½¬å­¦ä¹ å‘€</a><br/> ğŸ§‘ä¸ªäººç®€ä»‹ï¼šå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°å¨ï¼Œä¸€ä¸ªæƒ³è¦ä¸å¤§å®¶å…±åŒè¿›æ­¥çš„ç”·äººğŸ˜‰ğŸ˜‰<br/> ç›®å‰çŠ¶å†µğŸ‰ï¼šç›®å‰å¤§äºŒï¼Œåœ¨ä¸€å®¶æ»¡æ„çš„å…¬å¸å®ä¹ ğŸ‘ğŸ‘</p>\n<p>ğŸå¦‚æœå¤§ä½¬åœ¨å‡†å¤‡é¢è¯•ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘æ‰¾å®ä¹ å‰ç”¨çš„åˆ·é¢˜ç¥å™¨å“¦<a href=\"https://www.nowcoder.com/link/pc_csdncpt_xiaowei_sf\">åˆ·é¢˜ç¥å™¨ç‚¹è¿™é‡Œå“Ÿ</a><br/> ğŸ’•æ¬¢è¿å¤§å®¶ï¼šè¿™é‡Œæ˜¯CSDNï¼Œæˆ‘æ€»ç»“çŸ¥è¯†çš„åœ°æ–¹ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ï¼Œæˆ‘äº²çˆ±çš„å¤§ä½¬ğŸ˜˜</p>\n</blockquote>\n<p>ç‰›å®¢éƒ¨åˆ†ä½¿ç”¨åé¦ˆï¼Œä¸ªäººæ„Ÿè§‰è¿˜ä¸é”™ï¼Œå¸®æˆ‘æ‰¾åˆ°äº†å¿ƒä»ªçš„å…¬å¸ï¼Œå¸Œæœ›å„ä½ä¼™ä¼´å„¿ä»¬é€šè¿‡å®ƒä¹Ÿèƒ½æé«˜ä¸å°‘ğŸ¥‚ğŸ¥‚ğŸ¥‚</p>\n<p>ä»¥ä¸‹æ­£æ–‡å¼€å§‹</p>\n<p></p>\n<div class=\"toc\">\n<h3>æ–‡ç« ç›®å½•</h3>\n<ul><li><a href=\"#Feign_19\">ğŸš“Feignçš„ç®€ä»‹</a></li><li><a href=\"#Feign_27\">ğŸš—Feignçš„ä¼˜ç‚¹</a></li><li><a href=\"#Feign_41\">ğŸš•Feignå¦‚ä½•ä½¿ç”¨</a></li><li><a href=\"#Feign_103\">ğŸš™Feignçš„ä½¿ç”¨æ€»ç»“</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"Feign_19\"></a>ğŸš“Feignçš„ç®€ä»‹</h1>\n<p>Feign æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„ä¼ªRPCçš„RESTå®¢æˆ·ç«¯ï¼Œå®ƒç”¨äº†åŸºäºæ¥å£çš„æ³¨è§£æ–¹å¼ï¼Œå¾ˆæ–¹ä¾¿çš„å®¢æˆ·ç«¯é…ç½®ï¼ŒSpring Cloud ç»™ Feign æ·»åŠ äº†æ”¯æŒSpring MVCæ³¨è§£ï¼Œå¹¶æ•´åˆRibbonåŠEurekaè¿›è¡Œæ”¯æŒè´Ÿè½½å‡è¡¡ã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\b8a6f60677ce427fa058fbe2cb76480a.jpeg\"/></p>\n<p>Feign æ˜¯â¼€ä¸ª HTTP è¯·æ±‚çš„è½»é‡çº§å®¢æˆ·ç«¯æ¡†æ¶ã€‚é€šè¿‡æ¥â¼å£å’Œæ³¨è§£çš„â½…å¼å‘èµ· HTTP è¯·æ±‚è°ƒâ½¤ï¼Œ<strong>é¢å‘æ¥å£ç¼–ç¨‹</strong>ï¼Œå¹¶ä¸æ˜¯åƒ Java ä¸­é€šè¿‡å°è£… HTTP è¯·æ±‚æŠ¥â½‚çš„â½…å¼ç›´æ¥è°ƒâ½¤ã€‚<br/> æœåŠ¡æ¶ˆè´¹â½…æ‹¿åˆ°æœåŠ¡æä¾›â½…çš„æ¥â¼ï¼Œç„¶ååƒè°ƒâ½¤æœ¬åœ°æ¥â¼â½…æ³•â¼€æ ·å»è°ƒâ½¤ï¼Œå®é™…å‘å‡ºçš„æ˜¯è¿œç¨‹çš„è¯·æ±‚ã€‚è®©æˆ‘ä»¬æ›´åŠ ä¾¿æ·å’Œä¼˜é›…çš„å»è°ƒâ½¤åŸºäº HTTP çš„ APIï¼Œè¢«â¼´æ³›åº”â½¤åœ¨ Spring Cloud çš„è§£å†³â½…æ¡ˆä¸­ã€‚</p>\n<h1><a id=\"Feign_27\"></a>ğŸš—Feignçš„ä¼˜ç‚¹</h1>\n<p>ä¹‹å‰æˆ‘ä»¬åˆ©ç”¨RestTemplateå‘èµ·è¿œç¨‹è°ƒç”¨çš„ä»£ç ï¼š</p>\n<pre><code class=\"prism language-java\"><span class=\"token class-name\">String</span> url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://userservice/user/\"</span> <span class=\"token operator\">+</span> order<span class=\"token punctuation\">.</span><span class=\"token function\">getUserld</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> restTemplate<span class=\"token punctuation\">.</span><span class=\"token function\">getForObject</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token class-name\">User</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>ä¸Šé¢çš„å­˜åœ¨çš„é—®é¢˜æœ‰ä»£ç ï¼š<br/> å¯è¯»æ€§å·®ï¼Œç¼–ç¨‹ä½“éªŒä¸ç»Ÿä¸€ï¼›<br/> å‚æ•°å¤æ‚URLéš¾ä»¥ç»´æŠ¤<br/> Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„httpå®¢æˆ·ç«¯ï¼Œå®˜æ–¹åœ°å€ï¼š<a href=\"https://github.com/OpenFeign/feign\">Feignå®˜æ–¹é“¾æ¥</a></p>\n<p>å…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬ä¼˜é›…çš„å®ç°httpè¯·æ±‚çš„å‘é€ï¼Œè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚</p>\n<h1><a id=\"Feign_41\"></a>ğŸš•Feignå¦‚ä½•ä½¿ç”¨</h1>\n<p>è¿˜æ˜¯ä»¥æˆ‘ä»¬ä¹‹å‰çš„é¡¹ç›®ä¸ºä¾‹<br/> åœ¨order-serviceæœåŠ¡çš„pomæ–‡ä»¶ä¸­å¼•å…¥feignä¾èµ–ï¼š</p>\n<pre><code class=\"prism language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>org.springframework.cloud<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>spring-cloud-starter-openfeign<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">&gt;</span></span>\n</code></pre>\n<p>åœ¨order-serviceçš„å¯åŠ¨ç±»æ·»åŠ æ³¨è§£å¼€å¯Feignçš„åŠŸèƒ½ï¼š</p>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@EnableFeignClients</span>\n<span class=\"token annotation punctuation\">@MapperScan</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cn.itcast.order,mapper\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@SpringBootApplication</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">OrderApplication</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>\n<span class=\"token class-name\">SpringApplication</span><span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">OrderApplication</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">,</span>args<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>åœ¨order-serviceä¸­æ–°å»ºä¸€ä¸ªæ¥å£ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">cn<span class=\"token punctuation\">.</span>itcast<span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">.</span>client</span><span class=\"token punctuation\">;</span>â€‹\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">cn<span class=\"token punctuation\">.</span>itcast<span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">.</span>pojo<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">User</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>cloud<span class=\"token punctuation\">.</span>openfeign<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">FeignClient</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">GetMapping</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">PathVariable</span><span class=\"token punctuation\">;</span>\nâ€‹<span class=\"token annotation punctuation\">@FeignClient</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"userservice\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UserClient</span> <span class=\"token punctuation\">{<!-- --></span>   \n  <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/user/{id}\"</span><span class=\"token punctuation\">)</span>   \n  <span class=\"token class-name\">User</span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@PathVariable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>è¿™ä¸ªå®¢æˆ·ç«¯ä¸»è¦æ˜¯åŸºäºSpringMVCçš„æ³¨è§£æ¥å£°æ˜è¿œç¨‹è°ƒç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p>\n<ul><li>æœåŠ¡åç§°ï¼šuserservice</li><li>è¯·æ±‚æ–¹å¼ï¼šGET</li><li>è¯·æ±‚è·¯å¾„ï¼š/user/{id}</li><li>è¯·æ±‚å‚æ•°ï¼šLong id</li><li>è¿”å›å€¼ç±»å‹ï¼šUser</li></ul>\n<p>è¿™æ ·ï¼ŒFeignå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘é€httpè¯·æ±‚ï¼Œæ— éœ€è‡ªå·±ä½¿ç”¨RestTemplateæ¥å‘é€äº†ã€‚</p>\n<p>æˆ‘ä»¬ä¿®æ”¹order-serviceä¸­çš„OrderServiceç±»ä¸­çš„queryOrderByIdæ–¹æ³•ï¼Œä½¿ç”¨Feignå®¢æˆ·ç«¯ä»£æ›¿RestTemplateï¼š</p>\n<pre><code class=\"prism language-java\"><span class=\"token annotation punctuation\">@Autowired</span>\n<span class=\"token keyword\">private</span> <span class=\"token class-name\">UserClient</span> userClient<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">Order</span> <span class=\"token function\">query0rderById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> orderId<span class=\"token punctuation\">)</span> \n<span class=\"token comment\">//1.æŸ¥è¯¢è®¢å•</span>\n<span class=\"token class-name\">Order</span> order <span class=\"token operator\">=</span> orderMapper<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>orderId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//2. åˆ©ç”¨Feignå‘èµ·httpè¯·æ±‚ æŸ¥è¯¢ç”¨æˆ·</span>\n<span class=\"token class-name\">Useruser</span> <span class=\"token operator\">=</span> userClient<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">.</span><span class=\"token function\">getUserId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//3.å°è£…useråˆ°0rder</span>\norder<span class=\"token punctuation\">.</span><span class=\"token function\">setUser</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 4.è¿”å›</span>\n<span class=\"token keyword\">return</span> order<span class=\"token punctuation\">;</span>\n\n</code></pre>\n<h1><a id=\"Feign_103\"></a>ğŸš™Feignçš„ä½¿ç”¨æ€»ç»“</h1>\n<p>ä½¿ç”¨Feignçš„æ­¥éª¤ï¼š</p>\n<p>ç¬¬â‘ æ­¥ å¼•å…¥ä¾èµ–</p>\n<p>ç¬¬â‘¡æ­¥ æ·»åŠ @EnableFeignClientsæ³¨è§£</p>\n<p>ç¬¬â‘¢æ­¥ ç¼–å†™FeignClientæ¥å£</p>\n<p>ç¬¬â‘£æ­¥ ä½¿ç”¨FeignClientä¸­å®šä¹‰çš„æ–¹æ³•ä»£æ›¿RestTemplate<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"https://img-blog.csdnimg.cn/1320344f9e094379ba313311b49521d5.gif#pic_center\"/></p>\n<blockquote>\n<p>æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¦‚æœæœ‰ä»€ä¹ˆç–‘é—®çš„åœ°æ–¹è¯·æŒ‡å‡ºï¼Œè¯¸ä½¬ä»¬ä¸€èµ·è®¨è®ºğŸ»<br/> æœ€åå†æ¬¡ç»™å¤§å®¶å®‰åˆ©ä¸€æ³¢ç‰›å®¢ï¼Œç‚¹å‡»<a href=\"https://www.nowcoder.com/link/pc_csdncpt_xiaowei_sf\">åˆ·é¢˜ç¥å™¨</a><br/> æ³¨å†Œç‰›å®¢ï¼Œå¿«æ¥å’Œåšä¸»ä¸€èµ·åˆ·é¢˜å§å˜¿å˜¿å˜¿ğŸ‘ å†æ¬¡æ„Ÿè°¢å„ä½å°ä¼™ä¼´å„¿ä»¬çš„æ”¯æŒğŸ¤</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\5ee09ff91e044d7680f20f51cc521887.jpeg\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}