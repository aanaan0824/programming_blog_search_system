{"blogid": "126290039", "writerAge": "码龄2年", "writerBlogNum": "400", "writerCollect": "2826", "writerComment": "729", "writerFan": "20912", "writerGrade": "6级", "writerIntegral": "8202", "writerName": "前端江太公", "writerProfileAdress": "writer_image\\profile_126290039.jpg", "writerRankTotal": "2039", "writerRankWeekly": "347", "writerThumb": "1466", "writerVisitNum": "622921", "blog_read_count": "1603", "blog_time": "已于 2022-08-11 18:24:29 修改", "blog_title": "Python自动抢购脚本，学废了双十一双十二帮女票抢购心爱的礼物，隔壁女孩都馋哭了。", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>Python版本：3.10</p>\n<p>分享一个秒杀抢购的脚本程序，感兴趣的朋友一起看看吧</p>\n</blockquote>\n<p>第一步：需要把想要的商品加进购物车<code>（ 此脚本是对购物车内全部商品进行下单操作，所以不够买的商品最好先从购物车内删除。）</code></p>\n<p>第二步：写好Python脚本，在抢购之前运行，并设置好抢购时间。<br/> </p>\n<div class=\"toc\">\n<h3>目录标题</h3>\n<ul><li><ul><li><ul><li><a href=\"#1Python3_8\">1、安装Python3</a></li><li><a href=\"#2Pycharm_16\">2、集成开发环境：Pycharm</a></li><li><a href=\"#3webdriver_24\">3、安装webdriver扩展。</a></li><li><a href=\"#4chrome_34\">4、安装chrome浏览器，没谷歌写什么程序</a></li><li><a href=\"#5chromedriver_35\">5、安装chromedriver。</a></li><li><a href=\"#6_54\">6、上代码</a></li><li><a href=\"#_125\">补充说明：</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h3><a id=\"1Python3_8\"></a>1、安装Python3</h3>\n<p>下载链接: <a href=\"https://www.python.org/\">https://www.python.org/</a></p>\n<p>检查 Python3 是否正常可用：python3 -V</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\036d903effb1410480f09df75797d75b.png\"/></p>\n<h3><a id=\"2Pycharm_16\"></a>2、集成开发环境：Pycharm</h3>\n<p>下载链接: <a href=\"https://www.jetbrains.com/pycharm/download/#section=windows\">https://www.jetbrains.com/pycharm/download/#section=windows</a></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\47d61ea41a844a87a23983f2bb4a0c6d.png\"/></p>\n<p>你用vscode也行！</p>\n<h3><a id=\"3webdriver_24\"></a>3、安装webdriver扩展。</h3>\n<p>它是Selenium模块的一部分。Selenium是一个用于Web应用程序测试的工具，用于测试你的应用程序看是否能够很好得工作在不同浏览器和操作系统之上。Selenium测试直接运行在浏览器中，就像真正的用户在操作一样。所以其实就是<strong>安装Selenium</strong>：Win+R，输入cmd，在命令行中输入<code>pip show selenium</code>。</p>\n<p><code>pip</code>：python包管理工具，提供了对Python 包的查找、下载、安装、卸载的功能。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\542591c9e0f047be8a31aa4da3e9e03b.png\"/></p>\n<p><strong>注：pip 已内置于 Python 3.4 和 2.7 及以上版本，其他版本需另行安装。</strong></p>\n<h3><a id=\"4chrome_34\"></a>4、安装chrome浏览器，没谷歌写什么程序</h3>\n<h3><a id=\"5chromedriver_35\"></a>5、安装chromedriver。</h3>\n<p>它是chrome的插件，是为了webDriver能通过操作chromedriver来控制chrome浏览器自动操作，如打开网页，点击按钮等操作。</p>\n<p>下载地址：<br/> http://chromedriver.storage.googleapis.com/index.html或者https://npm.taobao.org/mirrors/chromedriver/</p>\n<p><strong>注意：下载时要根据电脑系统和chrome浏览器版本来选择对应的chromedriver版本。</strong></p>\n<p>可以通过浏览器右上角的三点→帮助→关于Google Chrome来查看自己的chrome版本。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\dd4b26b1f6c3489ab7da7eaf44148e28.png\"/></p>\n<p>下载chromedriver安装包后，进行解压，放在chrome安装的同级目录下，同时在环境变量PATH中添加路径。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\2dba35a146494b1e8cef352e7474ee13.png\"/></p>\n<h3><a id=\"6_54\"></a>6、上代码</h3>\n<pre><code class=\"prism language-python\">\n<span class=\"token comment\"># coding=utf-8</span>\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver\n<span class=\"token keyword\">import</span> datetime\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">from</span> os <span class=\"token keyword\">import</span> path\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>chrome<span class=\"token punctuation\">.</span>service <span class=\"token keyword\">import</span> Service\n<span class=\"token keyword\">from</span> selenium<span class=\"token punctuation\">.</span>webdriver<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>by <span class=\"token keyword\">import</span> By\n\n<span class=\"token comment\">#此处chromedriver改为自己下载解压的chromedriver的路径</span>\ns <span class=\"token operator\">=</span> Service<span class=\"token punctuation\">(</span><span class=\"token string\">'C:/Users/wzyh/AppData/Local/Google/Chrome/Application/chromedriver'</span><span class=\"token punctuation\">)</span>\ndriver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>service<span class=\"token operator\">=</span>s<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#driver.maximize_window()</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">#打开淘宝首页，扫码登陆淘宝</span>\n    driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://www.taobao.com\"</span><span class=\"token punctuation\">)</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>LINK_TEXT<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'亲，请登录'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>LINK_TEXT<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'亲，请登录'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请在30秒内完成扫码登录...\"</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#打开购物车列表首页</span>\n        driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">\"https://cart.taobao.com/cart.htm\"</span><span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">#全选购物车</span>\n    <span class=\"token keyword\">if</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'J_SelectAll1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'J_SelectAll1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    now <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login success:\"</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%Y-%m-%d %H:%M:%S\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">buy</span><span class=\"token punctuation\">(</span>times<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\">#记录当前时间，使用datatime内置模块</span>\n        now <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">\"%Y-%m-%d %H:%M:%S\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>times<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 对比时间，时间到的话就点击结算</span>\n        <span class=\"token keyword\">if</span> now <span class=\"token operator\">==</span> times<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">if</span> driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'J_Go'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                    driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>ID<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'J_Go'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    driver<span class=\"token punctuation\">.</span>find_element<span class=\"token punctuation\">(</span>by<span class=\"token operator\">=</span>By<span class=\"token punctuation\">.</span>LINK_TEXT<span class=\"token punctuation\">,</span> value<span class=\"token operator\">=</span><span class=\"token string\">'提交订单'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'抢购成功，请尽快付款'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n                 <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'请再次尝试提交订单'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    times <span class=\"token operator\">=</span> <span class=\"token builtin\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入抢购时间(例如格式：2022-08-11 12:00:00):\"</span><span class=\"token punctuation\">)</span>\n    login<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    buy<span class=\"token punctuation\">(</span>times<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>直接运行</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\d6be924fd47d4e3b9c57d16cc27d3107.png\"/><br/> 输入时间 并回车</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\96ff485642da4ab9afd6000d24c5487e.png\"/></p>\n<p>这时候会弹出一个谷歌窗口，并跳转淘宝登录页，我设置的时间是30秒，30秒内没登录就退出进程了。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\8144506bc4d24c75b8f7f1e407ec4a85.png\"/></p>\n<h3><a id=\"_125\"></a>补充说明：</h3>\n<p>selenium4.0中的find_element方法老版本跟新版本写法不一样<br/> <img alt=\"在这里插入图片描述\" src=\"image\\6dfd964f5c464bd79b511e36dd86da01.png\"/><br/> 可以看到，上面那个<code>find_element_by_link_text</code>已被划上横线，表示已经弃用，改用新方法<code>find_element(by=By.LINK_TEXT, value='亲，请登录')</code></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a38cd91cefc7418eb6b8953df77cbce6.png\"/><br/> 目前此脚本不支持自动stop，只能手动stop。有时间弄个京东的，抢茅台。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}