{"blogid": "124522705", "writerAge": "码龄1年", "writerBlogNum": "97", "writerCollect": "227", "writerComment": "13", "writerFan": "23", "writerGrade": "4级", "writerIntegral": "1043", "writerName": "Gigi Princess", "writerProfileAdress": "writer_image\\profile_124522705.jpg", "writerRankTotal": "31271", "writerRankWeekly": "282369", "writerThumb": "25", "writerVisitNum": "47847", "blog_read_count": "965", "blog_time": "于 2022-05-01 10:42:55 发布", "blog_title": "visual studio 2013更新到2019 连接 autocad2019 (c#)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"%E4%B8%80%E3%80%81%E5%B0%9D%E8%AF%95%E7%94%A8vs2013%E8%BF%9E%E6%8E%A5autocad2019-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%B8%80%E3%80%81%E5%B0%9D%E8%AF%95%E7%94%A8vs2013%E8%BF%9E%E6%8E%A5autocad2019\">一、尝试用vs2013连接autocad2019</a></p>\n<p id=\"1%E3%80%81%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0%E4%BA%86%E9%94%99%E8%AF%AF-toc\" style=\"margin-left:80px;\"><a href=\"#1%E3%80%81%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0%E4%BA%86%E9%94%99%E8%AF%AF\">1、运行时候出现了错误</a></p>\n<p id=\"2%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E8%AF%A2.netframework%E7%89%88%E6%9C%AC-toc\" style=\"margin-left:80px;\"><a href=\"#2%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E8%AF%A2.netframework%E7%89%88%E6%9C%AC\">2、如何查询.netframework版本</a></p>\n<p id=\"%E4%BA%8C%E3%80%81vs2013%E6%9B%B4%E6%96%B0%E5%88%B0vs2019-toc\" style=\"margin-left:40px;\"><a href=\"#%E4%BA%8C%E3%80%81vs2013%E6%9B%B4%E6%96%B0%E5%88%B0vs2019\">二、vs2013更新到vs2019</a></p>\n<p id=\"1%E3%80%81%E5%AE%8C%E5%85%A8%E5%B9%B2%E5%87%80%E7%9A%84%E5%8D%B8%E8%BD%BDvs2013-toc\" style=\"margin-left:80px;\"><a href=\"#1%E3%80%81%E5%AE%8C%E5%85%A8%E5%B9%B2%E5%87%80%E7%9A%84%E5%8D%B8%E8%BD%BDvs2013\">1、完全干净的卸载vs2013</a></p>\n<p id=\"2%E3%80%81%E5%AE%89%E8%A3%85vs2019-toc\" style=\"margin-left:80px;\"><a href=\"#2%E3%80%81%E5%AE%89%E8%A3%85vs2019\">2、安装vs2019</a></p>\n<p id=\"3%E3%80%81%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98-toc\" style=\"margin-left:80px;\"><a href=\"#3%E3%80%81%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98\">3、运行代码出现的问题</a></p>\n<p id=\"4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-toc\" style=\"margin-left:80px;\"><a href=\"#4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95\">4、解决方法</a></p>\n<hr id=\"hr-toc\"/>\n<p>我是想用Qt连接CAD的，而且主要应用2D部分，之前找的Free CAD挺好的，只是它主要是发展3D部分，综合来看还是得用autocad，最开始我电脑里只有vs2013，因为之前出现过卸载不干净然后重做系统的大坑情况，所以一直不想动他，然后我第一次尝试用vs2013连接autocad2019。</p>\n<hr/>\n<h2 id=\"%E4%B8%80%E3%80%81%E5%B0%9D%E8%AF%95%E7%94%A8vs2013%E8%BF%9E%E6%8E%A5autocad2019\">一、尝试用vs2013连接autocad2019</h2>\n<p>按照网上的教程：<a class=\"link-info\" href=\"https://blog.csdn.net/qq_45518972/article/details/108427875\" title=\"基于C#（Visual Studio 2013）的AutoCAD2016二次开发（一）编程环境的搭建\">基于C#（Visual Studio 2013）的AutoCAD2016二次开发（一）编程环境的搭建</a></p>\n<p>（1）在vs2013中新建一个Visual C#类库；</p>\n<p>（2）在解决方案资源管理器-引用右键-添加引用-选择CAD2019里的acmgd.dll、acdbmgd.dll、accoremgd.dll</p>\n<p>（3）输入代码：代码参考了这个博客<a class=\"link-info\" href=\"https://blog.csdn.net/weixin_30387339/article/details/99540162\" title=\"C# CAD 二次开发（二） -集成开发环境VS2012+CAD2016\">C# CAD 二次开发（二） -集成开发环境VS2012+CAD2016</a>，我目前对C#一点都不懂哈哈，所以大致的将这位博主的代码搬了过来</p>\n<pre><code class=\"language-cs\">//********************\n//----------------\n//          visula studio 2013\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\n\n//********************\n//----------------\n//          acdbmgd.dll\nusing Autodesk.AutoCAD.Runtime;\nusing Autodesk.AutoCAD.LayerManager;\nusing Autodesk.AutoCAD.GraphicsInterface;\nusing Autodesk.AutoCAD.DatabaseServices;\nusing Autodesk.AutoCAD.Geometry;\nusing Autodesk.AutoCAD.Colors;\n//********************\n//----------------\n//          acmgd.dll\nusing Autodesk.AutoCAD.Windows.ToolPalette;\nusing Autodesk.AutoCAD.Windows;\nusing Autodesk.AutoCAD.EditorInput;\nusing Autodesk.AutoCAD.ApplicationServices;\n\nnamespace ClassLibrary1\n{\n    public class Class1\n    {\n        [CommandMethod(\"hello\")]\n        public static void hello()\n        {\n            Editor e = Application.DocumentManager.MdiActiveDocument.Editor;\n            e.WriteMessage(\"Helloworld\");\n        }\n    }\n}\n</code></pre>\n<hr/>\n<h3 id=\"1%E3%80%81%E8%BF%90%E8%A1%8C%E6%97%B6%E5%80%99%E5%87%BA%E7%8E%B0%E4%BA%86%E9%94%99%E8%AF%AF\">1、运行时候出现了错误</h3>\n<p>warning MSB3274: 未能解析主引用“acdbmgd”，因为它是针对“.NETFramework,Version=v4.7”框架生成的。该框架版本高于当前目标框架“.NETFramework,Version=v4.5”。</p>\n<p>warning MSB3275: 未能解析主引用“accoremgd”，因为它对程序集“Acdbmgd, Version=23.0.0.0, Culture=neutral, PublicKeyToken=null”具有间接依赖关系，而该程序集是针对“.NETFramework,Version=v4.7”框架生成的。该框架版本高于当前目标框架“.NETFramework,Version=v4.5”。</p>\n<p>类似于这样的错误我也查询的解决方法，大致的意思可能是我的vs2013内的netframwork版本太低需要更新到4.7，具体解决办法后面会介绍。我还查询了如何查询.netframework版本的方法：</p>\n<hr/>\n<h3 id=\"2%E3%80%81%E5%A6%82%E4%BD%95%E6%9F%A5%E8%AF%A2.netframework%E7%89%88%E6%9C%AC\">2、如何查询.netframework版本</h3>\n<p>C:\\Windows\\Microsoft.NET\\Framework，根据这个路径可以查看版本。我以为要自己手动更新版本，后来查询到了vs各版本和.netframework版本是对应的，具体在网上就可以查到，当时我查的时候vs2013对应的.netframework版本就是4.5，是从vs2017开始对应的才是4.7，于是我选择了将vs2013更新到vs2019。</p>\n<hr/>\n<hr/>\n<h2 id=\"%E4%BA%8C%E3%80%81vs2013%E6%9B%B4%E6%96%B0%E5%88%B0vs2019\">二、vs2013更新到vs2019</h2>\n<p>首先要卸载vs2013，再安装vs2019</p>\n<hr/>\n<h3 id=\"1%E3%80%81%E5%AE%8C%E5%85%A8%E5%B9%B2%E5%87%80%E7%9A%84%E5%8D%B8%E8%BD%BDvs2013\">1、完全干净的卸载vs2013</h3>\n<p>亲测有效，找到安装镜像内的vs_ultimate.exe路径，像我这样的在命令符窗口输入：</p>\n<p><img alt=\"\" height=\"239\" src=\"image\\4a60089f66744c4487a0ba6e60eac1a1.png\" width=\"579\"/></p>\n<pre><code>//输入命令符窗口内\nC:\\WINDOWS\\system32&gt;h:\n\nH:\\&gt;cd \"vs2013光盘\\vs install\"\n\nH:\\vs2013光盘\\vs install&gt;vs_ultimate.exe /uninstall /force</code></pre>\n<p>我的确是安装完嫌他占地方大就给删了哈哈哈，好在我U盘里还有，我愣是给挪回电脑里的，就是等待的时间很长。如果镜像文件删了没有备份，可以试试用专用软件卸载，在网上查查，总之一定要卸载干净！</p>\n<hr/>\n<h3 id=\"2%E3%80%81%E5%AE%89%E8%A3%85vs2019\">2、安装vs2019</h3>\n<p><a href=\"https://visualstudio.microsoft.com/zh-hans/\" title=\"下载官方地址：Visual Studio: 面向软件开发人员和 Teams 的 IDE 和代码编辑器\">下载官方地址：Visual Studio: 面向软件开发人员和 Teams 的 IDE 和代码编辑器</a></p>\n<p>界面上只有2022版的，需要自己找：</p>\n<p>在下载模块往下翻会有一个  <u><strong>较早的下载项</strong> </u></p>\n<p><img alt=\"\" height=\"337\" src=\"image\\d5ab5562e7514d56bd3b1e5346e3d563.png\" width=\"633\"/><img alt=\"\" height=\"591\" src=\"image\\9f0b5eb6eae440e09da209e009c84ba4.png\" width=\"925\"/></p>\n<p>跟着登录微软账号就能下载了，具体安装步骤就不演示了，昨晚十二点多开始下载安装的，等到后面直接睡着了，反正早上醒来是安装好了。</p>\n<p>然后我用vs2019打开了之前的项目，还是那些代码，</p>\n<hr/>\n<h3 id=\"3%E3%80%81%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98\">3、运行代码出现的问题</h3>\n<p>（1）warning MSB3275: 未能解析主引用“acmgd”，因为它对程序集“AcCui, Version=23.0.0.0, Culture=neutral, PublicKeyToken=null”具有间接依赖关系，而该程序集是针对“.NETFramework,Version=v4.7”框架生成的。该框架版本高于当前目标框架“.NETFramework,Version=v4.5”。</p>\n<p>（2）error CS0246: 未能找到类型或命名空间名“Autodesk”(是否缺少 using 指令或程序集引用?)</p>\n<p>（3）error CS0246: 未能找到类型或命名空间名“CommandMethod”(是否缺少 using 指令或程序集引用?)</p>\n<p>（4）warning MSB3270: 所生成项目的处理器架构“MSIL”与引用“accoremgd”的处理器架构“AMD64”不匹配。这种不匹配可能会导致运行时失败。请考虑通过配置管理器更改您的项目的目标处理器架构，以使您的项目与引用间的处理器架构保持一致，或者为引用关联一个与您的项目的目标处理器架构相符的处理器架构。</p>\n<hr/>\n<h3 id=\"4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95\">4、解决方法</h3>\n<p>右键项目选择属性</p>\n<p>（1）<strong>调试</strong>里<strong>启动外部程序</strong> ，找到<strong>acad.exe</strong></p>\n<p><img alt=\"\" height=\"233\" src=\"image\\64fb9a8e13ff461681c9e00d68982566.png\" width=\"757\"/></p>\n<p> （2）<strong>应用程序</strong>选择<strong>4.7.2 </strong></p>\n<p><img alt=\"\" height=\"341\" src=\"image\\5d7d14a1906c498ea8f1a1f92d82c034.png\" width=\"759\"/></p>\n<p>（3）生<strong>成</strong>里<strong>目标平台</strong>选择<strong>x64</strong>（主要针对第四个问题）</p>\n<p><img alt=\"\" height=\"311\" src=\"image\\2138264b9caf44738a8c57ab6d7b83a7.png\" width=\"697\"/></p>\n<p> 再运行之后直接打开了autocad2019,在命令行输入netload，选择新鲜热乎的.dll文件，再输入hello，就会出现“Helloworld\"啦~成功！！！</p>\n<p><img alt=\"\" height=\"411\" src=\"image\\1040ad8e36b549b6a2f04f3a9f9b6bcb.png\" width=\"547\"/></p>\n<p> </p>\n</div>\n</div>"}