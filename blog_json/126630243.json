{"blogid": "126630243", "writerAge": "码龄1年", "writerBlogNum": "57", "writerCollect": "25", "writerComment": "6", "writerFan": "17", "writerGrade": "3级", "writerIntegral": "614", "writerName": "zhn100703", "writerProfileAdress": "writer_image\\profile_126630243.jpg", "writerRankTotal": "29816", "writerRankWeekly": "9055", "writerThumb": "28", "writerVisitNum": "14614", "blog_read_count": "295", "blog_time": "于 2022-08-31 19:13:16 发布", "blog_title": "中国剩余定理(Chinese remainder theorem, CRT)", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<h2>考虑一个问题：一个整数除以3余2、除以5余3、除以7余2，求这个整数</h2>\n<h3>part1</h3>\n<p><strong>问题1：</strong>计算一个整数 x ，使得它满足除以3余2、除以5余3、除以7余2。</p>\n<p>如果能够找到三个整数 x_1,x_2,x_3 ，使得：</p>\n<p>x_1 除以3余2、除以5余0、除以7余0；</p>\n<p>x_2 除以3余0、除以5余3、除以7余0；</p>\n<p>x_3 除以3余0、除以5余0、除以7余2；</p>\n<p>那么令 x=x_1+x_2+x_3 ，就很容易验证这时的 x 就满足除以3余2、除以5余3、除以7余2。</p>\n<h3>part2</h3>\n<p><strong>问题1-1-1</strong>为：寻找整数 y_1 满足 y_1 除以3余1、除以5余0、除以7余0；</p>\n<p><strong>问题1-2-1</strong>为：寻找整数 y_2 满足 y_2 除以3余0、除以5余1、除以7余0；</p>\n<p><strong>问题1-3-1</strong>为：寻找整数 y_3 满足 y_3 除以3余0、除以5余0、除以7余1</p>\n<p>这三个问题本质上是相同的。如果找到了 y_1,y_2,y_3 ，那么就可以取 x=2×y_1+3×y_2+2×y_3 。</p>\n<h3>part3</h3>\n<p>对于上述每个问题，就转化为求模逆元问题：(费马定理，或者拓展欧几里得定理)</p>\n<h3>part4</h3>\n<p><img alt=\"\" height=\"542\" src=\"image\\6d0bb2787a3041b1b50689e76df07b67.png\" width=\"989\"/></p>\n<h3> 贴代码</h3>\n<p></p>\n<p><strong>C++</strong></p>\n<pre><code class=\"language-cpp\">#include&lt;bits/stdc++.h&gt;\n#define ll long long\nusing namespace std;\nll a[1010]={2,3,2},m[1010]={3,5,7};\nll qpow(ll x,ll n,ll mod){\n    ll res=1;\n    while(n){\n        if(n&amp;1)res=res*x%mod;\n        n&gt;&gt;=1;\n        x=x*x%mod;\n    }\n    return res;\n}\nll inv(ll x,ll mod){return qpow(x,mod-2,mod);}\nll CRT(ll n){\n    ll M=1,x=0;\n    for(int i=0;i&lt;n;i++)cout&lt;&lt;m[i]&lt;&lt;' ';\n    for(int i=0;i&lt;n;i++)M=M*m[i];\n    for(int i=0;i&lt;n;i++)x=x+a[i]*inv(M/m[i],m[i])*(M/m[i]);\n    return x%M;\n}</code></pre>\n<p><strong>python</strong></p>\n<pre><code class=\"language-python\">from Crypto.Util.number import *\n# CRT 模板\na=[2,4,5] #记录余数 \nm=[3,5,7] #记录模 \n# n=len(a)=len(m)\ndef CRT(n):\n    M,x=1,0\n    for i in range(n):\n        M=M*m[i]\n    for i in range(n):\n        x=x+inverse(M/m[i],m[i])*(M/m[i])*a[i]\n    return x%M\nprint(int(CRT(3)))</code></pre>\n<p></p>\n</div>\n</div>"}