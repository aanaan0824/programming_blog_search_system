{"blogid": "125895012", "writerAge": "码龄5年", "writerBlogNum": "224", "writerCollect": "419", "writerComment": "102", "writerFan": "377", "writerGrade": "5级", "writerIntegral": "2669", "writerName": "camellias_", "writerProfileAdress": "writer_image\\profile_125895012.jpg", "writerRankTotal": "11496", "writerRankWeekly": "115480", "writerThumb": "102", "writerVisitNum": "194183", "blog_read_count": "782", "blog_time": "已于 2022-07-20 16:25:34 修改", "blog_title": "C#（三十八）之StreamWriter StreamWriter使用方法及与FileStream类的区别", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><strong>StreamReader类的属性：</strong></p>\n<p>CurrentEncoding：获取流使用的字符编码</p>\n<p>EndOfStream：指示当前位置是否在流的末尾</p>\n<p><strong>StreamReader类的方法：</strong></p>\n<p>Read()：读取流中的下一个字符或下一组字符。</p>\n<p>ReadBlock()：读取一个字符块。</p>\n<p>ReadLine()：从流中读取一行字符</p>\n<p>ReadToEnd()：从流的当前位置读取到流的末尾</p>\n<p>Close()：关闭当前流，并释放资源</p>\n<p><strong>StreamWriter类的属性：</strong></p>\n<p>Ecoding：获取被写入类型的字符编码</p>\n<p>例：outFile = new StreamWriter (“c://abc.txt”,false,Encoding.GetEncoding(“gb2312”));</p>\n<p>NewLine：当前流使用“行结束符”；</p>\n<p><strong>StreamWriter类的方法：</strong></p>\n<p>Write()：写入数据</p>\n<p>WriteLine()：写入数据，并添加行结束符</p>\n<p>Close()：关闭当前流，并释放资源</p>\n<p>StreamXXXX<strong>类与FileStream类的区别：</strong></p>\n<p>1：StreamReader/StreamWriter操作的是字符数据（char），而FileStream操作的是字节数据（byte）:</p>\n<p>2：StreamXXXX类常用于文本的打开与保存，而FileStream则用于数据的传输。</p>\n<p>3：FileStream是不能指定编码（因为它看到的只是文件的二进制形式，当然无所谓编码），所以如果有中文的文本的话需要转码。</p>\n<p>4：FileStream是一个较底层的类，只能简单地读文件到而缓冲区，而StreamXXXX类封装了一些高级的方法，如ReadLine() （按行读取）</p>\n<p>5：FileStream类主要使用于大文件读写，StreamXXXXX类主要用于小文件的读写。</p>\n<p>StreamReader</p>\n<pre><code class=\"prism language-C#\">/// &lt;summary&gt;\n        /// StreanReader读取\n        /// &lt;/summary&gt;\n        private void button3_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            if (path != \"\" &amp;&amp; File.Exists(path))\n            {\n                try\n                {\n                    reader = new StreamReader(path, Encoding.Default);\n                    string str = reader.ReadToEnd();\n                    MessageBox.Show(str);\n                }\n                catch (Exception qq)\n                {\n                    MessageBox.Show(qq.Message);\n                }\n                finally\n                {\n                    // 关闭文件流\n                    reader.Close();\n                    // 关闭资源\n                    reader.Dispose();\n                }\n            }\n            else\n            {\n                MessageBox.Show(\"请输入正确的路径\");\n                return;\n            }\n           \n        }\n</code></pre>\n<p>StreamWriter</p>\n<pre><code class=\"prism language-C#\">/// &lt;summary&gt;\n        /// StreamWrite写入\n        /// &lt;/summary&gt;\n        private void button4_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            try\n            {\n                if (path != \"\" &amp;&amp; File.Exists(path))\n                {\n                    //创建文件\n                    //writer = File.CreateText(path);\n                    writer = new StreamWriter(path, false, Encoding.GetEncoding(\"gb2312\"));\n                    string contact = @\"十年征战梦一场，功名利禄终相忘\";\n                    writer.Write(contact);\n                    MessageBox.Show(\"写入成功！\");\n \n                }\n                else\n                {\n                    MessageBox.Show(\"请输入正确的路径\");\n                    return;\n                }\n            }\n            catch (Exception qq)\n            {\n                MessageBox.Show(qq.Message);\n            }\n            finally\n            {\n                writer.Close();\n                writer.Dispose();\n            }\n        }\n</code></pre>\n<p>测试使用全部代码：</p>\n<pre><code class=\"prism language-C#\">using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing System.IO;\n \n \n \nnamespace FileStreams\n{\n    public partial class Form1 : Form\n    {\n        /// &lt;summary&gt;\n        /// 构造函数\n        /// &lt;/summary&gt;\n        public Form1()\n        {\n            InitializeComponent();\n        }\n        /// &lt;summary&gt;\n        /// 窗体加载事件\n        /// &lt;/summary&gt;\n        private void Form1_Load(object sender, EventArgs e)\n        {\n \n        }\n        /// &lt;summary&gt;\n        /// 定义一个FileStream类\n        /// &lt;/summary&gt;\n        public FileStream ff = null;\n        /// &lt;summary&gt;\n        /// 存储文件路径\n        /// &lt;/summary&gt;\n        public string path = \"\";\n        /// &lt;summary&gt;\n        /// StreamReader空对象\n        /// &lt;/summary&gt;\n        public StreamReader reader = null;\n        /// &lt;summary&gt;\n        /// StreamWriter空对象\n        /// &lt;/summary&gt;\n        public StreamWriter writer = null;\n        /// &lt;summary&gt;\n        /// FileStream读取\n        /// &lt;/summary&gt;\n        private void button1_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            if (path != \"\" &amp;&amp; File.Exists(path))\n            {\n                ff = new FileStream(path, FileMode.OpenOrCreate, FileAccess.ReadWrite);\n            }\n            else\n            {\n                MessageBox.Show(\"请输入正确的路径\");\n                return;\n            }\n            try\n            {\n                byte[] buffer = new byte[1024 * 1024 * 2];    //定义一个2M的字节数组\n                //返回本次实际读取到的有效字节数\n                int r = ff.Read(buffer, 0, buffer.Length);    //每次读取2M放到字节数组里面\n                //将字节数组中每一个元素按照指定的编码格式解码成字符串\n                string sss = Encoding.Default.GetString(buffer, 0, r);\n                MessageBox.Show(sss);\n            }\n            catch (Exception qq)\n            {\n                MessageBox.Show(qq.Message);\n            }\n            finally\n            {\n                // 关闭文件流\n                ff.Close();\n                // 关闭资源\n                ff.Dispose();\n            }\n           \n        }\n        /// &lt;summary&gt;\n        /// FileStream写入\n        /// &lt;/summary&gt;\n        private void button2_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            try\n            {\n                if (path != \"\")\n                {\n                    ff = new FileStream(path, FileMode.OpenOrCreate, FileAccess.ReadWrite);\n                    string content = @\"大漠孤烟直，长河落日圆\";\n                    // 将字符串读入字节数组中。\n                    byte[] buffer = Encoding.Default.GetBytes(content);\n                    // 将数组写入文件\n                    ff.Write(buffer, 0, buffer.Length);\n                    MessageBox.Show(\"写入成功\");\n                }\n                else\n                {\n                    MessageBox.Show(\"请输入正确的路径\");\n                    return;\n                }\n \n            }\n            catch (Exception qq)\n            {\n \n                MessageBox.Show(qq.Message);\n            }\n            finally\n            {\n                ff.Close();\n                ff.Dispose();\n            }\n           \n        }\n        /// &lt;summary&gt;\n        /// StreanReader读取\n        /// &lt;/summary&gt;\n        private void button3_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            if (path != \"\" &amp;&amp; File.Exists(path))\n            {\n                try\n                {\n                    reader = new StreamReader(path, Encoding.Default);\n                    string str = reader.ReadToEnd();\n                    MessageBox.Show(str);\n                }\n                catch (Exception qq)\n                {\n                    MessageBox.Show(qq.Message);\n                }\n                finally\n                {\n                    // 关闭文件流\n                    reader.Close();\n                    // 关闭资源\n                    reader.Dispose();\n                }\n            }\n            else\n            {\n                MessageBox.Show(\"请输入正确的路径\");\n                return;\n            }\n           \n        }\n        /// &lt;summary&gt;\n        /// StreamWrite写入\n        /// &lt;/summary&gt;\n        private void button4_Click(object sender, EventArgs e)\n        {\n            path = textBox1.Text;\n            try\n            {\n                if (path != \"\" &amp;&amp; File.Exists(path))\n                {\n                    //创建文件\n                    //writer = File.CreateText(path);\n                    writer = new StreamWriter(path, false, Encoding.GetEncoding(\"gb2312\"));\n                    string contact = @\"十年征战梦一场，功名利禄终相忘\";\n                    writer.Write(contact);\n                    MessageBox.Show(\"写入成功！\");\n                }\n                else\n                {\n                    MessageBox.Show(\"请输入正确的路径\");\n                    return;\n                }\n            }\n            catch (Exception qq)\n            {\n                MessageBox.Show(qq.Message);\n            }\n            finally\n            {\n                writer.Close();\n                writer.Dispose();\n            }\n        }\n       \n    }\n}\n</code></pre>\n<p>有好的建议，请在下方输入你的评论。</p>\n<p>欢迎访问个人博客<br/> <a href=\"https://guanchao.site\">https://guanchao.site</a></p>\n<p>欢迎访问小程序：</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\dda4e3f0678c4562844fb23ba5ec152c.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}