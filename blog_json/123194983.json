{"blogid": "123194983", "writerAge": "码龄4年", "writerBlogNum": "70", "writerCollect": "277", "writerComment": "11", "writerFan": "74", "writerGrade": "4级", "writerIntegral": "836", "writerName": "the zl", "writerProfileAdress": "writer_image\\profile_123194983.jpg", "writerRankTotal": "65200", "writerRankWeekly": "280722", "writerThumb": "48", "writerVisitNum": "132473", "blog_read_count": "2146", "blog_time": "已于 2022-03-01 11:01:19 修改", "blog_title": "文件上传漏洞—一句话图片马制作", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"_0\"></a>文件上传漏洞—一句话图片马制作</h2>\n<p><strong>提要</strong>：在文件上传漏洞中，通常需要上传脚本类型的文件至服务端执行，获取WebShell，但是网站会严格过滤脚本类型的文件，这个时候便可以通过图片马来尝试突破。<br/> <strong>简介</strong>：在图片格式文件（JPG，PNG和GIF等）中添加隐藏一句话木马，利用文件包含漏洞，Web容器解析漏洞和.htaccess文件解析成对应的脚本，达到可以被Web容器执行的效果。<br/> <strong>利用场景</strong>：因为图片格式的文件默认是不会被Web容器解析的，所以通常需要借助到文件包含漏洞，Web容器解析漏洞和.htaccess文件。</p>\n<h2><a id=\"_6\"></a>图片马常用制作方式：</h2>\n<h2><a id=\"_8\"></a>方法一：文本方式制作。</h2>\n<p>通过Notepad++直接打开图片文件，在尾部直接添加对应的脚本语言即可<br/> <img alt=\"在这里插入图片描述\" src=\"image\\b5e2f70746cf4fdb9077fcaa6d3b960c.png\"/></p>\n<h2><a id=\"CMD_13\"></a>方法二：CMD执行</h2>\n<p><strong>准备</strong>：制作名称为111.PHP的PHP脚本语言，名称为222.jpg的图片，制作后的图片马名称为333.jpg</p>\n<pre><code class=\"prism language-c\"><span class=\"token operator\">*</span><span class=\"token operator\">*</span>制作图片马命令<span class=\"token operator\">*</span><span class=\"token operator\">*</span>：copy 图片文件名称<span class=\"token operator\">/</span>b<span class=\"token operator\">+</span>脚本文件名称<span class=\"token operator\">/</span>a  新生成的文件名称，例如：copy <span class=\"token number\">222.</span>jpg<span class=\"token operator\">/</span>b<span class=\"token operator\">+</span><span class=\"token number\">111.</span>php<span class=\"token operator\">/</span>a <span class=\"token number\">333.</span>jpg\n</code></pre>\n<p>图片马制作：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\94a26a8734a84e78a3de4b0c755aba82.png\"/><br/> <strong>/a</strong>：通过二进制形式打开，放在脚本文件后面<br/> <strong>/b</strong>：通过ASCII形式打开，访问图片文件后面<br/> <strong>效果查看</strong>：制作的图片马，一句话木马已放在图片的尾部，和第一种方式生成的图片马效果一样<br/> <img alt=\"在这里插入图片描述\" src=\"image\\c67ca5ecbfdc40a995db9426c3c2eb0c.png\"/><br/> <strong>参考文章：</strong><br/> <a href=\"https://www.cnblogs.com/Linkas/p/15101706.html\">做一个图片马的四种方法(详细步骤)</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}