{"blogid": "119322059", "writerAge": "ç é¾„6å¹´", "writerBlogNum": "4", "writerCollect": "607", "writerComment": "110", "writerFan": "78", "writerGrade": "3çº§", "writerIntegral": "414", "writerName": "å¼ç€ç‹—éª¨å¤´çš„çŒ«", "writerProfileAdress": "writer_image\\profile_119322059.jpg", "writerRankTotal": "1041577", "writerRankWeekly": "165740", "writerThumb": "96", "writerVisitNum": "27301", "blog_read_count": "15487", "blog_time": "äºÂ 2021-08-03 10:45:42Â å‘å¸ƒ", "blog_title": "ä½¿ç”¨PyQt5ä¸ºYoloV5æ·»åŠ ç•Œé¢ï¼ˆä¸€ï¼‰", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"PyQt5YoloV5_0\"></a>ä½¿ç”¨PyQt5ä¸ºYoloV5æ·»åŠ ç•Œé¢</h2>\n<p>è¿‘æœŸå› ä¸ºç–«æƒ…ï¼Œæ— æ³•æ­£å¸¸å…¥èŒä¸Šç­ã€‚æ‰€ä»¥åœ¨å®¶å‚è€ƒç›¸å…³åšæ–‡ï¼Œè§†é¢‘å’Œä»£ç ç­‰ï¼Œå­¦ä¹ äº†PyQt5çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶å°è¯•ä¸ºYOLOV5æ·»åŠ ç•Œé¢ã€‚<br/> åæ­£å•¥ä¹Ÿä¸å’‹ä¼šï¼Œåœ¨å®¶çæ£é¼“æ£é¼“ï¼Œæ€»æ¯”é—²ç€å¼ºå‘—~<br/> é¡¹ç›®ä¸ºç®€å•Demoï¼Œä»…ä¾›è‡ªå·±è®°å½•è¿‡ç¨‹ï¼Œä»¥åŠäº¤æµå­¦ä¹ ~</p>\n<h2><a id=\"_5\"></a><strong>ä¸€ã€é¡¹ç›®ç®€ä»‹</strong></h2>\n<p>ä½¿ç”¨PyQt5ä¸ºYoloV5æ·»åŠ ä¸€ä¸ªå¯è§†åŒ–æ£€æµ‹ç•Œé¢ï¼Œå¹¶å®ç°ç®€å•çš„ç•Œé¢è·³è½¬ï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹ï¼š<br/> <strong>ç‰¹ç‚¹ï¼š</strong></p>\n<ol><li>UIç•Œé¢ä¸é€»è¾‘ä»£ç åˆ†ç¦»</li><li>æ”¯æŒè‡ªé€‰å®šæ¨¡å‹</li><li>åŒæ—¶è¾“å‡ºæ£€æµ‹ç»“æœä¸ç›¸åº”ç›¸å…³ä¿¡æ¯</li><li>æ”¯æŒå›¾ç‰‡ï¼Œè§†é¢‘ï¼Œæ‘„åƒå¤´æ£€æµ‹</li><li>æ”¯æŒè§†é¢‘æš‚åœä¸ç»§ç»­æ£€æµ‹</li></ol>\n<p><strong>ç›®çš„ï¼š</strong></p>\n<ol><li>ç†Ÿæ‚‰QtDesignçš„ä½¿ç”¨</li><li>äº†è§£PyQt5åŸºç¡€æ§ä»¶ä¸å¸ƒå±€æ–¹æ³•</li><li>äº†è§£ç•Œé¢è·³è½¬</li><li>äº†è§£ä¿¡å·ä¸æ§½</li><li>ç†Ÿæ‚‰è§†é¢‘åœ¨PyQtä¸­çš„å¤„ç†æ–¹æ³•</li></ol>\n<p><strong>é¡¹ç›®å›¾ç‰‡ï¼š</strong><br/> <img alt=\"ç™»å½•ç•Œé¢\" src=\"image\\541206b4f8324a2794978672f4b35b81.png\"/><br/> <img alt=\"æ³¨å†Œç•Œé¢\" src=\"image\\5ee90529650e41fb81065f17dcb40fc3.png\"/></p>\n<p><img alt=\"æ£€æµ‹ç•Œé¢\" src=\"image\\9161046e7c0744328152f0cdca8748d6.png\"/></p>\n<h2><a id=\"__28\"></a><strong>äºŒ. é¡¹ç›®æ•´ä½“æ¡†æ¶ä¸ä»£ç </strong></h2>\n<p><img alt=\"é¡¹ç›®æ¶æ„\" src=\"image\\8db7e8243fe543d485fa977e83abd32b.png\"/></p>\n<p>é¡¹ç›®åœ°å€ï¼šhttps://github.com/BonesCat/YoloV5_PyQt5/tree/main<br/> Bç«™è§†é¢‘ï¼šhttps://www.bilibili.com/video/BV1ZU4y1E7at/</p>\n<p><strong>æ›´æ–°ï¼šä»£ç æ›´æ–°è‡³ç™¾åº¦äº‘ï¼Œè‡ªå–ï¼ï¼ï¼</strong><br/> é“¾æ¥ï¼šhttps://pan.baidu.com/s/1qF6JMIl8qoTVtCTnBfIaZw<br/> æå–ç ï¼š3gdn<br/> å¯ä»¥ä¿å­˜è§†é¢‘å’Œå›¾ç‰‡å•Šï¼Œä¸Šä¼ äº†æˆªå›¾ç»™å¤§å®¶äº†ã€‚è¿˜æ˜¯ä¸è¡Œè‡ªå·±åœ¨åŠ¨æ‰‹æ”¹æ”¹å§ï¼Œä¸æ˜¯å¾ˆéš¾ã€‚</p>\n<p>æ¶æ„ä»‹ç»ï¼š</p>\n<ol><li>æ•´ä½“ä¸ºYoloV5çš„ä»£ç </li><li>uiæ–‡ä»¶å¤¹ä¸­å­˜æ”¾uiçš„pyæ–‡ä»¶å’ŒåŸä»¶ï¼Œä¾¿äºä½¿ç”¨ä¸æ›´æ”¹</li><li>ui_imgå­˜æ”¾uiä½¿ç”¨çš„å›¾åƒæ–‡ä»¶</li><li>utilsä¸­æ·»åŠ äº†ä¸€ä¸ªç”¨æˆ·è´¦æˆ·å·¥å…·id_utils.py</li><li>detect_logical.pyæ˜¯æ£€æµ‹ç•Œé¢çš„é€»è¾‘ä»£ç </li><li>main_logical.pyæ˜¯ä¸»ç•Œé¢çš„é€»è¾‘ä»£ç </li><li>userinfo.csvå­˜æ”¾ç”¨æˆ·è´¦å·idä¿¡æ¯</li></ol>\n<p>ä¸»è¦æ˜¯åœ¨åŸå§‹YoloV5-pyqtçš„åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>\n<ul><li>1.åˆ†ç¦»äº†ç•Œé¢å’Œé€»è¾‘</li><li>2.å¢åŠ äº†ç™»å½•ï¼Œæ³¨å†ŒåŠŸèƒ½</li><li>3.é‡æ„äº†éƒ¨åˆ†åŠŸèƒ½ä»£ç </li></ul>\n<h2><a id=\"_53\"></a><strong>ä¸‰ã€å¿«é€Ÿå¼€å§‹</strong></h2>\n<p><strong>ç¯å¢ƒä¸ç›¸å…³æ–‡ä»¶é…ç½®ï¼š</strong></p>\n<ul><li>æŒ‰ç…§ ult-yolov5 ä¸­requirementçš„è¦æ±‚é…ç½®ç¯å¢ƒï¼Œè‡ªè¡Œå®‰è£…PyQt5ï¼Œæ³¨æ„éƒ½éœ€è¦åœ¨ä¸€ä¸ªevnç¯å¢ƒä¸­è¿›è¡Œå®‰è£…ä¸é…ç½®</li><li>ä¸‹è½½æˆ–è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œå°†â€œ.ptâ€æ–‡ä»¶æ”¾åˆ°weightsæ–‡ä»¶å¤¹ï¼Œï¼ˆæƒé‡æ–‡ä»¶å¯ä»¥è‡ªå·±é€‰ï¼Œç¨‹åºé»˜è®¤æ‰“å¼€weightsæ–‡ä»¶å¤¹ï¼‰</li><li>å½“å‰è®¾ç½®çš„ä¸ºcpuè¿è¡Œæ¨¡å¼ï¼Œæ— å¥ˆå½“å‰æœ¨æœ‰å°é’±é’±ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®ä¸ºgpuï¼Œåœ¨opté‡Œé¢è®¾ç½®å°±å¯äº†ï¼Œæ£€æµ‹é€Ÿåº¦ä¼šæå‡</li></ul>\n<p><strong>ä¸¤ç§ç¨‹åºä½¿ç”¨æ–¹å¼ï¼š</strong></p>\n<ul><li>ç›´æ¥è¿è¡Œdetect_logical.pyï¼Œè¿›å…¥æ£€æµ‹ç•Œé¢</li><li>è¿è¡Œmain_logical.pyï¼Œå…ˆç™»å½•ï¼Œåœ¨è¿›å…¥æ£€æµ‹ç•Œé¢ï¼ˆè¿™æ˜¯ä¸ºäº†å­¦ä¹ ç•Œé¢è·³è½¬ğŸ˜‚ï¼‰</li></ul>\n<h2><a id=\"__65\"></a><strong>å››ã€ æ ¸å¿ƒéƒ¨åˆ†ä»£ç ä¸ç®€å•è®²è§£</strong></h2>\n<ul><li> <p>UIç•Œé¢å…¨éƒ¨éƒ½QtDesignè®¾è®¡ï¼Œç„¶åç”±pyUICç”Ÿæˆï¼Œä¸åšå™è¿°ï¼Œæ­¤éƒ¨åˆ†é‡ç‚¹åœ¨äºå¦‚ä½•ä½¿ç”¨QtDesignè®¾è®¡ç•Œé¢ã€‚UIç•Œé¢å¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼Œåªè¦å¯¹åº”çš„æ§ä»¶åä¸é€»è¾‘å‡½æ•°ä¸­çš„å¯¹åº”å³å¯ã€‚<br/> æˆ‘æ˜¯å–œæ¬¢å…ˆæ‘†æ”¾æ§ä»¶ï¼Œå†è°ƒæ•´å¸ƒå±€ã€‚<br/> 1.å…³é”®æ˜¯å…ˆå¤§æ¦‚è®¾è®¡å¥½å„ä¸ªéƒ¨ä»¶çš„ä½ç½®ï¼Œç„¶åæŒ‰ç…§æ°´å¹³å’Œç«–ç›´çš„å¸ƒå±€æ–¹å¼ï¼Œå¯¹å„ä¸ªå±€éƒ¨æ§ä»¶è¿›è¡Œå¸ƒå±€è°ƒæ•´ï¼ˆå¦‚ä¸Šä¸­ä¸‹ï¼Œå·¦ä¸­å³è¿™ç§å¸ƒå±€ï¼‰ã€‚<br/> 2.å±€éƒ¨è°ƒæ•´å¥½äº†ï¼Œå¯¹æ•´ä½“åœ¨è¿›è¡Œè°ƒæ•´ã€‚å…¨å±€éƒ½æœ‰å¸ƒå±€çš„æƒ…å†µä¸‹ï¼Œé¡µé¢æ˜¯å¯ä»¥è¿›è¡Œè‡ªåŠ¨ç¼©æ”¾çš„ã€‚<br/> æ³¨ï¼šç™½å¤œé»‘ç¾½çš„è¯¾ç¨‹é‡Œé¢ï¼Œæœ‰ä¸€èŠ‚è¯´è¿™ä¸ªçš„ã€‚å¯ä»¥å»çœ‹è§†é¢‘ã€‚æ•´ä½“çš„è®¾è®¡åçš„ç»“æœï¼Œå¯ä»¥ä½¿ç”¨QtDesignerçœ‹åŸå§‹çš„UIæ–‡ä»¶ï¼Œåœ¨uiæ–‡ä»¶å¤¹ä¸­ã€‚<br/> <img alt=\"ä¸‰æ®µå¼å¸ƒå±€ç¤ºæ„\" src=\"image\\22fd04af7ca5423cb0aa899bc7506eac.png\"/></p> </li><li> <p>main_logical.py<br/> æ­¤éƒ¨åˆ†ä»£ç æ˜¯è´Ÿè´£å¤„ç†ä¸»ç•Œé¢çš„é€»è¾‘ï¼Œå…·ä½“åŒ…æ‹¬ç™»å½•ç•Œé¢å’Œæ³¨å†Œç•Œé¢çš„é€»è¾‘ï¼Œå¹¶æ ¹æ®éœ€æ±‚å®ç°ç•Œé¢è·³è½¬ã€‚<br/> ä¸»è¦æ€è·¯ï¼š<br/> 1.å¯¼åŒ…ï¼šå¯¼å…¥ç›¸å…³UI<br/> 2.åˆ›å»ºç•Œé¢ç±»ï¼šæ¯ä¸ªç•Œé¢çš„é€»è¾‘ç‹¬è‡ªä¸ºä¸€ä¸ªç±»ï¼Œå¹¶åœ¨è¯¥ç±»ä¸­åˆå§‹åŒ–ç›¸å…³UIç•Œé¢ï¼Œä»¥åŠä¿¡å·æ§½ã€‚<br/> 3.ä¿¡å·ä¸æ§½ï¼šä½¿ç”¨connectæ“ä½œï¼Œå°†æ§ä»¶ç»‘å®šå¥½å…·ä½“çš„æ“ä½œ<br/> 4.ç•Œé¢è·³è½¬ï¼šç”±äºå•ä¸ªç•Œé¢æœ‰å…·ä½“çš„ç±»ï¼Œæ‰€ä»¥åªéœ€åœ¨è·³è½¬åŠŸèƒ½å‡½æ•°ä¸­ï¼Œå®ä¾‹ä¸€ä¸ªå…·ä½“ç•Œé¢å¯¹è±¡ï¼Œå¹¶è®¾ç½®ä¸ºshowï¼›å¹¶æ ¹æ®éœ€è¦å†³å®šæ˜¯å¦å…³é—­å½“å‰ç•Œé¢ã€‚<br/> éœ€è¦è¯´ä¸€å¥çš„æ˜¯ï¼Œå‚è€ƒç™½æ—¥é»‘ç¾½çš„è¯¾ç¨‹ï¼Œåœ¨åˆ›å»ºæ–°ç•Œé¢çš„æ—¶å€™ï¼Œè¿™é‡Œæ²¡æœ‰ç›´æ¥åœ¨å½“å‰ç±»ä¸­åˆ›å»ºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œè€Œæ˜¯ä½¿ç”¨libåŒ…ä¸­çš„å…¬å…±ä¿¡æ¯ç±»shareInfoä¸­çš„å˜é‡æ¥å®ç°çš„ã€‚</p> </li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># @Modified by: Ruihao</span>\n<span class=\"token comment\"># @ProjectName:yolov5-pyqt5</span>\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">from</span> datetime <span class=\"token keyword\">import</span> datetime\n\n<span class=\"token keyword\">from</span> PyQt5 <span class=\"token keyword\">import</span> QtWidgets\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtWidgets <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">from</span> utils<span class=\"token punctuation\">.</span>id_utils <span class=\"token keyword\">import</span> get_id_info<span class=\"token punctuation\">,</span> sava_id_info <span class=\"token comment\"># è´¦å·ä¿¡æ¯å·¥å…·å‡½æ•°</span>\n<span class=\"token keyword\">from</span> lib<span class=\"token punctuation\">.</span>share <span class=\"token keyword\">import</span> shareInfo <span class=\"token comment\"># å…¬å…±å˜é‡å</span>\n\n<span class=\"token comment\"># å¯¼å…¥QT-Designç”Ÿæˆçš„UI</span>\n<span class=\"token keyword\">from</span> ui<span class=\"token punctuation\">.</span>login_ui <span class=\"token keyword\">import</span> Login_Ui_Form\n<span class=\"token keyword\">from</span> ui<span class=\"token punctuation\">.</span>registe_ui <span class=\"token keyword\">import</span> Ui_Dialog\n<span class=\"token comment\"># å¯¼å…¥è®¾è®¡å¥½çš„æ£€æµ‹ç•Œé¢</span>\n<span class=\"token keyword\">from</span> detect_logical <span class=\"token keyword\">import</span> UI_Logic_Window\n\n<span class=\"token comment\"># ç•Œé¢ç™»å½•</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">win_Login</span><span class=\"token punctuation\">(</span>QMainWindow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> parent <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>win_Login<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui_login <span class=\"token operator\">=</span> Login_Ui_Form<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>setupUi<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>init_slots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>hidden_pwd<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># å¯†ç è¾“å…¥æ¡†éšè—</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">hidden_pwd</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>edit_password<span class=\"token punctuation\">.</span>setEchoMode<span class=\"token punctuation\">(</span>QLineEdit<span class=\"token punctuation\">.</span>Password<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç»‘å®šä¿¡å·æ§½</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">init_slots</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>btn_login<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>onSignIn<span class=\"token punctuation\">)</span> <span class=\"token comment\"># ç‚¹å‡»æŒ‰é’®ç™»å½•</span>\n        self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>edit_password<span class=\"token punctuation\">.</span>returnPressed<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>onSignIn<span class=\"token punctuation\">)</span> <span class=\"token comment\"># æŒ‰ä¸‹å›è½¦ç™»å½•</span>\n        self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>btn_regeist<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>create_id<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># è·³è½¬åˆ°æ³¨å†Œç•Œé¢</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">create_id</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        shareInfo<span class=\"token punctuation\">.</span>createWin <span class=\"token operator\">=</span> win_Register<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        shareInfo<span class=\"token punctuation\">.</span>createWin<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ä¿å­˜ç™»å½•æ—¥å¿—</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">sava_login_log</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'login_log.txt'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> encoding<span class=\"token operator\">=</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n            f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>username <span class=\"token operator\">+</span> <span class=\"token string\">'\\t log in at'</span> <span class=\"token operator\">+</span> datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strftimestrftime<span class=\"token operator\">+</span> <span class=\"token string\">'\\r'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç™»å½•</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">onSignIn</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You pressed sign in\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># ä»ç™»é™†ç•Œé¢è·å¾—è¾“å…¥è´¦æˆ·åä¸å¯†ç </span>\n        username <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>edit_username<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        password <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>ui_login<span class=\"token punctuation\">.</span>edit_password<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># è·å¾—è´¦å·ä¿¡æ¯</span>\n        USER_PWD <span class=\"token operator\">=</span> get_id_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># print(USER_PWD)</span>\n\n        <span class=\"token keyword\">if</span> username <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> USER_PWD<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span><span class=\"token string\">\"ç™»é™†å¤±è´¥!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"è´¦å·æˆ–å¯†ç è¾“å…¥é”™è¯¯\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># è‹¥ç™»é™†æˆåŠŸï¼Œåˆ™è·³è½¬ä¸»ç•Œé¢</span>\n            <span class=\"token keyword\">if</span> USER_PWD<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>username<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> password<span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Jump to main window\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token comment\"># # å®ä¾‹åŒ–æ–°çª—å£</span>\n                <span class=\"token comment\"># # å†™æ³•1ï¼š</span>\n                <span class=\"token comment\"># self.ui_new = win_Main()</span>\n                <span class=\"token comment\"># # æ˜¾ç¤ºæ–°çª—å£</span>\n                <span class=\"token comment\"># self.ui_new.show()</span>\n\n                <span class=\"token comment\"># å†™æ³•2ï¼š</span>\n                <span class=\"token comment\"># ä¸ç”¨self.ui_new,å› ä¸ºè¿™ä¸ªå­çª—å£ä¸æ˜¯ä»å±äºå½“å‰çª—å£,å†™æ³•ä¸å¥½</span>\n                <span class=\"token comment\"># æ‰€ä»¥ä½¿ç”¨å…¬ç”¨å˜é‡å</span>\n                shareInfo<span class=\"token punctuation\">.</span>mainWin <span class=\"token operator\">=</span> UI_Logic_Window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                shareInfo<span class=\"token punctuation\">.</span>mainWin<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token comment\"># å…³é—­å½“å‰çª—å£</span>\n                self<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"è´¦å·æˆ–å¯†ç è¾“å…¥é”™è¯¯\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># æ³¨å†Œç•Œé¢</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">win_Register</span><span class=\"token punctuation\">(</span>QDialog<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> parent <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>win_Register<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui_register <span class=\"token operator\">=</span> Ui_Dialog<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui_register<span class=\"token punctuation\">.</span>setupUi<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>init_slots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç»‘å®šæ§½ä¿¡å·</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">init_slots</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>ui_register<span class=\"token punctuation\">.</span>pushButton_regiser<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>new_account<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui_register<span class=\"token punctuation\">.</span>pushButton_cancer<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>cancel<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># åˆ›å»ºæ–°è´¦æˆ·</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">new_account</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Create new account\"</span><span class=\"token punctuation\">)</span>\n        USER_PWD <span class=\"token operator\">=</span> get_id_info<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># print(USER_PWD)</span>\n        new_username <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>ui_register<span class=\"token punctuation\">.</span>edit_username<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        new_password <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>ui_register<span class=\"token punctuation\">.</span>edit_password<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦ä¸ºç©º</span>\n        <span class=\"token keyword\">if</span> new_username <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">:</span>\n            replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"è´¦å·ä¸å‡†ä¸ºç©º\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># åˆ¤æ–­è´¦å·æ˜¯å¦å­˜åœ¨</span>\n            <span class=\"token keyword\">if</span> new_username <span class=\"token keyword\">in</span> USER_PWD<span class=\"token punctuation\">.</span>keys<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"è´¦å·å·²å­˜åœ¨\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                <span class=\"token comment\"># åˆ¤æ–­å¯†ç æ˜¯å¦ä¸ºç©º</span>\n                <span class=\"token keyword\">if</span> new_password <span class=\"token operator\">==</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">:</span>\n                    replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"å¯†ç ä¸èƒ½ä¸ºç©º\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token comment\"># æ³¨å†ŒæˆåŠŸ</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Successful!\"</span><span class=\"token punctuation\">)</span>\n                    sava_id_info<span class=\"token punctuation\">(</span>new_username<span class=\"token punctuation\">,</span> new_password<span class=\"token punctuation\">)</span>\n                    replay <span class=\"token operator\">=</span> QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>  <span class=\"token string\">\"!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"æ³¨å†ŒæˆåŠŸï¼\"</span><span class=\"token punctuation\">,</span> QMessageBox<span class=\"token punctuation\">.</span>Yes<span class=\"token punctuation\">)</span>\n                    <span class=\"token comment\"># å…³é—­ç•Œé¢</span>\n                    self<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># å–æ¶ˆæ³¨å†Œ</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">cancel</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># å…³é—­å½“å‰ç•Œé¢</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    app <span class=\"token operator\">=</span> QApplication<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># åˆ©ç”¨å…±äº«å˜é‡åæ¥å®ä¾‹åŒ–å¯¹è±¡</span>\n    shareInfo<span class=\"token punctuation\">.</span>loginWin <span class=\"token operator\">=</span> win_Login<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ç™»å½•ç•Œé¢ä½œä¸ºä¸»ç•Œé¢</span>\n    shareInfo<span class=\"token punctuation\">.</span>loginWin<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>exec_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n</code></pre>\n<p>detect_logical.py<br/> æ­¤éƒ¨åˆ†ä»£ç æ˜¯è´Ÿè´£å¤„ç†æ£€æµ‹çš„é€»è¾‘ï¼Œå…·ä½“åŒ…æ‹¬å®ç°æ¨¡å‹é€‰æ‹©ï¼Œåˆå§‹åŒ–ï¼Œå›¾ç‰‡/è§†é¢‘/æ‘„åƒå¤´æ£€æµ‹ã€‚<br/> ä¸»è¦æ€è·¯ï¼š<br/> 1.å¯¼åŒ…ï¼šå¯¼å…¥æ£€æµ‹çš„UI<br/> 2.ç•Œé¢åˆå§‹åŒ–ï¼šåˆå§‹åŒ–UIç•Œé¢ï¼Œä¸ºå¤„ç†è§†é¢‘åˆå§‹åŒ–QTimerå®šæ—¶å™¨ï¼Œå¹¶åˆå§‹åŒ–ä¿¡å·æ§½ã€‚<br/> 3.è§†é¢‘æ£€æµ‹éƒ¨åˆ†ä½¿ç”¨QTimerå®ç°å¤šçº¿ç¨‹å¤„ç†ã€‚æŠ€æœ¯ä»‹ç»è§ã€ŠPyQt5å¿«é€Ÿå¼€å‘ä¸å®è·µã€‹ï¼š<br/> <img alt=\"QTimer\" src=\"image\\ce7b96d5e91b4561806178ca2a425199.png\"/><br/> 4. é‡è¦åŠŸèƒ½å‡½æ•°ç®€æï¼š<br/> æœ¬é¡¹ç›®å°†ç›®æ ‡æ£€æµ‹æ‹†åˆ†ä¸ºäº†æ¨¡å‹åŠ è½½å’Œæ£€æµ‹ä¸¤ä¸ªéƒ¨åˆ†ï¼Œmodel_initè´Ÿè´£è¿›è¡Œæ¨¡å‹åŠ è½½ï¼Œè€Œdetectè´Ÿè´£è¿›è¡Œæ£€æµ‹å¹¶è¿”å›ç›¸å…³æ£€æµ‹ä¿¡æ¯ã€‚</p>\n<ul><li>model_initï¼šä¸»ä½“ä½¿ç”¨åŸå§‹çš„yolov5ä¸­çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸»è¦å‚æ•°å¯ä»¥åœ¨optä¸­è¿›è¡Œè®¾ç½®ã€‚å…¶ä¸­ï¼Œæƒé‡é»˜è®¤ä¸ºyolov5sï¼Œç•Œé¢ä¸­å¯ä»¥è‡ªå·±é€‰æ‹©æƒé‡ï¼Œæ ‡å‡†çš„sï¼Œmï¼Œxæ¨¡å‹æ˜¯æ”¯æŒçš„ã€‚</li><li>detectï¼šè€ƒè™‘åˆ°3ç§æ£€æµ‹æ¨¡å¼ä¸­éƒ½éœ€è¦ä½¿ç”¨é‡å¤è¾ƒå¤šçš„ä»£ç ï¼Œæ‰€ä»¥å°†å…¶æŠ½å‡ºä¸ºä¸€ä¸ªå‡½æ•°ã€‚è¾“å…¥ä¸ºåŸå§‹å›¾åƒï¼Œè¿”å›çš„æ˜¯æ£€æµ‹ä¿¡æ¯ã€‚</li><li>show_video_frameï¼šè´Ÿè´£å„å¸§å›¾åƒçš„æ£€æµ‹ä¸æ˜¾ç¤ºã€‚è¯¥å‡½æ•°åœ¨ç±»åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå·²ç»å’Œå®šæ—¶å™¨è¿›è¡Œç»‘å®šï¼Œè‹¥è®¡æ—¶è¶…æ—¶ï¼Œåˆ™è°ƒç”¨show_video_frameã€‚</li><li>button_video_stopï¼šé€šè¿‡è®¾ç½®num_stop è®¡æ•°ä¿¡å·é‡å’ŒblockSignalsæ¥æ§åˆ¶æ’­æ”¾ä¸æš‚åœã€‚</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"token comment\"># @Modified by: Ruihao</span>\n<span class=\"token comment\"># @ProjectName:yolov5-pyqt5</span>\n\n<span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> cv2\n<span class=\"token keyword\">import</span> argparse\n<span class=\"token keyword\">import</span> random\n<span class=\"token keyword\">import</span> torch\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> torch<span class=\"token punctuation\">.</span>backends<span class=\"token punctuation\">.</span>cudnn <span class=\"token keyword\">as</span> cudnn\n\n<span class=\"token keyword\">from</span> PyQt5 <span class=\"token keyword\">import</span> QtCore<span class=\"token punctuation\">,</span> QtGui<span class=\"token punctuation\">,</span> QtWidgets\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtCore <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtGui <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">from</span> PyQt5<span class=\"token punctuation\">.</span>QtWidgets <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n\n<span class=\"token keyword\">from</span> utils<span class=\"token punctuation\">.</span>torch_utils <span class=\"token keyword\">import</span> select_device\n<span class=\"token keyword\">from</span> models<span class=\"token punctuation\">.</span>experimental <span class=\"token keyword\">import</span> attempt_load\n<span class=\"token keyword\">from</span> utils<span class=\"token punctuation\">.</span>general <span class=\"token keyword\">import</span> check_img_size<span class=\"token punctuation\">,</span> non_max_suppression<span class=\"token punctuation\">,</span> scale_coords\n<span class=\"token keyword\">from</span> utils<span class=\"token punctuation\">.</span>datasets <span class=\"token keyword\">import</span> letterbox\n<span class=\"token keyword\">from</span> utils<span class=\"token punctuation\">.</span>plots <span class=\"token keyword\">import</span> plot_one_box2\n\n<span class=\"token keyword\">from</span> ui<span class=\"token punctuation\">.</span>detect_ui <span class=\"token keyword\">import</span> Ui_MainWindow <span class=\"token comment\"># å¯¼å…¥detect_uiçš„ç•Œé¢</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">UI_Logic_Window</span><span class=\"token punctuation\">(</span>QtWidgets<span class=\"token punctuation\">.</span>QMainWindow<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> parent<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>UI_Logic_Window<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span>parent<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>timer_video <span class=\"token operator\">=</span> QtCore<span class=\"token punctuation\">.</span>QTimer<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># åˆ›å»ºå®šæ—¶å™¨</span>\n        self<span class=\"token punctuation\">.</span>ui <span class=\"token operator\">=</span> Ui_MainWindow<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>setupUi<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>init_slots<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>cap <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>VideoCapture<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token comment\"># æš‚åœä¸æ’­æ”¾è¾…åŠ©ä¿¡å·ï¼Œnoteï¼šé€šè¿‡å¥‡å¶æ¥æ§åˆ¶æš‚åœä¸æ’­æ”¾</span>\n\n        <span class=\"token comment\"># æƒé‡åˆå§‹æ–‡ä»¶å</span>\n        self<span class=\"token punctuation\">.</span>openfile_name_model <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token comment\"># æ§ä»¶ç»‘å®šç›¸å…³æ“ä½œ</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">init_slots</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_img<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>button_image_open<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_video<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>button_video_open<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_camer<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>button_camera_open<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_weights<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>open_model<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_init<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>model_init<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_stop<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>button_video_stop<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_finish<span class=\"token punctuation\">.</span>clicked<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>finish_detect<span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>timeout<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>show_video_frame<span class=\"token punctuation\">)</span> <span class=\"token comment\"># å®šæ—¶å™¨è¶…æ—¶ï¼Œå°†æ§½ç»‘å®šè‡³show_video_frame</span>\n\n    <span class=\"token comment\"># æ‰“å¼€æƒé‡æ–‡ä»¶</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">open_model</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>openfile_name_model<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> QFileDialog<span class=\"token punctuation\">.</span>getOpenFileName<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_weights<span class=\"token punctuation\">,</span> <span class=\"token string\">'é€‰æ‹©weightsæ–‡ä»¶'</span><span class=\"token punctuation\">,</span>\n                                                             <span class=\"token string\">'weights/'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> self<span class=\"token punctuation\">.</span>openfile_name_model<span class=\"token punctuation\">:</span>\n            QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">u\"Warning\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u\"æ‰“å¼€æƒé‡å¤±è´¥\"</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">,</span>\n                                          defaultButton<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'åŠ è½½weightsæ–‡ä»¶åœ°å€ä¸ºï¼š'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>openfile_name_model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># åŠ è½½ç›¸å…³å‚æ•°ï¼Œå¹¶åˆå§‹åŒ–æ¨¡å‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">model_init</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># æ¨¡å‹ç›¸å…³å‚æ•°é…ç½®</span>\n        parser <span class=\"token operator\">=</span> argparse<span class=\"token punctuation\">.</span>ArgumentParser<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--weights'</span><span class=\"token punctuation\">,</span> nargs<span class=\"token operator\">=</span><span class=\"token string\">'+'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'weights/yolov5s.pt'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'model.pt path(s)'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--source'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'data/images'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'source'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># file/folder, 0 for webcam</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--img-size'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token number\">640</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'inference size (pixels)'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--conf-thres'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token number\">0.25</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'object confidence threshold'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--iou-thres'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token number\">0.45</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'IOU threshold for NMS'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--device'</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'cpu'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'cuda device, i.e. 0 or 0,1,2,3 or cpu'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--view-img'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'display results'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--save-txt'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'save results to *.txt'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--save-conf'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'save confidences in --save-txt labels'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--nosave'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'do not save images/videos'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--classes'</span><span class=\"token punctuation\">,</span> nargs<span class=\"token operator\">=</span><span class=\"token string\">'+'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'filter by class: --class 0, or --class 0 2 3'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--agnostic-nms'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'class-agnostic NMS'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--augment'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'augmented inference'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--update'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'update all models'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--project'</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'runs/detect'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'save results to project/name'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--name'</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'exp'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'save results to project/name'</span><span class=\"token punctuation\">)</span>\n        parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--exist-ok'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'existing project/name ok, do not increment'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>opt <span class=\"token operator\">=</span> parser<span class=\"token punctuation\">.</span>parse_args<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># é»˜è®¤ä½¿ç”¨optä¸­çš„è®¾ç½®ï¼ˆæƒé‡ç­‰ï¼‰æ¥å¯¹æ¨¡å‹è¿›è¡Œåˆå§‹åŒ–</span>\n        source<span class=\"token punctuation\">,</span> weights<span class=\"token punctuation\">,</span> view_img<span class=\"token punctuation\">,</span> save_txt<span class=\"token punctuation\">,</span> imgsz <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>source<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>view_img<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>save_txt<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>img_size\n\n        <span class=\"token comment\"># è‹¥openfile_name_modelä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨æ­¤æƒé‡è¿›è¡Œåˆå§‹åŒ–</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>openfile_name_model<span class=\"token punctuation\">:</span>\n            weights <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>openfile_name_model\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Using button choose model\"</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>device <span class=\"token operator\">=</span> select_device<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>half <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">.</span><span class=\"token builtin\">type</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'cpu'</span>  <span class=\"token comment\"># half precision only supported on CUDA</span>\n\n        cudnn<span class=\"token punctuation\">.</span>benchmark <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n\n        <span class=\"token comment\"># Load model</span>\n        self<span class=\"token punctuation\">.</span>model <span class=\"token operator\">=</span> attempt_load<span class=\"token punctuation\">(</span>weights<span class=\"token punctuation\">,</span> map_location<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># load FP32 model</span>\n        stride <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>stride<span class=\"token punctuation\">.</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># model stride</span>\n        self<span class=\"token punctuation\">.</span>imgsz <span class=\"token operator\">=</span> check_img_size<span class=\"token punctuation\">(</span>imgsz<span class=\"token punctuation\">,</span> s<span class=\"token operator\">=</span>stride<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># check img_size</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>half<span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>half<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># to FP16</span>\n\n        <span class=\"token comment\"># Get names and colors</span>\n        self<span class=\"token punctuation\">.</span>names <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>names <span class=\"token keyword\">if</span> <span class=\"token builtin\">hasattr</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">,</span> <span class=\"token string\">'module'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">else</span> self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">.</span>names\n        self<span class=\"token punctuation\">.</span>colors <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>random<span class=\"token punctuation\">.</span>randint<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"model initial done\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># è®¾ç½®æç¤ºæ¡†</span>\n        QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>information<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">u\"Notice\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u\"æ¨¡å‹åŠ è½½å®Œæˆ\"</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">,</span>\n                                      defaultButton<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç›®æ ‡æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">detect</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> name_list<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">'''\n        :param name_list: æ–‡ä»¶ååˆ—è¡¨\n        :param img: å¾…æ£€æµ‹å›¾ç‰‡\n        :return: info_show:æ£€æµ‹è¾“å‡ºçš„æ–‡å­—ä¿¡æ¯\n        '''</span>\n        showimg <span class=\"token operator\">=</span> img\n        <span class=\"token keyword\">with</span> torch<span class=\"token punctuation\">.</span>no_grad<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            img <span class=\"token operator\">=</span> letterbox<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> new_shape<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>img_size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            <span class=\"token comment\"># Convert</span>\n            img <span class=\"token operator\">=</span> img<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># BGR to RGB, to 3x416x416</span>\n            img <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>ascontiguousarray<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\n            img <span class=\"token operator\">=</span> torch<span class=\"token punctuation\">.</span>from_numpy<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>device<span class=\"token punctuation\">)</span>\n            img <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>half<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>half <span class=\"token keyword\">else</span> img<span class=\"token punctuation\">.</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># uint8 to fp16/32</span>\n            img <span class=\"token operator\">/=</span> <span class=\"token number\">255.0</span>  <span class=\"token comment\"># 0 - 255 to 0.0 - 1.0</span>\n            <span class=\"token keyword\">if</span> img<span class=\"token punctuation\">.</span>ndimension<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span>\n                img <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>unsqueeze<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># Inference</span>\n            pred <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>model<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> augment<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>augment<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n            <span class=\"token comment\"># Apply NMS</span>\n            pred <span class=\"token operator\">=</span> non_max_suppression<span class=\"token punctuation\">(</span>pred<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>conf_thres<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>iou_thres<span class=\"token punctuation\">,</span> classes<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>classes<span class=\"token punctuation\">,</span>\n                                       agnostic<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>opt<span class=\"token punctuation\">.</span>agnostic_nms<span class=\"token punctuation\">)</span>\n            info_show <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n            <span class=\"token comment\"># Process detections</span>\n            <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> det <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>pred<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">if</span> det <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span> <span class=\"token keyword\">and</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>det<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token comment\"># Rescale boxes from img_size to im0 size</span>\n                    det<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> scale_coords<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> det<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> showimg<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">for</span> <span class=\"token operator\">*</span>xyxy<span class=\"token punctuation\">,</span> conf<span class=\"token punctuation\">,</span> cls <span class=\"token keyword\">in</span> <span class=\"token builtin\">reversed</span><span class=\"token punctuation\">(</span>det<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                        label <span class=\"token operator\">=</span> <span class=\"token string\">'%s %.2f'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> conf<span class=\"token punctuation\">)</span>\n                        name_list<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>names<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n                        single_info <span class=\"token operator\">=</span> plot_one_box2<span class=\"token punctuation\">(</span>xyxy<span class=\"token punctuation\">,</span> showimg<span class=\"token punctuation\">,</span> label<span class=\"token operator\">=</span>label<span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>colors<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>cls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> line_thickness<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token comment\"># print(single_info)</span>\n                        info_show <span class=\"token operator\">=</span> info_show <span class=\"token operator\">+</span> single_info <span class=\"token operator\">+</span> <span class=\"token string\">\"\\n\"</span>\n        <span class=\"token keyword\">return</span>  info_show\n\n\n    <span class=\"token comment\"># æ‰“å¼€å›¾ç‰‡å¹¶æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">button_image_open</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button_image_open'</span><span class=\"token punctuation\">)</span>\n        name_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        img_name<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> QtWidgets<span class=\"token punctuation\">.</span>QFileDialog<span class=\"token punctuation\">.</span>getOpenFileName<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"æ‰“å¼€å›¾ç‰‡\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"data/images\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*.jpg;;*.png;;All Files(*)\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># åˆ¤æ–­å›¾ç‰‡æ˜¯å¦ä¸ºç©º</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> img_name<span class=\"token punctuation\">:</span>\n            QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">u\"Warning\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u\"æ‰“å¼€å›¾ç‰‡å¤±è´¥\"</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">,</span>\n                                          defaultButton<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>img_name<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>img_name<span class=\"token punctuation\">)</span>\n            info_show <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>detect<span class=\"token punctuation\">(</span>name_list<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>info_show<span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># æ£€æµ‹ä¿¡æ¯æ˜¾ç¤ºåœ¨ç•Œé¢</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>textBrowser<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span>info_show<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># æ£€æµ‹ç»“æœæ˜¾ç¤ºåœ¨ç•Œé¢</span>\n            self<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2BGRA<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">640</span><span class=\"token punctuation\">,</span> <span class=\"token number\">480</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> interpolation<span class=\"token operator\">=</span>cv2<span class=\"token punctuation\">.</span>INTER_AREA<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>QtImg <span class=\"token operator\">=</span> QtGui<span class=\"token punctuation\">.</span>QImage<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> QtGui<span class=\"token punctuation\">.</span>QImage<span class=\"token punctuation\">.</span>Format_RGB32<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>setPixmap<span class=\"token punctuation\">(</span>QtGui<span class=\"token punctuation\">.</span>QPixmap<span class=\"token punctuation\">.</span>fromImage<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>QtImg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>setScaledContents<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># è®¾ç½®å›¾åƒè‡ªé€‚åº”ç•Œé¢å¤§å°</span>\n\n    <span class=\"token comment\"># æ‰“å¼€è§†é¢‘å¹¶æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">button_video_open</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        video_name<span class=\"token punctuation\">,</span> _ <span class=\"token operator\">=</span> QtWidgets<span class=\"token punctuation\">.</span>QFileDialog<span class=\"token punctuation\">.</span>getOpenFileName<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">\"æ‰“å¼€è§†é¢‘\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"data/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"*.mp4;;*.avi;;All Files(*)\"</span><span class=\"token punctuation\">)</span>\n        flag <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>video_name<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> flag <span class=\"token operator\">==</span> <span class=\"token boolean\">False</span><span class=\"token punctuation\">:</span>\n            QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">u\"Warning\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u\"æ‰“å¼€è§†é¢‘å¤±è´¥\"</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">,</span>defaultButton<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ä»¥30msä¸ºé—´éš”ï¼Œå¯åŠ¨æˆ–é‡å¯å®šæ—¶å™¨</span>\n            <span class=\"token comment\"># è¿›è¡Œè§†é¢‘è¯†åˆ«æ—¶ï¼Œå…³é—­å…¶ä»–æŒ‰é”®ç‚¹å‡»åŠŸèƒ½</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_video<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_img<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_camer<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># æ‰“å¼€æ‘„åƒå¤´æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">button_camera_open</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Open camera to detect\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># è®¾ç½®ä½¿ç”¨çš„æ‘„åƒå¤´åºå·ï¼Œç³»ç»Ÿè‡ªå¸¦ä¸º0</span>\n        camera_num <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n        <span class=\"token comment\"># æ‰“å¼€æ‘„åƒå¤´</span>\n        self<span class=\"token punctuation\">.</span>cap <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>VideoCapture<span class=\"token punctuation\">(</span>camera_num<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># åˆ¤æ–­æ‘„åƒå¤´æ˜¯å¦å¤„äºæ‰“å¼€çŠ¶æ€</span>\n        bool_open <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">.</span>isOpened<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> bool_open<span class=\"token punctuation\">:</span>\n            QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>warning<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> <span class=\"token string\">u\"Warning\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">u\"æ‰“å¼€æ‘„åƒå¤´å¤±è´¥\"</span><span class=\"token punctuation\">,</span> buttons<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">,</span>\n                                          defaultButton<span class=\"token operator\">=</span>QtWidgets<span class=\"token punctuation\">.</span>QMessageBox<span class=\"token punctuation\">.</span>Ok<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_video<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_img<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_camer<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># å®šä¹‰è§†é¢‘å¸§æ˜¾ç¤ºæ“ä½œ</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">show_video_frame</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        name_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        flag<span class=\"token punctuation\">,</span> img <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> img <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n            info_show <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>detect<span class=\"token punctuation\">(</span>name_list<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">)</span> <span class=\"token comment\"># æ£€æµ‹ç»“æœå†™å…¥åˆ°åŸå§‹imgä¸Š</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>info_show<span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># æ£€æµ‹ä¿¡æ¯æ˜¾ç¤ºåœ¨ç•Œé¢</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>textBrowser<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span>info_show<span class=\"token punctuation\">)</span>\n\n            show <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">640</span><span class=\"token punctuation\">,</span> <span class=\"token number\">480</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ç›´æ¥å°†åŸå§‹imgä¸Šçš„æ£€æµ‹ç»“æœè¿›è¡Œæ˜¾ç¤º</span>\n            self<span class=\"token punctuation\">.</span>result <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>show<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2RGB<span class=\"token punctuation\">)</span>\n            showImage <span class=\"token operator\">=</span> QtGui<span class=\"token punctuation\">.</span>QImage<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                                     QtGui<span class=\"token punctuation\">.</span>QImage<span class=\"token punctuation\">.</span>Format_RGB888<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>setPixmap<span class=\"token punctuation\">(</span>QtGui<span class=\"token punctuation\">.</span>QPixmap<span class=\"token punctuation\">.</span>fromImage<span class=\"token punctuation\">(</span>showImage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>setScaledContents<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># è®¾ç½®å›¾åƒè‡ªé€‚åº”ç•Œé¢å¤§å°</span>\n\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>stop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">.</span>release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># è§†é¢‘å¸§æ˜¾ç¤ºæœŸé—´ï¼Œç¦ç”¨å…¶ä»–æ£€æµ‹æŒ‰é”®åŠŸèƒ½</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_video<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_img<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_camer<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># æš‚åœä¸ç»§ç»­æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">button_video_stop</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>blockSignals<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># æš‚åœæ£€æµ‹</span>\n        <span class=\"token comment\"># è‹¥QTimerå·²ç»è§¦å‘ï¼Œä¸”æ¿€æ´»</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>isActive<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token boolean\">True</span> <span class=\"token keyword\">and</span> self<span class=\"token punctuation\">.</span>num_stop<span class=\"token operator\">%</span><span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_stop<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token string\">u'æš‚åœæ£€æµ‹'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># å½“å‰çŠ¶æ€ä¸ºæš‚åœçŠ¶æ€</span>\n            self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token comment\"># è°ƒæ•´æ ‡è®°ä¿¡å·ä¸ºå¶æ•°</span>\n            self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>blockSignals<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># ç»§ç»­æ£€æµ‹</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_stop<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token string\">u'ç»§ç»­æ£€æµ‹'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># ç»“æŸè§†é¢‘æ£€æµ‹</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">finish_detect</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># self.timer_video.stop()</span>\n        self<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">.</span>release<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># é‡Šæ”¾cap</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>label<span class=\"token punctuation\">.</span>clear<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># æ¸…ç©ºlabelç”»å¸ƒ</span>\n        <span class=\"token comment\"># å¯åŠ¨å…¶ä»–æ£€æµ‹æŒ‰é”®åŠŸèƒ½</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_video<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_img<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_camer<span class=\"token punctuation\">.</span>setDisabled<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># ç»“æŸæ£€æµ‹æ—¶ï¼ŒæŸ¥çœ‹æš‚åœåŠŸèƒ½æ˜¯å¦å¤ä½ï¼Œå°†æš‚åœåŠŸèƒ½æ¢å¤è‡³åˆå§‹çŠ¶æ€</span>\n        <span class=\"token comment\"># Note:ç‚¹å‡»æš‚åœä¹‹åï¼Œnum_stopä¸ºå¶æ•°çŠ¶æ€</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>num_stop<span class=\"token operator\">%</span><span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Reset stop/begin!\"</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>ui<span class=\"token punctuation\">.</span>pushButton_stop<span class=\"token punctuation\">.</span>setText<span class=\"token punctuation\">(</span><span class=\"token string\">u'æš‚åœ/ç»§ç»­'</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>num_stop <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            self<span class=\"token punctuation\">.</span>timer_video<span class=\"token punctuation\">.</span>blockSignals<span class=\"token punctuation\">(</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    app <span class=\"token operator\">=</span> QtWidgets<span class=\"token punctuation\">.</span>QApplication<span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">)</span>\n    current_ui <span class=\"token operator\">=</span> UI_Logic_Window<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    current_ui<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sys<span class=\"token punctuation\">.</span>exit<span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">.</span>exec_<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n</code></pre>\n<h2><a id=\"__500\"></a><strong>äº”ã€ å‚è€ƒä¸è‡´è°¢</strong></h2>\n<ul><li>ã€ŠPyQt5å¿«é€Ÿå¼€å‘ä¸å®è·µã€‹</li><li>www.python3.vip</li><li>Bç«™ç™½æœˆé»‘ç¾½çš„PyQtæ•™ç¨‹ https://www.bilibili.com/video/BV1cJ411R7bP?from=search&amp;seid=7706040462590056686</li><li>https://xugaoxiang.blog.csdn.net/article/details/118384430 ä»è¿™ä¸ªåšä¸»çš„åšå®¢ä¸­å­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†ï¼Œæ„Ÿè§‰åšä¸»ï¼Œåšä¸»çš„ä»£ç æ¡†æ¶ä¹Ÿå¾ˆå¥½ï¼Œä¹Ÿæ˜¯æœ¬æ–‡ä»£ç æ˜¯åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œå­¦ä¹ å’Œä¿®æ”¹çš„</li><li>Githubé¡¹ç›®ï¼šYOLOv3GUI_Pytorch_PyQt5</li></ul>\n<p>** ç å­—çœŸçš„è¶…çº§è´¹æ—¶é—´ï¼Œè¯·è½¬è½½è¯·æ³¨æ˜å‡ºå¤„å“¦ï¼Œè°¢è°¢**</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}