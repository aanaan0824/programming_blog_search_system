{"blogid": "126255974", "writerAge": "ç é¾„1å¹´", "writerBlogNum": "44", "writerCollect": "1193", "writerComment": "2359", "writerFan": "1708", "writerGrade": "5çº§", "writerIntegral": "4039", "writerName": "èœ¡ç¬”é›ç”°å­¦å‰ç«¯", "writerProfileAdress": "writer_image\\profile_126255974.jpg", "writerRankTotal": "4551", "writerRankWeekly": "58", "writerThumb": "1242", "writerVisitNum": "122236", "blog_read_count": "3101", "blog_time": "å·²äºÂ 2022-08-29 09:57:41Â ä¿®æ”¹", "blog_title": "ã€ŠReactæ‰©å±•çŸ¥è¯†äºŒã€‹PureComponent / render props / Error boundary /ç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-dracula\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p><strong>å‰è¨€</strong></p>\n<blockquote>\n<p>åšä¸»ä¸»é¡µğŸ‘‰ğŸ»<a href=\"https://blog.csdn.net/xuxuii?spm=1011.2415.3001.5343\">èœ¡ç¬”é›ç”°å­¦ä»£ç </a><br/> ä¸“æ é“¾æ¥ğŸ‘‰ğŸ»<a href=\"https://blog.csdn.net/xuxuii/category_11838680.html\">Reactä¸“æ </a><br/> æ¥ä¸Šä¸€ç¯‡æ–‡ç« <a href=\"https://blog.csdn.net/xuxuii/article/details/126255881?spm=1001.2014.3001.5502\">reactçš„æ‰©å±•çŸ¥è¯†</a>ï¼Œä»Šå¤©æ¥å­¦ä¹ Reactçš„å¦å¤–ä¸€äº›æ‰©å±•çŸ¥è¯†<br/> æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä¸€èµ·æ¥çœ‹çœ‹å§~ğŸ¤</p>\n</blockquote>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" height=\"80%\" src=\"image\\80cb331b5e1e43ec84eb37d40acad767.jpeg\" width=\"80%\"/></p>\n<p></p>\n<div class=\"toc\">\n<h3>æ–‡ç« ç›®å½•</h3>\n<ul><li><a href=\"#1__10\">1. ç»„ä»¶ä¼˜åŒ–</a></li><li><ul><li><a href=\"#Component2_12\">Componentçš„2ä¸ªé—®é¢˜</a></li><li><a href=\"#shouldComponentUpdate_26\">é‡å†™shouldComponentUpdate()æ–¹æ³•</a></li><li><a href=\"#PureComponent_127\">ä½¿ç”¨PureComponent</a></li></ul>\n</li><li><a href=\"#2_render_props_159\">2. render props</a></li><li><ul><li><a href=\"#_161\">å¦‚ä½•å‘ç»„ä»¶å†…éƒ¨åŠ¨æ€ä¼ å…¥å¸¦å†…å®¹çš„ç»“æ„(æ ‡ç­¾)?</a></li><li><a href=\"#children_props_179\">children props</a></li><li><a href=\"#render_props_231\">render props</a></li></ul>\n</li><li><a href=\"#3_Error_boundary_283\">3. é”™è¯¯è¾¹ç•ŒError boundary</a></li><li><ul><li><a href=\"#_285\">ç†è§£</a></li><li><a href=\"#_291\">ç‰¹ç‚¹</a></li><li><a href=\"#_295\">ä½¿ç”¨æ–¹å¼</a></li></ul>\n</li><li><a href=\"#4__336\">4. ç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“</a></li><li><ul><li><a href=\"#_338\">ç»„ä»¶é—´çš„å…³ç³»</a></li><li><a href=\"#_344\">å‡ ç§é€šä¿¡æ–¹å¼</a></li><li><a href=\"#_356\">æ¯”è¾ƒå¥½çš„æ­é…æ–¹å¼</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"1__10\"></a>1. ç»„ä»¶ä¼˜åŒ–</h1>\n<h2><a id=\"Component2_12\"></a>Componentçš„2ä¸ªé—®é¢˜</h2>\n<blockquote>\n<p><code>é—®é¢˜1: </code>åªè¦æ‰§è¡ŒsetState()ï¼Œå³ä½¿ä¸æ”¹å˜çŠ¶æ€æ•°æ® ( this.setState({}))ï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°render() ==&gt; æ•ˆç‡ä½</p>\n<p><code>é—®é¢˜2: </code>åªè¦å½“å‰ç»„ä»¶é‡æ–°render()ï¼Œå°±ä¼šè‡ªåŠ¨é‡æ–°renderå­ç»„ä»¶ï¼Œçºµä½¿å­ç»„ä»¶æ²¡æœ‰ç”¨åˆ°çˆ¶ç»„ä»¶çš„ä»»ä½•æ•°æ® ==&gt; æ•ˆç‡ä½</p>\n</blockquote>\n<p><strong>æ•ˆç‡é«˜çš„åšæ³•</strong></p>\n<blockquote>\n<p>åªæœ‰<code>å½“ç»„ä»¶çš„stateæˆ–propsæ•°æ®å‘ç”Ÿæ”¹å˜</code>æ—¶æ‰é‡æ–°render()</p>\n</blockquote>\n<p><strong>åŸå› </strong></p>\n<blockquote>\n<p>Componentä¸­çš„<strong>shouldComponentUpdate()æ€»æ˜¯è¿”å›true</strong></p>\n</blockquote>\n<h2><a id=\"shouldComponentUpdate_26\"></a>é‡å†™shouldComponentUpdate()æ–¹æ³•</h2>\n<blockquote>\n<p><code>é—®é¢˜1: </code>åªè¦æ‰§è¡ŒsetState()ï¼Œå³ä½¿ä¸æ”¹å˜çŠ¶æ€æ•°æ® ( this.setState({}))ï¼Œç»„ä»¶ä¹Ÿä¼šé‡æ–°render() ==&gt; æ•ˆç‡ä½</p>\n</blockquote>\n<blockquote>\n<p>æ¯”è¾ƒæ–°æ—§stateæˆ–propsæ•°æ®ï¼Œå¦‚æœæœ‰å˜åŒ–æ‰è¿”å›trueï¼Œå¦‚æœæ²¡æœ‰è¿”å›false</p>\n</blockquote>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">carName</span><span class=\"token operator\">:</span> <span class=\"token string\">'å¥”é©°'</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">changeCar</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span>  <span class=\"token comment\">//ç›®å‰çš„propså’Œstate</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">,</span> nextState<span class=\"token punctuation\">)</span> <span class=\"token comment\">//æ¥ä¸‹æ¥è¦å˜åŒ–çš„ç›®æ ‡propsï¼Œç›®æ ‡state</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>carName <span class=\"token operator\">===</span> nextState<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'parent--render'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'parent'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯Parentç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span>æˆ‘çš„è½¦åå­—æ˜¯ï¼š<span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>changeCar<span class=\"token punctuation\">}</span><span class=\"token operator\">&gt;</span>ç‚¹æˆ‘æ¢è½¦<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>æ•ˆæœ</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" height=\"50%\" src=\"https://img-blog.csdnimg.cn/fcf49f94193043b5876b5e87c6e6f962.gif#pic_center\" width=\"50%\"/></p>\n<blockquote>\n<p>æ­¤æ—¶åœ¨ç‚¹å‡»å®ŒæŒ‰é’®ä¹‹åï¼Œå½“å‰ç»„ä»¶çš„stateçŠ¶æ€å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥shouldComponentUpdate()é‡Œçš„ifåˆ¤æ–­è¿”å›çš„æ˜¯falseï¼Œè¿›è€Œä¸ä¼šå¼•èµ·ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œä¸ä¼šè°ƒç”¨renderã€‚</p>\n</blockquote>\n<p><code>é—®é¢˜2</code>å’Œé—®é¢˜1ä¸€æ ·é‡å†™shouldComponentUpdate()æ–¹æ³•</p>\n<blockquote>\n<p>é—®é¢˜2: åªè¦å½“å‰ç»„ä»¶é‡æ–°render()ï¼Œå°±ä¼šè‡ªåŠ¨é‡æ–°renderå­ç»„ä»¶ï¼Œçºµä½¿å­ç»„ä»¶æ²¡æœ‰ç”¨åˆ°çˆ¶ç»„ä»¶çš„ä»»ä½•æ•°æ® ==&gt; æ•ˆç‡ä½</p>\n</blockquote>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./index.css'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">carName</span><span class=\"token operator\">:</span> <span class=\"token string\">'å¥”é©°'</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">changeCar</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">carName</span><span class=\"token operator\">:</span> <span class=\"token string\">'å®é©¬'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token comment\">// console.log(this.props, this.state)  //ç›®å‰çš„propså’Œstate</span>\n    <span class=\"token comment\">// console.log(nextProps, nextState) //æ¥ä¸‹æ¥è¦å˜åŒ–çš„ç›®æ ‡propsï¼Œç›®æ ‡state</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>carName <span class=\"token operator\">===</span> nextState<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'parent--render'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'parent'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯Parentç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span>æˆ‘çš„è½¦åå­—æ˜¯ï¼š<span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span>br <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>changeCar<span class=\"token punctuation\">}</span><span class=\"token operator\">&gt;</span>ç‚¹æˆ‘æ¢è½¦<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>Child carName<span class=\"token operator\">=</span><span class=\"token string\">'å¥¥æ‹“'</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Child</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span>  <span class=\"token comment\">//ç›®å‰çš„propså’Œstate</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>nextProps<span class=\"token punctuation\">,</span> nextState<span class=\"token punctuation\">)</span> <span class=\"token comment\">//æ¥ä¸‹æ¥è¦å˜åŒ–çš„ç›®æ ‡propsï¼Œç›®æ ‡state</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>carName <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'child--render'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'child'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯Childç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">&gt;</span>æˆ‘æ¥åˆ°çš„è½¦æ˜¯ï¼š<span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>carName<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>æ•ˆæœ</strong><br/> <img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" height=\"50%\" src=\"https://img-blog.csdnimg.cn/2f834b8a565742139c7fc448ffbe2b52.gif#pic_center\" width=\"50%\"/></p>\n<blockquote>\n<p>æ­¤æ—¶å­ç»„ä»¶æ¥æ”¶åˆ°çš„propsæ•°æ®æ˜¯å›ºå®šä¸å˜çš„ (<span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         &lt;\n        \n       \n       \n        &lt;\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.5782em; vertical-align: -0.0391em;\"></span><span class=\"mrel\">&lt;</span></span></span></span></span>Child carName=â€˜å¥¥æ‹“â€™ /&gt;) ï¼Œæ‰€ä»¥å­ç»„ä»¶é‡Œçš„shouldComponentUpdate()é‡Œçš„ifåˆ¤æ–­è¿”å›çš„æ˜¯falseï¼Œè¿›è€Œä¸ä¼šå¼•èµ·å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œä¸ä¼šè°ƒç”¨renderã€‚</p>\n</blockquote>\n<h2><a id=\"PureComponent_127\"></a>ä½¿ç”¨PureComponent</h2>\n<p>å½“stateçŠ¶æ€é‡Œæœ‰å¤šç»„æ•°æ®ï¼Œé‚£ä¹ˆshouldComponentUpdate()é‡Œå°±è¦è¿›è¡Œå¤šä¸ªåˆ¤æ–­ï¼Œè¿™æ ·æ˜¾ç„¶åœ¨çœŸæ­£å¼€å‘é‡Œæ˜¯ä¸å¯è¡Œçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç”¨æ‰‹åŠ¨å†™shouldComponentUpdate()æ–¹æ³•ï¼Œ <strong>ä½¿ç”¨PureComponent</strong>ï¼Œ å¯ä»¥é‡å†™shouldComponentUpdate()é‡Œçš„é€»è¾‘ï¼Œ åªæœ‰stateæˆ–propsæ•°æ®æœ‰å˜åŒ–æ‰è¿”å›trueã€‚(é¡¹ç›®ä¸­ä¸€èˆ¬ä½¿ç”¨PureComponentæ¥ä¼˜åŒ–)</p>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{<!-- --></span> PureComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token operator\">...</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PureComponent</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Child</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PureComponent</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span>\n</code></pre>\n<p>æ³¨æ„! ğŸ”¥ PureComponentåªæ˜¯<code>è¿›è¡Œstateå’Œpropsæ•°æ®çš„æµ…æ¯”è¾ƒ</code>ï¼Œå¦‚æœåªæ˜¯æ•°æ®å¯¹è±¡å†…éƒ¨æ•°æ®å˜äº†ï¼Œè¿”å›falseã€‚ <code>ä¸è¦ç›´æ¥ä¿®æ”¹stateæ•°æ®, è€Œæ˜¯è¦äº§ç”Ÿæ–°æ•°æ®</code></p>\n<pre><code class=\"prism language-js\"><span class=\"token comment\">//é”™è¯¯å†™æ³•</span>\n<span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\nobj<span class=\"token punctuation\">.</span>carName <span class=\"token operator\">=</span> <span class=\"token string\">'å®é©¬'</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span> \n</code></pre>\n<blockquote>\n<p>è¿™æ ·ä¿®æ”¹æ•°æ®ï¼Œåªæ˜¯<code>å¯¹åŸstateå¯¹è±¡å†…çš„å€¼åšäº†ä¿®æ”¹</code>ï¼Œä½†æ˜¯<code>å¯¹è±¡çš„å¼•ç”¨åœ°å€æ²¡å˜</code>ï¼ï¼<br/> åœ¨PureComponentçœ‹æ¥ï¼Œå¼•ç”¨åœ°å€æ²¡å˜æ—¶ï¼Œç»„ä»¶å†…éƒ¨çš„shouldComponentUpdateè¿”å›falseï¼Œä¹Ÿå°±ä¸ä¼šé‡æ–°renderï¼Œæ•°æ®æ›´æ–°å°±å¤±è´¥äº†ã€‚</p>\n</blockquote>\n<pre><code class=\"prism language-js\"><span class=\"token comment\">//æ­£ç¡®å†™æ³•</span>\n<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">carName</span><span class=\"token operator\">:</span> <span class=\"token string\">'å®é©¬'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<blockquote>\n<p>è¿™æ ·ä¿®æ”¹æ•°æ®ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ªæ–°å¯¹è±¡{ carName: â€˜å®é©¬â€™ }æ›¿æ¢äº†åŸæ¥çš„stateå¯¹è±¡ï¼Œæ•°æ®çš„å¼•ç”¨åœ°å€å˜åŒ–äº†ï¼Œé‚£ä¹ˆPureComponentç»„ä»¶å†…éƒ¨çš„shouldComponentUpdateè¿”å›trueï¼Œç»„ä»¶é‡æ–°renderï¼Œæ•°æ®æ›´æ–°æˆåŠŸã€‚</p>\n</blockquote>\n<h1><a id=\"2_render_props_159\"></a>2. render props</h1>\n<h2><a id=\"_161\"></a>å¦‚ä½•å‘ç»„ä»¶å†…éƒ¨åŠ¨æ€ä¼ å…¥å¸¦å†…å®¹çš„ç»“æ„(æ ‡ç­¾)?</h2>\n<p>Vueä¸­:</p>\n<blockquote>\n<p>ä½¿ç”¨slotæ’æ§½æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ç»„ä»¶æ ‡ç­¾ä½“ä¼ å…¥ç»“æ„</p>\n</blockquote>\n<pre><code class=\"prism language-js\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token constant\">B</span><span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n</code></pre>\n<p>Reactä¸­:</p>\n<blockquote>\n<p>ä½¿ç”¨children props: é€šè¿‡<code>ç»„ä»¶æ ‡ç­¾ä½“</code>ä¼ å…¥ç»“æ„</p>\n<p>ä½¿ç”¨render props: é€šè¿‡<code>ç»„ä»¶æ ‡ç­¾å±æ€§</code>ä¼ å…¥ç»“æ„ï¼Œè€Œä¸”å¯ä»¥<code>æºå¸¦æ•°æ®</code>ï¼Œä¸€èˆ¬ç”¨renderå‡½æ•°å±æ€§</p>\n</blockquote>\n<h2><a id=\"children_props_179\"></a>children props</h2>\n<pre><code class=\"prism language-js\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token constant\">B</span><span class=\"token operator\">&gt;</span>xxxx<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">B</span><span class=\"token operator\">&gt;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n<span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>\n<span class=\"token literal-property property\">é—®é¢˜</span><span class=\"token operator\">:</span> å¦‚æœ<span class=\"token constant\">B</span>ç»„ä»¶éœ€è¦<span class=\"token constant\">A</span>ç»„ä»¶å†…çš„æ•°æ®<span class=\"token punctuation\">,</span> <span class=\"token operator\">==</span><span class=\"token operator\">&gt;</span> åšä¸åˆ° \n</code></pre>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'parent'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯parentç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n          <span class=\"token operator\">&lt;</span><span class=\"token constant\">B</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯<span class=\"token constant\">A</span>ç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'b'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯<span class=\"token constant\">B</span>ç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>æ•ˆæœ</strong></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\f32fa279e5ab4be09dcf041e2d2a625f.png\"/></p>\n<h2><a id=\"render_props_231\"></a>render props</h2>\n<pre><code class=\"prism language-js\"><span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token operator\">&lt;</span><span class=\"token constant\">C</span> data<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span>data<span class=\"token punctuation\">}</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">C</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&gt;</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token constant\">A</span><span class=\"token operator\">&gt;</span>\n<span class=\"token constant\">A</span><span class=\"token literal-property property\">ç»„ä»¶</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>å†…éƒ¨stateæ•°æ®<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n<span class=\"token constant\">C</span><span class=\"token literal-property property\">ç»„ä»¶</span><span class=\"token operator\">:</span> è¯»å–<span class=\"token constant\">A</span>ç»„ä»¶ä¼ å…¥çš„æ•°æ®æ˜¾ç¤º <span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">}</span> \n</code></pre>\n<p>å¦‚æœåœ¨children propså†™æ³•çš„åŸºç¡€ä¸Š, è‹¥è¦å°†Aç»„ä»¶stateèº«ä¸Šçš„nameå±æ€§ä¼ ç»™Bç»„ä»¶, æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨render propsæ¥å†™:</p>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'parent'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯parentç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token operator\">&lt;</span><span class=\"token constant\">B</span> name<span class=\"token operator\">=</span><span class=\"token punctuation\">{<!-- --></span>name<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">A</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'jack'</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{<!-- --></span> name <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'a'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯<span class=\"token constant\">A</span>ç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n        <span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">B</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">'b'</span><span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h3<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯<span class=\"token constant\">B</span>ç»„ä»¶<span class=\"token punctuation\">,</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h3<span class=\"token operator\">&gt;</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>æ•ˆæœ</strong></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\beabc2d653ad4534805af7d2ea705257.jpeg\"/></p>\n<h1><a id=\"3_Error_boundary_283\"></a>3. é”™è¯¯è¾¹ç•ŒError boundary</h1>\n<h2><a id=\"_285\"></a>ç†è§£</h2>\n<p>é”™è¯¯è¾¹ç•Œ(Error boundary)ï¼šæŠŠé”™è¯¯æ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œæ¯”å¦‚åç«¯è¿”å›æ¥çš„æ•°æ®ç±»å‹å‡ºé”™ï¼Œæˆ–è€…ä¸€äº›å…¶ä»–çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç•Œé¢ä¸­æç¤ºç”¨æˆ·ä¸€äº›â€œç½‘ç»œç¹å¿™è¯·ç¨åé‡è¯•â€ä¿¡æ¯ï¼Œé”™è¯¯è¾¹ç•ŒError boundaryå°±æ˜¯ç”¨æ¥æ•è·<mark>åä»£ç»„ä»¶é”™è¯¯</mark>ï¼Œæ¸²æŸ“å‡ºå¤‡ç”¨é¡µé¢ã€‚</p>\n<p><code>é”™è¯¯è¾¹ç•Œä¸€èˆ¬æ˜¯åœ¨å®¹æ˜“å‘ç”Ÿé”™è¯¯çš„ç»„ä»¶çš„çˆ¶ç»„ä»¶ä¸­å¤„ç†ã€‚</code></p>\n<h2><a id=\"_291\"></a>ç‰¹ç‚¹</h2>\n<p>åªèƒ½æ•è·<strong>åä»£ç»„ä»¶</strong><mark>ç”Ÿå‘½å‘¨æœŸäº§ç”Ÿçš„é”™è¯¯</mark>ï¼Œä¸èƒ½æ•è·è‡ªå·±ç»„ä»¶äº§ç”Ÿçš„é”™è¯¯å’Œå…¶ä»–ç»„ä»¶åœ¨åˆæˆäº‹ä»¶ã€å®šæ—¶å™¨ä¸­äº§ç”Ÿçš„é”™è¯¯ã€‚</p>\n<h2><a id=\"_295\"></a>ä½¿ç”¨æ–¹å¼</h2>\n<p><strong>getDerivedStateFromErroré…åˆcomponentDidCatch</strong></p>\n<pre><code class=\"prism language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{<!-- --></span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span> <span class=\"token comment\">//ç”¨äºæ ‡è¯†å­ç»„ä»¶æ˜¯å¦äº§ç”Ÿé”™è¯¯</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// å¦‚æœParentç»„ä»¶çš„å­ç»„ä»¶å‡ºç°äº†ä»»ä½•çš„æŠ¥é”™ï¼Œéƒ½ä¼šè°ƒç”¨è¿™ä¸ªé’©å­å‡½æ•°ï¼Œè°ƒç”¨çš„æ—¶å€™ä¼ å…¥erroré”™è¯¯ä¿¡æ¯</span>\n  <span class=\"token keyword\">static</span> <span class=\"token function\">getDerivedStateFromError</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token literal-property property\">hasError</span><span class=\"token operator\">:</span> error <span class=\"token punctuation\">}</span><span class=\"token comment\">// è¿”å›æ–°çš„state</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">&gt;</span>\n        <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">&gt;</span>æˆ‘æ˜¯Parentç»„ä»¶<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">&gt;</span>\n        <span class=\"token punctuation\">{<!-- --></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>hasError <span class=\"token operator\">?</span> <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">&gt;</span>å½“å‰ç½‘ç»œä¸ç¨³å®šï¼Œè¯·ç¨åå†è¯•<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">&gt;</span> <span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span>Child <span class=\"token operator\">/</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">&gt;</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<pre><code class=\"prism language-js\"><span class=\"token comment\">// å¦‚æœç»„ä»¶åœ¨æ¸²æŸ“çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”±äºå­ç»„ä»¶å‡ºç°äº†é—®é¢˜ï¼Œå¼•å‘ä¸€äº›é”™è¯¯ï¼Œ</span>\n<span class=\"token comment\">//å°±ä¼šè°ƒç”¨æ­¤å‡½æ•°ï¼Œç”¨æ¥ç»Ÿè®¡é”™è¯¯ï¼Œåé¦ˆç»™æœåŠ¡å™¨ï¼Œç”¨äºé€šçŸ¥ç¼–ç äººå‘˜è¿›è¡Œbugçš„è§£å†³</span>\n<span class=\"token function\">componentDidCatch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error<span class=\"token punctuation\">,</span> info</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n  <span class=\"token comment\">// ç»Ÿè®¡é¡µé¢çš„é”™è¯¯ã€‚å‘é€è¯·æ±‚å‘é€åˆ°åå°å»</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">,</span> info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p><strong>æ•ˆæœ</strong></p>\n<p><img alt=\"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\" src=\"image\\8b88ba1888ec4ed6b903f0c39239f57e.jpeg\"/></p>\n<h1><a id=\"4__336\"></a>4. ç»„ä»¶é€šä¿¡æ–¹å¼æ€»ç»“</h1>\n<h2><a id=\"_338\"></a>ç»„ä»¶é—´çš„å…³ç³»</h2>\n<ul><li>çˆ¶å­ç»„ä»¶</li><li>å…„å¼Ÿç»„ä»¶ï¼ˆéåµŒå¥—ç»„ä»¶ï¼‰</li><li>ç¥–å­™ç»„ä»¶ï¼ˆè·¨çº§ç»„ä»¶ï¼‰</li></ul>\n<h2><a id=\"_344\"></a>å‡ ç§é€šä¿¡æ–¹å¼</h2>\n<ol><li>propsï¼š \n  <ul><li>children props</li><li>render props</li></ul> </li><li>æ¶ˆæ¯è®¢é˜…-å‘å¸ƒï¼š \n  <ul><li>pubs-subã€eventç­‰ç­‰</li></ul> </li><li>é›†ä¸­å¼çŠ¶æ€ç®¡ç†ï¼š \n  <ul><li>reduxã€dvaç­‰ç­‰</li></ul> </li><li>conText: \n  <ul><li>ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼</li></ul> </li></ol>\n<h2><a id=\"_356\"></a>æ¯”è¾ƒå¥½çš„æ­é…æ–¹å¼</h2>\n<blockquote>\n<p><mark>çˆ¶å­ç»„ä»¶</mark>ï¼šprops<br/> <mark>å…„å¼Ÿç»„ä»¶</mark>ï¼šæ¶ˆæ¯è®¢é˜…-å‘å¸ƒã€é›†ä¸­å¼ç®¡ç†<br/> <mark>ç¥–å­™ç»„ä»¶(è·¨çº§ç»„ä»¶)</mark>ï¼šæ¶ˆæ¯è®¢é˜…-å‘å¸ƒã€é›†ä¸­å¼ç®¡ç†ã€conText(å¼€å‘ç”¨çš„å°‘ï¼Œå°è£…æ’ä»¶ç”¨çš„å¤š)</p>\n</blockquote>\n<blockquote>\n<p><span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          ä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œå•¦âœ¨\n         \n        \n       \n       \n        \\textcolor{red}{ä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œå•¦âœ¨}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord cjk_fallback\" style=\"color: red;\">ä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œå•¦</span><span class=\"mord\" style=\"color: red;\">âœ¨</span></span></span></span></span> <br/><br/> <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          åŸåˆ›ä¸æ˜“ï¼Œè¿˜å¸Œæœ›å„ä½å¤§ä½¬æ”¯æŒä¸€ä¸‹\n         \n        \n       \n       \n        \\textcolor{blue}{åŸåˆ›ä¸æ˜“ï¼Œè¿˜å¸Œæœ›å„ä½å¤§ä½¬æ”¯æŒä¸€ä¸‹}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord cjk_fallback\" style=\"color: blue;\">åŸåˆ›ä¸æ˜“ï¼Œè¿˜å¸Œæœ›å„ä½å¤§ä½¬æ”¯æŒä¸€ä¸‹</span></span></span></span></span> <br/><br/> ğŸ¤ <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          ç‚¹èµï¼Œä½ çš„è®¤å¯æ˜¯æˆ‘åˆ›ä½œçš„åŠ¨åŠ›ï¼\n         \n        \n       \n       \n        \\textcolor{green}{ç‚¹èµï¼Œä½ çš„è®¤å¯æ˜¯æˆ‘åˆ›ä½œçš„åŠ¨åŠ›ï¼}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord cjk_fallback\" style=\"color: green;\">ç‚¹èµï¼Œä½ çš„è®¤å¯æ˜¯æˆ‘åˆ›ä½œçš„åŠ¨åŠ›ï¼</span></span></span></span></span> <br/><br/> â­ï¸ <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          æ”¶è—ï¼Œä½ çš„é’çæ˜¯æˆ‘åŠªåŠ›çš„æ–¹å‘ï¼\n         \n        \n       \n       \n        \\textcolor{green}{æ”¶è—ï¼Œä½ çš„é’çæ˜¯æˆ‘åŠªåŠ›çš„æ–¹å‘ï¼}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord cjk_fallback\" style=\"color: green;\">æ”¶è—ï¼Œä½ çš„é’çæ˜¯æˆ‘åŠªåŠ›çš„æ–¹å‘ï¼</span></span></span></span></span> <br/><br/> âœï¸ <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n     \n      \n       \n        \n         \n          è¯„è®ºï¼Œä½ çš„æ„è§æ˜¯æˆ‘è¿›æ­¥çš„è´¢å¯Œï¼\n         \n        \n       \n       \n        \\textcolor{green}{è¯„è®ºï¼Œä½ çš„æ„è§æ˜¯æˆ‘è¿›æ­¥çš„è´¢å¯Œï¼}\n       \n      \n     </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.6833em;\"></span><span class=\"mord cjk_fallback\" style=\"color: green;\">è¯„è®ºï¼Œä½ çš„æ„è§æ˜¯æˆ‘è¿›æ­¥çš„è´¢å¯Œï¼</span></span></span></span></span> <br/></p>\n</blockquote>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}