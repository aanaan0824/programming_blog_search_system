{"blogid": "126743128", "writerAge": "码龄4年", "writerBlogNum": "239", "writerCollect": "818", "writerComment": "115", "writerFan": "218", "writerGrade": "5级", "writerIntegral": "3610", "writerName": "beidou111", "writerProfileAdress": "writer_image\\profile_126743128.jpg", "writerRankTotal": "5273", "writerRankWeekly": "8281", "writerThumb": "223", "writerVisitNum": "204088", "blog_read_count": "18", "blog_time": "于 2022-09-07 12:28:19 发布", "blog_title": "CMake链接外部库", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>环境：win10+VS Code + cmake</p>\n<h1><a id=\"_2\"></a>自己生成一个外部库</h1>\n<p>我们首先自己生成一个库，叫mylib.lib<br/> 注意这是单独的一个项目<br/> <img alt=\"在这里插入图片描述\" src=\"image\\475653939b834595a404e980d390106d.png\"/></p>\n<p>CMakeLists.txt</p>\n<pre><code class=\"prism language-cpp\"><span class=\"token function\">cmake_minimum_required</span><span class=\"token punctuation\">(</span>VERSION <span class=\"token number\">3.20</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">project</span><span class=\"token punctuation\">(</span>buildLib<span class=\"token punctuation\">)</span>\n<span class=\"token function\">add_library</span><span class=\"token punctuation\">(</span>mylib STATIC mylib<span class=\"token punctuation\">.</span>cpp<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>mylib.cpp</p>\n<pre><code class=\"prism language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream&gt;</span></span>\n<span class=\"token keyword\">void</span> <span class=\"token function\">callMyLib</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    std<span class=\"token double-colon punctuation\">::</span>cout<span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">\"called my lib!\\n\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>mylib.h</p>\n<pre><code class=\"prism language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">callMyLib</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h1><a id=\"_27\"></a>引入自己生成的外部库</h1>\n<p>注意这又是一个另外的项目，和之前没有关系。</p>\n<p>把之前生成的mylib.lib和mylib.h拷贝到这个项目里面，位置如下<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ab8cb085940a45619920a37fbd511569.png\"/><br/> CMakeLists.txt <strong>(重点）</strong></p>\n<pre><code class=\"prism language-cpp\"><span class=\"token function\">cmake_minimum_required</span><span class=\"token punctuation\">(</span>VERSION <span class=\"token number\">3.20</span><span class=\"token punctuation\">)</span>\n<span class=\"token function\">project</span><span class=\"token punctuation\">(</span>linkLib<span class=\"token punctuation\">)</span>\n<span class=\"token function\">include_directories</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">{<!-- --></span>PROJECT_SOURCE_DIR<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>myLib<span class=\"token operator\">/</span>include<span class=\"token punctuation\">)</span>\n<span class=\"token function\">link_directories</span><span class=\"token punctuation\">(</span>$<span class=\"token punctuation\">{<!-- --></span>PROJECT_SOURCE_DIR<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span>myLib<span class=\"token operator\">/</span>lib<span class=\"token punctuation\">)</span>\n<span class=\"token function\">add_executable</span><span class=\"token punctuation\">(</span>main main<span class=\"token punctuation\">.</span>cpp<span class=\"token punctuation\">)</span>\n<span class=\"token function\">target_link_libraries</span><span class=\"token punctuation\">(</span>main mylib<span class=\"token punctuation\">.</span>lib<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>include_directories(${PROJECT_SOURCE_DIR}/myLib/include)<br/> 添加头文件目录</p>\n<p>link_directories(${PROJECT_SOURCE_DIR}/myLib/lib)<br/> 添加库目录</p>\n<p>add_executable(main main.cpp)<br/> 编译main.exe</p>\n<p>target_link_libraries(main mylib.lib)<br/> 把mylib.lib链接到main.exe</p>\n<p>main.cpp</p>\n<pre><code class=\"prism language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream&gt;</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"mylib.h\"</span></span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token function\">callMyLib</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>运行结果<br/> <img alt=\"在这里插入图片描述\" src=\"image\\c7d3609bdb774823896f06bb7ef136db.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}