{"blogid": "120409716", "writerAge": "码龄4年", "writerBlogNum": "236", "writerCollect": "1349", "writerComment": "318", "writerFan": "14015", "writerGrade": "6级", "writerIntegral": "6235", "writerName": "Tony+", "writerProfileAdress": "writer_image\\profile_120409716.jpg", "writerRankTotal": "2318", "writerRankWeekly": "1550", "writerThumb": "312", "writerVisitNum": "361299", "blog_read_count": "10762", "blog_time": "已于 2022-07-04 14:42:48 修改", "blog_title": "时间序列深度学习模型AAAI 2021论文之一Informer的主要代码解读、项目运作、自定义数据集使用", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>更新目录</h3>\n<br/>\n<strong>2021-10-11 14:10 更新：informer的预测本质</strong>\n</div>\n<p></p>\n<p><strong>经调试发现，informer的预测并不存在这种问题（时间预测的悖论），请看第七点提到的。</strong></p>\n<p><strong>2021-11 <a href=\"https://blog.csdn.net/qq_42658739/article/details/121100581\">如何安装GPU版本的ML框架、而且是多版本共存的那种，两种方法</a></strong><br/> <strong>2021-11-10 群友提供实现随机种子的函数实现以及具体分析</strong><br/> <strong>2022更新 注释链接和代码以及说明、案例在文章底部</strong></p>\n<p></p>\n<div class=\"toc\">\n<h3>一、前言</h3>\n<br/> 本文章是对informer开源代码进行自定义数据集（就是如何修改代码以跑通自己的数据集，毕竟原代码仓库没有注释）的使用的代码修改和代码流程解释。由于该informer项目仓库的源码没有注释，本文是包含注释的内容。\n</div>\n<p></p>\n<p><strong>以Github上的源码为准！以Github上的源码为准！以Github上的源码为准！</strong></p>\n<p><strong>要想得到好的模型效果，你要做的不只是拿数据套模型而已！套模型调参、修改模型之前你要的事情还有很多，这些事情几乎占用你整个项目的60%的时间！</strong></p>\n<p></p>\n<div class=\"toc\">\n<h3>二、informer相关</h3>\n</div>\n<p></p>\n<ol><li>论文：<a href=\"https://arxiv.org/abs/2012.07436\">https://arxiv.org/abs/2012.07436</a></li><li>代码仓库：<a href=\"https://github.com/zhouhaoyi/Informer2020\">https://github.com/zhouhaoyi/Informer2020</a></li><li>简介：据网上说是被评为<strong>AAAI 2021最佳论文</strong>，其作者设计了一种专为LSTF （长序列时间序列预测）设计的基于Transformer的改进模型 Informer，来解决Transformer在应用于LSTF时存在一些严重的问题。比如二次时间复杂度、较高的内存使用量和编解码器结构的固有限制等。Informer具有三个显著特点：采用ProbSparse自关注机制、自注意力提炼、生成式解码器。</li><li>感谢论文作者对AI科学做出的贡献，才能像我这种普通人能有机会接触这么nice的文章。作者的github：<a href=\"https://github.com/zhouhaoyi/Informer2020\">https://github.com/zhouhaoyi/Informer2020</a></li></ol>\n<p></p>\n<div class=\"toc\">\n<h3>三、informer原理和模型架构</h3>\n</div>\n<p></p>\n<p>这里<strong>请自行百度</strong>，百度讲的<strong>比较透彻</strong>，比如：</p>\n<ul><li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <a href=\"https://blog.csdn.net/m0_50811752/article/details/116373077\">AAAI 2021最佳论文 Informer</a></li><li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <a href=\"https://baijiahao.baidu.com/s?id=1694864669592216695&amp;wfr=spider&amp;for=pc\">AAAI 2021最佳论文《Informer》作者：Transformer 最新进展</a></li><li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> <a href=\"https://blog.csdn.net/FrankieHello/article/details/113830278\">解读：Informer——比Transformer更有效的长时间序列预测方法</a></li><li class=\"task-list-item\"><input class=\"task-list-item-checkbox\" disabled=\"disabled\" type=\"checkbox\"/> …</li></ul>\n<p></p>\n<div class=\"toc\">\n<h3>四、informer代码框架、 流水线解读</h3>\n</div>\n<p></p>\n<p>1.informer的项目结构：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\d0f7e73eeb264fd9acd2d8df3c538b01.png\"/></p>\n<p><strong>以上主要看红色框框部分，一个框框相当于一个模块，从上到下依次的模块含义是：</strong></p>\n<ul><li>①：项目的数据文件夹，其中data_loader文件是加载数据、预处理数据的作用。</li><li>②：项目的训练功能文件夹，这里面的py文件是用来训练模型的作用。</li><li>③：model文件夹，这里包含了模型的详细结构实现、各种作者提出的新的东西都在里面。</li><li>④：scripts文件夹，这里包含了模型的启动脚本、使用脚本。</li><li>⑤：utols文件夹，这里包含了模型的评估指标、时间轴的时间特征处理、指数缩减学习率、提前停止训练策略、数据标准化策略等功能。当然，还有作者提出的新型mask也在这里面。</li><li>⑥：第六部分这里是项目的启动入口main_informer文件（该文件包含了程序入口、变量初始化设置等），还有readme文件、还有依赖包文件。</li></ul>\n<p>注意，如果你还没创建好项目的先创建好项目，然后配置解释器，之后：</p>\n<pre><code class=\"prism language-python\">pip install <span class=\"token operator\">-</span>r requirements<span class=\"token punctuation\">.</span>txt\n</code></pre>\n<p></p>\n<div class=\"toc\">\n<h3>五、快速跑通示例和自定义数据集</h3>\n</div>\n<p></p>\n<p><strong>1.运行示例</strong></p>\n<p>配置好项目和安装好模块之后，先启动作者给出的数据文件看看是否能够启动：</p>\n<p>作者给出的是这样的命令：</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token comment\"># ETTh1</span>\npython <span class=\"token operator\">-</span>u main_informer<span class=\"token punctuation\">.</span>py <span class=\"token operator\">--</span>model informer <span class=\"token operator\">--</span><span class=\"token keyword\">data</span> ETTh1 <span class=\"token operator\">--</span>attn prob <span class=\"token operator\">--</span>freq h\n\n<span class=\"token comment\"># ETTh2</span>\npython <span class=\"token operator\">-</span>u main_informer<span class=\"token punctuation\">.</span>py <span class=\"token operator\">--</span>model informer <span class=\"token operator\">--</span><span class=\"token keyword\">data</span> ETTh2 <span class=\"token operator\">--</span>attn prob <span class=\"token operator\">--</span>freq h\n\n<span class=\"token comment\"># ETTm1</span>\npython <span class=\"token operator\">-</span>u main_informer<span class=\"token punctuation\">.</span>py <span class=\"token operator\">--</span>model informer <span class=\"token operator\">--</span><span class=\"token keyword\">data</span> ETTm1 <span class=\"token operator\">--</span>attn prob <span class=\"token operator\">--</span>freq t\n\n</code></pre>\n<p>当然也可以这样就好（然后在代码文件中设置好数据和时间频率）：</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token comment\"># ETTh1</span>\npython <span class=\"token operator\">-</span>u main_informer<span class=\"token punctuation\">.</span>py <span class=\"token operator\">--</span>model informer <span class=\"token operator\">--</span><span class=\"token keyword\">data</span> ETTh1 \n</code></pre>\n<p>启动成功之后，可以去配置成自己所需要的自定义数据集。</p>\n<p><strong>2.跑通自定义数据集</strong></p>\n<p>将自定义数据序列数据集文件夹添加到data文件夹下之后，前往代码修改以下几个地方：<br/> 首先，你的自定义数据集的时间列的字段名称 要是“date”，当然也可以不是，但是那样的话需要去改一下dataframe代码的列名。</p>\n<p>（1）main_informer里面：</p>\n<pre><code class=\"prism language-python\">parser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--data'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> required<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'titick'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'data them'</span><span class=\"token punctuation\">)</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--root_path'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'./data/titick/'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'数据文件的根路径（root path of the data file）'</span><span class=\"token punctuation\">)</span>\n\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--features'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\n\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--data_path'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token string\">'日均价.csv'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'data file'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 想要获得最终预测的话这里应该设置为True；否则将是获得一个标准化的预测。</span>\nparser<span class=\"token punctuation\">.</span>add_argument<span class=\"token punctuation\">(</span><span class=\"token string\">'--inverse'</span><span class=\"token punctuation\">,</span> action<span class=\"token operator\">=</span><span class=\"token string\">'store_true'</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">help</span><span class=\"token operator\">=</span><span class=\"token string\">'逆标准化输出数据'</span>\n                                                           <span class=\"token string\">'inverse output data'</span><span class=\"token punctuation\">,</span> default<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<pre><code class=\"prism language-python\">data_parser <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">'ETTh1'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ETTh1.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'OT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ETTh2'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ETTh2.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'OT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ETTm1'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ETTm1.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'OT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ETTm2'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ETTm2.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'OT'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'WTH'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'WTH.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'WetBulbCelsius'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'ECL'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'ECL.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'MT_320'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">321</span><span class=\"token punctuation\">,</span><span class=\"token number\">321</span><span class=\"token punctuation\">,</span><span class=\"token number\">321</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">321</span><span class=\"token punctuation\">,</span><span class=\"token number\">321</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Solar'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'solar_AL.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'POWER_136'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'titick'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{<!-- --></span><span class=\"token string\">'data'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'日均价.csv'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'T'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'S'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token string\">'MS'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>（2）还有exp_informer文件的这里：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\2d55d5c501b8446db56d674360310be4.png\"/></p>\n<p></p>\n<div class=\"toc\">\n<h3>六、修改自定义数据集部分模块的主要解读</h3>\n</div>\n<p></p>\n<p><strong>注意：</strong><br/> <strong>将随机打散数据的设置关掉将有助于你去调试模型，去观察张量维度变化。如下：</strong></p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\173a37095b534d5d94b434944a2eb50d.png\"/></p>\n<p></p>\n<div class=\"toc\">\n<h3>七、代码疑惑点：是否存在时间预测的悖论【不存在】</h3>\n<br/> 预测功能的时候本身有可能还是将已知数据作为输入来预测未来，因为现实场景中不会那样的。（说 有可能 主要是我不敢确定是不是，因为我毕竟习惯和常用TensorFlow，pytorch的代码不是看的很清晰）\n</div>\n<p></p>\n<p>这种现实场景就是：假如要预测2021-12-10~2021-12-20号的数据，但是需要2021-11-05到2021-12-09号的数据作为输入X才能实现预测，但是现在还没到11-05，所以那部分X数据就是未来的、是未知的，这种情况下就无法预测，这个是现实问题。</p>\n<p>详细请看我的这篇博客：<br/> <a href=\"https://blog.csdn.net/qq_42658739/article/details/118928809\">LSTM时间序列预测存在的问题–滑动窗口是一把双刃剑 | Python技能树征题</a></p>\n<p><strong>2021-10-11 14:10 更新：informer的预测本质</strong></p>\n<p><strong>经调试发现，informer的预测并不存在这种问题（时间预测的悖论）。</strong></p>\n<p></p>\n<div class=\"toc\">\n<h3>八、实验发现存在的一些疑惑</h3>\n</div>\n<p></p>\n<ul><li>在预测未来的时候，如果是长时间预测则无法较好的预测出突变的信息，如果是短期的预测（比如2~3个时间点）才能预测出突变，但是不稳定。</li><li>更换了损失函数发现原装的mse相对最好，mse特性本身就是对“异常点”有鲁棒性。huber loss进行长序列预测的时候容易趋于稳定。</li><li>关于shuffle_flag的设置，训练集的shuffle_flag如果为Flase的话发现预测的时候predict会很好但是需要把dropout设置的比较大比如0.5，为True的话需要把dropout设置的比较小比如0.05。</li></ul>\n<p><strong>仅为个人的数据集上的实验内容，每个数据集可能都不一样。有什么好的方法留言一起交流。</strong></p>\n<p></p>\n<div class=\"toc\">\n<h3>九、仓库</h3>\n</div>\n<p></p>\n<p><strong>2022-06-26 <a href=\"https://github.com/chenruhai/informer_ChineseNotes\">代码分享，如果您觉得对您有帮助，欢迎您为仓库点个star</a></strong></p>\n<p>最后：据说SCINet论文和代码结果相对informer来说更好，可以去试试这个2021年的新模型。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}