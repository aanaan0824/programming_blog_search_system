{"blogid": "124424438", "writerAge": "码龄4年", "writerBlogNum": "37", "writerCollect": "60", "writerComment": "8", "writerFan": "46", "writerGrade": "3级", "writerIntegral": "687", "writerName": "浅丿忆十一", "writerProfileAdress": "writer_image\\profile_124424438.jpg", "writerRankTotal": "51494", "writerRankWeekly": "93387", "writerThumb": "29", "writerVisitNum": "37895", "blog_read_count": "1499", "blog_time": "已于 2022-04-28 10:07:51 修改", "blog_title": "Unity Shader学习之Unity Shader中常用变量、文件等说明", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<p><span style=\"color:#fe2c24;\"><strong>1.顶点/片元函数声明</strong></span></p>\n<p>#pragma vertex name</p>\n<p>#pragma fragment name</p>\n<p>其中name为函数名</p>\n<p><span style=\"color:#fe2c24;\"><strong>2.常用语义</strong></span></p>\n<p style=\"text-align:center;\">从应用阶段传递模型数据给顶点着色器时Unity支持的常用语义</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">语义</td><td style=\"text-align:center;\">描述</td></tr><tr><td>POSITION</td><td>模型空间中的顶点位置，通常为float4类型</td></tr><tr><td>NORMAL</td><td>顶点法线，通常为float3类型</td></tr><tr><td>TANGENT</td><td>顶点切线，通常为float4类型</td></tr><tr><td> <p>TEXCOORDn，如TEXCOORD0，TEXCOORD1等</p> </td><td>该顶点的纹理坐标，TEXCOORD0表示第一组纹理坐标，依此类推，通常为float2或float4类型</td></tr><tr><td>COLOR</td><td>顶点颜色，通常是fixed4或float4</td></tr></tbody></table>\n<p style=\"text-align:center;\">从顶点着色器传递数据给片元着色器时Unity使用的常用语义</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">语义</td><td style=\"text-align:center;\">描述</td></tr><tr><td>SV_POSITION</td><td>裁剪空间中的顶点坐标，结构体中必须包含一个用该语义修饰的变量。等同于DirectX9中的POSITION，但最好使用SV_POSITION</td></tr><tr><td>COLOR0</td><td>通常用于输出第一组顶点颜色，但不是必须的</td></tr><tr><td>COLOR1</td><td>通常用于输出第二组顶点颜色，但不是必须的</td></tr><tr><td>TEXCOORD0~TEXCOORD7</td><td>通常用于输出纹理坐标，但不是必须的</td></tr></tbody></table>\n<p style=\"text-align:center;\">片元着色器输出时Unity支持的常用语义</p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">语义</td><td style=\"text-align:center;\">描述</td></tr><tr><td>SV_Target</td><td>输出值将会存储到渲染目标（render target）中。等同于DirectX9中的COLOR语义，但最好使用SV_Target</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>3.ShaderLab属性类型和Cg变量类型的匹配关系</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">ShaderLab属性类型</td><td style=\"text-align:center;\">Cg变量类型</td></tr><tr><td>Color，Vector</td><td>float4，half4，fixed4</td></tr><tr><td>Range，Float</td><td>float，half，fixed</td></tr><tr><td>2D</td><td>sampler2D</td></tr><tr><td>Cube</td><td>samplerCube</td></tr><tr><td>3D</td><td>sampler3D</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>4.UnityShader中常用的包含文件</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">文件名</td><td style=\"text-align:center;\">描述</td></tr><tr><td>UnityCG.cginc</td><td>包含了最常使用的帮助函数、宏和结构体等</td></tr><tr><td>UnityShaderVariables.cginc</td><td>在编译Unity Shader时，会被自动包含进来。包含了很多内置的全局变量，如UNITY_MATRIX_MVP等</td></tr><tr><td>Lighting.cginc</td><td>包含了各种内置的光照模型，如果编写的是Surface Shader的话，会自动包含进来</td></tr><tr><td>HLSLSupport.cginc</td><td>在编译Unity Shader时，会被自动包含进来。声明了很多跨平台编译的宏和定义</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>5.UnityCG.cginc中一些常用的结构体</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">名称</td><td style=\"text-align:center;\">描述</td><td style=\"text-align:center;\">包含的变量</td></tr><tr><td>appdata_base</td><td>可用于顶点着色器的输入</td><td>顶点位置、顶点法线、第一组纹理坐标</td></tr><tr><td>appdata_tan</td><td>可用于顶点着色器的输入</td><td>顶点位置、顶点切线、顶点法线、第一组纹理坐标</td></tr><tr><td>appdata_full</td><td>可用于顶点着色器的输入</td><td>顶点位置、顶点切线、顶点法线、四组（或更多）纹理坐标</td></tr><tr><td>appdata_img</td><td>可用于顶点着色器的输入</td><td>顶点位置、第一组纹理坐标</td></tr><tr><td>v2f_img</td><td>可用于顶点着色器的输出</td><td>裁剪空间中的位置、纹理坐标</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>6.UnityCG.cginc中的一些常用的帮助函数</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">函数名</td><td style=\"text-align:center;\">描述</td></tr><tr><td>float3 WorldSpaceViewDir(float4 v)</td><td>输入一个模型空间中的顶点位置，返回世界空间中从该点到摄像机的观察方向</td></tr><tr><td>float3 ObjSpaceViewDir(float4 v)</td><td>输入一个模型空间中的顶点位置，返回模型空间中从该点到摄像机的观察方向</td></tr><tr><td>float3 WorldSpaceLightDir(float4 v)</td><td><strong>仅可用于前向渲染中</strong>。输入一个模型空间中的顶点位置，返回世界空间中从该点到光源的光照方向。没有被归一化</td></tr><tr><td>float3 ObjSpaceLightDir(float4 v)</td><td><strong>仅可用于前向渲染中</strong>。输入一个模型空间中的顶点位置，返回模型空间中从该点到光源的光照方向。没有被归一化</td></tr><tr><td>float3 UnityObjectToWorldNormal(float3 norm)</td><td>把法线方向从模型空间转换到世界空间中。</td></tr><tr><td>float3 UnityObjectToWorldDir(float3 dir)</td><td>把方向矢量从模型空间转换到世界空间中。</td></tr><tr><td>float3 UnityWorldToObjectDir(float3 dir)</td><td>把方向矢量从世界空间变换到模型空间中。</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>7.Cg/HLSL中3种精度的数值类型</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">类型</td><td style=\"text-align:center;\">精度</td></tr><tr><td>float</td><td>最高精度的浮点值。通常使用32位来存储。</td></tr><tr><td>half</td><td>中等精度的浮点值。通常使用16位来存储，精度范围是-60000~60000</td></tr><tr><td>fixed</td><td>最低精度的浮点值。通常使用11位来存储，精度范围是-2.0~2.0</td></tr></tbody></table>\n<p><span style=\"color:#fe2c24;\"><strong>8.Unity支持的Shader Target</strong></span></p>\n<table border=\"1\" cellpadding=\"1\" cellspacing=\"1\" style=\"width:500px;\"><tbody><tr><td style=\"text-align:center;\">指令</td><td style=\"text-align:center;\">描述</td></tr><tr><td>#pragma target 2.0</td><td> <p>默认的Shader Target等级。相当于Direct3D 9上的</p> <p>Shader Model 2.0，不支持对顶点纹理的采样，</p> <p>不支持显式的LOD纹理采样</p> </td></tr><tr><td>#pragma target 3.0</td><td> <p>相当于Direct3D 9上的Shader Model 3.0，支持对</p> <p>顶点纹理的采样等。</p> </td></tr><tr><td>#pragma target 4.0</td><td> <p>相当于Direct3D 9上的Shader Model 4.0，支持几何</p> <p>着色器等</p> </td></tr><tr><td>#pragma target 5.0</td><td>相当于Direct3D 9上的Shader Model 5.0</td></tr></tbody></table>\n<p></p>\n</div>\n</div>"}