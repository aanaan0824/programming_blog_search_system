{"blogid": "125693678", "writerAge": "码龄2年", "writerBlogNum": "3", "writerCollect": "0", "writerComment": "0", "writerFan": "9", "writerGrade": "1级", "writerIntegral": "38", "writerName": "辉哥威武", "writerProfileAdress": "writer_image\\profile_125693678.jpg", "writerRankTotal": "145269", "writerRankWeekly": "1397418", "writerThumb": "6", "writerVisitNum": "1464", "blog_read_count": "883", "blog_time": "已于 2022-07-09 16:58:42 修改", "blog_title": "在Unity中使用C#调用C++动态链接库（DLL）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>一、创建C++动态链接库（DLL）<br/> 二、将Dll库在Unity工程中调用二、将Dll库在Unity工程中调用@<a href=\"%E8%BF%99%E9%87%8C%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%AE%E5%BD%95%E6%A0%87%E9%A2%98\">TOC</a></p>\n<h1><a id=\"CDLL_3\"></a>一、创建C++动态链接库（DLL）</h1>\n<h2><a id=\"1C_4\"></a>1、创建一个C++的空项目（如下图）</h2>\n<p>创建一个C++的空项目：<img alt=\"在这里插入图片描述\" src=\"image\\3f99a342147c4f95b167c4c239a76be0.png\"/></p>\n<h2><a id=\"2_7\"></a>2、配置项目属性为动态链接库</h2>\n<p>右键项目属性打开配置文件的输出类型为类库【配置属性】-》【常规】配置类型—动态库（.dll)<img alt=\"在这里插入图片描述\" src=\"image\\1ca467fc242e4edc8374fc6e2e1ed308.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\014179da5f4c4f4a90b83cd50c940fc1.png\"/></p>\n<h2><a id=\"3_11\"></a>3、简单写点代码</h2>\n<h3><a id=\"31_h_12\"></a>3.1 添加头文件（.h）</h3>\n<p>头文件 <code>AddOperate.h</code>。</p>\n<pre><code>#pragma once\nextern \"C\" _declspec(dllexport) int Sum(int a, int b);\nclass AddOperate\n{\npublic:\n};\n</code></pre>\n<h3><a id=\"31_cpp_23\"></a>3.1 添加源文件（.cpp）</h3>\n<p>源文件 <code>AddOperate.cpp</code>。</p>\n<pre><code>#include \"AddOperate.h\"\n#include \"iostream\"\nusing namespace std;\n\nint Sum(int a, int b)\n{\n    if (a - (int)a != 0 || b - (int)b != 0) {\n        cout &lt;&lt; \"请输入整数\" &lt;&lt; endl;\n        return -1;\n    }\n    return a + b;\n}\n\n</code></pre>\n<h2><a id=\"4DLL_41\"></a>4、右键项目点击生成即可生成DLL文件</h2>\n<p>在项目的Debug目录下即可找到生成的DLL文件<img alt=\"在这里插入图片描述\" src=\"image\\455b4af80e774eae896126d478bcbc8a.png\"/></p>\n<h1><a id=\"DllUnity_44\"></a>二、将Dll库在Unity工程中调用</h1>\n<h2><a id=\"1Unity_45\"></a>1、创建一个Unity工程：</h2>\n<h2><a id=\"2Plugins_46\"></a>2、新建一个文件夹命名为Plugins：</h2>\n<h2><a id=\"3Plugins_47\"></a>3、将之前生成的动态链接库放到Plugins文件夹下，如下图所示：</h2>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\0b4e1f5470bb4ffebba363244c8bea18.png\"/></p>\n<h2><a id=\"4TestcsC_49\"></a>4、新建一个Test.cs测试脚本调用C++代码：</h2>\n<p>下面展示一些 <code>Test.cs</code>。</p>\n<pre><code>using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Runtime.InteropServices;\nusing UnityEngine;\npublic class Test : MonoBehaviour\n{\n    \n    void Start()\n    {\n        Add(3, 4);\n    }\n\n    [DllImport(\"CPPDll2.dll\", CallingConvention = CallingConvention.Cdecl)]\n    extern static int Sum(int a, int b);\n    public void Add(int a,int b)\n    {\n        UnityEngine.Debug.Log(\"调用C++代码计算a + b的结果为\" + Sum(a,b));\n       \n    }\n</code></pre>\n<h3><a id=\"_77\"></a>运行结果：</h3>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\29a88eaad51746de9289e98c1dfac503.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}