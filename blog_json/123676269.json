{"blogid": "123676269", "writerAge": "码龄8年", "writerBlogNum": "1", "writerCollect": "1", "writerComment": "0", "writerFan": "1", "writerGrade": "1级", "writerIntegral": "12", "writerName": "超凡Cf", "writerProfileAdress": "writer_image\\profile_123676269.jpg", "writerRankTotal": "250131", "writerRankWeekly": "1266576", "writerThumb": "1", "writerVisitNum": "1491", "blog_read_count": "1490", "blog_time": "于 2022-03-23 07:31:57 发布", "blog_title": "t.cn短链接是怎么生成的？", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night-eighties\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"tcn_0\"></a>【分享】t.cn短链接是怎么生成的？</h2>\n<p>新浪短网址API是新浪对外公开的http://t.cn短网址生成接口，可以将长网址缩短生成 http://t.cn/xxxx 格式的短网址，目前网上有很多相关的接口，大多数都不能用，而且找起来也麻烦，分享一个自己收藏了很久的接口地址，用了快一年了，一直没掉过链子，大家可以试试。</p>\n<h2><a id=\"API_5\"></a>新浪短网址API</h2>\n<p>平台地址：<br/> <a href=\"http://s.011.run\">http://s.011.run</a> （可以在线免费生成t.cn短链接，简单方便）</p>\n<p>新浪短网址API 支持自动过微博白名单:<br/> <a href=\"http://s.011.run/api/tcn.php?longurl=http://www.baidu.com\">http://s.011.run/api/tcn.php?longurl=http://www.baidu.com</a></p>\n<p>返回格式：JSON 返回值为:dwz 返回状态码:200为成功</p>\n<h2><a id=\"_13\"></a>接口使用说明：</h2>\n<p>1、在线使用 将API地址中 “http://www.baidu.com” 的部分换成自己的长网址，然后复制，在浏览器中粘贴打开就能生成了。</p>\n<p>2、对接程序使用 如果嫌在线生成麻烦，可以将API接口对接到程序中自动生成，下面是不同语言的调用演示代码，大家接入的时候可以参考下。</p>\n<h2><a id=\"PHP_19\"></a>PHP调用参考：</h2>\n<pre><code class=\"prism language-php\"><span class=\"token variable\">$url</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">'http://www.baidu.com'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//修改为您的长连接地址</span>\n<span class=\"token variable\">$api_url</span> <span class=\"token operator\">=</span> <span class=\"token string single-quoted-string\">' http://s.011.run/api/tcn.php?longurl='</span><span class=\"token operator\">.</span><span class=\"token function\">urlencode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$short_url</span> <span class=\"token operator\">=</span> <span class=\"token function\">file_get_contents</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$api_url</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token variable\">$data</span> <span class=\"token operator\">=</span> <span class=\"token function\">json_decode</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$short_url</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">echo</span> <span class=\"token variable\">$data</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'dwz'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2><a id=\"JAVA_29\"></a>JAVA调用参考：</h2>\n<pre><code class=\"prism language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> path<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{<!-- --></span>\n <span class=\"token class-name\">URL</span> u <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">URL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" http://s.011.run/api/tcn.php?longurl=http://www.baidu.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token class-name\">InputStream</span> in <span class=\"token operator\">=</span> u<span class=\"token punctuation\">.</span><span class=\"token function\">openStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token class-name\">ByteArrayOutputStream</span> out <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ByteArrayOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{<!-- --></span>\n <span class=\"token keyword\">byte</span> buf<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">int</span> read <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>read <span class=\"token operator\">=</span> in <span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n out<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> read<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{<!-- --></span>\n <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span> in <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n in <span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span>\n <span class=\"token keyword\">byte</span> b<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> out<span class=\"token punctuation\">.</span><span class=\"token function\">toByteArray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> <span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n</code></pre>\n<h2><a id=\"Python_51\"></a>Python调用参考：</h2>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">,</span> urllib2<span class=\"token punctuation\">,</span> sys\n host <span class=\"token operator\">=</span> <span class=\"token string\">' http://s.011.run/'</span>\n path <span class=\"token operator\">=</span> <span class=\"token string\">'api/tcn.php'</span>\n method <span class=\"token operator\">=</span> <span class=\"token string\">'GET'</span>\n querys <span class=\"token operator\">=</span> <span class=\"token string\">'longurl=http%3A%2F%2Fwww.baidu.com'</span>\n bodys <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span><span class=\"token punctuation\">}</span>\n url <span class=\"token operator\">=</span> host <span class=\"token operator\">+</span> path <span class=\"token operator\">+</span> <span class=\"token string\">'?'</span> <span class=\"token operator\">+</span> querys\n request <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>Request<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n response <span class=\"token operator\">=</span> urllib2<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span>\n content <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_68\"></a>注意事项：</h2>\n<p>1、调用API接口时，只需将 “http://www.baidu.com”换成需要缩短的长链接即可。<br/> 2、接口支持链接中带参数，但要注意的是当链接中出现 &amp; 符号时，请用 %26 代替（或者使用url编码），urldecode转码 ，否则参数可能会丢失。<br/> 3、更换链接时，必须要以http(s)😕/开头，否则可能会导致短网址生成失败或者生成的短网址无法跳转访问原网站。<br/> 4、上文提到的新浪短网址API接口，经测试都是比较稳定的，觉得好用记得收藏一下，以免丢失。</p>\n<h2><a id=\"_75\"></a>常见问题：</h2>\n<p>1、长链接转换后，为什么结尾的参数丢失了？<br/> 答：因为长链接中含有特殊字符，需要将url编码（urldecode）后再使用接口生成。<br/> 2、接口没有返回结果，是什么情况？<br/> 答：有些时候接口返回数据会有延迟，超时未返回即生成失败，也就不会返回结果；或者是因为原链接被封了。<br/> 3、生成的短链接有效期是多久？有没有访问次数限制？<br/> 答：生成的http://t.cn短链接是永久有效的，没有点击次数限制，可以放心使用。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}