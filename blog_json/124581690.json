{"blogid": "124581690", "writerAge": "码龄2年", "writerBlogNum": "96", "writerCollect": "33", "writerComment": "14", "writerFan": "13", "writerGrade": "4级", "writerIntegral": "1029", "writerName": "抗争的小青年", "writerProfileAdress": "writer_image\\profile_124581690.jpg", "writerRankTotal": "20468", "writerRankWeekly": "4875", "writerThumb": "36", "writerVisitNum": "19686", "blog_read_count": "3528", "blog_time": "已于 2022-05-05 09:23:32 修改", "blog_title": "使用Seay进行代码安全审计", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h2><a id=\"Seay_0\"></a>Seay介绍</h2>\n<h3><a id=\"Seay_1\"></a>Seay介绍</h3>\n<p>Seay其实是一款用 C语言所开发的一款对 PHP相关代码的安全审计系统，它是运 行在 Windows操作系统上的。这种软件能够发现 SQL 注入漏洞、代码执行漏洞、命令执行错误、文件内容包括、文件的上传、绕过防护、拒绝文件服务、XSS的跨站漏洞、信息泄露问题、任意URL 跳 转等漏洞。 打开以后主界面如图 1.1 所示。</p>\n<p><img alt=\"图1.1Seay主界面\" src=\"image\\66b6bb6722ab47388b3ed1756599e1f7.png\"/></p>\n<h3><a id=\"_5\"></a>源代码审计系统主要特点：</h3>\n<ol><li>可以一键启动白盒审计</li><li>对代码进行必要的调试</li><li>对正则进行编码</li></ol>\n<h3><a id=\"Seay__10\"></a>Seay 支持的漏洞有以下几种</h3>\n<ol><li>文件的函数中如果存在相关变量,就有可能存在漏洞</li><li>pr.eg_repl.ace 的/f，如果有可控的变量，就可能存在漏洞</li><li>phpi.nfo()的相关函数，就会存在敏感信息泄露的漏洞</li><li>call_user_func 的相关函数的参数如果包含变量，就可能存在代码执行相关漏洞</li></ol>\n<h2><a id=\"Seay_16\"></a>Seay安装</h2>\n<h3><a id=\"Seay_17\"></a>下载Seay安装包</h3>\n<p><a href=\"https://www.fujieace.com/software/seay.html\">下载地址</a></p>\n<p><img alt=\"请添加图片描述\" src=\"image\\2891eca92e9442b7ae8c82a786db72ec.png\"/><br/> 解压后如下：<br/> <img alt=\"请添加图片描述\" src=\"image\\a1fcd726fffa42bea82b25e235c6c632.png\"/></p>\n<p>项目根目录如下图所示：<br/> <img alt=\"请添加图片描述\" src=\"image\\172c21e309a546359dec9e4aa1d0e02c.png\"/><br/> <img alt=\"请添加图片描述\" src=\"image\\eb9f9681c20e45009fe31ca160094799.png\"/><br/> 点击程序启动文件，程序正常启动如图所示。<br/> <img alt=\"请添加图片描述\" src=\"image\\2613e78c01844d028f48fcb0908c4f45.png\"/></p>\n<h2><a id=\"Seay_29\"></a>Seay使用</h2>\n<h3><a id=\"_30\"></a>基本使用方法</h3>\n<p>使用seay系统的方法如下：<br/> （1）在安装后就打开程序，然后新建一个项目。<br/> （2）选择需要审查的文件夹中的相关代码，然后打开后如图 3.1 。<br/> （3）然后查看系统界面左侧列表列出来的项目结构。<br/> （4）双击文件可以打开编辑器对其进行编辑，之后对文件进行字符和函数的查找。<img alt=\"seay系统的使用\" src=\"image\\bafdc90a166748d7a96bf86b6d0c7f85.png\"/><br/> （5）点击关闭。如果代码已经审计完成或者想审计其他人的相关代码，就点击关闭就可以。<br/> （6）菜单栏上的三个按钮为自动审计按钮，它可以自动对代码进行审计，自动审计，会对所有相关的危险以及隐藏的漏洞代码都会查找出来，使用者可以点击后等待 ，报告马上就可以自动出来，方便使用者。</p>\n<p><img alt=\"审计工具插件栏\" src=\"image\\3abcd54629b84f49a9555f1bf498347f.png\"/><br/> （7）代码调试功能可以调试需要执行的代码。如果是 php 解析的代码，相当方便<br/> （8）函数查询功能其实就是查询官网内置的相关函数，查阅具体的函数使用方法以及参数说明；<br/> （9）数据的管理功能体现在连接本地的数据库或者远程数据库时，可以方便项目的管理，用户可连接 mySQL 和 SQLserver， 示例如 3.3 图所示。<br/> <img alt=\"图 3.3 数据库管理功能\" src=\"image\\f98d2b18ff1544bab738e1097cf239bd.png\"/></p>\n<h2><a id=\"__DVWA_44\"></a>实验案例 - DVWA靶场</h2>\n<h3><a id=\"DVWA_45\"></a>DVWA介绍</h3>\n<p>DVWA靶场可以进行SQL注入漏洞、XSS漏洞、CSRF漏洞、以及文件上传等漏洞的相关练习，因为此系统又提供了许多的安全演练相关的级别，所以可以逐步地来提升Web渗透的相关的技术。DVWA靶场就是一套开源的系统，可以在练习Web渗透技术的同时，通过阅读源码学习到对于各种漏洞的安全防护编码的知识。</p>\n<h3><a id=\"DVMA_48\"></a>DVMA靶场下载</h3>\n<p>GitHub - d.igininja/DVWA: Dam.n Vulnerable Web Appl.icatio.n<br/> <img alt=\"图4.1 DVMA压缩包\" src=\"image\\699c05ddacc04e6a9b45a7a8779fa7f8.png\"/><br/> 解压后如图所示：<br/> <img alt=\"图4.2 DVMA根目录\" src=\"image\\b3ff548773f04427aa883b441c370f8e.png\"/></p>\n<h3><a id=\"Seay_53\"></a>Seay中新建项目</h3>\n<p>在Seay中选择进行新建项目，如图4.3所示。<br/> <img alt=\"图4.3 Seay中新建项目\" src=\"image\\30e40569b911480dbf040a0b2ba3a6bf.png\"/></p>\n<h3><a id=\"SeayDVWA_56\"></a>Seay中选择DVWA本地程序</h3>\n<p>在新建项目中，选择DVNA的相关源代码<br/> <img alt=\"图4.4 选择DVMA源代码\" src=\"image\\3eed3f5f337043fbb5e252a8f0f7d9d2.png\"/></p>\n<h3><a id=\"SeayDVMA_59\"></a>查看Seay中的DVMA的目录结构</h3>\n<p><img alt=\"图4.5 DVMA的目录结构\" src=\"image\\1620d53dd29e41b589d8410af297f0fa.png\"/></p>\n<h3><a id=\"Seay__61\"></a>Seay 开启审计</h3>\n<p>使用 Seay中的自动审计功能，点击“自动审计按钮”。<br/> <img alt=\"图4.6 开启自动审计功能\" src=\"image\\0f73da753f2b49e7bfb237908c4dcaed.png\"/></p>\n<h3><a id=\"_64\"></a>审计结果</h3>\n<p>审计的结果如图 4.7所示<br/> <img alt=\"图4.7 审计结果\" src=\"image\\7358e31db00a428ca787d5a5dbb92391.png\"/></p>\n<h3><a id=\"_67\"></a>生成代码审计报告</h3>\n<p>Seay可以自动生成审计报告，可在浏览器中打开，因为是html格式。<br/> <img alt=\"图 4.8“生成报告”按钮\" src=\"image\\ab7e0156e3d14b98973d2e6532dc9a2e.png\"/><br/> 我们可以在报告中看到各种漏洞的相关分析，以及漏洞文件的绝对路径。<br/> <img alt=\"图4.9 自动生成审计报告\" src=\"image\\60dc3ea33db1452ea2f21cc9bf9670e1.png\"/></p>\n<h3><a id=\"_72\"></a>漏洞相关分析</h3>\n<p>自动审计系统可以罗列出所有漏洞，如文件漏洞，文件读取的漏洞。可以通过自己分析可以熟悉和了解Web安全的相关漏洞，从而将漏洞和代码关联到一起，在理解代码的某些部分种可以出现的漏洞。比如ID序号为20，漏洞描述为文件操作函数里面存在变量，可以在任意文件中读取，删除，修改文件。<br/> <img alt=\"图 4.10 漏洞描述\" src=\"image\\9352c69384fc4b2a80895f958f5c9b17.png\"/><br/> 选中ID为20的漏洞，双击查看漏洞的信息，就可以可以查看漏洞的对应信息，以及相关分析。<br/> <img alt=\"图4.11 查看漏洞信息\" src=\"image\\cdd624be71a9447dbcc0cc90931a3fd3.png\"/><br/> 可以看到，输入文件后，可以在第227行对文件进行 unlink操作。<br/> <img alt=\"图4.12 分析漏洞信息\" src=\"image\\b3777abb3c8545dea0d2d5db17f7a06d.png\"/><br/> 打开 phpStudy程序,然后开启Apache和MySql组件，在主机中验证这个漏洞。<br/> <img alt=\"图4.13 打开 phpStudy\" src=\"image\\03dbe5daca3847cb8123a4e1984cfda5.png\"/><br/> 在主机上登陆DVNA，输入账号，密码。<br/> <img alt=\"图4.14 登陆DVMA\" src=\"image\\36ab769c12a84a5ba389ea211dcec773.png\"/><br/> 安全级别选择 low级别，然后点击“提交”。<img alt=\"图 4.15 选择级别\" src=\"image\\343e204cf87d4030a03fa6d10b025f78.png\"/><br/> 左侧选择“File Upload”,显示界面如下<br/> <img alt=\"图4.16 显示界面\" src=\"image\\e7fffc3204834490bf11f8c7678820f1.png\"/><br/> 根据漏洞描述，上传照片格式的文件。<br/> <img alt=\"图4.17上传文件\" src=\"image\\d6778e4dc4834ad580a48b64c818b550.png\"/><br/> <img alt=\"图4.18显示结果\" src=\"image\\600c01449e944f12a80a6e6d7c5857fc.png\"/><br/> 点击 ViewSource生成系统源码，对源码进行审计分析。<br/> <img alt=\"图4.19 生成源码\" src=\"image\\aec21e018be44168b6b20215fffcfcf6.png\"/><br/> 与Seay分析的结果进行比较，两者分析结果是一致的。<br/> <img alt=\"图4.20 比较结果\" src=\"image\\04526288e60d4a71a65262ed00b66012.png\"/><br/> <strong>审计结束</strong><br/> 点个赞再走吧<br/> <a href=\"http://liyublogs.top/\">往期传送门</a></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}