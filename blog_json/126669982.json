{"blogid": "126669982", "writerAge": "码龄1年", "writerBlogNum": "108", "writerCollect": "9463", "writerComment": "5182", "writerFan": "23622", "writerGrade": "7级", "writerIntegral": "16276", "writerName": "热爱编程的小白白", "writerProfileAdress": "writer_image\\profile_126669982.jpg", "writerRankTotal": "549", "writerRankWeekly": "28", "writerThumb": "6442", "writerVisitNum": "229733", "blog_read_count": "671", "blog_time": "已于 2022-09-04 18:23:20 修改", "blog_title": "【SSM框架】MyBatis的各种查询功能", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<p> 🍓个人主页：<a href=\"https://blog.csdn.net/Javascript_tsj?type=blog\" title=\"个人主页\">个人主页</a></p>\n<p>🍒系列专栏：<a href=\"https://blog.csdn.net/javascript_tsj/category_11957185.html?spm=1001.2014.3001.5482\" title=\"SSM框架\">SSM框架</a></p>\n<p>💬推荐一款模拟面试、刷题神器，从基础到大厂面试题👉<a href=\"https://www.nowcoder.com/link/pc_csdncpt_xbb_java\" title=\"点击跳转刷题网站进行注册学习\">点击跳转刷题网站进行注册学习</a></p>\n</blockquote>\n<p id=\"main-toc\"><strong>目录</strong></p>\n<p id=\"-toc\" style=\"margin-left:80px;\"></p>\n<p id=\"1.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%AF%B9%E8%B1%A1-toc\" style=\"margin-left:80px;\"><a href=\"#1.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%AF%B9%E8%B1%A1\">1.查询一个实体类对象</a></p>\n<p id=\"2.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AAlist%E9%9B%86%E5%90%88-toc\" style=\"margin-left:80px;\"><a href=\"#2.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AAlist%E9%9B%86%E5%90%88\">2.查询一个list集合</a></p>\n<p id=\"3.%E6%9F%A5%E8%AF%A2%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE-toc\" style=\"margin-left:80px;\"><a href=\"#3.%E6%9F%A5%E8%AF%A2%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE\">3.查询单个数据</a></p>\n<p id=\"4.%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88-toc\" style=\"margin-left:80px;\"><a href=\"#4.%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88\">4.查询一条数据为map集合</a></p>\n<p id=\"5.%E6%9F%A5%E8%AF%A2%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88-toc\" style=\"margin-left:80px;\"><a href=\"#5.%E6%9F%A5%E8%AF%A2%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88\">5.查询多条数据为map集合</a></p>\n<hr id=\"hr-toc\"/>\n<p></p>\n<h3 id=\"1.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%AF%B9%E8%B1%A1\"><span style=\"background-color:#ffd900;\">1.</span><strong><span style=\"background-color:#ffd900;\">查询一个实体类对象</span></strong></h3>\n<blockquote>\n<p>/**</p>\n<p>* 根据用户id查询用户信息</p>\n<p>* @param id</p>\n<p>* @return</p>\n<p>*/</p>\n<p>User getUserById(@Param(\"id\") int id);</p>\n</blockquote>\n<pre><code class=\"language-sql\">  &lt;select id=\"getUserById\" resultType=\"User\"&gt;\n       select * from t_user where id=#{id};\n    &lt;/select&gt;</code></pre>\n<pre><code class=\"language-java\">    @Test\n    public void test() {\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        User user = mapper.getUserById(2);\n        System.out.println(user);\n\n    }</code></pre>\n<p><strong>表：</strong></p>\n<p><img alt=\"\" height=\"246\" src=\"image\\8b186793db504d18b363e31123e9ec8f.png\" width=\"673\"/></p>\n<p><strong> 查询结果：</strong></p>\n<p><img alt=\"\" height=\"356\" src=\"image\\fae97f4202c1479da23a09802cb173d2.png\" width=\"1200\"/></p>\n<p></p>\n<p><strong>假如，我把后面的条件删除，会发生什么情况呢？ </strong></p>\n<p><img alt=\"\" height=\"591\" src=\"image\\603c8f79919a42769f4fd688a89c5626.png\" width=\"1200\"/></p>\n<p> <img alt=\"\" height=\"514\" src=\"image\\ec157f5f9889497693dee0384b408304.png\" width=\"1200\"/></p>\n<p></p>\n<blockquote>\n<p><strong>org.apache.ibatis.exceptions.TooManyResultsException: Expected one result (or null) to be returned by selectOne(), but found: 3</strong></p>\n<p></p>\n<p></p>\n<p><strong>当查询的数据为多条时，不能使用实体类作为返回值，否则会抛出异常 </strong></p>\n<p><strong>TooManyResultsException；但是若查询的数据只有一条，可以使用实体类或集合作为返回值</strong></p>\n</blockquote>\n<h3 id=\"2.%E6%9F%A5%E8%AF%A2%E4%B8%80%E4%B8%AAlist%E9%9B%86%E5%90%88\"><strong><span style=\"background-color:#ffd900;\">2.查询一个</span></strong><strong><span style=\"background-color:#ffd900;\">list</span></strong><strong><span style=\"background-color:#ffd900;\">集合 </span></strong></h3>\n<blockquote>\n<p>/**</p>\n<p>* 查询所有用户信息</p>\n<p>* @return</p>\n<p>*/</p>\n<p>List&lt;User&gt; getUserList();</p>\n</blockquote>\n<pre><code class=\"language-sql\">    &lt;select id=\"getAllUser\" resultType=\"User\"&gt;\nselect * from t_user;\n    &lt;/select&gt;</code></pre>\n<p><strong>测试类：</strong></p>\n<pre><code class=\"language-java\">   @Test\n    public void test2(){\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        List&lt;User&gt; allUser = mapper.getAllUser();\n        allUser.forEach(System.out::println);\n\n    }</code></pre>\n<p><strong> 查询结果：</strong></p>\n<p><img alt=\"\" height=\"382\" src=\"image\\9ef38761520d4593ad03433e164e80c7.png\" width=\"1200\"/></p>\n<p></p>\n<h3 id=\"3.%E6%9F%A5%E8%AF%A2%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE\"><span style=\"background-color:#ffd900;\">3.</span><strong><span style=\"background-color:#ffd900;\">查询单个数据</span></strong></h3>\n<blockquote>\n<p></p>\n<div>\n<span style=\"color:#aa5500;\">/**</span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">查询用户的总记录数 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* @return </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">在</span>\n<span style=\"color:#aa5500;\">MyBatis</span>\n<span style=\"color:#aa5500;\">中，对于</span>\n<span style=\"color:#aa5500;\">Java</span>\n<span style=\"color:#aa5500;\">中常用的类型都设置了类型别名 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">例如： </span>\n<span style=\"color:#aa5500;\">java.lang.Integer--&gt;int|integer </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">例如： </span>\n<span style=\"color:#aa5500;\">int--&gt;_int|_integer </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">例如： </span>\n<span style=\"color:#aa5500;\">Map--&gt;map,List--&gt;list </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">*/ </span>\n</div>\n<div>\n<span style=\"color:#008855;\">int </span>\n<span style=\"color:#0000ff;\">getCount</span>\n<span style=\"color:#333333;\">(); </span>\n</div>\n</blockquote>\n<pre><code class=\"language-sql\">    &lt;select id=\"getCount\" resultType=\"java.lang.Integer\"&gt;\n        select count(id) from t_user;\n    &lt;/select&gt;</code></pre>\n<p><strong>测试类：</strong></p>\n<pre><code class=\"language-java\">    @Test\n    public void test3(){\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        Integer count = mapper.getCount();\n        System.out.println(count);\n\n    }</code></pre>\n<p><strong> </strong></p>\n<p><strong>表：</strong><img alt=\"\" height=\"231\" src=\"image\\a186d7db931d467cb3340269ecfd8148.png\" width=\"842\"/></p>\n<p></p>\n<p><strong>查询结果：</strong></p>\n<p><img alt=\"\" height=\"262\" src=\"image\\72c170dc405f4c00949202363cf253f4.png\" width=\"1200\"/></p>\n<p></p>\n<h3></h3>\n<h3 id=\"4.%E6%9F%A5%E8%AF%A2%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88\"><strong><span style=\"background-color:#ffd900;\">4.查询一条数据为map集合</span></strong></h3>\n<blockquote>\n<p></p>\n<div>\n<span style=\"color:#aa5500;\">/**</span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">根据用户</span>\n<span style=\"color:#aa5500;\">id</span>\n<span style=\"color:#aa5500;\">查询用户信息为</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* @param id </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* @return </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">*/ </span>\n</div>\n<div></div>\n<div>\n<span style=\"color:#000000;\">Map</span>\n<span style=\"color:#981a1a;\">&lt;</span>\n<span style=\"color:#008855;\">String</span>\n<span style=\"color:#333333;\">, </span>\n<span style=\"color:#008855;\">Object</span>\n<span style=\"color:#981a1a;\">&gt; </span>\n<span style=\"color:#0000ff;\">getUserToMap</span>\n<span style=\"color:#333333;\">(</span>\n<span style=\"color:#555555;\">@Param</span>\n<span style=\"color:#333333;\">(</span>\n<span style=\"color:#aa1111;\">\"id\"</span>\n<span style=\"color:#333333;\">) </span>\n<span style=\"color:#008855;\">int </span>\n<span style=\"color:#000000;\">id</span>\n<span style=\"color:#333333;\">); </span>\n</div>\n</blockquote>\n<p></p>\n<pre><code class=\"language-sql\">&lt;!--Map&lt;String, Object&gt; getUserToMap(@Param(\"id\") int id);--&gt; \n\n &lt;select id=\"getUserToMap\" resultType=\"map\"&gt; \nselect * from t_user where id = #{id} \n&lt;/select&gt;</code></pre>\n<p> <strong>测试类：</strong></p>\n<pre><code class=\"language-java\">  @Test\n    public  void  test4(){\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        Map&lt;String, Object&gt; map = mapper.getUserToMap(4);\n        System.out.println(map);\n    }</code></pre>\n<p><img alt=\"\" height=\"310\" src=\"image\\3acb55d2dda248468f95f8994c90b1ff.png\" width=\"1101\"/></p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"5.%E6%9F%A5%E8%AF%A2%E5%A4%9A%E6%9D%A1%E6%95%B0%E6%8D%AE%E4%B8%BAmap%E9%9B%86%E5%90%88\"><span style=\"color:#333333;\"><strong><span style=\"background-color:#ffd900;\">5.</span></strong></span><span style=\"color:#333333;\"><strong><span style=\"background-color:#ffd900;\">查询多条数据为</span></strong></span><span style=\"color:#333333;\"><strong><span style=\"background-color:#ffd900;\">map</span></strong></span><span style=\"color:#333333;\"><strong><span style=\"background-color:#ffd900;\">集合</span></strong></span></h3>\n<p><span style=\"color:#333333;\"><strong>①方式一 </strong></span></p>\n<blockquote>\n<div>\n<span style=\"color:#aa5500;\">/**</span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">查询所有用户信息为</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* @return </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">将表中的数据以</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合的方式查询，一条数据对应一个</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">；若有多条数据，就会产生多个</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合，此 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">时可以将这些</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">放在一个</span>\n<span style=\"color:#aa5500;\">list</span>\n<span style=\"color:#aa5500;\">集合中获取 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">*/ </span>\n</div>\n<div>\n<span style=\"color:#000000;\">List</span>\n<span style=\"color:#981a1a;\">&lt;</span>\n<span style=\"color:#000000;\">Map</span>\n<span style=\"color:#981a1a;\">&lt;</span>\n<span style=\"color:#008855;\">String</span>\n<span style=\"color:#333333;\">, </span>\n<span style=\"color:#008855;\">Object</span>\n<span style=\"color:#981a1a;\">&gt;&gt; </span>\n<span style=\"color:#0000ff;\">getAllUserToMap</span>\n<span style=\"color:#333333;\">(); </span>\n</div>\n</blockquote>\n<pre><code class=\"language-sql\">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;\n &lt;select id=\"getAllUserToMap\" resultType=\"map\"&gt; \nselect * from t_user\n &lt;/select&gt;</code></pre>\n<p><strong>测试类：</strong></p>\n<pre><code class=\"language-java\"> @Test\n    public  void  test5(){\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        List&lt;Map&lt;String, Object&gt;&gt; allUserToMap = mapper.getAllUserToMap();\n        System.out.println(allUserToMap);\n    }</code></pre>\n<p></p>\n<p><img alt=\"\" height=\"352\" src=\"image\\d6c68abf690046e885de15e0d86c2533.png\" width=\"1200\"/></p>\n<p></p>\n<div>\n<span style=\"color:#333333;\"><strong>②方式二</strong></span>\n</div>\n<div></div>\n<blockquote>\n<div>\n<div>\n<span style=\"color:#aa5500;\">/**</span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">查询所有用户信息为</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* @return </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">* </span>\n<span style=\"color:#aa5500;\">将表中的数据以</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合的方式查询，一条数据对应一个</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">；若有多条数据，就会产生多个</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合，并 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">且最终要以一个</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">的方式返回数据，此时需要通过</span>\n<span style=\"color:#aa5500;\">@MapKey</span>\n<span style=\"color:#aa5500;\">注解设置</span>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合的键，值是每条数据所对应的 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">map</span>\n<span style=\"color:#aa5500;\">集合 </span>\n</div>\n<div>\n<span style=\"color:#aa5500;\">*/ </span>\n</div>\n<div></div>\n<div>\n<span style=\"color:#555555;\">@MapKey</span>\n<span style=\"color:#333333;\">(</span>\n<span style=\"color:#aa1111;\">\"id\"</span>\n<span style=\"color:#333333;\">) </span>\n</div>\n<div>\n<span style=\"color:#000000;\">Map</span>\n<span style=\"color:#981a1a;\">&lt;</span>\n<span style=\"color:#008855;\">String</span>\n<span style=\"color:#333333;\">, </span>\n<span style=\"color:#008855;\">Object</span>\n<span style=\"color:#981a1a;\">&gt; </span>\n<span style=\"color:#0000ff;\">getAllUserToMap</span>\n<span style=\"color:#333333;\">(); </span>\n</div>\n</div>\n</blockquote>\n<pre><code class=\"language-sql\">\n &lt;select id=\"getAllUserToMap\" resultType=\"map\"&gt; \nselect * from t_user\n &lt;/select&gt;</code></pre>\n<p> <strong>测试类：</strong></p>\n<pre><code class=\"language-java\">    @Test\n    public  void  test6(){\n        SqlSessionUtils sqlSessionUtils = new SqlSessionUtils();\n        SqlSession sqlSession = sqlSessionUtils.getSqlSession();\n        SelectMapper mapper = sqlSession.getMapper(SelectMapper.class);\n        Map&lt;String, Object&gt; allUserToMap = mapper.getAllUserToMap();\n        System.out.println(allUserToMap);\n\n    }\n</code></pre>\n<p><strong>运行结果：</strong></p>\n<blockquote>\n<p>{1={password=123, sex=男, id=1, age=23, email=11111@qq.com, username=张三},</p>\n<p>2={password=root, sex=女, id=2, age=23, email=11111@qq.com, username=root},</p>\n<p>3={password=789123, sex=女, id=3, age=28, email=9090889@qq.com, username=小王}, 4={password=1234567, sex=男, id=4, age=34, email=1487418@qq.com, username=小李}}</p>\n</blockquote>\n<p></p>\n</div>\n</div>"}