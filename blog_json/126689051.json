{"blogid": "126689051", "writerAge": "码龄6年", "writerBlogNum": "299", "writerCollect": "448", "writerComment": "386", "writerFan": "235", "writerGrade": "5级", "writerIntegral": "3522", "writerName": "kicinio", "writerProfileAdress": "writer_image\\profile_126689051.jpg", "writerRankTotal": "5505", "writerRankWeekly": "33449", "writerThumb": "129", "writerVisitNum": "231854", "blog_read_count": "166", "blog_time": "于 2022-09-04 15:50:16 发布", "blog_title": "一种子模块化的基于Hash刷新机制的iOS端数据驱动的MVVM架构思考", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h3><a id=\"_0\"></a>前言：</h3>\n<p>声明：本文系本人之愚见，所列举的事实为客观存在，并不存在绝对的抨击。如果您的想法和本人有出入欢迎留言共同探讨，有建议欢迎斧正，本人仅是菜鸟一枚，略有不便之处敬请读者海涵。</p>\n<blockquote>\n<p>iOS端的架构基准无非就是苹果推荐的MVC，经典MVVM，解耦性极好的MVP，新生代的VIPER及Uber推出的Ribs，当然还有臭名昭著的CCC(所有代码都放在ViewController里面)。架构的实施标准无非就是解决软件工程中两个重要问题：如何加快软件开发速度；如何解决软件工程后期维护问题。以CCC为例，这个架构的项目后期维护绝对是令人头疼的问题，甚至可能还会影响新功能的迭代，而MVP解耦性虽然很好，但是逻辑比较复杂。剩下较为流行的架构就剩MVVM了，这个架构除了编写较为麻烦，在后期迭代方面有着较为明显的优势，条理较为清晰。但我接触的一些项目里面的MVVM架构也有较为明显的问题，即ViewModel过于臃肿，虽然ViewController里面很干净，但是ViewModel里面复杂的业务逻辑、胶水代码让其成为了第二个<code>ViewController</code>，仍然不好维护。</p>\n</blockquote>\n<h2><a id=\"MVVM_5\"></a>现有MVVM架构引起的思考：</h2>\n<ul><li>过于臃肿的ViewModel<br/> ViewModel的本意是解决ViewController过于臃肿的问题，替代一部分ViewController的功能，连接View层及Model层。然而不分场合的滥用，导致ViewModel越来越庞大，后期迭代的时候成为问题。</li><li>复杂的逻辑走向和胶水代码<br/> 有些特殊的时间是ViewModel产生不了的，例如系统的回调事件。ViewModel我见过的基本上都是继承自<code>NSObject</code>，这个类自身并没有和系统及application有过多的交集。最明显的例子就是ViewController初始化完毕后会回调<code>viewDidLoad()</code>，一部分特殊的业务需要在这个回调方法里进行操作例如网络请求，然而ViewModel本身没这个方法，也无法hook到ViewController里面的这个回调方法，只有手动写一个<code>viewModelDidLoad()</code>方法进行勾起处理，每个人都有自己的编码风格，久而久之这些特殊的事件就让ViewModel变得越来越复杂。</li><li>事件流的传递<br/> 关于事件流的传递在iOS里面比Android是要丰富的，但也造就了五花八门的写法。最简单的就是View层的属性暴露出来成为public的属性，然后给控件<code>addTarget</code>；也可以使用<code>delegate</code>，但要考虑多对一的情况；以及似乎与MVVM绑定的特性及即向绑定，在ios里面体现就是RAC和RxSwift；还可以使用Notification，但是要考虑到通知满天飞找不到头的尴尬场面；最后就是block。</li><li>编写较为繁琐<br/> 这个问题一直是MVVM的弊端，从View层，Model层，ViewModel层，ViewController层，这个是个棘手的问题。</li></ul>\n<h3><a id=\"_14\"></a>设计思路：</h3>\n<p>设计的思路基本上沿着上面的思考而来。</p>\n<p>平常开发居多的是以长页面形式的ViewController及固定空间显示的ViewController居多，这一点可以参考美团饿了吗的点餐、订单详情界面。界面内容太长需要上下滑动。这给了我们一个思路：能不能利用滚动形式的组件去管理这些子业务？答案是可以的，而且也有现成的框架（IGListKit）。那么具体思考起来可不可以这样理解：把界面当成很多UICollectionViewCell组成的大部分，一些相同类型业务的Cell就归纳为一个Section里面，由一个容器去管理（UICollectionView）。这个做法得到不少公司产品的体现，没记错的话字节的“大力自习室”及唯品会就是这个思路。</p>\n<p>那是不是直接重写UICollectionView就行了？我的答案是可以，但是其内部细节不得而知，不如自己实现一个列表流组件，以此为基础进行迭代。</p>\n<p>对比Android开发，其有Activity(类似iOS中的ViewController)，Fragment(依附于Activity的碎片显示类)，Item(类似UICollectionViewCell)，Bundle(特殊的用以保存数据的类)，发现把这些拿过来刚好符合条件。<br/> Activity即当成UICollectionView，Fragment当成UICollectionView中的Section节点，Item直接继承于UIView(Cell内部布局层次较多，这里直接选择一个干净的UIView)。</p>\n<p>目前一个较为流行的东西叫做“数据驱动”，即被刷新对象本身没有直接刷新，而是通过其他类使用指定方法和参数间接刷新。那么这个参数就可以理解为上文的Bundle。这里将Bundle设计为不仅仅是数据储存类（典型的Model），它还可以保存控件的frame，block变量用于事件处理。这里也就是上面思考里面提到的事件流的处理，使用block的优点很明显，类似于Android中的匿名类监听器，对接双方是一对一的，不存在多对一情况，可以很快的从View层找到逻辑处理的地方，除了循环引用需要注意，还要多写block，我认为这是目前为止较好的处理方式。</p>\n<p>复杂的逻辑走向怎么处理？由于iOS的封闭性我们不知道系统内部实现细节，拿不到具体的context，所以这里用一个较为粗鲁的方式处理：即 ViewController手动调用activity的声明的方法，activity再手动调用fragment的声明方法。虽然很浅显，但是实际效果很好，常见的如<code>viewDidLoad()</code>、<code>viewWillAppear()</code>、<code>viewDidAppear()</code>等都能捕捉到。虽然方式简单粗暴，但是很有效，而且统一了这些回调方法的名称，较为好看吧。</p>\n<p>至于编写较为繁琐的问题，本人思考了不少时间实在没找到如何在开发速度和后期可维护性方面都做到最好，只能选择可维护性。如果有大佬有什么较好的处理方式欢迎留言共同探讨。</p>\n<h3><a id=\"_31\"></a>问题处理：</h3>\n<ul><li> <p>如何解决ViewModel过于臃肿的问题？<br/> 这里的解决思路是把初始化需要的步骤放到具体的View子项里面。例如，每个被划分后的Item通过数据驱动协议将bundle进行转型赋值，block的处理等。这样就减轻了ViewModel内初始化View层的问题。</p> </li><li> <p>如何解决刷新的问题？进一步衍生为如何解决局部刷新的问题？<br/> Item设置一个bundle属性，这个属性就是用以刷新Item的关键。由于NSObject有个hash属性，可以通过hash判断bundle的唯一性，如果一开始的item的bundle的hash与待刷新操作的相同则认定是同一个hash无需刷新，如果是不同值和认定其bundle被更新了需要刷新，如果没有值则认item是第一次执行刷新操作，需要调用数据驱动方法。另外bundle的hash值需要一个特殊的队列进行存储，以保证其hash队列长度最大为2。这也就是标题里面的hash刷新机制由来。与IGList不同的是，iglist实现了diff算法进行增上改，这是考虑cell复用的情况，本文不考虑复用情况所以也不需要diff算法（实际上数据流展示页面diif才会用到）。</p> </li><li> <p>如何解决适配横竖屏问题？<br/> 这里解决的途径是ViewController里重写这个方法：</p> </li></ul>\n<pre><code class=\"prism language-swift\">    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">willRotate</span><span class=\"token punctuation\">(</span>to toInterfaceOrientation<span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIInterfaceOrientation</span><span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TimeInterval</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">willRotate</span><span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">:</span> toInterfaceOrientation<span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">:</span> duration<span class=\"token punctuation\">)</span>\n        activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityRotate</span><span class=\"token punctuation\">(</span>rawValue<span class=\"token punctuation\">:</span> toInterfaceOrientation<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n</code></pre>\n<p>可以看出来这是手动调用rotate方法，然后传递到item层，重写rotate方法进行横屏、竖屏的frame处理。</p>\n<h3><a id=\"_48\"></a>最终工程：</h3>\n<p>最终本文实现以下特点：</p>\n<ul><li>ViewControllerActivity-Fragment-Item-Bundle-Model的层级划分。</li><li>数据驱动内容</li><li>Hash刷新</li><li>屏幕旋转适配</li><li>宿主生命周期</li><li>Fragment级别的增删。</li></ul>\n<p>具体工程：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\83a1fb0781684fabba0a306d12793feb.png\"/><br/> 其中TextFragment和BlankFragment是便利实现仅有文字或空白部分Fragment实现的类，很便捷。<br/> 具体代码可移步至<a href=\"https://github.com/mcry416/SGIKit/tree/main/SGIKit/SGLowCoupling\">github</a>观看</p>\n<h2><a id=\"ViewController_63\"></a>以登陆为例的ViewController编写：</h2>\n<p>即然文字分析了许多不如直接写一个实例看看效果如何，以登陆为例，只要账号为admin密码为123456就判断登陆成功。</p>\n<h3><a id=\"_66\"></a>分析：</h3>\n<p>ActivityModel即为ViewModel，Item为View层，Handler层暂未写。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\370837bb7de64557b3d0c5dadaacfe47.png\"/></p>\n<ul><li>ViewController层：</li></ul>\n<p>LoginDemoViewController.swift</p>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginDemoViewController</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIViewController</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">var</span> naviBar<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGNavigationBar</span><span class=\"token operator\">!</span>\n    <span class=\"token keyword\">var</span> activity<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGActivity</span><span class=\"token operator\">!</span>\n    <span class=\"token keyword\">var</span> activityModel<span class=\"token punctuation\">:</span> <span class=\"token class-name\">LoginActivityModel</span><span class=\"token operator\">!</span>\n\n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\">// Do any additional setup after loading the view.</span>\n        \n        <span class=\"token function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">viewWillAppear</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> animated<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewWillAppear</span><span class=\"token punctuation\">(</span>animated<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityWillAppear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">viewWillDisappear</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> animated<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewWillDisappear</span><span class=\"token punctuation\">(</span>animated<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityWillDisappear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">viewDidAppear</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> animated<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidAppear</span><span class=\"token punctuation\">(</span>animated<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityDidAppear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">viewDidDisappear</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> animated<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Bool</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">viewDidDisappear</span><span class=\"token punctuation\">(</span>animated<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityDidDisappear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">willRotate</span><span class=\"token punctuation\">(</span>to toInterfaceOrientation<span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIInterfaceOrientation</span><span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TimeInterval</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">willRotate</span><span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">:</span> toInterfaceOrientation<span class=\"token punctuation\">,</span> duration<span class=\"token punctuation\">:</span> duration<span class=\"token punctuation\">)</span>\n        activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityRotate</span><span class=\"token punctuation\">(</span>rawValue<span class=\"token punctuation\">:</span> toInterfaceOrientation<span class=\"token punctuation\">.</span>rawValue<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span>backgroundColor <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>white\n        naviBar <span class=\"token operator\">=</span> <span class=\"token class-name\">SGNavigationBar</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Login\"</span></span><span class=\"token punctuation\">,</span> leftText<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"\"</span></span><span class=\"token punctuation\">)</span>\n        naviBar<span class=\"token punctuation\">.</span>isEnableDividerLine <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n        naviBar<span class=\"token punctuation\">.</span>isBlur <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n        naviBar<span class=\"token punctuation\">.</span>setOnLeftClickListener <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">dismiss</span><span class=\"token punctuation\">(</span>animated<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>naviBar<span class=\"token punctuation\">)</span>\n        \n        activity <span class=\"token operator\">=</span> <span class=\"token class-name\">SGActivity</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n                                            y<span class=\"token punctuation\">:</span> naviBar<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY<span class=\"token punctuation\">,</span>\n                                            width<span class=\"token punctuation\">:</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span>\n                                            height<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> naviBar<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        activityModel <span class=\"token operator\">=</span> <span class=\"token class-name\">LoginActivityModel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        activityModel<span class=\"token punctuation\">.</span>context <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span>\n        activity<span class=\"token punctuation\">.</span>activityDelegate <span class=\"token operator\">=</span> activityModel\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>view<span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>activity<span class=\"token punctuation\">)</span>\n        activity<span class=\"token punctuation\">.</span><span class=\"token function\">activityDidLoad</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n</code></pre>\n<ul><li>Item层：</li></ul>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">Foundation</span>\n<span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TextFieldItem</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGItem</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> accountTextFiled<span class=\"token punctuation\">:</span>  <span class=\"token class-name\">UITextField</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">createAccountTextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> passwordTextField<span class=\"token punctuation\">:</span> <span class=\"token class-name\">UITextField</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">createPasswordTextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> textFiledBundle<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextFieldBundle</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> frame<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">required</span> <span class=\"token keyword\">init</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>coder<span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSCoder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token function\">fatalError</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"init(coder:) has not been implemented\"</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">bindBundle</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> bundle<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Any</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>textFiledBundle <span class=\"token operator\">=</span> bundle <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> <span class=\"token class-name\">TextFieldBundle</span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">bindBundleLandscape</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> bundle<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Any</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">itemWillRotate</span><span class=\"token punctuation\">(</span>rawValue<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">switch</span> rawValue<span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            accountTextFiled<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                            y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span>\n                                            width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                            height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n            passwordTextField<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                             y<span class=\"token punctuation\">:</span> accountTextFiled<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n                                             width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                             height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span>\n            accountTextFiled<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                            y<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n                                            width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                            height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n            passwordTextField<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                             y<span class=\"token punctuation\">:</span> accountTextFiled<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n                                             width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                             height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span>\n            accountTextFiled<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                            y<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n                                            width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                            height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n            passwordTextField<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n                                             y<span class=\"token punctuation\">:</span> accountTextFiled<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY <span class=\"token operator\">+</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n                                             width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                                             height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token class-name\">TextFieldItem</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>accountTextFiled<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>passwordTextField<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">createAccountTextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">UITextField</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> textFiled <span class=\"token operator\">=</span> <span class=\"token class-name\">UITextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        textFiled<span class=\"token punctuation\">.</span>borderStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>roundedRect\n        textFiled<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        textFiled<span class=\"token punctuation\">.</span>placeholder <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"Input account please.\"</span></span>\n        <span class=\"token keyword\">return</span> textFiled\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">createPasswordTextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">UITextField</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> textFiled <span class=\"token operator\">=</span> <span class=\"token class-name\">UITextField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        textFiled<span class=\"token punctuation\">.</span>borderStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span>roundedRect\n        textFiled<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> accountTextFiled<span class=\"token punctuation\">.</span>frame<span class=\"token punctuation\">.</span>maxY <span class=\"token operator\">+</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        textFiled<span class=\"token punctuation\">.</span>placeholder <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"Input password please.\"</span></span>\n        <span class=\"token keyword\">return</span> textFiled\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>ButtonItem.swift</p>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ButtonItem</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGItem</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> registerButton<span class=\"token punctuation\">:</span>  <span class=\"token class-name\">UIButton</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">createRegisterButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> loginButton <span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIButton</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">createLoginButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> buttonBundle<span class=\"token punctuation\">:</span> <span class=\"token class-name\">ButtonBundle</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span>frame<span class=\"token punctuation\">:</span> frame<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">required</span> <span class=\"token keyword\">init</span><span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>coder<span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSCoder</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token function\">fatalError</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"init(coder:) has not been implemented\"</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">bindBundle</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> bundle<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Any</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>buttonBundle <span class=\"token operator\">=</span> bundle <span class=\"token keyword\">as</span><span class=\"token operator\">?</span> <span class=\"token class-name\">ButtonBundle</span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">bindBundleLandscape</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> bundle<span class=\"token punctuation\">:</span> <span class=\"token keyword\">Any</span><span class=\"token operator\">?</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">itemWillRotate</span><span class=\"token punctuation\">(</span>rawValue<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">switch</span> rawValue<span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            registerButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n            loginButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">50</span> <span class=\"token operator\">-</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">3</span><span class=\"token punctuation\">:</span>\n            registerButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n            loginButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">50</span> <span class=\"token operator\">-</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">case</span> <span class=\"token number\">4</span><span class=\"token punctuation\">:</span>\n            registerButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n            loginButton<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_HEIGHT</span> <span class=\"token operator\">-</span> <span class=\"token number\">50</span> <span class=\"token operator\">-</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">break</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token class-name\">ButtonItem</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">initView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>registerButton<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span><span class=\"token function\">addSubview</span><span class=\"token punctuation\">(</span>loginButton<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">createRegisterButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">UIButton</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> button <span class=\"token operator\">=</span> <span class=\"token class-name\">UIButton</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Register\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span>setOnClickListener <span class=\"token punctuation\">{<!-- --></span> v <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>buttonBundle<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>registerClosure <span class=\"token operator\">!=</span> <span class=\"token nil constant\">nil</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>buttonBundle<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>registerClosure<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> button\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">createLoginButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">UIButton</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> button <span class=\"token operator\">=</span> <span class=\"token class-name\">UIButton</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span>frame <span class=\"token operator\">=</span> <span class=\"token class-name\">CGRect</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span> <span class=\"token operator\">-</span> <span class=\"token number\">50</span> <span class=\"token operator\">-</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span><span class=\"token function\">setTitle</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Login\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">for</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span>\n        button<span class=\"token punctuation\">.</span>setOnClickListener <span class=\"token punctuation\">{<!-- --></span> v <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>buttonBundle<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>loginClosure <span class=\"token operator\">!=</span> <span class=\"token nil constant\">nil</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>buttonBundle<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>loginClosure<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> button\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<ul><li>Fragment层<br/> TextFieldFragment.swift</li></ul>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TextFieldFragment</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SGFragmentDelegate</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> textFieldBundle<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextFieldBundle</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">TextFieldBundle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> textFieldItem<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextFieldItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> item <span class=\"token operator\">=</span> <span class=\"token class-name\">TextFieldItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        item<span class=\"token punctuation\">.</span>bundle <span class=\"token operator\">=</span> textFieldBundle\n        item<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> <span class=\"token class-name\">CGSize</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">130</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> item\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>textFieldItem<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>delegate <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">numberOfItemForFragment</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> fragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Int</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">.</span>count\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">itemAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> index<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">,</span> fragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">SGItem</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token class-name\">TextFieldFragment</span><span class=\"token punctuation\">{<!-- --></span>\n   \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">getAcccountText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">String</span><span class=\"token operator\">?</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> textFieldItem<span class=\"token punctuation\">.</span>accountTextFiled<span class=\"token punctuation\">.</span>text <span class=\"token operator\">??</span> <span class=\"token string-literal\"><span class=\"token string\">\"\"</span></span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">getPasswordText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">String</span><span class=\"token operator\">?</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> textFieldItem<span class=\"token punctuation\">.</span>passwordTextField<span class=\"token punctuation\">.</span>text <span class=\"token operator\">??</span> <span class=\"token string-literal\"><span class=\"token string\">\"\"</span></span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<p>ButtonFragment.swift</p>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ButtonFragment</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SGFragmentDelegate</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> buttonBundle<span class=\"token punctuation\">:</span> <span class=\"token class-name\">ButtonBundle</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> bundle <span class=\"token operator\">=</span> <span class=\"token class-name\">ButtonBundle</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        bundle<span class=\"token punctuation\">.</span>registerClosure <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>registerClosure <span class=\"token operator\">!=</span> <span class=\"token nil constant\">nil</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>registerClosure<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        bundle<span class=\"token punctuation\">.</span>loginClosure <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>loginClosure <span class=\"token operator\">!=</span> <span class=\"token nil constant\">nil</span><span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>loginClosure<span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> bundle\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> buttonItem<span class=\"token punctuation\">:</span> <span class=\"token class-name\">ButtonItem</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> item <span class=\"token operator\">=</span> <span class=\"token class-name\">ButtonItem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        item<span class=\"token punctuation\">.</span>bundle <span class=\"token operator\">=</span> buttonBundle\n        item<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> <span class=\"token class-name\">CGSize</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">:</span> <span class=\"token constant\">kSCREEN_WIDTH</span><span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> item\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> loginClosure<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> registerClosure<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>buttonItem<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">self</span><span class=\"token punctuation\">.</span>delegate <span class=\"token operator\">=</span> <span class=\"token keyword\">self</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">numberOfItemForFragment</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> fragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Int</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">.</span>count\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">itemAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> index<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">,</span> fragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGFragment</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">SGItem</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> items<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<ul><li>Bundle层：<br/> ButtonBundle.swift</li></ul>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ButtonBundle</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSObject</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> loginClosure<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">var</span> registerClosure<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    \n<span class=\"token punctuation\">}</span>\n</code></pre>\n<ul><li>ActivityModel层：<br/> LoginActivityModel.swift</li></ul>\n<pre><code class=\"prism language-swift\"><span class=\"token keyword\">import</span> <span class=\"token class-name\">UIKit</span>\n<span class=\"token keyword\">import</span> <span class=\"token class-name\">Foundation</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginActivityModel</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">NSObject</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">SGActivityDelegate</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">weak</span> <span class=\"token keyword\">var</span> context<span class=\"token punctuation\">:</span> <span class=\"token class-name\">UIViewController</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> <span class=\"token constant\">ACCOUNT</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span> <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"admin\"</span></span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">let</span> <span class=\"token constant\">PASSWORD</span><span class=\"token punctuation\">:</span> <span class=\"token class-name\">String</span> <span class=\"token operator\">=</span> <span class=\"token string-literal\"><span class=\"token string\">\"123456\"</span></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">var</span> fragments<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">SGFragment</span><span class=\"token operator\">&gt;!</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> textFieldFragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">TextFieldFragment</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> fragment <span class=\"token operator\">=</span> <span class=\"token class-name\">TextFieldFragment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> fragment\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">lazy</span> <span class=\"token keyword\">var</span> buttonFragment<span class=\"token punctuation\">:</span> <span class=\"token class-name\">ButtonFragment</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">let</span> fragment <span class=\"token operator\">=</span> <span class=\"token class-name\">ButtonFragment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        fragment<span class=\"token punctuation\">.</span>loginClosure <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">loginEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        fragment<span class=\"token punctuation\">.</span>registerClosure <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">weak</span> <span class=\"token keyword\">self</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">in</span>\n            <span class=\"token keyword\">self</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">registerEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">return</span> fragment\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">var</span> clickAction<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Void</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span>\n    \n    <span class=\"token keyword\">override</span> <span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        <span class=\"token function\">initData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">initData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        fragments <span class=\"token operator\">=</span> <span class=\"token class-name\">Array</span><span class=\"token operator\">&lt;</span><span class=\"token class-name\">SGFragment</span><span class=\"token operator\">&gt;</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">let</span> notice <span class=\"token operator\">=</span> <span class=\"token class-name\">SGTextFragment</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Start A Journey\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> blank1 <span class=\"token operator\">=</span> <span class=\"token class-name\">SGBlankFragment</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">:</span> <span class=\"token number\">80</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">let</span> blank2 <span class=\"token operator\">=</span> <span class=\"token class-name\">SGBlankFragment</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n        \n        fragments<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>notice<span class=\"token punctuation\">)</span>\n        fragments<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>blank1<span class=\"token punctuation\">)</span>\n        fragments<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>textFieldFragment<span class=\"token punctuation\">)</span>\n        fragments<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>blank2<span class=\"token punctuation\">)</span>\n        fragments<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>buttonFragment<span class=\"token punctuation\">)</span>\n        \n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// MARK: - Event</span>\n<span class=\"token keyword\">extension</span> <span class=\"token class-name\">LoginActivityModel</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">loginEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span> textFieldFragment<span class=\"token punctuation\">.</span><span class=\"token function\">getAcccountText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token constant\">ACCOUNT</span> <span class=\"token operator\">&amp;&amp;</span> textFieldFragment<span class=\"token punctuation\">.</span><span class=\"token function\">getPasswordText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token constant\">PASSWORD</span> <span class=\"token punctuation\">{<!-- --></span>\n            context<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token function\">toast</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Login Succeed.\"</span></span><span class=\"token punctuation\">,</span> location<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">.</span>center<span class=\"token punctuation\">)</span>\n            <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Login succeed.\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">registerEvent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">if</span> textFieldFragment<span class=\"token punctuation\">.</span><span class=\"token function\">getAcccountText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token constant\">ACCOUNT</span> <span class=\"token punctuation\">{<!-- --></span>\n            <span class=\"token class-name\">Log</span><span class=\"token punctuation\">.</span><span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token string-literal\"><span class=\"token string\">\"Register Done.\"</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">extension</span> <span class=\"token class-name\">LoginActivityModel</span><span class=\"token punctuation\">{<!-- --></span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">numberOfSGFragmentForSGActivity</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> activity<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGActivity</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">Int</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> fragments<span class=\"token punctuation\">.</span>count\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">fragmentAtIndex</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> activity<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGActivity</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">:</span> <span class=\"token class-name\">Int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">SGFragment</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> fragments<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n    \n    <span class=\"token keyword\">func</span> <span class=\"token function-definition function\">topFragmentForSGActivity</span><span class=\"token punctuation\">(</span><span class=\"token omit keyword\">_</span> activity<span class=\"token punctuation\">:</span> <span class=\"token class-name\">SGActivity</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-&gt;</span> <span class=\"token class-name\">SGFragment</span><span class=\"token operator\">?</span> <span class=\"token punctuation\">{<!-- --></span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">SGTextFragment</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"Swiped to the top\"</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    \n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<h3><a id=\"_522\"></a>登陆成果</h3>\n<p>竖屏默认状态：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\708567c5b9794895ba1acf1c06b6ef7c.png\"/></p>\n<p>登陆成功：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\77e356be40a04bd49e0f465183a7a92c.png\"/></p>\n<p>横屏状态：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\e68967e20378430b8c0632396da85680.png\"/><br/> 可以看到，无论是ViewController层还是ActivityModel层，其耦合性都得到了不少的改善，数据流向清晰简单，事件传递正常，横竖屏也适配正常。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}