{"blogid": "126656981", "writerAge": "码龄7年", "writerBlogNum": "230", "writerCollect": "14818", "writerComment": "509", "writerFan": "3757", "writerGrade": "7级", "writerIntegral": "11548", "writerName": "DanCheng-studio", "writerProfileAdress": "writer_image\\profile_126656981.jpg", "writerRankTotal": "938", "writerRankWeekly": "684", "writerThumb": "1841", "writerVisitNum": "1214049", "blog_read_count": "666", "blog_time": "于 2022-09-02 10:12:42 发布", "blog_title": "【毕业设计】深度学习YOLO图像视频足球和人体检测 - python opencv", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"1__1\"></a>1 前言</h1>\n<p>🚩 <strong>深度学习YOLO图像视频足球和人体检测</strong></p>\n<p>🥇学长这里给一个题目综合评分(每项满分5分)</p>\n<ul><li>难度系数：3分</li><li>工作量：3分</li><li>创新点：5分</li></ul>\n<p>🧿 <strong>选题指导, 项目分享：</strong></p>\n<p><a href=\"https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md\">https://gitee.com/dancheng-senior/project-sharing-1/blob/master/%E6%AF%95%E8%AE%BE%E6%8C%87%E5%AF%BC/README.md</a></p>\n<h1><a id=\"1__14\"></a>1 课题背景</h1>\n<p>得益于深度学习技术的飞速发展,基于深度学习的目标检测算法研究成为近几年研究的热门方向。<br/> 本项目基于Yolov5算法实现图像视频足球和人检测。</p>\n<h1><a id=\"2__19\"></a>2 实现效果</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\38deedd4c4a444e68a7749e422e32de6.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\76e721d1a5fd44728927d43608d73bab.png\"/></p>\n<h1><a id=\"3__24\"></a>3 卷积神经网络</h1>\n<p>卷积神经网络（CNN）是一种包含卷积运算的深层前馈神经网络。传统的神经网络每个神经元权重连接上层的所有神经元，所以会出现大量权重值，增加整个网络的数据量和复杂程度。CNN则具有两个重要特征则是“局部感知”和“权值共享”，可有效提取数据的特征同时降低权值数量。完整的卷积网络通常包括卷积层、池化层、全连接层和输出层。<br/> 卷积神经网络的运行流程就是在卷积层进行特征提取，池化层进行进一步特征概括，最终通过全连接层进行分类的过程，流程见下图。根据数据的特征不同，卷积网络需要构建不同深度的网络结构，越复杂的数据越需要丰富的网络堆叠方式来提取数据的多层特征。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\3ea6b15044204f51bc86d9b280c906b8.png\"/></p>\n<p>卷积层的提取数据特征的作用方式是通过卷积运算，使相同的卷积核根据固定的步长遍历数据。卷积核每遍历一个位置就和前一层中的神经元执行卷积运算，它是将矩阵中相同位置的元素直接相乘，然后求和的过程。在一维卷积神经网络中按照这个运算逻辑将卷积核矩阵根据步幅值继续向右滑动，直到覆盖整个输入矩阵，如图。</p>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\68dcccc0902747e4bbca55e164bc67d0.jpeg\"/></p>\n<p>最后，得到卷积后的特征矩阵。在卷积层，输入由一组卷积核卷积得到新的特征映射经过激活函数处理传递至下一层。</p>\n<p>池化层实现的功能则是对输入数据的降维和抽象，通过在空间范围内做维度约减，使模型可以抽取更广范围的特征，同时减少计算量和参数个数。池化采样主要分为两种方法：平均池化采样和最大池化采样。本文采用的是最大池化。池化过程如图。</p>\n<p><img alt=\"[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OLAWidxU-1659541083528)(D:\\CSDN_Articles\\文章素材\\CNN卷积神经网络\\3_3.jpg)]\" src=\"image\\228a5a0c5fbe4b56b54f06d5f66bb531.jpeg\"/></p>\n<p>最终卷积层和池化层提取的所有特征，在全连接层中以非线性地拟合输入数据用于分类。</p>\n<h1><a id=\"4_Yolov5_47\"></a>4 Yolov5算法</h1>\n<p><strong>简介</strong><br/> 下图所示为 YOLOv5 的网络结构图，分为输入端，Backbone，Neck 和 Prediction 四个部分。其中，<br/> 输入端包括 Mosaic 数据增强、自适应图片缩放、自适应锚框计算，Backbone 包括 Focus 结构、CSP<br/> 结 构，Neck 包 括 FPN+PAN 结 构，Prediction 包 括GIOU_Loss 结构。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\40782fb9736d4845a3a0adac01550b3f.png\"/><br/> 相关代码</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Yolo</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">object</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> weights_file<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>verbose <span class=\"token operator\">=</span> verbose\n        <span class=\"token comment\"># detection params</span>\n        self<span class=\"token punctuation\">.</span>S <span class=\"token operator\">=</span> <span class=\"token number\">7</span>  <span class=\"token comment\"># cell size</span>\n        self<span class=\"token punctuation\">.</span>B <span class=\"token operator\">=</span> <span class=\"token number\">2</span>  <span class=\"token comment\"># boxes_per_cell</span>\n        self<span class=\"token punctuation\">.</span>classes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"aeroplane\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bicycle\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bird\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"boat\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bottle\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"bus\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"car\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cat\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"chair\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cow\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"diningtable\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"dog\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"horse\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"motorbike\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"person\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"pottedplant\"</span><span class=\"token punctuation\">,</span>\n                        <span class=\"token string\">\"sheep\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sofa\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"train\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"tvmonitor\"</span><span class=\"token punctuation\">]</span>\n        self<span class=\"token punctuation\">.</span>C <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>classes<span class=\"token punctuation\">)</span> <span class=\"token comment\"># number of classes</span>\n        <span class=\"token comment\"># offset for box center (top left point of each cell)</span>\n        self<span class=\"token punctuation\">.</span>x_offset <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>S<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>self<span class=\"token punctuation\">.</span>S<span class=\"token operator\">*</span>self<span class=\"token punctuation\">.</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                              <span class=\"token punctuation\">[</span>self<span class=\"token punctuation\">.</span>B<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>S<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>S<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>y_offset <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>x_offset<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>threshold <span class=\"token operator\">=</span> <span class=\"token number\">0.2</span>  <span class=\"token comment\"># confidence scores threhold</span>\n        self<span class=\"token punctuation\">.</span>iou_threshold <span class=\"token operator\">=</span> <span class=\"token number\">0.4</span>\n        <span class=\"token comment\">#  the maximum number of boxes to be selected by non max suppression</span>\n        self<span class=\"token punctuation\">.</span>max_output_size <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n\n        self<span class=\"token punctuation\">.</span>sess <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>Session<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>_build_net<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>_build_detector<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>_load_weights<span class=\"token punctuation\">(</span>weights_file<span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"5__84\"></a>5 数据集</h1>\n<p>数据集包含4000多张标注过的球员与足球<br/> <img alt=\"在这里插入图片描述\" src=\"image\\3569a17506224c678ea7222522aa0e4d.png\"/></p>\n<h1><a id=\"6__89\"></a>6 最后</h1>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}