{"blogid": "126658005", "writerAge": "码龄1年", "writerBlogNum": "1068", "writerCollect": "4905", "writerComment": "324", "writerFan": "4734", "writerGrade": "7级", "writerIntegral": "13233", "writerName": "biyezuopinvip", "writerProfileAdress": "writer_image\\profile_126658005.jpg", "writerRankTotal": "825", "writerRankWeekly": "2471", "writerThumb": "1694", "writerVisitNum": "625653", "blog_read_count": "196", "blog_time": "于 2022-09-02 10:46:00 发布", "blog_title": "基于python爬取母婴用品评论的数据分析", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-tomorrow-night\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p>目录<br/> 摘 要 I<br/> Abstract II<br/> 1 绪论 4<br/> 1.1 背景及意义 4<br/> 1.1.1 背景 4<br/> 1.1.2 目标及意义 4<br/> 1.2 应用现状 4<br/> 1.3 数据模型及主要板块 5<br/> 1.3.1数据模型建立 5<br/> 1.3.2 主要板块 5<br/> 1.4 主要方法及技术路线 6<br/> 1.4.1 主要方法 6<br/> 1.4.2技术路线 6<br/> 2开发环境及技术 7<br/> 2.1硬件设备 7<br/> 2.1.1 CPU及操作系统 7<br/> 2.1.2 其他 7<br/> 2.2软件及IDE 7<br/> 2.2.1 MySQL 7<br/> 2.2.2 IDE 8<br/> 2.3主要技术 8<br/> 2.3.1 MySQL 8<br/> 2.3.2 Python 9<br/> 3 可行性分析与模块设计 10<br/> 3.1 可行性分析 10<br/> 3.1.1 技术可行性分析 10<br/> 3.1.2 数据可获得性分析 10<br/> 3.2 各模块设计 10<br/> 3.2.1 数据获取方法 10<br/> 3.2.2 数据预处理设计 10<br/> 3.2.3 数据分析思路设计 12<br/> 4 系统实现与结论 13<br/> 4.1数据采集 13<br/> 4.1.1确定待采集数据 13<br/> 4.1.2确定采集对象及采集思路 13<br/> 4.2采集准备 14<br/> 4.3开始采集数据 14<br/> 4.3.1分析网页 14<br/> 4.3.2思考 19<br/> 4.4数据清洗与分析 20<br/> 4.4.1清洗过程简述 20<br/> 4.5 可视化与分析 20<br/> 4.5.1消费时段分析 21<br/> 4.5.2月消费与会员等级分析 23<br/> 4.5.3评论内容分析 25<br/> 5 设计过程中存在的问题和解决过程 27<br/> 5.1问题1描述 27<br/> 5.2解决办法 27<br/> 5.3问题2描述 27<br/> 5.4解决办法 28<br/> 6 总结 31<br/> 致 谢 32<br/> 参考文献 33<br/> 3 可行性分析与模块设计<br/> 3.1 可行性分析<br/> 3.1.1 技术可行性分析<br/> 本人掌握python、MySQL等数据处理技术，并且熟练使用MySQL数据库、pycharm集成开发环境，并且在互联网上比较容易获取找到相关技术文档，因此技术思路清晰。<br/> 3.1.2 数据可获得性分析<br/> 本文分析数据由京东云天池提供的京东平台母婴商品销售数据集Baby Goods Info Data，数据来源真实可靠而且可以轻松获取。<br/> 3.2 各模块设计<br/> 3.2.1 数据获取方法<br/> 数据集源自Baby Goods Info Data-数据集-京东云天池，是京东平台母婴商品的销售数据，包括：<br/> 表1购买商品表（sample)sam_tianchi_mum_baby_trade_history.csv，主要记录用户在京东平台购买商品的信息，包括商品详细信息与购买行为发生时的详细记录等内容。<br/> 表2婴儿信息表 (sample)sam_tianchi_mum_baby.csv，主要记录商品适用的用户信息与产生购买行为的用户的相关登记信息。<br/> 3.2.2 数据预处理设计<br/> 详细说明数据分析中需要的字段以及对数据进行关联、清洗等预处理内容。<br/> 例如：<br/> 将收集到的信息表导入MySQL数据库中进行存储与预处理，因分析内容涉及用户维度的分析，所以首先需关联商品购买信息表和婴儿信息表，并在表1中添加婴儿生日、婴儿性别、婴儿年龄字段，接下来只需要对表1进行清洗。<br/> （1）选择子集<br/> 根据上面的分析思路，只需要用到以下字段：用户ID，商品二级分类，商品一级分类，商品属性，购买数量，购买时间，婴儿生日，婴儿性别，婴儿年龄，将不需要的字段隐藏以便分析。<br/> （2）列重命名<br/> 原表字段都是英文，为了方便分析，改成中文。<br/> （3）删除重复值<br/> 无重复数据。<br/> （4）缺失值处理<br/> 商品属性字段存在缺失值，不过这次分析用不到该字段，可直接忽略。<br/> （5）一致化处理<br/> 购买时间和婴儿生日字段都是非标准日期格式，需改成标准型。并且婴儿性别字段值是0和1，需将值更改成男和女。<br/> （6）数据排序<br/> 按购买时间升序排序。<br/> （7）异常值处理<br/> a.购买数量超过100的全改成1，这次分析主要争对个人用户，考虑到存在一次买几十个商品的土豪，所以将分界线设为100。<br/> b.婴儿年龄-1改为0，-2不做处理，28不做处理。存在负数是因为用户在婴儿出生前购买商品，-1表示提前一年内，可以改成0，-2表示提前2年，明显不合理，所以不做处理，分析用户相关内容时过滤。婴儿年龄28估计是用户误填了自己的年龄，同-2不做处理。<br/> c.婴儿性别为2的不做处理，分析用户相关内容时过滤。<br/> d.婴儿生日、婴儿性别、婴儿年龄字段的错误值（#N/A）不做处理。这是因为用户没有填写婴儿信息，只需在分析用户相关内容时过滤。<br/> 3.2.3 数据分析思路设计<br/> 电商平台总体分析可以从网站整体访问及订单销售两个大的维度来进行综合分析，对订单评论所含内容进行简单的分析，初步确定所需要抓取的内容。首先，在京东商城母婴信息界面的用户评价中含有昵称、会员等级、评价星级，评价内容、母婴品牌、购买时间等等。其中通过分析会员等级与购买的关系，可以给为不同会员提供不同的产品做参考。分析评价内容可以大概可以推断出消费者对该产品的态度、以及哪些回复关注度比较高等等。分析购买时间可以了解到消费者集中的购买时间段。这些分析对商品广告的精准投放以及为消费者提供更个性化的服务提供了重要参考。本文转载自http://www.biyezuopin.vip/onews.asp?id=16405</p>\n<pre><code class=\"prism language-cpp\"># <span class=\"token operator\">-</span><span class=\"token operator\">*</span><span class=\"token operator\">-</span> encoding<span class=\"token operator\">:</span> utf<span class=\"token operator\">-</span><span class=\"token number\">8</span> <span class=\"token operator\">-</span><span class=\"token operator\">*</span><span class=\"token operator\">-</span>\nfrom <span class=\"token keyword\">enum</span> <span class=\"token keyword\">import</span> <span class=\"token module\">Flag</span>\nfrom fake_useragent <span class=\"token keyword\">import</span> <span class=\"token module\">UserAgent</span>\nfrom bs4 <span class=\"token keyword\">import</span> <span class=\"token module\">BeautifulSoup</span>\n<span class=\"token keyword\">import</span> <span class=\"token module\">time</span>\n<span class=\"token keyword\">import</span> <span class=\"token module\">numpy</span> as np\n<span class=\"token keyword\">import</span> <span class=\"token module\">requests</span>\n<span class=\"token keyword\">import</span> <span class=\"token module\">json</span>\n<span class=\"token keyword\">import</span> <span class=\"token module\">csv</span>\n<span class=\"token keyword\">import</span> <span class=\"token module\">io</span>\n\n# 保存评论数据\ndef <span class=\"token function\">commentSave</span><span class=\"token punctuation\">(</span>list_comment<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token char\">''</span>'\n    list_comment<span class=\"token operator\">:</span> 二维list<span class=\"token punctuation\">,</span>包含了多条用户评论信息\n    <span class=\"token char\">''</span>'\n    file <span class=\"token operator\">=</span> io<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token char\">'data/JDComment_data.csv'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'w'</span><span class=\"token punctuation\">,</span>encoding<span class=\"token operator\">=</span><span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">,</span>newline <span class=\"token operator\">=</span> <span class=\"token char\">''</span><span class=\"token punctuation\">)</span>\n    writer <span class=\"token operator\">=</span> csv<span class=\"token punctuation\">.</span><span class=\"token function\">writer</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span>\n    writer<span class=\"token punctuation\">.</span><span class=\"token function\">writerow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token char\">'用户ID'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'评论内容'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'购买时间'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'点赞数'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'回复数'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'得分'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'评价时间'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'手机型号'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token function\">len</span><span class=\"token punctuation\">(</span>list_comment<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        writer<span class=\"token punctuation\">.</span><span class=\"token function\">writerow</span><span class=\"token punctuation\">(</span>list_comment<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    file<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token char\">'存入成功'</span><span class=\"token punctuation\">)</span>\n\ndef <span class=\"token function\">getCommentData</span><span class=\"token punctuation\">(</span>format_url<span class=\"token punctuation\">,</span>proc<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span>maxPage<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token char\">''</span>'\n    format_url<span class=\"token operator\">:</span> 格式化的字符串架子，在循环中给它添上参数\n    proc<span class=\"token operator\">:</span> 商品的productID，标识唯一的商品号\n    i<span class=\"token operator\">:</span> 商品的排序方式，例如全部商品、晒图、追评、好评等\n    maxPage<span class=\"token operator\">:</span> 商品的评论最大页数\n    <span class=\"token char\">''</span>'\n    sig_comment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    global list_comment\n    cur_page <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">while</span> cur_page <span class=\"token operator\">&lt;</span> maxPage<span class=\"token operator\">:</span>\n        cur_page <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        <span class=\"token macro property\"><span class=\"token directive-hash\">#</span> <span class=\"token directive keyword\">url</span> <span class=\"token expression\"><span class=\"token operator\">=</span> 'https<span class=\"token operator\">:</span></span><span class=\"token comment\">//sclub.jd.com/comment/productPageComments.action?callback=fetchJSON_comment98vv%s&amp;score=%s&amp;sortType=5&amp;page=%s&amp;pageSize=10&amp;isShadowSku=0&amp;fold=1'%(proc,i,cur_page)</span></span>\n        url <span class=\"token operator\">=</span> format_url<span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span>proc<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span>cur_page<span class=\"token punctuation\">)</span> # 给字符串添上参数\n        <span class=\"token keyword\">try</span><span class=\"token operator\">:</span>\n            response <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">,</span> verify<span class=\"token operator\">=</span>False<span class=\"token punctuation\">)</span>\n            time<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n            jsonData <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>text\n            startLoc <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token char\">'{'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">print</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">[</span><span class=\"token double-colon punctuation\">::</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></span><span class=\"token comment\">//字符串逆序</span></span>\n            jsonData <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span>startLoc<span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n            jsonData <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token function\">loads</span><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">)</span>\n            pageLen <span class=\"token operator\">=</span> <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"当前第%s页\"</span><span class=\"token operator\">%</span>cur_page<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">for</span> j in <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>pageLen<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n                userId <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'id'</span><span class=\"token punctuation\">]</span>#用户ID\n                content <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'content'</span><span class=\"token punctuation\">]</span>#评论内容\n                boughtTime <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'referenceTime'</span><span class=\"token punctuation\">]</span>#购买时间\n                voteCount <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'usefulVoteCount'</span><span class=\"token punctuation\">]</span>#点赞数\n                replyCount <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'replyCount'</span><span class=\"token punctuation\">]</span>#回复数目\n                starStep <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'score'</span><span class=\"token punctuation\">]</span>#得分\n                creationTime <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'creationTime'</span><span class=\"token punctuation\">]</span>#评价时间\n                referenceName <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'comments'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token char\">'referenceName'</span><span class=\"token punctuation\">]</span>#手机型号\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span>#每一行数据\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>boughtTime<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>voteCount<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>replyCount<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>starStep<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>creationTime<span class=\"token punctuation\">)</span>\n                sig_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>referenceName<span class=\"token punctuation\">)</span>\n                list_comment<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>sig_comment<span class=\"token punctuation\">)</span>\n                <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>sig_comment<span class=\"token punctuation\">)</span>\n                sig_comment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        except<span class=\"token operator\">:</span>\n            time<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n            cur_page <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token char\">'网络故障或者是网页出现了问题，五秒后重新连接'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token operator\">:</span>\n    global list_comment\n    ua<span class=\"token operator\">=</span><span class=\"token function\">UserAgent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    format_url <span class=\"token operator\">=</span> 'https<span class=\"token operator\">:</span><span class=\"token comment\">//club.jd.com/comment/productPageComments.action?callback=fetchJSON_comment98&amp;{0}&amp;score={1}&amp;sortType=5&amp;page={2}&amp;pageSize=10&amp;isShadowSku=0&amp;fold=1'</span>\n    # 设置访问请求头\n    headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token char\">'Accept'</span><span class=\"token operator\">:</span> <span class=\"token char\">'*/*'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'Host'</span><span class=\"token operator\">:</span><span class=\"token string\">\"club.jd.com\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"User-Agent\"</span><span class=\"token operator\">:</span>ua<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'Referer'</span><span class=\"token operator\">:</span><span class=\"token string\">\"https://item.jd.com/\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'sec-ch-ua'</span><span class=\"token operator\">:</span><span class=\"token string\">\"\\\"Chromium\\\";v=\\\"92\\\", \\\" Not A;Brand\\\";v=\\\"99\\\", \\\"Google Chrome\\\";v=\\\"92\\\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'sec-ch-ua-mobile'</span><span class=\"token operator\">:</span> <span class=\"token char\">'?0'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'Sec-Fetch-Dest'</span><span class=\"token operator\">:</span> <span class=\"token char\">'script'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'Sec-Fetch-Mode'</span><span class=\"token operator\">:</span><span class=\"token char\">'no-cors'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'Sec-Fetch-Site'</span><span class=\"token operator\">:</span><span class=\"token char\">'same-site'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token char\">'cookie'</span><span class=\"token operator\">:</span><span class=\"token char\">'your cookies'</span>\n    <span class=\"token punctuation\">}</span>\n    #手机四种颜色对应的产品id参数\n    productid <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token char\">'productId=100006795590'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'136061&amp;productId=5089275'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'22778&amp;productId=5475612'</span><span class=\"token punctuation\">,</span><span class=\"token char\">'7021&amp;productId=6784504'</span><span class=\"token punctuation\">]</span>\n    list_comment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    sig_comment <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> proc in productid<span class=\"token operator\">:</span>#遍历产品颜色\n        i <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n        <span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">7</span><span class=\"token operator\">:</span>#遍历排序方式\n            i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">==</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n                <span class=\"token keyword\">continue</span>\n             #先访问第<span class=\"token number\">0</span>页获取最大页数，再进行循环遍历\n            url <span class=\"token operator\">=</span> format_url<span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span>proc<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">try</span><span class=\"token operator\">:</span>\n                response <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">,</span> verify<span class=\"token operator\">=</span>False<span class=\"token punctuation\">)</span>\n                jsonData <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>text\n                startLoc <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token char\">'{'</span><span class=\"token punctuation\">)</span>\n                jsonData <span class=\"token operator\">=</span> jsonData<span class=\"token punctuation\">[</span>startLoc<span class=\"token operator\">:</span><span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n                jsonData <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token function\">loads</span><span class=\"token punctuation\">(</span>jsonData<span class=\"token punctuation\">)</span>\n                <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"最大页数%s\"</span><span class=\"token operator\">%</span>jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'maxPage'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n                <span class=\"token function\">getCommentData</span><span class=\"token punctuation\">(</span>format_url<span class=\"token punctuation\">,</span>proc<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">,</span>jsonData<span class=\"token punctuation\">[</span><span class=\"token char\">'maxPage'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>#遍历每一页\n            except Exception as e<span class=\"token operator\">:</span>\n                i <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n                <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"the error is \"</span><span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">)</span>\n                <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"wating---\"</span><span class=\"token punctuation\">)</span>\n                time<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n                <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">comment</span><span class=\"token expression\"><span class=\"token function\">Save</span><span class=\"token punctuation\">(</span>list_comment<span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"爬取结束，开始存储-------\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">commentSave</span><span class=\"token punctuation\">(</span>list_comment<span class=\"token punctuation\">)</span>\n\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\ef294aaec0554d6b88d8273cc4c6c855.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\12da86f08e874c8f9af2a846b48db957.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\961dad9a0d014d6187a1f829dd6ab1f9.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\704fdd83077241e1adba9ad020cb82b9.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\b140946f34384e2a8638d8dcd427480e.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\cc02e0c1da1c41579c9173194f4a991d.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\e4a634a77ba8413495203f586f7da9cc.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\7fdcf3f785af4f358d2124528dc0b262.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\7efc539761484ea5911d131809ab5559.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\dd60ce90d4834b0e82943ed2486c25c8.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\25aa4b050481489aa72bc65ce9693a8b.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\b9eeb2d8662d4cbfa7b1907a0d623562.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}