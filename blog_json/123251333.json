{"blogid": "123251333", "writerAge": "码龄4年", "writerBlogNum": "35", "writerCollect": "143", "writerComment": "9", "writerFan": "27", "writerGrade": "3级", "writerIntegral": "415", "writerName": "Tony", "writerProfileAdress": "writer_image\\profile_123251333.jpg", "writerRankTotal": "99645", "writerRankWeekly": "375121", "writerThumb": "43", "writerVisitNum": "26580", "blog_read_count": "12482", "blog_time": "已于 2022-03-22 20:49:11 修改", "blog_title": "Python虚拟环境", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>Python虚拟环境</h3>\n<ul><li><a href=\"#_3\">一、什么是虚拟环境</a></li><li><a href=\"#venv_20\">二、使用venv创建虚拟环境及其目录结构</a></li><li><ul><li><a href=\"#_28\">创建虚拟环境</a></li><li><a href=\"#_37\">虚拟环境目录分析</a></li><li><a href=\"#_127\">激活虚拟环境</a></li><li><a href=\"#_150\">虚拟环境做了什么</a></li><li><a href=\"#_156\">关闭虚拟环境</a></li></ul>\n</li><li><a href=\"#_163\">三、虚拟环境重要性</a></li><li><a href=\"#PyCharm_167\">四、PyCharm中的虚拟环境</a></li><li><a href=\"#_190\">五、保存和复制虚拟环境</a></li><li><a href=\"#_202\">六、总结</a></li></ul>\n</div>\n<p></p>\n<p>本文是学习笔记，记录了<a href=\"https://www.bilibili.com/video/BV1V7411n7CM?spm_id_from=333.337.search-card.all.click\">【安装不算完事，只有理解了虚拟环境才算真正掌握 Python 环境】</a>大佬的讲解，感谢分享。</p>\n<h1><a id=\"_3\"></a>一、什么是虚拟环境</h1>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\91cea233544e4376b53a1821a1df1f62.png\"/><br/> 安装python的时候相当于安装了一个全局的环境：</p>\n<ul><li>site-packages目录下是python第三方包（也就是pip install 安装的包都在该目录下）</li><li>标准库就是原生库（os,sys, math 等等）</li><li>Scripts下是可执行文件（pip install 时就会使用pip.exe这个可执行文件）</li><li>python.exe就是python解释器</li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a66cea3728b646abbebcabc3efbf33fe.png\"/><br/> <strong>虚拟环境</strong>可以看作是原生<strong>Python的副本</strong>，但是标准库都是一样的，每次都复制是不合算的<br/> <img alt=\"在这里插入图片描述\" src=\"image\\9e833bd6203142348dc7f99328bb7f9a.png\"/><br/> 所以每次就不复制标准库，而是直接调用原来的标准库就行。<br/> 同时解释器也存到<strong>Scripts</strong>这个目录下，path环境变量只需要增加一个即可。</p>\n<h1><a id=\"venv_20\"></a>二、使用venv创建虚拟环境及其目录结构</h1>\n<p><strong>python3.3</strong> 之后<strong>venv</strong>已经作为标准库嵌入到了python中，而之前的版本需要借助<strong>virtualenv</strong>这个第三方库来实现。</p>\n<p>在终端中使用<code>python -m venv -h</code>可以显示<code>venv</code>工具的用法。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\efc9463c13a2446695ac6eafd8c17cd5.png\"/><br/> 介绍的两个选项：<br/> <code>--system-site-packages</code>代表使用全局环境中的第三方库（否则虚拟环境直接是纯洁的第三方库）<br/> <code>--without-pip</code>代表不安装<strong>pip</strong>（一般都是要装的，所以默认就行）</p>\n<h2><a id=\"_28\"></a>创建虚拟环境</h2>\n<p>所以正常创建虚拟环境指令如下：<code>python -m venv 安装路径</code></p>\n<p>在当前目录下安装venvdemo这个虚拟环境</p>\n<pre><code class=\"prism language-powershell\">C:\\Users\\sunh_&gt;python <span class=\"token operator\">-</span>m venv venvdemo\n</code></pre>\n<h2><a id=\"_37\"></a>虚拟环境目录分析</h2>\n<p>进入虚拟环境查看目录结构：Lib是工具包，Scripts是可执行文件（和第一节描述相同）</p>\n<pre><code class=\"prism language-powershell\">C:\\Users\\sunh_&gt;cd venvdemo\n\nC:\\Users\\sunh_\\venvdemo&gt;<span class=\"token function\">dir</span>\n 驱动器 C 中的卷是 Windows<span class=\"token operator\">-</span>SSD\n 卷的序列号是 F639<span class=\"token operator\">-</span>05B6\n\n C:\\Users\\sunh_\\venvdemo 的目录\n\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          Include\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          Lib\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14                77 pyvenv<span class=\"token punctuation\">.</span>cfg\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          Scripts\n               1 个文件             77 字节\n               5 个目录 10<span class=\"token punctuation\">,</span>210<span class=\"token punctuation\">,</span>123<span class=\"token punctuation\">,</span>776 可用字节\n</code></pre>\n<p>进入<strong>Lib</strong>查看目录结构：<strong>无标准库</strong>，有第三方库<strong>site-packages</strong><br/> 进入<strong>site-packages</strong>查看目录结构：只有类似pip的少量包，是纯净的</p>\n<pre><code class=\"prism language-powershell\">C:\\Users\\sunh_\\venvdemo&gt;cd Lib\n\nC:\\Users\\sunh_\\venvdemo\\Lib&gt;<span class=\"token function\">dir</span>\n 驱动器 C 中的卷是 Windows<span class=\"token operator\">-</span>SSD\n 卷的序列号是 F639<span class=\"token operator\">-</span>05B6\n\n C:\\Users\\sunh_\\venvdemo\\Lib 的目录\n\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          site<span class=\"token operator\">-</span>packages\n               0 个文件              0 字节\n               3 个目录 10<span class=\"token punctuation\">,</span>210<span class=\"token punctuation\">,</span>156<span class=\"token punctuation\">,</span>544 可用字节\n\nC:\\Users\\sunh_\\venvdemo\\Lib&gt;cd site<span class=\"token operator\">-</span>packages\n\nC:\\Users\\sunh_\\venvdemo\\Lib\\site<span class=\"token operator\">-</span>packages&gt;<span class=\"token function\">dir</span>\n 驱动器 C 中的卷是 Windows<span class=\"token operator\">-</span>SSD\n 卷的序列号是 F639<span class=\"token operator\">-</span>05B6\n\n C:\\Users\\sunh_\\venvdemo\\Lib\\site<span class=\"token operator\">-</span>packages 的目录\n\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15               126 easy_install<span class=\"token punctuation\">.</span>py\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          pip\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          pip<span class=\"token operator\">-</span>19<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">.</span>dist<span class=\"token operator\">-</span>info\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          pkg_resources\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          setuptools\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          setuptools<span class=\"token operator\">-</span>40<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>dist<span class=\"token operator\">-</span>info\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          __pycache__\n               1 个文件            126 字节\n               8 个目录 10<span class=\"token punctuation\">,</span>210<span class=\"token punctuation\">,</span>156<span class=\"token punctuation\">,</span>544 可用字节\n</code></pre>\n<p>退回，进入<strong>Scripts</strong>库查看目录结构：可以看到包括<strong>pip.exe</strong>和<strong>python.exe</strong>的可执行文件。<br/> 由于使用虚拟环境是需要激活的，所以可以看到下面的文件：activate是linux下的激活文件；<br/> activate.bat和Activate.ps1是windows下的激活文件；<br/> deactivate.bat用来关闭虚拟环境。</p>\n<pre><code class=\"prism language-powershell\">C:\\Users\\sunh_\\venvdemo\\Lib\\site<span class=\"token operator\">-</span>packages&gt;cd <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nC:\\Users\\sunh_\\venvdemo\\Lib&gt;cd <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nC:\\Users\\sunh_\\venvdemo&gt;cd Scripts\n\nC:\\Users\\sunh_\\venvdemo\\Scripts&gt;<span class=\"token function\">dir</span>\n 驱动器 C 中的卷是 Windows<span class=\"token operator\">-</span>SSD\n 卷的序列号是 F639<span class=\"token operator\">-</span>05B6\n\n C:\\Users\\sunh_\\venvdemo\\Scripts 的目录\n\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14    &lt;<span class=\"token function\">DIR</span>&gt;          <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15             2<span class=\"token punctuation\">,</span>287 activate\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15             1<span class=\"token punctuation\">,</span>025 activate<span class=\"token punctuation\">.</span>bat\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15             1<span class=\"token punctuation\">,</span>495 Activate<span class=\"token punctuation\">.</span>ps1\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15               368 deactivate<span class=\"token punctuation\">.</span>bat\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15           102<span class=\"token punctuation\">,</span>781 easy_install<span class=\"token operator\">-</span>3<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15           102<span class=\"token punctuation\">,</span>781 easy_install<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15           102<span class=\"token punctuation\">,</span>763 pip<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15           102<span class=\"token punctuation\">,</span>763 pip3<span class=\"token punctuation\">.</span>7<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:15           102<span class=\"token punctuation\">,</span>763 pip3<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14           522<span class=\"token punctuation\">,</span>768 python<span class=\"token punctuation\">.</span>exe\n2022<span class=\"token operator\">/</span>03<span class=\"token operator\">/</span>03  14:14           522<span class=\"token punctuation\">,</span>256 pythonw<span class=\"token punctuation\">.</span>exe\n              11 个文件      1<span class=\"token punctuation\">,</span>564<span class=\"token punctuation\">,</span>050 字节\n               2 个目录 10<span class=\"token punctuation\">,</span>210<span class=\"token punctuation\">,</span>152<span class=\"token punctuation\">,</span>448 可用字节\n</code></pre>\n<h2><a id=\"_127\"></a>激活虚拟环境</h2>\n<p>直接激活虚拟环境</p>\n<pre><code class=\"prism language-powershell\">source activate 虚拟环境名字\n</code></pre>\n<p>或者在<strong>Scripts</strong>目录下调用activate文件<strong>激活</strong>虚拟环境</p>\n<pre><code class=\"prism language-powershell\">C:\\Users\\sunh_\\venvdemo\\Scripts&gt;activate\n</code></pre>\n<p>可以看到前面有(venvdemo)的前缀，表明现在是在该虚拟环境下操作的</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token punctuation\">(</span>venvdemo<span class=\"token punctuation\">)</span> C:\\Users\\sunh_\\venvdemo\\Scripts&gt;\n</code></pre>\n<p>查看当前环境内的第三方库：已经没有全局环境里的库，是个纯净的第三方库</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token punctuation\">(</span>venvdemo<span class=\"token punctuation\">)</span> C:\\Users\\sunh_\\venvdemo\\Scripts&gt;pip list\nPackage    Version\n<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">-</span> <span class=\"token operator\">--</span>-<span class=\"token operator\">--</span>-<span class=\"token operator\">-</span>\npip        19<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>3\nsetuptools 40<span class=\"token punctuation\">.</span>8<span class=\"token punctuation\">.</span>0\nYou are <span class=\"token keyword\">using</span> pip version 19<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>3<span class=\"token punctuation\">,</span> however version 22<span class=\"token punctuation\">.</span>0<span class=\"token punctuation\">.</span>3 is available<span class=\"token punctuation\">.</span>\nYou should consider upgrading via the <span class=\"token string\">'python -m pip install --upgrade pip'</span> command<span class=\"token punctuation\">.</span>\n</code></pre>\n<h2><a id=\"_150\"></a>虚拟环境做了什么</h2>\n<p>其实<strong>激活</strong>虚拟环境就是在环境变量PATH中插入激活的虚拟环境的路径<br/> <img alt=\"在这里插入图片描述\" src=\"image\\17f8e7dd21db41edb015b2c9b2d626ee.png\"/><br/> <img alt=\"在这里插入图片描述\" src=\"image\\4490c87b32ed4660bc3a19ea098dc508.png\"/><br/> 虚拟环境的环境变量就排在了原生pathon的环境变量的前面。</p>\n<h2><a id=\"_156\"></a>关闭虚拟环境</h2>\n<pre><code class=\"prism language-powershell\"><span class=\"token punctuation\">(</span>venvdemo<span class=\"token punctuation\">)</span> C:\\Users\\sunh_\\venvdemo\\Scripts&gt;deactivate\n</code></pre>\n<p>也就是将环境变量PATH从去除掉，从而关闭虚拟环境。</p>\n<h1><a id=\"_163\"></a>三、虚拟环境重要性</h1>\n<p><strong>解释1</strong>：如果一个环境要做很多任务就要安装很多第三方包，第三方包与包之间有时候会出现版本不兼容，从而导致不可用；而且包一多就很难管理一个环境。如果我们将每个任务限定在虚拟环境中操作，只安装这个任务需要的包，那么会大大减少不兼容问题的发生记几率。</p>\n<p><strong>解释2</strong>：可以直接通过虚拟环境来配置别人项目的运行环境，从而可以运行别人的代码。</p>\n<h1><a id=\"PyCharm_167\"></a>四、PyCharm中的虚拟环境</h1>\n<p>由第二节可知，激活主要就是在环境变量中插队，使其用虚拟环境下的<strong>解释器 python.exe</strong>编译；<br/> 那么如果IDE直接知道我们的解释器路径，那么就不需要激活也可以使用虚拟环境。</p>\n<p><strong>重点就在于解释器 python.exe的位置</strong></p>\n<p>创建项目时，可以选择已经存在的解释器，也就是选择在哪个虚拟环境下运行。（相对的，你选择哪个虚拟环境的编译器你就只能用那个环境下的包，虚拟环境间的第三方库是不互通的）<br/> 如果没有想要的虚拟环境，那么直接在 … 处选择你需要的虚拟环境下的<code>xxx\\Scripts\\python.exe</code>路径即可。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ad411e97652b469faab85a8bcbd9f009.png\"/><br/> 也可以使用IDE进行新建虚拟环境：<br/> <img alt=\"在这里插入图片描述\" src=\"image\\93f94ecf13b94d678f35ab99cad97c4a.png\"/><br/> 从上而下分别是：</p>\n<ol><li>New environment using：选择创建创建虚拟环境的工具</li><li>Location：创建的虚拟环境的位置</li><li>Base interpreter：基于哪个版本的python解释器创建</li><li>Inherit global site-packages：是否继承base interpreter的第三方库（同命令行中的–site-packages-命令）</li><li>Make available to all projects：是否别的项目可以用这个虚拟环境编译</li></ol>\n<p><strong>IDE创建的虚拟环境的目录结构</strong>：和第二节分析的那个目录结构是一样的，其实就可以看作是IDE帮你使用命令行的模式来创建虚拟环境。<br/> <img alt=\"在这里插入图片描述\" src=\"image\\d604a8627dbe4409b8f4dc51646abb90.png\"/></p>\n<h1><a id=\"_190\"></a>五、保存和复制虚拟环境</h1>\n<pre><code class=\"prism language-powershell\"><span class=\"token punctuation\">(</span>venvdemo<span class=\"token punctuation\">)</span> C:\\Users\\sunh_\\venvdemo\\Scripts&gt;pip freeze &gt;requirements<span class=\"token punctuation\">.</span>txt\n</code></pre>\n<p>使用<code>pip freeze &gt;requirements.txt</code>命令将虚拟环境的库 冻结后存到<strong>requirements.txt</strong>文件里。</p>\n<pre><code class=\"prism language-powershell\"><span class=\"token punctuation\">(</span>venvdemo<span class=\"token punctuation\">)</span> C:\\Users\\sunh_\\venvdemo\\Scripts&gt;pip install <span class=\"token operator\">-</span>r requiremnets<span class=\"token punctuation\">.</span>txt\n</code></pre>\n<p>别人只需要通过<code>pip install -r requiremnets.txt</code>即可安装此项目运行需要的包。</p>\n<h1><a id=\"_202\"></a>六、总结</h1>\n<p>虚拟环境给项目提供了一个编译运行的环境（提供给项目它需要的包）；<br/> 用哪个环境下的解释器就只能用哪个环境下的包，所以解释器的选择是很重要的。</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}