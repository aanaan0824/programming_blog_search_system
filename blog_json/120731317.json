{"blogid": "120731317", "writerAge": "码龄4年", "writerBlogNum": "182", "writerCollect": "5061", "writerComment": "174", "writerFan": "3627", "writerGrade": "5级", "writerIntegral": "3331", "writerName": "lainwith", "writerProfileAdress": "writer_image\\profile_120731317.jpg", "writerRankTotal": "5160", "writerRankWeekly": "10666", "writerThumb": "742", "writerVisitNum": "327382", "blog_read_count": "90047", "blog_time": "于 2021-10-12 20:43:44 发布", "blog_title": "python实现——处理Excel表格（超详细）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>目录</h3>\n<ul><li><a href=\"#xlsxlsx_13\">xls和xlsx</a></li><li><a href=\"#_19\">基本操作</a></li><li><ul><li><a href=\"#1openpyxlExcelsheet_23\">1：用openpyxl模块打开Excel文档，查看所有sheet表</a></li><li><a href=\"#21sheet_39\">2.1：通过sheet名称获取表格</a></li><li><ul><li><a href=\"#22_58\">2.2：获取活动表</a></li></ul>\n</li><li><a href=\"#31_74\">3.1：获取表格的尺寸</a></li><li><a href=\"#41_94\">4.1：获取单元格中的数据</a></li><li><ul><li><a href=\"#42_141\">4.2：获取单元格的行、列、坐标</a></li></ul>\n</li><li><a href=\"#5_166\">5：获取区间内的数据</a></li><li><ul><li><a href=\"#_168\">获取指定区间的数据</a></li><li><a href=\"#_203\">获取指定行列的数据</a></li><li><a href=\"#_268\">按行、列获取值</a></li><li><a href=\"#_317\">获取活动表的行列数</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_377\">操作</a></li><li><ul><li><a href=\"#excel_378\">创建新的excel</a></li><li><a href=\"#excel_395\">修改单元格、excel另存为</a></li><li><a href=\"#_413\">添加数据</a></li><li><ul><li><a href=\"#_414\">插入有效数据</a></li><li><a href=\"#_438\">插入空行空列</a></li></ul>\n</li><li><a href=\"#_459\">删除行、列</a></li><li><a href=\"#move_range_480\">移动指定区间的单元格(move_range)</a></li><li><a href=\"#_498\">字母列号与数字列号之间的转换</a></li><li><a href=\"#_526\">字体样式</a></li><li><ul><li><a href=\"#_527\">查看字体样式</a></li><li><a href=\"#_553\">修改字体样式</a></li><li><a href=\"#_596\">设置对齐格式</a></li><li><a href=\"#_641\">设置行高列宽</a></li><li><a href=\"#_694\">合并、拆分单元格</a></li></ul>\n</li></ul>\n</li><li><a href=\"#sheet_733\">sheet表</a></li><li><ul><li><a href=\"#sheetcreate_sheet_734\">创建新的sheet(create_sheet)</a></li><li><a href=\"#sheettitle_758\">修改sheet名字(title)</a></li><li><a href=\"#sheetcopy_worksheet_776\">复制sheet表(copy_worksheet)</a></li><li><a href=\"#sheetremove_794\">删除sheet表(remove)</a></li></ul>\n</li><li><a href=\"#Excel_822\">操作多个Excel表</a></li><li><ul><li><a href=\"#_824\">背景知识</a></li><li><ul><li><a href=\"#numpypandas_825\">numpy与pandas</a></li><li><a href=\"#xlsxwriter_893\">xlsxwriter</a></li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<ul><li>一个Excel电子表格文档称为一个工作簿</li><li>一个工作簿保存在一个扩展名为.xlsx的文件中</li><li>一个工作簿可以包含多个表</li><li>用户当前查看的表（或关闭Excel前最后查看的表）称为<strong>活动表</strong></li><li>在特定行和列的方格称为<strong>单元格、格子</strong></li></ul>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\a00efcbcf99544119c324f3c41e774ed.png\"/></p>\n<p><strong>处理Excel表格需要用到openpyxl模块，该模块需要手动安装<code>pip install openpyxl</code></strong></p>\n<h1><a id=\"xlsxlsx_13\"></a>xls和xlsx</h1>\n<p>简单来说：<br/> xls是excel2003及以前版本所生成的文件格式<br/> xlsx是excel2007及以后版本所生成的文件格式<br/> （excel 2007之后版本可以打开上述两种格式，但是excel2013只能打开xls格式）<br/> 进一步的详细解释参见：<a href=\"https://jingyan.baidu.com/article/1974b289c9aaefb5b0f7746b.html\">excel后缀.xls和.xlsx有什么区别</a></p>\n<h1><a id=\"_19\"></a>基本操作</h1>\n<p>用到的test.xlsx表格<br/> 在这里插入图片描述</p>\n<h2><a id=\"1openpyxlExcelsheet_23\"></a>1：用openpyxl模块打开Excel文档，查看所有sheet表</h2>\n<p><code>openpyxl.load_workbook()</code>函数接受文件名，返回一个workbook数据类型的值。这个workbook对象代表这个Excel文件，这个有点类似File对象代表一个打开的文本文件。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\t<span class=\"token comment\"># 返回一个workbook数据类型的值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>\t<span class=\"token comment\"># 打印Excel表中的所有表</span>\n\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># ['Sheet1', 'Sheet2']</span>\n</code></pre>\n<h2><a id=\"21sheet_39\"></a>2.1：通过sheet名称获取表格</h2>\n<p>在第10行，使用<code>workbook['Sheet1']</code>获取指定sheet表</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印Excel表中的所有表</span>\n\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">[</span><span class=\"token string\">'Sheet1'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 获取指定sheet表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># ['Sheet1', 'Sheet2']</span>\n<span class=\"token comment\"># &lt;Worksheet \"Sheet1\"&gt;</span>\n</code></pre>\n<h3><a id=\"22_58\"></a>2.2：获取活动表</h3>\n<p>使用<code>workbook.active</code>获取活动表</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active     <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># &lt;Worksheet \"Sheet1\"&gt;</span>\n</code></pre>\n<h2><a id=\"31_74\"></a>3.1：获取表格的尺寸</h2>\n<p>这里所说的尺寸大小，指的是excel表格中的数据有几行几列，针对的是不同的sheet而言<br/> 使用<code>sheet.dimensions</code>获取表格的尺寸<br/> 下面打印的A1:B7是什么意思呢？<br/> <img alt=\"在这里插入图片描述\" src=\"image\\ea7ce825667e4a208cf7f627b5a473b7.png\"/></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">[</span><span class=\"token string\">'Sheet1'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 获取指定sheet表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">.</span>dimensions<span class=\"token punctuation\">)</span>     <span class=\"token comment\"># 获取表格的尺寸大小</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># A1:B7</span>\n</code></pre>\n<h2><a id=\"41_94\"></a>4.1：获取单元格中的数据</h2>\n<p><strong>方法1：指定坐标的方式</strong><br/> <strong>sheet[“A1”]</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active     <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token comment\"># print(sheet.dimensions)     # 获取表格的尺寸大小</span>\n\ncell1 <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># 获取A1单元格的数据</span>\ncell2 <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'B7'</span><span class=\"token punctuation\">]</span>         <span class=\"token comment\"># 获取B7单元格的数据</span>\n<span class=\"token comment\"># cell2 = sheet['B7'].value\t\t# 另一种写法</span>\n\n<span class=\"token comment\"># 正确示范</span>\n<span class=\"token comment\"># cell1.value获取单元格A1中的值</span>\n<span class=\"token comment\"># cell2.value获取单元格B7中的值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell1<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>cell2<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 姓名 18</span>\n\n<span class=\"token comment\"># 错误示范</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell1<span class=\"token punctuation\">,</span>cell2<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># &lt;Cell 'Sheet1'.A1&gt; &lt;Cell 'Sheet1'.B7&gt;</span>\n</code></pre>\n<p><strong>方法2： 指定行列的方式</strong><br/> <strong>sheet.cell(row=, column=)方式</strong></p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active     <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token comment\"># print(sheet.dimensions)     # 获取表格的尺寸大小</span>\n\ncell1 <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>column<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 获取第1行第1列的数据</span>\ncell2 <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>column<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># 获取第3行第4的数据</span>\n\n<span class=\"token comment\"># 正确示范</span>\n<span class=\"token comment\"># cell1.value获取单元格A1中的值</span>\n<span class=\"token comment\"># cell2.value获取单元格B7中的值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell1<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span>cell2<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 姓名 41</span>\n</code></pre>\n<h3><a id=\"42_141\"></a>4.2：获取单元格的行、列、坐标</h3>\n<ul><li><code>.row</code> 获取某个格子的行数；</li><li><code>.columns</code> 获取某个格子的列数；</li><li><code>.coordinate</code> 获取某个格子的坐标；</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token comment\"># print(sheet.dimensions)     # 获取表格的尺寸大小</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>cell<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> column<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取第3行第4的数据</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>row<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>column<span class=\"token punctuation\">,</span> cell<span class=\"token punctuation\">.</span>coordinate<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n结果：\n41 3 2 B3\n'''</span>\n</code></pre>\n<h2><a id=\"5_166\"></a>5：获取区间内的数据</h2>\n<p>获取单行单列数据的时候，使用一层for循环；获取多行多列、指定区间的数据时，使用两层for循环</p>\n<h3><a id=\"_168\"></a>获取指定区间的数据</h3>\n<ol><li>使用<code>sheet['A1:A5']</code>拿到指定区间</li><li>使用两个for循环拿到数据</li></ol>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1:A5'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 获取A1到A5的数据</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>cell<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 打印A1到A5的数据</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> i<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># 当前活动表是：</span>\n<span class=\"token comment\"># &lt;Worksheet \"Sheet1\"&gt;</span>\n<span class=\"token comment\"># ((&lt;Cell 'Sheet1'.A1&gt;,), (&lt;Cell 'Sheet1'.A2&gt;,), (&lt;Cell 'Sheet1'.A3&gt;,), (&lt;Cell 'Sheet1'.A4&gt;,), (&lt;Cell 'Sheet1'.A5&gt;,))</span>\n<span class=\"token comment\"># 姓名</span>\n<span class=\"token comment\"># 张三</span>\n<span class=\"token comment\"># 李四</span>\n<span class=\"token comment\"># 王五</span>\n<span class=\"token comment\"># 赵六</span>\n</code></pre>\n<h3><a id=\"_203\"></a>获取指定行列的数据</h3>\n<ul><li>sheet[“A”] — 获取A列的数据</li><li>sheet[“A:C”] — 获取A,B,C三列的数据</li><li>sheet[5] — 只获取第5行的数据</li></ul>\n<p>下面的代码，获取一列数据的时候，使用一层for循环</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'2'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 获取第2行的数据</span>\n\n<span class=\"token comment\"># 打印A1到A5的数据</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># 当前活动表是：&lt;Worksheet \"Sheet1\"&gt;</span>\n<span class=\"token comment\"># 张三</span>\n<span class=\"token comment\"># 74</span>\n</code></pre>\n<p>下面代码，获取两列数据的时候，使用两层for循环。注意到，两列的结果打印到一起了，可读性较差</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A:B'</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 获取AB列的数据</span>\n\n<span class=\"token comment\"># 打印AB列数据</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> i<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># 当前活动表是：&lt;Worksheet \"Sheet1\"&gt;</span>\n<span class=\"token comment\"># 姓名</span>\n<span class=\"token comment\"># 张三</span>\n<span class=\"token comment\"># 李四</span>\n<span class=\"token comment\"># 王五</span>\n<span class=\"token comment\"># 赵六</span>\n<span class=\"token comment\"># alice</span>\n<span class=\"token comment\"># bob</span>\n<span class=\"token comment\"># 年龄</span>\n<span class=\"token comment\"># 74</span>\n<span class=\"token comment\"># 41</span>\n<span class=\"token comment\"># 56</span>\n<span class=\"token comment\"># 12</span>\n<span class=\"token comment\"># 17</span>\n<span class=\"token comment\"># 18</span>\n</code></pre>\n<h3><a id=\"_268\"></a>按行、列获取值</h3>\n<p><code>iter_rows()</code>：按行读取<br/> <code>iter_cols()</code>：按列读取</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 按行获取值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'按行获取值'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> sheet<span class=\"token punctuation\">.</span>iter_rows<span class=\"token punctuation\">(</span>min_row<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> max_row<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> min_col<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> max_col<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> i<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 按列获取值</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'按列获取值'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> sheet<span class=\"token punctuation\">.</span>iter_cols<span class=\"token punctuation\">(</span>min_row<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> max_row<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> min_col<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> max_col<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> i<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>j<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 结果：</span>\n<span class=\"token comment\"># 当前活动表是：&lt;Worksheet \"Sheet1\"&gt;</span>\n<span class=\"token comment\"># 按行获取值</span>\n<span class=\"token comment\"># 张三</span>\n<span class=\"token comment\"># 74</span>\n<span class=\"token comment\"># 李四</span>\n<span class=\"token comment\"># 41</span>\n<span class=\"token comment\"># 王五</span>\n<span class=\"token comment\"># 56</span>\n<span class=\"token comment\"># 赵六</span>\n<span class=\"token comment\"># 12</span>\n<span class=\"token comment\"># 按列获取值</span>\n<span class=\"token comment\"># 张三</span>\n<span class=\"token comment\"># 李四</span>\n<span class=\"token comment\"># 王五</span>\n<span class=\"token comment\"># 赵六</span>\n<span class=\"token comment\"># 74</span>\n<span class=\"token comment\"># 41</span>\n<span class=\"token comment\"># 56</span>\n<span class=\"token comment\"># 12</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\e42ee03ec3ac4bcb9eb6a2dadffc43b8.png\"/></p>\n<h3><a id=\"_317\"></a>获取活动表的行列数</h3>\n<p>方法1：使用<br/> sheet.max_row 获取行数<br/> sheet.max_column 获取列数</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'2.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nrows <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>max_row        <span class=\"token comment\"># 获取行数</span>\ncolumn <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span>max_column   <span class=\"token comment\"># 获取列数</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rows<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n结果：\n当前活动表是：&lt;Worksheet \"Sheet1\"&gt;\n381\n6\n'''</span>\n</code></pre>\n<p>方法2：自己写一个for循环</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nrow <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\ncolumn <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># 获取当前活动表有多少行</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> sheet<span class=\"token punctuation\">.</span>rows<span class=\"token punctuation\">:</span>\n    row<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\"># i是元组类型，转为列表</span>\n\n<span class=\"token comment\"># 获取当前活动表有多少列</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> sheet<span class=\"token punctuation\">.</span>columns<span class=\"token punctuation\">:</span>\n    column<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># i是元组类型，转为列表</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'行数：'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'列数：'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n结果：\n当前活动表是：&lt;Worksheet \"1号sheet\"&gt;\n行数：12\n列数：3\n'''</span>\n</code></pre>\n<h1><a id=\"_377\"></a>操作</h1>\n<h2><a id=\"excel_378\"></a>创建新的excel</h2>\n<p>第9行代码用来指定创建的excel的活动表的名字：</p>\n<ul><li>不写第9行，默认创建sheet</li><li>写了第9行，创建指定名字的sheet表</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active\nsheet<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'1号sheet'</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'1.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"excel_395\"></a>修改单元格、excel另存为</h2>\n<p>第9行代码，通过给单元格重新赋值，来修改单元格的值<br/> 第9行代码的另一种写法<code>sheet['B1'].value = 'age'</code><br/> 第10行代码，保存时如果使用原来的（第7行）名字，就直接保存；如果使用了别的名字，就会另存为一个新文件</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\nsheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'name'</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\e412dd1468e4472a8badb6a1254da167.png\"/></p>\n<h2><a id=\"_413\"></a>添加数据</h2>\n<h3><a id=\"_414\"></a>插入有效数据</h3>\n<p>使用<code>append()</code>方法，在原来数据的后面，按行插入数据</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'素子'</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'巴特'</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token string\">'塔奇克马'</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">:</span>\n    sheet<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 使用append插入数据</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\70a93f74092d4f298c65bed6b9facaa4.png\"/></p>\n<h3><a id=\"_438\"></a>插入空行空列</h3>\n<ul><li>insert_rows(idx=数字编号, amount=要插入的行数)，插入的行数是在idx行数的下方插入</li><li>insert_cols(idx=数字编号, amount=要插入的列数)，插入的位置是在idx列数的左侧插入</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsheet<span class=\"token punctuation\">.</span>insert_rows<span class=\"token punctuation\">(</span>idx<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> amount<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nsheet<span class=\"token punctuation\">.</span>insert_cols<span class=\"token punctuation\">(</span>idx<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> amount<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\0a75ce5c6a1042e6bc41147a05f5d4d8.png\"/></p>\n<h2><a id=\"_459\"></a>删除行、列</h2>\n<ul><li>delete_rows(idx=数字编号, amount=要删除的行数)</li><li>delete_cols(idx=数字编号, amount=要删除的列数)</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsheet<span class=\"token punctuation\">.</span>delete_rows<span class=\"token punctuation\">(</span>idx<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\"># 删除第10行</span>\nsheet<span class=\"token punctuation\">.</span>delete_cols<span class=\"token punctuation\">(</span>idx<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> amount<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 删除第1列，及往右共2列</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\ce54ec6a253f435d8758750357af37de.png\"/></p>\n<h2><a id=\"move_range_480\"></a>移动指定区间的单元格(move_range)</h2>\n<p>move_range(“数据区域”,rows=,cols=)：正整数为向下或向右、负整数为向左或向上</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsheet<span class=\"token punctuation\">.</span>move_range<span class=\"token punctuation\">(</span><span class=\"token string\">'D11:F12'</span><span class=\"token punctuation\">,</span>rows<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>cols<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 移动D11到F12构成的矩形格子</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\1512bd7c3d424b2ebb1d513f80c1bfe7.png\"/></p>\n<h2><a id=\"_498\"></a>字母列号与数字列号之间的转换</h2>\n<p>核心代码</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> get_column_letter<span class=\"token punctuation\">,</span> column_index_from_string\n\n<span class=\"token comment\"># 根据列的数字返回字母</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>get_column_letter<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># B</span>\n<span class=\"token comment\"># 根据字母返回列的数字</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>column_index_from_string<span class=\"token punctuation\">(</span><span class=\"token string\">'D'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 4</span>\n</code></pre>\n<p>举个例子：</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">from</span> openpyxl<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> get_column_letter<span class=\"token punctuation\">,</span> column_index_from_string\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'2.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 根据列的数字返回字母</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>get_column_letter<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># B</span>\n<span class=\"token comment\"># 根据字母返回列的数字</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>column_index_from_string<span class=\"token punctuation\">(</span><span class=\"token string\">'D'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 4</span>\n</code></pre>\n<h2><a id=\"_526\"></a>字体样式</h2>\n<h3><a id=\"_527\"></a>查看字体样式</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span>\nfont <span class=\"token operator\">=</span> cell<span class=\"token punctuation\">.</span>font\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前单元格的字体样式是'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">.</span>bold<span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">.</span>italic<span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n当前活动表是：&lt;Worksheet \"1号sheet\"&gt;\n当前单元格的字体样式是\n等线 11.0 False False &lt;openpyxl.styles.colors.Color object&gt;\nParameters:\nrgb=None, indexed=None, auto=None, theme=1, tint=0.0, type='theme'\n'''</span>\n</code></pre>\n<h3><a id=\"_553\"></a>修改字体样式</h3>\n<p><strong>openpyxl.styles.Font(name=字体名称,size=字体大小,bold=是否加粗,italic=是否斜体,color=字体颜色)</strong><br/> 其中，字体颜色中的color是RGB的16进制表示</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span>\ncell<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Font<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"微软雅黑\"</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> bold<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> italic<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"FF0000\"</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\285c388fdf3242e3b9a24f21e566e3eb.png\"/></p>\n<p>再者，可以使用for循环，修改多行多列的数据，在<a href=\"#g3KhE\">这里</a>介绍了获取的方法</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    i<span class=\"token punctuation\">.</span>font <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Font<span class=\"token punctuation\">(</span>name<span class=\"token operator\">=</span><span class=\"token string\">\"微软雅黑\"</span><span class=\"token punctuation\">,</span> size<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> bold<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> italic<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"FF0000\"</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\3cdfcb847ce14524a802475c7c6fbb78.png\"/></p>\n<h3><a id=\"_596\"></a>设置对齐格式</h3>\n<p>Alignment(horizontal=水平对齐模式,vertical=垂直对齐模式,text_rotation=旋转角度,wrap_text=是否自动换行)<br/> 水平对齐：‘distributed’，‘justify’，‘center’，‘left’， ‘centerContinuous’，'right，‘general’<br/> 垂直对齐：‘bottom’，‘distributed’，‘justify’，‘center’，‘top’</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">]</span>\nalignment <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Alignment<span class=\"token punctuation\">(</span>horizontal<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> vertical<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> text_rotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> wrap_text<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> alignment\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\ef98e8f62a1546728bb80264fa4bcb9b.png\"/></p>\n<p>当然，你仍旧可以调用for循环来实现对多行多列的操作</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">]</span>\nalignment <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Alignment<span class=\"token punctuation\">(</span>horizontal<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> vertical<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> text_rotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> wrap_text<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> cell<span class=\"token punctuation\">:</span>\n    i<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> alignment\n    \nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\9c09ccff12404fc987adc6cd4e701ec6.png\"/></p>\n<h3><a id=\"_641\"></a>设置行高列宽</h3>\n<p><strong>设置行列的宽高：</strong></p>\n<ul><li>row_dimensions[行编号].height = 行高</li><li>column_dimensions[列编号].width = 列宽</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 设置第1行的高度</span>\nsheet<span class=\"token punctuation\">.</span>row_dimensions<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> <span class=\"token number\">50</span>\n<span class=\"token comment\"># 设置B列的卷度</span>\nsheet<span class=\"token punctuation\">.</span>column_dimensions<span class=\"token punctuation\">[</span><span class=\"token string\">'B'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\da125868d93e44e48279c897a691c184.png\"/></p>\n<p><strong>设置所有单元格</strong><br/> （显示的结果是设置所有，有数据的单元格的）</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> openpyxl <span class=\"token keyword\">import</span> load_workbook\n<span class=\"token keyword\">from</span> openpyxl<span class=\"token punctuation\">.</span>utils <span class=\"token keyword\">import</span> get_column_letter\n<span class=\"token keyword\">import</span> os\n\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span><span class=\"token string\">r'C:\\Users\\asuka\\Desktop'</span><span class=\"token punctuation\">)</span>\n\nworkbook <span class=\"token operator\">=</span> load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'1.xlsx'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印所有的sheet表</span>\nws <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">[</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\"># 选中最左侧的sheet表</span>\n\nwidth <span class=\"token operator\">=</span> <span class=\"token number\">2.0</span>  <span class=\"token comment\"># 设置宽度</span>\nheight <span class=\"token operator\">=</span> width <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2.2862</span> <span class=\"token operator\">/</span> <span class=\"token number\">0.3612</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 设置高度</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"row:\"</span><span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">.</span>max_row<span class=\"token punctuation\">,</span> <span class=\"token string\">\"column:\"</span><span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">.</span>max_column<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 打印行数，列数</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">.</span>max_row <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    ws<span class=\"token punctuation\">.</span>row_dimensions<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>height <span class=\"token operator\">=</span> height\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> ws<span class=\"token punctuation\">.</span>max_column <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    ws<span class=\"token punctuation\">.</span>column_dimensions<span class=\"token punctuation\">[</span>get_column_letter<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>width <span class=\"token operator\">=</span> width\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\78217db1ebdf4873bea9fb6dead6cce2.png\"/></p>\n<h3><a id=\"_694\"></a>合并、拆分单元格</h3>\n<p>合并单元格有下面两种方法，需要注意的是，如果要合并的格子中有数据，即便python没有报错，Excel打开的时候也会报错。</p>\n<ul><li>merge_cells(待合并的格子编号)</li><li>merge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，end_column=结束列号)</li></ul>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n<span class=\"token keyword\">import</span> openpyxl<span class=\"token punctuation\">.</span>styles\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 方法1：</span>\nsheet<span class=\"token punctuation\">.</span>merge_cells<span class=\"token punctuation\">(</span><span class=\"token string\">'A12:B13'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 方法2：</span>\nsheet<span class=\"token punctuation\">.</span>merge_cells<span class=\"token punctuation\">(</span>start_row<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> start_column<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> end_row<span class=\"token operator\">=</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span> end_column<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 加一个居中对齐</span>\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'A12'</span><span class=\"token punctuation\">]</span>\nalignment <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Alignment<span class=\"token punctuation\">(</span>horizontal<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> vertical<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> text_rotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> wrap_text<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> alignment\n\ncell <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">[</span><span class=\"token string\">'C12'</span><span class=\"token punctuation\">]</span>\nalignment <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>styles<span class=\"token punctuation\">.</span>Alignment<span class=\"token punctuation\">(</span>horizontal<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> vertical<span class=\"token operator\">=</span><span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span> text_rotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> wrap_text<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\ncell<span class=\"token punctuation\">.</span>alignment <span class=\"token operator\">=</span> alignment\n\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\e2595be778d64baeac349ceb10c7ab3e.png\"/></p>\n<p><strong>拆分单元格的方法同上</strong></p>\n<ul><li>unmerge_cells(待合并的格子编号)</li><li>unmerge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，end_column=结束列号)</li></ul>\n<h1><a id=\"sheet_733\"></a>sheet表</h1>\n<h2><a id=\"sheetcreate_sheet_734\"></a>创建新的sheet(create_sheet)</h2>\n<p>create_sheet(“新的sheet名”)：创建一个新的sheet表</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>create_sheet<span class=\"token punctuation\">(</span><span class=\"token string\">'3号sheet'</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># 创建新的sheet表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>\t\t\t <span class=\"token comment\"># 查看所有的sheet表</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n当前活动表是：&lt;Worksheet \"Sheet1\"&gt;\n['Sheet1', 'Sheet2', '3号sheet']\n'''</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\1b3336ccae6245f688de7ec53d85973d.png\"/></p>\n<h2><a id=\"sheettitle_758\"></a>修改sheet名字(title)</h2>\n<p>第11行，使用<code>title</code>修改sheet表的名字</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nsheet<span class=\"token punctuation\">.</span>title <span class=\"token operator\">=</span> <span class=\"token string\">'1号sheet'</span>  <span class=\"token comment\"># 修改sheet表</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\41b603eb61654b5d86ac9c87b8c55e1a.png\"/></p>\n<h2><a id=\"sheetcopy_worksheet_776\"></a>复制sheet表(copy_worksheet)</h2>\n<p>在“操作”&gt;“修改单元格、excel另存为”中提到了另存为，其实复制sheet表就是一个另存为的过程，你要是在12行代码保存的时候使用第7行的文件名，那么复制的sheet表就保存到自己身上，内容跟copy.xlsx一样。</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>copy_worksheet<span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>\t<span class=\"token comment\"># 复制sheet表</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'copy.xlsx'</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\d2af9e77569348c9adefadc062f657a9.png\"/></p>\n<h2><a id=\"sheetremove_794\"></a>删除sheet表(remove)</h2>\n<p>remove(“sheet名”)：删除某个sheet表<br/> 要删除某sheet表，需要激活这个sheet表，即：将其作为活动表（关于活动表的定义请看前面文章开头写的有）下面8~11行代码展示了原始活动表与手动更换活动表，第13行代码删掉活动表</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> openpyxl\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 修改工作路径</span>\n\nworkbook <span class=\"token operator\">=</span> openpyxl<span class=\"token punctuation\">.</span>load_workbook<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 返回一个workbook数据类型的值</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>active  <span class=\"token comment\"># 获取活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nsheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">[</span><span class=\"token string\">'3号sheet'</span><span class=\"token punctuation\">]</span>     <span class=\"token comment\"># 手动切换到要删除的sheet表，一旦切换，这张表就是活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'当前活动表是：'</span> <span class=\"token operator\">+</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 删除当前活动表</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>workbook<span class=\"token punctuation\">.</span>sheetnames<span class=\"token punctuation\">)</span>\nworkbook<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">'test.xlsx'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n当前活动表是：&lt;Worksheet \"Sheet1\"&gt;\n当前活动表是：&lt;Worksheet \"3号sheet\"&gt;\n['Sheet1', 'Sheet2']\n'''</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\b202cf0a44f8444881c6ab2c5bba67c8.png\"/></p>\n<h1><a id=\"Excel_822\"></a>操作多个Excel表</h1>\n<p>其实想用openpyxl玩这个，但是网上用的是别的库，就有点无语，以后熟练的话在自己写一个函数实现吧</p>\n<h2><a id=\"_824\"></a>背景知识</h2>\n<h3><a id=\"numpypandas_825\"></a>numpy与pandas</h3>\n<p>NumPy是 Python 语言的一个扩展程序库，支持大量的维度数组与矩阵运算，此外也针对数组运算提供大量的数学函数库；pandas 是基于NumPy 的一种工具，该工具是为解决数据分析任务而创建的，我们需要利用Pandas进行Excel的合并</p>\n<ol><li>下面的代码生成了一个5行3列的包含15个字符的嵌套列表</li></ol>\n<p>（注意，第4行代码：15是等于3<em>5的，如果是15对应4</em>3，或者16对应5*3都会报错）<br/> （注意，第5行代码，虽然5行3列是15个数据，但是可以指定数据从1开头，到16结束）</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nxx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nyy <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>xx<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>yy<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n[[ 0  1  2]\n [ 3  4  5]\n [ 6  7  8]\n [ 9 10 11]\n [12 13 14]]\n[[ 1  2  3]\n [ 4  5  6]\n [ 7  8  9]\n [10 11 12]\n [13 14 15]]\n'''</span>\n</code></pre>\n<ol start=\"2\"><li>添加表头</li></ol>\n<p>使用pandas库的DataFrame来添加表头。关于打印的结果，把最左侧的一列去掉之后会发现结果很和谐，这是因为最左侧的一列代表行号。此时xx变量的类型是&lt;class ‘pandas.core.frame.DataFrame’&gt;</p>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\nxx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nyy <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>reshape<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nxx <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>xx<span class=\"token punctuation\">,</span> columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"数学\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"外语\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nyy <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>yy<span class=\"token punctuation\">,</span> columns<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"语文\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"数学\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"外语\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>xx<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>yy<span class=\"token punctuation\">)</span>\n\n<span class=\"token triple-quoted-string string\">'''\n结果：\n   语文  数学  外语\n0   0   1   2\n1   3   4   5\n2   6   7   8\n3   9  10  11\n4  12  13  14\n   语文  数学  外语\n0   1   2   3\n1   4   5   6\n2   7   8   9\n3  10  11  12\n4  13  14  15\n'''</span>\n</code></pre>\n<ol start=\"3\"><li>合并两个矩阵</li></ol>\n<p><code>pd.concat(list)</code>括号中传入的是一个列表；<br/> <code>ignore_list=True</code>表示忽略原有索引，重新生成一组新的索引；<br/> 或者直接可以写成z = pd.concat([xx,yy],ignore_list=True)；<br/> 不知道为什么失败，暂时搁浅</p>\n<h3><a id=\"xlsxwriter_893\"></a>xlsxwriter</h3>\n<p>xlsxwriter模块一般是和xlrd模块搭配使用的，<br/> xlsxwriter：负责写入数据，<br/> xlrd：负责读取数据。</p>\n<ol><li><strong>创建一个工作簿</strong></li></ol>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlsxwriter\n<span class=\"token keyword\">import</span> os\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 这一步相当于创建了一个新的\"工作簿\"；</span>\n<span class=\"token comment\"># \"demo.xlsx\"文件不存在，表示新建\"工作簿\"；</span>\n<span class=\"token comment\"># \"demo.xlsx\"文件存在，表示新建\"工作簿\"覆盖原有的\"工作簿\"；</span>\nworkbook <span class=\"token operator\">=</span> xlsxwriter<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token string\">\"demo.xlsx\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># close是将\"工作簿\"保存关闭，这一步必须有，否则创建的文件无法显示出来。</span>\nworkbook<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<ol start=\"2\"><li><strong>创建sheet表</strong></li></ol>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlsxwriter\n<span class=\"token keyword\">import</span> os\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n\nworkbook <span class=\"token operator\">=</span> xlsxwriter<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token string\">\"cc.xlsx\"</span><span class=\"token punctuation\">)</span>   <span class=\"token comment\"># 创建一个名为cc.xlsx的文件</span>\nworksheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>add_worksheet<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018年销售量\"</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 创建一个名为“2018年销售量”的sheet表</span>\n\nworkbook<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<ol start=\"3\"><li><strong>写入数据</strong></li></ol>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> xlsxwriter\n<span class=\"token keyword\">import</span> os\n\npath <span class=\"token operator\">=</span> <span class=\"token string\">r\"C:\\Users\\asuka\\Desktop\"</span>\nos<span class=\"token punctuation\">.</span>chdir<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 创建一个名为【demo.xlsx】工作簿；</span>\nworkbook <span class=\"token operator\">=</span> xlsxwriter<span class=\"token punctuation\">.</span>Workbook<span class=\"token punctuation\">(</span><span class=\"token string\">\"demo.xlsx\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 创建一个名为【2018年销售量】工作表；</span>\nworksheet <span class=\"token operator\">=</span> workbook<span class=\"token punctuation\">.</span>add_worksheet<span class=\"token punctuation\">(</span><span class=\"token string\">\"2018年销售量\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 使用write_row方法，为【2018年销售量】工作表，添加一个表头；</span>\nheadings <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'产品'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'销量'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"单价\"</span><span class=\"token punctuation\">]</span>\nworksheet<span class=\"token punctuation\">.</span>write_row<span class=\"token punctuation\">(</span><span class=\"token string\">'A1'</span><span class=\"token punctuation\">,</span> headings<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 使用write方法，在【2018年销售量】工作表中插入一条数据；</span>\n<span class=\"token comment\"># write语法格式：worksheet.write(行,列,数据)</span>\n\ndata <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"苹果\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8.9</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>headings<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    worksheet<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nworkbook<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<p><img alt=\"在这里插入图片描述\" src=\"image\\f7714de08ffc483b8b1543271a0d5e6d.png\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}