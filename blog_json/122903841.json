{"blogid": "122903841", "writerAge": "码龄2年", "writerBlogNum": "14", "writerCollect": "767", "writerComment": "31", "writerFan": "1218", "writerGrade": "2级", "writerIntegral": "275", "writerName": "yjprolus", "writerProfileAdress": "writer_image\\profile_122903841.jpg", "writerRankTotal": "67851", "writerRankWeekly": "81988", "writerThumb": "109", "writerVisitNum": "56167", "blog_read_count": "4964", "blog_time": "已于 2022-02-14 08:29:56 修改", "blog_title": "最全CTF Web题思路总结（更新ing）", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<blockquote>\n<p>网上似乎没有一篇比较完整的CTF Web题思路的总结，希望这篇“最全总结”对各位师傅有帮助。</p>\n</blockquote>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><a href=\"#_4\">基础</a></li><li><ul><li><a href=\"#Flag_6\">Flag可能出现的位置</a></li><li><a href=\"#_8\">网页源代码（注意注释）</a></li><li><a href=\"#_10\">数据库中</a></li><li><a href=\"#phpinfo_12\">phpinfo</a></li><li><a href=\"#_14\">靶机中的文件</a></li><li><a href=\"#_16\">环境变量</a></li><li><a href=\"#_18\">题目要求</a></li><li><a href=\"#XFFReferUACookieF12viewsourceURLrobotstxt_20\">XFF/Refer/UA/Cookie/F12(view-source)/URL/robots.txt/响应码/</a></li><li><a href=\"#_22\">指纹识别</a></li><li><a href=\"#_24\">工具</a></li><li><ul><li><a href=\"#ArjunHTTP_26\">Arjun：HTTP参数挖掘套件</a></li><li><a href=\"#TideFingerBscanGlass_28\">TideFinger/Bscan/Glass</a></li></ul>\n</li><li><a href=\"#Wappalyzer_30\">Wappalyzer插件</a></li><li><a href=\"#404302_32\">错误界面(404/302)</a></li><li><a href=\"#dirsearch_34\">源码泄露(dirsearch)</a></li><li><a href=\"#Git_36\">Git</a></li><li><ul><li><a href=\"#Githack_38\">Githack恢复</a></li><li><a href=\"#loggit_reset_40\">查看log后选择性地进行git reset回滚</a></li><li><a href=\"#gitconfigaccess_token_42\">.git/config可能有access_token信息</a></li></ul>\n</li><li><a href=\"#SVN_44\">SVN</a></li><li><ul><li><a href=\"#Seaysvn_46\">Seay-svn</a></li><li><a href=\"#dvcsripper_48\">dvcs-ripper工具</a></li><li><a href=\"#wcdb_50\">注意wc.db文件存在与否</a></li></ul>\n</li><li><a href=\"#WEBINFwebxml_52\">WEB-INF/web.xml泄露</a></li><li><a href=\"#DS_Store_54\">.DS_Store文件泄漏</a></li><li><a href=\"#hg_56\">.hg泄露</a></li><li><ul><li><a href=\"#dvcsripper_58\">dvcs-ripper工具</a></li></ul>\n</li><li><a href=\"#CVS_60\">CVS泄露</a></li><li><a href=\"#_62\">备份文件泄露</a></li><li><ul><li><a href=\"#geditfilename__64\">gedit：filename \\~</a></li><li><a href=\"#vimvim_r_filenameswpswoswn_66\">vim：vim -r filename.swp/.swo/.swn</a></li><li><a href=\"#wwwziprartargz_68\">www.zip/rar/tar.gz</a></li></ul>\n</li><li><a href=\"#PHP_70\">PHP专题</a></li><li><a href=\"#MD5SHA10e_72\">MD5/SHA1数组绕过、0e</a></li><li><a href=\"#is_numeric33a_74\">is_numeric()绕过：33a</a></li><li><a href=\"#_76\">比较大小：数组大于任何其他类型</a></li><li><a href=\"#intval_1a100a10_78\">intval() 1a/1%00/a1=0</a></li><li><a href=\"#e_80\">正则式：/e可执行，构造越界</a></li></ul>\n</li><li><a href=\"#_82\">命令执行</a></li><li><ul><li><a href=\"#__84\">运用分隔符&amp;或\\| 若无严格过滤可出现任意漏洞执行漏洞</a></li><li><a href=\"#shell_86\">反弹shell的方式</a></li><li><a href=\"#0A_88\">%0A参数污染</a></li><li><a href=\"#RCE_90\">无参RCE</a></li><li><a href=\"#preg_matchRCE_92\">绕过preg_match的RCE</a></li><li><a href=\"#bypass_96\">过滤与bypass</a></li><li><a href=\"#linuxIFS_98\">linux中{IFS}可以代替空格</a></li><li><a href=\"#_100\">内联执行</a></li><li><a href=\"#_102\">长度限制与解决方案</a></li><li><a href=\"#_104\">利用文件名</a></li><li><a href=\"#MySQL_106\">MySQL服务端恶意读取客户端文件漏洞</a></li><li><a href=\"#Redis_4x_CVE_108\">Redis 4.x CVE</a></li><li><a href=\"#shell_110\">主从复制写shell</a></li><li><a href=\"#RedisSSRF_114\">Redis结合SSRF</a></li></ul>\n</li><li><a href=\"#_118\">容器和框架漏洞</a></li><li><ul><li><a href=\"#Nginx_120\">Nginx配置漏洞</a></li><li><a href=\"#Windows_122\">Windows相关</a></li><li><a href=\"#IIS_PUT_124\">IIS PUT上传漏洞</a></li><li><a href=\"#IIS__126\">IIS 远程溢出漏洞</a></li><li><a href=\"#IIS_128\">IIS短文件漏洞</a></li><li><a href=\"#_130\">文件上传的绕过</a></li><li><a href=\"#Apache_HTTP_132\">Apache HTTP组件提权漏洞</a></li><li><a href=\"#CGI__136\">CGI 漏洞</a></li><li><a href=\"#ThinkPHP_138\">ThinkPHP</a></li><li><a href=\"#Twig_140\">Twig</a></li><li><a href=\"#Laravel_142\">Laravel</a></li><li><a href=\"#Smarty_144\">Smarty</a></li><li><a href=\"#ASP_146\">ASP</a></li><li><a href=\"#ASPNET_VIEWSTATE_148\">ASP.NET VIEWSTATE反序列化</a></li><li><a href=\"#webconfig_150\">web.config利用</a></li><li><a href=\"#JAVA_WEB_152\">JAVA WEB</a></li><li><a href=\"#Struts2_154\">Struts2框架漏洞</a></li><li><ul><li><a href=\"#OGNL_156\">OGNL注入</a></li></ul>\n</li><li><a href=\"#Spring_158\">Spring框架漏洞</a></li><li><ul><li><a href=\"#SPEL_160\">SPEL注入</a></li><li><a href=\"#_162\">组件漏洞</a></li><li><a href=\"#FastJson_164\">FastJson等</a></li></ul>\n</li><li><a href=\"#_166\">反序列化漏洞</a></li><li><ul><li><a href=\"#Hessian_168\">Hessian</a></li><li><a href=\"#ObjectOutputStream_170\">二进制（ObjectOutputStream）</a></li><li><a href=\"#JSON_172\">JSON</a></li><li><a href=\"#XML_174\">XML</a></li><li><a href=\"#YAML_176\">YAML</a></li></ul>\n</li><li><a href=\"#JRMP_178\">JRMP安全性问题</a></li><li><a href=\"#JWT_180\">JWT攻击</a></li><li><a href=\"#_182\">敏感信息泄露</a></li><li><a href=\"#none_184\">将算法修改为none</a></li><li><a href=\"#_186\">密钥混淆攻击</a></li><li><a href=\"#_188\">无效签名</a></li><li><a href=\"#_190\">暴力破解密钥</a></li><li><a href=\"#_192\">密钥泄露</a></li><li><a href=\"#KID_194\">操纵KID</a></li><li><a href=\"#_196\">操纵头部参数</a></li><li><a href=\"#JavaScript_198\">JavaScript框架</a></li><li><a href=\"#SSJIJavaScript_200\">SSJI（服务端JavaScript注入）</a></li><li><ul><li><a href=\"#Nodejs_202\">Node.js</a></li><li><a href=\"#Vuejs_204\">Vue.js</a></li></ul>\n</li><li><a href=\"#JavaScript_Prototype__206\">JavaScript Prototype 污染攻击</a></li><li><a href=\"#Python_208\">Python</a></li><li><a href=\"#_210\">沙箱逃逸</a></li><li><ul><li><a href=\"#_212\">利用内建函数执行命令</a></li><li><a href=\"#bypass_214\">过滤与bypass</a></li></ul>\n</li><li><a href=\"#_216\">各种框架的漏洞</a></li><li><ul><li><a href=\"#Flask_218\">Flask</a></li><li><a href=\"#SESSION_220\">SESSION安全问题</a></li><li><ul><li><a href=\"#_224\">敏感信息泄露</a></li><li><a href=\"#_226\">验证码绕过</a></li><li><a href=\"#SESSION_228\">SESSION伪造和对象注入漏洞</a></li><li><a href=\"#hashhmac_230\">使用hash而非hmac进行签名</a></li><li><a href=\"#Hash_232\">Hash长度拓展攻击</a></li><li><a href=\"#_234\">任意文件读取</a></li><li><a href=\"#_236\">加密而未签名</a></li><li><a href=\"#CBC_238\">CBC字节翻转攻击</a></li></ul>\n</li><li><a href=\"#Tornado_240\">Tornado</a></li><li><a href=\"#Django_242\">Django</a></li></ul>\n</li><li><a href=\"#_244\">反序列化漏洞</a></li><li><ul><li><a href=\"#pickle_246\">pickle模块</a></li></ul>\n</li><li><a href=\"#Ruby_248\">Ruby</a></li><li><a href=\"#ERB_250\">ERB模板注入</a></li></ul>\n</li><li><a href=\"#SQL_252\">SQL注入及数据库</a></li><li><ul><li><a href=\"#_254\">手工注入</a></li><li><a href=\"#_256\">原理</a></li><li><ul><li><a href=\"#web_258\">用户输入的内容传到web应用，没有经过过滤或者严格的过滤，被带入到了数据库中进行执行</a></li></ul>\n</li><li><a href=\"#_260\">漏洞产生的关键条件</a></li><li><ul><li><a href=\"#__262\">用户能够控制 自己的输入</a></li><li><a href=\"#_264\">直接控制输入</a></li><li><a href=\"#_266\">间接控制输入</a></li><li><ul><li><a href=\"#_268\">二次注入</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_270\">按照数据库分类</a></li><li><ul><li><a href=\"#mysql_272\">mysql数据库</a></li><li><a href=\"#_274\">六种基本的注入模式</a></li><li><ul><li><a href=\"#_276\">联合注入</a></li><li><a href=\"#_278\">几大基本步骤</a></li><li><ul><li><a href=\"#_280\">判断是否有注入以及注入点的类型</a></li><li><a href=\"#_282\">是否有注入</a></li><li><ul><li><a href=\"#_284\">加单引号</a></li><li><a href=\"#and_87318731_286\">and 8731=8731</a></li><li><a href=\"#and_aa_288\">and 'a'='a'</a></li><li><a href=\"#and_12_290\">and 1=2</a></li><li><a href=\"#or_11_292\">or 1=1</a></li><li><a href=\"#or_12_294\">or 1=2</a></li></ul>\n</li><li><a href=\"#_296\">注入点类型</a></li><li><ul><li><a href=\"#_298\">字符型</a></li><li><a href=\"#_300\">'</a></li><li><a href=\"#_302\">\"</a></li><li><a href=\"#_304\">'）</a></li><li><a href=\"#_306\">\"）</a></li><li><a href=\"#_308\">%'</a></li><li><a href=\"#_310\">数字型</a></li></ul>\n</li><li><a href=\"#_312\">判断查询列数</a></li><li><a href=\"#_314\">为什么</a></li><li><ul><li><a href=\"#union_select_316\">union 前后两个select语句的列数要一致</a></li></ul>\n</li><li><a href=\"#_318\">原理</a></li><li><ul><li><a href=\"#order_by_320\">order by是排序的语句</a></li><li><a href=\"#select__from_users_order_by_id_322\">select \\* from users order by id</a></li><li><a href=\"#select__from_users_order_by_id_desc_324\">select \\* from users order by id desc</a></li><li><a href=\"#select__from_users_order_by_1_326\">select \\* from users order by 1</a></li></ul>\n</li><li><a href=\"#order_by_n_328\">order by n</a></li><li><a href=\"#_330\">联合查询</a></li><li><a href=\"#union_332\">union</a></li><li><ul><li><a href=\"#id1_union_select_123_334\">id=1' union select 1,2,3--+</a></li><li><a href=\"#id1_union_select_123_336\">id=-1' union select 1,2,3--+</a></li></ul>\n</li><li><a href=\"#_338\">获取基本信息</a></li><li><a href=\"#version_340\">version()</a></li><li><ul><li><a href=\"#_342\">获取数据库的版本</a></li></ul>\n</li><li><a href=\"#database_344\">database()</a></li><li><ul><li><a href=\"#_346\">获取当前网站使用的数据库</a></li></ul>\n</li><li><a href=\"#user_348\">user()</a></li><li><ul><li><a href=\"#_350\">当前网站使用的数据库账号</a></li></ul>\n</li><li><a href=\"#secure_file_priv_352\">@@secure_file_priv</a></li><li><ul><li><a href=\"#_354\">数据库的读写文件</a></li></ul>\n</li><li><a href=\"#datadir_356\">@@datadir</a></li><li><ul><li><a href=\"#_358\">数据库的安装目录</a></li><li><a href=\"#phpstudy_360\">phpstudy</a></li><li><a href=\"#wamp_366\">wamp</a></li></ul>\n</li><li><a href=\"#_372\">......（自行补充）</a></li><li><a href=\"#_374\">获取数据库名</a></li><li><a href=\"#information_schema_376\">information_schema数据库</a></li><li><ul><li><a href=\"#schemata_378\">schemata数据表</a></li><li><a href=\"#tables_380\">tables数据表</a></li><li><a href=\"#columns_382\">columns数据表</a></li></ul>\n</li><li><a href=\"#schemata_384\">schemata数据表里面获取数据库名</a></li><li><ul><li><a href=\"#select_schema_name_from_schemata_386\">select schema_name from schemata;</a></li><li><a href=\"#id1_union_select_12group_concatschema_name_from_information_schemaschemata_388\">id=1' union select 1,2,group_concat(schema_name) from information_schema.schemata</a></li></ul>\n</li><li><a href=\"#_390\">获取数据表名</a></li><li><a href=\"#tables_392\">tables表</a></li><li><ul><li><a href=\"#select_table_name_from_tables_where_table_schemasecurity_394\">select table_name from tables where table_schema='security';</a></li><li><a href=\"#select_table_name_from_tables_where_table_schemadatabase_396\">select table_name from tables where table_schema=database();</a></li><li><a href=\"#id1_union_select_12group_concattable_name_from_information_schematables_where_table_schemadatabase_398\">id=1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()</a></li></ul>\n</li><li><a href=\"#_400\">获取列名</a></li><li><a href=\"#columns_402\">columns表</a></li><li><ul><li><a href=\"#select_column_name_from_columns_where_table_schemasecurity_and_table_nameusers_404\">select column_name from columns where table_schema='security' and table_name='users';</a></li></ul>\n</li><li><a href=\"#_406\">优化步骤</a></li><li><a href=\"#select_table_namecolumn_name_from_columns_where_table_schemasecurity_408\">select table_name,column_name from columns where table_schema='security';</a></li><li><a href=\"#id1_union_select_12group_concattable_name_column_name_from_information_schemacolumns_where_table_schemadatabase_410\">id=1' union select 1,2,group_concat(table_name,'\\_',column_name) from information_schema.columns where table_schema=database()</a></li><li><a href=\"#_412\">获取数据</a></li><li><a href=\"#md5_414\">md5破解</a></li><li><a href=\"#md5_416\">md5破解的做法</a></li><li><ul><li><a href=\"#_418\">暴力枚举</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_420\">报错注入</a></li><li><a href=\"#_422\">几个函数</a></li><li><ul><li><a href=\"#updatexml_424\">updatexml</a></li><li><a href=\"#extractvalue_426\">extractvalue</a></li><li><a href=\"#_428\">报错的原理</a></li><li><ul><li><a href=\"#xpath_430\">构造不满足xpath语法的内容</a></li></ul>\n</li><li><a href=\"#_432\">报错的语句</a></li><li><ul><li><a href=\"#id1_and_extractvalue1concat0x7eselect_user0x7e_434\">id=1' and extractvalue(1,concat(0x7e,(select user()),0x7e))</a></li></ul>\n</li><li><a href=\"#_436\">注意</a></li><li><ul><li><a href=\"#_438\">版本限制</a></li><li><a href=\"#32_440\">32位长度限制</a></li><li><a href=\"#substr_442\">substr</a></li></ul>\n</li><li><a href=\"#_444\">其他函数</a></li></ul>\n</li><li><a href=\"#_446\">布尔盲注</a></li><li><a href=\"#_448\">原理</a></li><li><ul><li><a href=\"#_450\">布尔运算</a></li><li><a href=\"#and_452\">and</a></li><li><a href=\"#or_454\">or</a></li></ul>\n</li><li><a href=\"#_456\">步骤</a></li><li><ul><li><a href=\"#_458\">获取数据库名</a></li><li><a href=\"#_460\">判断有多少个数据库</a></li><li><ul><li><a href=\"#count_462\">count()</a></li></ul>\n</li><li><a href=\"#_464\">判断第一个数据库名的长度</a></li><li><ul><li><a href=\"#length_466\">length()</a></li></ul>\n</li><li><a href=\"#_468\">获取第一个每一位数据库名字的字符</a></li><li><ul><li><a href=\"#substr_470\">substr()</a></li><li><a href=\"#ascii_472\">ascii()</a></li></ul>\n</li><li><a href=\"#_474\">判断第二个数据库名的长度</a></li><li><a href=\"#_476\">获取第二个数据库每一位数据库名字的字符</a></li><li><a href=\"#_478\">获取数据表名</a></li><li><a href=\"#_480\">判断数据库里面有多少个数据表</a></li><li><a href=\"#_482\">判断第一个数据库的长度</a></li><li><a href=\"#_484\">获取第一个数据表的每一位字符</a></li><li><a href=\"#_486\">获取列名</a></li><li><a href=\"#_488\">获取数据</a></li></ul>\n</li><li><a href=\"#_490\">时间盲注</a></li><li><a href=\"#_492\">原理</a></li><li><ul><li><a href=\"#_494\">发送一个请求，网站接受请求，并发送到数据库执行相关的操作，等待数据库返回结果，人为的延长数据库的执行时间，判断是否有注入</a></li></ul>\n</li><li><a href=\"#_496\">步骤</a></li><li><ul><li><a href=\"#_498\">同布尔盲注</a></li><li><a href=\"#if_500\">if(判断条件,条件为真时返回的值,条件为假时返回的值)</a></li><li><a href=\"#sleep_502\">sleep()</a></li><li><a href=\"#benchmark_504\">benchmark()</a></li></ul>\n</li><li><a href=\"#_506\">堆叠注入</a></li><li><a href=\"#mysqli_query_508\">mysqli_query函数不支持堆叠注入</a></li><li><a href=\"#mysqli_muiti_query_510\">mysqli_muiti_query()支持堆叠注入</a></li><li><a href=\"#_512\">语法</a></li><li><ul><li><a href=\"#select__from_userscreate_table_youid_int_514\">select \\* from users;create table you(id int);#</a></li><li><a href=\"#id1create_table_youid_int_516\">id=1';create table you(id int);#</a></li></ul>\n</li><li><a href=\"#_518\">内联注入</a></li><li><a href=\"#_520\">子查询</a></li><li><ul><li><a href=\"#select_select_1_522\">select (select 1)</a></li></ul>\n</li><li><a href=\"#_524\">区别</a></li><li><a href=\"#_526\">应用范围</a></li><li><ul><li><a href=\"#_528\">时间盲注\\&gt;布尔盲注\\&gt;报错注入=联合注入</a></li></ul>\n</li><li><a href=\"#_530\">利用便捷度</a></li><li><ul><li><a href=\"#_532\">联合注入\\&gt;报错注入\\&gt;布尔盲注\\&gt;时间盲注</a></li></ul>\n</li></ul>\n</li><li><a href=\"#sql_server_534\">sql server数据库</a></li><li><a href=\"#access_536\">access数据库</a></li><li><a href=\"#oracle_538\">oracle数据库</a></li><li><a href=\"#mongodb_540\">mongodb数据库</a></li></ul>\n</li><li><a href=\"#_542\">按照语句划分</a></li><li><ul><li><a href=\"#select_544\">select</a></li><li><a href=\"#_546\">四种基本注入</a></li><li><a href=\"#update_548\">update</a></li><li><a href=\"#_550\">联合注入不行</a></li><li><a href=\"#insert_552\">insert</a></li><li><a href=\"#_554\">联合注入不行</a></li><li><a href=\"#delete_556\">delete</a></li><li><a href=\"#_558\">联合注入不行</a></li><li><a href=\"#limit_560\">limit之后的注入</a></li><li><a href=\"#order_by_562\">order by之后的注入</a></li></ul>\n</li><li><a href=\"#_564\">按照位置划分</a></li><li><ul><li><a href=\"#get_566\">get</a></li><li><a href=\"#post_568\">post</a></li><li><a href=\"#http_header_570\">http header</a></li><li><a href=\"#cookie_572\">cookie</a></li><li><a href=\"#referer_574\">referer</a></li><li><a href=\"#useragent_576\">user-agent</a></li><li><a href=\"#_578\">注意</a></li><li><a href=\"#_580\">不管这个数据从什么地方传到数据库执行的，只要数据可控，那就有可能产生注入漏洞</a></li></ul>\n</li><li><a href=\"#_582\">其他类型</a></li><li><ul><li><a href=\"#base64_584\">base64注入</a></li><li><a href=\"#_586\">二次解码注入</a></li><li><a href=\"#adminor1_588\">插入admin\\\\'or\\\\'1</a></li><li><a href=\"#_590\">宽字节注入</a></li><li><a href=\"#OOBdns_592\">OOB-dns外带注入</a></li></ul>\n</li><li><a href=\"#sqlmap_594\">sqlmap</a></li><li><a href=\"#_596\">基本步骤</a></li><li><ul><li><a href=\"#_598\">检测是否有注入点</a></li><li><a href=\"#sqlmap_u_httpwwwxxxcom1phpid1_600\">sqlmap -u \"http://www.xxx.com/1.php?id=1\"</a></li><li><a href=\"#_602\">获取所有数据库名</a></li><li><a href=\"#sqlmap_u_httpwwwxxxcom1phpid1_dbs_604\">sqlmap -u \"http://www.xxx.com/1.php?id=1\" --dbs</a></li><li><a href=\"#_606\">获取数据表</a></li><li><a href=\"#sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_tables_608\">sqlmap -u \"http://www.xxx.com/1.php?id=1\" -D liuyanban --tables</a></li><li><a href=\"#_610\">获取列名</a></li><li><a href=\"#sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_T_users_columns_612\">sqlmap -u \"http://www.xxx.com/1.php?id=1\" -D liuyanban -T users --columns</a></li><li><a href=\"#_614\">获取数据</a></li><li><a href=\"#sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_T_users_C_idusernamepassword_dump_616\">sqlmap -u \"http://www.xxx.com/1.php?id=1\" -D liuyanban -T users -C id,username,password --dump</a></li></ul>\n</li><li><a href=\"#_618\">常用参数</a></li><li><ul><li><a href=\"#r_620\">-r</a></li><li><a href=\"#_622\">读取文件，提交数据包</a></li><li><a href=\"#_624\">用\\*进行标记</a></li><li><a href=\"#m_626\">-m</a></li><li><a href=\"#_628\">批量注入</a></li><li><a href=\"#cookie_630\">--cookie</a></li><li><a href=\"#useragent_632\">--user-agent</a></li><li><a href=\"#currentdb_634\">--current-db</a></li><li><a href=\"#currentuser_636\">--current-user</a></li><li><a href=\"#users_638\">--users</a></li><li><a href=\"#_640\">获取当前数据库的登陆用户</a></li><li><a href=\"#passwords_642\">--passwords</a></li><li><a href=\"#_644\">获取当前数据库的用户密码</a></li><li><a href=\"#v_646\">-v</a></li><li><a href=\"#_648\">五个等级</a></li><li><a href=\"#level_650\">--level</a></li><li><a href=\"#delay_652\">--delay</a></li><li><a href=\"#timesec_654\">--time-sec</a></li></ul>\n</li><li><a href=\"#_656\">读写文件</a></li><li><ul><li><a href=\"#_658\">原理</a></li><li><a href=\"#_660\">读</a></li><li><ul><li><a href=\"#load_file_662\">load_file</a></li><li><a href=\"#_664\">关键条件</a></li><li><ul><li><a href=\"#_666\">有读权限</a></li><li><a href=\"#secure_file_priv_668\">secure_file_priv</a></li><li><a href=\"#SELinux_670\">SELinux</a></li><li><a href=\"#_672\">知道绝对路径</a></li></ul>\n</li><li><a href=\"#_674\">用法</a></li><li><ul><li><a href=\"#id1_union_select_12load_fileetcpasswd_676\">id=1' union select 1,2,load_file('/etc/passwd')</a></li><li><a href=\"#id1_union_select_12load_file0x0000000_678\">id=1' union select 1,2,load_file(0x0000000)</a></li><li><a href=\"#id1_union_select_12load_filechar1020_680\">id=1' union select 1,2,load_file(char(10,20))</a></li><li><a href=\"#id1_union_select_12hexload_filechar1020_682\">id=1' union select 1,2,hex(load_file(char(10,20)))</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_684\">写</a></li><li><ul><li><a href=\"#into_outfile_686\">into outfile</a></li><li><a href=\"#_688\">关键条件</a></li><li><ul><li><a href=\"#_690\">有写权限</a></li><li><a href=\"#secure_file_priv_692\">secure_file_priv</a></li><li><a href=\"#SELinux_694\">SELinux</a></li><li><a href=\"#_696\">知道绝对路径</a></li><li><a href=\"#_698\">绕过单引号的过滤</a></li></ul>\n</li><li><a href=\"#_700\">用法</a></li><li><ul><li><a href=\"#id1_union_select_12__php_phpinfo_html___into_outfile_varwwwhtmlshellphp_702\">id=1' union select 1,2,' ¶ `&lt;?php phpinfo(); ?&gt;`{=html} ¶ ' into outfile '/var/www/html/shell.php'</a></li><li><a href=\"#id1_union_select_120x00000000_into_outfile_varwwwhtmlshellphp_704\">id=1' union select 1,2,0x00000000 into outfile '/var/www/html/shell.php'</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_706\">参数</a></li><li><a href=\"#_708\">读</a></li><li><ul><li><a href=\"#fileread_710\">--file-read</a></li></ul>\n</li><li><a href=\"#_712\">写</a></li><li><ul><li><a href=\"#filewrite_714\">--file-write</a></li><li><a href=\"#filedest_716\">--file-dest</a></li></ul>\n</li><li><a href=\"#_718\">进阶参数</a></li><li><a href=\"#osshell_720\">--os-shell</a></li><li><ul><li><a href=\"#_722\">原理</a></li><li><a href=\"#webshellwebshell_724\">利用写文件，先写入一个简单的上传页面，再利用上传页面，上传一个webshell执行命令，从webshell页面获取命令回显</a></li></ul>\n</li><li><a href=\"#oscmd_726\">--os-cmd</a></li></ul>\n</li><li><a href=\"#waf_728\">waf</a></li><li><ul><li><a href=\"#_730\">原理</a></li><li><a href=\"#_732\">身份认证</a></li><li><ul><li><a href=\"#_734\">白名单</a></li><li><a href=\"#_736\">黑名单</a></li></ul>\n</li><li><a href=\"#_738\">数据包解析</a></li><li><a href=\"#_740\">规则匹配</a></li><li><a href=\"#waf_742\">绕waf的方式</a></li><li><a href=\"#_744\">身份认证层面</a></li><li><ul><li><a href=\"#_746\">伪造白名单</a></li></ul>\n</li><li><a href=\"#_748\">数据包解析层面</a></li><li><ul><li><a href=\"#_750\">数据包加密</a></li><li><a href=\"#_752\">冰蝎</a></li><li><a href=\"#_754\">自加密</a></li></ul>\n</li><li><a href=\"#_756\">规则匹配层面</a></li><li><ul><li><a href=\"#_758\">利用数据库、中间件、编程语言的种种特性进行绕过</a></li></ul>\n</li><li><a href=\"#waf_760\">绕waf基础方式</a></li><li><a href=\"#_762\">大小写</a></li><li><ul><li><a href=\"#uNioN_SeLect_764\">uNioN SeLect</a></li></ul>\n</li><li><a href=\"#_766\">替代</a></li><li><ul><li><a href=\"#UNunionION_SELselectECT_768\">UNunionION SELselectECT</a></li></ul>\n</li><li><a href=\"#_770\">特殊字符</a></li><li><ul><li><a href=\"#_772\">代替空格的特殊字符</a></li><li><a href=\"#0a_774\">%0a</a></li><li><a href=\"#0c_776\">%0c</a></li><li><a href=\"#_778\">括号</a></li><li><a href=\"#_780\">花括号</a></li></ul>\n</li><li><a href=\"#_782\">编码</a></li><li><ul><li><a href=\"#url_784\">url编码</a></li><li><a href=\"#unicode_786\">unicode编码</a></li></ul>\n</li><li><a href=\"#_788\">注释符号</a></li><li><ul><li><a href=\"#_790\">普通注释</a></li><li><a href=\"#_792\">内联注释</a></li></ul>\n</li><li><a href=\"#_794\">综合方式</a></li><li><ul><li><a href=\"#_796\">大小写</a></li><li><a href=\"#_798\">特殊字符</a></li><li><a href=\"#_800\">编码</a></li><li><a href=\"#_802\">注释符号</a></li></ul>\n</li><li><a href=\"#_804\">参数污染</a></li><li><a href=\"#_806\">缓冲区溢出</a></li><li><a href=\"#_808\">分块传输</a></li><li><a href=\"#bselectb___50000select_810\">正则绕过：\\\\bselect\\\\b -\\&gt; /\\*! 50000select\\*/</a></li><li><a href=\"#_812\">遗漏的注入点</a></li><li><a href=\"#tamper_814\">tamper</a></li><li><a href=\"#tamper_816\">常用的tamper脚本</a></li><li><a href=\"#_818\">用法</a></li><li><ul><li><a href=\"#sqlmap_u_httpwwwxxxcomindexphpid1_tamper_space2commentpy_820\">sqlmap -u \"http://www.xxx.com/index.php?id=1\" --tamper space2comment.py</a></li></ul>\n</li><li><a href=\"#_822\">进阶</a></li><li><ul><li><a href=\"#tamper_824\">自己编写tamper脚本</a></li></ul>\n</li></ul>\n</li><li><a href=\"#_826\">注意站库分离</a></li></ul>\n</li><li><a href=\"#XSSCSRFXXESSRFSSTI_828\">XSS/CSRF/XXE/SSRF/SSTI</a></li><li><ul><li><a href=\"#XSS_830\">XSS</a></li><li><a href=\"#_832\">过滤特定标签</a></li><li><ul><li><a href=\"#_834\">使用事件</a></li><li><a href=\"#_836\">使用新标签</a></li></ul>\n</li><li><a href=\"#_838\">过滤事件</a></li><li><ul><li><a href=\"#fuzz_840\">fuzz</a></li><li><a href=\"#JS_842\">使用伪协议或其他可以执行JS代码的标签属性</a></li></ul>\n</li><li><a href=\"#_844\">过滤敏感关键字（字符）</a></li><li><ul><li><a href=\"#_846\">字符串拼接混淆</a></li><li><a href=\"#_848\">编解码</a></li><li><a href=\"#XSS_850\">在XSS放置在客户端</a></li><li><a href=\"#_852\">字符相关</a></li></ul>\n</li><li><a href=\"#_854\">字符集编码相关</a></li><li><ul><li><a href=\"#_856\">宽字节</a></li></ul>\n</li><li><a href=\"#_858\">长度限制</a></li><li><ul><li><a href=\"#_860\">利用第三方库函数</a></li><li><a href=\"#_862\">利用注释</a></li><li><a href=\"#windownamelocation_864\">window.name和location.\\*</a></li></ul>\n</li><li><a href=\"#HttpOnly_866\">HttpOnly相关</a></li><li><ul><li><a href=\"#CVE20120053_868\">CVE-2012-0053</a></li><li><a href=\"#phpinfo_870\">phpinfo()</a></li><li><a href=\"#FlashJavaAPI_872\">利用Flash/Java的API</a></li></ul>\n</li><li><a href=\"#XSS_Auditor_874\">XSS Auditor</a></li><li><ul><li><a href=\"#_876\">字符集编码</a></li><li><a href=\"#_878\">利用协议理解不一致</a></li><li><a href=\"#CRLF_880\">利用CRLF</a></li></ul>\n</li><li><a href=\"#CSP_882\">CSP</a></li><li><a href=\"#SSTI_884\">SSTI</a></li><li><a href=\"#tqlmap_886\">tqlmap工具</a></li><li><a href=\"#XXE_888\">XXE</a></li><li><a href=\"#_890\">原理</a></li><li><ul><li><a href=\"#xml_892\">xml外部实体注入</a></li></ul>\n</li><li><a href=\"#_894\">实体</a></li><li><ul><li><a href=\"#_896\">内部实体</a></li><li><a href=\"#_898\">外部实体</a></li></ul>\n</li><li><a href=\"#xml_900\">xml格式</a></li><li><a href=\"#_902\">利用</a></li><li><ul><li><a href=\"#_904\">任意文件读取</a></li><li><a href=\"#ssrf_906\">ssrf</a></li><li><a href=\"#_908\">命令执行</a></li></ul>\n</li><li><a href=\"#CSRF_910\">CSRF</a></li><li><a href=\"#_912\">原理</a></li><li><a href=\"#_914\">跨域</a></li><li><ul><li><a href=\"#_916\">同源</a></li><li><a href=\"#_918\">协议相同</a></li><li><a href=\"#_920\">域名相同</a></li><li><a href=\"#_922\">端口相同</a></li><li><a href=\"#_924\">跨</a></li><li><a href=\"#_926\">同源策略</a></li><li><ul><li><a href=\"#ajax_928\">ajax无法跨域</a></li><li><a href=\"#_930\">自动表单提交</a></li><li><a href=\"#__script_srchtml_932\"> ¶ `</a></li></ul>\n</li></ul>\n</li></ul>\n</li></ul>\n</div>\n<p></p>\n<h1><a id=\"_4\"></a>基础</h1>\n<h2><a id=\"Flag_6\"></a>Flag可能出现的位置</h2>\n<h2><a id=\"_8\"></a>网页源代码（注意注释）</h2>\n<h2><a id=\"_10\"></a>数据库中</h2>\n<h2><a id=\"phpinfo_12\"></a>phpinfo</h2>\n<h2><a id=\"_14\"></a>靶机中的文件</h2>\n<h2><a id=\"_16\"></a>环境变量</h2>\n<h2><a id=\"_18\"></a>题目要求</h2>\n<h2><a id=\"XFFReferUACookieF12viewsourceURLrobotstxt_20\"></a>XFF/Refer/UA/Cookie/F12(view-source)/URL/robots.txt/响应码/</h2>\n<h2><a id=\"_22\"></a>指纹识别</h2>\n<h2><a id=\"_24\"></a>工具</h2>\n<h3><a id=\"ArjunHTTP_26\"></a>Arjun：HTTP参数挖掘套件</h3>\n<h3><a id=\"TideFingerBscanGlass_28\"></a>TideFinger/Bscan/Glass</h3>\n<h2><a id=\"Wappalyzer_30\"></a>Wappalyzer插件</h2>\n<h2><a id=\"404302_32\"></a>错误界面(404/302)</h2>\n<h2><a id=\"dirsearch_34\"></a>源码泄露(dirsearch)</h2>\n<h2><a id=\"Git_36\"></a>Git</h2>\n<h3><a id=\"Githack_38\"></a>Githack恢复</h3>\n<h3><a id=\"loggit_reset_40\"></a>查看log后选择性地进行git reset回滚</h3>\n<h3><a id=\"gitconfigaccess_token_42\"></a>.git/config可能有access_token信息</h3>\n<h2><a id=\"SVN_44\"></a>SVN</h2>\n<h3><a id=\"Seaysvn_46\"></a>Seay-svn</h3>\n<h3><a id=\"dvcsripper_48\"></a>dvcs-ripper工具</h3>\n<h3><a id=\"wcdb_50\"></a>注意wc.db文件存在与否</h3>\n<h2><a id=\"WEBINFwebxml_52\"></a>WEB-INF/web.xml泄露</h2>\n<h2><a id=\"DS_Store_54\"></a>.DS_Store文件泄漏</h2>\n<h2><a id=\"hg_56\"></a>.hg泄露</h2>\n<h3><a id=\"dvcsripper_58\"></a>dvcs-ripper工具</h3>\n<h2><a id=\"CVS_60\"></a>CVS泄露</h2>\n<h2><a id=\"_62\"></a>备份文件泄露</h2>\n<h3><a id=\"geditfilename__64\"></a>gedit：filename ~</h3>\n<h3><a id=\"vimvim_r_filenameswpswoswn_66\"></a>vim：vim -r filename.swp/.swo/.swn</h3>\n<h3><a id=\"wwwziprartargz_68\"></a>www.zip/rar/tar.gz</h3>\n<h2><a id=\"PHP_70\"></a>PHP专题</h2>\n<h2><a id=\"MD5SHA10e_72\"></a>MD5/SHA1数组绕过、0e</h2>\n<h2><a id=\"is_numeric33a_74\"></a>is_numeric()绕过：33a</h2>\n<h2><a id=\"_76\"></a>比较大小：数组大于任何其他类型</h2>\n<h2><a id=\"intval_1a100a10_78\"></a>intval() 1a/1%00/a1=0</h2>\n<h2><a id=\"e_80\"></a>正则式：/e可执行，构造越界</h2>\n<h1><a id=\"_82\"></a>命令执行</h1>\n<h2><a id=\"__84\"></a>运用分隔符&amp;或| 若无严格过滤可出现任意漏洞执行漏洞</h2>\n<h2><a id=\"shell_86\"></a>反弹shell的方式</h2>\n<h2><a id=\"0A_88\"></a>%0A参数污染</h2>\n<h2><a id=\"RCE_90\"></a>无参RCE</h2>\n<h2><a id=\"preg_matchRCE_92\"></a>绕过preg_match的RCE</h2>\n<p>非常经典的如无符号RCE</p>\n<h2><a id=\"bypass_96\"></a>过滤与bypass</h2>\n<h2><a id=\"linuxIFS_98\"></a>linux中{IFS}可以代替空格</h2>\n<h2><a id=\"_100\"></a>内联执行</h2>\n<h2><a id=\"_102\"></a>长度限制与解决方案</h2>\n<h2><a id=\"_104\"></a>利用文件名</h2>\n<h2><a id=\"MySQL_106\"></a>MySQL服务端恶意读取客户端文件漏洞</h2>\n<h2><a id=\"Redis_4x_CVE_108\"></a>Redis 4.x CVE</h2>\n<h2><a id=\"shell_110\"></a>主从复制写shell</h2>\n<p>https://github.com/n0b0dyCN/redis-rogue-server</p>\n<h2><a id=\"RedisSSRF_114\"></a>Redis结合SSRF</h2>\n<p>https://github.com/xmsec/redis-ssrf</p>\n<h1><a id=\"_118\"></a>容器和框架漏洞</h1>\n<h2><a id=\"Nginx_120\"></a>Nginx配置漏洞</h2>\n<h2><a id=\"Windows_122\"></a>Windows相关</h2>\n<h2><a id=\"IIS_PUT_124\"></a>IIS PUT上传漏洞</h2>\n<h2><a id=\"IIS__126\"></a>IIS 远程溢出漏洞</h2>\n<h2><a id=\"IIS_128\"></a>IIS短文件漏洞</h2>\n<h2><a id=\"_130\"></a>文件上传的绕过</h2>\n<h2><a id=\"Apache_HTTP_132\"></a>Apache HTTP组件提权漏洞</h2>\n<p>CVE-2019-0211</p>\n<h2><a id=\"CGI__136\"></a>CGI 漏洞</h2>\n<h2><a id=\"ThinkPHP_138\"></a>ThinkPHP</h2>\n<h2><a id=\"Twig_140\"></a>Twig</h2>\n<h2><a id=\"Laravel_142\"></a>Laravel</h2>\n<h2><a id=\"Smarty_144\"></a>Smarty</h2>\n<h2><a id=\"ASP_146\"></a>ASP</h2>\n<h2><a id=\"ASPNET_VIEWSTATE_148\"></a>ASP.NET VIEWSTATE反序列化</h2>\n<h2><a id=\"webconfig_150\"></a>web.config利用</h2>\n<h2><a id=\"JAVA_WEB_152\"></a>JAVA WEB</h2>\n<h2><a id=\"Struts2_154\"></a>Struts2框架漏洞</h2>\n<h3><a id=\"OGNL_156\"></a>OGNL注入</h3>\n<h2><a id=\"Spring_158\"></a>Spring框架漏洞</h2>\n<h3><a id=\"SPEL_160\"></a>SPEL注入</h3>\n<h3><a id=\"_162\"></a>组件漏洞</h3>\n<h3><a id=\"FastJson_164\"></a>FastJson等</h3>\n<h2><a id=\"_166\"></a>反序列化漏洞</h2>\n<h3><a id=\"Hessian_168\"></a>Hessian</h3>\n<h3><a id=\"ObjectOutputStream_170\"></a>二进制（ObjectOutputStream）</h3>\n<h3><a id=\"JSON_172\"></a>JSON</h3>\n<h3><a id=\"XML_174\"></a>XML</h3>\n<h3><a id=\"YAML_176\"></a>YAML</h3>\n<h2><a id=\"JRMP_178\"></a>JRMP安全性问题</h2>\n<h2><a id=\"JWT_180\"></a>JWT攻击</h2>\n<h2><a id=\"_182\"></a>敏感信息泄露</h2>\n<h2><a id=\"none_184\"></a>将算法修改为none</h2>\n<h2><a id=\"_186\"></a>密钥混淆攻击</h2>\n<h2><a id=\"_188\"></a>无效签名</h2>\n<h2><a id=\"_190\"></a>暴力破解密钥</h2>\n<h2><a id=\"_192\"></a>密钥泄露</h2>\n<h2><a id=\"KID_194\"></a>操纵KID</h2>\n<h2><a id=\"_196\"></a>操纵头部参数</h2>\n<h2><a id=\"JavaScript_198\"></a>JavaScript框架</h2>\n<h2><a id=\"SSJIJavaScript_200\"></a>SSJI（服务端JavaScript注入）</h2>\n<h3><a id=\"Nodejs_202\"></a>Node.js</h3>\n<h3><a id=\"Vuejs_204\"></a>Vue.js</h3>\n<h2><a id=\"JavaScript_Prototype__206\"></a>JavaScript Prototype 污染攻击</h2>\n<h2><a id=\"Python_208\"></a>Python</h2>\n<h2><a id=\"_210\"></a>沙箱逃逸</h2>\n<h3><a id=\"_212\"></a>利用内建函数执行命令</h3>\n<h3><a id=\"bypass_214\"></a>过滤与bypass</h3>\n<h2><a id=\"_216\"></a>各种框架的漏洞</h2>\n<h3><a id=\"Flask_218\"></a>Flask</h3>\n<h3><a id=\"SESSION_220\"></a>SESSION安全问题</h3>\n<p>https://www.leavesongs.com/PENETRATION/client-session-security.html</p>\n<h4><a id=\"_224\"></a>敏感信息泄露</h4>\n<h4><a id=\"_226\"></a>验证码绕过</h4>\n<h4><a id=\"SESSION_228\"></a>SESSION伪造和对象注入漏洞</h4>\n<h4><a id=\"hashhmac_230\"></a>使用hash而非hmac进行签名</h4>\n<h4><a id=\"Hash_232\"></a>Hash长度拓展攻击</h4>\n<h4><a id=\"_234\"></a>任意文件读取</h4>\n<h4><a id=\"_236\"></a>加密而未签名</h4>\n<h4><a id=\"CBC_238\"></a>CBC字节翻转攻击</h4>\n<h3><a id=\"Tornado_240\"></a>Tornado</h3>\n<h3><a id=\"Django_242\"></a>Django</h3>\n<h2><a id=\"_244\"></a>反序列化漏洞</h2>\n<h3><a id=\"pickle_246\"></a>pickle模块</h3>\n<h2><a id=\"Ruby_248\"></a>Ruby</h2>\n<h2><a id=\"ERB_250\"></a>ERB模板注入</h2>\n<h1><a id=\"SQL_252\"></a>SQL注入及数据库</h1>\n<h2><a id=\"_254\"></a>手工注入</h2>\n<h2><a id=\"_256\"></a>原理</h2>\n<h3><a id=\"web_258\"></a>用户输入的内容传到web应用，没有经过过滤或者严格的过滤，被带入到了数据库中进行执行</h3>\n<h2><a id=\"_260\"></a>漏洞产生的关键条件</h2>\n<h3><a id=\"__262\"></a>用户能够控制 自己的输入</h3>\n<h3><a id=\"_264\"></a>直接控制输入</h3>\n<h3><a id=\"_266\"></a>间接控制输入</h3>\n<h4><a id=\"_268\"></a>二次注入</h4>\n<h2><a id=\"_270\"></a>按照数据库分类</h2>\n<h3><a id=\"mysql_272\"></a>mysql数据库</h3>\n<h3><a id=\"_274\"></a>六种基本的注入模式</h3>\n<h4><a id=\"_276\"></a>联合注入</h4>\n<h4><a id=\"_278\"></a>几大基本步骤</h4>\n<h5><a id=\"_280\"></a>判断是否有注入以及注入点的类型</h5>\n<h5><a id=\"_282\"></a>是否有注入</h5>\n<h6><a id=\"_284\"></a>加单引号</h6>\n<h6><a id=\"and_87318731_286\"></a>and 8731=8731</h6>\n<h6><a id=\"and_aa_288\"></a>and ‘a’=‘a’</h6>\n<h6><a id=\"and_12_290\"></a>and 1=2</h6>\n<h6><a id=\"or_11_292\"></a>or 1=1</h6>\n<h6><a id=\"or_12_294\"></a>or 1=2</h6>\n<h5><a id=\"_296\"></a>注入点类型</h5>\n<h6><a id=\"_298\"></a>字符型</h6>\n<h6><a id=\"_300\"></a>’</h6>\n<h6><a id=\"_302\"></a>\"</h6>\n<h6><a id=\"_304\"></a>'）</h6>\n<h6><a id=\"_306\"></a>\"）</h6>\n<h6><a id=\"_308\"></a>%’</h6>\n<h6><a id=\"_310\"></a>数字型</h6>\n<h5><a id=\"_312\"></a>判断查询列数</h5>\n<h5><a id=\"_314\"></a>为什么</h5>\n<h6><a id=\"union_select_316\"></a>union 前后两个select语句的列数要一致</h6>\n<h5><a id=\"_318\"></a>原理</h5>\n<h6><a id=\"order_by_320\"></a>order by是排序的语句</h6>\n<h6><a id=\"select__from_users_order_by_id_322\"></a>select * from users order by id</h6>\n<h6><a id=\"select__from_users_order_by_id_desc_324\"></a>select * from users order by id desc</h6>\n<h6><a id=\"select__from_users_order_by_1_326\"></a>select * from users order by 1</h6>\n<h5><a id=\"order_by_n_328\"></a>order by n</h5>\n<h5><a id=\"_330\"></a>联合查询</h5>\n<h5><a id=\"union_332\"></a>union</h5>\n<h6><a id=\"id1_union_select_123_334\"></a>id=1’ union select 1,2,3–+</h6>\n<h6><a id=\"id1_union_select_123_336\"></a>id=-1’ union select 1,2,3–+</h6>\n<h5><a id=\"_338\"></a>获取基本信息</h5>\n<h5><a id=\"version_340\"></a>version()</h5>\n<h6><a id=\"_342\"></a>获取数据库的版本</h6>\n<h5><a id=\"database_344\"></a>database()</h5>\n<h6><a id=\"_346\"></a>获取当前网站使用的数据库</h6>\n<h5><a id=\"user_348\"></a>user()</h5>\n<h6><a id=\"_350\"></a>当前网站使用的数据库账号</h6>\n<h5><a id=\"secure_file_priv_352\"></a>@@secure_file_priv</h5>\n<h6><a id=\"_354\"></a>数据库的读写文件</h6>\n<h5><a id=\"datadir_356\"></a>@@datadir</h5>\n<h6><a id=\"_358\"></a>数据库的安装目录</h6>\n<h6><a id=\"phpstudy_360\"></a>phpstudy</h6>\n<p>####### c:\\phpstudy\\mysql</p>\n<p>####### c:\\phpstudy\\www</p>\n<h6><a id=\"wamp_366\"></a>wamp</h6>\n<p>####### c:\\wamp\\mysql</p>\n<p>####### c:\\wamp\\www</p>\n<h5><a id=\"_372\"></a>…（自行补充）</h5>\n<h5><a id=\"_374\"></a>获取数据库名</h5>\n<h5><a id=\"information_schema_376\"></a>information_schema数据库</h5>\n<h6><a id=\"schemata_378\"></a>schemata数据表</h6>\n<h6><a id=\"tables_380\"></a>tables数据表</h6>\n<h6><a id=\"columns_382\"></a>columns数据表</h6>\n<h5><a id=\"schemata_384\"></a>schemata数据表里面获取数据库名</h5>\n<h6><a id=\"select_schema_name_from_schemata_386\"></a>select schema_name from schemata;</h6>\n<h6><a id=\"id1_union_select_12group_concatschema_name_from_information_schemaschemata_388\"></a>id=1’ union select 1,2,group_concat(schema_name) from information_schema.schemata</h6>\n<h5><a id=\"_390\"></a>获取数据表名</h5>\n<h5><a id=\"tables_392\"></a>tables表</h5>\n<h6><a id=\"select_table_name_from_tables_where_table_schemasecurity_394\"></a>select table_name from tables where table_schema=‘security’;</h6>\n<h6><a id=\"select_table_name_from_tables_where_table_schemadatabase_396\"></a>select table_name from tables where table_schema=database();</h6>\n<h6><a id=\"id1_union_select_12group_concattable_name_from_information_schematables_where_table_schemadatabase_398\"></a>id=1’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()</h6>\n<h5><a id=\"_400\"></a>获取列名</h5>\n<h5><a id=\"columns_402\"></a>columns表</h5>\n<h6><a id=\"select_column_name_from_columns_where_table_schemasecurity_and_table_nameusers_404\"></a>select column_name from columns where table_schema=‘security’ and table_name=‘users’;</h6>\n<h5><a id=\"_406\"></a>优化步骤</h5>\n<h5><a id=\"select_table_namecolumn_name_from_columns_where_table_schemasecurity_408\"></a>select table_name,column_name from columns where table_schema=‘security’;</h5>\n<h5><a id=\"id1_union_select_12group_concattable_name_column_name_from_information_schemacolumns_where_table_schemadatabase_410\"></a>id=1’ union select 1,2,group_concat(table_name,’_’,column_name) from information_schema.columns where table_schema=database()</h5>\n<h5><a id=\"_412\"></a>获取数据</h5>\n<h5><a id=\"md5_414\"></a>md5破解</h5>\n<h5><a id=\"md5_416\"></a>md5破解的做法</h5>\n<h6><a id=\"_418\"></a>暴力枚举</h6>\n<h4><a id=\"_420\"></a>报错注入</h4>\n<h4><a id=\"_422\"></a>几个函数</h4>\n<h5><a id=\"updatexml_424\"></a>updatexml</h5>\n<h5><a id=\"extractvalue_426\"></a>extractvalue</h5>\n<h5><a id=\"_428\"></a>报错的原理</h5>\n<h6><a id=\"xpath_430\"></a>构造不满足xpath语法的内容</h6>\n<h5><a id=\"_432\"></a>报错的语句</h5>\n<h6><a id=\"id1_and_extractvalue1concat0x7eselect_user0x7e_434\"></a>id=1’ and extractvalue(1,concat(0x7e,(select user()),0x7e))</h6>\n<h5><a id=\"_436\"></a>注意</h5>\n<h6><a id=\"_438\"></a>版本限制</h6>\n<h6><a id=\"32_440\"></a>32位长度限制</h6>\n<h6><a id=\"substr_442\"></a>substr</h6>\n<h5><a id=\"_444\"></a>其他函数</h5>\n<h4><a id=\"_446\"></a>布尔盲注</h4>\n<h4><a id=\"_448\"></a>原理</h4>\n<h5><a id=\"_450\"></a>布尔运算</h5>\n<h5><a id=\"and_452\"></a>and</h5>\n<h5><a id=\"or_454\"></a>or</h5>\n<h4><a id=\"_456\"></a>步骤</h4>\n<h5><a id=\"_458\"></a>获取数据库名</h5>\n<h5><a id=\"_460\"></a>判断有多少个数据库</h5>\n<h6><a id=\"count_462\"></a>count()</h6>\n<h5><a id=\"_464\"></a>判断第一个数据库名的长度</h5>\n<h6><a id=\"length_466\"></a>length()</h6>\n<h5><a id=\"_468\"></a>获取第一个每一位数据库名字的字符</h5>\n<h6><a id=\"substr_470\"></a>substr()</h6>\n<h6><a id=\"ascii_472\"></a>ascii()</h6>\n<h5><a id=\"_474\"></a>判断第二个数据库名的长度</h5>\n<h5><a id=\"_476\"></a>获取第二个数据库每一位数据库名字的字符</h5>\n<h5><a id=\"_478\"></a>获取数据表名</h5>\n<h5><a id=\"_480\"></a>判断数据库里面有多少个数据表</h5>\n<h5><a id=\"_482\"></a>判断第一个数据库的长度</h5>\n<h5><a id=\"_484\"></a>获取第一个数据表的每一位字符</h5>\n<h5><a id=\"_486\"></a>获取列名</h5>\n<h5><a id=\"_488\"></a>获取数据</h5>\n<h4><a id=\"_490\"></a>时间盲注</h4>\n<h4><a id=\"_492\"></a>原理</h4>\n<h5><a id=\"_494\"></a>发送一个请求，网站接受请求，并发送到数据库执行相关的操作，等待数据库返回结果，人为的延长数据库的执行时间，判断是否有注入</h5>\n<h4><a id=\"_496\"></a>步骤</h4>\n<h5><a id=\"_498\"></a>同布尔盲注</h5>\n<h5><a id=\"if_500\"></a>if(判断条件,条件为真时返回的值,条件为假时返回的值)</h5>\n<h5><a id=\"sleep_502\"></a>sleep()</h5>\n<h5><a id=\"benchmark_504\"></a>benchmark()</h5>\n<h4><a id=\"_506\"></a>堆叠注入</h4>\n<h4><a id=\"mysqli_query_508\"></a>mysqli_query函数不支持堆叠注入</h4>\n<h4><a id=\"mysqli_muiti_query_510\"></a>mysqli_muiti_query()支持堆叠注入</h4>\n<h4><a id=\"_512\"></a>语法</h4>\n<h5><a id=\"select__from_userscreate_table_youid_int_514\"></a>select * from users;create table you(id int);#</h5>\n<h5><a id=\"id1create_table_youid_int_516\"></a>id=1’;create table you(id int);#</h5>\n<h4><a id=\"_518\"></a>内联注入</h4>\n<h4><a id=\"_520\"></a>子查询</h4>\n<h5><a id=\"select_select_1_522\"></a>select (select 1)</h5>\n<h4><a id=\"_524\"></a>区别</h4>\n<h4><a id=\"_526\"></a>应用范围</h4>\n<h5><a id=\"_528\"></a>时间盲注&gt;布尔盲注&gt;报错注入=联合注入</h5>\n<h4><a id=\"_530\"></a>利用便捷度</h4>\n<h5><a id=\"_532\"></a>联合注入&gt;报错注入&gt;布尔盲注&gt;时间盲注</h5>\n<h3><a id=\"sql_server_534\"></a>sql server数据库</h3>\n<h3><a id=\"access_536\"></a>access数据库</h3>\n<h3><a id=\"oracle_538\"></a>oracle数据库</h3>\n<h3><a id=\"mongodb_540\"></a>mongodb数据库</h3>\n<h2><a id=\"_542\"></a>按照语句划分</h2>\n<h3><a id=\"select_544\"></a>select</h3>\n<h3><a id=\"_546\"></a>四种基本注入</h3>\n<h3><a id=\"update_548\"></a>update</h3>\n<h3><a id=\"_550\"></a>联合注入不行</h3>\n<h3><a id=\"insert_552\"></a>insert</h3>\n<h3><a id=\"_554\"></a>联合注入不行</h3>\n<h3><a id=\"delete_556\"></a>delete</h3>\n<h3><a id=\"_558\"></a>联合注入不行</h3>\n<h3><a id=\"limit_560\"></a>limit之后的注入</h3>\n<h3><a id=\"order_by_562\"></a>order by之后的注入</h3>\n<h2><a id=\"_564\"></a>按照位置划分</h2>\n<h3><a id=\"get_566\"></a>get</h3>\n<h3><a id=\"post_568\"></a>post</h3>\n<h3><a id=\"http_header_570\"></a>http header</h3>\n<h3><a id=\"cookie_572\"></a>cookie</h3>\n<h3><a id=\"referer_574\"></a>referer</h3>\n<h3><a id=\"useragent_576\"></a>user-agent</h3>\n<h3><a id=\"_578\"></a>注意</h3>\n<h3><a id=\"_580\"></a>不管这个数据从什么地方传到数据库执行的，只要数据可控，那就有可能产生注入漏洞</h3>\n<h2><a id=\"_582\"></a>其他类型</h2>\n<h3><a id=\"base64_584\"></a>base64注入</h3>\n<h3><a id=\"_586\"></a>二次解码注入</h3>\n<h3><a id=\"adminor1_588\"></a>插入admin\\'or\\'1</h3>\n<h3><a id=\"_590\"></a>宽字节注入</h3>\n<h3><a id=\"OOBdns_592\"></a>OOB-dns外带注入</h3>\n<h2><a id=\"sqlmap_594\"></a>sqlmap</h2>\n<h2><a id=\"_596\"></a>基本步骤</h2>\n<h3><a id=\"_598\"></a>检测是否有注入点</h3>\n<h3><a id=\"sqlmap_u_httpwwwxxxcom1phpid1_600\"></a>sqlmap -u “http://www.xxx.com/1.php?id=1”</h3>\n<h3><a id=\"_602\"></a>获取所有数据库名</h3>\n<h3><a id=\"sqlmap_u_httpwwwxxxcom1phpid1_dbs_604\"></a>sqlmap -u “http://www.xxx.com/1.php?id=1” --dbs</h3>\n<h3><a id=\"_606\"></a>获取数据表</h3>\n<h3><a id=\"sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_tables_608\"></a>sqlmap -u “http://www.xxx.com/1.php?id=1” -D liuyanban --tables</h3>\n<h3><a id=\"_610\"></a>获取列名</h3>\n<h3><a id=\"sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_T_users_columns_612\"></a>sqlmap -u “http://www.xxx.com/1.php?id=1” -D liuyanban -T users --columns</h3>\n<h3><a id=\"_614\"></a>获取数据</h3>\n<h3><a id=\"sqlmap_u_httpwwwxxxcom1phpid1_D_liuyanban_T_users_C_idusernamepassword_dump_616\"></a>sqlmap -u “http://www.xxx.com/1.php?id=1” -D liuyanban -T users -C id,username,password --dump</h3>\n<h2><a id=\"_618\"></a>常用参数</h2>\n<h3><a id=\"r_620\"></a>-r</h3>\n<h3><a id=\"_622\"></a>读取文件，提交数据包</h3>\n<h3><a id=\"_624\"></a>用*进行标记</h3>\n<h3><a id=\"m_626\"></a>-m</h3>\n<h3><a id=\"_628\"></a>批量注入</h3>\n<h3><a id=\"cookie_630\"></a>–cookie</h3>\n<h3><a id=\"useragent_632\"></a>–user-agent</h3>\n<h3><a id=\"currentdb_634\"></a>–current-db</h3>\n<h3><a id=\"currentuser_636\"></a>–current-user</h3>\n<h3><a id=\"users_638\"></a>–users</h3>\n<h3><a id=\"_640\"></a>获取当前数据库的登陆用户</h3>\n<h3><a id=\"passwords_642\"></a>–passwords</h3>\n<h3><a id=\"_644\"></a>获取当前数据库的用户密码</h3>\n<h3><a id=\"v_646\"></a>-v</h3>\n<h3><a id=\"_648\"></a>五个等级</h3>\n<h3><a id=\"level_650\"></a>–level</h3>\n<h3><a id=\"delay_652\"></a>–delay</h3>\n<h3><a id=\"timesec_654\"></a>–time-sec</h3>\n<h2><a id=\"_656\"></a>读写文件</h2>\n<h3><a id=\"_658\"></a>原理</h3>\n<h3><a id=\"_660\"></a>读</h3>\n<h4><a id=\"load_file_662\"></a>load_file</h4>\n<h4><a id=\"_664\"></a>关键条件</h4>\n<h5><a id=\"_666\"></a>有读权限</h5>\n<h5><a id=\"secure_file_priv_668\"></a>secure_file_priv</h5>\n<h5><a id=\"SELinux_670\"></a>SELinux</h5>\n<h5><a id=\"_672\"></a>知道绝对路径</h5>\n<h4><a id=\"_674\"></a>用法</h4>\n<h5><a id=\"id1_union_select_12load_fileetcpasswd_676\"></a>id=1’ union select 1,2,load_file(’/etc/passwd’)</h5>\n<h5><a id=\"id1_union_select_12load_file0x0000000_678\"></a>id=1’ union select 1,2,load_file(0x0000000)</h5>\n<h5><a id=\"id1_union_select_12load_filechar1020_680\"></a>id=1’ union select 1,2,load_file(char(10,20))</h5>\n<h5><a id=\"id1_union_select_12hexload_filechar1020_682\"></a>id=1’ union select 1,2,hex(load_file(char(10,20)))</h5>\n<h3><a id=\"_684\"></a>写</h3>\n<h4><a id=\"into_outfile_686\"></a>into outfile</h4>\n<h4><a id=\"_688\"></a>关键条件</h4>\n<h5><a id=\"_690\"></a>有写权限</h5>\n<h5><a id=\"secure_file_priv_692\"></a>secure_file_priv</h5>\n<h5><a id=\"SELinux_694\"></a>SELinux</h5>\n<h5><a id=\"_696\"></a>知道绝对路径</h5>\n<h5><a id=\"_698\"></a>绕过单引号的过滤</h5>\n<h4><a id=\"_700\"></a>用法</h4>\n<h5><a id=\"id1_union_select_12__php_phpinfo_html___into_outfile_varwwwhtmlshellphp_702\"></a>id=1’ union select 1,2,’ ¶ <code>&lt;?php phpinfo(); ?&gt;</code>{=html} ¶ ’ into outfile ‘/var/www/html/shell.php’</h5>\n<h5><a id=\"id1_union_select_120x00000000_into_outfile_varwwwhtmlshellphp_704\"></a>id=1’ union select 1,2,0x00000000 into outfile ‘/var/www/html/shell.php’</h5>\n<h3><a id=\"_706\"></a>参数</h3>\n<h3><a id=\"_708\"></a>读</h3>\n<h4><a id=\"fileread_710\"></a>–file-read</h4>\n<h3><a id=\"_712\"></a>写</h3>\n<h4><a id=\"filewrite_714\"></a>–file-write</h4>\n<h4><a id=\"filedest_716\"></a>–file-dest</h4>\n<h3><a id=\"_718\"></a>进阶参数</h3>\n<h3><a id=\"osshell_720\"></a>–os-shell</h3>\n<h4><a id=\"_722\"></a>原理</h4>\n<h4><a id=\"webshellwebshell_724\"></a>利用写文件，先写入一个简单的上传页面，再利用上传页面，上传一个webshell执行命令，从webshell页面获取命令回显</h4>\n<h3><a id=\"oscmd_726\"></a>–os-cmd</h3>\n<h2><a id=\"waf_728\"></a>waf</h2>\n<h3><a id=\"_730\"></a>原理</h3>\n<h3><a id=\"_732\"></a>身份认证</h3>\n<h4><a id=\"_734\"></a>白名单</h4>\n<h4><a id=\"_736\"></a>黑名单</h4>\n<h3><a id=\"_738\"></a>数据包解析</h3>\n<h3><a id=\"_740\"></a>规则匹配</h3>\n<h3><a id=\"waf_742\"></a>绕waf的方式</h3>\n<h3><a id=\"_744\"></a>身份认证层面</h3>\n<h4><a id=\"_746\"></a>伪造白名单</h4>\n<h3><a id=\"_748\"></a>数据包解析层面</h3>\n<h4><a id=\"_750\"></a>数据包加密</h4>\n<h4><a id=\"_752\"></a>冰蝎</h4>\n<h4><a id=\"_754\"></a>自加密</h4>\n<h3><a id=\"_756\"></a>规则匹配层面</h3>\n<h4><a id=\"_758\"></a>利用数据库、中间件、编程语言的种种特性进行绕过</h4>\n<h3><a id=\"waf_760\"></a>绕waf基础方式</h3>\n<h3><a id=\"_762\"></a>大小写</h3>\n<h4><a id=\"uNioN_SeLect_764\"></a>uNioN SeLect</h4>\n<h3><a id=\"_766\"></a>替代</h3>\n<h4><a id=\"UNunionION_SELselectECT_768\"></a>UNunionION SELselectECT</h4>\n<h3><a id=\"_770\"></a>特殊字符</h3>\n<h4><a id=\"_772\"></a>代替空格的特殊字符</h4>\n<h4><a id=\"0a_774\"></a>%0a</h4>\n<h4><a id=\"0c_776\"></a>%0c</h4>\n<h4><a id=\"_778\"></a>括号</h4>\n<h4><a id=\"_780\"></a>花括号</h4>\n<h3><a id=\"_782\"></a>编码</h3>\n<h4><a id=\"url_784\"></a>url编码</h4>\n<h4><a id=\"unicode_786\"></a>unicode编码</h4>\n<h3><a id=\"_788\"></a>注释符号</h3>\n<h4><a id=\"_790\"></a>普通注释</h4>\n<h4><a id=\"_792\"></a>内联注释</h4>\n<h3><a id=\"_794\"></a>综合方式</h3>\n<h4><a id=\"_796\"></a>大小写</h4>\n<h4><a id=\"_798\"></a>特殊字符</h4>\n<h4><a id=\"_800\"></a>编码</h4>\n<h4><a id=\"_802\"></a>注释符号</h4>\n<h3><a id=\"_804\"></a>参数污染</h3>\n<h3><a id=\"_806\"></a>缓冲区溢出</h3>\n<h3><a id=\"_808\"></a>分块传输</h3>\n<h3><a id=\"bselectb___50000select_810\"></a>正则绕过：\\bselect\\b -&gt; /*! 50000select*/</h3>\n<h3><a id=\"_812\"></a>遗漏的注入点</h3>\n<h3><a id=\"tamper_814\"></a>tamper</h3>\n<h3><a id=\"tamper_816\"></a>常用的tamper脚本</h3>\n<h3><a id=\"_818\"></a>用法</h3>\n<h4><a id=\"sqlmap_u_httpwwwxxxcomindexphpid1_tamper_space2commentpy_820\"></a>sqlmap -u “http://www.xxx.com/index.php?id=1” --tamper space2comment.py</h4>\n<h3><a id=\"_822\"></a>进阶</h3>\n<h4><a id=\"tamper_824\"></a>自己编写tamper脚本</h4>\n<h2><a id=\"_826\"></a>注意站库分离</h2>\n<h1><a id=\"XSSCSRFXXESSRFSSTI_828\"></a>XSS/CSRF/XXE/SSRF/SSTI</h1>\n<h2><a id=\"XSS_830\"></a>XSS</h2>\n<h2><a id=\"_832\"></a>过滤特定标签</h2>\n<h3><a id=\"_834\"></a>使用事件</h3>\n<h3><a id=\"_836\"></a>使用新标签</h3>\n<h2><a id=\"_838\"></a>过滤事件</h2>\n<h3><a id=\"fuzz_840\"></a>fuzz</h3>\n<h3><a id=\"JS_842\"></a>使用伪协议或其他可以执行JS代码的标签属性</h3>\n<h2><a id=\"_844\"></a>过滤敏感关键字（字符）</h2>\n<h3><a id=\"_846\"></a>字符串拼接混淆</h3>\n<h3><a id=\"_848\"></a>编解码</h3>\n<h3><a id=\"XSS_850\"></a>在XSS放置在客户端</h3>\n<h3><a id=\"_852\"></a>字符相关</h3>\n<h2><a id=\"_854\"></a>字符集编码相关</h2>\n<h3><a id=\"_856\"></a>宽字节</h3>\n<h2><a id=\"_858\"></a>长度限制</h2>\n<h3><a id=\"_860\"></a>利用第三方库函数</h3>\n<h3><a id=\"_862\"></a>利用注释</h3>\n<h3><a id=\"windownamelocation_864\"></a>window.name和location.*</h3>\n<h2><a id=\"HttpOnly_866\"></a>HttpOnly相关</h2>\n<h3><a id=\"CVE20120053_868\"></a>CVE-2012-0053</h3>\n<h3><a id=\"phpinfo_870\"></a>phpinfo()</h3>\n<h3><a id=\"FlashJavaAPI_872\"></a>利用Flash/Java的API</h3>\n<h2><a id=\"XSS_Auditor_874\"></a>XSS Auditor</h2>\n<h3><a id=\"_876\"></a>字符集编码</h3>\n<h3><a id=\"_878\"></a>利用协议理解不一致</h3>\n<h3><a id=\"CRLF_880\"></a>利用CRLF</h3>\n<h2><a id=\"CSP_882\"></a>CSP</h2>\n<h2><a id=\"SSTI_884\"></a>SSTI</h2>\n<h2><a id=\"tqlmap_886\"></a>tqlmap工具</h2>\n<h2><a id=\"XXE_888\"></a>XXE</h2>\n<h2><a id=\"_890\"></a>原理</h2>\n<h3><a id=\"xml_892\"></a>xml外部实体注入</h3>\n<h2><a id=\"_894\"></a>实体</h2>\n<h3><a id=\"_896\"></a>内部实体</h3>\n<h3><a id=\"_898\"></a>外部实体</h3>\n<h2><a id=\"xml_900\"></a>xml格式</h2>\n<h2><a id=\"_902\"></a>利用</h2>\n<h3><a id=\"_904\"></a>任意文件读取</h3>\n<h3><a id=\"ssrf_906\"></a>ssrf</h3>\n<h3><a id=\"_908\"></a>命令执行</h3>\n<h2><a id=\"CSRF_910\"></a>CSRF</h2>\n<h2><a id=\"_912\"></a>原理</h2>\n<h2><a id=\"_914\"></a>跨域</h2>\n<h3><a id=\"_916\"></a>同源</h3>\n<h3><a id=\"_918\"></a>协议相同</h3>\n<h3><a id=\"_920\"></a>域名相同</h3>\n<h3><a id=\"_922\"></a>端口相同</h3>\n<h3><a id=\"_924\"></a>跨</h3>\n<h3><a id=\"_926\"></a>同源策略</h3>\n<h4><a id=\"ajax_928\"></a>ajax无法跨域</h4>\n<h4><a id=\"_930\"></a>自动表单提交</h4>\n<h4><a id=\"__script_srchtml_932\"></a><img alt=\"\" src=\"\"/> ¶ <code>&lt;script src&gt;</code>{=html}</h4>\n<h2><a id=\"_934\"></a>其他</h2>\n<h2><a id=\"crossdomainxml_936\"></a>crossdomain.xml的错误配置</h2>\n<h2><a id=\"SSRF_938\"></a>SSRF</h2>\n<h2><a id=\"hash_940\"></a>hash长度扩展攻击</h2>\n<h3><a id=\"HashPump_942\"></a>HashPump</h3>\n<h2><a id=\"PHP_SOAP_944\"></a>PHP SOAP</h2>\n<p>SOAP是PHP中的原生类，其常和反序列化漏洞一起考察</p>\n<h2><a id=\"Bypass_948\"></a>过滤与Bypass</h2>\n<h3><a id=\"_950\"></a>限制请求特定域名</h3>\n<h3><a id=\"_952\"></a>@</h3>\n<h3><a id=\"IP_954\"></a>限制访问内网IP</h3>\n<h3><a id=\"_956\"></a>进制转换</h3>\n<h3><a id=\"_958\"></a>省略写法</h3>\n<h3><a id=\"DNS_960\"></a>利用DNS和可控域名</h3>\n<h1><a id=\"_962\"></a>文件上传</h1>\n<h2><a id=\"_964\"></a>原理</h2>\n<h2><a id=\"web_966\"></a>用户能够控制自己上传的文件，web应用没有经过过滤或者没有经过严格的过滤，上传的恶意文件被保存到服务器上当做脚本文件来执行</h2>\n<h2><a id=\"_968\"></a>常规的利用方式</h2>\n<h2><a id=\"_970\"></a>直接上传</h2>\n<h2><a id=\"JS_972\"></a>绕过前端JS验证</h2>\n<h3><a id=\"js_974\"></a>不让js代码生效</h3>\n<h3><a id=\"js_976\"></a>删除js</h3>\n<h3><a id=\"js_978\"></a>禁用js</h3>\n<h3><a id=\"js_980\"></a>修改js</h3>\n<h3><a id=\"_982\"></a>抓包修改</h3>\n<h3><a id=\"1jpg1php_984\"></a>1.jpg改为1.php</h3>\n<h2><a id=\"mimetype_986\"></a>mime-type值验证</h2>\n<h3><a id=\"_988\"></a>概念</h3>\n<h3><a id=\"_990\"></a>补充</h3>\n<h3><a id=\"_992\"></a>抓包修改</h3>\n<h3><a id=\"ContentType_994\"></a>Content-Type</h3>\n<h4><a id=\"imagejpeg_996\"></a>image/jpeg</h4>\n<h4><a id=\"imagepng_998\"></a>image/png</h4>\n<h4><a id=\"imagegif_1000\"></a>image/gif</h4>\n<h2><a id=\"_1002\"></a>文件头</h2>\n<h3><a id=\"_1004\"></a>概念</h3>\n<h3><a id=\"_1_1006\"></a>子主题 1</h3>\n<h3><a id=\"_1008\"></a>利用方式</h3>\n<h3><a id=\"_1010\"></a>抓包修改</h3>\n<h4><a id=\"jpeg_1012\"></a>jpeg</h4>\n<h4><a id=\"png_1014\"></a>png</h4>\n<h4><a id=\"gif_1016\"></a>gif</h4>\n<h4><a id=\"GIF89a_1018\"></a>GIF89a</h4>\n<h3><a id=\"_1020\"></a>图片马</h3>\n<h4><a id=\"1jpg1php_1022\"></a>1.jpg改成1.php</h4>\n<h2><a id=\"_1024\"></a>黑名单</h2>\n<h3><a id=\"_1026\"></a>解析漏洞</h3>\n<h3><a id=\"apache_1028\"></a>apache</h3>\n<h3><a id=\"nginx_1030\"></a>nginx</h3>\n<h3><a id=\"iis_60_1032\"></a>iis 6.0</h3>\n<h4><a id=\"fck_1034\"></a>fck编辑器</h4>\n<h4><a id=\"_1036\"></a>目录解析</h4>\n<h5><a id=\"xxaspasp_1038\"></a>新建一个xx.asp目录，在这个目录里面的文件都会当作asp文件来执行</h5>\n<h4><a id=\"_1040\"></a>文件名解析</h4>\n<h5><a id=\"xxxasp1jpg_1042\"></a>xxx.asp;1.jpg</h5>\n<h5><a id=\"_1044\"></a>重命名文件</h5>\n<h6><a id=\"jpg_1046\"></a>时间戳.jpg</h6>\n<h3><a id=\"iis_7075_1048\"></a>iis 7.0/7.5</h3>\n<h4><a id=\"php_1050\"></a>php路径修复</h4>\n<h3><a id=\"_1052\"></a>中间件的特性</h3>\n<h3><a id=\"iis60_1054\"></a>iis6.0</h3>\n<h4><a id=\"asa_1056\"></a>asa</h4>\n<h4><a id=\"cer_1058\"></a>cer</h4>\n<h4><a id=\"cdx_1060\"></a>cdx</h4>\n<h3><a id=\"_1062\"></a>常规方式</h3>\n<h3><a id=\"_1064\"></a>大小写</h3>\n<h3><a id=\"windows_1066\"></a>windows文件流</h3>\n<h3><a id=\"_1068\"></a>操作系统特性</h3>\n<h4><a id=\"1jpg_1070\"></a>1.jpg空格</h4>\n<h4><a id=\"1jpg_1072\"></a>1.jpg.</h4>\n<h2><a id=\"_1074\"></a>白名单</h2>\n<h3><a id=\"_1076\"></a>解析漏洞</h3>\n<h3><a id=\"_1078\"></a>文件包含</h3>\n<h3><a id=\"ewebeditor_1080\"></a>ewebeditor后台可以修改白名单</h3>\n<h3><a id=\"getshell_1082\"></a>后台getshell</h3>\n<h3><a id=\"_1084\"></a>备份数据功能</h3>\n<h4><a id=\"_1086\"></a>把当前数据库备份为一个文件</h4>\n<h4><a id=\"_1088\"></a>可以指定文件后缀</h4>\n<h5><a id=\"1php_1090\"></a>1.php</h5>\n<h4><a id=\"_1092\"></a>不可以指定文件后缀</h4>\n<h5><a id=\"_1094\"></a>抓包修改</h5>\n<h5><a id=\"_1096\"></a>不能修改</h5>\n<h4><a id=\"_1098\"></a>想办法插入一句话代码</h4>\n<h3><a id=\"_1100\"></a>新建、浏览文件/目录功能</h3>\n<h4><a id=\"getshell_1102\"></a>getshell</h4>\n<h4><a id=\"_1104\"></a>文件包含漏洞</h4>\n<h4><a id=\"_1106\"></a>任意文件读取</h4>\n<h4><a id=\"xxphpfilenameindexphp_1108\"></a>xx.php?filename=…/…/index.php</h4>\n<h4><a id=\"_1110\"></a>任意文件下载</h4>\n<h3><a id=\"_1112\"></a>注意</h3>\n<h4><a id=\"_1114\"></a>前台和后台分离</h4>\n<h4><a id=\"wwwxxxcom_1116\"></a>www.xxx.com</h4>\n<h5><a id=\"wwwxxxcomadmin_1118\"></a>www.xxx.com/admin</h5>\n<h5><a id=\"adminxxxcom_1120\"></a>admin.xxx.com</h5>\n<h2><a id=\"_1122\"></a>二次渲染</h2>\n<h3><a id=\"_1124\"></a>含义</h3>\n<h3><a id=\"_1126\"></a>图片马</h3>\n<h2><a id=\"_1128\"></a>注意负载均衡</h2>\n<h2><a id=\"_1130\"></a>练习平台</h2>\n<h2><a id=\"uploadlabs_1132\"></a>upload-labs</h2>\n<h1><a id=\"_1134\"></a>文件包含</h1>\n<h2><a id=\"_1136\"></a>原理</h2>\n<h2><a id=\"_1138\"></a>分类</h2>\n<h2><a id=\"_1140\"></a>远程文件包含</h2>\n<h3><a id=\"_1142\"></a>利用方式</h3>\n<h3><a id=\"includephpfilehttpxxxcom1txt_1144\"></a>include.php?file=http://xxx.com/1.txt</h3>\n<h2><a id=\"_1146\"></a>本地文件包含</h2>\n<h3><a id=\"_1148\"></a>利用方式</h3>\n<h3><a id=\"_1150\"></a>伪协议</h3>\n<h2><a id=\"_1152\"></a>特殊方式</h2>\n<h2><a id=\"_1154\"></a>包含日志文件</h2>\n<h2><a id=\"load_data_infile_1156\"></a>load data infile</h2>\n<h2><a id=\"_1158\"></a>路径问题</h2>\n<h2><a id=\"_1160\"></a>可以直接获取路径</h2>\n<h3><a id=\"_1162\"></a>通过返回包获取</h3>\n<h3><a id=\"_1164\"></a>右键查看地址</h3>\n<h2><a id=\"_1166\"></a>无法直接获取路径</h2>\n<h3><a id=\"_1168\"></a>查看源代码或者本地搭建</h3>\n<h3><a id=\"_1170\"></a>猜</h3>\n<h3><a id=\"_1172\"></a>通用的路径</h3>\n<h4><a id=\"img_1174\"></a>img</h4>\n<h4><a id=\"images_1176\"></a>images</h4>\n<h4><a id=\"upload_1178\"></a>upload</h4>\n<h4><a id=\"uploads_1180\"></a>uploads</h4>\n<h4><a id=\"file_1182\"></a>file</h4>\n<h3><a id=\"_1184\"></a>分析网站结构</h3>\n<h4><a id=\"_1186\"></a>爬虫</h4>\n<h4><a id=\"_1188\"></a>分析网站命名方式</h4>\n<h2><a id=\"_1190\"></a>上传文件保存在另外的服务器上面</h2>\n<h2><a id=\"_1192\"></a>防御方式</h2>\n<h1><a id=\"_1194\"></a>反序列化</h1>\n<h2><a id=\"Java_1196\"></a>Java</h2>\n<h2><a id=\"PHP_1198\"></a>PHP</h2>\n<h2><a id=\"_1200\"></a>框架</h2>\n<h2><a id=\"weblogic_1202\"></a>weblogic</h2>\n<h2><a id=\"struct2_1204\"></a>struct2</h2>\n<h2><a id=\"fastjson_1206\"></a>fastjson</h2>\n<h2><a id=\"_1208\"></a>其他</h2>\n<h1><a id=\"_1210\"></a>代码审计</h1>\n<h2><a id=\"XSS_1212\"></a>XSS</h2>\n<h2><a id=\"print_1214\"></a>print()</h2>\n<h2><a id=\"printr_1216\"></a>printr()</h2>\n<h2><a id=\"echo_1218\"></a>echo</h2>\n<h2><a id=\"printf_1220\"></a>printf()</h2>\n<h2><a id=\"sprintf_1222\"></a>sprintf()</h2>\n<h2><a id=\"die_1224\"></a>die()</h2>\n<h2><a id=\"var_dump_1226\"></a>var_dump()</h2>\n<h2><a id=\"var_export_1228\"></a>var_export()</h2>\n<h2><a id=\"_1230\"></a>代码执行</h2>\n<h2><a id=\"_1232\"></a>函数</h2>\n<h3><a id=\"eval_1234\"></a>eval()</h3>\n<h3><a id=\"assert_1236\"></a>assert()</h3>\n<h3><a id=\"preg_repace_1238\"></a>preg_repace()</h3>\n<h3><a id=\"create_function_1240\"></a>create_function()</h3>\n<h3><a id=\"array_map_1242\"></a>array_map()</h3>\n<h3><a id=\"call_user_func_1244\"></a>call_user_func()</h3>\n<h3><a id=\"call_user_func_array_1246\"></a>call_user_func_array()</h3>\n<h3><a id=\"array_filter_1248\"></a>array_filter()</h3>\n<h3><a id=\"usort_1250\"></a>usort()</h3>\n<h3><a id=\"uasort_1252\"></a>uasort()</h3>\n<h2><a id=\"bypass_1254\"></a>过滤与bypass</h2>\n<h3><a id=\"_1256\"></a>利用各种函数的返回值进行拼接</h3>\n<h3><a id=\"_1258\"></a>利用^符号异或出想要的东西</h3>\n<h3><a id=\"_1260\"></a>利用等价表达式</h3>\n<h3><a id=\"__1262\"></a>_</h3>\n<h4><a id=\"_1264\"></a>空格</h4>\n<h4><a id=\"_1266\"></a>.</h4>\n<h2><a id=\"_1268\"></a>文件包含</h2>\n<h2><a id=\"include_1270\"></a>include()</h2>\n<h2><a id=\"include_once_1272\"></a>include_once()</h2>\n<h2><a id=\"require_1274\"></a>require()</h2>\n<h2><a id=\"require_once_1276\"></a>require_once()</h2>\n<h2><a id=\"_1278\"></a>文件读取（下载）</h2>\n<h2><a id=\"file_get_contents_1280\"></a>file_get_contents()</h2>\n<h2><a id=\"highlight_file_1282\"></a>highlight_file()</h2>\n<h2><a id=\"fopen_1284\"></a>fopen()</h2>\n<h2><a id=\"readfile_1286\"></a>readfile()</h2>\n<h2><a id=\"fread_1288\"></a>fread()</h2>\n<h2><a id=\"fgetss_1290\"></a>fgetss()</h2>\n<h2><a id=\"fgets_1292\"></a>fgets()</h2>\n<h2><a id=\"parse_ini_file_1294\"></a>parse_ini_file()</h2>\n<h2><a id=\"show_source_1296\"></a>show_source()</h2>\n<h2><a id=\"file_1298\"></a>file()</h2>\n<h2><a id=\"sort_1300\"></a>sort()比较鸡肋</h2>\n<h2><a id=\"_1302\"></a>命令执行</h2>\n<h2><a id=\"_1304\"></a>相关函数</h2>\n<h3><a id=\"system_1306\"></a>system()</h3>\n<h3><a id=\"exec_1308\"></a>exec()</h3>\n<h3><a id=\"shell_exec_1310\"></a>shell_exec()（反引号也可以）</h3>\n<h3><a id=\"passthru_1312\"></a>passthru()</h3>\n<h3><a id=\"pcntl_exec_1314\"></a>pcntl_exec()</h3>\n<h3><a id=\"popen_1316\"></a>popen()</h3>\n<h3><a id=\"proc_open_1318\"></a>proc_open()</h3>\n<h3><a id=\"create_function_1320\"></a>create_function()</h3>\n<p>这个是逃逸后可以命令执行</p>\n<h2><a id=\"bypass_1324\"></a>过滤与bypass</h2>\n<h3><a id=\"disable_function_1326\"></a>disable_function</h3>\n<h3><a id=\"ld_preload_1328\"></a>ld_preload</h3>\n<h3><a id=\"php_gc_1330\"></a>php_gc</h3>\n<h3><a id=\"_1332\"></a>限制命令长度</h3>\n<h3><a id=\"_1334\"></a>限制回显长度</h3>\n<h3><a id=\"_1336\"></a>过滤字符</h3>\n<h3><a id=\"_1338\"></a>空格</h3>\n<p>bash环境</p>\n<h4><a id=\"_1342\"></a>&lt;</h4>\n<h4><a id=\"IFS_1344\"></a>${IFS}</h4>\n<h4><a id=\"IFS9_1346\"></a>$IFS$9</h4>\n<h4><a id=\"09_1348\"></a>%09</h4>\n<h3><a id=\"_1350\"></a>某些函数名</h3>\n<h3><a id=\"_1352\"></a>截断符号</h3>\n<h4><a id=\"fuzz_1354\"></a>fuzz得出没被过滤的</h4>\n<h4><a id=\"base_1356\"></a>利用base编码绕过</h4>\n<h4><a id=\"_1358\"></a>用两个单引号</h4>\n<p>比如命令 cat /etc/passwd</p>\n<p>等价于 cat /etc/pass’w’d</p>\n<h2><a id=\"_1364\"></a>文件上传</h2>\n<h2><a id=\"move_uploaded_file_1366\"></a>move_uploaded_file()</h2>\n<h2><a id=\"_1368\"></a>文件删除</h2>\n<h2><a id=\"unlink_1370\"></a>unlink()</h2>\n<h2><a id=\"session_destroy_1372\"></a>session_destroy()（老版本）</h2>\n<h2><a id=\"_1374\"></a>变量覆盖</h2>\n<h2><a id=\"extract_1376\"></a>extract()</h2>\n<h2><a id=\"parse_str_1378\"></a>parse_str</h2>\n<h3><a id=\"_1380\"></a>无第二个参数会引起变量覆盖</h3>\n<h2><a id=\"import_request_variables_1382\"></a>import_request_variables()</h2>\n<h2><a id=\"for_each_GET_as_keyvalue_keyvalue_1384\"></a>for each($_GET as <span class=\"katex--inline\"><span class=\"katex\"><span class=\"katex-mathml\">\n    \n     \n      \n       \n        k\n       \n       \n        e\n       \n       \n        y\n       \n       \n        =\n       \n       \n        &gt;\n       \n      \n      \n       key=&gt;\n      \n     \n    </span><span class=\"katex-html\"><span class=\"base\"><span class=\"strut\" style=\"height: 0.88888em; vertical-align: -0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right: 0.03148em;\">k</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right: 0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right: 0.277778em;\"></span><span class=\"mrel\">=</span></span><span class=\"base\"><span class=\"strut\" style=\"height: 0.5782em; vertical-align: -0.0391em;\"></span><span class=\"mrel\">&gt;</span></span></span></span></span>value) <span class=\"katex--inline\">KaTeX parse error: Expected '}', got 'EOF' at end of input: {<!-- --></span>key}=$value</h2>\n<h2><a id=\"register_globals_1386\"></a>register_globals</h2>\n<h2><a id=\"_1388\"></a>弱类型比较</h2>\n<h2><a id=\"_1390\"></a><mark>、</mark>=、!==、!=</h2>\n<h3><a id=\"md5sha1_1392\"></a>md5,sha1的==绕过</h3>\n<h2><a id=\"is_numeric_1394\"></a>is_numeric</h2>\n<h3><a id=\"16_1396\"></a>16进制编码绕过</h3>\n<h3><a id=\"0020false_1398\"></a>%00放在数字开头或者结尾，%20放在开头都能使函数返回false</h3>\n<h2><a id=\"in_array_1400\"></a>in_array</h2>\n<h2><a id=\"md5_1402\"></a>弱不相等却md5值相等的情况</h2>\n<p>只需要利用NaN(float)和’NaN’(string)即可（INF等同理）</p>\n<h2><a id=\"PHP_1406\"></a>PHP黑魔法</h2>\n<p>这里记录的是一些比较Trick的内容</p>\n<p>主要是一些函数的特性</p>\n<h2><a id=\"md5_1412\"></a>md5</h2>\n<h3><a id=\"sqlmd5ffifdyoptrue_or6xxx_1414\"></a>绕过sql，md5(‘ffifdyop’,true)= 'or’6xxx</h3>\n<p>当raw设置为true时输入 ffifdyop 可以对单引号进行闭合</p>\n<p>经过md5编码后返回的原始二进制不是普通的二进制（因为raw为true),而是’or’6<code>\\xc9</code>{=tex}]<code>\\x99</code>{=tex}<code>\\xe9</code>{=tex}!r,<code>\\xf9</code>{=tex}<code>\\xedb</code>{=tex}<code>\\x</code>{=tex}1c<br/> 这种。这样的话就会和前面的形成闭合，构成万能密码；</p>\n<h3><a id=\"_1421\"></a>弱类型绕过和强类型绕过</h3>\n<h2><a id=\"eval_1423\"></a>eval</h2>\n<h3><a id=\"_1425\"></a>可使用分号构造出多条语句</h3>\n<h2><a id=\"ereg_1427\"></a>ereg</h2>\n<h3><a id=\"00_1429\"></a>存在%00截断</h3>\n<h2><a id=\"strcmp_1431\"></a>strcmp</h2>\n<p>影响版本 PHP5.3 及以下</p>\n<h3><a id=\"return_0_1435\"></a>无法处理数组并将return 0</h3>\n<h2><a id=\"ascii_1437\"></a>ascii</h2>\n<h3><a id=\"_1439\"></a>传进去的是字符串只会截取第一个字符进行处理</h3>\n<h2><a id=\"curl_setopt_1441\"></a>curl_setopt</h2>\n<h3><a id=\"SSRF_1443\"></a>存在可能的SSRF</h3>\n<h2><a id=\"preg_replace_1445\"></a>preg_replace</h2>\n<h3><a id=\"_e_1447\"></a>第二个参数使用 /e模式导致代码执行</h3>\n<h2><a id=\"urldecode_1449\"></a>urldecode</h2>\n<h3><a id=\"url_1451\"></a>url二次编码绕过</h3>\n<h2><a id=\"include_1453\"></a>include</h2>\n<p>include函数有这么一个神奇的功能：若以字符’/‘分隔（而且不计个数），若是在前面的字符串所代表的文件无法被PHP找到，则PHP会自动包含’/‘后面的文件------注意是最后一个’/’。（存疑）</p>\n<h2><a id=\"__wakeup_1457\"></a>__wakeup</h2>\n<p>(CVE-2016-7124)</p>\n<p>影响版本： · PHP before 5.6.25 · 7.x before 7.0.10</p>\n<h3><a id=\"__wakeup__1463\"></a>反序列化时，如果表示对象属性个数的值大于真实的属性个数时就会跳过__wakeup( )的执行</h3>\n<h2><a id=\"open_basedir_1465\"></a>open_basedir</h2>\n<p>PHP5.x</p>\n<h3><a id=\"_1469\"></a>可绕过并进行任意文件读取（两种方法）</h3>\n<h2><a id=\"in_array_1471\"></a>in_array()</h2>\n<h3><a id=\"FALSE_1473\"></a>第三个参数如果设置为FALSE，就存在注入点</h3>\n<h2><a id=\"spl_autoload_register_1475\"></a>spl_autoload_register</h2>\n<h3><a id=\"getshell_1477\"></a>配合文件上传可以getshell</h3>\n<h2><a id=\"create_function_1479\"></a>create_function()</h2>\n<h3><a id=\"_1481\"></a>代码注入</h3>\n<h2><a id=\"file_get_contents_1483\"></a>file_get_contents</h2>\n<h3><a id=\"_1485\"></a>经常用伪协议绕过</h3>\n<h2><a id=\"mt_rand_1487\"></a>mt_rand</h2>\n<h3><a id=\"SEED_1489\"></a>SEED相关的安全性问题</h3>\n<h2><a id=\"sprintf_1491\"></a>sprintf</h2>\n<h3><a id=\"_1493\"></a>格式化字符串漏洞</h3>\n<h2><a id=\"parse_url_1495\"></a>parse_url</h2>\n<h3><a id=\"_1497\"></a>可用于绕过某些过滤</h3>\n<h2><a id=\"preg_match_1499\"></a>preg_match</h2>\n<ol><li> <p>可绕过进行代码执行，见P神的文章</p> </li><li> <p>通过pre_match函数的资源消耗来绕过，因为pre_match在匹配的时候会消耗较大的资源，并且默认存在贪婪匹配，所以通过喂一个超长的字符串去给pre_match吃，导致pre_match消耗大量资源从而导致php超时，后面的php语句就不会执行。</p> </li><li> <p>回溯次数上限pcre.backtrack_limit相关的安全问题</p> </li><li> <p>%0A，%0D 参数污染相关问题</p> </li></ol>\n<h2><a id=\"intval_1509\"></a>intval</h2>\n<h3><a id=\"_1511\"></a>类型转换上限</h3>\n<h2><a id=\"Session_1513\"></a>Session绕过</h2>\n<p>删除cookie，没有cookie中的SESSIONID就找不到对应的session文件，相应的$_SESSION[‘var’]就为NULL，传参NULL即可匹配。</p>\n<h2><a id=\"file_put_contents_1517\"></a>file_put_contents</h2>\n<p>第二个参数写入数据如果是数组的话，会被连接起来写入文件。但是这样就能绕过前面的过滤。</p>\n<h2><a id=\"json_encodedecode_1521\"></a>json_encode/decode</h2>\n<p>json_encode：将数组转换为json，只支持utf8格式的数据。json_encode<br/> 会自动将utf8格式的汉字转为unicode格式。gbk格式的数据只能输出NULL。</p>\n<p>json_decode：可以解析unicode编码格式的字符串，官方说明只能解析utf-8编码的数据。 英文字符不区分编码格式，encode decode都能解析。</p>\n<p>json_decode：可以当作mysql的分隔符:<br/> 空格 + <code>\\f</code>{=tex}<code>\\n</code>{=tex} <code>\\r</code>{=tex}<code>\\t \\u0</code>{=tex}009 <code>\\u0</code>{=tex}00A <code>\\u0</code>{=tex}00B <code>\\u0</code>{=tex}00C <code>\\u0</code>{=tex}00D <code>\\u0</code>{=tex}020 <code>\\u0</code>{=tex}02B</p>\n<h2><a id=\"NULL_1531\"></a>几乎所有的字符串相关函数都不能处理数组，此时会返回NULL，可用于绕过</h2>\n<p>举例： md5,sha1,strpos</p>\n<h3><a id=\"ereg_1535\"></a>ereg</h3>\n<h3><a id=\"MD5_1537\"></a>MD5</h3>\n<h3><a id=\"sha1_1539\"></a>sha1</h3>\n<h3><a id=\"strpos_1541\"></a>strpos</h3>\n<h3><a id=\"strcmp_1543\"></a>strcmp</h3>\n<h2><a id=\"_1545\"></a>变量特性</h2>\n<h2><a id=\"ignore_user_abort_1547\"></a>ignore_user_abort</h2>\n<h3><a id=\"_1549\"></a>并发漏洞</h3>\n<h2><a id=\"_SERVERQUERY_STRING_1551\"></a>$_SERVER[‘QUERY_STRING’]</h2>\n<h3><a id=\"_GETurldecode_1553\"></a>不会像$_GET一样进行urldecode</h3>\n<h2><a id=\"disable_functions_1555\"></a>disable_functions</h2>\n<h3><a id=\"_1557\"></a>有七种做法进行绕过</h3>\n<h3><a id=\"_1559\"></a>可以试试蚁剑的插件</h3>\n<h2><a id=\"exitreturn_1561\"></a>未exit(),return()引发的相关问题</h2>\n<h2><a id=\"_1563\"></a>伪静态绕过</h2>\n<h2><a id=\"_1565\"></a>反序列化漏洞</h2>\n<h2><a id=\"_1567\"></a>对各种魔法函数的理解</h2>\n<h3><a id=\"__wakeup_unserialize_1569\"></a>__wakeup() //使用unserialize时触发</h3>\n<h3><a id=\"__sleep_serialize_1571\"></a>__sleep() //使用serialize时触发</h3>\n<h3><a id=\"__destruct__1573\"></a>__destruct() //对象被销毁时触发</h3>\n<h3><a id=\"__construct_1575\"></a>__construct()//对象创建时自动调用</h3>\n<h3><a id=\"__call__1577\"></a>__call() //在对象上下文中调用不可访问的方法时触发</h3>\n<h3><a id=\"__callStatic__1579\"></a>__callStatic() //在静态上下文中调用不可访问的方法时触发</h3>\n<h3><a id=\"__get__1581\"></a>__get() //用于从不可访问的属性读取数据</h3>\n<h3><a id=\"__set__1583\"></a>__set() //用于将数据写入不可访问的属性</h3>\n<h3><a id=\"__isset_issetempty_1585\"></a>__isset() //在不可访问的属性上调用isset()或empty()触发</h3>\n<h3><a id=\"__unset_unset_1587\"></a>__unset() //在不可访问的属性上使用unset()时触发</h3>\n<h3><a id=\"__toString__1589\"></a>__toString() //把类当作字符串使用时触发</h3>\n<h3><a id=\"__invoke__1591\"></a>__invoke() //当脚本尝试将对象调用为函数时触发</h3>\n<h2><a id=\"pop_1593\"></a>pop链的构造</h2>\n<h3><a id=\"_1595\"></a>寻找位点</h3>\n<h3><a id=\"_1597\"></a>正向构造</h3>\n<p>切入点------__wakeup()------其他</p>\n<h3><a id=\"_1601\"></a>反向推理</h3>\n<p>从flag开始推起</p>\n<h2><a id=\"phar_1605\"></a>phar与反序列化</h2>\n<h2><a id=\"_1607\"></a>由于替换引起的反序列化字符串逃逸</h2>\n<h2><a id=\"_1609\"></a>绕过正则</h2>\n<p>if (preg_match(’/[oc]:<code>\\d+</code>{=tex}:/i’,<br/> ‘O:4:“Demo”:1:{s:10:“Demofile”;s:16:“f15g_1s_here.php”;}’)) 进行这种正则判断的时候，可以在数字前加’+'号来绕过，数字的正号在序列化后的字符串中可以省略，但是可以绕过正则</p>\n<h2><a id=\"_1614\"></a>逻辑漏洞</h2>\n<h2><a id=\"_1616\"></a>用户名和密码分开验证</h2>\n<h2><a id=\"_1618\"></a>下单和扣款的先后顺序</h2>\n<h2><a id=\"_1620\"></a>技巧相关</h2>\n<h2><a id=\"_1622\"></a>小型代码</h2>\n<h3><a id=\"_1624\"></a>寻找输入点</h3>\n<h3><a id=\"_1626\"></a>对针对输入点的过滤进行绕过</h3>\n<h3><a id=\"_1628\"></a>在处理输入的函数中寻找漏洞</h3>\n<h3><a id=\"_1630\"></a>进行利用</h3>\n<h2><a id=\"_1632\"></a>大型代码</h2>\n<h3><a id=\"_1634\"></a>寻找危险函数</h3>\n<h3><a id=\"__1636\"></a>向上回溯 寻找可用输入点</h3>\n<h3><a id=\"_1638\"></a>尝试绕过过滤</h3>\n<h3><a id=\"_1640\"></a>寻找触发漏洞的方法</h3>\n<h2><a id=\"2019WebUpload_1642\"></a>2019强网杯Web-Upload</h2>\n<h1><a id=\"_1644\"></a>脚本编写</h1>\n<h1><a id=\"_1646\"></a>其他</h1>\n<h2><a id=\"Clickjacking_1648\"></a>Clickjacking</h2>\n<h2><a id=\"HEREDOC_1650\"></a>HEREDOC</h2>\n<h2><a id=\"JSPFUCK_1652\"></a>JSPFUCK</h2>\n<h2><a id=\"Web_Assembly_1654\"></a>Web Assembly</h2>\n<h2><a id=\"_1656\"></a>整数溢出</h2>\n<p>常见于商城，购物界面</p>\n<h2><a id=\"Hash_1660\"></a>Hash长度拓展攻击</h2>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}