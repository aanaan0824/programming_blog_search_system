{"blogid": "125907766", "writerAge": "码龄4年", "writerBlogNum": "376", "writerCollect": "4310", "writerComment": "883", "writerFan": "57617", "writerGrade": "7级", "writerIntegral": "14982", "writerName": "bug菌¹", "writerProfileAdress": "writer_image\\profile_125907766.jpg", "writerRankTotal": "616", "writerRankWeekly": "271", "writerThumb": "1993", "writerVisitNum": "1823748", "blog_read_count": "32", "blog_time": "于 2022-09-07 00:00:00 发布", "blog_title": "springboot系列(二十七):如何实现word携带图片导出？这你得会|超级详细，建议收藏", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"htmledit_views\" id=\"content_views\">\n<blockquote>\n<p><strong>👨‍🎓 作者</strong>：bug菌</p>\n<p>🎉<strong>简介</strong>：在CSDN、掘金等社区优质创作者，全网合计6w粉+，对一切技术都感兴趣，重心偏java方向，目前运营公众号[猿圈奇妙屋]，欢迎小伙伴们的加入，一起秃头。</p>\n<p>🚫<strong>特别声明</strong>：原创不易，转载请附上原文出处链接和本文声明，谢谢配合。</p>\n<p>🙏<strong>版权声明</strong>：文章里可能部分文字或者图片来源于互联网或者百度百科，如有侵权请联系bug菌处理。</p>\n</blockquote>\n<div class=\"img-center\">\n<figure class=\"image\">\n<img alt=\"\" height=\"247\" src=\"image\\b96792104be1449992f949aed413990c.png\" width=\"497\"/>\n<figcaption>\n<a href=\"https://dev.csdn.net/activity?utm_source=sale_source&amp;sale_source=vR3hDJerMm\" title=\"【开发云】年年都是折扣价，不用四处薅羊毛\">【开发云】年年都是折扣价，不用四处薅羊毛</a>\n</figcaption>\n</figure>\n</div>\n<p>         嗨，家人们，我是bug菌呀，我又来啦。今天我们来聊点什么咧，OK，接着为大家更<a href=\"https://blog.csdn.net/weixin_43970743/category_11599389.html\" title=\"《springboot零基础入门教学》\">《springboot零基础入门教学》</a>系列文章吧。希望能帮助更多的初学者们快速入门！</p>\n<blockquote>\n        小伙伴们在批阅文章的过程中如果觉得文章对您有一丝丝帮助，还请别吝啬您手里的赞呀，大胆的把文章\n <span style=\"color:#be191c;\"><strong>点亮</strong></span>👍吧，您的点赞三连(\n <span style=\"color:#be191c;\">收藏⭐️+关注👨‍🎓+留言</span>📃)就是对bug菌我创作道路上最好的鼓励与支持😘。时光不弃🏃🏻‍♀️，创作不停💕，加油☘️\n</blockquote>\n<h2><span style=\"color:#ff9900;\">一、前言</span>🔥</h2>\n<p>        前几期呢，我们主要是讲了如何集成easypoi实现excel的导入导出功能，word的导入导出，对吧。不知道你们掌握的如何，如果还对以下任意一篇有疑问，还请大家多多提问，哈哈哈，虽然不是什么大佬，但是我会尽全力相授，一起学习查缺补漏。</p>\n<ul><li>springboot集成EasyPoi(环境准备篇)</li><li>如何实现Excel文件的导入？</li><li>如何实现Excel文件的导出？</li><li>如何实现单word文档模板分页导出？</li><li>如何实现word文件模板导出单页？</li><li>如何实现word文件带图片导出？</li><li>如何实现excel文件带图片导出？</li><li>如何实现excel文件多sheet导入？</li><li>如何实现excel文件多sheet导出？</li><li>如何实现excel模板导出成pdf文件？</li></ul>\n<p>       既然word的导出都实现了多样化，那数据上要是如果携带图片，那该怎么办呢？</p>\n<p>比如啊，导出所有用户的基本信息，而用户表中，就存有每一个用户的自画像，比如一寸照啥的，像这个情况，那word导出应该得怎么实现呢？还是跟以前一样么？？</p>\n<p>       接下来我就开始啦，同学们可得竖起耳朵好好听讲哦~我会带着大家一步一步实现它，至于怎么实现，接着往下看。</p>\n<h2><span style=\"color:#ff9900;\">二、引入pom依赖</span>🔥</h2>\n<p>       像你如果要实现word携带图片导出，还是引入前几期的easypoi版本肯定是不能用，比如easypoi3.2.0虽然提供了拓展图片导出，但是bug菌的的确确是尝试过了，没有导出成功，可能是作者在这些版本中，压根就没有加入对该图片解析的代码吧。大家请看：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"601\" src=\"image\\5b4bb23adcea414dacae8a9b85364c8d.jpeg\" width=\"950\"/></p>\n<p>        接着本来我是直接封装了一个对图片进行设置的方法，但凡是一涉及该实体，就被划线处理，应该就是被废弃了。</p>\n<p class=\"img-center\"><img alt=\"\" height=\"160\" src=\"image\\3bd431c633ac441fa71c32f308bb2a4c.jpeg\" width=\"820\"/></p>\n<p>        所以在查询资料发现，easypoi4.3版本及以上却支持了word图片导出，就很完美，这下对于有word导出图片需求的同学来说，这就是福音啊。即我们就以easypoi4.3为例给大家演示如何实现word图片导出，好吧？</p>\n<pre><code class=\"language-java\">&lt;!--easypoi依赖，excel导入导出--&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;cn.afterturn&lt;/groupId&gt;\n    &lt;artifactId&gt;easypoi-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;4.3.0&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n<p><strong>切记！注意依赖版本 4.3.0+才支持多图片循环导出。</strong></p>\n<h2><span style=\"color:#ff9900;\">三、实现word图片导出</span>🔥</h2>\n<h3>1️⃣<span style=\"color:#4da8ee;\">定义word模板</span></h3>\n<p>        我们分别以单word模板导出多页数据和word模板导出多数据两种模式进行演示，这样大家日后遇到此需求，就不用再查阅相关资料了，直接上手就是开撸(代码)。</p>\n<p><span style=\"color:#be191c;\"><strong>模式一：</strong></span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"283\" src=\"image\\095e28baf2604be4a1eab2e705be2750.jpeg\" width=\"661\"/></p>\n<p><span style=\"color:#be191c;\"><strong>模式二：</strong></span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"354\" src=\"image\\6264ac4be5b6471dab6951c2c6053cfb.jpeg\" width=\"745\"/></p>\n<p>        以上是两种不同的word模板，接下来我们就根据这两份不同的模板依次为大家演示如何导出该画像图片。</p>\n<h3>2️⃣<span style=\"color:#4da8ee;\">Controller添加word导出方法</span></h3>\n<p>        我们先来定义一个word文档导出方法，目的是提供一个口子，好方便自己通过浏览器访问进行测试。</p>\n<pre><code class=\"language-java\">/**\n * word文档导出到一个模板中\n */\n@GetMapping(\"export-word-all\")\n@ApiOperation(value = \"word文档导出到一个模板中\", notes = \"word文档导出到一个模板中\")\npublic void exportUsersToWordAll(HttpServletResponse response) throws Exception {\n    userService.exportUsersToWord(response);\n}\n\n/**\n * word文档导出\n */\n@GetMapping(\"export-word\")\n@ApiOperation(value = \"word文档导出\", notes = \"word文档导出\")\npublic void exportUsersToWord(HttpServletResponse response) throws Exception {\n    userService.exportUsersToWord(response);\n}</code></pre>\n<p>        不需要任何返回值及参数，你只需要携带你调用接口时的请求<code>HttpServletResponse </code>即可。</p>\n<h3>3️⃣<span style=\"color:#4da8ee;\">定义导入接口</span></h3>\n<pre><code class=\"language-java\">/**\n * word文档导出到一个模板中\n */\nvoid exportUsersToWordAll(HttpServletResponse response) throws Exception;\n\n/**\n * word文档导出\n */\nvoid exportUsersToWord(HttpServletResponse response) throws Exception;</code></pre>\n<h3>4️⃣<span style=\"color:#4da8ee;\">实现导出方法(核心) </span></h3>\n<p>        如下这个导出实现类就很关键了，我们还是直接使用easypoi提供的<code>exportWord07()</code>方法，具体细节就看我上两期教学内容啦，这里我们着重演示添加图片：</p>\n<p>代码具体设置如下：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"473\" src=\"image\\e0385152ba8845909889eb5f71abf014.jpeg\" width=\"985\"/></p>\n<pre><code class=\"language-java\">//添加简单图片map.put(\"image\", this.imgFormatting(\"static/image/刘亦菲.jpg\", 100, 100));</code></pre>\n<p>        我就直接不贴所有代码了啊，毕竟其余代码上几期教学内容中都全部有，还有，我这里只是作为演示，所以图片地址固定死了，如遇实际环境，肯定是直接传入该用户的图片地址即可。</p>\n<p>附上设置图片封装的方法，仅供参考：</p>\n<pre><code class=\"language-java\">/**\n * 图片格式化，Word导出图片格式\n *\n * @param imgPath 图片路径\n */\nprivate ImageEntity imgFormatting(String imgPath, int width, int height) {\n    //设置图片\n    ImageEntity image = new ImageEntity(imgPath, width, height);\n    //表格外添加简单图片\n    image.setType(ImageEntity.URL);\n    return image;\n}</code></pre>\n<h3>5️⃣<span style=\"color:#4da8ee;\">浏览器测试接口</span></h3>\n<p>        我们打开浏览器，在地址栏，输入我们刚才在Controller暴露出来的接口地址：</p>\n<p>比如我的：<a href=\"http://localhost:8080//user/export-word-all\" title=\"http://localhost:8080//user/export-word-all\">http://localhost:8080//user/export-word-all</a> 和 <a href=\"http://localhost:8080//user/export-word\" title=\"http://localhost:8080//user/export-word\">http://localhost:8080//user/export-word</a></p>\n<p>按你的接口地址进行访问即可。</p>\n<p>        我分别截图给大家看一下，两种模式分别展示图片是何种效果：</p>\n<p><span style=\"color:#be191c;\">模式一：</span></p>\n<p><span style=\"color:#be191c;\">       </span><span style=\"color:#333333;\"> 根据word模板1，直接导出单模板多页数据，具体截图如下：</span></p>\n<p class=\"img-center\"><img alt=\"\" height=\"258\" src=\"image\\bab27a64b75840078197b0da4163e1e8.jpeg\" width=\"644\"/></p>\n<p>        以上就只截图了一页模板内容啦，反正图片就是一样的，你们的国民女神。</p>\n<p><span style=\"color:#be191c;\">模式二：</span></p>\n<p><span style=\"color:#be191c;\">        </span><span style=\"color:#333333;\">根据word模板2，直</span>接导出word模板多内容显示具体如下：</p>\n<p class=\"img-center\"><img alt=\"\" height=\"554\" src=\"image\\62bf5ae25c144225904edf8e3f4a088e.jpeg\" width=\"1016\"/></p>\n<p>        对比出来了么，这两种导出方式，差异还是有点大，对吧，但是这期内容重点不是这两种导出模式，而是图片在这两种模式下，都展示成功了，还以为要翻车，嘿嘿，内容教你们啦，剩下的就靠大家去摸索咯。</p>\n<p>     ... ...</p>\n<p>        ok，以上就是我这期的全部内容啦，如果还想学习更多，你可以看看我的往期热文推荐哦，每天积累一个奇淫小知识，日积月累下去，你一定能成为令人敬仰的大佬的。好啦，咱们下期见~</p>\n<h2><span style=\"color:#ff9900;\">三、往期推荐🔥</span></h2>\n<ul><li id=\"articleContentId\"><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125639200\" title=\"springboot系列(一):如何创建springboot项目及启动\">springboot系列(一):如何创建springboot项目及启动</a></li><li> <p><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125678725\" title=\"springboot系列(二):yaml、properties两配置文件介绍及使用\">springboot系列(二):yaml、properties两配置文件介绍及使用</a></p> </li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125721763\" title=\"springboot系列(三):多环境切换，实例演示\">springboot系列(三):多环境切换，实例演示</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125806789\" title=\"springboot系列(四):stater入门\">springboot系列(四):stater入门</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125808010\" title=\"springboot系列(五):史上最最最全springboot常用注解\">springboot系列(五):史上最最最全springboot常用注解</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125844323\" title=\"springboot系列(六):mysql配置及数据库查询\">springboot系列(六):mysql配置及数据库查询</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125845236\" title=\"springboot系列(七):如何通过mybatis-plus实现接口增删改查\">springboot系列(七):如何通过mybatis-plus实现接口增删改查</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125846402\" title=\"springboot系列(八):mybatis-plus之条件构造器使用手册\">springboot系列(八):mybatis-plus之条件构造器使用手册</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125849168\" title=\"springboot系列(九):mybatis-plus之如何自定义sql\">springboot系列(九):mybatis-plus之如何自定义sql</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125886471\" title=\"springboot系列(十):mybatis之xml映射文件＞、＜=等特殊符号写法\">springboot系列(十):mybatis之xml映射文件＞、＜=等特殊符号写法</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125886864\" title=\"springboot系列(十一):实现多数据源配置，开箱即用\">springboot系列(十一):实现多数据源配置，开箱即用</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125888177\" title=\"springboot系列(十二):如何实现邮件发送提醒，你一定得会(准备篇)\">springboot系列(十二):如何实现邮件发送提醒，你一定得会(准备篇)</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125888409\" title=\"springboot系列(十三):如何实现发送普通邮件？你一定得会\">springboot系列(十三):如何实现发送普通邮件？你一定得会</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125888751\" title=\"springboot系列(十四):如何实现发送图片、doc文档等附件邮件？你一定得会\">springboot系列(十四):如何实现发送图片、doc文档等附件邮件？你一定得会</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125888965\" title=\"springboot系列(十五):如何实现静态邮件模板发送？你一定得会\">springboot系列(十五):如何实现静态邮件模板发送？你一定得会</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125889361\" title=\"springboot系列(十六):如何实现发送邮件提醒，附完整源码\">springboot系列(十六):如何实现发送邮件提醒，附完整源码</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/126145700\" title=\"springboot系列(十七):集成在线接口文档Swagger2\">springboot系列(十七):集成在线接口文档Swagger2</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125894591\" title=\"springboot系列(十八):如何Windows安装redis？你玩过么\">springboot系列(十八):如何Windows安装redis？你玩过么</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125895363\" title=\"springboot系列(十九):如何集成redis？不会我教你\">springboot系列(十九):如何集成redis？不会我教你</a></li><li><a href=\"https://blog.csdn.net/weixin_43970743/article/details/125895652\" title=\"springboot系列(二十):如何通过redis实现手机号验证码功能 \">springboot系列(二十):如何通过redis实现手机号验证码功能 </a></li><li>... ...</li></ul>\n<h2><span style=\"color:#ff9900;\">四、文末🔥</span></h2>\n<p>        如果还想要学习更多，小伙伴们可关注bug菌专门为大家创建的专栏<a href=\"https://blog.csdn.net/weixin_43970743/category_11599389.html\" title=\"《springboot零基础入门教学》\">《springboot零基础入门教学》</a>，从无到有，从零到一！希望能帮助到更多小伙伴们。</p>\n<div class=\"img-center\">\n<figure class=\"image\">\n<img alt=\"\" height=\"247\" src=\"image\\b96792104be1449992f949aed413990c.png\" width=\"497\"/>\n<figcaption>\n<a href=\"https://dev.csdn.net/activity?utm_source=sale_source&amp;sale_source=vR3hDJerMm\" title=\"【开发云】年年都是折扣价，不用四处薅羊毛\">【开发云】年年都是折扣价，不用四处薅羊毛</a>\n</figcaption>\n</figure>\n</div>\n<p><span style=\"color:#be191c;\">       我是bug菌，一名想走👣出大山改变命运的程序猿。接下来的路还很长，都等待着我们去突破、去挑战。来吧，小伙伴们，我们一起加油！未来皆可期，fighting！</span></p>\n<p>        最后送大家两句我很喜欢的话，与诸君共勉！</p>\n<hr/>\n<p>☘️做你想做的人，没有时间限制，只要愿意，什么时候都可以start。</p>\n<p>🍀你能从现在开始改变，也可以一成不变，这件事，没有规矩可言，你可以活出最精彩的自己。</p>\n<hr/>\n<p><img alt=\"\" src=\"https://img-blog.csdnimg.cn/20210616160640975.gif\"/>​​​</p>\n<blockquote>\n<p>💌如果文章对您有所帮助，就请留下您的<strong>赞</strong>吧！(#^.^#)；</p>\n<p>💝如果喜欢bug菌分享的文章，就请给bug菌点个<strong>关注</strong>吧！(๑′ᴗ‵๑)づ╭❤～；</p>\n<p>💗如果对文章有任何疑问，还请文末<strong>留言</strong>或者<strong>加群</strong>吧；</p>\n<p>💞鉴于个人经验有限，所有观点及技术研点，如有异议，请直接回复参与讨论(请勿发表攻击言论，谢谢）；</p>\n<p>💕版权声明：原创不易，转载请附上原文出处链接和本文声明，版权所有，盗版必究！！！谢谢。</p>\n</blockquote>\n</div>\n</div>"}