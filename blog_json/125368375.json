{"blogid": "125368375", "writerAge": "码龄13年", "writerBlogNum": "717", "writerCollect": "55002", "writerComment": "12899", "writerFan": "177418", "writerGrade": "10级", "writerIntegral": "103398", "writerName": "梦想橡皮擦", "writerProfileAdress": "writer_image\\profile_125368375.jpg", "writerRankTotal": "15", "writerRankWeekly": "139", "writerThumb": "23538", "writerVisitNum": "12404523", "blog_read_count": "16771", "blog_time": "于 2022-06-20 11:01:28 发布", "blog_title": "高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-dark\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<p></p>\n<div class=\"toc\">\n<h3>文章目录</h3>\n<ul><li><ul><li><a href=\"#_gaussDBDWS_1\">创建高斯数据库 gaussDB（DWS）</a></li><li><a href=\"#_gaussDBDWS_30\">连接 gaussDB（DWS）</a></li><li><a href=\"#GaussDB_DWS__54\">GaussDB （DWS） 命令学习</a></li><li><ul><li><a href=\"#l__107\">`\\l`： 列出所有数据库</a></li><li><a href=\"#c___111\">`\\c 数据库名` ：切换数据库</a></li><li><a href=\"#_144\">创建一个表</a></li><li><a href=\"#_176\">维护数据</a></li><li><a href=\"#_schema_226\">创建和管理 schema</a></li><li><a href=\"#_267\">其余命令</a></li></ul>\n</li><li><a href=\"#_288\">总结</a></li></ul>\n</li></ul>\n</div>\n<p></p>\n<h2><a id=\"_gaussDBDWS_1\"></a>创建高斯数据库 gaussDB（DWS）</h2>\n<p>在正式开始前需要提前创建一下 VPC，位置入口如下所示。<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\87f18e5515dc9d70a060c37864fd1bd8.png\"/></p>\n<p>在打开的页面配置如下信息，然后创建即可。</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\da1f6c5b62896c3ec56e89d16efd1cda.png\"/></p>\n<p>其中首要进行的修改是 <strong>基本名称</strong> 和 <strong>子网名称</strong></p>\n<p>创建完毕之后的结果如下所示：</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\b978702fddab248a1e12f683f356ac31.png\"/></p>\n<p>接下来就可以配置高斯数据库 DWS 了，功能入口地址为 <strong>大数据</strong>-&gt;<strong>数据仓库服务 GaussDB(DWS)</strong></p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\bec0b422219319f079a95982b4c5db12.png\"/></p>\n<p>这里按照华为云提示输入即可，请注意购买一个公网 IP，否则后续实践不好操作。</p>\n<p>虚拟私有云选择前文配置内容即可。</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\4a83175cb4bfa39e7781fa1397f4bdc0.png\"/></p>\n<p>创建之后需要等 10 分钟所有的初始化实践，然后出现 <strong>可用</strong> 状态后，表示创建成功。</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\dad48991c9497e05eb1b5eb398f04df6.png\"/></p>\n<h2><a id=\"_gaussDBDWS_30\"></a>连接 gaussDB（DWS）</h2>\n<p>首先下载链接工具，下载完毕在 Download 目录对文件进行解压与链接操作。</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\43d8fbee3a6cd3fd87e9916d02dbe461.png\"/></p>\n<pre><code class=\"prism language-shell\"><span class=\"token function\">unzip</span> dws_client_8.1.x_redhat_x64.zip\n<span class=\"token builtin class-name\">source</span> gsql_env.sh\n</code></pre>\n<p>去 DWS 详情页拿到外网 IP，接下来就可以使用下述命令行进行连接。</p>\n<pre><code class=\"prism language-shell\">gsql -d gaussdb -h <span class=\"token operator\">&lt;</span>DWS的公网IP<span class=\"token operator\">&gt;</span> -U dbadmin -p <span class=\"token number\">8000</span> -r -W <span class=\"token operator\">&lt;</span>用户dbadmin密码<span class=\"token operator\">&gt;</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>使用公网 IP 和密码登录之后，进入到 DWS 操作界面。<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\e004a9ca22f15a33f3056696be09642a.png\"/></p>\n<p>其中与 <code>gaussdb=&gt;</code> 对应的还有一个 <code>gaussdb-&gt;</code>，表示为换行，一般当你的命令没有结尾时，即未出现分号 （<code>;</code>），会出现该输入状态。</p>\n<p>连接到 DWS 之后，就可以进行命令学习了。</p>\n<h2><a id=\"GaussDB_DWS__54\"></a>GaussDB （DWS） 命令学习</h2>\n<p>首先使用万能命令 <code>help</code>，得到下图所示内容。<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\318f3c76bb8a2e632b5a86ea681b5b03.png\"/></p>\n<p>其中出现了很多关键信息</p>\n<pre><code class=\"prism language-shell\">You are using gsql, the command-line interface to gaussdb.\nType:  <span class=\"token punctuation\">\\</span>copyright <span class=\"token keyword\">for</span> distribution terms\n       <span class=\"token punctuation\">\\</span>h <span class=\"token keyword\">for</span> <span class=\"token builtin class-name\">help</span> with SQL commands\n       <span class=\"token punctuation\">\\</span>? <span class=\"token keyword\">for</span> <span class=\"token builtin class-name\">help</span> with gsql commands\n       <span class=\"token punctuation\">\\</span>g or terminate with semicolon to execute query\n       <span class=\"token punctuation\">\\</span>q to quit\n\n</code></pre>\n<p>使用 <code>\\h</code> 得到 SQL 命令，具体如下，省略了部分结果，其中涉及的内容与 MySQL 关键字基本一致，例如 <code>Alter</code>，<code>Create</code>，<code>Drop</code> 等内容。</p>\n<pre><code class=\"prism language-sql\">ABORT            <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TEXT</span> SEARCH CONFIGURATION\n  <span class=\"token keyword\">ALTER</span> APP WORKLOAD <span class=\"token keyword\">GROUP</span>          <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TEXT</span> SEARCH DICTIONARY\n  <span class=\"token keyword\">ALTER</span> APP WORKLOAD <span class=\"token keyword\">GROUP</span> MAPPING  <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TRIGGER</span>\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">DATA</span> SOURCE                 <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TYPE</span>\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">DATABASE</span>                    <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">USER</span>\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">DEFAULT</span> <span class=\"token keyword\">PRIVILEGES</span>          <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">VIEW</span>\n  <span class=\"token keyword\">ALTER</span> DIRECTORY                   <span class=\"token keyword\">CREATE</span> WORKLOAD <span class=\"token keyword\">GROUP</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>skipping <span class=\"token number\">1</span> line\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">SESSION</span>                     <span class=\"token keyword\">DROP</span> NODE <span class=\"token keyword\">GROUP</span>\n  <span class=\"token keyword\">ALTER</span> SYNONYM                     <span class=\"token keyword\">DROP</span> OWNED\n  <span class=\"token keyword\">ALTER</span> SYSTEM <span class=\"token keyword\">KILL</span> <span class=\"token keyword\">SESSION</span>         <span class=\"token keyword\">DROP</span> <span class=\"token keyword\">PROCEDURE</span>\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span>                       <span class=\"token keyword\">DROP</span> REDACTION POLICY\n  <span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">PARTITION</span>             <span class=\"token keyword\">DROP</span> RESOURCE POOL\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>skipping <span class=\"token number\">1</span> line\n  <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span>                      <span class=\"token keyword\">TRUNCATE</span>\n  <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">AS</span>                   <span class=\"token keyword\">UPDATE</span>\n  <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token keyword\">PARTITION</span>            VACUUM\n  <span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLESPACE</span>                 <span class=\"token keyword\">VALUES</span>\n</code></pre>\n<p>使用 <code>\\?</code> 得到的是 <code>gsql</code> 命令，这些是需要我们仔细学习的内容。</p>\n<p><code>\\copyright</code> 获取的是版权信息，得到内容如下所示：</p>\n<pre><code class=\"prism language-shell\">GaussDB Database Management System\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> Huawei Technologies Co., Ltd. <span class=\"token number\">2018</span>. All rights reserved.`\n</code></pre>\n<p>首先记住 <code>\\q</code> 是退出，但是如果一口气把所有命令都记住是不可能的，因为编程属于熟能生巧的技术工种，所以死记硬背效果不大。</p>\n<p>我们先看一下基本 <code>gsql</code> 命令。</p>\n<h3><a id=\"l__107\"></a><code>\\l</code>： 列出所有数据库</h3>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\adfb6c64588efab40006621ac5ba38ae.png\"/></p>\n<h3><a id=\"c___111\"></a><code>\\c 数据库名</code> ：切换数据库</h3>\n<p>使用 <code>\\c</code> 可以切换数据库，例如下述命令：</p>\n<pre><code class=\"prism language-shell\"><span class=\"token punctuation\">\\</span>c postgres\n</code></pre>\n<p>使用之后会要求再次输入密码：</p>\n<pre><code class=\"prism language-shell\">assword <span class=\"token keyword\">for</span> user dbadmin:\nSSL connection <span class=\"token punctuation\">(</span>protocol: TLSv1.3, cipher: TLS_AES_128_GCM_SHA256, bits: <span class=\"token number\">128</span><span class=\"token punctuation\">)</span>\nYou are now connected to database <span class=\"token string\">\"postgres\"</span> as user <span class=\"token string\">\"dbadmin\"</span><span class=\"token builtin class-name\">.</span>\n\n</code></pre>\n<p>切换成功之后，会发现输入状态提示位置已经切换到新的数据库中。</p>\n<pre><code class=\"prism language-shell\"><span class=\"token assign-left variable\">postgres</span><span class=\"token operator\">=</span><span class=\"token operator\">&gt;</span> <span class=\"token punctuation\">\\</span>d\n</code></pre>\n<p>此时我们可以用 <code>\\d</code> 查看<strong>当前数据库下的表</strong>。</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\b17aa1728de761ef2041571d5748bfa1.png\"/></p>\n<p>如果该数据库下没有表，则提示下述无关系。</p>\n<pre><code class=\"prism language-shell\">No relations found.\n</code></pre>\n<h3><a id=\"_144\"></a>创建一个表</h3>\n<p>为了后续测试，我们需要创建一个数据表，使用命令与 MySQL 一致，具体如下：</p>\n<pre><code class=\"prism language-sql\"><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> customer_t1\n<span class=\"token punctuation\">(</span>\n    c_customer_sk             <span class=\"token keyword\">integer</span><span class=\"token punctuation\">,</span>\n    c_customer_id             <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    c_first_name              <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    c_last_name               <span class=\"token keyword\">char</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> <span class=\"token punctuation\">(</span>orientation <span class=\"token operator\">=</span> <span class=\"token keyword\">column</span><span class=\"token punctuation\">,</span>compression<span class=\"token operator\">=</span>middle<span class=\"token punctuation\">)</span>\ndistribute <span class=\"token keyword\">by</span> <span class=\"token keyword\">hash</span> <span class=\"token punctuation\">(</span>c_last_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>代码复制之后的结果如下所示，注意 <code>=&gt;</code> 和 <code>-&gt;</code>：<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\aed8da5352479fc97429181f435562cf.png\"/></p>\n<p>然后回车运行建表脚本，得到下述内容，表示表创建完毕。</p>\n<pre><code class=\"prism language-shell\">CREATE TABLE\n</code></pre>\n<p>此时再使用 <code>\\d</code> 就能得到刚刚建立的数据表了。<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\a3e92de3e1cdfd3631a9dbf4566f9c6d.png\"/></p>\n<blockquote>\n<p>表的字段名：c_customer_sk 、c_customer_id、c_first_name 和 c_last_name 是，integer、char(5)、char(6)和 char(8)是这四字段名称的类型。</p>\n</blockquote>\n<p>表创建完毕，就可以对数据进行管理了，常见的操作是插入，更新，删除。</p>\n<h3><a id=\"_176\"></a>维护数据</h3>\n<p><strong>插入数据</strong></p>\n<pre><code class=\"prism language-shell\">INSERT INTO customer_t1<span class=\"token punctuation\">(</span>c_customer_sk, c_customer_id, c_first_name<span class=\"token punctuation\">)</span> VALUES <span class=\"token punctuation\">(</span><span class=\"token number\">5566</span>, <span class=\"token string\">'hello'</span>, <span class=\"token string\">'橡皮擦'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>插入上述数据，由于 <code>橡皮擦</code> 超过了数据长度，所以出现下述异常。</p>\n<pre><code class=\"prism language-shell\">ERROR:  value too long <span class=\"token keyword\">for</span> <span class=\"token builtin class-name\">type</span> character<span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nCONTEXT:  referenced column: c_first_name\n</code></pre>\n<p>修改之后，插入成功：</p>\n<pre><code class=\"prism language-shell\">INSERT INTO customer_t1<span class=\"token punctuation\">(</span>c_customer_sk, c_customer_id, c_first_name<span class=\"token punctuation\">)</span> VALUES <span class=\"token punctuation\">(</span><span class=\"token number\">5566</span>, <span class=\"token string\">'hello'</span>, <span class=\"token string\">'???'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<p>提示信息：</p>\n<pre><code class=\"prism language-shell\">INSERT <span class=\"token number\">0</span> <span class=\"token number\">1</span>\n</code></pre>\n<p>此时可以用 <code>\\d+</code> 命令查看表的属性</p>\n<pre><code class=\"prism language-shell\"><span class=\"token punctuation\">\\</span>d+ customer_t1<span class=\"token punctuation\">;</span>\n</code></pre>\n<p>得到的结果如下所示：</p>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\66f5e38b247e60ad90a4094d40d0c4b7.png\"/></p>\n<p><strong>查询命令</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token keyword\">select</span> * from customer_t1<span class=\"token punctuation\">;</span>\n</code></pre>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\c5ff75fecf2dc81f2f2721f86783731e.png\"/></p>\n<p>其余的查询语句参考 MySQL 的 SELECT 语法即可。</p>\n<p><strong>更新与删除表数据</strong><br/> 更新与删除语句与 MySQL 一致，可以互相参考学习。</p>\n<h3><a id=\"_schema_226\"></a>创建和管理 schema</h3>\n<p>在 GaussDB DWS 中有一个新概念的出现，叫做 Schema ，即模式。</p>\n<p>通过管理 schema，允许多个用户使用同一数据库而不相互干扰，可以将数据库对象组织成易于管理的逻辑组，同时便于将第三方应用添加到相应的 schema 下而不引起冲突。</p>\n<p>有一些注意事项，抄录自官网手册：</p>\n<ul><li>数据库集群包含一个或多个已命名数据库。用户和用户组在整个集群范围内是共享的，但是其数据并不共享。任何与服务器连接的用户都只能访问连接请求里声明的那个数据库。</li><li>一个数据库可以包含一个或多个已命名的 schema，schema 又包含表及其他数据库对象，包括数据类型、函数、操作符等。同一对象名可以在不同的 schema 中使用而不会引起冲突。例如，schema1 和 schema2 都可以包含一个名为 mytable 的表。</li></ul>\n<p>使用 <code>\\dn</code> 可以查看所有 schema：<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\f23943b5e2241e8717847eae3b6705f9.png\"/></p>\n<p>使用 <code>SHOW search_path;</code>，可以显示<strong>当前使用的 schema</strong>，效果如下：<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\ca9760763e02fbb3efc807b243457413.png\"/></p>\n<p><strong>模式相关命令</strong><br/> 查看数据库当前模式</p>\n<pre><code class=\"prism language-shell\">\n<span class=\"token keyword\">select</span> current_schema<span class=\"token punctuation\">;</span>\n</code></pre>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\31d2740ff227ae0c2e7df0b39a1c9ea6.png\"/></p>\n<p><strong>设置当前数据库模式</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token builtin class-name\">set</span> <span class=\"token assign-left variable\">current_schema</span><span class=\"token operator\">=</span>my_schema<span class=\"token punctuation\">;</span>\n</code></pre>\n<p><strong>创建 schema 并指定 owner</strong></p>\n<pre><code class=\"prism language-shell\">create schema my_schema authorization dlpuser<span class=\"token punctuation\">;</span>\n</code></pre>\n<blockquote>\n<p>关于 schema 更多命令，可以在实战用继续学习。</p>\n</blockquote>\n<h3><a id=\"_267\"></a>其余命令</h3>\n<p>使用 <code>show server_encoding;</code> 可以查看数据库编码。<br/> <img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\c25f14695b521c2bed71879e322ac5fc.png\"/></p>\n<p><strong>查看数据库用户</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token keyword\">select</span> * from pg_user<span class=\"token punctuation\">;</span>\n</code></pre>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\1be6d5a7bc62743366523dc8ae240954.png\"/></p>\n<p><strong>查看当前数据库拥有的表</strong></p>\n<pre><code class=\"prism language-shell\"><span class=\"token keyword\">select</span> * from pg_tables<span class=\"token punctuation\">;</span>\n</code></pre>\n<p><img alt=\"高斯数据库gaussDB（DWS），全网首篇对标MySQL命令集合文章\" src=\"image\\0282d24c50eed4f98e0ce9c28b8e473d.png\"/></p>\n<h2><a id=\"_288\"></a>总结</h2>\n<p>本篇博客从 DWS 初始化入手，为大家重点介绍了最常用的 Gaussdb 命令，其中 SQL 部分参考 MySQL 知识点即可，gsql 可以着重学习一下，当然 DWS 还有更多的技能栈，例如 <strong>分区</strong>，<strong>索引</strong>，<strong>视图</strong>，<strong>序列</strong>，<strong>定时任务</strong>，我们下篇博客见~</p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}