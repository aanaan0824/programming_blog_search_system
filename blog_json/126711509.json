{"blogid": "126711509", "writerAge": "码龄1年", "writerBlogNum": "335", "writerCollect": "2178", "writerComment": "205", "writerFan": "847", "writerGrade": "5级", "writerIntegral": "4473", "writerName": "小熊猫爱恰饭", "writerProfileAdress": "writer_image\\profile_126711509.jpg", "writerRankTotal": "3894", "writerRankWeekly": "81", "writerThumb": "517", "writerVisitNum": "201637", "blog_read_count": "213", "blog_time": "于 2022-09-05 19:06:49 发布", "blog_title": "20行Python代码获取 心碎榜单文件保存本地，准备开始emo......", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-atom-one-light\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"emo_0\"></a>嗨害大家好鸭…我是小熊猫（emo版）</h1>\n<h2><a id=\"_2\"></a>(语气充满悲伤…)</h2>\n<p><img alt=\"请添加图片描述\" src=\"image\\f3a6a959557f41408185f869e1a301fe.jpeg\"/><br/> 今天咱们试试只用<mark>20行代码</mark>来实现</p>\n<p>批量获取 某某云 文件保存本地，炒鸡简单！</p>\n<p>悄悄的告诉你，其实不到20行代码~</p>\n<p><img alt=\"请添加图片描述\" src=\"image\\e39b5d5d5e2a4765af5b987b8dee2237.jpeg\"/></p>\n<h2><a id=\"_13\"></a>你需要准备</h2>\n<p>本次使用的环境是Python3.8，编辑器是pycharm ，</p>\n<p>没有安装的小伙伴，看我置顶文章有教程。</p>\n<p>模块使用的是requests、re、os 三个，其中requests是第三方模块，需要手动安装一下，re、os都是内置模块，不需要安装。</p>\n<p>pip install requests 即可，不会安装的我置顶文章也有详细教程，这里就不过多讲了。</p>\n<blockquote>\n<p><mark>或者直接在文章末尾点名片拿一下软件和安装教程也是可以的。</mark></p>\n</blockquote>\n<p><img alt=\"请添加图片描述\" src=\"image\\6cc489675bbe4710a9df887a331bd5db.jpeg\"/></p>\n<h2><a id=\"_28\"></a>浏览器开发者工具</h2>\n<p>咱们需要学会如何使用开发者工具。</p>\n<p>对此很多小伙伴都不会，因为每个浏览器的开发者工具细节上多少有一些差别，我建议都用谷歌浏览器，英文看不懂的话可以调成中文。</p>\n<p>打开开发者工具，点击省略号，点击 shortcuts</p>\n<p><img alt=\"请添加图片描述\" src=\"image\\185b9a8e41854147a8f6547efa04c235.png\"/><br/> 依次点击 preferences - language ，直接拉到最下方选择中文即可。</p>\n<p><img alt=\"请添加图片描述\" src=\"image\\2c77f293b70a416e9ad6b964ea39cdfc.png\"/></p>\n<h2><a id=\"_41\"></a>代码实现</h2>\n<p>本次实现步骤大致分为以下五步：</p>\n<ol><li>发送请求</li><li>获取数据</li><li>解析数据</li><li>保存数据</li></ol>\n<p>这里我就不讲怎么分析开发者工具了，有空（<s>摸鱼</s> ）做一个详细的教程，讲解开发者工具。</p>\n<hr/>\n<p><img alt=\"请添加图片描述\" src=\"image\\e1c20659f4694821a3b2cd549ccab6fa.jpeg\"/></p>\n<h2><a id=\"_58\"></a>模块导入</h2>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">import</span> requests  <span class=\"token comment\"># 数据请求模块</span>\n<span class=\"token keyword\">import</span> re  <span class=\"token comment\"># 正则表达式模块</span>\n<span class=\"token keyword\">import</span> os   <span class=\"token comment\"># 文件操作模块</span>\n</code></pre>\n<h2><a id=\"_66\"></a>发送请求</h2>\n<pre><code class=\"prism language-python\">url <span class=\"token operator\">=</span> <span class=\"token string\">'https://网址自己打一下/discover/toplist?id=3778678'</span>\nheaders <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n    <span class=\"token string\">'User-Agent'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36'</span>\n<span class=\"token punctuation\">}</span>\nresponse <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>url<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span>\n</code></pre>\n<h2><a id=\"_75\"></a>获取数据</h2>\n<pre><code class=\"prism language-python\">result <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>findall<span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;li&gt;&lt;a href=\"/song\\?id=(\\d+)\"&gt;(.*?)&lt;/a&gt;&lt;/li&gt;'</span><span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> music<span class=\"token punctuation\">,</span> title <span class=\"token keyword\">in</span> result<span class=\"token punctuation\">:</span>\n    music_url <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'http://music.163.com/song/media/outer/url?id=</span><span class=\"token interpolation\"><span class=\"token punctuation\">{<!-- --></span>music<span class=\"token punctuation\">}</span></span><span class=\"token string\">.mp3'</span></span>\n    music_content <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>url<span class=\"token operator\">=</span>music_url<span class=\"token punctuation\">,</span> headers<span class=\"token operator\">=</span>headers<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>content\n</code></pre>\n<h2><a id=\"_83\"></a>保存数据</h2>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>filename <span class=\"token operator\">+</span> title <span class=\"token operator\">+</span> <span class=\"token string\">'.mp3'</span><span class=\"token punctuation\">,</span> mode<span class=\"token operator\">=</span><span class=\"token string\">'wb'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span>\n    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>music_content<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span>\n</code></pre>\n<p>当然这只是最简单的爬取榜单音乐，评论、歌词等等都可以爬取，还有制作词云图、通过搜索下载，音乐下载器，等等各种实现下载的方式。</p>\n<p><mark><strong>好了，今天的分享就到这里，完整代码下方名片获取哈~</strong></mark></p>\n<h2><a id=\"emo_93\"></a>我是小熊猫（emo版），咱下篇文章再见啦(✿◡‿◡)</h2>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/d5738ec208684e4b900c40f15be339ac.gif\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}