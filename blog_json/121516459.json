{"blogid": "121516459", "writerAge": "码龄1年", "writerBlogNum": "132", "writerCollect": "1960", "writerComment": "808", "writerFan": "2298", "writerGrade": "5级", "writerIntegral": "3396", "writerName": "魔王不会哭", "writerProfileAdress": "writer_image\\profile_121516459.jpg", "writerRankTotal": "5183", "writerRankWeekly": "2180", "writerThumb": "550", "writerVisitNum": "183529", "blog_read_count": "8632", "blog_time": "于 2021-11-24 16:04:40 发布", "blog_title": "想去看演唱却总是抢不到票？教你用Python制作一个自动抢票脚本", "content": "<div class=\"article_content clearfix\" id=\"article_content\">\n<link href=\"style.css\" rel=\"stylesheet\"/>\n<div class=\"markdown_views prism-dracula\" id=\"content_views\">\n<svg style=\"display: none;\" xmlns=\"http://www.w3.org/2000/svg\">\n<path d=\"M5,0 0,2.5 5,5z\" id=\"raphael-marker-block\" stroke-linecap=\"round\" style=\"-webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"></path>\n</svg>\n<h1><a id=\"_0\"></a>前言</h1>\n<p>嗨喽！大家好，这里是魔王！！</p>\n<p>大麦网，是中国综合类现场娱乐票务营销平台，业务覆盖演唱会、 话剧、音乐剧、体育赛事等领域。</p>\n<p>但是因为票数有限，还有黄牛们不能丢了饭碗，所以导致了，很多人都抢不到票</p>\n<p>那么，今天带大家用Python来制作一个自动抢票的脚本小程序<br/> <img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/3d7c1f14a56143f2afbaad77aa7d8319.webp?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA6a2U546L5LiN5Lya5ZOt,size_15,color_FFFFFF,t_70,g_se,x_16\"/></p>\n<h1><a id=\"_11\"></a>此次知识点：</h1>\n<ul><li>面向对象编程</li><li>selenium 操作浏览器</li><li>pickle 保存和读取Cookie实现免登陆</li><li>time 做延时操作</li><li>os 创建文件，判断文件是否存在</li></ul>\n<h1><a id=\"_18\"></a>开发环境：</h1>\n<ul><li>版 本：anaconda5.2.0（python3.6.5）</li><li>编辑器：pycharm</li></ul>\n<blockquote>\n<p>python安装包 安装教程视频</p>\n<p>pycharm 社区版 专业版 及 激活码</p>\n<p>视频教程私我领取</p>\n</blockquote>\n<h1><a id=\"_28\"></a>第三方库：</h1>\n<ul><li>selenium &gt;&gt;&gt; pip install selenium==3.4.1</li></ul>\n<h1><a id=\"_31\"></a>步骤</h1>\n<blockquote>\n<ol><li> <p>实现免登陆<br/> 第一次登陆的时候 会帮助我记录我们的登陆信息<br/> set_cookie 登陆成功之后 cookie会发生变化<br/> 后续抢票: 直接使用我们记录好的登陆信息<br/> get_cookie</p> </li><li> <p>抢票并且下单</p> </li></ol>\n</blockquote>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/47c5cac7e1ad4626addfc1f8d3fb7654.gif\"/></p>\n<h1><a id=\"_43\"></a>首先导入本次所需的模块</h1>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">from</span> selenium <span class=\"token keyword\">import</span> webdriver  <span class=\"token comment\"># 操作谷歌浏览器 需要额外安装的 并且现在安装这个模块得指定版本 3.4</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n<span class=\"token keyword\">import</span> pickle  <span class=\"token comment\"># 保存和读取cookie实现免登录的工具</span>\n<span class=\"token keyword\">import</span> os   <span class=\"token comment\"># 操作文件的模块</span>\n</code></pre>\n<h1><a id=\"_50\"></a>第一步，实现免登录</h1>\n<h3><a id=\"_51\"></a>确定目标，设置全局变量</h3>\n<pre><code class=\"prism language-python\"><span class=\"token comment\"># 大麦网主页</span>\ndamai_url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.damai.cn/\"</span>\n<span class=\"token comment\"># 登录页</span>\nlogin_url <span class=\"token operator\">=</span> <span class=\"token string\">\"https://passport.damai.cn/login?ru=https%3A%2F%2Fwww.damai.cn%2F\"</span>\n<span class=\"token comment\"># 抢票目标页</span>\ntarget_url <span class=\"token operator\">=</span> 'https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>detail<span class=\"token punctuation\">.</span>damai<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span>item<span class=\"token punctuation\">.</span>htm?spm<span class=\"token operator\">=</span>a2oeg<span class=\"token punctuation\">.</span>search_category<span class=\"token punctuation\">.</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">.</span>77f24d15RWgT4o<span class=\"token operator\">&amp;</span><span class=\"token builtin\">id</span><span class=\"token operator\">=</span><span class=\"token number\">654534889506</span><span class=\"token operator\">&amp;</span>clicktitle<span class=\"token operator\">=</span><span class=\"token operator\">%</span>E5<span class=\"token operator\">%</span>A4<span class=\"token operator\">%</span>A7<span class=\"token operator\">%</span>E4<span class=\"token operator\">%</span>BC<span class=\"token operator\">%</span><span class=\"token number\">97</span><span class=\"token operator\">%</span>E7\n</code></pre>\n<h3><a id=\"_61\"></a>初始化加载</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Concert</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">=</span> <span class=\"token number\">0</span>         <span class=\"token comment\"># 状态,表示如今进行到何种程度</span>\n        self<span class=\"token punctuation\">.</span>login_method <span class=\"token operator\">=</span> <span class=\"token number\">1</span>   <span class=\"token comment\"># {0:模拟登录,1:Cookie登录}自行选择登录方式</span>\n        self<span class=\"token punctuation\">.</span>driver <span class=\"token operator\">=</span> webdriver<span class=\"token punctuation\">.</span>Chrome<span class=\"token punctuation\">(</span>executable_path<span class=\"token operator\">=</span><span class=\"token string\">'chromedriver.exe'</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># 默认Chrome浏览器</span>\n</code></pre>\n<h3><a id=\"cookie_70\"></a>登录调用设置cookie</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">set_cookie</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>damai_url<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###请点击登录###\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'大麦网-全球演出赛事官方购票平台'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n        sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###请扫码登录###'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>title <span class=\"token operator\">!=</span> <span class=\"token string\">'大麦网-全球演出赛事官方购票平台-100%正品、先付先抢、在线选座！'</span><span class=\"token punctuation\">:</span>\n       sleep<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###扫码成功###\"</span><span class=\"token punctuation\">)</span>\n    pickle<span class=\"token punctuation\">.</span>dump<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get_cookies<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cookies.pkl\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###Cookie保存成功###\"</span><span class=\"token punctuation\">)</span>\n    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>target_url<span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"cookie_87\"></a>获取cookie</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">get_cookie</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        cookies <span class=\"token operator\">=</span> pickle<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cookies.pkl\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 载入cookie</span>\n        <span class=\"token keyword\">for</span> cookie <span class=\"token keyword\">in</span> cookies<span class=\"token punctuation\">:</span>\n            cookie_dict <span class=\"token operator\">=</span> <span class=\"token punctuation\">{<!-- --></span>\n                <span class=\"token string\">'domain'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'.damai.cn'</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\"># 必须有，不然就是假登录</span>\n                <span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> cookie<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'value'</span><span class=\"token punctuation\">:</span> cookie<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n            self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>add_cookie<span class=\"token punctuation\">(</span>cookie_dict<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###载入Cookie###'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_104\"></a>开始登录</h3>\n<pre><code class=\"prism language-python\">    <span class=\"token keyword\">def</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>login_method<span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>login_url<span class=\"token punctuation\">)</span>                                \n            <span class=\"token comment\"># 载入登录界面</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###开始登录###'</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">elif</span> self<span class=\"token punctuation\">.</span>login_method<span class=\"token operator\">==</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token string\">'cookies.pkl'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>                     \n            <span class=\"token comment\"># 如果不存在cookie.pkl,就获取一下</span>\n                self<span class=\"token punctuation\">.</span>set_cookie<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>target_url<span class=\"token punctuation\">)</span>\n                self<span class=\"token punctuation\">.</span>get_cookie<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_120\"></a>打开浏览器</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">enter_concert</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"打开浏览器\"\"\"</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###打开浏览器，进入大麦网###'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># self.driver.maximize_window()           # 最大化窗口</span>\n    <span class=\"token comment\"># 调用登陆</span>\n    self<span class=\"token punctuation\">.</span>login<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>                            <span class=\"token comment\"># 先登录再说</span>\n    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>refresh<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>                   <span class=\"token comment\"># 刷新页面</span>\n    self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">=</span> <span class=\"token number\">2</span>                         <span class=\"token comment\"># 登录成功标识</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###登录成功###\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\"># 后续德云社可以讲</span>\n    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>isElementExist<span class=\"token punctuation\">(</span><span class=\"token string\">'/html/body/div[2]/div[2]/div/div/div[3]/div[2]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'/html/body/div[2]/div[2]/div/div/div[3]/div[2]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h1><a id=\"_135\"></a>第二步，抢票并下单</h1>\n<h3><a id=\"_136\"></a>判断元素是否存在</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">isElementExist</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    flag <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\n    browser <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>driver\n    <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n        browser<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> flag\n\n    <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n        flag <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n        <span class=\"token keyword\">return</span> flag\n</code></pre>\n<h3><a id=\"_150\"></a>选票</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">choose_ticket</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">==</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span>                  <span class=\"token comment\">#登录成功入口</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token operator\">*</span><span class=\"token number\">30</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###开始进行日期及票价选择###\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'确认订单'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>           <span class=\"token comment\"># 如果跳转到了订单结算界面就算这步成功了，否则继续执行此步</span>\n            <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n                buybutton <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'buybtn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n                <span class=\"token keyword\">if</span> buybutton <span class=\"token operator\">==</span> <span class=\"token string\">\"提交缺货登记\"</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token comment\"># 改变现有状态</span>\n                    self<span class=\"token punctuation\">.</span>status<span class=\"token operator\">=</span><span class=\"token number\">2</span>\n                    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>target_url<span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###抢票未开始，刷新等待开始###'</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">continue</span>\n                <span class=\"token keyword\">elif</span> buybutton <span class=\"token operator\">==</span> <span class=\"token string\">\"立即预定\"</span><span class=\"token punctuation\">:</span>\n                    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'buybtn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token comment\"># 改变现有状态</span>\n                    self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">=</span> <span class=\"token number\">3</span>\n                <span class=\"token keyword\">elif</span> buybutton <span class=\"token operator\">==</span> <span class=\"token string\">\"立即购买\"</span><span class=\"token punctuation\">:</span>\n                    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'buybtn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token comment\"># 改变现有状态</span>\n                    self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">=</span> <span class=\"token number\">4</span>\n                <span class=\"token comment\"># 选座购买暂时无法完成自动化</span>\n                <span class=\"token keyword\">elif</span> buybutton <span class=\"token operator\">==</span> <span class=\"token string\">\"选座购买\"</span><span class=\"token punctuation\">:</span>\n                    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_class_name<span class=\"token punctuation\">(</span><span class=\"token string\">'buybtn'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                    self<span class=\"token punctuation\">.</span>status <span class=\"token operator\">=</span> <span class=\"token number\">5</span>\n            <span class=\"token keyword\">except</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###未跳转到订单结算界面###'</span><span class=\"token punctuation\">)</span>\n            title <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>title\n            <span class=\"token keyword\">if</span> title <span class=\"token operator\">==</span> <span class=\"token string\">'选座购买'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token comment\"># 实现选座位购买的逻辑</span>\n                self<span class=\"token punctuation\">.</span>choice_seats<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">elif</span> title <span class=\"token operator\">==</span> <span class=\"token string\">'确认订单'</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token comment\"># 如果标题为确认订单</span>\n                    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'waiting ......'</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>isElementExist<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"container\"]/div/div[9]/button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                        self<span class=\"token punctuation\">.</span>check_order<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">break</span>\n</code></pre>\n<h3><a id=\"_191\"></a>选择想要座位</h3>\n<pre><code class=\"prism language-python\">    <span class=\"token keyword\">def</span> <span class=\"token function\">choice_seats</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>title <span class=\"token operator\">==</span> <span class=\"token string\">'选座购买'</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>isElementExist<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"app\"]/div[2]/div[2]/div[1]/div[2]/img'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token comment\"># 座位手动选择 选中座位之后//*[@id=\"app\"]/div[2]/div[2]/div[1]/div[2]/img 就会消失</span>\n                <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'请快速的选择您的座位！！！'</span><span class=\"token punctuation\">)</span>\n            <span class=\"token comment\"># 消失之后就会出现 //*[@id=\"app\"]/div[2]/div[2]/div[2]/div</span>\n            <span class=\"token keyword\">while</span> self<span class=\"token punctuation\">.</span>isElementExist<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"app\"]/div[2]/div[2]/div[2]/div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token comment\"># 找到之后进行点击确认选座</span>\n                self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"app\"]/div[2]/div[2]/div[2]/button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_203\"></a>下单</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">check_order</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n!<span class=\"token punctuation\">[</span>请添加图片描述<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>https<span class=\"token punctuation\">:</span><span class=\"token operator\">//</span>img<span class=\"token operator\">-</span>blog<span class=\"token punctuation\">.</span>csdnimg<span class=\"token punctuation\">.</span>cn<span class=\"token operator\">/</span><span class=\"token number\">4a0b661782e24b8ebf46390fb2333452.</span>gif<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> self<span class=\"token punctuation\">.</span>status <span class=\"token keyword\">in</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'###开始确认订单###'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">try</span><span class=\"token punctuation\">:</span>\n            <span class=\"token comment\"># 默认选第一个购票人信息</span>\n            self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//*[@id=\"container\"]/div/div[2]/div[2]/div[1]/div/label'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">except</span> Exception <span class=\"token keyword\">as</span> e<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"###购票人信息选中失败，自行查看元素位置###\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\"># 最后一步提交订单</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 太快会影响加载，导致按钮点击无效</span>\n        self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>find_element_by_xpath<span class=\"token punctuation\">(</span><span class=\"token string\">'//div[@class = \"w1200\"]//div[2]//div//div[9]//button[1]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"__219\"></a>抢票成功, 退出当前程序</h3>\n<pre><code class=\"prism language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">finish</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    self<span class=\"token punctuation\">.</span>driver<span class=\"token punctuation\">.</span>quit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_224\"></a>测试代码</h3>\n<pre><code class=\"prism language-c\"><span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token operator\">:</span>\n    try<span class=\"token operator\">:</span>\n        con <span class=\"token operator\">=</span> <span class=\"token function\">Concert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>             # 具体如果填写请查看类中的初始化函数\n        con<span class=\"token punctuation\">.</span><span class=\"token function\">enter_concert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>         # 打开浏览器\n        con<span class=\"token punctuation\">.</span><span class=\"token function\">choose_ticket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>         # 开始抢票\n\n    except Exception as e<span class=\"token operator\">:</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span>\n        con<span class=\"token punctuation\">.</span><span class=\"token function\">finish</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n</code></pre>\n<h3><a id=\"_236\"></a>效果</h3>\n<p><img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/70534a7cab70423da9c1fe6e6827273d.gif\"/><br/> 好了，我的这篇文章写到这里就结束啦！</p>\n<p>希望你在python这条路上依心而行，别回头，别四顾。一如既往不改初见的模样，未来的路很长，不管怎样，一定要相信自己一直走下去。</p>\n<p>有更多建议或问题可以评论区或私信我哦！一起加油努力叭(ง •_•)ง</p>\n<p>喜欢就关注一下博主，或点赞收藏评论一下我的文章叭！！！<br/> <img alt=\"请添加图片描述\" src=\"https://img-blog.csdnimg.cn/4479a9fd8d2f4ecf8c2d691576043790.gif\"/></p>\n</div>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-22a2fefd3b.css\" rel=\"stylesheet\"/>\n<link href=\"https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-4f8fbf9108.css\" rel=\"stylesheet\"/>\n</div>"}